<?php$DICCIONARIO="S";$path="../";include("config_opac.php");include("leer_bases.php");include("tope.php");$base=$_REQUEST["base"]; echo "<p>Búsqueda avanzada</p>";$_REQUEST["diccionario"]="DICCIONARIO";//if(isset($_REQUEST["Sub_Expresion"])) $_REQUEST["Sub_Expresion"]=urldecode($_REQUEST["Sub_Expresion"]);//if(isset($_REQUEST["Expresion"])) $_REQUEST["Expresion"]=urldecode($_REQUEST["Expresion"]);//foreach ($_REQUEST as $var => $value) echo "$var => $value<br>";// Para presentar el diccionario de términosfunction PresentarDiccionario(){global $base,$xWxis,$db_path,$Wxis,$wxisUrl,$LastKey;    $base=$_REQUEST["base"];	$Prefijo=$_REQUEST["prefijo"];	$LastKey=$_REQUEST["LastKey"];	$IsisScript= "wxis/ifp.xis";	$cisis_ver="";    $diccio="";	$query = "&base=$base&cipar=$db_path"."par/$base".".par&Formato=opac.pft&Opcion=diccionario&prefijo=$Prefijo&campo=Palabras&Diccio=$diccio&LastKey=".$LastKey;	$contenido=wxisLlamar($base,$query,"ifp.xis");	foreach ($contenido as $linea){	echo "$linea<br>";        $pre=trim(substr($linea,0,strlen($_REQUEST["prefijo"])));		if ($pre==$_REQUEST["prefijo"]){			$l=explode('|',$linea);			$ter=substr($l[0],strlen($Prefijo));            $ter=trim($ter);            if (isset($_REQUEST["Opcion"]) and $_REQUEST["Opcion"]=="avanzada")				echo "<option value=\"".$ter."\">".$ter;			else				echo "<option value=\"".trim($l[0])."\">".$ter;			if (isset($l[1])) echo " (".trim($l[1]).")";			echo "\n";			$mayorclave=$l[0];		}	}	$LastKey=$mayorclave;    $_REQUEST["LastKey"]=$LastKey;}// ------------------------------------------------------// INICIO DEL PROGRAMA// ------------------------------------------------------echo "<div>";if (!isset($_REQUEST["LastKey"]))    $_REQUEST["LastKey"]="";if (isset($_REQUEST["campo"]))   echo "Diccionario de ".urldecode($_REQUEST["campo"]);else	echo "Diccionario de palabras recuperables ";echo"</h4></center>"; ?><form name=diccionario method=post><input type=hidden name=campo value="<?php if (isset($_REQUEST["campo"])) echo urldecode($_REQUEST["campo"])?>">	<P><br><a href=Javascript:CancelarDiccionario()>Cancelar</a>  <table xwidth="640" border="0" cellspacing="0" cellpadding="0">    <tr>      <td width="20">&nbsp;</td>      <td colspan="2" valign="top" class="menusec1">		Use la tecla Ctrl o Shift para seleccionar mas de un termino      </td>      <td width="15" height="9">&nbsp;</td>    </tr>    <tr>      <td width="20">&nbsp;</td>      <td rowspan="2" width="5" align="left" valign="top">&nbsp;</td>      <td rowspan="2" xwidth="585" valign=top>        <table width="100%" border="0" cellspacing="0" cellpadding="0">          <tr>            <td xwidth=250>              <select name=terminos  size=16 multiple xwidth=250 style="font-size:12px">              <OPTION VALUE=""><?phpPresentarDiccionario();?></select>   <INPUT TYPE=HIDDEN VALUE="<?php echo $LastKey?>" NAME="LastKey">   <br> </td> <td width=10>&nbsp;</td> <td> 	Para avanzar a un termino específico, escriba las primeras letras 	<input type=text name="IR_A" size=10> y haga clic en &nbsp; 	<strong><a href="javascript:NavegarDiccionario(this,3)">Continuar</a></strong>.<?php if ($_REQUEST["Opcion"]!="avanzada"){?> 	<p><br>Al finalizar su seleccion haga clic sobre 	&nbsp; <strong><a href="javascript:EjecutarBusquedaDiccionario()">Buscar</a></strong>  para ejecutar la búsqueda con el o los términos seleccionados.<?php }if ($_REQUEST["Opcion"]=="avanzada"){?>  	<p><BR>Para enviar al formulario de búsqueda los términos seleccionados haga click en &nbsp;          	<a href=javascript:EnviarTerminos()><strong>Enviar</strong></a><?} ?>  </td>  </tr>  <tr>  <td align=center>&nbsp;&nbsp;<strong><a href="javascript:NavegarDiccionario(this,4)" class=boton>Más términos</a>&nbsp;&nbsp;  </td>  </tr>        </table>      </td>  </table><?phpforeach ($_REQUEST as $key=>$value){	if ($key!="IR_A" and $key!="LastKey" and $key!="Expresion" and $key!="Seleccionados")		echo "<input type=hidden name=$key value=\"".$value."\">\n";}echo "<input type=text name=Seleccionados value=\"";if (isset($_REQUEST["Seleccionados"])) echo $_REQUEST["Seleccionados"];echo "\">\n";?><input type=hidden name=Expresion></form></div><?php include("footer.php");echo "\n<script>Opcion='";if (isset($_REQUEST["Opcion"])) echo $_REQUEST["Opcion"];echo "'\n</script>\n";?>