<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
</head>
<body><div class="page"><p/>
<p>Christian&nbsp;Heumann&nbsp;&middot; Michael&nbsp;Schomaker
Shalabh
</p>
<p>Introduction to 
Statistics and 
Data Analysis 
With Exercises, Solutions and 
Applications in R</p>
<p/>
</div>
<div class="page"><p/>
<p>Introduction to Statistics and Data Analysis</p>
<p/>
</div>
<div class="page"><p/>
<p>Christian Heumann &bull; Michael Schomaker
Shalabh
</p>
<p>Introduction to Statistics
and Data Analysis
</p>
<p>With Exercises, Solutions
and Applications in R
</p>
<p>123</p>
<p/>
</div>
<div class="page"><p/>
<p>Christian Heumann
Department of Statistics
Ludwig-Maximilians-Universit&auml;t M&uuml;nchen
M&uuml;nchen
Germany
</p>
<p>Michael Schomaker
Centre for Infectious Disease Epidemiology
and Research
</p>
<p>University of Cape Town
Cape Town
South Africa
</p>
<p>Shalabh
Department of Mathematics and Statistics
Indian Institute of Technology Kanpur
Kanpur
India
</p>
<p>ISBN 978-3-319-46160-1 ISBN 978-3-319-46162-5 (eBook)
DOI 10.1007/978-3-319-46162-5
</p>
<p>Library of Congress Control Number: 2016955516
</p>
<p>&copy; Springer International Publishing Switzerland 2016
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part
of the material is concerned, specifically the rights of translation, reprinting, reuse of illustrations,
recitation, broadcasting, reproduction on microfilms or in any other physical way, and transmission
or information storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar
methodology now known or hereafter developed.
</p>
<p>The use of general descriptive names, registered names, trademarks, service marks, etc. in this
publication does not imply, even in the absence of a specific statement, that such names are exempt from
the relevant protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this
book are believed to be true and accurate at the date of publication. Neither the publisher nor the
authors or the editors give a warranty, express or implied, with respect to the material contained herein or
</p>
<p>for any errors or omissions that may have been made.
</p>
<p>Printed on acid-free paper
</p>
<p>This Springer imprint is published by Springer Nature
The registered company is Springer International Publishing AG
</p>
<p>The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland</p>
<p/>
</div>
<div class="page"><p/>
<p>Preface
</p>
<p>The success of the open-source statistical software &ldquo;R&rdquo; has made a significant
</p>
<p>impact on the teaching and research of statistics in the last decade. Analysing data is
</p>
<p>now easier and more affordable than ever, but choosing the most appropriate sta-
</p>
<p>tistical methods remains a challenge for many users. To understand and interpret
</p>
<p>software output, it is necessary to engage with the fundamentals of statistics.
</p>
<p>However, many readers do not feel comfortable with complicated mathematics.
</p>
<p>In this book, we attempt to find a healthy balance between explaining statistical
</p>
<p>concepts comprehensively and showing their application and interpretation using R.
</p>
<p>This book will benefit beginners and self-learners from various backgrounds as
</p>
<p>we complement each chapter with various exercises and detailed and comprehen-
</p>
<p>sible solutions. The results involving mathematics and rigorous proofs are separated
</p>
<p>from the main text, where possible, and are kept in an appendix for interested
</p>
<p>readers. Our textbook covers material that is generally taught in introductory-level
</p>
<p>statistics courses to students from various backgrounds, including sociology,
</p>
<p>biology, economics, psychology, medicine, and others. Most often, we introduce
</p>
<p>the statistical concepts using examples and illustrate the calculations both manually
</p>
<p>and using R.
</p>
<p>However, while we provide a gentle introduction to R (in the appendix), this is
</p>
<p>not a software book. Our emphasis lies on explaining statistical concepts correctly
</p>
<p>and comprehensively, using exercises and software to delve deeper into the subject
</p>
<p>matter and learn about the conceptual challenges that the methods present.
</p>
<p>This book&rsquo;s homepage, http://chris.userweb.mwn.de/book/, contains additional
</p>
<p>material, most notably the software codes needed to answer the software exercises,
</p>
<p>and data sets. In the remainder of this book, we will use grey boxes
</p>
<p>to introduce the relevant R commands. In many cases, the code can be directly
</p>
<p>pasted into R to reproduce the results and graphs presented in the book; in others,
</p>
<p>the code is abbreviated to improve readability and clarity, and the detailed code can
</p>
<p>be found online.
</p>
<p>v</p>
<p/>
</div>
<div class="page"><p/>
<p>Many years of teaching experience, from undergraduate to postgraduate level,
</p>
<p>went into this book. The authors hope that the reader will enjoy reading it and find it a
</p>
<p>useful reference for learning. We welcome critical feedback to improve future edi-
</p>
<p>tions of this book. Comments can be sent to christian.heumann@stat.uni-
</p>
<p>muenchen.de, shalab@iitk.ac.in, and michael.schomaker@uct.
</p>
<p>ac.za who contributed equally to this book.
</p>
<p>We thank Melanie Schomaker for producing some of the figures and giving
</p>
<p>graphical advice, Alice Blanck from Springer for her continuous help and support,
</p>
<p>and Lyn Imeson for her dedicated commitment which improved the earlier versions
</p>
<p>of this book. We are grateful to our families who have supported us during the
</p>
<p>preparation of this book.
</p>
<p>M&uuml;nchen, Germany Christian Heumann
</p>
<p>Cape Town, South Africa Michael Schomaker
</p>
<p>Kanpur, India Shalabh
</p>
<p>November 2016
</p>
<p>vi Preface</p>
<p/>
</div>
<div class="page"><p/>
<p>Contents
</p>
<p>Part I Descriptive Statistics
</p>
<p>1 Introduction and Framework . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3
</p>
<p>1.1 Population, Sample, and Observations . . . . . . . . . . . . . . . . . . . 3
</p>
<p>1.2 Variables. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4
</p>
<p>1.2.1 Qualitative and Quantitative Variables . . . . . . . . . . . . . 5
</p>
<p>1.2.2 Discrete and Continuous Variables . . . . . . . . . . . . . . . 6
</p>
<p>1.2.3 Scales . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
</p>
<p>1.2.4 Grouped Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
</p>
<p>1.3 Data Collection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
</p>
<p>1.4 Creating a Data Set. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
</p>
<p>1.4.1 Statistical Software . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
</p>
<p>1.5 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 13
</p>
<p>1.6 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
</p>
<p>2 Frequency Measures and Graphical Representation of Data . . . . . . 17
</p>
<p>2.1 Absolute and Relative Frequencies . . . . . . . . . . . . . . . . . . . . . . 17
</p>
<p>2.2 Empirical Cumulative Distribution Function . . . . . . . . . . . . . . . 19
</p>
<p>2.2.1 ECDF for Ordinal Variables . . . . . . . . . . . . . . . . . . . . 20
</p>
<p>2.2.2 ECDF for Continuous Variables . . . . . . . . . . . . . . . . . 22
</p>
<p>2.3 Graphical Representation of a Variable . . . . . . . . . . . . . . . . . . . 24
</p>
<p>2.3.1 Bar Chart . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
</p>
<p>2.3.2 Pie Chart . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
</p>
<p>2.3.3 Histogram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
</p>
<p>2.4 Kernel Density Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29
</p>
<p>2.5 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 32
</p>
<p>2.6 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
</p>
<p>3 Measures of Central Tendency and Dispersion . . . . . . . . . . . . . . . . . 37
</p>
<p>3.1 Measures of Central Tendency . . . . . . . . . . . . . . . . . . . . . . . . . 38
</p>
<p>3.1.1 Arithmetic Mean . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 38
</p>
<p>3.1.2 Median and Quantiles . . . . . . . . . . . . . . . . . . . . . . . . . 40
</p>
<p>3.1.3 Quantile&ndash;Quantile Plots (QQ-Plots) . . . . . . . . . . . . . . . 44
</p>
<p>3.1.4 Mode . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45
</p>
<p>vii</p>
<p/>
</div>
<div class="page"><p/>
<p>3.1.5 Geometric Mean . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
</p>
<p>3.1.6 Harmonic Mean . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
</p>
<p>3.2 Measures of Dispersion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
</p>
<p>3.2.1 Range and Interquartile Range. . . . . . . . . . . . . . . . . . . 49
</p>
<p>3.2.2 Absolute Deviation, Variance, and Standard
</p>
<p>Deviation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50
</p>
<p>3.2.3 Coefficient of Variation . . . . . . . . . . . . . . . . . . . . . . . . 55
</p>
<p>3.3 Box Plots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56
</p>
<p>3.4 Measures of Concentration . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57
</p>
<p>3.4.1 Lorenz Curve. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58
</p>
<p>3.4.2 Gini Coefficient . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
</p>
<p>3.5 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 63
</p>
<p>3.6 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63
</p>
<p>4 Association of Two Variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 67
</p>
<p>4.1 Summarizing the Distribution of Two Discrete Variables . . . . . 68
</p>
<p>4.1.1 Contingency Tables for Discrete Data . . . . . . . . . . . . . 68
</p>
<p>4.1.2 Joint, Marginal, and Conditional Frequency
</p>
<p>Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
</p>
<p>4.1.3 Graphical Representation of Two Nominal or
</p>
<p>Ordinal Variables. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72
</p>
<p>4.2 Measures of Association for Two Discrete Variables . . . . . . . . 74
</p>
<p>4.2.1 Pearson&rsquo;s χ2 Statistic . . . . . . . . . . . . . . . . . . . . . . . . . . 76
</p>
<p>4.2.2 Cramer&rsquo;s V Statistic. . . . . . . . . . . . . . . . . . . . . . . . . . . 77
</p>
<p>4.2.3 Contingency Coefficient C . . . . . . . . . . . . . . . . . . . . . . 77
</p>
<p>4.2.4 Relative Risks and Odds Ratios. . . . . . . . . . . . . . . . . . 78
</p>
<p>4.3 Association Between Ordinal and Continuous Variables. . . . . . 79
</p>
<p>4.3.1 Graphical Representation of Two Continuous
</p>
<p>Variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79
</p>
<p>4.3.2 Correlation Coefficient . . . . . . . . . . . . . . . . . . . . . . . . . 82
</p>
<p>4.3.3 Spearman&rsquo;s Rank Correlation Coefficient. . . . . . . . . . . 84
</p>
<p>4.3.4 Measures Using Discordant and Concordant Pairs . . . . 86
</p>
<p>4.4 Visualization of Variables from Different Scales. . . . . . . . . . . . 88
</p>
<p>4.5 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 89
</p>
<p>4.6 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90
</p>
<p>Part II Probability Calculus
</p>
<p>5 Combinatorics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
</p>
<p>5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 97
</p>
<p>5.2 Permutations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101
</p>
<p>5.2.1 Permutations without Replacement . . . . . . . . . . . . . . . 101
</p>
<p>5.2.2 Permutations with Replacement . . . . . . . . . . . . . . . . . . 101
</p>
<p>5.3 Combinations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
</p>
<p>viii Contents</p>
<p/>
</div>
<div class="page"><p/>
<p>5.3.1 Combinations without Replacement
</p>
<p>and without Consideration of the Order . . . . . . . . . . . . 102
</p>
<p>5.3.2 Combinations without Replacement
</p>
<p>and with Consideration of the Order . . . . . . . . . . . . . . 103
</p>
<p>5.3.3 Combinations with Replacement
</p>
<p>and without Consideration of the Order . . . . . . . . . . . . 103
</p>
<p>5.3.4 Combinations with Replacement
</p>
<p>and with Consideration of the Order . . . . . . . . . . . . . . 104
</p>
<p>5.4 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 105
</p>
<p>5.5 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
</p>
<p>6 Elements of Probability Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
</p>
<p>6.1 Basic Concepts and Set Theory . . . . . . . . . . . . . . . . . . . . . . . . 109
</p>
<p>6.2 Relative Frequency and Laplace Probability . . . . . . . . . . . . . . . 113
</p>
<p>6.3 The Axiomatic Definition of Probability . . . . . . . . . . . . . . . . . . 115
</p>
<p>6.3.1 Corollaries Following from Kolomogorov&rsquo;s
</p>
<p>Axioms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
</p>
<p>6.3.2 Calculation Rules for Probabilities. . . . . . . . . . . . . . . . 117
</p>
<p>6.4 Conditional Probability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
</p>
<p>6.4.1 Bayes&rsquo; Theorem. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
</p>
<p>6.5 Independence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
</p>
<p>6.6 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 123
</p>
<p>6.7 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
</p>
<p>7 Random Variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
</p>
<p>7.1 Random Variables. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127
</p>
<p>7.2 Cumulative Distribution Function (CDF) . . . . . . . . . . . . . . . . . 129
</p>
<p>7.2.1 CDF of Continuous Random Variables . . . . . . . . . . . . 129
</p>
<p>7.2.2 CDF of Discrete Random Variables . . . . . . . . . . . . . . 131
</p>
<p>7.3 Expectation and Variance of a Random Variable . . . . . . . . . . . 134
</p>
<p>7.3.1 Expectation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134
</p>
<p>7.3.2 Variance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
</p>
<p>7.3.3 Quantiles of a Distribution. . . . . . . . . . . . . . . . . . . . . . 137
</p>
<p>7.3.4 Standardization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 138
</p>
<p>7.4 Tschebyschev&rsquo;s Inequality . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
</p>
<p>7.5 Bivariate Random Variables . . . . . . . . . . . . . . . . . . . . . . . . . . . 140
</p>
<p>7.6 Calculation Rules for Expectation and Variance . . . . . . . . . . . . 144
</p>
<p>7.6.1 Expectation and Variance of the Arithmetic Mean . . . 145
</p>
<p>7.7 Covariance and Correlation. . . . . . . . . . . . . . . . . . . . . . . . . . . . 146
</p>
<p>7.7.1 Covariance. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
</p>
<p>7.7.2 Correlation Coefficient . . . . . . . . . . . . . . . . . . . . . . . . . 148
</p>
<p>7.8 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 149
</p>
<p>7.9 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149
</p>
<p>Contents ix</p>
<p/>
</div>
<div class="page"><p/>
<p>8 Probability Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
</p>
<p>8.1 Standard Discrete Distributions . . . . . . . . . . . . . . . . . . . . . . . . . 154
</p>
<p>8.1.1 Discrete Uniform Distribution . . . . . . . . . . . . . . . . . . . 154
</p>
<p>8.1.2 Degenerate Distribution . . . . . . . . . . . . . . . . . . . . . . . . 156
</p>
<p>8.1.3 Bernoulli Distribution . . . . . . . . . . . . . . . . . . . . . . . . . 156
</p>
<p>8.1.4 Binomial Distribution . . . . . . . . . . . . . . . . . . . . . . . . . 157
</p>
<p>8.1.5 Poisson Distribution. . . . . . . . . . . . . . . . . . . . . . . . . . . 160
</p>
<p>8.1.6 Multinomial Distribution . . . . . . . . . . . . . . . . . . . . . . . 161
</p>
<p>8.1.7 Geometric Distribution . . . . . . . . . . . . . . . . . . . . . . . . 163
</p>
<p>8.1.8 Hypergeometric Distribution . . . . . . . . . . . . . . . . . . . . 163
</p>
<p>8.2 Standard Continuous Distributions . . . . . . . . . . . . . . . . . . . . . . 165
</p>
<p>8.2.1 Continuous Uniform Distribution. . . . . . . . . . . . . . . . . 165
</p>
<p>8.2.2 Normal Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . 166
</p>
<p>8.2.3 Exponential Distribution . . . . . . . . . . . . . . . . . . . . . . . 170
</p>
<p>8.3 Sampling Distributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
</p>
<p>8.3.1 χ2-Distribution. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
</p>
<p>8.3.2 t-Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172
</p>
<p>8.3.3 F-Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
</p>
<p>8.4 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 174
</p>
<p>8.5 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
</p>
<p>Part III Inductive Statistics
</p>
<p>9 Inference . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
</p>
<p>9.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 181
</p>
<p>9.2 Properties of Point Estimators . . . . . . . . . . . . . . . . . . . . . . . . . . 183
</p>
<p>9.2.1 Unbiasedness and Efficiency . . . . . . . . . . . . . . . . . . . . 183
</p>
<p>9.2.2 Consistency of Estimators . . . . . . . . . . . . . . . . . . . . . . 189
</p>
<p>9.2.3 Sufficiency of Estimators . . . . . . . . . . . . . . . . . . . . . . . 190
</p>
<p>9.3 Point Estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
</p>
<p>9.3.1 Maximum Likelihood Estimation. . . . . . . . . . . . . . . . . 192
</p>
<p>9.3.2 Method of Moments . . . . . . . . . . . . . . . . . . . . . . . . . . 195
</p>
<p>9.4 Interval Estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
</p>
<p>9.4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
</p>
<p>9.4.2 Confidence Interval for the Mean of a Normal
</p>
<p>Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197
</p>
<p>9.4.3 Confidence Interval for a Binomial Probability . . . . . . 199
</p>
<p>9.4.4 Confidence Interval for the Odds Ratio . . . . . . . . . . . . 201
</p>
<p>9.5 Sample Size Determinations . . . . . . . . . . . . . . . . . . . . . . . . . . . 203
</p>
<p>9.6 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 205
</p>
<p>9.7 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 205
</p>
<p>10 Hypothesis Testing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209
</p>
<p>10.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 209
</p>
<p>10.2 Basic Definitions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210
</p>
<p>x Contents</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2.1 One- and Two-Sample Problems . . . . . . . . . . . . . . . . . 210
</p>
<p>10.2.2 Hypotheses . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210
</p>
<p>10.2.3 One- and Two-Sided Tests . . . . . . . . . . . . . . . . . . . . . 211
</p>
<p>10.2.4 Type I and Type II Error . . . . . . . . . . . . . . . . . . . . . . . 213
</p>
<p>10.2.5 How to Conduct a Statistical Test . . . . . . . . . . . . . . . . 214
</p>
<p>10.2.6 Test Decisions Using the p-Value . . . . . . . . . . . . . . . . 215
</p>
<p>10.2.7 Test Decisions Using Confidence Intervals . . . . . . . . . 216
</p>
<p>10.3 Parametric Tests for Location Parameters . . . . . . . . . . . . . . . . . 216
</p>
<p>10.3.1 Test for the Mean When the Variance
</p>
<p>is Known (One-Sample Gauss Test) . . . . . . . . . . . . . . 216
</p>
<p>10.3.2 Test for the Mean When the Variance
</p>
<p>is Unknown (One-Sample t-Test) . . . . . . . . . . . . . . . . 219
</p>
<p>10.3.3 Comparing the Means of Two Independent
</p>
<p>Samples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221
</p>
<p>10.3.4 Test for Comparing the Means
</p>
<p>of Two Dependent Samples (Paired t-Test) . . . . . . . . . 225
</p>
<p>10.4 Parametric Tests for Probabilities . . . . . . . . . . . . . . . . . . . . . . . 227
</p>
<p>10.4.1 One-Sample Binomial Test for the Probability p . . . . . 227
</p>
<p>10.4.2 Two-Sample Binomial Test . . . . . . . . . . . . . . . . . . . . . 230
</p>
<p>10.5 Tests for Scale Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . 232
</p>
<p>10.6 Wilcoxon&ndash;Mann&ndash;Whitney (WMW) U-Test . . . . . . . . . . . . . . . 232
</p>
<p>10.7 χ2-Goodness-of-Fit Test . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235
</p>
<p>10.8 χ2-Independence Test and Other χ2-Tests. . . . . . . . . . . . . . . . . 238
</p>
<p>10.9 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 242
</p>
<p>10.10 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 242
</p>
<p>11 Linear Regression . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 249
</p>
<p>11.1 The Linear Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 250
</p>
<p>11.2 Method of Least Squares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 252
</p>
<p>11.2.1 Properties of the Linear Regression Line . . . . . . . . . . . 255
</p>
<p>11.3 Goodness of Fit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 256
</p>
<p>11.4 Linear Regression with a Binary Covariate . . . . . . . . . . . . . . . . 259
</p>
<p>11.5 Linear Regression with a Transformed Covariate . . . . . . . . . . . 261
</p>
<p>11.6 Linear Regression with Multiple Covariates . . . . . . . . . . . . . . . 262
</p>
<p>11.6.1 Matrix Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 263
</p>
<p>11.6.2 Categorical Covariates . . . . . . . . . . . . . . . . . . . . . . . . . 265
</p>
<p>11.6.3 Transformations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 267
</p>
<p>11.7 The Inductive View of Linear Regression. . . . . . . . . . . . . . . . . 269
</p>
<p>11.7.1 Properties of Least Squares and Maximum
</p>
<p>Likelihood Estimators . . . . . . . . . . . . . . . . . . . . . . . . . 273
</p>
<p>11.7.2 The ANOVA Table . . . . . . . . . . . . . . . . . . . . . . . . . . . 274
</p>
<p>11.7.3 Interactions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 276
</p>
<p>11.8 Comparing Different Models. . . . . . . . . . . . . . . . . . . . . . . . . . . 280
</p>
<p>11.9 Checking Model Assumptions . . . . . . . . . . . . . . . . . . . . . . . . . 285
</p>
<p>Contents xi</p>
<p/>
</div>
<div class="page"><p/>
<p>11.10 Association Versus Causation . . . . . . . . . . . . . . . . . . . . . . . . . . 288
</p>
<p>11.11 Key Points and Further Issues . . . . . . . . . . . . . . . . . . . . . . . . . 289
</p>
<p>11.12 Exercises. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 290
</p>
<p>Appendix A: Introduction to R . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 297
</p>
<p>Appendix B: Solutions to Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 321
</p>
<p>Appendix C: Technical Appendix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 423
</p>
<p>Appendix D: Visual Summaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 443
</p>
<p>References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 449
</p>
<p>Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 451
</p>
<p>xii Contents</p>
<p/>
</div>
<div class="page"><p/>
<p>About the Authors
</p>
<p>Prof. Christian Heumann is a professor at the Ludwig-Maximilians-Universit&auml;t
</p>
<p>M&uuml;nchen, Germany, where he teaches students in Bachelor and Master programs
</p>
<p>offered by the Department of Statistics, as well as undergraduate students in the
</p>
<p>Bachelor of Science programs in business administration and economics. His
</p>
<p>research interests include statistical modeling, computational statistics and all
</p>
<p>aspects of missing data.
</p>
<p>Dr. Michael Schomaker is a Senior Researcher and Biostatistician at the Centre
</p>
<p>for Infectious Disease Epidemiology &amp; Research (CIDER), University of Cape
</p>
<p>Town, South Africa. He received his doctoral degree from the University of
</p>
<p>Munich. He has taught undergraduate students for many years and has written
</p>
<p>contributions for various introductory textbooks. His research focuses on missing
</p>
<p>data, causal inference, model averaging and HIV/AIDS.
</p>
<p>Prof. Shalabh is a Professor at the Indian Institute of Technology Kanpur, India.
</p>
<p>He received his Ph.D. from the University of Lucknow (India) and completed his
</p>
<p>post-doctoral work at the University of Pittsburgh (USA) and University of Munich
</p>
<p>(Germany). He has over twenty years of experience in teaching and research. His
</p>
<p>main research areas are linear models, regression analysis, econometrics, mea-
</p>
<p>surement error models, missing data models and sampling theory.
</p>
<p>xiii</p>
<p/>
</div>
<div class="page"><p/>
<p>Part I
</p>
<p>Descriptive Statistics</p>
<p/>
</div>
<div class="page"><p/>
<p>1Introduction and Framework
</p>
<p>Statistics is a collection of methods which help us to describe, summarize, interpret,
</p>
<p>and analyse data. Drawing conclusions from data is vital in research, administra-
</p>
<p>tion, and business. Researchers are interested in understanding whether a medical
</p>
<p>intervention helps in reducing the burden of a disease, how personality relates to
</p>
<p>decision-making, whether a new fertilizer increases the yield of crops, how a polit-
</p>
<p>ical system affects trade policy, who is going to vote for a political party in the
</p>
<p>next election, what are the long-term changes in the population of a fish species,
</p>
<p>and many more questions. Governments and organizations may be interested in the
</p>
<p>life expectancy of a population, the risk factors for infant mortality, geographical
</p>
<p>differences in energy usage, migration patterns, or reasons for unemployment. In
</p>
<p>business, identifying people who may be interested in a certain product, optimizing
</p>
<p>prices, and evaluating the satisfaction of customers are possible areas of interest.
</p>
<p>No matter what the question of interest is, it is important to collect data in a
</p>
<p>way which allows its analysis. The representation of collected data in a data set or
</p>
<p>data matrix allows the application of a variety of statistical methods. In the first
</p>
<p>part of the book, we are going to introduce methods which help us in describing
</p>
<p>data, and the second and third parts of the book focus on inferential statistics, which
</p>
<p>means drawing conclusions from data. In this chapter, we are going to introduce the
</p>
<p>framework of statistics which is needed to properly collect, administer, evaluate, and
</p>
<p>analyse data.
</p>
<p>1.1 Population, Sample, and Observations
</p>
<p>Let us first introduce some terminology and related notations used in this book.
</p>
<p>The units on which we measure data&mdash;such as persons, cars, animals, or plants&mdash;
</p>
<p>are called observations. These units/observations are represented by the Greek
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_1
</p>
<p>3</p>
<p/>
</div>
<div class="page"><p/>
<p>4 1 Introduction and Framework
</p>
<p>symbol ω. The collection of all units is called population and is represented by Ω .
</p>
<p>When we refer to ω &isin; Ω , we mean a single unit out of all units, e.g. one person out of
</p>
<p>all persons of interest. If we consider a selection of observations ω1,ω2, . . . ,ωn , then
</p>
<p>these observations are called sample. A sample is always a subset of the population,
</p>
<p>{ω1,ω2, . . . ,ωn} &sube; Ω .
</p>
<p>Example 1.1.1
</p>
<p>&bull; If we are interested in the social conditions under which Indian people live, then
</p>
<p>we would define all inhabitants of India as Ω and each of its inhabitants as ω. If we
</p>
<p>want to collect data from a few inhabitants, then those would represent a sample
</p>
<p>from the total population.
</p>
<p>&bull; Investigating the economic power of Africa&rsquo;s platinum industry would require to
</p>
<p>treat each platinum-related company as ω, whereas all platinum-related companies
</p>
<p>would be collected in Ω . A few companies ω1,ω2, . . . ,ωn comprise a sample of
</p>
<p>all companies.
</p>
<p>&bull; We may be interested in collecting information about those participating in a
</p>
<p>statistics course. All participants in the course constitute the population Ω , and
</p>
<p>each participant refers to a unit or observation ω.
</p>
<p>Remark 1.1.1 Sometimes, the concept of a population is not applicable or difficult
</p>
<p>to imagine. As an example, imagine that we measure the temperature in New Delhi
</p>
<p>every hour. A sample would then be the time series of temperatures in a specific
</p>
<p>time window, for example from January to March 2016. A population in the sense of
</p>
<p>observational units does not exist here. But now assume that we measure temperatures
</p>
<p>in several different cities; then, all the cities form the population, and a sample is any
</p>
<p>subset of the cities.
</p>
<p>1.2 Variables
</p>
<p>If we have specified the population of interest for a specific research question, we
</p>
<p>can think of what is of interest about our observations. A particular feature of these
</p>
<p>observations can be collected in a statistical variable X . Any information we are
</p>
<p>interested in may be captured in such a variable. For example, if our observations
</p>
<p>refer to human beings, X may describe marital status, gender, age, or anything else
</p>
<p>which may relate to a person. Of course, we can be interested in many different
</p>
<p>features, each of them collected in a different variable X i , i = 1, 2, . . . , p. Each
</p>
<p>observation ω takes a particular value for X . If X refers to gender, each observation,
</p>
<p>i.e. each person, has a particular value x which refers to either &ldquo;male&rdquo; or &ldquo;female&rdquo;.
</p>
<p>The formal definition of a variable is
</p>
<p>X : Ω &rarr; S
</p>
<p>ω �&rarr; x
(1.1)</p>
<p/>
</div>
<div class="page"><p/>
<p>1.2 Variables 5
</p>
<p>This definition states that a variable X takes a value x for each observation ω &isin; Ω ,
</p>
<p>whereby the number of possible values is contained in the set S.
</p>
<p>Example 1.2.1
</p>
<p>&bull; If X refers to gender, possible x-values are contained in S = {male, female}. Each
</p>
<p>observation ω is either male or female, and this information is summarized in X .
</p>
<p>&bull; Let X be the country of origin for a car. Possible values to be taken by an observation
</p>
<p>ω (i.e. a car) are S = {Italy,South Korea,Germany,France, India,China, Japan,
</p>
<p>USA, . . .}.
</p>
<p>&bull; A variable X which refers to age may take any value between 1 and 125. Each
</p>
<p>person ω is assigned a value x which represents the age of this person.
</p>
<p>1.2.1 Qualitative and Quantitative Variables
</p>
<p>Qualitative variables are the variables which take values x that cannot be ordered in
</p>
<p>a logical or natural way. For example,
</p>
<p>&bull; the colour of the eye,
</p>
<p>&bull; the name of a political party, and
</p>
<p>&bull; the type of transport used to travel to work
</p>
<p>are all qualitative variables. Neither is there any reason to list blue eyes before brown
</p>
<p>eyes (or vice versa) nor does it make sense to list buses before trains (or vice versa).
</p>
<p>Quantitative variables represent measurable quantities. The values which these
</p>
<p>variables can take can be ordered in a logical and natural way. Examples of quanti-
</p>
<p>tative variables are
</p>
<p>&bull; size of shoes,
</p>
<p>&bull; price for houses,
</p>
<p>&bull; number of semesters studied, and
</p>
<p>&bull; weight of a person.
</p>
<p>Remark 1.2.1 It is common to assign numbers to qualitative variables for practical
</p>
<p>purposes in data analyses (see Sect. 1.4 for more detail). For instance, if we consider
</p>
<p>the variable &ldquo;gender&rdquo;, then each observation can take either the &ldquo;value&rdquo; male or
</p>
<p>female. We may decide to assign 1 to female and 0 to male and use these numbers
</p>
<p>instead of the original categories. However, this is arbitrary, and we could have also
</p>
<p>chosen &ldquo;1&rdquo; for male and &ldquo;0&rdquo; for female, or &ldquo;2&rdquo; for male and &ldquo;10&rdquo; for female. There
</p>
<p>is no logical and natural order on how to arrange male and female, and thus, the
</p>
<p>variable gender remains a qualitative variable, even after using numbers for coding
</p>
<p>the values that X can take.</p>
<p/>
</div>
<div class="page"><p/>
<p>6 1 Introduction and Framework
</p>
<p>1.2.2 Discrete and Continuous Variables
</p>
<p>Discrete variables are variables which can only take a finite number of values.
</p>
<p>All qualitative variables are discrete, such as the colour of the eye or the region of
</p>
<p>a country. But also quantitative variables can be discrete: the size of shoes or the
</p>
<p>number of semesters studied would be discrete because the number of values these
</p>
<p>variables can take is limited.
</p>
<p>Variables which can take an infinite number of values are called continuous
</p>
<p>variables. Examples are the time it takes to travel to university, the length of an
</p>
<p>antelope, and the distance between two planets. Sometimes, it is said that continuous
</p>
<p>variables are variables which are &ldquo;measured rather than counted&rdquo;. This is a rather
</p>
<p>informal definition which helps to understand the difference between discrete and
</p>
<p>continuous variables. The crucial point is that continuous variables can, in theory,
</p>
<p>take an infinite number of values; for instance, the height of a person may be recorded
</p>
<p>as 172 cm. However, the actual height on the measuring tape might be 172.3 cm which
</p>
<p>was rounded off to 172 cm. If one had a better measuring instrument, we may have
</p>
<p>obtained 172.342 cm. But the real height of this person is a number with indefinitely
</p>
<p>many decimal places such as 172.342975328&hellip; cm. No matter what we eventually
</p>
<p>report or obtain, a variable which can take an infinite amount of values is defined to
</p>
<p>be a continuous variable.
</p>
<p>1.2.3 Scales
</p>
<p>The thoughts and considerations from above indicate that different variables contain
</p>
<p>different amounts of information. A useful classification of these considerations is
</p>
<p>given by the concept of the scale of a variable. This concept will help us in the
</p>
<p>remainder of this book to identify which methods are the appropriate ones to use in
</p>
<p>a particular setting.
</p>
<p>Nominal scale. The values of a nominal variable cannot be ordered. Examples are
</p>
<p>the gender of a person (male&ndash;female) or the status of an application (pending&ndash;not
</p>
<p>pending).
</p>
<p>Ordinal scale. The values of an ordinal variable can be ordered. However, the differ-
</p>
<p>ences between these values cannot be interpreted in a meaningful way. For exam-
</p>
<p>ple, the possible values of education level (none&ndash;primary education&ndash;secondary
</p>
<p>education&ndash;university degree) can be ordered meaningfully, but the differences
</p>
<p>between these values cannot be interpreted. Likewise, the satisfaction with a prod-
</p>
<p>uct (unsatisfied&ndash;satisfied&ndash;very satisfied) is an ordinal variable because the values
</p>
<p>this variable can take can be ordered, but the differences between &ldquo;unsatisfied&ndash;
</p>
<p>satisfied&rdquo; and &ldquo;satisfied&ndash;very satisfied&rdquo; cannot be compared in a numerical way.
</p>
<p>Continuous scale. The values of a continuous variable can be ordered. Furthermore,
</p>
<p>the differences between these values can be interpreted in a meaningful way. For
</p>
<p>instance, the height of a person refers to a continuous variable because the values
</p>
<p>can be ordered (170 cm, 171 cm, 172 cm, &hellip;), and differences between these</p>
<p/>
</div>
<div class="page"><p/>
<p>1.2 Variables 7
</p>
<p>values can be compared (the difference between 170 and 171 cm is the same
</p>
<p>as the difference between 171 and 172 cm). Sometimes, the continuous scale is
</p>
<p>divided further into subscales. While in the remainder of the book we typically
</p>
<p>do not need these classifications, it is still useful to reflect on them:
</p>
<p>Interval scale. Only differences between values, but not ratios, can be interpreted.
</p>
<p>An example for this scale would be temperature (measured in ◦C): the difference
</p>
<p>between &minus;2 ◦C and 4 ◦C is 6 ◦C, but the ratio of 4/&minus; 2 = &minus;2 does not mean that
</p>
<p>&minus;4 ◦C is twice as cold as 2 ◦C.
</p>
<p>Ratio scale. Both differences and ratios can be interpreted. An example is speed:
</p>
<p>60 km/h is 40 km/h more than 20 km/h. Moreover, 60 km/h is three times faster
</p>
<p>than 20 km/h because the ratio between them is 3.
</p>
<p>Absolute scale. The absolute scale is the same as the ratio scale, with the excep-
</p>
<p>tion that the values are measured in &ldquo;natural&rdquo; units. An example is &ldquo;number of
</p>
<p>semesters studied&rdquo; where no artificial unit such as km/h or ◦C is needed: the
</p>
<p>values are simply 1, 2, 3, . . ..
</p>
<p>1.2.4 Grouped Data
</p>
<p>Sometimes, data may be available only in a summarized form: instead of the original
</p>
<p>value, one may only know the category or group the value belongs to. For example,
</p>
<p>&bull; it is often convenient in a survey to ask for the income (per year) by means of
</p>
<p>groups: [e0&ndash;e20,000), [e20,000&ndash;e30,000), . . ., &gt; e100,000;
</p>
<p>&bull; if there are many political parties in an election, those with a low number of voters
</p>
<p>are often summarized in a new category &ldquo;Other Parties&rdquo;;
</p>
<p>&bull; instead of capturing the number of claims made by an insurance company customer,
</p>
<p>the variable &ldquo;claimed&rdquo; may denote whether or not the customer claimed at all
</p>
<p>(yes&ndash;no).
</p>
<p>If data is available in grouped form, we call the respective variable capturing
</p>
<p>this information a grouped variable. Sometimes, these variables are also known as
</p>
<p>categorical variables. This is, however, not a complete definition because categorical
</p>
<p>variables refer to any type of variable which takes a finite, possibly small, number of
</p>
<p>values. Thus, any discrete and/or nominal and/or ordinal and/or qualitative variable
</p>
<p>may be regarded as a categorical variable. Any grouped or categorical variable which
</p>
<p>can only take two values is called a binary variable.
</p>
<p>To gain a better understanding on how the definitions from the above sections
</p>
<p>relate to each other see Fig. 1.1. Qualitative data is always discrete, but quantitative
</p>
<p>data can be both discrete (e.g. size of shoes or a grouped variable) and continuous
</p>
<p>(e.g. temperature). Nominal variables are always qualitative and discrete (e.g. colour
</p>
<p>of the eye), whereas continuous variables are always quantitative (e.g. temperature).
</p>
<p>Categorical variables can be both qualitative (e.g. colour of the eye) and quantitative
</p>
<p>(satisfaction level on a scale from 1 to 5). Categorical variables are never continuous.</p>
<p/>
</div>
<div class="page"><p/>
<p>8 1 Introduction and Framework
</p>
<p>Fig. 1.1 Summary of variable classifications
</p>
<p>1.3 Data Collection
</p>
<p>When collecting data, we may ask ourselves how to facilitate this in detail and
</p>
<p>how much data needs to be collected. The latter question will be partly answered
</p>
<p>in Sect. 9.5; but in general, we can think of collecting data either on all subjects of
</p>
<p>interest, such as in a national census, or on a representative sample of the population.
</p>
<p>Most commonly, we gather data on a sample (described in the Part I of this book) and
</p>
<p>then draw conclusions about the population of interest (discussed in the Part III of
</p>
<p>this book). A sample might either be chosen by us or obtained through third parties
</p>
<p>(hospitals, government agencies), or created during an experiment. This depends on
</p>
<p>the context as described below.
</p>
<p>Survey. A survey typically (but not always) collects data by asking questions (in
</p>
<p>person or by phone) or providing questionnaires to study participants (as a printout
</p>
<p>or online). For example, an opinion poll before a national election provides evidence
</p>
<p>about the future government: potential voters are asked by phone which party they are
</p>
<p>going to vote for in the next election; on the day of the election, this information can
</p>
<p>be updated by asking the same question to a sample of voters who have just delivered
</p>
<p>their vote at the polling station (so-called exit poll). A behavioural research survey
</p>
<p>may ask members of a community about their knowledge and attitudes towards drug
</p>
<p>use. For this purpose, the study coordinators can send people with a questionnaire
</p>
<p>to this community and interview members of randomly selected households.
</p>
<p>Ideally, a survey is conducted in a way which makes the chosen sample repre-
</p>
<p>sentative of the population of interest. If a marketing company interviews people in
</p>
<p>a pedestrian zone to find their views about a new chocolate bar, then these people</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>1.3 Data Collection 9
</p>
<p>may not be representative of those who will potentially be interested in this product.
</p>
<p>Similarly, if students are asked to fill in an online survey to evaluate a lecture, it
</p>
<p>may turn out that those who participate are on average less satisfied than those who
</p>
<p>do not. Survey sampling is a complex topic on its own. The interested reader may
</p>
<p>consult Groves et al. (2009) or Kauermann and K&uuml;chenhoff (2011).
</p>
<p>Experiment. Experimental data is obtained in &ldquo;controlled&rdquo; settings. This can mean
</p>
<p>many things, but essentially it is data which is generated by the researcher with full
</p>
<p>control over one or many variables of interest. For instance, suppose there are two
</p>
<p>competing toothpastes, both of which promise to reduce pain for people with sensitive
</p>
<p>teeth. If the researcher decided to randomly assign toothpaste A to half of the study
</p>
<p>participants, and toothpaste B to the other half, then this is an experiment because
</p>
<p>it is only the researcher who decides which toothpaste is to be used by any of the
</p>
<p>participants. It is not decided by the participant. The data of the variable toothpaste
</p>
<p>is controlled by the experimenter. Consider another example where the production
</p>
<p>process of a product can potentially be reduced by combining two processes. The
</p>
<p>management could decide to implement the new process in three production facilities,
</p>
<p>but leave it as it is in the other facilities. The production process for the different
</p>
<p>units (facilities) is therefore under control of the management. However, if each
</p>
<p>facility could decide for themselves if they wanted a change or not, it would not be
</p>
<p>an experiment because factors not directly controlled by the management, such as the
</p>
<p>leadership style of the facility manager, would determine which process is chosen.
</p>
<p>Observational Data. Observational data is data which is collected routinely, without
</p>
<p>a researcher designing a survey or conducting an experiment. Suppose a blood sample
</p>
<p>is drawn from each patient with a particular acute infection when they arrive at a
</p>
<p>hospital. This data may be stored in the hospital&rsquo;s folders and later accessed by a
</p>
<p>researcher who is interested in studying this infection. Or suppose a government
</p>
<p>institution monitors where people live and move to. This data can later be used to
</p>
<p>explore migration patterns.
</p>
<p>Primary and Secondary Data. Primary data is data we collect ourselves, i.e. via a
</p>
<p>survey or experiment. Secondary data, in contrast, is collected by someone else. For
</p>
<p>example, data from a national census, publicly available databases, previous research
</p>
<p>studies, government reports, historical data, and data from the internet, among others,
</p>
<p>are secondary data.
</p>
<p>1.4 Creating a Data Set
</p>
<p>There is a unique way in which data is prepared and collected to utilize statistical
</p>
<p>analyses. The data is stored in a data matrix (=data set) with p columns and n rows
</p>
<p>(see Fig. 1.2). Each row corresponds to an observation/unit ω and each column to
</p>
<p>a variable X . This means that, for example, the entry in the fourth row and second
</p>
<p>column (x42) describes the value of the fourth observation on the second variable.
</p>
<p>The examples below will illustrate the concept of a data set in more detail.</p>
<p/>
</div>
<div class="page"><p/>
<p>10 1 Introduction and Framework
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>ω Variable 1 Variable 2 &middot; &middot; &middot; Variable p
</p>
<p>1 x11 x12 &middot; &middot; &middot; x1p
2 x21 x22 &middot; &middot; &middot; x2p
...
</p>
<p>...
...
</p>
<p>...
n xn1 xn2 &middot; &middot; &middot; xnp
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>Fig. 1.2 Data set or data matrix
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>ω Music Mathematics Biology Geography
</p>
<p>StudentA 65 70 85 45
StudentB 77 82 80 60
StudentC 78 73 93 68
StudentD 88 71 63 58
StudentE 75 83 63 57
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>Fig. 1.3 Data set of marks of five students
</p>
<p>Example 1.4.1 Suppose five students take examinations in music, mathematics, biol-
</p>
<p>ogy, and geography. Their marks, measured on a scale between 0 and 100 (where
</p>
<p>100 is the best mark), can be written down as illustrated in Fig. 1.3. Note that each
</p>
<p>row refers to a student and each column to a variable. We consider a larger data set
</p>
<p>in the next example.
</p>
<p>Example 1.4.2 Consider the data set described in Appendix A.4. A pizza delivery
</p>
<p>service captures information related to each delivery, for example the delivery time,
</p>
<p>the temperature of the pizza, the name of the driver, the date of the delivery, the
</p>
<p>name of the branch, and many more. To capture the data of all deliveries during one
</p>
<p>month, we create a data matrix. Each row refers to a particular delivery, therefore
</p>
<p>representing the observations of the data. Each column refers to a variable. In Fig. 1.4,
</p>
<p>the variables X1 (delivery time in minutes), X2 (temperature in
◦C), and X12 (name
</p>
<p>of branch) are listed.
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>Delivery Delivery Time Temperature &middot; &middot; &middot; Branch
</p>
<p>1 35.1 68.3 &middot; &middot; &middot; East (1)
2 25.2 71.0 &middot; &middot; &middot; East (1)
...
</p>
<p>...
...
</p>
<p>...
1266 35.7 60.8 &middot; &middot; &middot; West (2)
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>Fig. 1.4 Pizza data set</p>
<p/>
</div>
<div class="page"><p/>
<p>1.4 Creating a Data Set 11
</p>
<p>Table 1.1 Coding list for
</p>
<p>branch
Variable Values Code
</p>
<p>Branch East 1
</p>
<p>West 2
</p>
<p>Centre 3
</p>
<p>Missing 4
</p>
<p>The first row tells us about the features of the first pizza delivery: the delivery
</p>
<p>time was 35.1 min, the pizza arrived with a temperature of 68.3 ◦C, and the pizza
</p>
<p>was delivered from the branch in the East of the city. In total, there were n = 1266
</p>
<p>deliveries. For nominal variables, such as branch, we may decide to produce a coding
</p>
<p>list, as illustrated in Table 1.1: instead of referring to the branches as &ldquo;East&rdquo;, &ldquo;West&rdquo;,
</p>
<p>and &ldquo;Centre&rdquo;, we may simply call them 1, 2, and 3. As we will see in Chap. 11, this
</p>
<p>has benefits for some analysis methods, though this is not needed in general.
</p>
<p>If some values are missing, for example because they were never captured or even
</p>
<p>lost, then this requires special attention. In Table 1.1, we assign missing values the
</p>
<p>number &ldquo;4&rdquo; and therefore treat them as a separate category. If we work with statistical
</p>
<p>software (see below), we may need other coding such as NA in the statistical software
</p>
<p>R or in Stata. More detail can be found in Appendix A.
</p>
<p>Another consideration when collecting data is that of transformations: we may
</p>
<p>have captured the velocity of cars in kilometres per hour, but may need to present
</p>
<p>the data in miles per hour; we have captured the temperature in degrees Celsius,
</p>
<p>whereas we need to communicate results in degrees Fahrenheit, or we have created a
</p>
<p>satisfaction score which we want to range from &minus;5 to +5, while the score currently
</p>
<p>runs from 0 to 20. This is not a problem at all. We can simply create a new variable
</p>
<p>which reflects the required transformation. However, valid transformations depend
</p>
<p>on the scale of a variable. Variables on an interval scale can use transformations of
</p>
<p>the following kind:
</p>
<p>g(x) = a + bx, b &gt; 0. (1.2)
</p>
<p>For ratio scales, only the following transformations are valid:
</p>
<p>g(x) = bx, b &gt; 0. (1.3)
</p>
<p>In the above equation, a is set to 0 because ratios only stay the same if we respect a
</p>
<p>variable&rsquo;s natural point of origin.
</p>
<p>Example 1.4.3 The temperature in ◦F relates to the temperature in ◦C as follows:
</p>
<p>Temperature in ◦F = 32 + 1.8 Temperature in ◦C
</p>
<p>g(x) = a + b x
</p>
<p>This means that 25 ◦C relates to (32 + 1.8 &middot; 25) ◦F = 77 ◦F. If X1 is a variable
</p>
<p>representing temperature by ◦C, we can simply create a new variable X2 which is
</p>
<p>temperature in ◦F. Since temperature is measured on an interval scale, this transfor-
</p>
<p>mation is valid.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>12 1 Introduction and Framework
</p>
<p>Changing currencies is also possible. If we would like to represent the price of a
</p>
<p>product not in South African Rand but in e, we simply apply the transformation
</p>
<p>Price in South African Rand = b &middot; Price in e
</p>
<p>whereby b is the currency exchange rate.
</p>
<p>1.4.1 Statistical Software
</p>
<p>There are number of statistical software packages which allow data collection, man-
</p>
<p>agement, and&ndash;most importantly&ndash;analysis. In this book, we focus on the statistical
</p>
<p>software R which is freely available at http://cran.r-project.org/. A gentle introduc-
</p>
<p>tion to R is provided in Appendix A. A data matrix can be created manually using
</p>
<p>commands such as matrix(), data.frame(), and others. Any data can be edited
</p>
<p>using edit(). However, typically analysts have already typed their data into data-
</p>
<p>bases or spreadsheets, for example in Excel, Access, or MySQL. In most of these
</p>
<p>applications, it is possible to save the data as an ASCII file (.dat), as a tab-delimited
</p>
<p>file (.txt), or as a comma-separated values file (.csv). All of these formats allow easy
</p>
<p>switching between different software and database applications. Such data can easily
</p>
<p>be read into R by means of the following commands:
</p>
<p>setwd('C:/directory')
</p>
<p>read.table('pizza_delivery.dat')
</p>
<p>read.table('pizza_delivery.txt')
</p>
<p>read.csv('pizza_delivery.csv')
</p>
<p>where setwd specifies the working directory. Alternatively, loading the library
</p>
<p>foreign allows the import of data from many different statistical software pack-
</p>
<p>ages, notably Stata, SAS, Minitab, SPSS, among others. A detailed description of
</p>
<p>data import and export can be found in the respective R manual available at http://
</p>
<p>cran.r-project.org/doc/manuals/r-release/R-data.pdf. Once the data is read into R,
</p>
<p>it can be viewed with
</p>
<p>fix() # option 1
</p>
<p>View() # option 2
</p>
<p>We can also can get an overview of the data directly in the R-console by displaying
</p>
<p>only the top lines of the data with head(). Both approaches are visualized in Fig. 1.5
</p>
<p>for the pizza data introduced in Example 1.4.2.</p>
<p/>
<div class="annotation"><a href="http://cran.r-project.org/">http://cran.r-project.org/</a></div>
<div class="annotation"><a href="http://cran.r-project.org/doc/manuals/r-release/R-data.pdf">http://cran.r-project.org/doc/manuals/r-release/R-data.pdf</a></div>
<div class="annotation"><a href="http://cran.r-project.org/doc/manuals/r-release/R-data.pdf">http://cran.r-project.org/doc/manuals/r-release/R-data.pdf</a></div>
</div>
<div class="page"><p/>
<p>1.5 Key Points and Further Issues 13
</p>
<p>Fig. 1.5 Viewing data in R
</p>
<p>1.5 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� The scale of variables is not only a formalism but an essential framework
</p>
<p>for choosing the correct analysis methods. This is particularly relevant
</p>
<p>for association analysis (Chap. 4), statistical tests (Chap. 10), and linear
</p>
<p>regression (Chap. 11).
</p>
<p>� Even if variables are measured on a nominal scale (i.e. if they are cate-
</p>
<p>gorical/qualitative), we may choose to assign a number to each category
</p>
<p>of this variable. This eases the implementation of some analysis methods
</p>
<p>introduced later in this book.
</p>
<p>� Data is usually stored in a data matrix where the rows represent the
</p>
<p>observations and the columns are variables. It can be analysed with
</p>
<p>statistical software. We use R (R Core Team 2016) in this book. A
</p>
<p>gentle introduction is provided in Appendix A and throughout the book.
</p>
<p>A more comprehensive introduction can be found in other books, for
</p>
<p>example in Albert and Rizzo (2012), Crawley (2013), or Ligges (2008).
</p>
<p>Even advanced books, e.g. Adler (2012) or Everitt and Hothorn (2011),
</p>
<p>can offer insights to beginners.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>14 1 Introduction and Framework
</p>
<p>1.6 Exercises
</p>
<p>Exercise 1.1 Describe both the population and the observations for the following
</p>
<p>research questions:
</p>
<p>(a) Evaluation of the satisfaction of employees from an airline.
</p>
<p>(b) Description of the marks of students from an assignment.
</p>
<p>(c) Comparison of two drugs which deal with high blood pressure.
</p>
<p>Exercise 1.2 A national park conducts a study on the behaviour of their leopards.
</p>
<p>A few of the park&rsquo;s leopards are registered and receive a GPS device which allows
</p>
<p>measuring the position of the leopard. Use this example to describe the following
</p>
<p>concepts: population, sample, observation, value, and variable.
</p>
<p>Exercise 1.3 Which of the following variables are qualitative, and which are quan-
</p>
<p>titative? Specify which of the quantitative variables are discrete and which are
</p>
<p>continuous:
</p>
<p>Time to travel to work, shoe size, preferred political party, price for a canteen meal, eye
</p>
<p>colour, gender, wavelength of light, customer satisfaction on a scale from 1 to 10, delivery
</p>
<p>time for a parcel, blood type, number of goals in a hockey match, height of a child, subject
</p>
<p>line of an email.
</p>
<p>Exercise 1.4 Identify the scale of the following variables:
</p>
<p>(a) Political party voted for in an election
</p>
<p>(b) The difficulty of different levels in a computer game
</p>
<p>(c) Production time of a car
</p>
<p>(d) Age of turtles
</p>
<p>(e) Calender year
</p>
<p>(f) Price of a chocolate bar
</p>
<p>(g) Identification number of a student
</p>
<p>(h) Final ranking at a beauty contest
</p>
<p>(i) Intelligence quotient.
</p>
<p>Exercise 1.5 Make yourself familiar with the pizza data set from Appendix A.4.
</p>
<p>(a) First, browse through the introduction to R in Appendix A. Then, read in the
</p>
<p>data.
</p>
<p>(b) View the data both in the R data editor and in the R console.
</p>
<p>(c) Create a new data matrix which consists of the first 5 rows and first 5 variables
</p>
<p>of the data. Print this data set on the R console. Now, save this data set in your
</p>
<p>preferred format.
</p>
<p>(d) Add a new variable &ldquo;NewTemperature&rdquo; to the data set which converts the tem-
</p>
<p>perature from ◦C to ◦F.</p>
<p/>
</div>
<div class="page"><p/>
<p>1.6 Exercises 15
</p>
<p>(e) Attach the data and list the values from the variable &ldquo;NewTemperature&rdquo;.
</p>
<p>(f) Use &ldquo;?&rdquo; to make yourself familiar with the following commands: str, dim,
</p>
<p>colnames, names, nrow, ncol, head, and tail. Apply these commands
</p>
<p>to the data to get more information about it.
</p>
<p>Exercise 1.6 Consider the research questions of describing parents&rsquo; attitudes towards
</p>
<p>immunization, what proportion of them wants immunization against chicken pox for
</p>
<p>their last-born child, and whether this proportion differs by gender and age.
</p>
<p>(a) Which data collection method is the most suitable one to answer the above
</p>
<p>questions: survey or experiment?
</p>
<p>(b) How would you capture the attitudes towards immunization in a single variable?
</p>
<p>(c) Which variables are needed to answer all the above questions? Describe the scale
</p>
<p>of each of them.
</p>
<p>(d) Reflect on what an appropriate data set would look like. Now, given this data
</p>
<p>set, try to write down the above research questions as precisely as possible.
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 321</p>
<p/>
</div>
<div class="page"><p/>
<p>2Frequency Measures and GraphicalRepresentation of Data
</p>
<p>In Chap. 1, we highlighted that different variables contain different levels of informa-
</p>
<p>tion. When summarizing or visualizing one or more variable(s), it is this information
</p>
<p>which determines the appropriate statistical methods to use.
</p>
<p>Suppose we are interested in studying the employment opportunities and starting
</p>
<p>salaries of university graduates with a master&rsquo;s degree. Let the variable X denote the
</p>
<p>starting salaries measured in e/year. Now suppose 100 graduate students provide
</p>
<p>their initial salaries. Let us write down the salary of the first student as x1, the
</p>
<p>salary of the second student as x2, and so on. We therefore have 100 observations
</p>
<p>x1, x2, . . . , x100. How canwe summarize those 100 values best to extract meaningful
</p>
<p>information from them? The answer to this question depends upon several aspects
</p>
<p>like the nature of the recorded data, e.g. how many observations have been obtained
</p>
<p>(either small in number or large in number) or how the data was recorded (either
</p>
<p>exact values were obtained or the values were obtained in intervals). For example, the
</p>
<p>starting salaries may be obtained as exact values, say 51,500 e/year, 32,350 e/year,
</p>
<p>etc. Alternatively, these values could have been summarized in categories such as low
</p>
<p>income (&lt;30,000 e/year), medium income (30,000&ndash;50,000 e/year), high income
</p>
<p>(50,000&ndash;70,000e/year), and very high income (&gt;70,000e/year). Another approach
</p>
<p>is to ask whether the students were employed or not after graduating and record the
</p>
<p>data in terms of &ldquo;yes&rdquo; or &ldquo;no&rdquo;. It is evident that the latter classification is less detailed
</p>
<p>than the grouped income datawhich is less detailed than the exact data. Depending on
</p>
<p>which conceptualization of &ldquo;starting salary&rdquo; we use, we need to choose the approach
</p>
<p>to summarize the data, that is the 100 values relating to the 100 graduated students.
</p>
<p>2.1 Absolute and Relative Frequencies
</p>
<p>Discrete Data. Let us first consider a simple example to illustrate our notation.
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_2
</p>
<p>17</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_1">http://dx.doi.org/10.1007/978-3-319-46162-5_1</a></div>
</div>
<div class="page"><p/>
<p>18 2 Frequency Measures and Graphical Representation of Data
</p>
<p>Example 2.1.1 Suppose there are ten people in a supermarket queue. Each of them
</p>
<p>is either coded as &ldquo;F&rdquo; (if the person is female) or &ldquo;M&rdquo; (if the person is male). The
</p>
<p>collected data may look like
</p>
<p>M, F, M, F, M, M, M, F, M, M.
</p>
<p>There are now two categories in the data: male (M) and female (F).We use a1 to refer
</p>
<p>to themale category and a2 to refer to the female category. Since there are sevenmale
</p>
<p>and three female students, we have 7 values in category a1, denoted as n1 = 7, and 3
</p>
<p>values in category a2, denoted as n2 = 3. The number of observations in a particular
</p>
<p>category is called the absolute frequency. It follows that n1 = 7 and n2 = 3 are the
</p>
<p>absolute frequencies of a1 and a2, respectively. Note that n1 + n2 = n = 10, which
</p>
<p>is the same as the total number of collected observations. We can also calculate
</p>
<p>the relative frequencies of a1 and a2 as f1 = f (a1) =
n1
n
= 7
</p>
<p>10
= 0.7 = 70% and
</p>
<p>f2 = f (a2) =
n2
n
= 3
</p>
<p>10
= 0.3 = 30%, respectively. This gives us information about
</p>
<p>the proportions of male and female customers in the queue.
</p>
<p>We now extend these concepts to a general framework for the summary of data
</p>
<p>on discrete variables. Suppose there are k categories denoted as a1, a2, . . . , ak
with n j ( j = 1, 2, . . . , k) observations in category a j . The absolute frequency n j is
</p>
<p>defined as the number of units in the j th category a j . The sumof absolute frequencies
</p>
<p>equals the total number of units in the data:
&sum;k
</p>
<p>j=1 n j = n. The relative frequencies
</p>
<p>of the j th class are defined as
</p>
<p>f j = f (a j ) =
n j
</p>
<p>n
, j = 1, 2, . . . , k. (2.1)
</p>
<p>The relative frequencies always lie between 0 and 1 and
&sum;k
</p>
<p>j=1 f j = 1.
</p>
<p>Grouped Continuous Data. Data on continuous variables usually has a large number
</p>
<p>(k) of different values. Sometimes k may even be the same as n and in such a case
</p>
<p>the relative frequencies become f j =
1
n
for all j . However, it is possible to define
</p>
<p>intervals in which the observed values are contained.
</p>
<p>Example 2.1.2 Consider the following n = 20 results of the written part of a driving
</p>
<p>licence examination (a maximum of 100 points could be achieved):
</p>
<p>28, 35, 42, 90, 70, 56, 75, 66, 30, 89, 75, 64, 81, 69, 55, 83, 72, 68, 73, 16.
</p>
<p>We can summarize the results in class intervals such as 0&ndash;20, 21&ndash;40, 41&ndash;60, 61&ndash;80,
</p>
<p>and 81&ndash;100, and the data can be presented as follows:
</p>
<p>Class intervals 0&ndash;20 21&ndash;40 41&ndash;60 61&ndash;80 81&ndash;100
</p>
<p>Absolute frequencies n1 = 1 n2 = 3 n3 = 3 n4 = 9 n5 = 4
</p>
<p>Relative frequencies f1 =
1
20
</p>
<p>f2 =
3
20
</p>
<p>f3 =
3
20
</p>
<p>f4 =
9
20
</p>
<p>f5 =
5
20
</p>
<p>We have
&sum;5
</p>
<p>j=1 n j = 20 = n and
&sum;5
</p>
<p>j=1 f j = 1.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.1 Absolute and Relative Frequencies 19
</p>
<p>Table 2.1 Frequency distribution for discrete data
</p>
<p>Class intervals (a j ) a1 a2 ... ak
</p>
<p>Absolute frequencies (n j ) n1 n2 ... nk
</p>
<p>Relative frequencies ( f j ) f1 f2 ... fk
</p>
<p>Now, suppose the n observations can be classified into k class intervals
</p>
<p>a1, a2, . . . , ak , where a j ( j = 1, 2, . . . , k) contains n j observationswith
&sum;k
</p>
<p>j=1 n j =
</p>
<p>n. The relative frequency of the j th class is f j = n j/n and
&sum;k
</p>
<p>j=1 f j = 1. Table 2.1
</p>
<p>displays the frequency distribution of a discrete variable X .
</p>
<p>Example 2.1.3 Consider the pizza delivery service data (Example 1.4.2, Appen-
</p>
<p>dix A.4). We are interested in the pizza deliveries by branch and generate the respec-
</p>
<p>tive frequency table, showing the distribution of the data, using the table command
</p>
<p>in R (after reading in and attaching the data) as
</p>
<p>table(branch) # absolute frequencies
</p>
<p>table(branch)/length(branch) # relative frequencies
</p>
<p>a j Centre East West
</p>
<p>n j 421 410 435
</p>
<p>f j
421
1266
</p>
<p>&asymp; 0.333 410
1266
</p>
<p>&asymp; 0.323 435
1266
</p>
<p>&asymp; 0.344
</p>
<p>We have n =
&sum;
</p>
<p>j n j = 1266 deliveries and
&sum;
</p>
<p>j f j = 1. We can see from this table
</p>
<p>that each branch has a similar absolute number of pizza deliveries and each branch
</p>
<p>contributes to about one-third of the total number of deliveries.
</p>
<p>2.2 Empirical Cumulative Distribution Function
</p>
<p>Another approach to summarize and visualize the (frequency) distribution of vari-
</p>
<p>ables is the empirical cumulative distribution function, often abbreviated as
</p>
<p>&ldquo;ECDF&rdquo;. As the name itself suggests, it gives us an idea about the cumulative rela-
</p>
<p>tive frequencies up to a certain point. For example, say we want to know how many
</p>
<p>people scored up to 60 points in Example 2.1.2. Then, this can be calculated by
</p>
<p>adding the number of people in the class intervals 0&ndash;20, 21&ndash;40, and 41&ndash;60, which
</p>
<p>corresponds to n1 + n2 + n3 = 1+ 3+ 3 = 7 and is the cumulative frequency. If
</p>
<p>we want to know the relative frequency of people obtaining up to 60 points, we have
</p>
<p>to add the relative frequencies of the people in the class intervals 0&ndash;20, 21&ndash;40, and
</p>
<p>41&ndash;60 as f1 + f2 + f3 =
1
20
</p>
<p>+ 3
20
</p>
<p>+ 3
20
</p>
<p>= 7
20
.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_1">http://dx.doi.org/10.1007/978-3-319-46162-5_1</a></div>
</div>
<div class="page"><p/>
<p>20 2 Frequency Measures and Graphical Representation of Data
</p>
<p>Before discussing the empirical cumulative distribution function in amore general
</p>
<p>framework, let us first understand the concept of ordered values. Suppose the values
</p>
<p>of height of four people are observed as x1 = 180 cm, x2 = 160 cm, x3 = 175 cm,
</p>
<p>and x4 = 170 cm. We arrange these values in an order, say ascending order, i.e. first
</p>
<p>the smallest value (denoted as x(1)) and lastly the largest value (denoted as x(4)). We
</p>
<p>obtain
</p>
<p>x(1) = x2 = 160 cm, x(2) = x4 = 170 cm,
</p>
<p>x(3) = x3 = 175 cm, x(4) = x1 = 180 cm.
</p>
<p>The values x(1), x(2), x(3), and x(4) are called ordered values for which x(1) &lt; x(2) &lt;
</p>
<p>x(3) &lt; x(4) holds. Note that x1 is not necessarily the smallest value but x(1) is
</p>
<p>necessarily the smallest value. In general, if we have n observations x1, x2, . . . , xn ,
</p>
<p>then the ordered data is x(1) &le; x(2) &le; &middot; &middot; &middot; &le; x(n).
</p>
<p>Consider n observations x1, x2, . . . , xn of a variable X , which are arranged in
</p>
<p>ascending order as x(1) &le; x(2) &le; &middot; &middot; &middot; &le; x(n) (and are thus on an at least ordinal scale).
</p>
<p>The empirical cumulative distribution function F(x) is defined as the cumulative
</p>
<p>relative frequencies of all values a j , which are smaller than, or equal to, x :
</p>
<p>F(x) =
&sum;
</p>
<p>a j&le;x
</p>
<p>f (a j ). (2.2)
</p>
<p>This definition implies that F(x) is a monotonically non-decreasing function, 0 &le;
</p>
<p>F(x) &le; 1, limx&rarr;&minus;&infin; F(x) = 0 (the lower limit of F is 0), limx&rarr;+&infin; F(x) = 1 (the
</p>
<p>upper limit of F is 1), and F(x) is right continuous.
</p>
<p>2.2.1 ECDF for Ordinal Variables
</p>
<p>The empirical cumulative distribution function of ordinal variables is a step function.
</p>
<p>Example 2.2.1 Consider a customer satisfaction survey from a car service company.
</p>
<p>The 200 customers who had a car service done within the last 30 days were asked to
</p>
<p>respond regarding their overall level of satisfaction with the quality of the car service
</p>
<p>on a scale from 1 to 5 based on the following options: 1 = not satisfied at all, 2 =
</p>
<p>unsatisfied, 3 = satisfied, 4 = very satisfied, and 5 = perfectly satisfied. Based on
</p>
<p>the frequency of each option, we can calculate the relative frequencies and then
</p>
<p>plot the empirical cumulative distribution function, either manually (takes longer)
</p>
<p>or by using R (quick):
</p>
<p>Satisfaction level (a j ) j = 1 j = 2 j = 3 j = 4 j = 5
</p>
<p>n j 4 16 90 70 20
</p>
<p>f j 4/200 16/200 90/200 70/200 20/200
</p>
<p>F j 4/200 20/200 110/200 180/200 200/200</p>
<p/>
</div>
<div class="page"><p/>
<p>2.2 Empirical Cumulative Distribution Function 21
</p>
<p>0 1 2 3 4 5 6
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>Satisfaction
</p>
<p>F
(x
</p>
<p>)
</p>
<p>Fig. 2.1 ECDF for the satisfaction survey
</p>
<p>The F j &rsquo;s are calculated as follows:
</p>
<p>F1 = f1, F3 = f1 + f2 + f3,
</p>
<p>F2 = f1 + f2, F4 = f1 + f2 + f3 + f4.
</p>
<p>The ECDF for this data can be obtained by summarizing the data in a vector and
</p>
<p>using the plot.ecdf() function in R, see Fig. 2.1:
</p>
<p>sv &lt;- c(rep(1,4),rep(2,16),rep(3,90),rep(4,70),rep(5,20))
</p>
<p>plot.ecdf(sv)
</p>
<p>The ECDF can be used to obtain the relative frequencies for values contained in
</p>
<p>certain intervals as
</p>
<p>H(c &le; x &le; d) = relative frequency of values x with c &le; x &le; d.
</p>
<p>It further follows that:
</p>
<p>H(x &le; a j ) = F(a j ) (2.3)
</p>
<p>H(x &lt; a j ) = H(x &le; a j ) &minus; f (a j ) = F(a j ) &minus; f (a j ) (2.4)
</p>
<p>H(x &gt; a j ) = 1&minus; H(x &le; a j ) = 1&minus; F(a j ) (2.5)
</p>
<p>H(x &ge; a j ) = 1&minus; H(X &lt; a j ) = 1&minus; F(a j ) + f (a j ) (2.6)
</p>
<p>H(a j1 &le; x &le; a j2) = F(a j2) &minus; F(a j1) + f (a j1) (2.7)
</p>
<p>H(a j1 &lt; x &le; a j2) = F(a j2) &minus; F(a j1) (2.8)
</p>
<p>H(a j1 &lt; x &lt; a j2) = F(a j2) &minus; F(a j1) &minus; f (a j2) (2.9)
</p>
<p>H(a j1 &le; x &lt; a j2) = F(a j2) &minus; F(a j1) &minus; f (a j2) + f (a j1) (2.10)</p>
<p/>
</div>
<div class="page"><p/>
<p>22 2 Frequency Measures and Graphical Representation of Data
</p>
<p>Example 2.2.2 Suppose, in Example 2.2.1, we want to know how many customers
</p>
<p>are not satisfied with their car service. Then, using the data relating to the responses
</p>
<p>&ldquo;1&rdquo; and &ldquo;2&rdquo;, we observe from the ECDF that (16+ 4)/200% = 10% of the cus-
</p>
<p>tomers were not satisfied with the car service. This relates to using rule (2.3):
</p>
<p>H(X &le; 2) = F(2) = 0.1 or 10 %. Similarly, the proportion of customers who are
</p>
<p>more than satisfied can be obtained using (2.5) as H(X &gt; 3) = 1&minus; H(x &le; 3) =
</p>
<p>1&minus; 110/200 = 0.45% or 45 %.
</p>
<p>2.2.2 ECDF for Continuous Variables
</p>
<p>In general, we can apply formulae (2.2)&ndash;(2.10) to continuous data as well. However,
</p>
<p>before demonstrating their use, let us consider a somewhat different setting. Let us
</p>
<p>assume that a continuous variable of interest is only available in the form of grouped
</p>
<p>data. We may assume that the observations within each group, i.e. each category
</p>
<p>or each interval, are distributed uniformly over the entire interval. The ECDF then
</p>
<p>consists of straight lines connecting the lower and upper values of the ECDF in each
</p>
<p>of the intervals. To understand this concept inmore detail, we introduce the following
</p>
<p>notation:
</p>
<p>k number of groups (or intervals),
</p>
<p>e j&minus;1 lower limit of j th interval,
</p>
<p>e j upper limit of j th interval,
</p>
<p>d j = e j &minus; e j&minus;1 width of the j th interval,
</p>
<p>n j number of observations in the j th interval.
</p>
<p>Under the assumption that all values in a particular interval are distributed uni-
</p>
<p>formly within this interval, the empirical cumulative distribution function relates to a
</p>
<p>polygonal chain connecting the points (0, 0),
(
</p>
<p>e1, F(e1)
)
</p>
<p>,
(
</p>
<p>e2, F(e2)
)
</p>
<p>, . . . , (ek, 1).
</p>
<p>The ECDF can then be defined as
</p>
<p>F(x) =
</p>
<p>⎧
</p>
<p>⎪
</p>
<p>⎨
</p>
<p>⎪
</p>
<p>⎩
</p>
<p>0, x &lt; e0
</p>
<p>F(e j&minus;1) +
f j
d j
</p>
<p>(x &minus; e j&minus;1), x &isin; [e j&minus;1, e j )
</p>
<p>1, x &ge; ek
</p>
<p>(2.11)
</p>
<p>with F(e0) = 0. The idea behind (2.11) is presented in Fig. 2.2. For any interval
</p>
<p>[e j&minus;1, e j ), the respective lower and upper limits of the ECDF are F(e j ) and F(e j&minus;1).
</p>
<p>If we assume values to be distributed uniformly over this interval, we can connect
</p>
<p>F(e j ) and F(e j&minus;1) with a straight line. To obtain F(x) with x &gt; e j&minus;1 and x &lt; e j ,
</p>
<p>we simply add the height of the ECDF between F(e j&minus;1) and F(x) to F(e j&minus;1).
</p>
<p>Example 2.2.3 Consider Example 2.1.3 of the pizza delivery service. Suppose we
</p>
<p>are interested in determining the distribution of the pizza delivery times. Using
</p>
<p>the function plot.ecdf() in R, we obtain the ECDF of the continuous data, see
</p>
<p>Fig. 2.3a. Note that the structure of the curve is a step function but now almost looks
</p>
<p>like a continuous curve. The reason for this is that when the number of observations is
</p>
<p>large, then the lengths of class intervals become small. When these small lengths are</p>
<p/>
</div>
<div class="page"><p/>
<p>2.2 Empirical Cumulative Distribution Function 23
</p>
<p>Fig. 2.2 Illustration of the
</p>
<p>ECDF for continuous data
</p>
<p>available in groups/intervals&lowast;
</p>
<p>ej&minus;1
</p>
<p>F (ej&minus;1)
</p>
<p>ejx
</p>
<p>F (x)
</p>
<p>dj
</p>
<p>fj
</p>
<p>joined together, they appear like a continuous curve. As the number of observations
</p>
<p>increases, the smoothness of the curve increases too. If the number of observations
</p>
<p>is not large, e.g. suppose the data is reported as a summary from the drivers, i.e.
</p>
<p>whether the delivery took&lt;15 min, between 15 and 20 min, between 20 and 25 min,
</p>
<p>and so on, then we can construct the ECDF by creating a table summarizing the data
</p>
<p>features as in Table 2.2.
</p>
<p>Figure 2.3b shows the ECDF based on the grouped data evaluated in Table 2.2. It
</p>
<p>is interesting to see that the graphs emerging from the use of the grouped data and
</p>
<p>ungrouped data are similar in this specific example.
</p>
<p>Suppose we are interested in calculating how many deliveries were completed
</p>
<p>within the desired time limit of 30 min, with a tolerance of maximum 10 %
</p>
<p>deviation, i.e. a deviation of 3 min. We can evaluate the ECDF at x = 33 min.
</p>
<p>Table 2.2 The values needed to calculate the ECDF for the grouped pizza delivery time data in
</p>
<p>Example 2.2.3
</p>
<p>Delivery time j e j&minus;1 e j n j f j F(e j )
</p>
<p>[0; 10] 1 0 10 0 0.0000 0.0000
</p>
<p>(10; 15] 2 10 15 3 0.0024 0.0024
</p>
<p>(15; 20] 3 15 20 21 0.0166 0.0190
</p>
<p>(20; 25] 4 20 25 75 0.0592 0.0782
</p>
<p>(25; 30] 5 25 30 215 0.1698 0.2480
</p>
<p>(30; 35] 6 30 35 373 0.2946 0.5426
</p>
<p>(35; 40] 7 35 40 350 0.2765 0.8191
</p>
<p>(40; 45] 8 40 45 171 0.1351 0.9542
</p>
<p>(45; 50] 9 45 50 52 0.0411 0.9953
</p>
<p>(50; 55] 10 50 55 6 0.0047 1.0000</p>
<p/>
</div>
<div class="page"><p/>
<p>24 2 Frequency Measures and Graphical Representation of Data
</p>
<p>10 20 30 40 50
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>Delivery Time (in min)
</p>
<p>F
(x
</p>
<p>)
</p>
<p>(a) Continuous data
</p>
<p>10 20 30 40 50
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>Delivery Time (in min)
</p>
<p>F
(x
</p>
<p>)
</p>
<p>(b) Grouped continuous data
</p>
<p>Fig. 2.3 Empirical cumulative distribution function for pizza delivery time
</p>
<p>Based on (2.11),we calculate H(X &le; 33) = F(33) = F(30) + f (6)/5(33&minus; 30) =
</p>
<p>0.2480+ 0.2946/5 &middot; 3 = 0.42476. Thus, we conclude, based on the grouped data,
</p>
<p>that only about 42 % of the deliveries were completed in the desired time frame.
</p>
<p>2.3 Graphical Representation of a Variable
</p>
<p>Frequency tables and empirical cumulative distribution functions are useful in provid-
</p>
<p>ing a numerical summary of a variable. Graphs are an alternative way to summarize
</p>
<p>a variable&rsquo;s information. In many situations, they have the advantage of conveying
</p>
<p>the information hidden in the data more compactly. Similarly, someone&rsquo;s mood can
</p>
<p>bemore easily understood when looking at a smiley &copy; than by reading an essay about
</p>
<p>one&rsquo;s mood in a long paragraph.
</p>
<p>2.3.1 Bar Chart
</p>
<p>A simple tool to visualize the relative or absolute frequencies of observed values of
</p>
<p>a variable is a bar chart. A bar chart can be used for nominal and ordinal variables,
</p>
<p>as long as the number of categories is not very large. It consists of one bar for each
</p>
<p>category. The height of each bar is determined by either the absolute frequency or
</p>
<p>the relative frequency of the respective category and is shown on the y-axis. If the
</p>
<p>variable is measured on an ordinal level, then it is recommended to arrange the bars
</p>
<p>on the x-axis according to their ranks or values. If the number of categories is large,
</p>
<p>then the number of bars will be large too and the bar chart, in turn, may not remain
</p>
<p>informative.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Graphical Representation of a Variable 25
</p>
<p>female male
</p>
<p>Gender
</p>
<p>a
b
</p>
<p>s
o
</p>
<p>lu
te
</p>
<p> f
re
</p>
<p>q
u
</p>
<p>e
n
</p>
<p>c
y
</p>
<p>0
2
</p>
<p>4
6
</p>
<p>8
1
</p>
<p>0
</p>
<p>(a) With absolute frequencies
</p>
<p>female male
</p>
<p>Gender
</p>
<p>re
la
</p>
<p>ti
v
e
</p>
<p> f
re
</p>
<p>q
u
</p>
<p>e
n
</p>
<p>c
y
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>(b) With relative frequencies
</p>
<p>Fig. 2.4 Bar charts
</p>
<p>Example 2.3.1 Consider Example 2.1.1 inwhich ten people, queueing in a supermar-
</p>
<p>ket, were classified as being either male (M) or female (F). The absolute frequencies
</p>
<p>for males and females are n1 = 7 and n2 = 3, respectively. Since there are two cate-
</p>
<p>gories,M and F, two bars are needed to construct the chart&mdash;one for themale category
</p>
<p>and another for the female category. The heights of the bars are determined as either
</p>
<p>n1 = 7 and n2 = 3 or f1 = 0.7 and f2 = 0.3. These graphs are shown in Fig. 2.4.
</p>
<p>Example 2.3.2 Consider the data in Example 2.1.3, where the pizza delivery times
</p>
<p>for each branch are recorded over a period of 1 month. The frequency table forms the
</p>
<p>basis for the bar chart, either using the absolute or relative frequencies on the y-axis.
</p>
<p>Figure 2.5 shows the bar charts for the number and proportion of pizza deliveries per
</p>
<p>branch. The graphs can be produced in R by applying the barplot command to a
</p>
<p>frequency table:
</p>
<p>barplot(table(branch))
</p>
<p>barplot(table(branch)/length(branch))
</p>
<p>Remark 2.3.1 Insteadof vertical bars, horizontal bars canbedrawnusing the optional
</p>
<p>argument horiz=TRUE in the barplot command.</p>
<p/>
</div>
<div class="page"><p/>
<p>26 2 Frequency Measures and Graphical Representation of Data
</p>
<p>Centre East West
</p>
<p>Branch
</p>
<p>a
b
</p>
<p>s
o
</p>
<p>lu
te
</p>
<p> f
re
</p>
<p>q
u
</p>
<p>e
n
</p>
<p>c
y
</p>
<p>0
1
</p>
<p>0
0
</p>
<p>2
0
</p>
<p>0
3
</p>
<p>0
0
</p>
<p>4
0
</p>
<p>0
5
</p>
<p>0
0
</p>
<p>(a) With absolute frequencies
</p>
<p>Centre East West
</p>
<p>Branch
</p>
<p>re
la
</p>
<p>ti
v
e
</p>
<p> f
re
</p>
<p>q
u
</p>
<p>e
n
</p>
<p>c
y
</p>
<p>0
.0
</p>
<p>0
.1
</p>
<p>0
.2
</p>
<p>0
.3
</p>
<p>0
.4
</p>
<p>0
.5
</p>
<p>(b) With relative frequencies
</p>
<p>Fig. 2.5 Bar charts for the pizza deliveries per branch
</p>
<p>2.3.2 Pie Chart
</p>
<p>Pie charts are another option to visualize the absolute and relative frequencies of
</p>
<p>nominal and ordinal variables. A pie chart is a circle partitioned into segments,
</p>
<p>where each of the segments represents a category. The size of each segment depends
</p>
<p>upon the relative frequency and is determined by the angle f j &middot; 360
◦.
</p>
<p>Example 2.3.3 To illustrate the construction of a pie chart, let us consider again
</p>
<p>Example 2.1.1 in which ten people in a supermarket queue were classified as being
</p>
<p>either male (M) or female (F): M, F, M, F, M, M, M, F, M, M. The pie chart for this
</p>
<p>data will have two segments: one for males and another one for females. The relative
</p>
<p>frequencies are f1 = 7/10 and f2 = 3/10, respectively. The size of the segment
</p>
<p>for the first category (M) is f1 &middot; 360
◦ = (7/10) &middot; 360◦ = 252◦, and the size of the
</p>
<p>segment for the second category (F) is f2 &middot; 360
◦ = (3/10) &middot; 360◦ = 108◦. The pie
</p>
<p>chart is shown in Fig. 2.6a.
</p>
<p>Example 2.3.4 Consider again Example 2.2.1, where 200 customers were asked
</p>
<p>about their level of satisfaction (5 categories) with their car service. The pie chart
</p>
<p>for this example consists of five segments representing the categories 1, 2, 3, 4,
</p>
<p>and 5. The size of the j th segment is f j &middot; 360
◦, j = 1, 2, 3, 4, 5. For example, for
</p>
<p>category 1, there are 4 out of 200 customers, who are not satisfied at all. The angle
</p>
<p>of the segment &ldquo;not satisfied at all&rdquo; therefore is f1 &middot; 360
◦ = 4/200 &middot; 360◦ = 7.2◦.
</p>
<p>Similarly, we can calculate the angle of the other segments and obtain a pie chart as
</p>
<p>shown in Fig. 2.6b using the pie command in R
</p>
<p>pie(table(sv))</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Graphical Representation of a Variable 27
</p>
<p>female
</p>
<p>male
</p>
<p>(a) For gender of people queueing
</p>
<p>not statisfied at all
</p>
<p>not satisfied
</p>
<p>satisfied
</p>
<p>very
</p>
<p>satisfied
</p>
<p>perfectly satisfied
</p>
<p>(b) For satisfaction with the car service
</p>
<p>Fig. 2.6 Pie charts
</p>
<p>Remark 2.3.2 Note that the area of a segment is not proportional to the absolute
</p>
<p>frequency of the respective category. Instead, the area of the segment is proportional
</p>
<p>to the angle f j &middot; 360
◦ (and depends also on the radius of the whole circle). It has been
</p>
<p>argued that this may cause improper interpretations as the human eye may catch the
</p>
<p>segment&rsquo;s area more easily than the angle of a segment. Pie charts should therefore
</p>
<p>be used with caution.
</p>
<p>2.3.3 Histogram
</p>
<p>If a variable consists of a large number of different values, the number of categories
</p>
<p>used to construct bar charts will consequently be large too. A bar chart may thus not
</p>
<p>give a clear summary when applied to a continuous variable. Instead, a histogram is
</p>
<p>the appropriate choice to represent the distribution of values of continuous variables.
</p>
<p>It is based on the idea to categorize the data into different groups and plot the bars
</p>
<p>for each category with height h j = f j/d j , where d j = e j &minus; e j&minus;1 denotes the width
</p>
<p>of the j th class interval or category. An important consideration for this concept is
</p>
<p>that the area of the bars (=height &times; width) is proportional to the relative frequency.
</p>
<p>This means that the widths of the bars need not necessarily to be the same because
</p>
<p>different widths can be adjusted with different heights of the bars.
</p>
<p>Example 2.3.5 Consider Example 2.1.2, where n = 20 people were divided into five
</p>
<p>class intervals 0&ndash;20, 21&ndash;40, 41&ndash;60, 61&ndash;80, and 81&ndash;100 based on their performance
</p>
<p>in a written driving licence examination. The frequency table is given as</p>
<p/>
</div>
<div class="page"><p/>
<p>28 2 Frequency Measures and Graphical Representation of Data
</p>
<p>Class intervals 0&ndash;20 21&ndash;40 41&ndash;60 61&ndash;80 81&ndash;100
</p>
<p>Absolute freq n1 = 1 n2 = 3 n3 = 3 n4 = 9 n5 = 4
</p>
<p>Relative freq f1 =
1
20
</p>
<p>f2 =
3
20
</p>
<p>f3 =
3
20
</p>
<p>f4 =
9
20
</p>
<p>f5 =
5
20
</p>
<p>Height f j /d j h1 =
1
</p>
<p>400
h2 =
</p>
<p>3
400
</p>
<p>h3 =
3
</p>
<p>400
h4 =
</p>
<p>9
400
</p>
<p>h5 =
4
</p>
<p>400
</p>
<p>Fig. 2.7 Histogram for the
</p>
<p>scores of the people
</p>
<p>Score
</p>
<p>D
e
</p>
<p>n
s
it
y
</p>
<p>0 20 40 60 80 100
</p>
<p>0
.0
</p>
<p>0
0
</p>
<p>0
.0
</p>
<p>0
5
</p>
<p>0
.0
</p>
<p>1
0
</p>
<p>0
.0
</p>
<p>1
5
</p>
<p>0
.0
</p>
<p>2
0
</p>
<p>0
.0
</p>
<p>2
5
</p>
<p>The histogram for this grouped data set has five categories and therefore it has
</p>
<p>five bars. Since the widths of class intervals are the same, the heights of the bars
</p>
<p>are proportional to the relative frequency of the respective category. The resulting
</p>
<p>histogram is displayed in Fig. 2.7.
</p>
<p>Example 2.3.6 RecallExample2.2.3 and thevariable &ldquo;pizzadelivery time&rdquo;.Table 2.3
</p>
<p>shows the summary of the grouped data and the values needed to calculate the his-
</p>
<p>togram. Figure 2.8a shows the histogramwith equal widths of delivery time intervals.
</p>
<p>We see a symmetric distribution of the pizza delivery times, but many delivery times
</p>
<p>exceeding the target time of 30 min. If the histogram is required to have different
</p>
<p>widths for different bars, i.e. different delivery time intervals for different categories,
</p>
<p>then it can also be constructed as shown in Fig. 2.8b. This representation is different
</p>
<p>from Fig. 2.8a. The following commands in R are used to construct the histograms
</p>
<p>for absolute and relative frequencies, respectively:
</p>
<p>hist(time) # show abs. frequencies
</p>
<p>hist(time, freq=F) # show rel. frequencies
</p>
<p>Remark 2.3.3 The R command truehist() from the library MASS presents an alter-
</p>
<p>native to the hist() command. The default specifications are somewhat different,
</p>
<p>and many users prefer it to the command hist.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Graphical Representation of a Variable 29
</p>
<p>Table 2.3 Values needed to calculate the histogram for the grouped pizza delivery time data
</p>
<p>Delivery time j e j&minus;1 e j d j f j h j
</p>
<p>[0; 10] 1 0 10 10 0.0000 0.00000
</p>
<p>(10; 15] 2 10 15 5 0.0024 0.00047
</p>
<p>(15; 20] 3 15 20 5 0.0166 0.00332
</p>
<p>(20; 25] 4 20 25 5 0.0592 0.01185
</p>
<p>(25; 30] 5 25 30 5 0.1698 0.03397
</p>
<p>(30; 35] 6 30 35 5 0.2946 0.05893
</p>
<p>(35; 40] 7 35 40 5 0.2765 0.05529
</p>
<p>(40; 45] 8 40 45 5 0.1351 0.02701
</p>
<p>(45; 50] 9 45 50 5 0.0411 0.00821
</p>
<p>(50; 55] 10 50 55 5 0.0047 0.00094
</p>
<p>Delivery Time (in min)
</p>
<p>D
e
n
s
it
y
</p>
<p>10 20 30 40 50 60
</p>
<p>0
.0
</p>
<p>0
0
.0
</p>
<p>1
0
.0
</p>
<p>2
0
.0
</p>
<p>3
0
.0
</p>
<p>4
0
.0
</p>
<p>5
0
.0
</p>
<p>6
</p>
<p>(a) With same width for each category
</p>
<p>Delivery Time (in min)
</p>
<p>D
e
n
s
it
y
</p>
<p>10 20 30 40 50 60
</p>
<p>0
.0
</p>
<p>0
0
.0
</p>
<p>1
0
.0
</p>
<p>2
0
.0
</p>
<p>3
0
.0
</p>
<p>4
0
.0
</p>
<p>5
0
.0
</p>
<p>6
</p>
<p>(b) With different widths per category
</p>
<p>Fig. 2.8 Histogram for pizza delivery time
</p>
<p>2.4 Kernel Density Plots
</p>
<p>A disadvantage of histograms is that continuous data is categorized artificially. The
</p>
<p>choice of the class intervals is crucial for the final look of the graph. A more elegant
</p>
<p>way to deal with this problem is to smooth the histogram in the sense that each obser-
</p>
<p>vation may contribute to different classes with different weights, and the distribution
</p>
<p>is represented by a continuous function rather than a step function. A kernel density
</p>
<p>plot can be produced by using the following function:</p>
<p/>
</div>
<div class="page"><p/>
<p>30 2 Frequency Measures and Graphical Representation of Data
</p>
<p>0 2 4 6 8 10 12
</p>
<p>0
.0
</p>
<p>0
0
</p>
<p>.0
5
</p>
<p>0
.1
</p>
<p>0
0
</p>
<p>.1
5
</p>
<p>0
.2
</p>
<p>0
</p>
<p>X
</p>
<p>d
e
</p>
<p>n
s
it
y
</p>
<p>| | | | |
</p>
<p>(a) Epanechnikow kernel density estimate
</p>
<p>0 2 4 6 8 10 12
</p>
<p>0
.0
</p>
<p>0
0
</p>
<p>.0
5
</p>
<p>0
.1
</p>
<p>0
0
</p>
<p>.1
5
</p>
<p>X
</p>
<p>d
e
</p>
<p>n
s
it
y
</p>
<p>| | | | |
</p>
<p>Epanechnikov
</p>
<p>Gaussian
</p>
<p>Rectangular
</p>
<p>(b) Different kernel choices
</p>
<p>Fig. 2.9 Construction of kernel density plots
</p>
<p>f̂n(x) =
1
</p>
<p>nh
</p>
<p>n
&sum;
</p>
<p>i=1
</p>
<p>K
</p>
<p>(
</p>
<p>x &minus; xi
</p>
<p>h
</p>
<p>)
</p>
<p>, h &gt; 0, (2.12)
</p>
<p>where n is the sample size, h is the bandwidth, and K is a kernel function, for
</p>
<p>example
</p>
<p>K (x) =
</p>
<p>{
</p>
<p>1
2
</p>
<p>if &minus; 1 &le; x &le; 1
</p>
<p>0 elsewhere
(rectangular kernel)
</p>
<p>K (x) =
</p>
<p>{
</p>
<p>3
4
(1&minus; x2) if |x | &lt; 1
</p>
<p>0 elsewhere.
(Epanechnikov kernel)
</p>
<p>To better understand this concept, consider Fig. 2.9a. The tick marks on the x-axis
</p>
<p>represent five observations: 3, 6, 7, 8, and 10. On each observation xi as well as its
</p>
<p>surrounding values, we apply a kernel function, which is the Epanechnikov kernel in
</p>
<p>the figure. This means that we have five functions (grey, dashed lines), which refer to
</p>
<p>the five observations. These functions are largest at the observation itself and become
</p>
<p>gradually smaller as the distance from the observation increases. Summing up the
</p>
<p>functions, as described in Eq. (2.12), yields the solid black line, which is the kernel
</p>
<p>density plot of the five observations. It is a smooth curve, which represents the data
</p>
<p>distribution. The degree of smoothness can be controlled by the bandwidth h, which
</p>
<p>is chosen as 2 in Fig. 2.9a.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.4 Kernel Density Plots 31
</p>
<p>Delivery time
</p>
<p>d
e
n
s
it
y
</p>
<p>0 10 20 30 40 50 60 70
</p>
<p>0
.0
</p>
<p>0
0
.0
</p>
<p>2
0
.0
</p>
<p>4
0
.0
</p>
<p>6
</p>
<p>(a) Default bandwidth
</p>
<p>0 10 20 30 40 50 60 70
</p>
<p>0
.0
</p>
<p>0
0
.0
</p>
<p>2
0
.0
</p>
<p>4
0
.0
</p>
<p>6
</p>
<p>Delivery time
</p>
<p>d
e
n
s
it
y
</p>
<p>(b) Shorter bandwidth
</p>
<p>Fig. 2.10 Kernel density plot for delivery time
</p>
<p>The choice of the kernel may affect the overall look of the plot. Above, we have
</p>
<p>given the functions for the rectangular and Epanechnikov kernels. However, another
</p>
<p>common function for kernel density plots is the normal distribution function, which
</p>
<p>is introduced in Sect. 8.2.2, see Fig. 2.9b for a comparison of different kernels. The
</p>
<p>kernel which is based on the normal distribution is called the &ldquo;Gaussian kernel&rdquo; and
</p>
<p>is the default in R, where a kernel density plot can be produced combining the plot
</p>
<p>and density commands:
</p>
<p>example &lt;- c(3,6,7,8,10)
</p>
<p>plot(density(example, kernel='gaussian'))
</p>
<p>Please note that kernel functions are not defined arbitrarily and need to satisfy cer-
</p>
<p>tain conditions, such as those required for probability density functions as explained
</p>
<p>in Chap. 7, Theorem 7.2.1.
</p>
<p>Example 2.4.1 Let us consider the pizza data which we introduced earlier and in
</p>
<p>Appendix A.4. We can summarize the delivery time by using a kernel density plot
</p>
<p>using the R command plot(density(time)) and compare it with a histogram,
</p>
<p>see Fig. 2.10a. We see that the delivery times are symmetric around 35 min. If we
</p>
<p>shorten the bandwidth to a half of the default bandwidth (option adjust=0.5), the
</p>
<p>kernel density plot becomes more wiggly, which is illustrated in Fig. 2.10b.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>32 2 Frequency Measures and Graphical Representation of Data
</p>
<p>2.5 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� Bar charts and histograms are not the same graphical tools. Bar charts
</p>
<p>visualize the categories of nominal or ordinal variables whereas his-
</p>
<p>tograms visualize the distribution of continuous variables. A bar chart
</p>
<p>does not require to have ordered values on the x-axis, but a histogram
</p>
<p>always requires the values on the x-axis to be on a continuous scale and
</p>
<p>to be ordered. The interpretation of a histogram is simplified if the class
</p>
<p>intervals are equally sized, since then the heights of the rectangles of
</p>
<p>the histogram are proportional to the absolute or relative frequencies.
</p>
<p>� The ECDF can be used only for ordinal and continuous variables, see
</p>
<p>Sect. 7.2 for the theoretical background of the cumulative distribution
</p>
<p>function.
</p>
<p>� A pie chart summarizes observations from a discrete (nominal, ordi-
</p>
<p>nal or grouped continuous) variable. It is only useful if the number of
</p>
<p>different values (categories) is small. It is to be kept in mind that the
</p>
<p>area of each segment is not proportional to the absolute frequency of
</p>
<p>the respective category. The angle of the segment is proportional to the
</p>
<p>relative frequency of the respective category.
</p>
<p>� Other possibilities to visualize the distribution of variables are, for exam-
</p>
<p>ple, box plots (Sect. 3.3) and stratified plots (Sects. 4.1.3, 4.3.1, and 4.4).
</p>
<p>2.6 Exercises
</p>
<p>Exercise 2.1 Consider the results of the national elections in South Africa in 2014
</p>
<p>and 2009:
</p>
<p>Party Results 2014 (%) Results 2009 (%)
</p>
<p>ANC (African National Congress) 62.15 65.90
</p>
<p>DA (Democratic Alliance) 22.23 16.66
</p>
<p>EFF (Economic Freedom Fighters) 6.35 &ndash;
</p>
<p>IFP (Inkatha Freedom Party) 2.40 4.55
</p>
<p>COPE (Congress of the People) 0.67 7.42
</p>
<p>Others 6.20 5.47
</p>
<p>(a) Summarize the results of the 2014 elections in a bar chart. Do it manually and
</p>
<p>by using R.
</p>
<p>(b) How would you compare the results of the 2009 and 2014 elections? Offer a
</p>
<p>simple solution that can be represented in a single plot. Construct this plot in R.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>2.6 Exercises 33
</p>
<p>Exercise 2.2 Consider a variable X describing the time until the first goal was scored
</p>
<p>in the matches of the 2006 football World Cup competition. Only matches with at
</p>
<p>least one goal are considered, and goals during the x th minute of extra time are
</p>
<p>denoted as 90+ x :
</p>
<p>6 24 90+1 8 4 25 3 83 89 34 25 24 18 6
</p>
<p>23 10 28 4 63 6 60 5 40 2 22 26 23 26
</p>
<p>44 49 34 2 33 9 16 55 23 13 23 4 8 26
</p>
<p>70 4 6 60 23 90+5 28 49 6 57 33 56 7
</p>
<p>(a) What is the scale of X?
</p>
<p>(b) Write down the frequency table of X based on the following categories: [0, 15),
</p>
<p>[15, 30), [30, 45), [45, 60), [60, 75), [75, 90), [90, 96).
</p>
<p>(c) Draw the histogram for X with intervals relating to the groups from the frequency
</p>
<p>table.
</p>
<p>(d) Now use R to reproduce the histogram. Compare the histogram to a kernel
</p>
<p>density plot of your choice.
</p>
<p>(e) Calculate the empirical cumulative distribution function for the grouped data.
</p>
<p>(f) Use R to plot the ECDF (via a step function) for
</p>
<p>(i) the original data and
</p>
<p>(ii) the grouped data.
</p>
<p>(g) Consider the grouped data. Now assume that the values within each interval are
</p>
<p>distributed uniformly. Determine the proportion of first goals which occurred
</p>
<p>(i) in the first half, i.e. during the first 45 min,
</p>
<p>(ii) in the last 10 min or during the extra time,
</p>
<p>(iii) between the 20th and 65th min, i.e. what is H(20 &le; X &le; 65)?
</p>
<p>(h) Determine the time point at which in 80 % of the matches the first goal was
</p>
<p>scored at or before this time point.
</p>
<p>Exercise 2.3 Suppose we have the following information to construct a histogram
</p>
<p>for a continuous variable with 2000 observations:
</p>
<p>j e j&minus;1 e j d j h j
</p>
<p>1 0 1 1 0.125
</p>
<p>2 1 4 3 0.125
</p>
<p>3 4 7 3 0.125
</p>
<p>4 7 8 1 0.125
</p>
<p>(a) Determine the relative frequencies for each interval.
</p>
<p>(b) Determine the absolute frequencies.</p>
<p/>
</div>
<div class="page"><p/>
<p>34 2 Frequency Measures and Graphical Representation of Data
</p>
<p>Exercise 2.4 A university survey was conducted on 500 first-year students to obtain
</p>
<p>knowledge about the size of their accommodation (in square metres).
</p>
<p>j Size of accommodation (m2)
</p>
<p>e j&minus;1 &le; x &le; e j
</p>
<p>F(x)
</p>
<p>1 8&ndash;14 0.25
</p>
<p>2 14&ndash;22 0.40
</p>
<p>3 22&ndash;34 0.75
</p>
<p>4 34&ndash;50 0.97
</p>
<p>5 50&ndash;82 1.00
</p>
<p>(a) Determine the absolute frequencies for each category.
</p>
<p>(b) What proportion of people live in a flat of at least 34 m2?
</p>
<p>Exercise 2.5 Consider a survey in which 100 people were asked to rate on a scale
</p>
<p>from 1 to 10 howmuch they agree with the statement that &ldquo;there is too much football
</p>
<p>on television&rdquo;. The results are summarized below:
</p>
<p>Score 0 1 2 3 4 5 6 7 8 9 10
</p>
<p>Responses 0 1 3 8 8 27 30 11 6 4 2
</p>
<p>(a) Calculate and draw the ECDF of the scores.
</p>
<p>(b) Determine F(3) and F(9).
</p>
<p>(c) Consider the situation, where the data is summarized in the two categories &ldquo;dis-
</p>
<p>agree&rdquo; (score &le; 5) and &ldquo;agree&rdquo; (score &gt; 5). What would the ECDF look like
</p>
<p>under the approach outlined in (2.11)? Determine F(3) and F(9) for the sum-
</p>
<p>marized data.
</p>
<p>(d) Explain the differences between (b) and (c).
</p>
<p>Exercise 2.6 It is possible to produce professional graphics in R. However, it is
</p>
<p>advantageous to go beyond the default options. To demonstrate this, consider Exam-
</p>
<p>ple 2.1.3 about the pizza delivery data, which is described in Appendix A.4.
</p>
<p>(a) Set the working directory in R (setwd()), read in the data (read.csv()), and
</p>
<p>attach the data. Draw a histogram of the variable &ldquo;temperature&rdquo;. Type ?hist,
</p>
<p>and view the options. Adjust the histogram so that you are satisfied with (i) axes
</p>
<p>labelling, (ii) axes range, and (iii) colour. Now use the lines() command to
</p>
<p>add a dashed vertical line at 65 ◦C (which is the minimum temperature the pizza
</p>
<p>should have at the time of delivery).
</p>
<p>(b) Consider a different approach, which constructs plots by means of multiple lay-
</p>
<p>ers using ggplot2. You need an Internet connection to install the package using
</p>
<p>the command install.packages(&rsquo;ggplot2&rsquo;). Browse through the help</p>
<p/>
</div>
<div class="page"><p/>
<p>2.6 Exercises 35
</p>
<p>pages on http://docs.ggplot2.org/current/. Look specifically at the examples for
</p>
<p>ggplot, qplot, scale_histogram, and scale_y_continuous. Try to
</p>
<p>understand the roles of &ldquo;aesthetics&rdquo; and &ldquo;geoms&rdquo;. Now, after loading the library
</p>
<p>via library(ggplot2), create a ggplot object for the pizza data,which declares
</p>
<p>&ldquo;temperature&rdquo; to be the x-variable. Now add a layer with geom_histogram to
</p>
<p>create a histogram with interval width of 2.5 and dark grey bars which are
</p>
<p>50 % transparent. Change the y-axis labelling by adding the relevant layer using
</p>
<p>scale_y_continuous. Plot the graph.
</p>
<p>(c) Now create a normal bar chart for the variable &ldquo;driver&rdquo; in R. Type ?barplot
</p>
<p>and ?par to see the options one can pass on to barchart() to adjust the graph.
</p>
<p>Make the graph look good.
</p>
<p>(d) Now create the same bar chart with ggplot2. Use qplot instead of ggplot
</p>
<p>to create the plot. Use an option which makes each bar to consist of segments
</p>
<p>relating to the day of delivery, so that one can see the number of deliveries by
</p>
<p>driver to highlight during which days the drivers delivered most often. Browse
</p>
<p>through &ldquo;themes&rdquo; and &ldquo;scales&rdquo; on the help page, and add layers that make the
</p>
<p>background black and white and the bars on a grey scale.
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 325
</p>
<p>&lowast;Source Toutenburg, H., Heumann, C., Deskriptive Statistik, 7th edition, 2009,
</p>
<p>Springer, Heidelberg</p>
<p/>
<div class="annotation"><a href="http://docs.ggplot2.org/current/">http://docs.ggplot2.org/current/</a></div>
</div>
<div class="page"><p/>
<p>3Measures of CentralTendency andDispersion
</p>
<p>A data set may contain many variables and observations. However, we are not always
</p>
<p>interested in each of the measured values but rather in a summary which interprets the
</p>
<p>data. Statistical functions fulfil the purpose of summarizing the data in a meaningful
</p>
<p>yet concise way.
</p>
<p>Example 3.0.1 Suppose someone from Munich (Germany) plans a holiday in
</p>
<p>Bangkok (Thailand) during the month of December and would like to get infor-
</p>
<p>mation about the weather when preparing for the trip. Suppose last year&rsquo;s maximum
</p>
<p>temperatures during the day (in degrees Celsius) for December 1&ndash;31 are as follows:
</p>
<p>22, 24, 21, 22, 25, 26, 25, 24, 23, 25, 25, 26, 27, 25, 26,
</p>
<p>25, 26, 27, 27, 28, 29, 29, 29, 28, 30, 29, 30, 31, 30, 28, 29.
</p>
<p>How do we draw conclusions from this data? Looking at the individual values gives
</p>
<p>us a feeling about the temperatures one can experience in Bangkok, but it does not
</p>
<p>provide us with a clear summary. It is evident that the average of these 31 values as
</p>
<p>&ldquo;Sum of all values/Total number of observations&rdquo; (22 + 24 + &middot; &middot; &middot; + 28 + 29)/31 =
26.48 is meaningful in the sense that we know what temperature to expect &ldquo;on
</p>
<p>average&rdquo;. To choose the right clothing for the holidays, we may also be interested in
</p>
<p>knowing the temperature range to understand the variability in temperature, which
</p>
<p>is between 21 and 31 ◦C. Summarizing 31 individual values with only three numbers
(26.48, 21, and 31) will provide sufficient information to plan the holidays.
</p>
<p>In this chapter, we focus on the most important statistical concepts to summarize
</p>
<p>data: these are measures of central tendency and variability. The applications of each
</p>
<p>measure depend on the scale of the variable of interest, see Appendix D.1 for a
</p>
<p>detailed summary.
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_3
</p>
<p>37</p>
<p/>
</div>
<div class="page"><p/>
<p>38 3 Measures of Central Tendency and Dispersion
</p>
<p>3.1 Measures of Central Tendency
</p>
<p>A natural human tendency is to make comparisons with the &ldquo;average&rdquo;. For example,
</p>
<p>a student scoring 40 % in an examination will be happy with the result if the average
</p>
<p>score of the class is 25 %. If the average class score is 90 %, then the student may not
</p>
<p>feel happy even if he got 70 % right. Some other examples of the use of &ldquo;average&rdquo;
</p>
<p>values in common life are mean body height, mean temperature in July in some
</p>
<p>town, the most often selected study subject, the most popular TV show in 2015, and
</p>
<p>average income. Various statistical concepts refer to the &ldquo;average&rdquo; of the data, but
</p>
<p>the right choice depends upon the nature and scale of the data as well as the objective
</p>
<p>of the study. We call statistical functions which describe the average or centre of the
</p>
<p>data location parameters or measures of central tendency.
</p>
<p>3.1.1 Arithmetic Mean
</p>
<p>The arithmetic mean is one of the most intuitive measures of central tendency.
</p>
<p>Suppose a variable of size n consists of the values x1, x2, . . . , xn . The arithmetic
</p>
<p>mean of this data is defined as
</p>
<p>x̄ =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
xi . (3.1)
</p>
<p>In informal language, we often speak of &ldquo;the average&rdquo; or just &ldquo;the mean&rdquo; when using
</p>
<p>the formula (3.1).
</p>
<p>To calculate the arithmetic mean for grouped data, we need the following fre-
</p>
<p>quency table:
</p>
<p>Class intervals a j a1 = e0 &minus; e1 a2 = e1 &minus; e2 &hellip; ak = ek&minus;1 &minus; ek
Absolute freq. n j n1 n2 &hellip; nk
</p>
<p>Relative freq. f j f1 f2 &hellip; fk
</p>
<p>Note that a1, a2, . . . , ak are the k class intervals and each interval a j ( j = 1, 2, . . . , k)
contains n j observations with
</p>
<p>&sum;k
j=1 n j = n. The relative frequency of the j th class
</p>
<p>is f j = n j/n and
&sum;k
</p>
<p>j=1 f j = 1. The mid-value of the j th class interval is defined as
m j = (e j&minus;1 + e j )/2, which is the mean of the lower and upper limits of the interval.
The weighted arithmetic mean for grouped data is defined as
</p>
<p>x̄ =
1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
n j m j =
</p>
<p>k
&sum;
</p>
<p>j=1
f j m j . (3.2)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.1 Measures of Central Tendency 39
</p>
<p>Example 3.1.1 Consider again Example 3.0.1 where we looked at the temperature
</p>
<p>in Bangkok during December. The measurements were
</p>
<p>22, 24, 21, 22, 25, 26, 25, 24, 23, 25, 25, 26, 27, 25, 26,
</p>
<p>25, 26, 27, 27, 28, 29, 29, 29, 28, 30, 29, 30, 31, 30, 28, 29 .
</p>
<p>The arithmetic mean is therefore
</p>
<p>x̄ =
22 + 24 + 21 + &middot; &middot; &middot; + 28 + 29
</p>
<p>31
= 26.48 ◦C.
</p>
<p>In R, the arithmetic mean can be calculated using the mean command:
</p>
<p>weather &lt;- c(22,24,21,,30,28,29)
</p>
<p>mean(weather)
</p>
<p>[1] 26.48387
</p>
<p>Let us assume the data in Example 3.0.1 is summarized in categories as
</p>
<p>follows:
</p>
<p>Class intervals &lt; 20 (20 &minus; 25] (25, 30] (30, 35] &gt; 35
Absolute frequencies n1 = 0 n2 = 12 n3 = 18 n4 = 1 n5 = 0
Relative frequencies f1 = 0 f2 = 1231 f3 =
</p>
<p>18
31
</p>
<p>f4 = 131 f5 = 0
</p>
<p>We can calculate the (weighted) arithmetic mean as
</p>
<p>x̄ =
k
</p>
<p>&sum;
</p>
<p>j=1
f j m j = 0 +
</p>
<p>12
</p>
<p>31
&middot; 22.5 +
</p>
<p>18
</p>
<p>31
&middot; 27.5 +
</p>
<p>1
</p>
<p>31
32.5 + 0 &asymp; 25.7.
</p>
<p>In R, we use the weighted.mean function to obtain the result. The function requires
</p>
<p>to specify the (hypothesized) means for each group, for example the middle values
</p>
<p>of the class intervals, as well as the weights.
</p>
<p>weighted.mean(c(22.5,27.5,32.5),c(12/31,18/31,1/31))
</p>
<p>Interestingly, the results of the mean and the weighted mean differ. This is because
</p>
<p>we use the middle of each class as an approximation of the mean within the class. The
</p>
<p>implication is that we assume that the values are uniformly distributed within each
</p>
<p>interval. This assumption is obviously not met. If we had knowledge about the mean
</p>
<p>in each class, like in this example, we would obtain the correct result as follows:
</p>
<p>x̄ =
k
</p>
<p>&sum;
</p>
<p>j=1
f j x̄ j = 0 +
</p>
<p>12
</p>
<p>31
&middot; 23.83333 +
</p>
<p>18
</p>
<p>31
&middot; 28 +
</p>
<p>1
</p>
<p>31
32.5 + 0 = 26.48387.
</p>
<p>However, the weighted mean is meant to estimate the arithmetic mean in those
</p>
<p>situations where only grouped data is available. It is therefore typically used to
</p>
<p>obtain an approximation of the true mean.</p>
<p/>
</div>
<div class="page"><p/>
<p>40 3 Measures of Central Tendency and Dispersion
</p>
<p>Properties of the Arithmetic Mean.
</p>
<p>(i) The sum of the deviations of each variable around the arithmetic mean is zero:
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; x̄) =
</p>
<p>n
&sum;
</p>
<p>i=1
xi &minus; nx̄ = nx̄ &minus; nx̄ = 0. (3.3)
</p>
<p>(ii) If the data is linearly transformed as yi = a + bxi , where a and b are known
constants, it holds that
</p>
<p>ȳ =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
yi =
</p>
<p>1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
(a + bxi ) =
</p>
<p>1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
a +
</p>
<p>b
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
xi = a + bx̄ . (3.4)
</p>
<p>Example 3.1.2 Recall Examples 3.0.1 and 3.1.1 where we considered the tempera-
</p>
<p>tures in December in Bangkok. We measured them in degrees Celsius, but someone
</p>
<p>from the USA might prefer to know them in degrees Fahrenheit. With a linear trans-
</p>
<p>formation, we can create a new temperature variable as
</p>
<p>Temperature in ◦F = 32 + 1.8 Temperature in ◦C.
</p>
<p>Using ȳ = a + bx̄ , we get ȳ = 32 + 1.8 &middot; 26.48 &asymp; 79.7 ◦F.
</p>
<p>3.1.2 Median and Quantiles
</p>
<p>The median is the value which divides the observations into two equal parts such
</p>
<p>that at least 50 % of the values are greater than or equal to the median and at least
</p>
<p>50 % of the values are less than or equal to the median. The median is denoted by
</p>
<p>x̃0.5; then, in terms of the empirical cumulative distribution function, the condition
</p>
<p>F(x̃0.5) = 0.5 is satisfied. Consider the n observations x1, x2, . . . , xn which can
be ordered as x(1) &le; x(2) &le; &middot; &middot; &middot; &le; x(n). The calculation of the median depends on
whether the number of observations n is odd or even. When n is odd, then x̃0.5 is the
</p>
<p>middle ordered value. When n is even, then x̃0.5 is the arithmetic mean of the two
</p>
<p>middle ordered values:
</p>
<p>x̃0.5 =
{
</p>
<p>x((n+1)/2) if n is odd
1
2
(x(n/2) + x(n/2+1)) if n is even.
</p>
<p>(3.5)
</p>
<p>Example 3.1.3 Consider again Examples 3.0.1&ndash;3.1.2 where we evaluated the tem-
</p>
<p>perature in Bangkok in December. The ordered values x(i), i = 1, 2, . . . , 31, are as
follows:
</p>
<p>◦C 21 22 22 23 24 24 25 25 25 25 25 25 26 26 26 26
(i) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
◦C 27 27 27 28 28 28 29 29 29 29 29 30 30 30 31
(i) 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31</p>
<p/>
</div>
<div class="page"><p/>
<p>3.1 Measures of Central Tendency 41
</p>
<p>We have n = 31, and therefore x̃0.5 = x((n+1)/2) = x((31+1)/2) = x(16) = 26. There-
fore, at least 50 % of the 31 observations are greater than or equal to 26 and at least
</p>
<p>50 % are less than or equal to 26. If one value was missing, let us say the last observa-
</p>
<p>tion, then the median would be calculated as 1
2
(x(30/2) + x(30/2+1)) = 12 (26 + 26) =
</p>
<p>26. In R, we would have obtained the results using the median command:
</p>
<p>median(weather)
</p>
<p>If we deal with grouped data, we can calculate the median under the assumption
</p>
<p>that the values within each class are equally distributed. Let K1, K2, . . . , Kk be
</p>
<p>k classes with observations of size n1, n2, . . . , nk , respectively. First, we need to
</p>
<p>determine which class is the median class, i.e. the class that includes the median. We
</p>
<p>define the median class as the class Km for which
</p>
<p>m&minus;1
&sum;
</p>
<p>j=1
f j &lt; 0.5 and
</p>
<p>m
&sum;
</p>
<p>j=1
f j &ge; 0.5 (3.6)
</p>
<p>hold. Then, we can determine the median as
</p>
<p>x̃0.5 = em&minus;1 +
0.5 &minus;
</p>
<p>&sum;m&minus;1
j=1 f j
</p>
<p>fm
dm (3.7)
</p>
<p>where em&minus;1 denotes the lower limit of the interval Km and dm is the width of the
interval Km .
</p>
<p>Example 3.1.4 Recall Example 3.1.1 where we looked at the grouped temperature
</p>
<p>data:
</p>
<p>Class intervals &lt;20 (20&ndash;25] (25, 30] (30, 35] &gt;35
n j n1 = 0 n2 = 12 n3 = 18 n4 = 1 n5 = 0
f j f1 = 0 f2 = 1231 f3 =
</p>
<p>18
31
</p>
<p>f4 = 131 f5 = 0
&sum;
</p>
<p>j f j 0
12
31
</p>
<p>30
31
</p>
<p>1 1
</p>
<p>For the third class (m = 3), we have
m&minus;1
&sum;
</p>
<p>j=1
f j =
</p>
<p>12
</p>
<p>31
&lt; 0.5 and
</p>
<p>m
&sum;
</p>
<p>j=1
f j =
</p>
<p>30
</p>
<p>31
&ge; 0.5.
</p>
<p>We can therefore calculate the median as
</p>
<p>x̃0.5 = em&minus;1 +
0.5 &minus;
</p>
<p>&sum;m&minus;1
j=1 f j
</p>
<p>fm
dm = 25 +
</p>
<p>0.5 &minus; 12
31
</p>
<p>18
31
</p>
<p>&middot; 5 &asymp; 25.97.</p>
<p/>
</div>
<div class="page"><p/>
<p>42 3 Measures of Central Tendency and Dispersion
</p>
<p>7 8 9 10 11 12 13
</p>
<p>0
.0
</p>
<p>0
.1
</p>
<p>0
.2
</p>
<p>0
.3
</p>
<p>0
.4
</p>
<p>mean
</p>
<p>median
</p>
<p>(a) Symmetric data
</p>
<p>0 2 4 6
</p>
<p>0
.0
</p>
<p>0
.1
</p>
<p>0
.2
</p>
<p>0
.3
</p>
<p>0
.4
</p>
<p>0
.5
</p>
<p>0
.6
</p>
<p>0
.7
</p>
<p>mean
</p>
<p>median
</p>
<p>(b) Skewed data
</p>
<p>&minus;5 0 5 10
</p>
<p>0
.0
</p>
<p>0
0
.0
</p>
<p>5
0
.1
</p>
<p>0
0
.1
</p>
<p>5
0
.2
</p>
<p>0 mean
</p>
<p>median
</p>
<p>(c) Bimodal data
</p>
<p>10 20 30 40 50 60
</p>
<p>0
.0
</p>
<p>0
0
.1
</p>
<p>0
0
.2
</p>
<p>0
0
.3
</p>
<p>0 mean
</p>
<p>median
</p>
<p>(d) Data with outliers
</p>
<p>Fig. 3.1 Arithmetic mean and median for different data
</p>
<p>Comparing the Mean with the Median. In the above examples, the mean and the
</p>
<p>median turn out to be quite similar to each other. This is because we looked at data
</p>
<p>which is symmetrically distributed around its centre, i.e. on average, we can expect
</p>
<p>26 ◦C with deviations that are similar above and below the average temperature.
A similar example is given in Fig. 3.1a: we see that the raw data is summarized by
</p>
<p>using ticks at the bottom of the graph and by using a kernel density estimator. The
</p>
<p>mean and the median are similar here because the distribution of the observations
</p>
<p>is symmetric around the centre. If we have skewed data (Fig. 3.1b), then the mean
</p>
<p>and the median may differ. If the data has more than one centre, such as in Fig. 3.1c,
</p>
<p>neither the median nor the mean has meaningful interpretations. If we have outliers
</p>
<p>(Fig. 3.1d), then it is wise to use the median because the mean is sensitive to outliers.
</p>
<p>These examples show that depending on the situation of interest either the mean, the
</p>
<p>median, both or neither of them can be useful.</p>
<p/>
</div>
<div class="page"><p/>
<p>3.1 Measures of Central Tendency 43
</p>
<p>Quantiles. Quantiles are a generalization of the idea of the median. The median is
</p>
<p>the value which splits the data into two equal parts. Similarly, a quantile partitions
</p>
<p>the data into other proportions. For example, a 25 %-quantile splits the data into two
</p>
<p>parts such that at least 25 % of the values are less than or equal to the quantile and at
</p>
<p>least 75 % of the values are greater than or equal to the quantile. In general, let α be a
</p>
<p>number between zero and one. The (α &times; 100)%-quantile, denoted as x̃α , is defined as
the value which divides the data in proportions of (α &times; 100)% and (1 &minus; α)&times; 100 %
such that at least α &times; 100 % of the values are less than or equal to the quantile and
at least (1 &minus; α)&times; 100 % of the values are greater than or equal to the quantile. In
terms of the empirical cumulative distribution function, we can write F(x̃α) = α. It
follows immediately that for n observations, at least nα values are less than or equal
</p>
<p>to x̃α and at least n(1 &minus; α) observations are greater than or equal to x̃α . The median
is the 50 %-quantile x̃0.5. If α takes the values 0.1, 0.2, . . . , 0.9, the quantiles are
</p>
<p>called deciles. If α &middot; 100 is an integer number (e.g. α &times; 100 = 95), the quantiles are
called percentiles, i.e. the data is divided into 100 equal parts. If α takes the values
</p>
<p>0.2, 0.4, 0.6, and 0.8, the quantiles are known as quintiles and they divide the data
</p>
<p>into five equal parts. If α takes the values 0.25, 0.5, and 0.75, the quantiles are called
</p>
<p>quartiles.
</p>
<p>Consider n ordered observations x(1) &le; x(2) &le; &middot; &middot; &middot; &le; x(n). The α &middot; 100 %-quantile
x̃α is calculated as
</p>
<p>x̃α =
</p>
<p>⎧
</p>
<p>⎨
</p>
<p>⎩
</p>
<p>x(k) if nα is not an integer number,
</p>
<p>choose k as the smallest integer &gt; nα,
1
2
(x(nα) + x(nα+1)) if nα is an integer.
</p>
<p>(3.8)
</p>
<p>Example 3.1.5 Recall Examples 3.0.1&ndash;3.1.4 where we evaluated the temperature in
</p>
<p>Bangkok in December. The ordered values x(i), i = 1, 2, . . . , 31 are as follows:
◦C 21 22 22 23 24 24 25 25 25 25 25 25 26 26 26 26
(i) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
◦C 27 27 27 28 28 28 29 29 29 29 29 30 30 30 31
(i) 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
</p>
<p>To determine the quartiles, i.e. the 25, 50, and 75 % quantiles, we calculate nα as
</p>
<p>31 &middot; 0.25 = 7.75, 31 &middot; 0.5 = 15.5, and 31 &middot; 0.75 = 23.25. Using (3.8), it follows that
x̃0.25 = x(8) = 25, x̃0.5 = x(16) = 26,
</p>
<p>x̃0.75 = x(24) = 29.
In R, we obtain the same results using the quantile function. The probs argument
</p>
<p>is used to specify α. By default, the quartiles are reported.
</p>
<p>quantile(weather)
</p>
<p>quantile(weather, probs=c(0,0.25,0.5,0.75,1))
</p>
<p>However, please note that R offers nine different ways to obtain quantiles, each
</p>
<p>of which can be chosen by the type argument. See Hyndman and Fan (1996) for
</p>
<p>more details.</p>
<p/>
</div>
<div class="page"><p/>
<p>44 3 Measures of Central Tendency and Dispersion
</p>
<p>10 20 30 40 50 60
</p>
<p>1
0
</p>
<p>2
0
</p>
<p>3
0
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>Delivery time from Luigi
</p>
<p>D
e
liv
</p>
<p>e
ry
</p>
<p> t
im
</p>
<p>e
 f
ro
</p>
<p>m
 D
</p>
<p>o
m
</p>
<p>e
n
ic
</p>
<p>o
</p>
<p>(a) QQ-plot for Luigi and Domenico
</p>
<p>10 20 30 40 50 60
</p>
<p>1
0
</p>
<p>2
0
</p>
<p>3
0
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>Delivery time from Mario
</p>
<p>D
e
liv
</p>
<p>e
ry
</p>
<p> t
im
</p>
<p>e
 f
ro
</p>
<p>m
 S
</p>
<p>a
lv
</p>
<p>a
to
</p>
<p>re
</p>
<p>(b) QQ-plot for Mario and Salvatore
</p>
<p>Fig. 3.2 QQ-plots for the pizza delivery time for different drivers
</p>
<p>3.1.3 Quantile&ndash;Quantile Plots (QQ-Plots)
</p>
<p>If we plot the quantiles of two variables against each other, we obtain a Quantile&ndash;
</p>
<p>Quantile plot (QQ-plot). This provides a simple summary of whether the distributions
</p>
<p>of the two variables are similar with respect to their location or not.
</p>
<p>Example 3.1.6 Consider again the pizza data which is described in Appendix A.4. We
</p>
<p>may be interested in the delivery time for different drivers to see if their performance
</p>
<p>is the same. Figure 3.2a shows a QQ-plot for the delivery time of driver Luigi and
</p>
<p>the delivery time of driver Domenico. Each point refers to the α% quantile of both
</p>
<p>drivers. If the point lies on the bisection line, then they are identical and we conclude
</p>
<p>that the quantiles of the both drivers are the same. If the point is below the line, then
</p>
<p>the quantile is higher for Luigi, and if the point is above the line, then the quantile is
</p>
<p>lower for Luigi. So if all the points lie exactly on the line, we can conclude that the
</p>
<p>distributions of both the drivers are the same. We see that all the reported quantiles
</p>
<p>lie below the line, which implies that all the quantiles of Luigi have higher values
</p>
<p>than those of Domenico. This means that not only on an average, but also in general,
</p>
<p>the delivery times are higher for Luigi. If we look at two other drivers, as displayed
</p>
<p>in Fig. 3.2b, the points lie very much on the bisection line. We can therefore conclude
</p>
<p>that the delivery times of these two drivers do not differ much.
</p>
<p>In R, we can generate QQ-plots by using the qqplot command:
</p>
<p>qqplot()</p>
<p/>
</div>
<div class="page"><p/>
<p>3.1 Measures of Central Tendency 45
</p>
<p>Fig. 3.3 Different patterns for a QQ-plot
</p>
<p>As a summary, let us consider four important patterns:
</p>
<p>(a) If all the pairs of quantiles lie (nearly) on a straight line at an angle of 45 % from
</p>
<p>the x-axis, then the two samples have similar distributions (Fig. 3.3a).
</p>
<p>(b) If the y-quantiles are lower than the x-quantiles, then the y-values have a ten-
</p>
<p>dency to be lower than the x-values (Fig. 3.3b).
</p>
<p>(c) If the x-quantiles are lower than the y-quantiles, then the x-values have a ten-
</p>
<p>dency to be lower than the y-values (Fig. 3.3c).
</p>
<p>(d) If the QQ-plot is like Fig. 3.3d, it indicates that there is a break point up to which
</p>
<p>the y-quantiles are lower than the x-quantiles and after that point, the y-quantiles
</p>
<p>are higher than the x-quantiles.
</p>
<p>3.1.4 Mode
</p>
<p>Consider a situation in which an ice cream shop owner wants to know which flavour
</p>
<p>of ice cream is the most popular among his customers. Similarly, a footwear shop
</p>
<p>owner may like to find out what design and size of shoes are in highest demand. To
</p>
<p>answer this type of questions, one can use the mode which is another measure of
</p>
<p>central tendency.
</p>
<p>The mode x̄M of n observations x1, x2, . . . , xn is the value which occurs the
</p>
<p>most compared with all other values, i.e. the value which has maximum absolute
</p>
<p>frequency. It may happen that two or more values occur with the same frequency in
</p>
<p>which case the mode is not uniquely defined. A formal definition of the mode is
</p>
<p>x̄M = a j &hArr; n j = max {n1, n2, . . . , nk} . (3.9)
The mode is typically applied to any type of variable for which the number of different
</p>
<p>values is not too large. If continuous data is summarized in groups, then the mode
</p>
<p>can be used as well.
</p>
<p>Example 3.1.7 Recall the pizza data set described in Appendix A.4. The pizza deliv-
</p>
<p>ery service has three branches, in the East, West, and Centre, respectively. Suppose
</p>
<p>we want to know which branch delivers the most pizzas. We find that most of the de-
</p>
<p>liveries have been made in the West, see Fig. 3.4a; therefore the mode is x̄M = West.
Similarly, suppose we also want to find the mode for the categorized pizza deliv-
</p>
<p>ery time: if we group the delivery time in intervals of 5 min, then we see that the
</p>
<p>most frequent delivery time is the interval &ldquo;30&minus;35&rdquo; min, see Fig. 3.4b. The mode is
therefore x̄M = [30, 35).</p>
<p/>
</div>
<div class="page"><p/>
<p>46 3 Measures of Central Tendency and Dispersion
</p>
<p>Centre East West
</p>
<p>Branch
</p>
<p>a
b
s
o
lu
</p>
<p>te
 f
re
</p>
<p>q
u
e
n
c
y
</p>
<p>0
1
0
0
</p>
<p>2
0
0
</p>
<p>3
0
0
</p>
<p>4
0
0
</p>
<p>5
0
0
</p>
<p>(a) Bar chart for branch
</p>
<p>Delivery Time (in min)
</p>
<p>D
e
n
s
it
y
</p>
<p>10 20 30 40 50 60
</p>
<p>0
.0
</p>
<p>0
0
.0
</p>
<p>1
0
.0
</p>
<p>2
0
.0
</p>
<p>3
0
.0
</p>
<p>4
0
.0
</p>
<p>5
0
.0
</p>
<p>6
</p>
<p>(b) Histogram for grouped delivery time
</p>
<p>Fig. 3.4 Results from the pizza data set
</p>
<p>3.1.5 Geometric Mean
</p>
<p>Consider n observations x1, x2, . . . , xn which are all positive and collected on a
</p>
<p>quantitative variable. The geometric mean x̄G of this data is defined as
</p>
<p>x̄G = n
&radic;
&radic;
&radic;
&radic;
</p>
<p>n
&prod;
</p>
<p>i=1
xi =
</p>
<p>(
n
&prod;
</p>
<p>i=1
xi
</p>
<p>) 1
n
</p>
<p>. (3.10)
</p>
<p>The geometric mean plays an important role in fields where we are interested in
</p>
<p>products of observations, such as when we look at percentage changes in quantities.
</p>
<p>We illustrate its interpretation and use by looking at the average growth of a quantity
</p>
<p>in the sense that we allow a starting value, such as a certain amount of money or a
</p>
<p>particular population, to change over time. Suppose we have a starting value at some
</p>
<p>baseline time point 0 (zero), which may be denoted as B0. At time t , this value may
</p>
<p>have changed and we therefore denote it as Bt , t = 1, 2, . . . , T . The ratio of Bt and
Bt&minus;1,
</p>
<p>xt =
Bt
</p>
<p>Bt&minus;1
,
</p>
<p>is called the t th growth factor. The growth rate rt is defined as
</p>
<p>rt = ((xt &minus; 1) &middot; 100)%
</p>
<p>and gives us an idea about the growth or decline of our value at time t . We can
</p>
<p>summarize these concepts in the following table:</p>
<p/>
</div>
<div class="page"><p/>
<p>3.1 Measures of Central Tendency 47
</p>
<p>Time Inventory Growth factor Growth rate
</p>
<p>t Bt xt rt
</p>
<p>0 B0 &ndash; &ndash;
</p>
<p>1 B1 x1 = B1/B0 ((x1 &minus; 1) &middot; 100)%
2 B2 x2 = B2/B1 ((x2 &minus; 1) &middot; 100)%
.
.
.
</p>
<p>.
</p>
<p>.
</p>
<p>.
.
.
.
</p>
<p>.
</p>
<p>.
</p>
<p>.
</p>
<p>T BT xT = BT /BT&minus;1 ((xT &minus; 1) &middot; 100)%
</p>
<p>We can calculate Bt (t = 1, 2, . . . , T ) by using the growth factors:
Bt = B0 &middot; x1 &middot; x2 &middot; . . . &middot; xt .
</p>
<p>The average growth factor from B0 to BT is the geometric mean or geometric average
</p>
<p>of the growth factors:
</p>
<p>x̄G = T
&radic;
</p>
<p>x1 &middot; x2 &middot; . . . &middot; xT
</p>
<p>= T
&radic;
</p>
<p>B0 &middot; x1 &middot; x2 &middot; . . . &middot; xT
B0
</p>
<p>= T
&radic;
</p>
<p>BT
</p>
<p>B0
. (3.11)
</p>
<p>Therefore, Bt at time t can be calculated as Bt = B0 &middot; x̄ tG .
</p>
<p>Example 3.1.8 Suppose someone wants to deposit money, say e1000, in a bank.
</p>
<p>The bank advisor proposes a 5-year savings plan with the following plan for interest
</p>
<p>rates: 1 % in the first year, 1.5 % in the second year, 2.5 % in the third year, and 3 %
</p>
<p>in the last 2 years. Now he would like to calculate the average growth factor and
</p>
<p>average growth rate for the invested money. The concept of the geometric mean can
</p>
<p>be used as follows:
</p>
<p>Year Euro Growth factor Growth rate (%)
</p>
<p>0 1000 &ndash; &ndash;
</p>
<p>1 1010 1.01 1.0
</p>
<p>2 1025.15 1.015 1.5
</p>
<p>3 1050.78 1.025 2.5
</p>
<p>4 1082.30 1.03 3.0
</p>
<p>5 1114.77 1.03 3.0
</p>
<p>The geometric mean is calculated as
</p>
<p>x̄G = (1.01 &middot; 1.015 &middot; 1.025 &middot; 1.03 &middot; 1.03)
1
5 = 1.021968
</p>
<p>which means that he will have on average about 2.2 % growth per year. The savings
</p>
<p>after 5 years can be calculated as
</p>
<p>e 1000 &middot; 1.0219685 = e 1114.77.
It is easy to compare two different saving plans with different growth strategies using
</p>
<p>the geometric mean.</p>
<p/>
</div>
<div class="page"><p/>
<p>48 3 Measures of Central Tendency and Dispersion
</p>
<p>3.1.6 Harmonic Mean
</p>
<p>The harmonic mean is typically used whenever different xi contribute to the mean
</p>
<p>with a different weight wi , i.e. when we implicitly assume that the weight of each
</p>
<p>xi is not one. It can be calculated as
</p>
<p>x̄H =
w1 + w2 + &middot; &middot; &middot; + wk
w1
x1
</p>
<p>+ w2
x2
</p>
<p>+ &middot; &middot; &middot; + wk
xk
</p>
<p>=
&sum;k
</p>
<p>i=1 wi
&sum;k
</p>
<p>i=1
wi
xi
</p>
<p>. (3.12)
</p>
<p>For example, when calculating the average speed, each weight relates to the rela-
</p>
<p>tive distance travelled, ni/n, with speed xi . Using wi = ni/n and
&sum;
</p>
<p>i wi =
&sum;
</p>
<p>i ni/
</p>
<p>n = 1, the harmonic mean can be written as
</p>
<p>x̄H =
1
</p>
<p>&sum;k
i=1
</p>
<p>wi
xi
</p>
<p>. (3.13)
</p>
<p>Example 3.1.9 Suppose an investor bought shares worthe1000 for two consecutive
</p>
<p>months. The price for a share was e50 in the first month and e200 in the second
</p>
<p>month. What is the average purchase price? The number of shares purchased in
</p>
<p>the first month is 1000/50 = 20. The number of shares purchased in the second
month is 1000/200 = 5. The total number of shares purchased is thus 20 + 5 = 25,
and the total investment is e2000. It is evident that the average purchase price is
</p>
<p>2000/25 = e80. This is in fact the harmonic mean calculated as
</p>
<p>x̄H =
1
</p>
<p>0.5
50
</p>
<p>+ 0.5
200
</p>
<p>= 80
</p>
<p>because the weight of each purchase is ni/n = 1000/2000 = 0.5. If the investment
was e1200 in the first month and e800 in the second month, then we could use the
</p>
<p>harmonic mean with weights 1200/2000 = 0.6 and 800/2000 = 0.4, respectively,
to obtain the results.
</p>
<p>3.2 Measures of Dispersion
</p>
<p>Measures of central tendency, as introduced earlier, give us an idea about the loca-
</p>
<p>tion where most of the data is concentrated. However, two different data sets may
</p>
<p>have the same value for the measure of central tendency, say the same arithmetic
</p>
<p>means, but they may have different concentrations around the mean. In this case, the
</p>
<p>location measures may not be adequate enough to describe the distribution of the
</p>
<p>data. The concentration or dispersion of observations around any particular value is
</p>
<p>another property which characterizes the data and its distribution. We now introduce
</p>
<p>statistical methods which describe the variability or dispersion of data.</p>
<p/>
</div>
<div class="page"><p/>
<p>3.2 Measures of Dispersion 49
</p>
<p>Example 3.2.1 Suppose three students Christine, Andreas, and Sandro arrive at dif-
</p>
<p>ferent times in the class to attend their lectures. Let us look at their arrival time in
</p>
<p>the class after or before the starting time of lecture, i.e. let us look how early or late
</p>
<p>they were (in minutes).
</p>
<p>Week 1 2 3 4 5 6 7 8 9 10
</p>
<p>Christine 0 0 0 0 0 0 0 0 0 0
</p>
<p>Andreas &minus;10 +10 &minus;10 +10 &minus;10 +10 &minus;10 +10 &minus;10 +10
Sandro 3 5 6 2 4 6 8 4 5 7
</p>
<p>We see that Christine always arrives on time (time difference of zero). Andreas arrives
</p>
<p>sometimes 10 min early and sometimes 10 min late. However, the arithmetic mean of
</p>
<p>both students is the same&mdash;on average, they both arrive on time! This interpretation
</p>
<p>is obviously not meaningful. The difference between both students is the variability
</p>
<p>in arrival times that cannot be measured with the mean or median. For this reason, we
</p>
<p>need to introduce measures of dispersion (variability). With the knowledge of both
</p>
<p>location and dispersion, we can give a much more nuanced comparison between the
</p>
<p>different arrival times. For example, consider the third student Sandro. He is always
</p>
<p>late; sometimes more, sometimes less. However, while on average he comes late, his
</p>
<p>behaviour is more predictable than that of Andreas. Both location and dispersion are
</p>
<p>needed to give a fair comparison.
</p>
<p>Example 3.2.2 Consider another example in which a supplier for the car industry
</p>
<p>needs to deliver 10 car doors with an exact width of 1.00 m. He supplies 5 doors with
</p>
<p>a width of 1.05 m and the remaining 5 doors with a width of 0.95 m. The arithmetic
</p>
<p>mean of all the 10 doors is 1.00 m. Based on the arithmetic mean, one may conclude
</p>
<p>that all the doors are good but the fact is that none of the doors are usable as they will
</p>
<p>not fit into the car. This knowledge can be summarized by a measure of dispersion.
</p>
<p>The above examples highlight that the distribution of a variable needs to be char-
</p>
<p>acterized by a measure of dispersion in addition to a measure of location (central
</p>
<p>tendency). Now we introduce various measures of dispersion.
</p>
<p>3.2.1 Range and Interquartile Range
</p>
<p>Consider a variable X with n observations x1, x2, . . . , xn . Order these n observations
</p>
<p>as x(1) &le; x(2) &le; &middot; &middot; &middot; &le; x(n). The range is a measure of dispersion defined as the
difference between the maximum and minimum value of the data as
</p>
<p>R = x(n) &minus; x(1). (3.14)
The interquartile range is defined as the difference between the 75th and 25th
</p>
<p>quartiles as
</p>
<p>dQ = x̃0.75 &minus; x̃0.25. (3.15)
It covers the centre of the distribution and contains 50 % of the observations.</p>
<p/>
</div>
<div class="page"><p/>
<p>50 3 Measures of Central Tendency and Dispersion
</p>
<p>Remark 3.2.1 Note that the interquartile range is defined as the interval [x̃0.25; x̃0.75]
in some literature. However, in line with most of the statistical literature, we define
</p>
<p>the interquartile range to be a measure of dispersion, i.e. the difference between x̃0.75
and x̃0.25.
</p>
<p>Example 3.2.3 Recall Examples 3.0.1&ndash;3.1.5 where we looked at the temperature in
</p>
<p>Bangkok during December. The ordered values x(i), i = 1, . . . , 31, are as follows:
</p>
<p>◦C 21 22 22 23 24 24 25 25 25 25 25 25 26 26 26 26
(i) 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16
◦C 27 27 27 28 28 28 29 29 29 29 29 30 30 30 31
(i) 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
</p>
<p>We obtained the quantiles in Example 3.1.5 as x̃0.25 = 25 and x̃0.75 = 29. The in-
terquartile range is therefore dQ = 29 &minus; 25 = 4, which means that 50 % of the data
is centred between 25 and 29 ◦C. The range is R = 31 &minus; 21 = 10 ◦C, meaning that
the temperature is varying at most by 10 ◦C. In R, there are several ways to ob-
tain quartiles, minimum and maximum values, e.g. by using min, max, quantiles,
</p>
<p>range, among others. All numbers can be easily obtained by the summary command
</p>
<p>which we recommend using.
</p>
<p>summary(weather)
</p>
<p>3.2.2 Absolute Deviation,Variance, and Standard Deviation
</p>
<p>Another measure of dispersion is the variance. The variance is one of the most
</p>
<p>important measures in statistics and is needed throughout this book. We use the idea of
</p>
<p>&ldquo;absolute deviation&rdquo; to give some more background and motivation for understanding
</p>
<p>the variance as a measure of dispersion, followed by some examples.
</p>
<p>Consider the deviations of n observations around a certain value &ldquo;A&rdquo; and combine
</p>
<p>them together, for instance, via the arithmetic mean of all the deviations:
</p>
<p>D =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; A). (3.16)
</p>
<p>This measure has the drawback that the deviations (xi &minus; A), i = 1, 2, . . . , n, can be
either positive or negative and, consequently, their sum can potentially be very small
</p>
<p>or even zero. Using D as a measure of variability is therefore not a good idea since
</p>
<p>D may be small even for a large variability in the data.</p>
<p/>
</div>
<div class="page"><p/>
<p>3.2 Measures of Dispersion 51
</p>
<p>Using absolute values of the deviations solves this problem, and we introduce the
</p>
<p>following measure of dispersion:
</p>
<p>D(A) =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
|xi &minus; A|. (3.17)
</p>
<p>It can be shown that the absolute deviation attains its minimum when A corresponds
</p>
<p>to the median of the data:
</p>
<p>D(x̃0.5) =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
|xi &minus; x̃0.5|. (3.18)
</p>
<p>We call D(x̃0.5) the absolute median deviation. When A = x̄ , we speak of the
absolute mean deviation given by
</p>
<p>D(x̄) =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
|xi &minus; x̄ |. (3.19)
</p>
<p>Another solution to avoid the positive and negative signs of deviation in (3.16) is to
</p>
<p>consider the squares of deviations xi &minus; A, rather than using the absolute value. This
provides another measure of dispersion as
</p>
<p>s2(A) =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; A)2 (3.20)
</p>
<p>which is known as the mean squared error (MSE) with respect to A. The MSE
</p>
<p>is another important measure in statistics, see Chap. 9, Eq. (9.4), for details. It can
</p>
<p>be shown that s2(A) attains its minimum value when A = x̄ . This is the (sample)
variance
</p>
<p>s̃2 =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; x̄)2. (3.21)
</p>
<p>After expanding s̃2, we can write (3.21) as
</p>
<p>s̃2 =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
x2i &minus; x̄2. (3.22)
</p>
<p>The positive square root of the variance is called the (sample) standard deviation,
</p>
<p>defined as
</p>
<p>s̃ =
</p>
<p>&radic;
&radic;
&radic;
&radic;
</p>
<p>1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; x̄)2. (3.23)
</p>
<p>The standard deviation has the same unit of measurement as the data whereas the
</p>
<p>unit of the variance is the square of the units of the observations. For example, if X is
</p>
<p>weight, measured in kg, then x̄ and s̃ are also measured in kg, while s̃2 is measured
</p>
<p>in kg2 (which may be more difficult to interpret). The variance is a measure which
</p>
<p>we use in other chapters to obtain measures of association between variables and to</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>52 3 Measures of Central Tendency and Dispersion
</p>
<p>draw conclusions from a sample about a population of interest; however, the standard
</p>
<p>deviation is typically preferred for a descriptive summary of the dispersion of data.
</p>
<p>The standard deviation measures how much the observations vary or how they
</p>
<p>are dispersed around the arithmetic mean. A low value of the standard deviation
</p>
<p>indicates that the values are highly concentrated around the mean. A high value of
</p>
<p>the standard deviation indicates lower concentration of the observations around the
</p>
<p>mean, and some of the observed values may even be far away from the mean. If there
</p>
<p>are extreme values or outliers in the data, then the arithmetic mean is more sensitive
</p>
<p>to outliers than the median. In such a case, the absolute median deviation (3.18) may
</p>
<p>be preferred over the standard deviation.
</p>
<p>Example 3.2.4 Consider again Example 3.2.1 where we evaluated the arrival times
</p>
<p>of Christine, Andreas, and Sandro in their lecture. Using the arithmetic mean, we
</p>
<p>concluded that both Andreas and Christine arrive on time, whereas Sandro is always
</p>
<p>late; however, we saw that the variation of arrival times differs substantially among
</p>
<p>the three students. To describe and quantify this variability formally, we calculate
</p>
<p>the variance and absolute median deviation:
</p>
<p>s̃2C =
1
</p>
<p>10
</p>
<p>10
&sum;
</p>
<p>i=1
(xi &minus; x̄)2 =
</p>
<p>1
</p>
<p>10
((0 &minus; 0)2 + &middot; &middot; &middot; + (0 &minus; 0)2) = 0
</p>
<p>s̃2A =
1
</p>
<p>10
</p>
<p>10
&sum;
</p>
<p>i=1
(xi &minus; x̄)2 =
</p>
<p>1
</p>
<p>10
((&minus;10 &minus; 0)2 + &middot; &middot; &middot; + (10 &minus; 0)2) &asymp; 111.1
</p>
<p>s̃2S =
1
</p>
<p>10
</p>
<p>10
&sum;
</p>
<p>i=1
(xi &minus; x̄)2 =
</p>
<p>1
</p>
<p>10
((3 &minus; 5)2 + &middot; &middot; &middot; + (7 &minus; 5)2) &asymp; 3.3
</p>
<p>D(x̃0.5,C ) =
1
</p>
<p>10
</p>
<p>n
&sum;
</p>
<p>i=1
|xi &minus; x̃0.5| = |0 &minus; 0| + &middot; &middot; &middot; + |0 &minus; 0| = 0
</p>
<p>D(x̃0.5,A) =
1
</p>
<p>10
</p>
<p>n
&sum;
</p>
<p>i=1
|xi &minus; x̃0.5| = | &minus; 10 &minus; 0| + &middot; &middot; &middot; + |10 &minus; 0| = 10
</p>
<p>D(x̃0.5,S) =
1
</p>
<p>10
</p>
<p>n
&sum;
</p>
<p>i=1
|xi &minus; x̃0.5| = |3 &minus; 5| + &middot; &middot; &middot; + |7 &minus; 5| = 1.4.
</p>
<p>We observe that the variation/dispersion/variability is the lowest for Christine and
</p>
<p>highest for Andreas. Both median absolute deviation and variance allow a comparison
</p>
<p>between the two students. If we take the square root of the variance, we obtain the
</p>
<p>standard deviation. For example, s̃S =
&radic;
</p>
<p>3.3 &asymp; 1.8, which means that the average
difference of the observations from the arithmetic mean is 1.8.
</p>
<p>In R, we can use the var command to calculate the variance. However, note
</p>
<p>that R uses 1/(n &minus; 1) instead of 1/n in calculating the variance. The idea behind
the multiplication by 1/(n &minus; 1) in place of 1/n is discussed in Chap. 9, see also
Theorem 9.2.1.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>3.2 Measures of Dispersion 53
</p>
<p>Variance for Grouped Data. The variance for grouped data can be calculated using
</p>
<p>s2b =
1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
n j (a j &minus; x̄)2 =
</p>
<p>1
</p>
<p>n
</p>
<p>⎛
</p>
<p>⎝
</p>
<p>k
&sum;
</p>
<p>j=1
n j a
</p>
<p>2
j &minus; nx̄2
</p>
<p>⎞
</p>
<p>⎠ =
1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
n j a
</p>
<p>2
j &minus; x̄2,
</p>
<p>(3.24)
</p>
<p>where a j is the middle value of the j th interval. However, when the data is artificially
</p>
<p>grouped and the knowledge about the original ungrouped data is available, we can
</p>
<p>also use the arithmetic mean of the j th class:
</p>
<p>s2b =
1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
n j (x̄ j &minus; x̄)2. (3.25)
</p>
<p>The two expressions (3.24) and (3.25) represent the variance between the different
</p>
<p>classes, i.e. they describe the variability of the class specific means x̄ j , weighted by
</p>
<p>the size of each class n j , around the overall mean x̄ . It is evident that the variance
</p>
<p>within each class is not taken into account in these formulae. The variability of
</p>
<p>measurements in each class, i.e. the variability of &forall;xi &isin; K j , is another important
component to determine the overall variance in the data. It is therefore not surprising
</p>
<p>that using only the between variance s̃2b will underestimate the total variance and
</p>
<p>therefore
</p>
<p>s2b &le; s2. (3.26)
</p>
<p>If the data within each class is known, we can use the Theorem of Variance
</p>
<p>Decomposition (see p. 136 for the theoretical background) to determine the variance.
</p>
<p>This allows us to represent the total variance as the sum of the variance between
</p>
<p>the different classes and the variance within the different classes as
</p>
<p>s̃2 =
1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
n j (x̄ j &minus; x̄)2
</p>
<p>︸ ︷︷ ︸
</p>
<p>between
</p>
<p>+
1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
n j s̃
</p>
<p>2
j
</p>
<p>︸ ︷︷ ︸
</p>
<p>within
</p>
<p>. (3.27)
</p>
<p>In (3.27), s̃2j is the variance of the j th class:
</p>
<p>s̃2j =
1
</p>
<p>n j
</p>
<p>&sum;
</p>
<p>xi&isin;K j
</p>
<p>(xi &minus; x̄ j )2. (3.28)
</p>
<p>The proof of (3.27) is given in Appendix C.1, p. 423.
</p>
<p>Example 3.2.5 Recall the weather data used in Examples 3.0.1&ndash;3.2.3 and the grouped
</p>
<p>data specified as follows:
</p>
<p>Class intervals &lt;20 (20&ndash;25] (25, 30] (30, 35] &gt;35
n j n1 = 0 n2 = 12 n3 = 18 n4 = 1 n5 = 0
x̄ j &ndash; 23.83 28 31 &ndash;
</p>
<p>s̃2j &ndash; 1.972 2 0 &ndash;</p>
<p/>
</div>
<div class="page"><p/>
<p>54 3 Measures of Central Tendency and Dispersion
</p>
<p>We know that x̄ = 26.48 and n = 31. The first step is to calculate the mean and
variances in each class using (3.28). We then obtain x̄ j and s
</p>
<p>2
j as listed above. The
</p>
<p>within and between variances are as follows:
</p>
<p>1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
n j s̃
</p>
<p>2
j =
</p>
<p>1
</p>
<p>31
(12 &middot; 1.972 + 18 &middot; 2 + 1 &middot; 0) &asymp; 1.925
</p>
<p>1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
n j (x̄ j &minus; x̄)2 =
</p>
<p>1
</p>
<p>31
(12 &middot; [23.83 &minus; 26.48]2 + 18 &middot; [28 &minus; 26.48]2
</p>
<p>+1 &middot; [31 &minus; 26.48]2) &asymp; 4.71.
</p>
<p>The total variance is therefore s̃2 &asymp; 6.64. Estimating the variance using all 31 ob-
servations would yield the same results. However, it becomes clear that without
</p>
<p>knowledge about the variance within each class, we cannot reliably estimate s̃2. In
</p>
<p>the above example, the variance between the classes is 3 times lower than the total
</p>
<p>variance which is a serious underestimation.
</p>
<p>Linear Transformations. Let us consider a linear transformation yi = a + bxi
(b 
= 0) of the original data xi , (i = 1, 2, . . . , n). We get the arithmetic mean of
the transformed data as ȳ = a + bx̄ and for the variance:
</p>
<p>s̃2y =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ȳ)2 =
</p>
<p>b2
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; x̄)2
</p>
<p>= b2s̃2x . (3.29)
</p>
<p>Example 3.2.6 Let xi , i = 1, 2, . . . , n, denote measurements on time. These data
could have been recorded and analysed in hours, but we may be interested in a
</p>
<p>summary in minutes. We can make a linear transformation yi = 60 xi . Then, ȳ = 60x̄
and s̃2y = 602s̃2x . If the mean and variance of the xi &rsquo;s have already been obtained, then
the mean and variance of the yi &rsquo;s can be obtained directly using these transformations.
</p>
<p>Standardization. A variable is called standardized if its mean is zero and its variance
</p>
<p>is 1. Standardization can be achieved by using the following transformation:
</p>
<p>yi =
xi &minus; x̄
</p>
<p>s̃x
= &minus;
</p>
<p>x̄
</p>
<p>s̃x
+
</p>
<p>1
</p>
<p>s̃x
xi = a + bxi . (3.30)
</p>
<p>It follows that ȳ =
&sum;n
</p>
<p>i=1(xi &minus; x̄)/s̃x = 0 and s̃2y =
&sum;n
</p>
<p>i=1(xi &minus; x̄)2/s̃2x = 1. There
are many statistical methods which require standardization, see, for example,
</p>
<p>Sect. 10.3.1 for details in the context of statistical tests.
</p>
<p>Example 3.2.7 Let X be a variable which measures air pollution by using the concen-
</p>
<p>tration of atmospheric particulate matter (in &micro;g/m3). Suppose we have the following
</p>
<p>10 measurements:</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>3.2 Measures of Dispersion 55
</p>
<p>30 25 12 45 50 52 38 39 45 33.
</p>
<p>We calculate x̄ = 36.9, s̃2x = 136.09, and s̃x = 11.67. To get a standardized vari-
able Y , we transform all the observations xi &rsquo;s as
</p>
<p>yi =
xi &minus; x̄
</p>
<p>s̃x
= &minus;
</p>
<p>x̄
</p>
<p>s̃x
+
</p>
<p>1
</p>
<p>s̃x
xi = &minus;
</p>
<p>36.9
</p>
<p>11.67
+
</p>
<p>1
</p>
<p>11.67
xi = &minus;3.16 + 0.086xi .
</p>
<p>Now y1 = &minus;3.16 + 0.086 &middot; 30 = &minus;0.58, y2 = &minus;3.16 + 0.086 &middot; 25 = &minus;1.01, . . .,
are the standardized observations. The scale command in R allows standard-
</p>
<p>ization, and we can obtain the standardized observations corresponding to the
</p>
<p>10 measurements as
</p>
<p>air &lt;- c(30,25,12,45,50,52,38,39,45,33)
</p>
<p>scale(air)
</p>
<p>Please note that the scale command uses 1/(n &minus; 1) for calculating the variance,
as already outlined above. Thus, the results provided by scale are not identical to
</p>
<p>those using (3.30).
</p>
<p>3.2.3 Coefficient of Variation
</p>
<p>Consider a situation where two different variables have arithmetic means x̄1 and x̄2
with standard deviations s̃1 and s̃2, respectively. Suppose we want to compare the
</p>
<p>variability of hotel prices in Munich (measured in euros) and London (measured
</p>
<p>in British pounds). How can we provide a fair comparison? Since the prices are
</p>
<p>measured in different units, and therefore likely have arithmetic means which differ
</p>
<p>substantially, it does not make much sense to compare the standard deviations di-
</p>
<p>rectly. The coefficient of variation v is a measure of dispersion which uses both the
</p>
<p>standard deviation and mean and thus allows a fair comparison. It is properly defined
</p>
<p>only when all the values of a variable are measured on a ratio scale and are positive
</p>
<p>such that x̄ &gt; 0 holds. It is defined as
</p>
<p>v =
s
</p>
<p>x̄
. (3.31)
</p>
<p>The coefficient of variation is a unit-free measure of dispersion. It is often used when
</p>
<p>the measurements of two variables are different but can be put into relation by using a
</p>
<p>linear transformation yi = bxi . It is possible to show that if all values xi of a variable
X are transformed into a variable Y with values yi = b &middot; xi , b &gt; 0, then v does not
change.</p>
<p/>
</div>
<div class="page"><p/>
<p>56 3 Measures of Central Tendency and Dispersion
</p>
<p>Example 3.2.8 If we want to compare the variability of hotel prices in two selected
</p>
<p>cities in Germany and England, we could calculate the mean prices, together with
</p>
<p>their standard deviation. Suppose a sample of prices of say 100 hotels in two selected
</p>
<p>cities in Germany and England is available and suppose we obtain the mean and
</p>
<p>standard deviations of the two cities as x1 = e130, x2 = &pound;230, s1 = e99, and s2 =
&pound;212. Then, v1 = 99/130 &asymp; 0.72 and v2 = 212/230 = 0.92. This indicates higher
variability in hotel prices in England. However, if the data distribution is skewed
</p>
<p>or bimodal, then it may be wise not to choose the arithmetic mean as a measure of
</p>
<p>central tendency and likewise the coefficient of variation.
</p>
<p>3.3 Box Plots
</p>
<p>So far we have described various measures of central tendency and dispersion. It can
</p>
<p>be tedious to list those measures in summary tables. A simple and powerful graph
</p>
<p>is the box plot which summarizes the distribution of a continuous (or sometimes an
</p>
<p>ordinal) variable by using its median, quartiles, minimum, maximum, and extreme
</p>
<p>values.
</p>
<p>Figure 3.5a shows a typical box plot. The vertical length of the box is the in-
</p>
<p>terquartile range dQ = x̃0.75 &minus; x̃0.25, which shows the region that contains 50 % of
the data. The bottom end of the box refers to the first quartile, and the top end of the
</p>
<p>box refers to the third quartile. The thick line in the box is the median. It becomes
</p>
<p>immediately clear that the box indicates the symmetry of the data: if the median is
</p>
<p>in the middle of the box, the data should be symmetric, otherwise it is skewed. The
</p>
<p>whiskers at the end of the plot mark the minimum and maximum values of the data.
</p>
<p>Looking at the box plot as a whole tells us about the data distribution and the range
</p>
<p>and variability of observations. Sometimes, it may be advisable to understand which
</p>
<p>values are extreme in the sense that they are &ldquo;far away&rdquo; from the centre of the distri-
</p>
<p>bution. In many software packages, including R, values are defined to be extreme if
</p>
<p>they are greater than 1.5 box lengths away from the first or third quartile. Sometimes,
</p>
<p>they are called outliers. Outliers and extreme values are defined differently in some
</p>
<p>software packages and books.
</p>
<p>Median
</p>
<p>1st Quartile
</p>
<p>3rd Quartile
</p>
<p>minimum
</p>
<p>maximum
</p>
<p>(a) Box plot without extreme values
</p>
<p>Median
</p>
<p>1st Quartile
</p>
<p>3rd Quartile
</p>
<p>extreme values
</p>
<p>extreme values
</p>
<p>(b) Box plot with extreme values</p>
<p/>
</div>
<div class="page"><p/>
<p>3.3 Box Plots 57
</p>
<p>The boxplot command in R draws a box plot. The range option controls whether
</p>
<p>extreme values should be plotted, and if yes, how one wants to define such values.
</p>
<p>boxplot(variable, range=1.5)
</p>
<p>Example 3.3.1 Recall Examples 3.0.1&ndash;3.2.5 where we looked at the temperature in
</p>
<p>Bangkok during December. We have already calculated the median (26◦C) and the
quartiles (25, 29◦C). The minimum and maximum values are 21◦C and 31◦C. The box
plot for this data is shown in Fig. 3.5a. One can see that the temperature distribution
</p>
<p>is slightly skewed with more variability for lower temperatures. The interquartile
</p>
<p>range is 4, and therefore, any value &gt;29 + 4 &times; 1.5 = 35 or &lt;25 &minus; 4 &times; 1.5 = 19
would be an extreme value. However, there are no extreme values in the data.
</p>
<p>Example 3.3.2 Consider again the pizza data described in Appendix A.4. We use R
</p>
<p>to plot the box plot for the delivery time via boxplot(time) (Fig. 3.5b). We see
</p>
<p>a symmetric distribution with a median delivery time of about 35 min. Most of the
</p>
<p>deliveries took between 30 and 40 min. The extreme values indicate that there were
</p>
<p>some exceptionally short and long delivery times.
</p>
<p>2
2
</p>
<p>2
4
</p>
<p>2
6
</p>
<p>2
8
</p>
<p>3
0
</p>
<p>T
e
</p>
<p>m
p
</p>
<p>e
ra
</p>
<p>tu
re
</p>
<p>(a) Boxplot for weather data
</p>
<p>1
0
</p>
<p>2
0
</p>
<p>3
0
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>D
e
</p>
<p>liv
e
</p>
<p>ry
 T
</p>
<p>im
e
</p>
<p> (
in
</p>
<p> m
in
</p>
<p>u
te
</p>
<p>s
)
</p>
<p>(b) Boxplot for pizza data
</p>
<p>3.4 Measures of Concentration
</p>
<p>A completely different concept used to describe a quantitative variable is the idea of
</p>
<p>concentration. For a variable X , it summarizes the proportion of each observation
</p>
<p>with respect to the sum of all observations
&sum;n
</p>
<p>i=1 xi . Let us look at a simple example
to demonstrate its usefulness.</p>
<p/>
</div>
<div class="page"><p/>
<p>58 3 Measures of Central Tendency and Dispersion
</p>
<p>Table 3.1 Concentration of
</p>
<p>farmland: two different
</p>
<p>situations
</p>
<p>Farmer (i) xi (Area, in hectare)
</p>
<p>1 20
</p>
<p>2 20
</p>
<p>3 20
</p>
<p>4 20
</p>
<p>5 20
&sum;5
</p>
<p>i=1 xi = 100
Farmer (i) xi (Area, in hectare)
</p>
<p>1 0
</p>
<p>2 0
</p>
<p>3 0
</p>
<p>4 0
</p>
<p>5 100
&sum;5
</p>
<p>i=1 xi = 100
</p>
<p>Example 3.4.1 Consider a village with 5 farms. Each farmer has a farm of a certain
</p>
<p>size. How can we evaluate the land distribution? Do all farmers have a similar amount
</p>
<p>of land or do one or two farmers have a big advantage because they have considerably
</p>
<p>more space?
</p>
<p>Table 3.1 shows two different situations: in the table on the left, we see an equal
</p>
<p>distribution of land, i.e. each farmer owns 20 hectares of farmland. This means X is
</p>
<p>not concentrated, rather it is equally distributed. A statistical function describing the
</p>
<p>concentration could return a value of zero in such a case. Consider another extreme
</p>
<p>where one farmer owns all the farmland and the others do not own anything, as shown
</p>
<p>on the right side of Table 3.1. This is an extreme concentration of land: one person
</p>
<p>owns everything and thus, we say the concentration is high. A statistical function
</p>
<p>describing the concentration could return a value of one in such a case.
</p>
<p>3.4.1 Lorenz Curve
</p>
<p>The Lorenz curve is a popular method to display concentrations graphically. Con-
</p>
<p>sider n observations x1, x2, . . . , xn of a variable X . Assume that all the observations
</p>
<p>are positive. The sum of all the observations is
&sum;n
</p>
<p>i=1 xi = nx̄ if the data is un-
grouped. First, we need to order the data: 0 &le; x(1) &le; x(2) &le; &middot; &middot; &middot; &le; x(n). To plot the
Lorenz curve, we need
</p>
<p>ui =
i
</p>
<p>n
, i = 0, . . . , n, (3.32)
</p>
<p>and
</p>
<p>vi =
&sum;i
</p>
<p>j=1 x( j)
&sum;n
</p>
<p>j=1 x( j)
, i = 1, . . . , n; v0 := 0, (3.33)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.4 Measures of Concentration 59
</p>
<p>u0 = 0
u1 u2 u3 u4 u5 = 1
</p>
<p>v0 = 0
</p>
<p>v1
</p>
<p>v2
</p>
<p>v3
</p>
<p>v4
</p>
<p>v5 = 1
</p>
<p>u0 = 0
u1 u2 u3 u4 u5 = 1
</p>
<p>v0 = 0
</p>
<p>v1
</p>
<p>v2
</p>
<p>v3
</p>
<p>v4
</p>
<p>v5 = 1
</p>
<p>Fig. 3.5 Lorenz curves for no concentration (left) and some concentration (right)&lowast;
</p>
<p>where
&sum;i
</p>
<p>j=1 x( j) is the cumulative total of observations up to the i th observation.
The idea is that vi describe the contribution of all values &le; i in comparison with
the sum of all values. Plotting ui against vi for all i shows how much the sum of all
</p>
<p>xi , for all observations &le; i , contributes to the total sum. In other words, the point
(ui , vi ) says that ui &middot; 100 % of observations contain vi &middot; 100 % of the sum of all xi
less than or equal to i . Obviously, if all xi are identical, the Lorenz curve will be a
</p>
<p>straight diagonal line, also known as the identity line or line of equality. If the xi
are of different sizes, then the Lorenz curve falls below the line of equality. This is
</p>
<p>illustrated in the following example.
</p>
<p>Example 3.4.2 Recall Example 3.4.1 where we looked at the distribution of farmland
</p>
<p>among 5 farmers. On the upper panel of Table 3.1, we observed an equal distribution
</p>
<p>of land among the farmers: x1 = 20, x2 = 20, x3 = 20, x4 = 20, and x5 = 20. We
obtain u1 = 1/5, u2 = 2/5, . . . , u5 = 1 and v1 = 20/100, v2 = 40/100, . . . , v5 =
1. This yields a Lorenz curve as displayed on the left side of Fig. 3.5: there is no
</p>
<p>concentration. We can interpret each point. For example, (u2, v2) = (0.4, 0.4)means
that 40 % of farmers own 40 % of the land.
</p>
<p>The lower panel of Table 3.1 describes the situation with strong concentration. For
</p>
<p>this table, we obtain u1 = 1/5, u2 = 2/5, . . . , u5 = 1 and v1 = 0, v2 = 0, . . . , v5 =
1. Therefore, for example, 80 % of farmers own 0 % of the land which shows strong
</p>
<p>inequality. Most often we do not have such extreme situations. In this case, the Lorenz
</p>
<p>curve is bent towards the lower right corner of the plot, see the right side of Fig. 3.5.
</p>
<p>We can plot the Lorenz curve in R using the Lc command in the library ineq.
</p>
<p>The Lorenz curve for the left table of Example 3.4.1 is plotted in R as follows:
</p>
<p>library(ineq)
</p>
<p>x &lt;- c(20,20,20,20,20)
</p>
<p>plot(Lc(x))</p>
<p/>
</div>
<div class="page"><p/>
<p>60 3 Measures of Central Tendency and Dispersion
</p>
<p>Fig. 3.6 Lorenz curve and
</p>
<p>the Gini coefficient&lowast;
</p>
<p>ui&minus;1 ui
</p>
<p>vi&minus;1
</p>
<p>vi
</p>
<p>F
</p>
<p>Fi
</p>
<p>We can use the same approach as above to obtain the Lorenz curve when we have
</p>
<p>grouped data. We simply describe the contributions for each class rather than for
</p>
<p>each observation and approximate the values in each class by using its mid-point.
</p>
<p>More formally we can write:
</p>
<p>ũi =
i
</p>
<p>&sum;
</p>
<p>j=1
f j , i = 1, 2, . . . , k; ũ0 := 0 (3.34)
</p>
<p>and
</p>
<p>ṽi =
&sum;i
</p>
<p>j=1 f j a j
&sum;k
</p>
<p>j=1 f j a j
=
</p>
<p>&sum;i
j=1 n j a j
</p>
<p>nx̄
, i = 1, 2, . . . , k; ṽ0 := 0. (3.35)
</p>
<p>3.4.2 Gini Coefficient
</p>
<p>We have seen in Sect. 3.4.1 that the Lorenz curve corresponds to the identity line, that
</p>
<p>is the diagonal line of equality, for no concentration. When there is some concentra-
</p>
<p>tion, then the curve deviates from this line. The amount of deviation depends on the
</p>
<p>strength of concentration. Suppose we want to design a measure of concentration
</p>
<p>which is 0 for no concentration and 1 for perfect (i.e. extreme) concentration. We can
</p>
<p>simply measure the area between the Lorenz curve and the identity line and multiply
</p>
<p>it by 2. For no concentration, the area will be zero and hence the measure will be
</p>
<p>zero. If there is perfect concentration, then the curve will coincide with the axes, the
</p>
<p>area will be close to 0.5, and twice the area will be close to one. The measure based
</p>
<p>on such an approach is called the Gini coefficient:
</p>
<p>G = 2 &middot; F. (3.36)
</p>
<p>Note that F is the area between the curve and the bisection or diagonal line.</p>
<p/>
</div>
<div class="page"><p/>
<p>3.4 Measures of Concentration 61
</p>
<p>The Gini coefficient can be estimated by adding up the areas of the trapeziums Fi
as displayed in Fig. 3.6:
</p>
<p>F =
n
</p>
<p>&sum;
</p>
<p>i=1
Fi &minus; 0.5,
</p>
<p>where
</p>
<p>Fi =
ui&minus;1 + ui
</p>
<p>2
(vi &minus; vi&minus;1).
</p>
<p>It can be shown that this corresponds to
</p>
<p>G = 1 &minus;
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
(vi&minus;1 + vi ), (3.37)
</p>
<p>but the proof is omitted. The same formula can be used for grouped data except that
</p>
<p>ṽ is used instead of v. Since
</p>
<p>0 &le; G &le;
n &minus; 1
</p>
<p>n
, (3.38)
</p>
<p>one may prefer to use the standardized Gini coefficient
</p>
<p>G+ =
n
</p>
<p>n &minus; 1
G, (3.39)
</p>
<p>which takes a maximum value of 1.
</p>
<p>Example 3.4.3 We return to our farmland example. Suppose we have 7 farmers with
</p>
<p>farms of different sizes:
</p>
<p>Farmer 1 2 3 4 5 6 7
</p>
<p>Farmland size xi 20 14 59 9 36 23 3
</p>
<p>Using the ordered values, we can calculate ui and vi using (3.32) and (3.33):
</p>
<p>i x(i) ui vi
</p>
<p>1 3 1
7
= 0.1429 3
</p>
<p>164
= 0.0183
</p>
<p>2 9 2
7
= 0.2857 12
</p>
<p>164
= 0.0732
</p>
<p>3 14 3
7
= 0.4286 26
</p>
<p>164
= 0.1585
</p>
<p>4 20 4
7
= 0.5714 46
</p>
<p>164
= 0.2805
</p>
<p>5 23 5
7
= 0.7143 69
</p>
<p>164
= 0.4207
</p>
<p>6 36 6
7
= 0.8571 105
</p>
<p>164
= 0.6402
</p>
<p>7 59 7
7
= 1.0000 164
</p>
<p>164
= 1.0000</p>
<p/>
</div>
<div class="page"><p/>
<p>62 3 Measures of Central Tendency and Dispersion
</p>
<p>Fig. 3.7 Lorenz curve for
</p>
<p>Example 3.4.3&lowast;
</p>
<p>0 0.14 0.29 0.43 0.57 0.71 0.86 1
</p>
<p>00.02
0.07
</p>
<p>0.16
</p>
<p>0.28
</p>
<p>0.42
</p>
<p>0.64
</p>
<p>1
</p>
<p>ui
</p>
<p>vi
</p>
<p>The Lorenz curve is displayed in Fig. 3.7. Using this information, it is easy to
</p>
<p>calculate the Gini coefficient:
</p>
<p>G = 1 &minus;
1
</p>
<p>7
(0.0183 + [0.0183 + 0.0732] + [0.0732 + 0.1585] + [0.1585 + 0.2805]
</p>
<p>+[0.2805 + 0.4207] + [0.4207 + 0.6402] + [0.6402 + 1]) = 0.402
</p>
<p>We know that G = 0.4024 &le; 6
7
= n&minus;1
</p>
<p>n
. To standardize the coefficient, we therefore
</p>
<p>have to use (3.39):
</p>
<p>G+ =
7
</p>
<p>6
G =
</p>
<p>7
</p>
<p>6
&middot; 0.4024 = 0.4695 .
</p>
<p>In R, we can obtain the non-standardized Gini Coefficient using the ineq function
</p>
<p>in the library ineq.
</p>
<p>library(ineq)
</p>
<p>farm &lt;- c(20,14,59,9,36,23,3)
</p>
<p>ineq(farm)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.5 Key Points and Further Issues 63
</p>
<p>3.5 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� A summary on how to descriptively summarize data is given in Appen-
</p>
<p>dix D.1.
</p>
<p>� The median is preferred over the arithmetic mean when the data distri-
</p>
<p>bution is skewed or there are extreme values.
</p>
<p>� If data of a continuous variable is grouped, and the original ungrouped
</p>
<p>data is not known, additional assumptions are needed to calculate mea-
</p>
<p>sures of central tendency and dispersion. However, in some cases, these
</p>
<p>assumptions may not be satisfied, and the formulae provided may give
</p>
<p>imprecise results.
</p>
<p>� QQ-plots are not only descriptive summaries but can also be used to test
</p>
<p>modelling assumptions, see Chap. 11.9 for more details.
</p>
<p>� The distribution of a continuous variable can be easily summarized using
</p>
<p>a box plot.
</p>
<p>3.6 Exercises
</p>
<p>Exercise 3.1 A hiking enthusiast has a new app for his smartphone which summa-
</p>
<p>rizes his hikes by using a GPS device. Let us look at the distance hiked (in km) and
</p>
<p>maximum altitude (in m) for the last 10 hikes:
</p>
<p>Distance 12.5 29.9 14.8 18.7 7.6 16.2 16.5 27.4 12.1 17.5
</p>
<p>Altitude 342 1245 502 555 398 670 796 912 238 466
</p>
<p>(a) Calculate the arithmetic mean and median for both distance and altitude.
</p>
<p>(b) Determine the first and third quartiles for both the distance and the altitude
</p>
<p>variables. Discuss the shape of the distribution given the results of (a) and (b).
</p>
<p>(c) Calculate the interquartile range, absolute median deviation, and standard de-
</p>
<p>viation for both variables. What is your conclusion about the variability of the
</p>
<p>data?
</p>
<p>(d) One metre corresponds to approximately 3.28 ft. What is the average altitude
</p>
<p>when measured in feet rather than in metres?
</p>
<p>(e) Draw and interpret the box plot for both distance and altitude.
</p>
<p>(f) Assume distance is measured as only short (5&ndash;15 km), moderate (15&ndash;20 km), and
</p>
<p>long (20&ndash;30 km). Summarize the grouped data in a frequency table. Calculate
</p>
<p>the weighted arithmetic mean under the assumption that the raw data is not</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>64 3 Measures of Central Tendency and Dispersion
</p>
<p>known. Determine the weighted median under the assumption that the values
</p>
<p>within each class are equally distributed.
</p>
<p>(g) What is the variance for the grouped data when the raw data is known, i.e. when
</p>
<p>one has knowledge about the variance in each class? How does it compare with
</p>
<p>the variance one obtains when the raw data is unknown?
</p>
<p>(h) Use R to reproduce the results of (a), (b), (c), (e), and (f).
</p>
<p>Exercise 3.2 A gambler notes down his wins and losses (in e) from playing 10
</p>
<p>games of roulette in a casino.
</p>
<p>Round 1 2 3 4 5 6 7 8 9 10
</p>
<p>Won/Lost 200 600 &minus;200 &minus;200 &minus;200 &minus;100 &minus;100 &minus;400 0
</p>
<p>(a) Assume x̄ = &minus; e90 and s = e294.7881. What is the result of round 10?
(b) Determine the mode and the interquartile range.
</p>
<p>(c) A different gambler plays 33 rounds of roulette. His results are x̄ = e12 and
s = e1000. Is it meaningful to compare the variability of results of the two
players by using the coefficient of variation? If yes, determine the coefficients
</p>
<p>of variation; if no, why is a comparison not possible?
</p>
<p>Exercise 3.3 A fashion boutique has summarized its daily sales of designer socks in
</p>
<p>different groups: men&rsquo;s socks, women&rsquo;s socks, and children&rsquo;s socks. Unfortunately,
</p>
<p>the data for men&rsquo;s socks was lost. Determine the missing values.
</p>
<p>n Arithmetic mean Standard deviation
</p>
<p>in e in e
</p>
<p>Women&rsquo;s wear 45 16
&radic;
</p>
<p>6
</p>
<p>Men&rsquo;s wear ? ? ?
</p>
<p>Children&rsquo;s wear 20 7.5
&radic;
</p>
<p>3
</p>
<p>Total 100 15
&radic;
</p>
<p>19.55
</p>
<p>Exercise 3.4 The number of members of a millionaires&rsquo; club were as follows:
</p>
<p>Year 2011 2012 2013 2014 2015 2016
</p>
<p>Members 23 24 27 25 30 28
</p>
<p>(a) What is the average growth rate of the membership?
</p>
<p>(b) Based on the results of (a), how many members would one expect in 2018?</p>
<p/>
</div>
<div class="page"><p/>
<p>3.6 Exercises 65
</p>
<p>4000 10000 12000
</p>
<p>4
0
</p>
<p>0
0
</p>
<p>6
0
</p>
<p>0
0
</p>
<p>8
0
</p>
<p>0
0
</p>
<p>1
0
</p>
<p>0
0
</p>
<p>0
1
</p>
<p>2
0
</p>
<p>0
0
</p>
<p>6000 8000
</p>
<p>Quantiles, men
</p>
<p>Q
u
</p>
<p>a
n
</p>
<p>ti
le
</p>
<p>s
, 
</p>
<p>w
o
</p>
<p>m
e
</p>
<p>n
</p>
<p>(a) for the salary
</p>
<p>65 70 90 95
</p>
<p>6
5
</p>
<p>7
0
</p>
<p>7
5
</p>
<p>8
0
</p>
<p>8
5
</p>
<p>9
0
</p>
<p>9
5
</p>
<p>75 80 85
</p>
<p>Quantiles, men
</p>
<p>Q
u
</p>
<p>a
n
</p>
<p>ti
le
</p>
<p>s
, 
</p>
<p>w
o
</p>
<p>m
e
</p>
<p>n
</p>
<p>(b) for length of service
</p>
<p>Fig. 3.8 QQ-plots
</p>
<p>(c) The president of the club is interested in the number of members in 2025, the
</p>
<p>year when his presidency ends. Would it make sense to predict the number of
</p>
<p>members for 2025?
</p>
<p>In 2015, the members invested e250 million on the stock market. 10 members
</p>
<p>contributed 16% of the investment sum, 8 members contributed e60 million, 8
</p>
<p>members contributede70 million, and another 4 members contributed the remaining
</p>
<p>amount.
</p>
<p>(d) Draw the Lorenz curve for this data.
</p>
<p>(e) Calculate and interpret the standardized Gini coefficient.
</p>
<p>Exercise 3.5 Consider the monthly salaries Y (in Swiss francs) of a well-reputed
</p>
<p>software company, as well as the length of service (in months, X ), and gender (Z ).
</p>
<p>Figure 3.8 shows the QQ-plots for both Y and X given Z . Interpret both graphs.
</p>
<p>Exercise 3.6 There is no built-in function in R to calculate the mode of a variable.
</p>
<p>Program such a function yourself. Hint: type ?table and ?names to recall the
</p>
<p>functionality of these functions. Combine them in an intelligent way.
</p>
<p>Exercise 3.7 Consider a country in which 90 % of the wealth is owned by 20 % of
</p>
<p>the population, the so-called upper class. For simplicity, let us assume that the wealth
</p>
<p>is distributed equally within this class.
</p>
<p>(a) Draw the Lorenz curve for this country.
</p>
<p>(b) Now assume a revolution takes place in the country and all members of the upper
</p>
<p>class have to give away their wealth which is then distributed equally across the
</p>
<p>remaining population. Draw the Lorenz curve for this scenario.
</p>
<p>(c) What would the curve from (b) look like if the entire upper class left the country?</p>
<p/>
</div>
<div class="page"><p/>
<p>66 3 Measures of Central Tendency and Dispersion
</p>
<p>Exercise 3.8 A bus route in the mountainous regions of Romania has a length of
</p>
<p>418 km. The manager of the bus company serving the route wants his buses to finish
</p>
<p>a trip within 8 h. The bus travels the first 180 km with an average speed of 48 km/h, the
</p>
<p>next 117 km with an average speed of 37 km/h, and the last section with an average
</p>
<p>speed of 52 km/h.
</p>
<p>(a) What is the average speed with which the bus travels?
</p>
<p>(b) Will the bus finish the trip in time?
</p>
<p>Exercise 3.9 Four friends have a start-up company which sells vegan ice cream.
</p>
<p>Their initial financial contributions are as follows:
</p>
<p>Person 1 2 3 4
</p>
<p>Contribution (in e) 800 10300 4700 2220
</p>
<p>(a) Calculate and draw the Lorenz curve.
</p>
<p>(b) Determine and interpret the standardized Gini coefficient.
</p>
<p>(c) Does G+ change if each of the friends contributes only half the amount of
money? If yes, how much? If no, why not?
</p>
<p>(d) Use R to draw the above Lorenz curve and to calculate the Gini coefficient.
</p>
<p>Exercise 3.10 Recall the pizza delivery data which is described in Appendix A.4.
</p>
<p>Use R to read in and analyse the data.
</p>
<p>(a) Calculate the mean, median, minimum, maximum, first quartile, and third quar-
</p>
<p>tile for all quantitative variables.
</p>
<p>(b) Determine and interpret the 99 % quantile for delivery time and temperature.
</p>
<p>(c) Write a function which calculates the absolute mean deviation. Use the function
</p>
<p>to calculate the absolute mean deviation of temperature.
</p>
<p>(d) Scale the delivery time and calculate the mean and variance for this variable.
</p>
<p>(e) Draw a box plot for delivery time and temperature. The box plots should not
</p>
<p>highlight extreme values.
</p>
<p>(f) Use the cut command to create a new variable which summarizes delivery time
</p>
<p>in steps of 10 min. Calculate the arithmetic mean of this variable.
</p>
<p>(g) Reproduce the QQ-plots shown in Example 3.1.6.
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 333
</p>
<p>&lowast;Source Toutenburg, H., Heumann, C., Deskriptive Statistik, 7th edition, 2009,
Springer, Heidelberg</p>
<p/>
</div>
<div class="page"><p/>
<p>4AssociationofTwoVariables
</p>
<p>In Chaps. 2 and 3 we discussed how to analyse a single variable using graphs and
</p>
<p>summary statistics. However, in many situations we may be interested in the interde-
</p>
<p>pendence of two or more variables. For example, suppose we want to know whether
</p>
<p>male and female students in a college have any preference between the subjects
</p>
<p>mathematics and biology, i.e. if there is any evidence that male students prefer math-
</p>
<p>ematics over biology and female students prefer biology over mathematics or vice
</p>
<p>versa. Supposewe choose an equal number ofmale and female students and ask them
</p>
<p>about their preferred subject. We expect that if there is no association between the
</p>
<p>two variables &ldquo;gender of student&rdquo; (male or female) and &ldquo;subject&rdquo; (mathematics or
</p>
<p>biology), then an equal proportion ofmale and female students should choose the sub-
</p>
<p>jects biology and mathematics, respectively. Any difference in the proportions may
</p>
<p>indicate a preference ofmales or females for a particular subject. Similarly, in another
</p>
<p>example, we may want to find out whether female employees of an organization are
</p>
<p>paid less than male employees or vice versa. Let us assume again that we choose
</p>
<p>an equal number of male and female employees and assume further that the salary
</p>
<p>is measured as a binary variable (low- versus high-salary group). We then expect
</p>
<p>that if there is no gender discrimination, the number of male and female employees
</p>
<p>in the lower- and higher-salary groups in the organization should be approximately
</p>
<p>equal. In both examples, the variables considered are binary and nominal (although
</p>
<p>the salary can also be seen as ordinal) and the data is summarized in terms of fre-
</p>
<p>quency measures. There may, however, be situations in which we are interested in
</p>
<p>associations between ordinal or continuous variables. Consider a data set in which
</p>
<p>height, weight, and age of infants are given. Usually, the height and weight of infants
</p>
<p>increase with age. Also, the height of infants increases with their weight and vice
</p>
<p>versa. Clearly, there is an interrelation or association among the three variables. In
</p>
<p>another example, two persons have to judge participants of a dance competition and
</p>
<p>rank them according to their performance. Now if we want to learn about the fairness
</p>
<p>in the judgment, we expect that both the judges give similar ranks to each candidate,
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_4
</p>
<p>67</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>68 4 Association of Two Variables
</p>
<p>i.e. both judges give high ranks to good candidates and low ranks to not so good
</p>
<p>candidates. We are therefore interested in studying the association between the ranks
</p>
<p>given by the two judges. In all these examples, the intention lies in measuring the
</p>
<p>degree of association between two (or more) variables. We therefore need to study
</p>
<p>different ways of measuring the association level for different types of variables. In
</p>
<p>this chapter, we present measures and graphical summaries for the association of
</p>
<p>two variables&mdash;dependent on their scale.
</p>
<p>4.1 Summarizing the Distribution of Two DiscreteVariables
</p>
<p>When both variables are discrete, then it is possible to list all combinations of values
</p>
<p>of the two variables and to count how often these combinations occur in the data.
</p>
<p>Consider the salary example in the introduction to this chapter in which both the
</p>
<p>variables were binary. There are four possible combinations of variable categories
</p>
<p>(female and low-salary group, female and high-salary group, male and low-salary
</p>
<p>group, and male and high-salary group). A complete description of the joint occur-
</p>
<p>rence of these two variables can be given by counting, for each combination, the
</p>
<p>number of units for which this combination is measured. In the following, we gen-
</p>
<p>eralize this concept to two variables where each can have an arbitrary (but fixed)
</p>
<p>number of values or categories.
</p>
<p>4.1.1 Contingency Tables for Discrete Data
</p>
<p>Suppose we have data on two discrete variables. This data can be described in a
</p>
<p>two-dimensional contingency table.
</p>
<p>Example 4.1.1 An airline conducts a customer satisfaction survey. The survey
</p>
<p>includes questions about travel class and satisfaction levels with respect to different
</p>
<p>categories such as seat comfort, in-flight service, meals, safety, and other indicators.
</p>
<p>Consider the information on X , denoting the travel class (Economy = &ldquo;E&rdquo;, Business
</p>
<p>= &ldquo;B&rdquo;, First = &ldquo;F&rdquo;), and &ldquo;Y&rdquo;, denoting the overall satisfaction with the flight on a
</p>
<p>scale from 1 to 4 as 1 (poor), 2 (fair), 3 (good), and 4 (very good). A possible response
</p>
<p>from 12 customers may look as follows:
</p>
<p>Passenger number
</p>
<p>i 1 2 3 4 5 6 7 8 9 10 11 12
</p>
<p>Travel class E E E B E B F E E B E B
</p>
<p>Satisfaction 2 4 1 3 1 2 4 3 2 4 3 3
</p>
<p>We can calculate the absolute frequencies for each of the combination of observed
</p>
<p>values. For example, there are 2 passengers (passenger numbers 3 and 5) who were</p>
<p/>
</div>
<div class="page"><p/>
<p>4.1 Summarizing the Distribution of Two Discrete Variables 69
</p>
<p>Table 4.1 Contingency table for travel class and satisfaction
</p>
<p>Overall rating of flight quality Total (row)
</p>
<p>Poor Fair Good Very good
</p>
<p>Travel class Economy
</p>
<p>business
</p>
<p>first
</p>
<p>2 2 2 1 7
</p>
<p>0 1 2 1 4
</p>
<p>0 0 0 1 1
</p>
<p>Total
</p>
<p>(column)
</p>
<p>2 3 4 3 12
</p>
<p>flying in economy class and rated the flight quality as poor, there were no passengers
</p>
<p>from both business class and first class who rated the flight quality as poor; there
</p>
<p>were 2 passengers who were flying in economy class and rated the quality as fair
</p>
<p>(2), and so on. Table4.1 is a two-dimensional table summarizing this information.
</p>
<p>Note that we not only summarize the joint frequency distribution of the two
</p>
<p>variables but also the distributions of the individual variables. Summing up the rows
</p>
<p>and columns of the table gives the respective frequency distributions. For example,
</p>
<p>the last column of the table demonstrates that 7 passengers were flying in economy
</p>
<p>class, 4 passengers were flying in business class and 1 passenger in first class.
</p>
<p>Now we extend this example and discuss a general framework to summarize
</p>
<p>the absolute frequencies of two discrete variables in contingency tables. We use
</p>
<p>the following notations: Let x1, x2, . . . , xk be the k classes of a variable X and let
</p>
<p>y1, y2, . . . , yl be the l classes of another variable Y . We assume that both X and Y
</p>
<p>are discrete variables. It is possible to summarize the absolute frequencies ni j related
</p>
<p>to (xi , y j ), i = 1, 2, . . . , k, j = 1, 2, . . . , l, in a k &times; l contingency table as shown
in Table4.2.
</p>
<p>Table 4.2 k &times; l contingency table
</p>
<p>Y
</p>
<p>y1 y j yl Total
</p>
<p>(rows)
</p>
<p>x1 n11 &middot; &middot; &middot; n1 j &middot; &middot; &middot; n1l n1+
x2 n21 &middot; &middot; &middot; n2 j &middot; &middot; &middot; n2l n2+
.
.
.
</p>
<p>.
</p>
<p>.
</p>
<p>.
.
.
.
</p>
<p>.
</p>
<p>.
</p>
<p>.
.
.
.
</p>
<p>X xi ni1 &middot; &middot; &middot; ni j &middot; &middot; &middot; nil ni+
.
.
.
</p>
<p>.
</p>
<p>.
</p>
<p>.
.
.
.
</p>
<p>.
</p>
<p>.
</p>
<p>.
.
.
.
</p>
<p>xk nk1 &middot; &middot; &middot; nk j &middot; &middot; &middot; nkl nk+
Total
</p>
<p>(columns)
</p>
<p>n+1 &middot; &middot; &middot; n+ j &middot; &middot; &middot; n+l n</p>
<p/>
</div>
<div class="page"><p/>
<p>70 4 Association of Two Variables
</p>
<p>We denote the sum of the i th row as ni+ =
&sum;l
</p>
<p>j=1 ni j and the sum over the j th
</p>
<p>column as n+ j =
&sum;k
</p>
<p>i=1 ni j . The total number of observations is therefore
</p>
<p>n =
k
</p>
<p>&sum;
</p>
<p>i=1
ni+ =
</p>
<p>l
&sum;
</p>
<p>j=1
n+ j =
</p>
<p>k
&sum;
</p>
<p>i=1
</p>
<p>l
&sum;
</p>
<p>j=1
ni j . (4.1)
</p>
<p>Remark 4.1.1 Note that it is also possible to use the relative frequencies fi j = ni j/n
instead of the absolute frequencies ni j in Table4.2, see Example 4.1.2.
</p>
<p>4.1.2 Joint,Marginal, and Conditional Frequency Distributions
</p>
<p>When the data on two variables are summarized in a contingency table, there are
</p>
<p>several concepts which can help us in studying the characteristics of the data. For
</p>
<p>example, how the values of both the variables behave jointly, how the values of
</p>
<p>one variable behave when another variable is kept fixed etc. These features can be
</p>
<p>studied using the concepts of joint frequency distribution, marginal frequency distri-
</p>
<p>bution, and conditional frequency distribution. If relative frequency is used instead
</p>
<p>of absolute frequency, then we speak of the joint relative frequency distribution, mar-
</p>
<p>ginal relative frequency distribution, and conditional relative frequency distribution.
</p>
<p>Definition 4.1.1 Using the notations of Table4.2, we define the following:
</p>
<p>The frequencies ni j represent the joint frequency distribution of X and Y .
</p>
<p>The frequencies ni+ represent the marginal frequency distribution of X .
</p>
<p>The frequencies n+ j represent the marginal frequency distribution of Y .
</p>
<p>We define f
X |Y
</p>
<p>i | j = ni j/n+ j to be the conditional frequency distribution of
X given Y = y j .
</p>
<p>We define f
Y |X
j |i = ni j/ni+ to be the conditional frequency distribution of Y
</p>
<p>given X = xi
The frequencies fi j represent the joint relative frequency distribution of X
</p>
<p>and Y .
</p>
<p>The frequencies fi+ =
&sum;l
</p>
<p>j=1 fi j represent the marginal relative frequency
distribution of X .
</p>
<p>The frequencies f+ j =
&sum;k
</p>
<p>i=1 fi j represent the marginal relative frequency
distribution of Y .
</p>
<p>We define f
X |Y
</p>
<p>i | j = fi j/ f+ j to be the conditional relative frequency distrib-
ution of X given Y = y j .
</p>
<p>We define f
Y |X
j |i = fi j/ fi+ to be the conditional relative frequency distribu-
</p>
<p>tion of Y given X = xi .</p>
<p/>
</div>
<div class="page"><p/>
<p>4.1 Summarizing the Distribution of Two Discrete Variables 71
</p>
<p>Table 4.3 Contingency table for travel class and satisfaction
</p>
<p>Overall rating of flight quality
</p>
<p>Poor Fair Good Very good Total (rows)
</p>
<p>Travel class Economy 10 33 15 4 62
</p>
<p>Business 0 3 20 2 25
</p>
<p>First 0 0 5 8 13
</p>
<p>Total
</p>
<p>(columns)
</p>
<p>10 36 40 14 100
</p>
<p>Note that for a bivariate joint frequency distribution, there will only be two mar-
</p>
<p>ginal (or relative) frequency distributions but possibly more than two conditional (or
</p>
<p>relative) frequency distributions.
</p>
<p>Example 4.1.2 Recall the setup of Example 4.1.1. We now collect and evaluate the
</p>
<p>responses of 100 customers (instead of 12 passengers as in Example 4.1.1) regarding
</p>
<p>their choice of the travel class and their overall satisfaction with the flight quality.
</p>
<p>The data is provided in Table4.3 where each of the cell entries illustrates how
</p>
<p>many out of 100 passengers answered xi and y j : for example, the first entry &ldquo;10&rdquo;
</p>
<p>indicates that 10 passengers were flying in economy class and described the overall
</p>
<p>service quality as poor.
</p>
<p>&bull; The marginal frequency distributions are displayed in the last column and last row,
respectively. For example, the marginal distribution of X refers to the frequency
</p>
<p>table of &ldquo;travel class&rdquo; (X ) and tells us that 62 passengers were flying in economy
</p>
<p>class, 25 in business class, and 13 in first class. Similarly, the marginal distribution
</p>
<p>of &ldquo;overall rating of flight quality&rdquo; (Y ) tells us that 10 passengers rated the quality
</p>
<p>as poor, 36 as fair, 40 as good, and 14 as very good.
</p>
<p>&bull; The conditional frequency distributions give us an idea about the behaviour of one
variable when the other one is kept fixed. For example, the conditional distribution
</p>
<p>of the &ldquo;overall rating of flight quality&rdquo; (Y ) among passengers who were flying
</p>
<p>in economy class ( fY |X=Economy) gives f
Y |X
1|1 = 10/62 &asymp; 16% which means that
</p>
<p>approximately 16% of the customers in economy class are rating the quality as
</p>
<p>poor, f
Y |X
2|1 = 33/62 &asymp; 53% of the customers in economy class are rating the
</p>
<p>quality as fair, f
Y |X
3|1 = 15/62 &asymp; 24%of the customers in economy class are rating
</p>
<p>the quality as good and f
Y |X
4|1 = 4/62 &asymp; 7% of the customers in economy class
</p>
<p>are rating the quality as very good. Similarly, f
Y |X
3|2 = 20/25 &asymp; 80%whichmeans
</p>
<p>that 80% of the customers in business class are rating the quality as good and
</p>
<p>so on.
</p>
<p>&bull; The conditional frequency distribution of the &ldquo;travel class&rdquo; (X ) of passengers
given the &ldquo;overall rating of flight quality&rdquo; (Y ) is obtained by fX |Y=Satisfaction level.
</p>
<p>For example, fX |Y=good gives f
X |Y
1|3 = 15/40 = 37.5% which means that 37.5%</p>
<p/>
</div>
<div class="page"><p/>
<p>72 4 Association of Two Variables
</p>
<p>of the passengers who rated the flight to be good travelled in economy class,
</p>
<p>f
X |Y
2|3 = 20/40 = 50% of the passengers who rated the flight to be good travelled
</p>
<p>in business class and f
X |Y
3|3 = 5/40 = 12.5%of the passengers who rated the flight
</p>
<p>to be good travelled in first class.
</p>
<p>&bull; In total, we have 100 customers and hence
</p>
<p>n =
k
</p>
<p>&sum;
</p>
<p>i=1
ni+ = 62+ 25+ 13 =
</p>
<p>l
&sum;
</p>
<p>j=1
n+ j = 10+ 36+ 40+ 14
</p>
<p>=
k
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>l
&sum;
</p>
<p>j=1
ni j = 10+ 33+ 15+ 4++3+ 20+ 2+ 5+ 8 = 100
</p>
<p>&bull; Alternatively, we can summarize X and Y using the relative frequencies as follows:
</p>
<p>Overall rating of flight quality
</p>
<p>Poor Fair Good Very good Total (rows)
</p>
<p>Travel class Economy 10
100
</p>
<p>33
100
</p>
<p>15
100
</p>
<p>4
100
</p>
<p>62
100
</p>
<p>Business 0 3
100
</p>
<p>20
100
</p>
<p>2
100
</p>
<p>25
100
</p>
<p>First 0 0 5
100
</p>
<p>8
100
</p>
<p>13
100
</p>
<p>Total (columns) 10
100
</p>
<p>36
100
</p>
<p>40
100
</p>
<p>14
100
</p>
<p>1
</p>
<p>To produce the frequency table without the marginal distributions, we can use
</p>
<p>the R command table(X,Y). To obtain the full contingency table including the
</p>
<p>marginal distributions in R, one can use the function addmargins(). For the relative
</p>
<p>frequencies, the function prop.table() can be used. In summary, a full contingency
</p>
<p>table is obtained by using
</p>
<p>addmargins(table(X,Y))
</p>
<p>addmargins(prop.table(table(X,Y)))
</p>
<p>4.1.3 Graphical Representation of Two Nominal
or Ordinal Variables
</p>
<p>Bar charts (see Sect. 2.3.1) can be used to graphically summarize the association
</p>
<p>between two nominal or two ordinal variables. The bar chart is drawn for X and the
</p>
<p>categories of Y are represented by separated bars or stacked bars for each category
</p>
<p>of X . In this way, we summarize the joint distribution of the contingency table.
</p>
<p>Example 4.1.3 Consider Example 4.1.2. There are 62 passengers flying in the econ-
</p>
<p>omy class. From these 62 passengers, 10 rated the quality of the flight as poor, 33 as
</p>
<p>fair, 15 as good, and 4 as very good. This means for X = x1(= Economy), we can</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
</div>
<div class="page"><p/>
<p>4.1 Summarizing the Distribution of Two Discrete Variables 73
</p>
<p>Class
</p>
<p>a
b
s
o
lu
</p>
<p>te
 f
re
</p>
<p>q
u
e
n
c
ie
</p>
<p>s
</p>
<p>0
</p>
<p>10
</p>
<p>20
</p>
<p>30
</p>
<p>1: Economy 2: Business 3: First
</p>
<p>Rating
1=poor
2=fair
</p>
<p>3=good
4=very good
</p>
<p>Class
</p>
<p>a
b
s
o
lu
</p>
<p>te
 f
re
</p>
<p>q
u
e
n
c
ie
</p>
<p>s
</p>
<p>0
</p>
<p>20
</p>
<p>40
</p>
<p>60
</p>
<p>1: Economy 2: Business 3: First
</p>
<p>Rating
1=poor
2=fair
</p>
<p>3=good
4=very good
</p>
<p>(a) Categories next to each other (b) Categories stacked
</p>
<p>Fig. 4.1 Bar charts for travel class and rating of satisfaction
</p>
<p>either place 4 bars next to each other, as in Fig. 4.1a, or we can stack them on top
</p>
<p>of each other, as in Fig. 4.1b. The same can be done for the other categories of X ,
</p>
<p>see Fig. 4.1. Stacked and stratified bar charts are prepared in R by calling the library
</p>
<p>lattice and using the function bar chart. In detail, one needs to specify:
</p>
<p>Class &lt;- c(rep('1: Economy',62),rep('2: Business',25),
</p>
<p>rep('3: First',13))
</p>
<p>Rating &lt;- c(rep('1=poor',10),rep('2=fair',33),...)
</p>
<p>library(lattice)
</p>
<p>barchart(table(Class,Rating),horizontal=FALSE,stack=FALSE)
</p>
<p>barchart(table(Class,Rating),horizontal=FALSE,stack=TRUE)
</p>
<p>Remark 4.1.2 There are several other options in R to specify stratified bar charts.
</p>
<p>We refer the interested reader to Exercise 2.6 to explore how the R package ggplot2
</p>
<p>can be used to make such graphics. Sometimes it can also be useful to visualize the
</p>
<p>difference of two variables and not stack or stratify the bars, see Exercise 2.1.
</p>
<p>Independence and Expected Frequencies An important statistical concept is inde-
</p>
<p>pendence. In this section, we touch upon its descriptive aspects, see Chaps. 6
</p>
<p>(Sect. 6.5) and 7 (Sect. 7.5) for more theoretical details. Two variables are considered
</p>
<p>to be independent if the observations on one variable do not influence the observa-
</p>
<p>tions on the other variable. For example, suppose two different persons roll a die
</p>
<p>separately; then, the outcomes of their rolls do not depend on each other. So we
</p>
<p>can say that the two observations are independent. In the context of contingency
</p>
<p>tables, two variables are independent of each other when the joint relative frequency
</p>
<p>equals the product of the marginal relative frequencies of the two variables, i.e. the</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_6">http://dx.doi.org/10.1007/978-3-319-46162-5_6</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_6">http://dx.doi.org/10.1007/978-3-319-46162-5_6</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>74 4 Association of Two Variables
</p>
<p>Table 4.4 Observed and expected absolute frequencies for the airline survey
</p>
<p>Overall rating of flight quality
</p>
<p>Poor Fair Good Very good Total
</p>
<p>Travel Economy 10 (6.2) 33 (22.32) 15 (24.8) 4 (8.68) 62
</p>
<p>class Business 0 (2.5) 3 (9.0) 20 (10.0) 2 (3.5) 25
</p>
<p>First 0 (1.3) 0 (4.68) 5 (5.2) 8 (1.82) 13
</p>
<p>Total 10 36 40 14 100
</p>
<p>following equation holds:
</p>
<p>fi j = fi+ f+ j . (4.2)
The expected absolute frequencies under independence are obtained by
</p>
<p>ñi j = n fi j = n
ni+
n
</p>
<p>n+ j
n
</p>
<p>=
ni+n+ j
</p>
<p>n
. (4.3)
</p>
<p>Note that the absolute frequencies are always integers but the expected absolute
</p>
<p>frequencies may not always be integers.
</p>
<p>Example 4.1.4 Recall Example 4.1.2. The expected absolute frequencies for the
</p>
<p>contingency table can be calculated using (4.3). For example,
</p>
<p>ñ11 =
62 &middot; 10
100
</p>
<p>= 6.2, ñ12 =
62 &middot; 36
100
</p>
<p>= 22.32 etc.
</p>
<p>Table4.4 lists both the observed absolute frequency and expected absolute frequency
</p>
<p>(in brackets).
</p>
<p>To calculate the expected absolute frequencies in R, we can access the &ldquo;expected&rdquo;
</p>
<p>object returned from a χ2-test applied to the respective contingency table as follows:
</p>
<p>chisq.test(table(Class,Rating))$expected
</p>
<p>A detailed motivation and explanation of this command is given in Sect. 10.8.
</p>
<p>4.2 Measures of Association for Two DiscreteVariables
</p>
<p>When two variables are not independent, then they are associated. Their association
</p>
<p>can be weak or strong. Now we describe some popular measures of association.
</p>
<p>Measures of association describe the degree of association between two variables
</p>
<p>and can have a direction as well. Note that if variables are defined on a nominal scale,
</p>
<p>then nothing can be said about the direction of association, only about the strength.
</p>
<p>Let us first consider a 2&times; 2 contingency table which is a special case of a k &times; l
contingency table, see Table4.5.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>4.2 Measures of Association for Two Discrete Variables 75
</p>
<p>Table 4.5 2&times; 2 contingency table
</p>
<p>Y
</p>
<p>y1 y2 Total (row)
</p>
<p>x1 a b a + b
X x2 c d c + d
</p>
<p>Total (column) a + c b + d n
</p>
<p>Table 4.6 2&times; 2 contingency table
</p>
<p>Persons
</p>
<p>Not affected Affected Total (row)
</p>
<p>Vaccinated 90 10 100
</p>
<p>Vaccination Not vaccinated 40 60 100
</p>
<p>Total (column) 130 70 200
</p>
<p>The variables X and Y are independent if
</p>
<p>a
</p>
<p>a + c
=
</p>
<p>b
</p>
<p>b + d
=
</p>
<p>a + b
n
</p>
<p>(4.4)
</p>
<p>or equivalently if
</p>
<p>a =
(a + b)(a + c)
</p>
<p>n
. (4.5)
</p>
<p>Note that some other forms of the conditions (4.4)&ndash;(4.5) can also be derived in
</p>
<p>terms of a, b, c, and d.
</p>
<p>Example 4.2.1 Suppose a vaccination against flu (influenza) is given to 200 persons.
</p>
<p>Some of the persons may get affected by flu despite the vaccination. The data is
</p>
<p>summarized in Table4.6. Using the notations of Table4.5, we have a = 90, b =
10, c = 40, d = 60, and thus, (a + b)(a + c)/n = 100 &middot; 130/200 = 65which is less
than a = 90. Hence, being affected by flu is not independent of the vaccination,
i.e. whether one is vaccinated or not has an influence on getting affected by flu.
</p>
<p>In the vaccinated group, only 10 of 100 persons are affected by flu while in the
</p>
<p>group not vaccinated 60 of 100 persons are affected. Another interpretation is that
</p>
<p>if independence holds, then we would expect 65 persons to be not affected by flu in
</p>
<p>the vaccinated group but we observe 90 persons. This shows that vaccination has a
</p>
<p>protective effect.
</p>
<p>To gain a better understanding about the strength of association between two
</p>
<p>variables, we need to develop the concept of dependence and independence further.
</p>
<p>The following three subsections illustrate this in more detail.</p>
<p/>
</div>
<div class="page"><p/>
<p>76 4 Association of Two Variables
</p>
<p>4.2.1 Pearson&rsquo;sχ2 Statistic
</p>
<p>We now introduce Pearson&rsquo;s χ2 statistic which is used for measuring the association
</p>
<p>between variables in a contingency table and plays an important role in the construc-
</p>
<p>tion of statistical tests, see Sect. 10.8. The χ2 statistic or χ2 coefficient for a k &times; l
contingency table is given as
</p>
<p>χ
2 =
</p>
<p>k
&sum;
</p>
<p>i=1
</p>
<p>l
&sum;
</p>
<p>j=1
</p>
<p>(
</p>
<p>ni j &minus; ñi j
)2
</p>
<p>ñi j
=
</p>
<p>k
&sum;
</p>
<p>i=1
</p>
<p>l
&sum;
</p>
<p>j=1
</p>
<p>(
</p>
<p>ni j &minus;
ni+n+ j
</p>
<p>n
</p>
<p>)2
</p>
<p>ni+n+ j
n
</p>
<p>. (4.6)
</p>
<p>A simpler formula for 2&times; 2 contingency tables is
</p>
<p>χ
2 =
</p>
<p>n(ad &minus; bc)2
</p>
<p>(a + b)(c + d)(a + c)(b + d)
. (4.7)
</p>
<p>The idea behind the χ2 coefficient is that when the relationship between two
</p>
<p>variables is stronger, then the deviations between observed and expected frequencies
</p>
<p>are expected to be higher (because the expected frequencies are calculated assuming
</p>
<p>independence) and this indicates a stronger relationship between the two variables. If
</p>
<p>observed and expected frequencies are identical or similar, then this is an indication
</p>
<p>that the association between the two variables is weak and the variables may even be
</p>
<p>independent. Theχ2 statistic for a k &times; l contingency table sums up all the differences
between the observed and expected frequencies, squares them, and scales them with
</p>
<p>respect to the expected frequencies. The squaring of the differencemakes the statistic
</p>
<p>independent of the positive and negative signs of the difference between observed
</p>
<p>and expected frequencies. The range of values for χ2 is
</p>
<p>0 &le; χ2 &le; n(min(k, l) &minus; 1). (4.8)
Note that min(k, l) is the minimum function and simply returns the smaller of the
</p>
<p>two numbers k and l. For example, min(3, 4) returns the value 3. Consequently the
</p>
<p>values of χ2 obtained from (4.6) can be compared with the range from (4.8). A
</p>
<p>value of χ2 close to zero indicates a weak association and a value of χ2 close to
</p>
<p>n(min(k, l) &minus; 1) indicates a strong association between the two variables. Note that
the range of χ2 depends on n, k and l, i.e. the sample size and the dimension of the
</p>
<p>contingency table.
</p>
<p>The χ2 statistic is a symmetric measure in the sense that its value does not depend
</p>
<p>on which variable is defined as X and which as Y .
</p>
<p>Example 4.2.2 Consider Examples 4.1.2 and 4.1.4. Using the values from Table4.4,
</p>
<p>we can calculate the χ2 statistic as
</p>
<p>χ
2 =
</p>
<p>(10&minus; 6.2)2
</p>
<p>6.2
+
</p>
<p>(33&minus; 22.32)2
</p>
<p>22.32
+ &middot; &middot; &middot; +
</p>
<p>(8&minus; 1.82)2
</p>
<p>1.82
= 57.95064
</p>
<p>Themaximumpossible value for theχ2 statistic is 100(min(4, 3) &minus; 1) = 200. Thus,
χ
2 &asymp; 57 indicates a moderate association between &ldquo;travel class&rdquo; and &ldquo;overall rating
</p>
<p>of flight quality&rdquo; of the passengers. In R, we obtain this result as follows:
</p>
<p>chisq.test(table(Class,Rating))$statistic</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>4.2 Measures of Association for Two Discrete Variables 77
</p>
<p>4.2.2 Cramer&rsquo;s V Statistic
</p>
<p>A problem with Pearson&rsquo;s χ2 coefficient is that the range of its maximum value
</p>
<p>depends on the sample size and the size of the contingency table. These values
</p>
<p>may vary in different situations. To overcome this problem, the coefficient can be
</p>
<p>standardized to lie between 0 and 1 so that it is independent of the sample size as well
</p>
<p>as the dimension of the contingency table. Since n(min(k, l) &minus; 1) was the maximal
value of the χ2 statistic, dividing χ2 by this maximal value automatically leads to a
</p>
<p>scaled version with maximal value 1. This idea is used by Cramer&rsquo;s V statistic which
</p>
<p>for a k &times; l contingency table is given by
</p>
<p>V =
</p>
<p>&radic;
</p>
<p>χ2
</p>
<p>n(min(k, l) &minus; 1)
. (4.9)
</p>
<p>The closer the value of V gets to 1, the stronger the association between the two
</p>
<p>variables.
</p>
<p>Example 4.2.3 Consider Example 4.2.2. The obtained χ2 statistic is 57.95064. To
</p>
<p>obtain Cramer&rsquo;s V , we just need to calculate
</p>
<p>V =
</p>
<p>&radic;
</p>
<p>χ2
</p>
<p>n(min(k, l) &minus; 1)
=
</p>
<p>&radic;
</p>
<p>57.95064
</p>
<p>100(3&minus; 1)
&asymp; 0.54. (4.10)
</p>
<p>This indicates a moderate association between &ldquo;travel class&rdquo; and &ldquo;overall rating of
</p>
<p>flight quality&rdquo; because 0.54 lies in the middle of 0 and 1. In R, there are two options
</p>
<p>to calculate V : (i) to calculate the χ2 statistic and then adjust it as in (4.9), (ii) to use
</p>
<p>the functions assocstats and xtabs contained in the package vcd as follows:
</p>
<p>library(vcd)
</p>
<p>assocstats(xtabs(&sim;Class+Rating))
</p>
<p>4.2.3 Contingency Coefficient C
</p>
<p>Another option to standardize χ2 is given by a corrected version of Pearson&rsquo;s con-
</p>
<p>tingency coefficient:
</p>
<p>Ccorr =
C
</p>
<p>Cmax
=
</p>
<p>&radic;
</p>
<p>min(k, l)
</p>
<p>min(k, l) &minus; 1
</p>
<p>&radic;
</p>
<p>χ2
</p>
<p>χ2 + n
, (4.11)
</p>
<p>with
</p>
<p>C =
</p>
<p>&radic;
</p>
<p>χ2
</p>
<p>χ2 + n
and Cmax =
</p>
<p>&radic;
</p>
<p>min(k, l) &minus; 1
min(k, l)
</p>
<p>. (4.12)
</p>
<p>It always lies between 0 and 1. The closer the value of C is to 1, the stronger the
</p>
<p>association.</p>
<p/>
</div>
<div class="page"><p/>
<p>78 4 Association of Two Variables
</p>
<p>Example 4.2.4 We know from Example 4.2.2 that the χ2 statistic for travel class and
</p>
<p>satisfaction level is 57.95064. To calculateCcorr, we need the following calculations:
</p>
<p>C =
&radic;
</p>
<p>57.95064
</p>
<p>57.95064+ 100
= 0.606, Cmax =
</p>
<p>&radic;
</p>
<p>min(4, 3) &minus; 1
min(4, 3)
</p>
<p>=
&radic;
</p>
<p>2
</p>
<p>3
= 0.816,
</p>
<p>Ccorr =
C
</p>
<p>Cmax
=
</p>
<p>0.606
</p>
<p>0.816
&asymp; 0.74 .
</p>
<p>There is a moderate to strong association between &ldquo;travel class&rdquo; and &ldquo;overall rating
</p>
<p>of flight quality&rdquo; of the passengers. We can compute C in R using the vcd package
</p>
<p>as follows:
</p>
<p>library(vcd)
</p>
<p>Cmax = sqrt((min(c(3,4))-1)/min(c(3,4)))
</p>
<p>assocstats(xtabs(&sim;Class+Rating))$cont/Cmax
</p>
<p>4.2.4 Relative Risks and Odds Ratios
</p>
<p>We now introduce the concepts of odds ratios and relative risks. Consider a 2&times; 2
contingency table as introduced in Table4.5. Now suppose we have two variables
</p>
<p>X and Y with their conditional distributions f
X |Y
</p>
<p>i | j and f
Y |X
j |i . In the context of a
</p>
<p>2&times; 2 contingency table, f X |Y1|1 = n11/n+1, f
X |Y
1|2 = n12/n+2, f
</p>
<p>X |Y
2|2 = n22/n+2, and
</p>
<p>f
X |Y
2|1 = n21/n+1. The relative risks are defined as the ratio of two conditional dis-
</p>
<p>tributions, for example
</p>
<p>f
X |Y
1|1
</p>
<p>f
X |Y
1|2
</p>
<p>=
n11/n+1
n12/n+2
</p>
<p>=
a/(a + c)
b/(b + d)
</p>
<p>and
f
</p>
<p>X |Y
2|1
</p>
<p>f
X |Y
2|2
</p>
<p>=
n21/n+1
n22/n+2
</p>
<p>=
c/(a + c)
d/(b + d)
</p>
<p>. (4.13)
</p>
<p>The odds ratio is defined as the ratio of these relative risks from (4.13) as
</p>
<p>O R =
f
</p>
<p>X |Y
1|1 / f
</p>
<p>X |Y
1|2
</p>
<p>f
X |Y
2|1 / f
</p>
<p>X |Y
2|2
</p>
<p>=
f
</p>
<p>X |Y
1|1 f
</p>
<p>X |Y
2|2
</p>
<p>f
X |Y
2|1 f
</p>
<p>X |Y
1|2
</p>
<p>=
a d
</p>
<p>b c
. (4.14)
</p>
<p>Alternatively, the odds ratio can be defined as the ratio of the chances for &ldquo;disease&rdquo;,
</p>
<p>a/b (number of smokers with the disease divided by the number of non-smokers
</p>
<p>with the disease), and no disease, c/d (number of smokers with no disease divided
</p>
<p>by the number of non-smokers with no disease).
</p>
<p>The relative risks compare proportions, while the odds ratio compares odds.</p>
<p/>
</div>
<div class="page"><p/>
<p>4.2 Measures of Association for Two Discrete Variables 79
</p>
<p>Example 4.2.5 A classical example refers to the possible association of smoking
</p>
<p>with a particular disease. Consider the following data on 240 individuals:
</p>
<p>Smoking Total (row)
</p>
<p>Yes No
</p>
<p>Disease Yes 34 66 100
</p>
<p>No 22 118 140
</p>
<p>Total (column) 56 184 240
</p>
<p>We calculate the following relative risks:
</p>
<p>f
X |Y
1|1
</p>
<p>f
X |Y
1|2
</p>
<p>=
34/56
</p>
<p>66/184
&asymp; 1.69 and
</p>
<p>f
X |Y
2|1
</p>
<p>f
X |Y
2|2
</p>
<p>=
22/56
</p>
<p>118/184
&asymp; 0.61 . (4.15)
</p>
<p>Thus, the proportion of individuals with the disease is 1.69 times higher among
</p>
<p>smokers when compared with non-smokers. Similarly, the proportion of healthy
</p>
<p>individuals is 0.61 times smaller among smokers when compared with non-smokers.
</p>
<p>The relative risks are calculated to compare the proportion of sick or healthy
</p>
<p>patients between smokers and non-smokers. Using these two relative risks, the odds
</p>
<p>ratio is obtained as
</p>
<p>O R =
34&times; 118
66&times; 22
</p>
<p>= 2.76.
</p>
<p>We can interpret this outcome as follows: (i) the chances of smoking are 2.76 times
</p>
<p>higher for individuals with the disease compared with healthy individuals (follows
</p>
<p>from definition (4.14)). We can also say that (ii) the chances of having the particular
</p>
<p>disease is 2.76 times higher for smokers compared with non-smokers. If we inter-
</p>
<p>change either one of the &ldquo;Yes&rdquo; and &ldquo;No&rdquo; columns or the &ldquo;Yes&rdquo; and &ldquo;No&rdquo; rows, we
</p>
<p>obtain O R = 1/2.76 &asymp; 0.36, giving us further interpretations: (iii) the chances of
smoking are 0.36 times lower for individuals without disease compared with indi-
</p>
<p>viduals with the disease, and (iv) the chance of having the particular disease is 0.36
</p>
<p>times lower for non-smokers compared with smokers. Note that all four interpreta-
</p>
<p>tions are correct and one needs to choose the right interpretation in the light of the
</p>
<p>experimental situation and the question of interest.
</p>
<p>4.3 Association Between Ordinal and ContinuousVariables
</p>
<p>4.3.1 Graphical Representation of Two ContinuousVariables
</p>
<p>A simple way to graphically summarize the association between two continuous
</p>
<p>variables is to plot the paired observations of the two variables in a two-dimensional
</p>
<p>coordinate system. If n paired observations for two continuous variables X and Y
</p>
<p>are available as (xi , yi ), i = 1, 2, . . . , n, then all such observations can be plotted</p>
<p/>
</div>
<div class="page"><p/>
<p>80 4 Association of Two Variables
</p>
<p>rBravais&minus;Pearson =0.91, rSpearman =0.87
</p>
<p>X
</p>
<p>Y
</p>
<p>(a) Strong positive linear relationship
</p>
<p>rBravais&minus;Pearson =&minus;0.92, rSpearman =&minus;0.92
</p>
<p>X
</p>
<p>Y
(b) Strong negative linear relationship
</p>
<p>rBravais&minus;Pearson =0.50, rSpearman =0.51
</p>
<p>X
</p>
<p>Y
</p>
<p>(c) Moderate positive relationship
</p>
<p>rBravais&minus;Pearson =&minus;0.56, rSpearman =&minus;0.55
</p>
<p>X
</p>
<p>Y
</p>
<p>(d) Moderate negative relationship
</p>
<p>Fig. 4.2 Scatter plots
</p>
<p>in a single graph. This graph is called a scatter plot. Such a plot reveals possible
</p>
<p>relationships and trends between the two variables. For example, Figs. 4.2 and 4.3
</p>
<p>show scatter plots with six different types of association.
</p>
<p>&bull; Figure4.2a shows increasing values of Y for increasing values of X . We call this
relationship positive association. The relationship between X and Y is nearly linear
</p>
<p>because all the points lie around a straight line.
</p>
<p>&bull; Figure4.2b shows decreasing values of Y for increasing values of X . We call this
relationship negative association.
</p>
<p>&bull; Figure4.2c tells us the same as Fig. 4.2a, except that the positive association is
weaker.</p>
<p/>
</div>
<div class="page"><p/>
<p>4.3 Association Between Ordinal and Continuous Variables 81
</p>
<p>rBravais&minus;Pearson =0.03, rSpearman =&minus;0.01
</p>
<p>X
</p>
<p>Y
</p>
<p>(a) No clear relationship
</p>
<p>rBravais&minus;Pearson =0.64, rSpearman =0.99
</p>
<p>X
</p>
<p>Y
(b) Nonlinear relationship
</p>
<p>Fig. 4.3 Continues Fig. 4.2&mdash;more scatter plots
</p>
<p>&bull; Figure4.2d tells us the same as Fig. 4.2b, except that the negative association is
weaker.
</p>
<p>&bull; Figure4.3a shows that as the X -values increase, the values of Y neither increase
nor decrease. This indicates that there is no clear relationship between X and Y
</p>
<p>and highlights the lack of association between X and Y .
</p>
<p>&bull; Figure4.3b illustrates a nonlinear relationship between X - and Y -values.
</p>
<p>Example 4.3.1 To explore the possible relationship between the overall number of
</p>
<p>tweets with the number of followers on Twitter, we take a sample of 10 prime
</p>
<p>ministers and heads of state in different countries as of June 2014 and obtain the
</p>
<p>following data:
</p>
<p>Name Tweets Followers
</p>
<p>Angela Merkel 25 7194
</p>
<p>Barack Obama 11,800 43,400,000
</p>
<p>Jacob Zuma 99 324,000
</p>
<p>Dilma Rousseff 1934 2,330,000
</p>
<p>Sauli Niinist&ouml; 199 39,000
</p>
<p>Vladimir Putin 2539 189,000
</p>
<p>Francois Hollande 4334 639,000
</p>
<p>David Cameron 952 688,000
</p>
<p>Enrique P. Nieto 3245 2,690,000
</p>
<p>John Key 2468 110,000
</p>
<p>The tweets are denoted by xi and the followers are denoted by yi , i = 1, 2, . . . , 10.
We plot paired observations (xi , yi ) into a cartesian coordinate system. For example,
</p>
<p>we plot (x1, y1) = (25, 7194) forAngelaMerkel, (x2, y2) = (11, 800, 43, 400, 000)</p>
<p/>
</div>
<div class="page"><p/>
<p>82 4 Association of Two Variables
</p>
<p>Fig. 4.4 Scatter plot
</p>
<p>between tweets and followers
</p>
<p>Tweets
</p>
<p>F
o
llo
w
e
rs
</p>
<p>0 2500 5000 7500 10000 12500
</p>
<p>5000
</p>
<p>10
5
</p>
<p>10
6
</p>
<p>10
7
</p>
<p>10
8
</p>
<p>5 &times; 10
8
</p>
<p>for Barack Obama, and so on. Figure4.4 shows the scatter plot for the number of
</p>
<p>tweets and the number of followers (on a log-scale).
</p>
<p>One can see that there is a positive association between the number of tweets and
</p>
<p>the number of followers. This does, however, not imply a causal relationship: it is
</p>
<p>not necessarily because someone tweets more he/she has more followers or because
</p>
<p>someone has more followers he/she tweets more; the scatter plot just describes that
</p>
<p>those with more tweets have more followers. In R, we produce this scatter plot by
</p>
<p>the plot command:
</p>
<p>tweets &lt;- c(25,11800,99,...)
</p>
<p>followers &lt;- c(7194,43400000,...)
</p>
<p>plot(tweets,followers)
</p>
<p>4.3.2 Correlation Coefficient
</p>
<p>Suppose two variables X and Y are measured on a continuous scale and are linearly
</p>
<p>related like Y = a + b X where a and b are constant values. The correlation coef-
ficient r(X, Y ) = r measures the degree of linear relationship between X and Y
using
</p>
<p>r =
&sum;n
</p>
<p>i=1(xi &minus; x̄)(yi &minus; ȳ)
&radic;
</p>
<p>&sum;n
i=1(xi &minus; x̄)2 &middot;
</p>
<p>&sum;n
i=1(yi &minus; ȳ)2
</p>
<p>=
Sxy
</p>
<p>&radic;
</p>
<p>Sxx Syy
, (4.16)
</p>
<p>with
</p>
<p>Sxx =
n
</p>
<p>&sum;
</p>
<p>i=1
(xi &minus; x̄)2 = ns̃2X , Syy =
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ȳ)2 = ns̃2Y , (4.17)
</p>
<p>and
</p>
<p>Sxy =
n
</p>
<p>&sum;
</p>
<p>i=1
(xi &minus; x̄)(yi &minus; ȳ) =
</p>
<p>n
&sum;
</p>
<p>i=1
xi yi &minus; nx̄ ȳ . (4.18)</p>
<p/>
</div>
<div class="page"><p/>
<p>4.3 Association Between Ordinal and Continuous Variables 83
</p>
<p>Karl Pearson (1857&ndash;1936) presented the first rigorous treatment of correlation and
</p>
<p>acknowledged Auguste Bravais (1811&ndash;1863) for ascertaining the initial mathemati-
</p>
<p>cal formulae for correlation. This is why the correlation coefficient is also known as
</p>
<p>the Bravais&ndash;Pearson correlation coefficient.
</p>
<p>The correlation coefficient is independent of the units of measurement of X and
</p>
<p>Y . For example, if someone measures the height and weight in metres and kilograms
</p>
<p>respectively and another person measures them in centimetres and grams, respec-
</p>
<p>tively, then the correlation coefficient between the two sets of data will be the same.
</p>
<p>The correlation coefficient is symmetric, i.e. r(X, Y ) = r(Y, X). The limits of r are
&minus;1 &le; r &le; 1. If all the points in a scatter plot lie exactly on a straight line, then the
linear relationship between X and Y is perfect and |r | = 1, see also Exercise 4.7. If
the relationship between X and Y is (i) perfectly linear and increasing, then r = +1
and (ii) perfectly linear and decreasing, then r = &minus;1. The signs of r thus determine
the direction of the association. If r is close to zero, then it indicates that the variables
</p>
<p>are independent or the relationship is not linear. Note that if the relationship between
</p>
<p>X and Y is nonlinear, then the degree of linear relationship may be low and r is then
</p>
<p>close to zero even if the variables are clearly not independent. Note that r(X, X) = 1
and r(X,&minus;X) = &minus;1.
</p>
<p>Example 4.3.2 Look again at the scatter plots in Figs. 4.2 and 4.3.We observe strong
</p>
<p>positive linear correlation in Fig. 4.2a (r = 0.91), strong negative linear correlation
in Fig. 4.2b (r = &minus;0.92), moderate positive linear correlation in Fig. 4.2c (r = 0.50),
moderate negative linear association in Fig. 4.2d (r = &minus;0.56), no visible correlation
in Fig. 4.3a (r = 0.03), and strong nonlinear (but not so strong linear) correlation in
Fig. 4.3b (r = 0.64).
</p>
<p>Example 4.3.3 In a decathlon competition, a group of athletes are competing with
</p>
<p>each other in 10 different track and field events. Suppose we are interested in how
</p>
<p>the results of the 100-m race relate to the results of the long jump competition. The
</p>
<p>correlation coefficient for the 100-m race (X , in seconds) and the long jump event
</p>
<p>(Y , in metres) for 5 athletes participating in the 2004 Olympic Games (see also
</p>
<p>Appendix A.4) are listed in Table4.7.
</p>
<p>To calculate the correlation coefficient, we need the following summary statistics:
</p>
<p>x̄ =
1
</p>
<p>5
(10.85+ 10.44+ 10.50+ 10.89+ 10.62) = 10.66
</p>
<p>ȳ =
1
</p>
<p>5
(7.84+ 7.96+ 7.81+ 7.47+ 7.74) = 7.764
</p>
<p>Sxx = (10.85&minus; 10.66)2 + (10.44&minus; 10.66)2 + &middot; &middot; &middot; + (10.62&minus; 10.66)2 = 0.1646
</p>
<p>Table 4.7 Results of 100-m
</p>
<p>race and long jump of 5
</p>
<p>athletes
</p>
<p>i xi yi
</p>
<p>Roman Sebrle 10.85 7.84
</p>
<p>Bryan Clay 10.44 7.96
</p>
<p>Dmitriy Karpov 10.50 7.81
</p>
<p>Dean Macey 10.89 7.47
</p>
<p>Chiel Warners 10.62 7.74</p>
<p/>
</div>
<div class="page"><p/>
<p>84 4 Association of Two Variables
</p>
<p>Syy = (7.84&minus; 7.764)2 + (7.96&minus; 7.764)2 + &middot; &middot; &middot; + (7.74&minus; 7.764)2 = 0.13332
Sxy = (10.85&minus; 10.66)(7.84&minus; 7.764) + &middot; &middot; &middot; + (10.62&minus; 10.66)(7.74&minus; 7.764)
</p>
<p>= &minus;0.1027
The correlation coefficient therefore is
</p>
<p>r =
Sxy
</p>
<p>&radic;
</p>
<p>Sxx Syy
=
</p>
<p>&minus;0.1027
&radic;
0.1646&times; 0.13332
</p>
<p>&asymp; &minus;0.69 .
</p>
<p>Since &minus;0.69 is negative, we can say that (i) there is a negative correlation between
the 100-m race and the long jump event, i.e., shorter running times result in longer
</p>
<p>long jump results, and (ii) this association is moderate to strong.
</p>
<p>In R, we can obtain the results (after attaching the data) as follows:
</p>
<p>cor(X.100m,X.Long.jump, method='pearson')
</p>
<p>4.3.3 Spearman&rsquo;s Rank Correlation Coefficient
</p>
<p>Consider a situation where n objects are ranked with respect to two variables X and
</p>
<p>Y . For instance, the variables could represent the opinion of two different judges
</p>
<p>in a talent competition who rank the participants with respect to their performance.
</p>
<p>This means that for each judge, the worst participant (with the lowest score xi ) is
</p>
<p>assigned rank 1, the second worst participant (with the second lowest score xi ) will
</p>
<p>receive rank 2, and so on. Thus, every participant has been given two ranks by two
</p>
<p>different judges. Suppose we want to measure the degree of association between the
</p>
<p>two different judgments; that is, the two different sets of ranks. We expect that under
</p>
<p>perfect agreement, both the judges give the same judgment in the sense that they give
</p>
<p>the same ranks to each candidate. However, if they are not in perfect agreement, then
</p>
<p>there may be some variation in the ranks assigned by them. To measure the degree of
</p>
<p>agreement, or, in general, the degree of association, one can use Spearman&rsquo;s rank
</p>
<p>correlation coefficient. As the name says, this correlation coefficient uses only the
</p>
<p>ranks of the values and not the values themselves. Thus, this measure is suitable
</p>
<p>for both ordinal and continuous variables. We introduce the following notations:
</p>
<p>let R(xi ) denote the rank of the i th observation on X , i.e. the rank xi among the
</p>
<p>ordered values of X . Similarly, R(yi ) denotes the rank of the i th observation of y.
</p>
<p>The difference between the two rank values is di = R(xi ) &minus; R(yi ). Spearman&rsquo;s rank
correlation coefficient is defined as
</p>
<p>R = 1&minus;
6
</p>
<p>&sum;n
i=1 d
</p>
<p>2
i
</p>
<p>n(n2 &minus; 1)
. (4.19)
</p>
<p>The values of R lie between &minus;1 and +1 and measure the degree of correlation
between the ranks of X and Y . Note that it does not matter whether we choose an
</p>
<p>ascending or descending order of the ranks, the value of R remains the same. When
</p>
<p>all the observations are assigned exactly the same ranks, then R = 1 and when all
the observations are assigned exactly the opposite ranks, then R = &minus;1.</p>
<p/>
</div>
<div class="page"><p/>
<p>4.3 Association Between Ordinal and Continuous Variables 85
</p>
<p>Example 4.3.4 Look again at the scatter plots in Figs. 4.2 and 4.3. We observe
</p>
<p>strong positive correlation in Fig. 4.2a (R = 0.87), strong negative correlation in
Fig. 4.2b (R = &minus;0.92), moderate positive correlation in Fig. 4.2c (R = 0.51), mod-
erate negative association in Fig. 4.2d (R = &minus;0.55), no visible correlation in Fig. 4.3a
(R = &minus;0.01), and strong nonlinear correlation in Fig. 4.3b (R = 0.99).
</p>
<p>Example 4.3.5 Let us follow Example 4.3.3 a bit further and calculate Spearman&rsquo;s
</p>
<p>rank correlation coefficient for the first five observations of the decathlon data. Again
</p>
<p>we list the results of the 100-m race (X ) and the results of the long jump competition
</p>
<p>(Y ). In addition, we assign ranks to both X and Y . For example, the shortest time
</p>
<p>receives rank 1, whereas the longest time receives rank 5. Similarly, the shortest long
</p>
<p>jump result receives rank 1, the longest long jump result receives rank 5.
</p>
<p>i xi R(xi ) yi R(yi ) di d
2
i
</p>
<p>Roman Sebrle 10.85 4 7.84 4 0 0
</p>
<p>Bryan Clay 10.44 1 7.96 5 &minus;4 16
Dmitriy Karpov 10.50 2 7.81 3 &minus;1 1
Dean Macey 10.89 5 7.47 1 &minus;4 16
Chiel Warners 10.62 3 7.74 2 &minus;1 1
Total 34
</p>
<p>Using (4.19), Spearman&rsquo;s rank correlation coefficient can be calculated as
</p>
<p>R = 1&minus;
6
&sum;n
</p>
<p>i=1 d
2
i
</p>
<p>n(n2 &minus; 1)
= 1&minus;
</p>
<p>6 &middot; 34
5 &middot; 24
</p>
<p>= &minus;0.7.
</p>
<p>We therefore have a moderate to strong negative association between the 100-m
</p>
<p>race and the long jump event. We now know that for the 5 athletes above longer
</p>
<p>running times relate to shorter jumping distances which in turn means that a good
</p>
<p>performance in one discipline implies a good performance in the other discipline. In
</p>
<p>R, we can obtain the same results by using the cor command:
</p>
<p>cor(X.100m,X.Long.jump, method='spearman')
</p>
<p>If two or more observations take the same values for xi (or yi ), then there is a
</p>
<p>tie. In such situations, the respective ranks can simply be averaged, though more
</p>
<p>complicated solutions also exist (one of which is implemented in the R function
</p>
<p>cor). For example, if in Example 4.3.5 Bryan Clay&rsquo;s was 10.50 s instead of 10.44 s,
</p>
<p>then both Bryan Clay and Dmitriy Karpov had the same time. Instead of assigning
</p>
<p>the ranks 1 and 2 to them, we assign the ranks 1.5 to each of them.
</p>
<p>The differences between the correlation coefficient and the rank correlation coeffi-
</p>
<p>cient aremanifold: firstly, Pearson&rsquo;s correlation coefficient can be used for continuous
</p>
<p>variables only, but not for nominal or ordinal variables. The rank correlation coeffi-
</p>
<p>cient can be used for either two continuous or two ordinal variables or a combination
</p>
<p>of an ordinal and a continuous variable, but not for two nominal variables. More-
</p>
<p>over, the rank correlation coefficient responds to any type of relationship whereas</p>
<p/>
</div>
<div class="page"><p/>
<p>86 4 Association of Two Variables
</p>
<p>Pearson&rsquo;s correlation measures the degree of a linear relationship only&mdash;see also
</p>
<p>Fig. 4.3b. Another difference between the two correlation coefficients is that Pear-
</p>
<p>son uses the entire information contained in the continuous data in contrast to the
</p>
<p>rank correlation coefficient which uses only ordinal information contained in the
</p>
<p>ordered data.
</p>
<p>4.3.4 Measures Using Discordant and Concordant Pairs
</p>
<p>Another concept which uses ranks to measure the association between ordinal vari-
</p>
<p>ables is based on concordant and discordant observation pairs. It is best illustrated
</p>
<p>by means of an example.
</p>
<p>Example 4.3.6 Suppose an online book store conducts a survey on their customer&rsquo;s
</p>
<p>satisfaction with respect to both the timeliness of deliveries (X ) and payment options
</p>
<p>(Y ). Let us consider the following 2&times; 3 contingency table with a summary of the
responses of 100 customers. We assume that the categories for both variables can
</p>
<p>be ordered and ranks can be assigned to different categories, see the numbers in
</p>
<p>brackets in Table4.8. There are 100 observation pairs (xi , yi ) which summarize the
</p>
<p>response of the customers with respect to both X and Y . For example, there are 18
</p>
<p>customers who were unsatisfied with the timeliness of the deliveries and complained
</p>
<p>that there are not enough payment options. If we compare two responses (xi1 , yi1) and
</p>
<p>(xi2 , yi2), it might be possible that one customer is more happy (or more unhappy)
</p>
<p>than the other customer with respect to both X and Y or that one customer is more
</p>
<p>happy with respect to X but more unhappy with respect to Y (or vice versa). If the
</p>
<p>former is the case, then this is a concordant observation pair; if the latter is true, then
</p>
<p>it is a discordant pair. For instance, a customer who replied &ldquo;enough&rdquo; and &ldquo;satisfied&rdquo;
</p>
<p>is more happy than a customer who replied &ldquo;not enough&rdquo; and &ldquo;unsatisfied&rdquo; because
</p>
<p>he is more happy with respect to both X and Y .
</p>
<p>In general, a pair is
</p>
<p>&bull; concordant if i2 &gt; i1 and j2 &gt; j1 (or i2 &lt; i1 and j2 &lt; j1),
&bull; discordant if i2 &lt; i1 and j2 &gt; j1 (or i2 &gt; i1 and j2 &lt; j1),
&bull; tied if i1 = i2 (or j1 = j2).
</p>
<p>Table 4.8 Payment options and timeliness survey with 100 participating customers
</p>
<p>Timeliness
</p>
<p>Unsatisfied Satisfied Very satisfied Total
</p>
<p>(1) (2) (3)
</p>
<p>Payment
</p>
<p>options
</p>
<p>Not enough (1) 7 11 26 44
</p>
<p>Enough (2) 10 15 31 56
</p>
<p>Total 17 26 57 100</p>
<p/>
</div>
<div class="page"><p/>
<p>4.3 Association Between Ordinal and Continuous Variables 87
</p>
<p>Obviously, if we have only concordant observations, then there is a strong posi-
</p>
<p>tive association because a higher value of X (in terms of the ranking) implies a
</p>
<p>higher value of Y . However, if we have only discordant observations, then there is
</p>
<p>a clear negative association. The measures which are introduced below simply put
</p>
<p>the number of concordant and discordant pairs into relation. This idea is reflected in
</p>
<p>Goodman and Kruskal&rsquo;s γ which is defined as
</p>
<p>γ =
K
</p>
<p>K + D
&minus;
</p>
<p>D
</p>
<p>K + D
=
</p>
<p>K &minus; D
K + D
</p>
<p>, (4.20)
</p>
<p>where
</p>
<p>K =
&sum;
</p>
<p>i&lt;m
</p>
<p>&sum;
</p>
<p>j&lt;n
</p>
<p>ni j nmn, D =
&sum;
</p>
<p>i&lt;m
</p>
<p>&sum;
</p>
<p>j&gt;n
</p>
<p>ni j nmn
</p>
<p>describe the number of concordant and discordant observation pairs, respectively.
</p>
<p>An alternative measure is Stuart&rsquo;s τc given as
</p>
<p>τc =
2min(k, l)(K &minus; D)
n2(min(k, l) &minus; 1)
</p>
<p>. (4.21)
</p>
<p>Bothmeasures are standardized to lie between&minus;1 and 1, where larger values indicate
a stronger association and the sign indicates the direction of the association.
</p>
<p>Example 4.3.7 Consider Example 4.3.6. A customerwho replied &ldquo;enough&rdquo; and &ldquo;sat-
</p>
<p>isfied&rdquo; is more happy than a customer who replied &ldquo;not enough&rdquo; and &ldquo;unsatisfied&rdquo;
</p>
<p>because the observation pairs, using ranks, are (2, 2) and (1, 1) and therefore i2 &gt; i1
and j2 &gt; j1. There are 7&times; 15 such pairs. Similarly those who said &ldquo;not enough&rdquo;
and &ldquo;unsatisfied&rdquo; are less happy than those who said &ldquo;enough&rdquo; and &ldquo;very satisfied&rdquo;
</p>
<p>(7&times; 31 pairs). Table 4.5 summarizes the comparisons in detail.
Table 4.5a shows that (x1, y1) = (not enough, unsatisfied) is concordant to
</p>
<p>(x2, y2) = (enough, satisfied) and (x2, y3) = (enough, very satisfied) and tied to
(x2, y1) = (enough, unsatisfied), (x1, y2) = (not enough, satisfied), and (x1, y3) =
(not enough, very satisfied). Thus for these comparisons, we have 0 discordant pairs,
</p>
<p>(7&times; 15) + (7&times; 31) concordant pairs and 7&times; (10+ 11+ 26) tied pairs. Table 4.5b&ndash;
f show how the task can be completed. While tiresome, systematically working
</p>
<p>through the table (and making sure to not count pairs more than once) yields
</p>
<p>K = 7&times; (15+ 31) + 11&times; 31 = 663
D = 10&times; (11+ 26) + 15&times; 26 = 760.
</p>
<p>As a visual rule of thumb, working from the top left to the bottom right yields the
</p>
<p>concordant pairs; and working from the bottom left to the top right yields the discor-
</p>
<p>dant pairs. It follows that K = (663&minus; 760)/(663+ 760) &asymp; &minus;0.07 which indicates
no clear relationship between the two variables. A similar result is obtained using
</p>
<p>τc which is 4&times; (760&minus; 663)/1002 &asymp; 0.039. This rather lengthy task can be made
much quicker by using the ord.gamma and ord.tau commands from the R library
</p>
<p>ryouready:</p>
<p/>
</div>
<div class="page"><p/>
<p>88 4 Association of Two Variables
</p>
<p>(a) y1 y2 y3
x1 t t
x2 t c c
</p>
<p>(b) y1 y2 y3
x1 t t
x2 d t c
</p>
<p>(c) y1 y2 y3
x1 t t
x2 d d t
</p>
<p>(d) y1 y2 y3
x1 t d d
x2 t t
</p>
<p>(e) y1 y2 y3
x1 c t d
x2 t t
</p>
<p>(f) y1 y2 y3
x1 c c t
x2 t t
</p>
<p>Fig.4.5 Scheme to visualize concordant (c), discordant (d), and tied (t) pairs in a 2&times; 3 contingency
table
</p>
<p>library(ryouready)
</p>
<p>ex &lt;- matrix(c(7,11,26,10,15,31),ncol=3,byrow=T)
</p>
<p>ord.gamma(ex)
</p>
<p>ord.tau(ex)
</p>
<p>4.4 Visualization of Variables fromDifferent Scales
</p>
<p>If we want to jointly visualize the association between a variable X , which is either
</p>
<p>nominal or ordinal and another variable Y , which is continuous, then we can use any
</p>
<p>graph which is suitable for the continuous variable (see Chaps. 2 and 3) and produce
</p>
<p>it for each category of the nominal/ordinal variable. We recommend using stratified
</p>
<p>box plots or stratified ECDF&rsquo;s, as they are easy to read when summarized in a single
</p>
<p>figure; however, it is also possible to place histograms next to each other or on top of
</p>
<p>each other, or overlay kernel density plots, but we do not illustrate this here in more
</p>
<p>detail.
</p>
<p>Example 4.4.1 Consider again our pizza delivery example (AppendixA.4). If we
</p>
<p>are interested in the pizza delivery times by branch, we may simply plot the box
</p>
<p>plots and ECDF&rsquo;s of delivery time by branch. Figure4.6 shows that the shortest
</p>
<p>delivery times can be observed in the branch in the East. Producing these graphs
</p>
<p>in R is straightforward: The boxplot command can be used for two variables by
</p>
<p>separating them with the &sim; sign. For the ECDF, we have to produce a plot for each
branch and overlay them with the &ldquo;add=TRUE&rdquo; option.
</p>
<p>boxplot(time&sim;branch)
plot.ecdf(time[branch=='East'])
</p>
<p>plot.ecdf(time[branch=='West'], add=TRUE)
</p>
<p>plot.ecdf(time[branch=='Centre'], add=TRUE)</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>4.5 Key Points and Further Issues 89
</p>
<p>Centre East West
</p>
<p>2
0
</p>
<p>3
0
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>Branch
</p>
<p>D
e
</p>
<p>liv
e
</p>
<p>ry
 T
</p>
<p>im
e
</p>
<p> (
in
</p>
<p> m
in
</p>
<p>)
</p>
<p>(a) Using box plots
</p>
<p>10 20 30 40 50
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>Delivery Time (in min)
</p>
<p>F
(x
</p>
<p>)
</p>
<p>West
</p>
<p>East
</p>
<p>Centre
</p>
<p>(b) Using ECDF&rsquo;s
</p>
<p>Fig. 4.6 Distribution of pizza delivery time stratified by branch
</p>
<p>4.5 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� How to use different measures of association:
</p>
<p>2 nominal variables &rarr; Pearson&rsquo;sχ2, relative risks, odds ratio,
Cramer&rsquo;s V , and Ccorr
</p>
<p>2 ordinal variables &rarr; Spearman&rsquo;s rank correlation coeffi-
cient, γ, τc
</p>
<p>2 continuous variables &rarr; Pearson&rsquo;s correlation coefficient,
Spearman&rsquo;s correlation coefficient
</p>
<p>� For two variables which are measured on different scales, for exam-
</p>
<p>ple continuous/ordinal or ordinal/nominal, one should use measures of
</p>
<p>association suitable for the less informative of the two scales.
</p>
<p>� Another graphical representation of both a continuous and discrete vari-
</p>
<p>able is stratified confidence interval plots (error plots), see Chap.9.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>90 4 Association of Two Variables
</p>
<p>4.6 Exercises
</p>
<p>Exercise 4.1 Anewspaper asks two of its staff to review the coffee quality at different
</p>
<p>trendy caf&eacute;s. The coffee can be rated on a scale from 1 (miserable) to 10 (excellent).
</p>
<p>The results of the two coffee enthusiasts X and Y are as follows:
</p>
<p>Caf&eacute; i xi yi
</p>
<p>1 3 6
</p>
<p>2 8 7
</p>
<p>3 7 10
</p>
<p>4 9 8
</p>
<p>5 5 4
</p>
<p>(a) Calculate and interpret Spearman&rsquo;s rank correlation coefficient.
</p>
<p>(b) Does Spearman&rsquo;s R differ depending onwhether ranks are assigned in a decreas-
</p>
<p>ing or increasing order?
</p>
<p>(c) Suppose the coffee can only be rated as either good (&gt;5) or bad (&le;5). Do the
chances of a good rating differ between the two journalists?
</p>
<p>Exercise 4.2 A total of 150 customers of a petrol station are asked about their satis-
</p>
<p>faction with their car and motorbike insurance. The results are summarized below:
</p>
<p>Satisfied Unsatisfied Total
</p>
<p>Car 33 25 58
</p>
<p>Car (diesel engine) 29 31 60
</p>
<p>Motorbike 12 20 32
</p>
<p>Total 74 76 150
</p>
<p>(a) Determine and interpret Pearson&rsquo;s χ2 statistic, Cramer&rsquo;s V , and Ccorr.
</p>
<p>(b) Combine the categories &ldquo;car&rdquo; and &ldquo;car (diesel engine)&rdquo; and produce the corre-
</p>
<p>sponding 2&times; 2 table. Calculate χ2 as efficiently as possible and give a mean-
ingful interpretation of the odds ratio.
</p>
<p>(c) Compare the results from (a) and (b).
</p>
<p>Exercise 4.3 There has been a big debate about the usefulness of speed limits on
</p>
<p>public roads. Consider the following table which lists the speed limits for country
</p>
<p>roads (in miles/h) and traffic deaths (per 100 million km) for different countries in
</p>
<p>1986 when the debate was particularly serious:
</p>
<p>(a) Draw the scatter plot for the two variables.
</p>
<p>(b) Calculate the Bravais&ndash;Pearson and Spearman correlation coefficients.</p>
<p/>
</div>
<div class="page"><p/>
<p>4.6 Exercises 91
</p>
<p>Country Speed limit Traffic deaths
</p>
<p>Denmark 55 4.1
</p>
<p>Japan 55 4.7
</p>
<p>Canada 60 4.3
</p>
<p>Netherlands 60 5.1
</p>
<p>Italy 75 6.1
</p>
<p>(c) What are the effects on the correlation coefficients if the speed limit is given in
</p>
<p>km/h rather than miles/h (1 mile/h &asymp; 1.61km/h)?
(d) Consider one more observation: the speed limit for England was 70miles/h and
</p>
<p>the death rate was 3.1.
</p>
<p>(i) Add this observation to the scatter plot.
</p>
<p>(ii) Calculate the Bravais&ndash;Pearson correlation coefficient given this additional
</p>
<p>observation.
</p>
<p>Exercise 4.4 The famous passenger liner Titanic hit an iceberg in 1912 and sank. A
</p>
<p>total of 337 passengers travelled in first class, 285 in second class, and 721 in third
</p>
<p>class. In addition, there were 885 staff members on board. Not all passengers could
</p>
<p>be rescued. Only the following were rescued: 135 from the first class, 160 from the
</p>
<p>second class, 541 from the third class and 674 staff.
</p>
<p>(a) Determine and interpret the contingency table for the variables &ldquo;travel class&rdquo;
</p>
<p>and &ldquo;rescue status&rdquo;.
</p>
<p>(b) Use a contingency table to summarize the conditional relative frequency distri-
</p>
<p>butions of rescue status given travel class. Could there be an association of the
</p>
<p>two variables?
</p>
<p>(c) What would the contingency table from (a) look like under the independence
</p>
<p>assumption? Calculate Cramer&rsquo;s V statistic. Is there any association between
</p>
<p>travel class and rescue status?
</p>
<p>(d) Combine the categories &ldquo;first class&rdquo; and &ldquo;second class&rdquo; as well as &ldquo;third class&rdquo;
</p>
<p>and &ldquo;staff&rdquo;. Create a contingency table based on these new categories. Determine
</p>
<p>and interpret Cramer&rsquo;s V , the odds ratio, and relative risks of your choice.
</p>
<p>(e) Given the results from (a) to (d), what are your conclusions?
</p>
<p>Exercise 4.5 To study the association of the monthly average temperature (in ◦C,
X ) and hotel occupation (in %, Y ), we consider data from three cities: Polenca
</p>
<p>(Mallorca, Spain) as a summer holiday destination, Davos (Switzerland) as a winter
</p>
<p>skiing destination, and Basel (Switzerland) as a business destination.</p>
<p/>
</div>
<div class="page"><p/>
<p>92 4 Association of Two Variables
</p>
<p>DD
</p>
<p>D
</p>
<p>D
</p>
<p>D
</p>
<p>DDD
</p>
<p>DD
</p>
<p>D
</p>
<p>D
</p>
<p>&minus;10 0 10 20 30
</p>
<p>0
2
</p>
<p>0
4
</p>
<p>0
6
0
</p>
<p>8
0
</p>
<p>1
0
</p>
<p>0
</p>
<p>Temperature
</p>
<p>h
o
</p>
<p>te
l 
o
</p>
<p>c
c
u
</p>
<p>p
a
</p>
<p>n
c
y
</p>
<p>P
</p>
<p>P
</p>
<p>P
</p>
<p>PP
P
</p>
<p>P
</p>
<p>P
</p>
<p>P
</p>
<p>P
</p>
<p>P
</p>
<p>B
</p>
<p>B
</p>
<p>B
B P B
</p>
<p>B
</p>
<p>B
</p>
<p>B
</p>
<p>B
</p>
<p>BB
</p>
<p>B
</p>
<p>Fig. 4.7 Temperature and hotel occupancy for the different cities
</p>
<p>Months Davos Polenca Basel
</p>
<p>X Y X Y X Y
</p>
<p>Jan &minus;6 91 10 13 1 23
Feb &minus;5 89 10 21 0 82
Mar 2 76 14 42 5 40
</p>
<p>Apr 4 52 17 64 9 45
</p>
<p>May 7 42 22 79 14 39
</p>
<p>Jun 15 36 24 81 20 43
</p>
<p>Jul 17 37 26 86 23 50
</p>
<p>Aug 19 39 27 92 24 95
</p>
<p>Sep 13 26 22 36 21 64
</p>
<p>Oct 9 27 19 23 14 78
</p>
<p>Nov 4 68 14 13 9 9
</p>
<p>Dec 0 92 12 41 4 12
</p>
<p>(a) Calculate the Bravais&ndash;Pearson correlation coefficient. The following summary
</p>
<p>statistics are available:
&sum;36
</p>
<p>i=1 xi yi = 22, 776, x̄ = 12.22, ȳ = 51.28, s̃2x = 76.95,
and s̃2y = 706.98.
</p>
<p>(b) Interpret the scatter plot in Fig. 4.7 which visualizes temperature and hotel occu-
</p>
<p>pancy for Davos (D), Polenca (P), and Basel (B).
</p>
<p>(c) Use R to calculate the correlation coefficient separately for each city. Interpret
</p>
<p>the results and discuss the use of the correlation coefficient if more than two
</p>
<p>variables are available.</p>
<p/>
</div>
<div class="page"><p/>
<p>4.6 Exercises 93
</p>
<p>Exercise 4.6 Consider a neighbourhood survey on the use of a local park. Respon-
</p>
<p>dents were asked whether the park may be used for summer music concerts and
</p>
<p>whether dog owners should put their dogs on a lead. The results are summarized in
</p>
<p>the following contingency table:
</p>
<p>Put dogs on a lead
</p>
<p>Agree No opinion Disagree Total
</p>
<p>Use for concerts Agree 82 4 0 86
</p>
<p>No opinion 8 43 9 60
</p>
<p>Disagree 0 2 10 12
</p>
<p>Total 90 49 19 158
</p>
<p>(a) Calculate and interpret Goodman and Kruskal&rsquo;s γ.
</p>
<p>(b) Now ignore the ordinal structure of the data and calculate Cramer&rsquo;s V .
</p>
<p>(c) Create the contingency table which is obtained when the categories &ldquo;no opinion&rdquo;
</p>
<p>and &ldquo;agree&rdquo; are combined.
</p>
<p>(d) What is the relative risk of disagreement with summer concerts depending on
</p>
<p>the opinion about using leads?
</p>
<p>(e) Calculate the odds ratio and offer two interpretations of it.
</p>
<p>(f) Determine γ for the table calculated in (c).
</p>
<p>(g) What is your final interpretation and what may be the best measure to use in this
</p>
<p>example?
</p>
<p>Exercise 4.7 Consider n observations for which yi = a + bxi , b &gt; 0, holds. Show
that r = 1.
</p>
<p>Exercise 4.8 Make yourself familiar with the Olympic decathlon data described in
</p>
<p>Appendix A.4. Read in and attach the data in R.
</p>
<p>(a) Use R to calculate and interpret the Bravais&ndash;Pearson correlation coefficient
</p>
<p>between the results of the discus and the shot-put events.
</p>
<p>(b) There are 10 continuous variables. How many different correlation coefficients
</p>
<p>can you calculate? How would you summarize them?
</p>
<p>(c) Apply the cor command to the whole data and interpret the output.
</p>
<p>(d) Omit the two rows which contain missing data and interpret the output again.
</p>
<p>Exercise 4.9 We are interested in the pizza delivery data which is described in
</p>
<p>Appendix A.4.
</p>
<p>(a) Read in the data and create two new binary variables which describe whether
</p>
<p>a pizza was hot (&gt;65 ◦C) and the delivery time was short (&lt;30min). Create a
contingency table for the two new variables.
</p>
<p>(b) Calculate and interpret the odds ratio for the contingency table from (a).</p>
<p/>
</div>
<div class="page"><p/>
<p>94 4 Association of Two Variables
</p>
<p>(c) UseCramer&rsquo;sV , Stuart&rsquo;s τc, Goodman andKruskal&rsquo;sγ, and a stacked bar chart to
</p>
<p>explore the association between the categorical time and temperature variables.
</p>
<p>(d) Draw a scatter plot for the continuous time and temperature variables. Determine
</p>
<p>both the Bravais&ndash;Pearson and Spearman correlation coefficients.
</p>
<p>(e) Use methods of your choice to explore the relationship between temperature
</p>
<p>and driver, operator, number of ordered pizzas and bill. Is it clear which of the
</p>
<p>variables influence the pizza temperature?
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 345</p>
<p/>
</div>
<div class="page"><p/>
<p>Part II
</p>
<p>Probability Calculus</p>
<p/>
</div>
<div class="page"><p/>
<p>5Combinatorics
</p>
<p>5.1 Introduction
</p>
<p>Combinatorics is a special branch of mathematics. It has many applications not
</p>
<p>only in several interesting fields such as enumerative combinatorics (the classical
</p>
<p>application), but also in other fields, for example in graph theory and optimization.
</p>
<p>First, we try to motivate and understand the role of combinatorics in statistics.
</p>
<p>Consider a simple example in which someone goes to a cafe. The person would
</p>
<p>like a hot beverage and a cake. Assume that one can choose among three different
</p>
<p>beverages, for example cappuccino, hot chocolate, and green tea, and three different
</p>
<p>cakes, let us say carrot cake, chocolate cake, and lemon tart. The person may consider
</p>
<p>different beverage and cake combinations when placing the order, for example carrot
</p>
<p>cake and cappuccino, carrot cake and tea, and hot chocolate and lemon tart. From a
</p>
<p>statistical perspective, the customer is evaluating the possible combinations before
</p>
<p>making a decision. Depending on their preferences, the order will be placed by
</p>
<p>choosing one of the combinations.
</p>
<p>In this example, it is easy to calculate the number of possible combinations.
</p>
<p>There are three different beverages and three different cakes to choose from, leading
</p>
<p>to nine different (3 &times; 3) beverage and cake combinations. However, suppose there
</p>
<p>is a choice of 15 hot beverages and 8 different cakes. How many orders can be
</p>
<p>made? (Answer: 15 &times; 8) What if the person decides to order two cakes, how will it
</p>
<p>affect the number of possible combinations of choices? It will be a tedious task to
</p>
<p>count all the possibilities. So we need a systematic approach to count such possible
</p>
<p>combinations. Combinatorics deals with the counting of different possibilities in a
</p>
<p>systematic approach.
</p>
<p>People often use the urn model to understand the system in the counting process.
</p>
<p>The urn model deals with the drawing of balls from an urn. The balls in the urn
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_5
</p>
<p>97</p>
<p/>
</div>
<div class="page"><p/>
<p>98 5 Combinatorics
</p>
<p>(a) (b) (c)
</p>
<p>(d) &ndash; &ndash; &ndash; ...
</p>
<p>(e) &ndash; &ndash;
</p>
<p>Fig. 5.1 a Representation of the urn model. Drawing from the urn model b with replacement and c
</p>
<p>without replacement. Compositions of three drawn balls: d all balls are distinguishable and e some
</p>
<p>balls are not distinguishable
</p>
<p>represent the units of a population, or the features of a population. The balls may
</p>
<p>vary in colour or size to represent specific properties of a unit or feature. We illustrate
</p>
<p>this concept in more detail in Fig. 5.1.
</p>
<p>Suppose there are 5 balls of three different colours&mdash;two black, one grey, and two
</p>
<p>white (see Fig. 5.1a). This can be generalized to a situation in which there are n balls
</p>
<p>in the urn and we want to draw m balls. Suppose we want to know
</p>
<p>&bull; how many different possibilities exist to draw m out of n balls (thus determining
</p>
<p>the number of distinguishable combinations).
</p>
<p>To deal with such a question, we first need to decide whether a ball will be put back
</p>
<p>into the urn after it is drawn or not. Figure 5.1b illustrates that a grey ball is drawn
</p>
<p>from the urn and then placed back (illustrated by the two-headed arrow). We say the
</p>
<p>ball is drawn with replacement. Figure 5.1c illustrates a different situation in which
</p>
<p>the grey ball is drawn from the urn and is not placed back into the urn (illustrated by
</p>
<p>the one-headed arrow). We say the ball is drawn without replacement.
</p>
<p>Further, we may be interested in knowing the
</p>
<p>&bull; total number of ways in which the chosen set of balls can be arranged in a distin-
</p>
<p>guishable order (which we will define as permutations later in this chapter).
</p>
<p>To answer the question how many permutations exist, we first need to decide whether
</p>
<p>all the chosen balls are distinguishable from each other or not. For example, in
</p>
<p>Fig. 5.1d, the three chosen balls have different colours; therefore, they are distin-
</p>
<p>guishable. There are many options on how they can be arranged. In contrast, some</p>
<p/>
</div>
<div class="page"><p/>
<p>5.1 Introduction 99
</p>
<p>of the chosen balls in Fig. 5.1e are the same colour, they are therefore not distin-
</p>
<p>guishable. Consequently, the number of combinations is much more limited. The
</p>
<p>concept of balls and urns just represents the features of observations from a sample.
</p>
<p>We illustrate this in more detail in the following example.
</p>
<p>Example 5.1.1 Say a father promises his daughter three scoops of ice cream if she
</p>
<p>cleans up her room. For simplicity, let us assume the daughter has a choice of four
</p>
<p>flavours: chocolate, banana, cherry, and lemon. How many different choices does the
</p>
<p>daughter have? If each scoop has to be a different flavour she obviously has much
</p>
<p>less choice than if the scoops can have the same flavour. In the urn model, this is rep-
</p>
<p>resented by the concept of &ldquo;with/without replacement&rdquo;. The urn contains 4 balls of 4
</p>
<p>different colours which represent the ice cream flavours. For each of the three scoops,
</p>
<p>a ball is drawn to determine the flavour. If we draw with replacement, each flavour
</p>
<p>can be potentially chosen multiple times; however, if we draw without replacement
</p>
<p>each flavour can be chosen only once. Then, the number of possible combinations
</p>
<p>is easy to calculate: it is 4, i.e. (chocolate, banana, and cherry); (chocolate, banana,
</p>
<p>and lemon); (chocolate, cherry, and lemon); and (banana, cherry, and lemon). But
</p>
<p>what if we have more choices? Or if we can draw flavours multiple times? We then
</p>
<p>need calculation rules which help us counting the number of options.
</p>
<p>Now, let us assume that the daughter picked the flavours (chocolate [C], banana
</p>
<p>[B], and lemon [L]). Like many other children, she prefers to eat her most favourite
</p>
<p>flavour (chocolate) last, and her least favourite flavour (cherry) first. Therefore, the
</p>
<p>order in which the scoops are placed on top of the cone are important! In how
</p>
<p>many different ways can the scoops be placed on top of the cone? This relates
</p>
<p>to the question of the number of distinguishable permutations. The answer is 6:
</p>
<p>(C,B,L)&ndash;(C,L,B)&ndash;(B,L,C)&ndash;(B,C,L)&ndash;(L,B,C)&ndash;(L,C,B). But what if the daughter did
</p>
<p>pick a flavour multiple times, e.g. (chocolate, chocolate, lemon)? Since the two
</p>
<p>chocolate scoops are non-distinguishable, there are fewer permutations: (chocolate,
</p>
<p>chocolate, and lemon)&ndash;(chocolate, lemon, and chocolate)&ndash;(lemon, chocolate, and
</p>
<p>chocolate).
</p>
<p>The bottom line of this example is that the number of combinations/options is
</p>
<p>determined by (i) whether we draw with or without replacement (i.e. allow flavours
</p>
<p>to be chosen more than once) and (ii) whether the arrangement in a particular order
</p>
<p>(=permutation) is of any specific interest.
</p>
<p>Consider the urn example again. Suppose three balls of different colours, black,
</p>
<p>grey, and white, are drawn. Now there are two options: The first option is to take into
</p>
<p>account the order in which the balls are drawn. In such a situation, two possible sets
</p>
<p>of balls such as (black, grey, and white) and (white, black, and grey) constitute two
</p>
<p>different sets. Such a set is called an ordered set. In the second option, we do not
</p>
<p>take into account the order in which the balls are drawn. In such a situation, the two
</p>
<p>possible sets of balls such as (black, grey, and white) and (white, black, and grey)
</p>
<p>are the same sets and constitute an unordered set of balls.</p>
<p/>
</div>
<div class="page"><p/>
<p>100 5 Combinatorics
</p>
<p>Definition 5.1.1 A group of elements is said to be ordered if the order in which
</p>
<p>these elements are drawn is of relevance. Otherwise, it is called unordered.
</p>
<p>Examples.
</p>
<p>&bull; Ordered samples:
</p>
<p>&ndash; The first three places in an Olympic 100 m race are determined by the order
</p>
<p>in which the athletes arrive at the finishing line. If 8 athletes are competing
</p>
<p>with each other, the number of possible results for the first three places is of
</p>
<p>interest. In the urn language, we are taking draws without replacement (since
</p>
<p>every athlete can only have one distinct place).
</p>
<p>&ndash; In a raffle with two prizes, the first drawn raffle ticket gets the first prize and the
</p>
<p>second raffle ticket gets the second prize.
</p>
<p>&ndash; There exist various esoteric tarot card games which claim to foretell someone&rsquo;s
</p>
<p>fortune with respect to several aspects of life. The order in which the cards are
</p>
<p>shown on the table is important for the interpretation.
</p>
<p>&bull; Unordered samples:
</p>
<p>&ndash; The selected members for a national football team. The order in which the
</p>
<p>selected names are announced is irrelevant.
</p>
<p>&ndash; Out of 10 economists, 10 medical doctors, and 10 statisticians, an advisory
</p>
<p>committee consisting of 4 economists, 3 medical doctors, and 2 statisticians is
</p>
<p>elected.
</p>
<p>&ndash; Fishing 20 fish from a lake.
</p>
<p>&ndash; A bunch of 10 flowers made from 21 flowers of 4 different colours.
</p>
<p>Definition 5.1.2 The factorial function n! is defined as
</p>
<p>n! =
</p>
<p>{
</p>
<p>1 for n = 0
</p>
<p>1 &middot; 2 &middot; 3 &middot; &middot; &middot; n for n &gt; 0.
(5.1)
</p>
<p>Example 5.1.2 It follows from the definition of the factorial function that
</p>
<p>0! = 1, 1! = 1 2! = 1 &middot; 2 = 2, 3! = 1 &middot; 2 &middot; 3 = 6 .
</p>
<p>This can be calculated in R as follows:
</p>
<p>factorial(n)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.2 Permutations 101
</p>
<p>5.2 Permutations
</p>
<p>Definition 5.2.1 Consider a set of n elements. Each ordered composition of these n
</p>
<p>elements is called a permutation.
</p>
<p>We distinguish between two cases: If all the elements are distinguishable, then we
</p>
<p>speak of permutation without replacement. However, if some or all of the elements
</p>
<p>are not distinguishable, then we speak of permutation with replacement. Please note
</p>
<p>that the meaning of &ldquo;replacement&rdquo; here is just a convention and does not directly
</p>
<p>refer to the drawings, e.g. from the urn model considered in Example 5.1.1.
</p>
<p>5.2.1 Permutations without Replacement
</p>
<p>If all the n elements are distinguishable, then there are
</p>
<p>n! (5.2)
</p>
<p>different compositions of these elements.
</p>
<p>Example 5.2.1 There were three candidate cities for hosting the 2020 Olympic
</p>
<p>Games: Tokyo (T), Istanbul (I), and Madrid (M). Before the election, there were
</p>
<p>3! = 6 possible outcomes, regarding the final rankings of the cities:
</p>
<p>(M, T, I), (M, I, T), (T, M, I), (T, I, M), (I, M, T), (I, T, M).
</p>
<p>5.2.2 Permutations with Replacement
</p>
<p>Assume that not all n elements are distinguishable. The elements are divided into
</p>
<p>groups, and these groups are distinguishable. Suppose, there are s groups of sizes
</p>
<p>n1, n2, . . . , ns . The total number of different ways to arrange the n elements in s
</p>
<p>groups is:
n!
</p>
<p>n1! n2! n3! &middot; &middot; &middot; ns !
. (5.3)
</p>
<p>Example 5.2.2 Consider the data in Fig. 5.1e. There are two groups consisting of two
</p>
<p>black balls (n1 = 2) and one white ball (n2 = 1). So there are the following three
</p>
<p>possible combinations to arrange the balls: (black, black, and white), (black, white,
</p>
<p>and black), and (white, black, and black). This can be determined by calculating
</p>
<p>3!
</p>
<p>2! 1!
=
</p>
<p>3 &middot; 2 &middot; 1
</p>
<p>2 &middot; 1 &middot; 1
= 3 .</p>
<p/>
</div>
<div class="page"><p/>
<p>102 5 Combinatorics
</p>
<p>5.3 Combinations
</p>
<p>Definition 5.3.1 The Binomial coefficient for any integers m and n with n &ge; m &ge; 0
</p>
<p>is denoted and defined as
(
</p>
<p>n
</p>
<p>m
</p>
<p>)
</p>
<p>=
n!
</p>
<p>m! (n &minus; m)!
. (5.4)
</p>
<p>It is read as &ldquo;n choose m&rdquo; and can be calculated in R using the following command:
</p>
<p>choose(n,m)
</p>
<p>There are several calculation rules for the binomial coefficient:
(
</p>
<p>n
</p>
<p>0
</p>
<p>)
</p>
<p>= 1,
</p>
<p>(
</p>
<p>n
</p>
<p>1
</p>
<p>)
</p>
<p>= n,
</p>
<p>(
</p>
<p>n
</p>
<p>m
</p>
<p>)
</p>
<p>=
</p>
<p>(
</p>
<p>n
</p>
<p>n &minus; m
</p>
<p>)
</p>
<p>,
</p>
<p>(
</p>
<p>n
</p>
<p>m
</p>
<p>)
</p>
<p>=
</p>
<p>m
&prod;
</p>
<p>i=1
</p>
<p>n + 1 &minus; i
</p>
<p>i
. (5.5)
</p>
<p>We now answer the question of how many different possibilities exist to draw m
</p>
<p>out of n elements, i.e. m out of n balls from an urn. It is necessary to distinguish
</p>
<p>between the following four cases:
</p>
<p>(1) Combinations without replacement and without consideration of the order of
</p>
<p>the elements.
</p>
<p>(2) Combinations without replacement and with consideration of the order of the
</p>
<p>elements.
</p>
<p>(3) Combinations with replacement and without consideration of the order of the
</p>
<p>elements.
</p>
<p>(4) Combinations with replacement and with consideration of the order of the ele-
</p>
<p>ments.
</p>
<p>5.3.1 Combinations without Replacement and without
Consideration of the Order
</p>
<p>When there is no replacement and the order of the elements is also not relevant, then
</p>
<p>the total number of distinguishable combinations in drawing m out of n elements is
(
</p>
<p>n
</p>
<p>m
</p>
<p>)
</p>
<p>. (5.6)
</p>
<p>Example 5.3.1 Suppose a company elects a new board of directors. The board con-
</p>
<p>sists of 5 members and 15 people are eligible to be elected. How many combinations
</p>
<p>for the board of directors exist? Since a person cannot be elected twice, we have a</p>
<p/>
</div>
<div class="page"><p/>
<p>5.3 Combinations 103
</p>
<p>situation where there is no replacement. The order is also of no importance: either
</p>
<p>one is elected or not. We can thus apply (5.6) which yields
(
</p>
<p>15
</p>
<p>5
</p>
<p>)
</p>
<p>=
15!
</p>
<p>10!5!
= 3003
</p>
<p>possible combinations. This result can be obtained in R by using the command
</p>
<p>choose(15,5).
</p>
<p>5.3.2 Combinations without Replacement and with Consideration
of the Order
</p>
<p>The total number of different combinations for the setting without replacement and
</p>
<p>with consideration of the order is
</p>
<p>n!
</p>
<p>(n &minus; m)!
=
</p>
<p>(
</p>
<p>n
</p>
<p>m
</p>
<p>)
</p>
<p>m! . (5.7)
</p>
<p>Example 5.3.2 Consider a horse race with 12 horses. A possible bet is to forecast
</p>
<p>the winner of the race, the second horse of the race, and the third horse of the race.
</p>
<p>The total number of different combinations for the horses in the first three places is
</p>
<p>12!
</p>
<p>(12 &minus; 3)!
= 12 &middot; 11 &middot; 10 = 1320 .
</p>
<p>This result can be explained intuitively: for the first place, there is a choice of 12
</p>
<p>different horses. For the second place, there is a choice of 11 different horses (12
</p>
<p>horses minus the winner). For the third place, there is a choice of 10 different horses
</p>
<p>(12 horses minus the first and second horses). The total number of combinations is
</p>
<p>the product 12 &middot; 11 &middot; 10. This can be calculated in R as follows:
</p>
<p>12 &lowast; 11 &lowast; 10
</p>
<p>5.3.3 Combinations with Replacement and without Consideration
of the Order
</p>
<p>The total number of different combinations with replacement and without consider-
</p>
<p>ation of the order is
(
</p>
<p>n + m &minus; 1
</p>
<p>m
</p>
<p>)
</p>
<p>=
(n + m &minus; 1)!
</p>
<p>m! (n &minus; 1)!
=
</p>
<p>(
</p>
<p>n + m &minus; 1
</p>
<p>n &minus; 1
</p>
<p>)
</p>
<p>. (5.8)
</p>
<p>Note that these are the two representations which follow from the definition of the
</p>
<p>binomial coefficient but typically only the first representation is used in textbooks.
</p>
<p>We will motivate the second representation after Example 5.3.3.</p>
<p/>
</div>
<div class="page"><p/>
<p>104 5 Combinatorics
</p>
<p>Example 5.3.3 A farmer has 2 fields and aspires to cultivate one out of 4 different
</p>
<p>organic products per field. Then, the total number of choices he has is
(
</p>
<p>4 + 2 &minus; 1
</p>
<p>2
</p>
<p>)
</p>
<p>=
</p>
<p>(
</p>
<p>5
</p>
<p>2
</p>
<p>)
</p>
<p>=
5!
</p>
<p>2! 3!
=
</p>
<p>3! &middot; 4 &middot; 5
</p>
<p>1 &middot; 2 &middot; 3!
= 10. (5.9)
</p>
<p>If 4 different organic products are denoted as a, b, c, and d, then the following
</p>
<p>combinations are possible:
</p>
<p>(a, a) (a, b) (a, c) (a, d)
</p>
<p>(b, b) (b, c) (b, d)
</p>
<p>(c, c) (c, d)
</p>
<p>(d, d)
</p>
<p>Please note that, for example, (a,b) is identical to (b,a) because the order in which
</p>
<p>the products a and b are cultivated on the first or second field is not important in this
</p>
<p>example.
</p>
<p>We now try to give an intuitive explanation of formula (5.9) using Example 5.3.3.
</p>
<p>We have n = 4 products and m = 2 fields and apply the following technical &ldquo;trick&rdquo;:
</p>
<p>we sort the combinations by the product symbols (a, b, c, or d). When we switch from
</p>
<p>one product to the next (e.g. from b to c), we make a note by adding a vertical line
</p>
<p>|. Whenever a product is skipped, we add a line too. For example, the combination
</p>
<p>(a, c) is denoted by a||c|, the combination (d, d) by |||dd, (c, c) by ||cc|, and (a, a)
</p>
<p>by aa|||. Therefore, the number of characters equates to the 2 chosen symbols of the
</p>
<p>set (a, b, c, d) plus the 3 vertical lines, in summary (4 + 2) &minus; 1 = 5 places where
</p>
<p>3 = n &minus; 1 places are selected for the vertical line |. How many different line/letter
</p>
<p>combinations exist? There are 3 out of 5 possible positions for |, i.e.
(
</p>
<p>5
3
</p>
<p>)
</p>
<p>= 10 possible
</p>
<p>combinations, and this is nothing but the right-hand side of (5.9).
</p>
<p>5.3.4 Combinations with Replacement and with Consideration of
the Order
</p>
<p>The total number of different combinations for the integers m and n with replacement
</p>
<p>and when the order is of relevance is
</p>
<p>nm . (5.10)
</p>
<p>Example 5.3.4 Consider a credit card with a four-digit personal identification num-
</p>
<p>ber (PIN) code. The total number of possible combinations for the PIN is
</p>
<p>nm = 104 = 10, 000.
</p>
<p>Note that every digit in the first, second, third, and fourth places (m = 4) can be
</p>
<p>chosen out of ten digits from 0 to 9 (n = 10).</p>
<p/>
</div>
<div class="page"><p/>
<p>5.4 Key Points and Further Issues 105
</p>
<p>5.4 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� The rules of combinatorics are as follows:
</p>
<p>Combinations without replacement with replacement
</p>
<p>without order
</p>
<p>(
</p>
<p>n
</p>
<p>m
</p>
<p>) (
</p>
<p>n + m &minus; 1
</p>
<p>m
</p>
<p>)
</p>
<p>with order
</p>
<p>(
</p>
<p>n
</p>
<p>m
</p>
<p>)
</p>
<p>m! nm
</p>
<p>� Combinations with and without replacement are also often called com-
</p>
<p>binations with and without repetition.
</p>
<p>� The permutation rules are as follows:
</p>
<p>without replacement with replacement
</p>
<p>Permutations n!
n!
</p>
<p>n1! &middot; &middot; &middot; ns !
</p>
<p>5.5 Exercises
</p>
<p>Exercise 5.1 At a party with 10 guests, every guest shakes hands with each other
</p>
<p>guest. How many handshakes can be counted in total?
</p>
<p>Exercise 5.2 A language teacher is concerned about the vocabularies of his students.
</p>
<p>He thus tests 5 students in each lecture. What are the total number of possible
</p>
<p>combinations
</p>
<p>(a) if a student is tested only once per lecture and
</p>
<p>(b) if a student is tested more than once per lecture?
</p>
<p>Use R to quantify numbers which you cannot calculate manually.
</p>
<p>Exercise 5.3 &ldquo;Gobang&rdquo; is a popular game in which two players set counters on a
</p>
<p>board with 381 knots. One needs to place 5 consecutive counters in a row to win
</p>
<p>the game. There are also rules on how to remove counters from the other player.
</p>
<p>Consider a match where 64 counters have already been placed on the board. How
</p>
<p>many possible combinations exist to place 64 counters on the board?</p>
<p/>
</div>
<div class="page"><p/>
<p>106 5 Combinatorics
</p>
<p>Exercise 5.4 A shop offers a special tray of beer: &ldquo;Munich&rsquo;s favourites&rdquo;. Customers
</p>
<p>are allowed to fill the tray, which holds 20 bottles, with any combination of Munich&rsquo;s
</p>
<p>6 most popular beers (from 6 different breweries).
</p>
<p>(a) What are the number of possible combinations to fill the tray?
</p>
<p>(b) A customer insists of having at least one beer from each brewery in his tray.
</p>
<p>How many options does he have to fill the tray?
</p>
<p>Exercise 5.5 The FIFA World Cup 2018 in Russia consists of 32 teams. How many
</p>
<p>combinations for the top 3 teams exist when
</p>
<p>(a) taking into account the order of these top 3 teams and
</p>
<p>(b) without taking into account the order of these top 3 teams?
</p>
<p>Exercise 5.6 An online book store assigns membership codes to each member. For
</p>
<p>administrative reasons, these codes consist of four letters between &ldquo;A&rdquo; and &ldquo;L&rdquo;.
</p>
<p>A special discount period increased the total number of members from 18, 200 to
</p>
<p>20, 500. Are there enough combinations of codes left to be assigned for the new
</p>
<p>membership codes?
</p>
<p>Exercise 5.7 In the old scoring system of ice skating (valid until 2004), each member
</p>
<p>of a jury of 9 people judged the performance of the skaters on a scale between 0 and
</p>
<p>6. It was a decimal scale and thus scores such as 5.1 and 5.2 were possible. Calculate
</p>
<p>the number of possible score combinations from the jury.
</p>
<p>Exercise 5.8 It is possible in Pascal&rsquo;s triangle (Fig. 5.2, left) to view each entry as
</p>
<p>the sum of the two entries directly above it. For example, the 3 on the fourth line
</p>
<p>1 5 10 10 5 1
5
</p>
<p>0
</p>
<p>5
</p>
<p>1
</p>
<p>5
</p>
<p>2
</p>
<p>5
</p>
<p>3
</p>
<p>5
</p>
<p>4
</p>
<p>5
</p>
<p>5
</p>
<p>)
</p>
<p>1 4 6 4 1
4
</p>
<p>0
</p>
<p>4
</p>
<p>1
</p>
<p>4
</p>
<p>2
</p>
<p>4
</p>
<p>3
</p>
<p>4
</p>
<p>4
</p>
<p>)
</p>
<p>1 3 3 1
3
</p>
<p>0
</p>
<p>3
</p>
<p>1
</p>
<p>3
</p>
<p>2
</p>
<p>3
</p>
<p>3
</p>
<p>)
</p>
<p>1 2 1
2
</p>
<p>0
</p>
<p>2
</p>
<p>1
</p>
<p>2
</p>
<p>2
</p>
<p>)
</p>
<p>1 1
1
</p>
<p>0
</p>
<p>1
</p>
<p>1
</p>
<p>)
</p>
<p>1
0
</p>
<p>0
</p>
<p>)
</p>
<p>Fig. 5.2 Excerpt from Pascal&rsquo;s triangle (left) and its representation by means of binomial coeffi-
</p>
<p>cients (right)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.5 Exercises 107
</p>
<p>from the top is the sum of the 1 and 2 above the 3. Another interpretation refers
</p>
<p>to a geometric representation of the binomial coefficient,
(
</p>
<p>n
k
</p>
<p>)
</p>
<p>(Fig. 5.2, right) with
</p>
<p>k = 0, 1, 2, . . . being the column index and n = 0, 1, 2, . . . being the row index.
</p>
<p>(a) Show that each entry in the bold third diagonal line can be represented via
(
</p>
<p>n
2
</p>
<p>)
</p>
<p>.
</p>
<p>(b) Now show that the sum of two consecutive entries in the bold third diagonal line
</p>
<p>always corresponds to quadratic numbers.
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 358</p>
<p/>
</div>
<div class="page"><p/>
<p>6Elements of Probability Theory
</p>
<p>Let us first consider some simple examples to understand the need for probability
</p>
<p>theory. Often one needs to make a decision whether to carry an umbrella or not when
</p>
<p>leaving the house; a company might wonder whether to introduce a new advertise-
</p>
<p>ment to possibly increase sales or to continue with their current advertisement; or
</p>
<p>someone may want to choose a restaurant based on where he can get his favourite
</p>
<p>dish. In all these situations, randomness is involved. For example, the decision of
</p>
<p>whether to carry an umbrella or not is based on the possibility or chance of rain.
</p>
<p>The sales of the company may increase, decrease, or remain unchanged with a new
</p>
<p>advertisement. The investment in a new advertising campaign may therefore only
</p>
<p>be useful if the probability of its success is higher than that of the current adver-
</p>
<p>tisement. Similarly, one may choose the restaurant where one is most confident of
</p>
<p>getting the food of one&rsquo;s choice. In all such cases, an event may be happening or not
</p>
<p>and depending on its likelihood, actions are taken. The purpose of this chapter is to
</p>
<p>learn how to calculate such likelihoods of events happening and not happening.
</p>
<p>6.1 Basic Concepts and Set Theory
</p>
<p>A simple (not rigorous) definition of a random experiment requires that the exper-
</p>
<p>iment can be repeated any number of times under the same set of conditions, and
</p>
<p>its outcome is known only after the completion of the experiment. A simple and
</p>
<p>classical example of a random experiment is the tossing of a coin or the rolling of a
</p>
<p>die. When tossing a coin, it is unknown what the outcome will be, head or tail, until
</p>
<p>the coin is tossed. The experiment can be repeated and different outcomes may be
</p>
<p>observed in each repetition. Similarly, when rolling a die, it is unknown how many
</p>
<p>dots will appear on the upper surface until the die is rolled. Again, the die can be
</p>
<p>rolled repeatedly and different numbers of dots are obtained in each trial. A possible
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_6
</p>
<p>109</p>
<p/>
</div>
<div class="page"><p/>
<p>110 6 Elements of Probability Theory
</p>
<p>outcome of a random experiment is called a simple event (or elementary event)
</p>
<p>and denoted by ωi . The set of all possible outcomes, {ω1,ω2, . . . ,ωk}, is called the
</p>
<p>sample space and is denoted as Ω , i.e. Ω = {ω1,ω2, . . . ,ωk}. Subsets of Ω are
</p>
<p>called events and are denoted by capital letters such as A, B,C . The set of all simple
</p>
<p>events that are contained in the event A is denoted by ΩA. The event Ā refers to
</p>
<p>the non-occurring of A and is called a composite or complementary event. Also
</p>
<p>Ω is an event. Since it contains all possible outcomes, we say that Ω will always
</p>
<p>occur and we call it a sure event or certain event. On the other hand, if we consider
</p>
<p>the null set &empty; = {} as an event, then this event can never occur and we call it an
</p>
<p>impossible event. The sure event therefore is the set of all elementary events, and
</p>
<p>the impossible event is the set with no elementary events.
</p>
<p>The above concepts of &ldquo;events&rdquo; form the basis of a definition of &ldquo;probability&rdquo;.
</p>
<p>Once we understand the concept of probability, we can develop a framework to make
</p>
<p>conclusions about the population of interest, using a sample of data.
</p>
<p>Example 6.1.1 (Rolling a die) If a die is rolled once, then the possible outcomes
</p>
<p>are the number of dots on the upper surface: 1, 2, . . . , 6. Therefore, the sample
</p>
<p>space is the set of simple events ω1 = &ldquo;1&rdquo;, ω2 = &ldquo;2&rdquo;, . . . , ω6 = &ldquo;6&rdquo; and Ω =
</p>
<p>{ω1,ω2, . . . ,ω6}. Any subset of Ω can be used to define an event. For example, an
</p>
<p>event A may be &ldquo;an even number of dots on the upper surface of the die&rdquo;. There are
</p>
<p>three possibilities that this event occurs: ω2,ω4, or ω6. If an odd number shows up,
</p>
<p>then the composite event Ā occurs instead of A. If an event is defined to observe only
</p>
<p>one particular number, say ω1 = &ldquo;1&rdquo;, then it is an elementary event. An example of
</p>
<p>a sure event is &ldquo;a number which is greater than or equal to 1&rdquo; because any number
</p>
<p>between 1 and 6 is greater than or equal to 1. An impossible event is &ldquo;the number is
</p>
<p>7&rdquo;.
</p>
<p>Example 6.1.2 (Rolling two dice) Suppose we throw two dice simultaneously and
</p>
<p>an event is defined as the &ldquo;number of dots observed on the upper surface of both the
</p>
<p>dice&rdquo;; then, there are 36 simple events defined as (number of dots on first die, number
</p>
<p>of dots on second die), i.e. ω1 = (1, 1),ω2 = (1, 2), . . . ,ω36 = (6, 6). Therefore Ω
</p>
<p>is
</p>
<p>Ω =
</p>
<p>{(1, 1), (1, 2), (1, 3), (1, 4), (1, 5), (1, 6)
</p>
<p>(2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6)
</p>
<p>(3, 1), (3, 2), (3, 3), (3, 4), (3, 5), (3, 6)
</p>
<p>(4, 1), (4, 2), (4, 3), (4, 4), (4, 5), (4, 6)
</p>
<p>(5, 1), (5, 2), (5, 3), (5, 4), (5, 5), (5, 6)
</p>
<p>(6, 1), (6, 2), (6, 3), (6, 4), (6, 5), (6, 6)}.
</p>
<p>One can define different events and their corresponding sample spaces. For exam-
</p>
<p>ple, if an event A is defined as &ldquo;upper faces of both the dice contain the same number
</p>
<p>of dots&rdquo;, then the sample space is ΩA = {(1, 1), (2, 2), (3, 3), (4, 4), (5, 5), (6, 6)}.
</p>
<p>If another event B is defined as &ldquo;the sum of numbers on the upper faces is 6&rdquo;, then</p>
<p/>
</div>
<div class="page"><p/>
<p>6.1 Basic Concepts and Set Theory 111
</p>
<p>Fig. 6.1 A &cup; B and A &cap; B&lowast;
</p>
<p>A B A B
</p>
<p>Fig. 6.2 A\B and
</p>
<p>Ā = Ω\A&lowast;
</p>
<p>A B A Ā
</p>
<p>the sample space is ΩB = {(1, 5), (2, 4), (3, 3), (4, 2), (5, 1)}. A sure event is &ldquo;get
</p>
<p>either an even number or an odd number&rdquo;; an impossible event would be &ldquo;the sum
</p>
<p>of the two dice is greater than 13&rdquo;.
</p>
<p>It is possible to view events as sets of simple events. This helps to determine how
</p>
<p>different events relate to each other. A popular technique to visualize this approach is
</p>
<p>to use Venn diagrams. In Venn diagrams, two or more sets are visualized by circles.
</p>
<p>Overlapping circles imply that both events have one or more identical simple events.
</p>
<p>Separated circles mean that none of the simple events of event A are contained in
</p>
<p>the sample space of B. We use the following notations:
</p>
<p>A &cup; B The union of events A &cup; B is the set of all simple events of A and B which
</p>
<p>occurs if at least one of the simple events of A or B occurs (Fig. 6.1, left
</p>
<p>side, grey shaded area). Please note that we use the word &ldquo;or&rdquo; from a
</p>
<p>statistical perspective: &ldquo;A or B&rdquo; means that either a simple event from A
</p>
<p>occurs, or a simple event from B occurs, or a simple event which is part
</p>
<p>of both A and B occurs.
</p>
<p>A &cap; B The intersection of events A &cap; B is the set of all simple events A and B
</p>
<p>which occur when a simple event occurs that belongs to A and B (Fig. 6.1,
</p>
<p>right side, grey shaded area).
</p>
<p>A\B The event A\B contains all simple events of A, which are not contained
</p>
<p>in B. The event &ldquo;A but not B&rdquo; or &ldquo;A minus B&rdquo; occurs, if A occurs but B
</p>
<p>does not occur. Also A\B = A &cap; B̄ (Fig. 6.2, left side, grey shaded area).
</p>
<p>Ā The event Ā contains all simple events of Ω , which are not contained in A.
</p>
<p>The complementary event of A (which is &ldquo;Not-A&rdquo; or &ldquo; Ā&rdquo; occurs whenever
</p>
<p>A does not occur (Fig. 6.2, right side, grey shaded area).
</p>
<p>A &sube; B A is a subset of B. This means that all simple events of A are also part of
</p>
<p>the sample space of B.</p>
<p/>
</div>
<div class="page"><p/>
<p>112 6 Elements of Probability Theory
</p>
<p>Example 6.1.3 Consider Example 6.1.1 where the sample space of rolling a die was
</p>
<p>determined as Ω = {ω1,ω2, . . . ,ω6} with ω1 = &ldquo;1&rdquo;, ω2 = &ldquo;2&rdquo;, . . . , ω6 = &ldquo;6&rdquo;.
</p>
<p>&bull; If A = {ω1,ω2,ω3,ω4,ω5} and B is the set of all odd numbers, then B =
</p>
<p>{ω1,ω3,ω5} and thus B &sube; A.
</p>
<p>&bull; If A = {ω2,ω4,ω6} is the set of even numbers and B = {ω3,ω6} is the set of all
</p>
<p>numbers which are divisible by 3, then A &cup; B = {ω2,ω3,ω4,ω6} is the collection
</p>
<p>of simple events for which the number is either even or divisible by 3 or both.
</p>
<p>&bull; If A = {ω1,ω3,ω5} is the set of odd numbers and B = {ω3,ω6} is the set of the
</p>
<p>numbers which are divisible by 3, then A &cap; B = {ω3} is the set of simple events
</p>
<p>in which the numbers are odd and divisible by 3.
</p>
<p>&bull; If A = {ω1,ω3,ω5} is the set of odd numbers and B = {ω3,ω6} is the set of the
</p>
<p>numbers which are divisible by 3, then A\B = {ω1,ω5} is the set of simple events
</p>
<p>in which the numbers are odd but not divisible by 3.
</p>
<p>&bull; If A = {ω2,ω4,ω6} is the set of even numbers, then Ā = {ω1,ω3,ω5} is the set of
</p>
<p>odd numbers.
</p>
<p>Remark 6.1.1 Some textbooks also use the following notations:
</p>
<p>A + B for A &cup; B
</p>
<p>AB for A &cap; B
</p>
<p>A &minus; B for A\B.
</p>
<p>We can use these definitions and notations to derive the following properties of a
</p>
<p>particular event A:
</p>
<p>A &cup; A = A A &cap; A = A
</p>
<p>A &cup;Ω = Ω A &cap;Ω = A
</p>
<p>A &cup; &empty; = A A &cap; &empty; = &empty;
</p>
<p>A &cup; Ā = Ω A &cap; Ā = &empty;.
</p>
<p>Definition 6.1.1 Two events A and B are disjoint if A &cap; B = &empty; holds, i.e. if both
</p>
<p>events cannot occur simultaneously.
</p>
<p>Example 6.1.4 The events A and Ā are disjoint events.
</p>
<p>Definition 6.1.2 The events A1, A2, . . . , Am are said to be mutually or pairwise
</p>
<p>disjoint, if Ai &cap; A j = &empty; whenever i �= j = 1, 2, ...,m.
</p>
<p>Example 6.1.5 Recall Example 6.1.1. If A = {ω1,ω3,ω5} and B = {ω2,ω4,ω6} are
</p>
<p>the sets of odd and even numbers, respectively, then the events A and B are disjoint.</p>
<p/>
</div>
<div class="page"><p/>
<p>6.1 Basic Concepts and Set Theory 113
</p>
<p>Definition 6.1.3 The events A1, A2, . . . , Am form a complete decomposition of Ω
</p>
<p>if and only if
</p>
<p>A1 &cup; A2 &cup; &middot; &middot; &middot; &cup; Am = Ω
</p>
<p>and
</p>
<p>Ai &cap; A j = &empty; (for all i �= j).
</p>
<p>Example 6.1.6 Consider Example 6.1.1. The elementary events A1 = {ω1}, A2 =
</p>
<p>{ω2}, . . . , A6 = {ω6} form a complete decomposition. Other complete decomposi-
</p>
<p>tions are, e.g.
</p>
<p>&bull; A1 = {ω1,ω3,ω5}, A2 = {ω2,ω4,ω6}
</p>
<p>&bull; A1 = {ω1}, A2 = {ω2,ω3,ω4,ω5,ω6}
</p>
<p>&bull; A1 = {ω1,ω2,ω3}, A2 = {ω4,ω5,ω6}.
</p>
<p>6.2 Relative Frequency and Laplace Probability
</p>
<p>There is a close connection between the relative frequency and the probability of
</p>
<p>an event. A random experiment is described by its possible outcomes, for example
</p>
<p>getting a number between 1 and 6 when rolling a die. Suppose an experiment has m
</p>
<p>possible outcomes (events) A1, A2, . . . , Am and the experiment is repeated n times.
</p>
<p>Now we can count how many times each of the possible outcome has occurred. In
</p>
<p>other words, we can calculate the absolute frequency ni = n(Ai ) which is equal to
</p>
<p>the number of times an event Ai , i = 1, 2, . . . ,m, occurs. The relative frequency
</p>
<p>fi = f (Ai ) of a random event Ai , with n repetitions of the experiment, is calculated
</p>
<p>as
</p>
<p>fi = f (Ai ) =
ni
</p>
<p>n
. (6.1)
</p>
<p>Example 6.2.1 Consider roulette, a game frequently played in casinos. The roulette
</p>
<p>table consists of 37 numbers from 0 to 36. Out of these 37 numbers, 18 numbers are
</p>
<p>red, 18 are black and one (zero) is green. Players can place their bets on either a single
</p>
<p>number or a range of numbers, the colours red or black, whether the number is odd
</p>
<p>or even, among many other choices. A casino employee spins a wheel (containing
</p>
<p>pockets representing the 37 numbers) in one direction and then spins a ball over the
</p>
<p>wheel in the opposite direction. The wheel and ball gradually slow down and the
</p>
<p>ball finally settles in a pocket. The pocket number in which the ball sits down when
</p>
<p>the wheel stops is the winning number. Consider three possible outcomes A1: &ldquo;red&rdquo;,
</p>
<p>A2:&ldquo;black&rdquo;, and A3: &ldquo;green (zero)&rdquo;. Suppose the roulette ball is spun n = 500 times.
</p>
<p>All the outcomes are counted and recorded as follows: A1 occurs 240 times, A2
occurs 250 times and A3 occurs 10 times. Then, the absolute frequencies are given</p>
<p/>
</div>
<div class="page"><p/>
<p>114 6 Elements of Probability Theory
</p>
<p>by n1 = n(A1) = 240, n2 = n(A2) = 250, and n3 = n(A3) = 10. We therefore get
</p>
<p>the relative frequencies as
</p>
<p>f1 = f (A1) =
240
</p>
<p>500
= 0.48 , f2 = f (A2) =
</p>
<p>250
</p>
<p>500
= 0.5,
</p>
<p>f3 = f (A3) =
10
</p>
<p>500
= 0.02.
</p>
<p>If we assume that the experiment is repeated a large number of times (mathe-
</p>
<p>matically, this would mean that n tends to infinity) and the experimental conditions
</p>
<p>remain the same (at least approximately) over all the repetitions, then the relative
</p>
<p>frequency f (A) converges to a limiting value for A. This limiting value is interpreted
</p>
<p>as the probability of A and denoted by P(A), i.e.
</p>
<p>P(A) = lim
n&rarr;&infin;
</p>
<p>n(A)
</p>
<p>n
</p>
<p>where n(A) denotes the number of times an event A occurs out of n times.
</p>
<p>Example 6.2.2 Suppose a fair coin is tossed n = 20 times and we observe the number
</p>
<p>of heads n(A1) = 8 times and number of tails n(A2) = 12 times. The meaning
</p>
<p>of a fair coin in this case is that the probabilities of head and tail are equal (i.e.
</p>
<p>0.5). Then, the relative frequencies in the experiment are f (A1) = 8/20 = 0.4 and
</p>
<p>f (A2) = 12/20 = 0.6. When the coin is tossed a large number of times and n tends
</p>
<p>to infinity, then both f (A1) and f (A2) will have a limiting value 0.5 which is simply
</p>
<p>the probability of getting a head or tail in tossing a fair coin.
</p>
<p>Example 6.2.3 In Example 6.2.1, the relative frequency of f (red) = f (A1) tends to
</p>
<p>18/37 as n tends to infinity because 18 out of 37 numbers are red.
</p>
<p>The reader will gain a more theoretical understanding of how repeated experiments
</p>
<p>relate to expected quantities in the following chapters after learning the Theorem of
</p>
<p>Large Numbers described in Appendix A.3.
</p>
<p>A different definition of probability was given by Pierre-Simon Laplace (1749&ndash;
</p>
<p>1827). We call an experiment a Laplace experiment if the number of possible
</p>
<p>simple events is finite and all the outcomes are equally probable. The probability of
</p>
<p>an arbitrary event A is then defined as follows:
</p>
<p>Definition 6.2.1 The proportion
</p>
<p>P(A) =
|A|
</p>
<p>|Ω|
=
</p>
<p>Number of &ldquo;favourable simple events&rdquo; for A
</p>
<p>Total number of possible simple events
(6.2)
</p>
<p>is called the Laplace probability, where |A| is the cardinal number of A, i.e. the
</p>
<p>number of simple events contained in the set A, and |Ω| is the cardinal number of
</p>
<p>Ω , i.e. the number of simple events contained in the set Ω .
</p>
<p>The cardinal numbers |A| and |Ω| are often calculated using the combinatoric
</p>
<p>rules introduced in Chap. 5.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_5">http://dx.doi.org/10.1007/978-3-319-46162-5_5</a></div>
</div>
<div class="page"><p/>
<p>6.2 Relative Frequency and Laplace Probability 115
</p>
<p>Example 6.2.4 (Example 6.1.2 continued) The sample space contains 36 simple
</p>
<p>events. All of these simple events have equal probability 1/36. To calculate the
</p>
<p>probability of the event A that the sum of the dots on the two dice is at least 4 and at
</p>
<p>most 6, we count the favourable simple events which fulfil this condition. The simple
</p>
<p>events are (1, 3), (2, 2), (3, 1) (sum is 4), (1, 4), (2, 3), (4, 1), (3, 2) (sum is 5) and
</p>
<p>(1, 5), (2, 4), (3, 3), (4, 2), (5, 1) (sum is 6). In total, there are (3 + 4 + 5) = 12
</p>
<p>favourable simple events, i.e.
</p>
<p>A = {(1, 3), (2, 2), (3, 1), (1, 4), (2, 3), (4, 1),
</p>
<p>(3, 2), (1, 5), (2, 4), (3, 3), (4, 2), (5, 1)} .
</p>
<p>The probability of the event A is therefore 12/36 = 1/3.
</p>
<p>6.3 The Axiomatic Definition of Probability
</p>
<p>An important foundation for modern probability theory was established by
</p>
<p>A.N. Kolmogorov in 1933 when he proposed the following axioms of probability.
</p>
<p>Axiom 1 Every random event A has a probability in the (closed) interval [0, 1], i.e.
</p>
<p>0 &le; P(A) &le; 1.
</p>
<p>Axiom 2 The sure event has probability 1, i.e.
</p>
<p>P(Ω) = 1.
</p>
<p>Axiom 3 If A1 and A2 are disjoint events, then
</p>
<p>P(A1 &cup; A2) = P(A1)+ P(A2).
</p>
<p>holds.
</p>
<p>Remark Axiom 3 also holds for three or more disjoint events and is called the
</p>
<p>theorem of additivity of disjoint events. For example, if A1, A2, and A3 are disjoint
</p>
<p>events, then P(A1 &cup; A2 &cup; A3) = P(A1)+ P(A2)+ P(A3).
</p>
<p>Example 6.3.1 Suppose the two events in tossing a coin are A1: &ldquo;appearance of head&rdquo;
</p>
<p>and A2: &ldquo;appearance of tail&rdquo; which are disjoint. The event A1 &cup; A2: &ldquo;appearance of
</p>
<p>head or tail&rdquo; has the probability
</p>
<p>P(A1 &cup; A2) = P(A1)+ P(A2) = 1/2 + 1/2 = 1.
</p>
<p>Example 6.3.2 Suppose an event is defined as the number of points observed on the
</p>
<p>upper surface of a die when rolling it. There are six events, i.e. the natural numbers
</p>
<p>1, 2, 3, 4, 5, 6. These events are disjoint and they have equal probability of occurring:
</p>
<p>P(1) = P(2) = &middot; &middot; &middot; = P(6) = 1/6. The probability of getting an even number is
</p>
<p>then
</p>
<p>P(&ldquo;even number&rdquo;) = P(2)+ P(4)+ P(6) = 1/6 + 1/6 + 1/6 = 1/2.</p>
<p/>
</div>
<div class="page"><p/>
<p>116 6 Elements of Probability Theory
</p>
<p>6.3.1 Corollaries Following from Kolomogorov&rsquo;s Axioms
</p>
<p>We already know that A &cup; Ā = Ω (sure event). Since A and Ā are disjoint, using
</p>
<p>Axiom 3 we have
</p>
<p>P(A &cup; Ā) = P(A)+ P( Ā) = 1 .
</p>
<p>Based on this, we have the following corollaries.
</p>
<p>Corollary 1 The probability of the complementary event of A, (i.e. Ā) is
</p>
<p>P( Ā) = 1 &minus; P(A). (6.3)
</p>
<p>Example 6.3.3 Suppose a box of 30 chocolates contains chocolates of 6 differ-
</p>
<p>ent flavours with 5 chocolates of each flavour. Suppose an event A is defined as
</p>
<p>A = {&ldquo;marzipan flavour&rdquo;}. The probability of finding a marzipan chocolate (with-
</p>
<p>out looking into the box) is P(&ldquo;marzipan&rdquo;) = 5/30. Then, the probability of the
</p>
<p>complementary event Ā, i.e. the probability of not finding a marzipan chocolate is
</p>
<p>therefore
</p>
<p>P(&ldquo;no marzipan flavour&rdquo;) = 1 &minus; P(&ldquo;marzipan flavour&rdquo;) = 25/30.
</p>
<p>Corollary 2 The probability of occurrence of an impossible event &empty; is zero:
</p>
<p>P(&empty;) = P(Ω̄) = 1 &minus; P(Ω) = 0.
</p>
<p>Corollary 3 Let A1 and A2 be not necessarily disjoint events. The probability of
</p>
<p>occurrence of A1 or A2 is
</p>
<p>P(A1 &cup; A2) = P(A1)+ P(A2)&minus; P(A1 &cap; A2). (6.4)
</p>
<p>The rule in (6.4) is known as the additive theorem of probability. Again we use
</p>
<p>the word &ldquo;or&rdquo; in the statistical sense: either A1 is occurring, A2 is occurring, or both
</p>
<p>of them. This means we have to add the probabilities P(A1) and P(A2) but need to
</p>
<p>make sure that the simple events which are contained in both sets are not counted
</p>
<p>twice, thus we subtract P(A1 &cap; A2).
</p>
<p>Example 6.3.4 There are 10 actors acting in a play. Two actors, one of whom is
</p>
<p>male, are portraying evil characters. In total, there are 6 female actors. Let an event
</p>
<p>A describe whether the actor is male and another event B describe whether the
</p>
<p>character is evil. Suppose we want to know the probability of a randomly chosen
</p>
<p>actor being male or evil. We can then calculate
</p>
<p>P(actor is male or evil) =
</p>
<p>= P(actor is male)+ P(actor is evil)&minus; P(actor is male and evil)
</p>
<p>=
4
</p>
<p>10
+
</p>
<p>2
</p>
<p>10
&minus;
</p>
<p>1
</p>
<p>10
=
</p>
<p>1
</p>
<p>2
.</p>
<p/>
</div>
<div class="page"><p/>
<p>6.3 The Axiomatic Definition of Probability 117
</p>
<p>Corollary 4 If A &sube; B then P(A) &le; P(B).
</p>
<p>Proof We use the representation B = A &cup; ( Ā &cap; B) where A and Ā &cap; B are the
</p>
<p>disjoint events. Then using Axiom 3 and Axiom 1, we get
</p>
<p>P(B) = P(A)+ P( Ā &cap; B) &ge; P(A) .
</p>
<p>6.3.2 Calculation Rules for Probabilities
</p>
<p>The introduced axioms and corollaries can be summarized as follows:
</p>
<p>(1) 0 &le; P(A) &le; 1
</p>
<p>(2) P(Ω) = 1
</p>
<p>(3) P(A1 &cup; A2) = P(A1)+ P(A2), if A1 and A2 are disjoint
</p>
<p>(4) P(&empty;) = 0
</p>
<p>(5) P( Ā) = 1 &minus; P(A)
</p>
<p>(6) P(A1 &cup; A2) = P(A1)+ P(A2)&minus; P(A1 &cap; A2)
</p>
<p>(7) P(A) &le; P(B), if A &sube; B
</p>
<p>6.4 Conditional Probability
</p>
<p>Consider the following example to understand the concept of conditional probability:
</p>
<p>Suppose a new medical test is developed to diagnose a particular infection of the
</p>
<p>blood. The test is conducted on blood samples from 100 randomly selected patients
</p>
<p>and the outcomes of the tests are presented in Table 6.1.
</p>
<p>There are the following four possible outcomes:
</p>
<p>&bull; The blood sample has an infection and the test diagnoses it, i.e. the test is correctly
</p>
<p>diagnosing the infection.
</p>
<p>&bull; The blood sample does not have an infection and the test does not diagnose it, i.e.
</p>
<p>the test is correctly diagnosing that there is no infection.
</p>
<p>&bull; The blood sample has an infection and the test does not diagnose it, i.e. the test is
</p>
<p>incorrect in stating that there is no infection.
</p>
<p>&bull; The blood sample does not have an infection but the test diagnoses it, i.e. the test
</p>
<p>is incorrect in stating that there is an infection.
</p>
<p>Table 6.2 contains the relative frequencies of Table 6.1. In the following, we in-
</p>
<p>terpret the relative frequencies as probabilities, i.e. we assume that the values in
</p>
<p>Table 6.2 would be observed if the number n of patients was much larger than 100.
</p>
<p>It can be seen that the probability that a test is positive is P(T+) = 0.30 + 0.10 =
</p>
<p>0.40 and the probability that an infection is present is P(I P) = 0.30 + 0.15 = 0.45.</p>
<p/>
</div>
<div class="page"><p/>
<p>118 6 Elements of Probability Theory
</p>
<p>Table 6.1 Absolute frequencies of test results and infection status
</p>
<p>Infection Total (row)
</p>
<p>Present Absent
</p>
<p>Test Positive (+) 30 10 40
</p>
<p>Negative (&minus;) 15 45 60
</p>
<p>Total (column) 45 55 Total = 100
</p>
<p>Table 6.2 Relative frequencies of patients and test
</p>
<p>Infection Total (row)
</p>
<p>Present (IP) Absent (IA)
</p>
<p>Test Positive (+) 0.30 0.10 0.40
</p>
<p>Negative (&minus;) 0.15 0.45 0.60
</p>
<p>Total (column) 0.45 0.55 Total = 1
</p>
<p>If one already knows that the test is positive and wants to determine the probability
</p>
<p>that the infection is indeed present, then this can be achieved by the respective
</p>
<p>conditional probability P(I P|T+) which is
</p>
<p>P(I P|T+) =
P(I P &cap; T+)
</p>
<p>P(T+)
=
</p>
<p>0.3
</p>
<p>0.4
= 0.75.
</p>
<p>Note that I P &cap; T+ denotes the &ldquo;relative frequency of blood samples in which the
</p>
<p>disease is present and the test is positive&rdquo; which is 0.3.
</p>
<p>More generally, recall Definition 4.1.1 from Chap. 4 where we defined condi-
</p>
<p>tional, joint, and marginal frequency distributions in contingency tables. The present
</p>
<p>example simply applies these rules to the contingency tables of relative frequencies
</p>
<p>and interprets the relative frequencies as an approximation to the probabilities of
</p>
<p>interest, as already explained.
</p>
<p>We use the intersection operator &cap; to describe events which occur for A = a
</p>
<p>and B = b. This relates to the joint relative frequencies. The marginal relative fre-
</p>
<p>quencies (i.e. probabilities P(A = a)) can be observed from the column and row
</p>
<p>sums, respectively; and the conditional probabilities can be observed as the joint
</p>
<p>frequencies in relation to the marginal frequencies.
</p>
<p>For simplicity, assume that all simple events in Ω = {ω1,ω2, . . . ,ωk} are equally
</p>
<p>probable, i.e. P(ω j ) =
1
k
, j = 1, 2, . . . , k. Let A and B be two events containing n A
</p>
<p>and nB numbers of simple events. Let further A &cap; B contain n AB numbers of simple
</p>
<p>events. The Laplace probability using (6.2) is
</p>
<p>P(A) =
n A
</p>
<p>k
, P(B) =
</p>
<p>nB
</p>
<p>k
, P(A &cap; B) =
</p>
<p>n AB
</p>
<p>k
.
</p>
<p>Assume that we have prior information that A has already occurred. Now we want to
</p>
<p>find out how the probability of B is to be calculated. Since A has already occurred,
</p>
<p>we know that the sample space is reduced by the number of simple events which</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>6.4 Conditional Probability 119
</p>
<p>are contained in A. There are n A such simple events. Thus, the total sample space
</p>
<p>Ω is reduced by the sample space of A. Therefore, the simple events in A &cap; B are
</p>
<p>those simple events which are realized when B is realized. The Laplace probability
</p>
<p>for B under the prior information on A, or under the condition that A is known, is
</p>
<p>therefore
</p>
<p>P(B|A) =
n AB/k
</p>
<p>n A/k
=
</p>
<p>P(A &cap; B)
</p>
<p>P(A)
. (6.5)
</p>
<p>This can be generalized to the case when the probabilities for simple events are
</p>
<p>unequal.
</p>
<p>Definition 6.4.1 Let P(A) &gt; 0. Then the conditional probability of event B oc-
</p>
<p>curring, given that event A has already occurred, is
</p>
<p>P(B|A) =
P(A &cap; B)
</p>
<p>P(A)
. (6.6)
</p>
<p>The roles of A and B can be interchanged to define P(A|B) as follows. Let P(B) &gt; 0.
</p>
<p>The conditional probability of A given B is
</p>
<p>P(A|B) =
P(A &cap; B)
</p>
<p>P(B)
. (6.7)
</p>
<p>We now introduce a few important theorems which are relevant to calculating
</p>
<p>conditional and other probabilities.
</p>
<p>Theorem 6.4.1 (Multiplication Theorem of Probability) For two arbitrary events A
</p>
<p>and B, the following holds:
</p>
<p>P(A &cap; B) = P(A|B)P(B) = P(B|A)P(A). (6.8)
</p>
<p>This theorem follows directly from the two definitions (6.6) and (6.7) (but does not
</p>
<p>require that P(A) &gt; 0 and P(B) &gt; 0).
</p>
<p>Theorem 6.4.2 (Law of Total Probability) Assume that A1, A2, . . . , Am are events
</p>
<p>such that &cup;mi=1 Ai = Ω and Ai &cap; A j = &empty; for all i �= j, P(Ai ) &gt; 0 for all i , i.e. A1,
</p>
<p>A2, . . . , Am form a complete decomposition of Ω = &cup;
m
i=1 Ai in pairwise disjoint
</p>
<p>events, then the probability of an event B can be calculated as
</p>
<p>P(B) =
</p>
<p>m&sum;
</p>
<p>i=1
</p>
<p>P(B|Ai )P(Ai ) . (6.9)</p>
<p/>
</div>
<div class="page"><p/>
<p>120 6 Elements of Probability Theory
</p>
<p>6.4.1 Bayes&rsquo; Theorem
</p>
<p>Bayes&rsquo; Theorem gives a connection between P(A|B) and P(B|A). For events A and
</p>
<p>B with P(A) &gt; 0 and P(B) &gt; 0, using (6.6) and (6.7) or (6.8), we get
</p>
<p>P(A|B) =
P(A &cap; B)
</p>
<p>P(B)
=
</p>
<p>P(A &cap; B)
</p>
<p>P(A)
</p>
<p>P(A)
</p>
<p>P(B)
</p>
<p>=
P(B|A)P(A)
</p>
<p>P(B)
. (6.10)
</p>
<p>Let A1, A2, . . . , Am be events such that&cup;
m
i=1 Ai = Ω and Ai &cap; A j = &empty; for all i �=
</p>
<p>j, P(Ai ) &gt; 0 for all i , and B is another event than A, then using (6.9) and (6.10),
</p>
<p>we get
</p>
<p>P(A j |B) =
P(B|A j )P(A j )&sum;
i P(B|Ai )P(Ai )
</p>
<p>. (6.11)
</p>
<p>The probabilities P(Ai ) are called prior probabilities, P(B|Ai ) are sometimes
</p>
<p>called model probabilities and P(A j |B) are called posterior probabilities.
</p>
<p>Example 6.4.1 Suppose someone rents movies from two different DVD stores.
</p>
<p>Sometimes it happens that the DVD does not work because of scratches. We con-
</p>
<p>sider the following events: Ai (i = 1, 2): &ldquo;the DVD is rented from store i&rdquo;. Further
</p>
<p>let B denote the event that the DVD is working without any problems. Assume we
</p>
<p>know that P(A1) = 0.6 and P(A2) = 0.4 (note that A2 = Ā1) and P(B|A1) = 0.95,
</p>
<p>P(B|A2) = 0.75 and we are interested in the probability that a rented DVD works
</p>
<p>fine. We can then apply the Law of Total Probability and get
</p>
<p>P(B)
(6.9)
= P(B|A1)P(A1)+ P(B|A2)P(A2)
</p>
<p>= 0.6 &middot; 0.95 + 0.4 &middot; 0.75 = 0.87.
</p>
<p>We may also be interested in the probability that the movie was rented from store 1
</p>
<p>and is working which is
</p>
<p>P(B &cap; A1)
(6.8)
= P(B|A1)P(A1) = 0.95 &middot; 0.6 = 0.57.
</p>
<p>Now suppose we have a properly working DVD. What is the probability that it is
</p>
<p>rented from store 1? This is obtained as follows:
</p>
<p>P(A1|B)
(6.7)
=
</p>
<p>P(A1 &cap; B)
</p>
<p>P(B)
=
</p>
<p>0.57
</p>
<p>0.87
= 0.6552.
</p>
<p>Now assume we have a DVD which does not work, i.e. B̄ occurs. The probability
</p>
<p>that a DVD is not working given that it is from store 1 is P(B̄|A1) = 0.05. Similarly,</p>
<p/>
</div>
<div class="page"><p/>
<p>6.4 Conditional Probability 121
</p>
<p>P(B̄|A2) = 0.25 for store 2. We can now calculate the conditional probability that
</p>
<p>a DVD is from store 1 given that it is not working:
</p>
<p>P(A1|B̄)
(6.11)
=
</p>
<p>P(B̄|A1)P(A1)
</p>
<p>P(B̄|A1)P(A1)+ P(B̄|A2)P(A2)
</p>
<p>=
0.05 &middot; 0.6
</p>
<p>0.05 &middot; 0.6 + 0.25 &middot; 0.4
= 0.2308.
</p>
<p>The result about P(B̄) used in the denominator can also be directly obtained by using
</p>
<p>P(B̄) = 1 &minus; 0.87 = 0.13.
</p>
<p>6.5 Independence
</p>
<p>Intuitively, two events are independent if the occurrence or non-occurrence of one
</p>
<p>event does not affect the occurrence or non-occurrence of the other event. In other
</p>
<p>words, two events A and B are independent if the probability of occurrence of B has
</p>
<p>no effect on the probability of occurrence of A. In such a situation, one expects that
</p>
<p>P(A|B) = P(A) and P(A|B̄) = P(A) .
</p>
<p>Using this and (6.7), we can write
</p>
<p>P(A|B) =
P(A &cap; B)
</p>
<p>P(B)
</p>
<p>=
P(A &cap; B̄)
</p>
<p>P(B̄)
= P(A|B̄). (6.12)
</p>
<p>This yields:
</p>
<p>P(A &cap; B)P(B̄) = P(A &cap; B̄)P(B)
</p>
<p>P(A &cap; B)(1 &minus; P(B)) = P(A &cap; B̄)P(B)
</p>
<p>P(A &cap; B) = (P(A &cap; B̄)+ P(A &cap; B))P(B)
</p>
<p>P(A &cap; B) = P(A)P(B) . (6.13)
</p>
<p>This leads to the following definition of stochastic independence.
</p>
<p>Definition 6.5.1 Two random events A and B are called (stochastically) indepen-
</p>
<p>dent if
</p>
<p>P(A &cap; B) = P(A)P(B) , (6.14)
</p>
<p>i.e. if the probability of simultaneous occurrence of both events A and B is the
</p>
<p>product of the individual probabilities of occurrence of A and B.</p>
<p/>
</div>
<div class="page"><p/>
<p>122 6 Elements of Probability Theory
</p>
<p>This definition of independence can be extended to the case of more than two
</p>
<p>events as follows:
</p>
<p>Definition 6.5.2 The n events A1, A2, . . . , An are stochastically mutually indepen-
</p>
<p>dent, if for any subset of m events Ai1 , Ai2 , . . . , Aim (m &le; n)
</p>
<p>P(Ai1 &cap; Ai2 &middot; &middot; &middot; &cap; Aim ) = P(Ai1)P(Ai2) &middot; . . . &middot; P(Aim ) (6.15)
</p>
<p>holds.
</p>
<p>A weaker form of independence is pairwise independence. If condition (6.15) is
</p>
<p>fulfilled only for two arbitrary events, i.e. m = 2, then the events are called pairwise
</p>
<p>independent. The difference between pairwise independence and general stochastic
</p>
<p>independence is explained in the following example.
</p>
<p>Example 6.5.1 Consider an urn with four balls. The following combinations of ze-
</p>
<p>roes and ones are printed on the balls: 110, 101, 011, 000. One ball is drawn from
</p>
<p>the urn. Define the following events:
</p>
<p>A1 : The first digit on the ball is 1.
</p>
<p>A2 : The second digit on the ball is 1.
</p>
<p>A3 : The third digit on the ball is 1.
</p>
<p>Since there are two favourable simple events for each of the events A1, A2 and A3,
</p>
<p>we get
</p>
<p>P(A1) = P(A2) = P(A3) =
2
</p>
<p>4
=
</p>
<p>1
</p>
<p>2
.
</p>
<p>The probability that all the three events simultaneously occur is zero because there
</p>
<p>is no ball with 111 printed on it. Therefore, A1, A2, and A3 are not stochastically
</p>
<p>independent because
</p>
<p>P(A1)P(A2)P(A3) =
1
</p>
<p>8
�= 0 = P(A1 &cap; A2 &cap; A3).
</p>
<p>However,
</p>
<p>P(A1 &cap; A2) =
1
</p>
<p>4
= P(A1)P(A2) ,
</p>
<p>P(A1 &cap; A3) =
1
</p>
<p>4
= P(A1)P(A3) ,
</p>
<p>P(A2 &cap; A3) =
1
</p>
<p>4
= P(A2)P(A3) ,
</p>
<p>which means that the three events are pairwise independent.</p>
<p/>
</div>
<div class="page"><p/>
<p>6.6 Key Points and Further Issues 123
</p>
<p>6.6 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� We summarize some important theorems and laws:
</p>
<p>&bull; The Laplace probability is the ratio
</p>
<p>P(A) =
|A|
</p>
<p>|Ω|
=
</p>
<p>Number of &ldquo;favourable simple events&rdquo; for A
</p>
<p>Total number of possible simple events
.
</p>
<p>&bull; The Law of Total Probability is
</p>
<p>P(B) =
</p>
<p>m&sum;
</p>
<p>i=1
</p>
<p>P(B|Ai )P(Ai ).
</p>
<p>&bull; Bayes&rsquo; Theorem is
</p>
<p>P(A j |B) =
P(B|A j )P(A j )&sum;
i P(B|Ai )P(Ai )
</p>
<p>.
</p>
<p>&bull; n events A1, A2, . . . , An are (stochastically) independent, if
</p>
<p>P(A1 &cap; A2 &middot; &middot; &middot; &cap; An) = P(A1)P(A2) &middot; . . . &middot; P(An).
</p>
<p>� In Sect. 10.8, we present the χ2-independence test, which can test
</p>
<p>whether discrete random variables (see Chap. 7) are independent or not.
</p>
<p>6.7 Exercises
</p>
<p>Exercise 6.1
</p>
<p>(a) SupposeΩ = {0, 1, . . . , 15}, A = {0, 8}, B = {1, 2, 3, 5, 8, 10, 12}, C = {0, 4,
</p>
<p>9, 15}. Determine A &cap; B, B &cap; C , A &cup; C , C \ A, Ω \ (B &cup; A &cup; C).
</p>
<p>(b) Now consider the three pairwise disjoint events E , F , G with Ω = E &cup;
</p>
<p>F &cup; G and P(E) = 0.2 and P(F) = 0.5. Calculate P(F̄), P(G), P(E &cap; G),
</p>
<p>P(E \ E), and P(E &cup; F).
</p>
<p>Exercise 6.2 A driving licence examination consists of two parts which are based on
</p>
<p>a theoretical and a practical examination. Suppose 25 % of people fail the practical
</p>
<p>examination, 15 % of people fail the theoretical examination, and 10 % of people fail
</p>
<p>both the examinations. If a person is randomly chosen, then what is the probability
</p>
<p>that this person</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>124 6 Elements of Probability Theory
</p>
<p>(a) fails at least one of the examinations?
</p>
<p>(b) only fails the practical examination, but not the theoretical examination?
</p>
<p>(c) successfully passes both the tests?
</p>
<p>(d) fails any of the two examinations?
</p>
<p>Exercise 6.3 A new board game uses a twelve-sided die. Suppose the die is rolled
</p>
<p>once, what is the probability of getting
</p>
<p>(a) an even number?
</p>
<p>(b) a number greater than 9?
</p>
<p>(c) an even number greater than 9?
</p>
<p>(d) an even number or a number greater than 9?
</p>
<p>Exercise 6.4 The Smiths are a family of six. They are celebrating Christmas and
</p>
<p>there are 12 gifts, two for each family member. The name tags for each family
</p>
<p>member have been attached to the gifts. Unfortunately the name tags on the gifts are
</p>
<p>damaged by water. Suppose each family member draws two gifts at random. What
</p>
<p>is the probability that someone
</p>
<p>(a) gets his/her two gifts, rather than getting the gifts for another family member?
</p>
<p>(b) gets none of his/her gifts, but rather gets the gifts for other family members?
</p>
<p>Exercise 6.5 A chef from a popular TV cookery show sometimes puts too much salt
</p>
<p>in his pumpkin soup and the probability of this happening is 0.2. If he is in love
</p>
<p>(which he is with probability 0.3), then the probability of using too much salt is 0.6.
</p>
<p>(a) Create a contingency table for the probabilities of the two variables &ldquo;in love&rdquo;
</p>
<p>and &ldquo;too much salt&rdquo;.
</p>
<p>(b) Determine whether the two variables are stochastically independent or not.
</p>
<p>Exercise 6.6 Dr. Obermeier asks his neighbour to take care of his basil plant while
</p>
<p>he is away on leave. He assumes that his neighbour does not take care of the basil
</p>
<p>with a probability of 1
3
. The basil dies with probability 1
</p>
<p>2
when someone takes care
</p>
<p>of it and with probability 3
4
</p>
<p>if no one takes care of it.
</p>
<p>(a) Calculate the probability of the basil plant surviving after its owner&rsquo;s leave.
</p>
<p>(b) It turns out that the basil eventually dies. What is the probability that
</p>
<p>Dr. Obermeier&rsquo;s neighbour did not take care of the plant?
</p>
<p>Exercise 6.7 A bank considers changing its credit card policy. Currently 5 % of credit
</p>
<p>card owners are not able to pay their bills in any month, i.e. they never pay their bills.
</p>
<p>Among those who are generally able to pay their bills, there is still a 20 % probability
</p>
<p>that the bill is paid too late in a particular month.</p>
<p/>
</div>
<div class="page"><p/>
<p>6.7 Exercises 125
</p>
<p>(a) What is the probability that someone is not paying his bill in a particular month?
</p>
<p>(b) A credit card owner did not pay his bill in a particular month. What is the
</p>
<p>probability that he never pays back the money?
</p>
<p>(c) Should the bank consider blocking the credit card if a customer does not pay his
</p>
<p>bill on time?
</p>
<p>Exercise 6.8 There are epidemics which affect animals such as cows, pigs, and oth-
</p>
<p>ers. Suppose 200 cows are tested to see whether they are infected with a virus or not.
</p>
<p>Let event A describe whether a cow has been transported by a truck recently or not
</p>
<p>and let B denote the event that a cow has been tested positive with a virus. The data
</p>
<p>are summarized in the following table:
</p>
<p>B B̄ Total
</p>
<p>A 40 60 100
</p>
<p>Ā 20 80 100
</p>
<p>Total 60 140 200
</p>
<p>(a) What is the probability that a cow is infected and has been transported by a truck
</p>
<p>recently?
</p>
<p>(b) What is the probability of having an infected cow given that it has been trans-
</p>
<p>ported by the truck?
</p>
<p>(c) Determine and interpret P(B).
</p>
<p>Exercise 6.9 A football practice target is a portable wall with two holes (which are
</p>
<p>the target) in it for training shots. Suppose there are two players A and B. The
</p>
<p>probabilities of hitting the target by A and B are 0.4 and 0.5, respectively.
</p>
<p>(a) What is the probability that at least one of the players succeeds with his shot?
</p>
<p>(b) What is the probability that exactly one of the players hits the target?
</p>
<p>(c) What is the probability that only B scores?
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 361
</p>
<p>&lowast;Source Toutenburg, H., Heumann, C., Induktive Statistik, 4th edition, 2007,
</p>
<p>Springer, Heidelberg</p>
<p/>
</div>
<div class="page"><p/>
<p>7RandomVariables
</p>
<p>In the first part of the book we highlighted how to describe data. Now, we discuss
</p>
<p>the concepts required to draw statistical conclusions from a sample of data about a
</p>
<p>population of interest. For example, suppose we know the starting salary of a sample
</p>
<p>of 100 students graduating in law. We can use this knowledge to draw conclusions
</p>
<p>about the expected salary for the population of all students graduating in law. Simi-
</p>
<p>larly, if a newly developed drug is given to a sample of selected tuberculosis patients,
</p>
<p>then some patients may show improvement and some patients may not, but we are
</p>
<p>interested in the consequences for the entire population of patients. In the remainder
</p>
<p>of this chapter, we describe the theoretical concepts required for making such con-
</p>
<p>clusions. They form the basis for statistical tests and inference which are introduced
</p>
<p>in Chaps. 9&ndash;11.
</p>
<p>7.1 RandomVariables
</p>
<p>Random variables help us to view the collected data as an outcome of a random
</p>
<p>experiment. Consider the simple experiment of tossing a coin. If a coin is tossed,
</p>
<p>then one can observe either &ldquo;head&rdquo; (H ) or &ldquo;tail&rdquo; (T ). The occurrence of &ldquo;head&rdquo; or
</p>
<p>&ldquo;tail&rdquo; is random, and the exact outcome will only be known after the coin is tossed.
</p>
<p>We can toss the coin many times and obtain a sequence of outputs. For example, if
</p>
<p>a coin is tossed seven times, then one of the outcomes may be H, H, T, H, T, T, T .
</p>
<p>This outcome is the consequence of a random experiment, and it may be helpful if
</p>
<p>we can distill the sequence of outcomes in meaningful numbers. One option is to
</p>
<p>summarize them by a variable X , which takes the values x1 = 1 (denoting head)
and x2 = 0 (denoting tail). We have learnt from Chap. 6 that this can be described
in the framework of a random experiment where Ω = {ω1,ω2} with the events
A1 = {ω1} = 1 = head and A2 = {ω2} = 0 = tail. The random variable X is
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_7
</p>
<p>127</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_6">http://dx.doi.org/10.1007/978-3-319-46162-5_6</a></div>
</div>
<div class="page"><p/>
<p>128 7 Random Variables
</p>
<p>Table 7.1 Examples of random variables
</p>
<p>X Event Realizations of X
</p>
<p>Roll of a die Ai : number i (i = 1, 2, . . . , 6) x = i
Lifetime of TV Ai : survival time is i months
</p>
<p>(i = 1, 2, . . .)
x = i
</p>
<p>Roulette A1: red x1 = 1
A2: black x2 = 2
A3: green (zero) x3 = 0
</p>
<p>now mapped to real numbers, and therefore, it describes the possible outcome of
</p>
<p>any coin toss experiment. The observed outcomes H, H, T, H, T, T, T relate to a
</p>
<p>specific sample, a unique realization of this experiment. We can write X (ω1) = 1
and X (ω2) = 0 with ω1,ω2 &isin; Ω and 1, 0 &isin; R where R is the set of real numbers.
We know that in any coin tossing experiment, the probability of head being observed
</p>
<p>is P(X (ω1) = 1) = 0.5 and of tail being observed is P(X (ω2) = 0) = 0.5. We
may therefore view X as a random variable which collects the possible outcomes of
</p>
<p>a random experiment and captures the uncertainty associated with them.
</p>
<p>Definition 7.1.1 Let Ω represent the sample space of a random experiment, and let
</p>
<p>R be the set of real numbers. A random variable is a function X which assigns to
</p>
<p>each element ω &isin; Ω one and only one number X (ω) = x, x &isin; R, i.e.
X : Ω &rarr; R. (7.1)
</p>
<p>Example 7.1.1 The features of a die roll experiment, a roulette game, or the lifetime
</p>
<p>of a TV can all be described by a random variable, see Table 7.1. The events involve
</p>
<p>randomness, and if we have knowledge about the random process, we can assign
</p>
<p>probabilities P(X = xi ) to each event, e.g. when rolling a die, the probability of
getting a &ldquo;1&rdquo; is P(X = 1) = 1/6 and the probability of getting a &ldquo;2&rdquo; is P(X = 2) =
1/6.
</p>
<p>Note that it is a convention to denote random variables by capital letters (e.g. X )
</p>
<p>and their values by small letters (e.g. x). It is evident from the coin tossing experiment
</p>
<p>that we need to know P(X = x) to describe the respective random variable. We
assume in this chapter that we have this knowledge. However, Chaps. 9&ndash;11 show
</p>
<p>how a sample of data can be used to estimate unknown probabilities and other
</p>
<p>quantities given a prespecified uncertainty level. More generally, we can say that it
</p>
<p>is mandatory to know P(X &isin; A) for all possible A which are subsets of R. If we
choose A = (&minus;&infin;, x], x &isin; R, we have
</p>
<p>P(X &isin; A) = P(X &isin; (&minus;&infin;, x]) = P(&minus;&infin; &lt; X &le; x) = P(X &le; x).
This consideration gives rise to the definition of the cumulative distribution func-
</p>
<p>tion. Recall that we developed the concept of the empirical cumulative distribution
</p>
<p>function (ECDF) in Chap. 2, Sect. 2.2, but the definition there was empirical. Now,
</p>
<p>we develop it theoretically.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
</div>
<div class="page"><p/>
<p>7.2 Cumulative Distribution Function (CDF) 129
</p>
<p>7.2 Cumulative Distribution Function (CDF)
</p>
<p>Definition 7.2.1 The cumulative distribution function (CDF) of a random variable
</p>
<p>X is defined as
</p>
<p>F(x) = P(X &le; x). (7.2)
</p>
<p>As in Chap. 2, we can see that the CDF is useful in obtaining the probabilities related
</p>
<p>to the occurrence of random events. Note that the empirical cumulative distribu-
</p>
<p>tion function (ECDF, Sect. 2.2) and the cumulative distribution function are closely
</p>
<p>related and therefore have a similar definition and similar calculation rules. How-
</p>
<p>ever, in Chap. 2, we work with the cumulative distribution of observed values in a
</p>
<p>particular sample whereas in this chapter, we deal with random variables modelling
</p>
<p>the distribution of a general population.
</p>
<p>The Definition 7.2.1 implies the following properties of the cumulative distribution
</p>
<p>function:
</p>
<p>&bull; F(x) is a monotonically non-decreasing function
(if x1 &le; x2, it follows that F(x1) &le; F(x2)),
</p>
<p>&bull; limx&rarr;&minus;&infin; F(x) = 0 (the lower limit of F is 0),
&bull; limx&rarr;+&infin; F(x) = 1 (the upper limit of F is 1),
&bull; F(x) is continuous from the right, and
&bull; 0 &le; F(x) &le; 1 for all x &isin; R.
</p>
<p>Another notation for F(x) = P(X &le; x) is FX (x), but we use F(x).
</p>
<p>7.2.1 CDF of Continuous RandomVariables
</p>
<p>Before giving some examples about the meaning and interpretation of the CDF, we
</p>
<p>first need to consider some definitions and theorems.
</p>
<p>Definition 7.2.2 A random variable X is said to be continuous if there is a function
</p>
<p>f (x) such that for all x &isin; R
</p>
<p>F(x) =
&int; x
</p>
<p>&minus;&infin;
f (t)dt (7.3)
</p>
<p>holds. F(x) is the cumulative distribution function (CDF) of X , and f (x) is the
</p>
<p>probability density function (PDF) of x and d
dx
</p>
<p>F(x) = f (x) for all x that are
continuity points of f .
</p>
<p>Theorem 7.2.1 For a function f (x) to be a probability density function (PDF) of
</p>
<p>X, it needs to satisfy the following conditions:
</p>
<p>(1) f (x) &ge; 0 for all x &isin; R,
(2)
</p>
<p>&int;&infin;
&minus;&infin; f (x)dx = 1.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
</div>
<div class="page"><p/>
<p>130 7 Random Variables
</p>
<p>Theorem 7.2.2 Let X be a random variable with CDF F(x). If x1 &lt; x2, where x1
and x2 are known constants, P(x1 &le; X &le; x2) = F(x2)&minus; F(x1) =
</p>
<p>&int; x2
x1
</p>
<p>f (x)dx.
</p>
<p>Theorem 7.2.3 The probability of a continuous random variable taking a particular
</p>
<p>value x0 is zero:
</p>
<p>P(X = x0) = 0. (7.4)
</p>
<p>The proof is provided in Appendix C.2.
</p>
<p>Example 7.2.1 Consider the continuous random variable &ldquo;waiting time for the train&rdquo;.
</p>
<p>Suppose that a train arrives every 20 min. Therefore, the waiting time of a particular
</p>
<p>person is random and can be any time contained in the interval [0, 20]. We can start
</p>
<p>describing the required probability density function as
</p>
<p>f (x) =
{
</p>
<p>k for 0 &le; x &le; 20
0 otherwise
</p>
<p>where k is an unknown constant. Now, using condition (2) of Theorem 7.2.1, we
</p>
<p>have
</p>
<p>1 =
&int; 20
</p>
<p>0
</p>
<p>f (x)dx = [kx]200 = 20k
</p>
<p>which needs to be fulfilled. This yields k = 1/20 which is always greater than 0,
and therefore, condition (1) of Theorem 7.2.1 is also fulfilled. It follows that
</p>
<p>f (x) =
{
</p>
<p>1
20
</p>
<p>for 0 &le; x &le; 20
0 otherwise
</p>
<p>is the probability density function describing the waiting time for the train. We can
</p>
<p>now use Definition 7.2.2 to determine the cumulative distribution function:
</p>
<p>F(x) =
&int; x
</p>
<p>0
</p>
<p>f (t)dt =
&int; x
</p>
<p>0
</p>
<p>1
</p>
<p>20
dt =
</p>
<p>1
</p>
<p>20
[t]x0 =
</p>
<p>1
</p>
<p>20
x .
</p>
<p>Suppose we are interested in calculating the probability of a waiting time between
</p>
<p>15 and 20 min. This can be calculated using Theorem 7.2.2:
</p>
<p>P(15 &le; X &le; 20) = F(20)&minus; F(15) =
20
</p>
<p>20
&minus;
</p>
<p>15
</p>
<p>20
= 0.25.
</p>
<p>We can obtain this probability from the graph of the CDF as well, see Fig. 7.1 where
</p>
<p>both the PDF and CDF of this example are illustrated.
</p>
<p>Defining a function, for example the CDF, is simple in R: One can use the
</p>
<p>function command followed by specifying the variables the function evaluates
</p>
<p>in round brackets (e.g. x) and the function itself in braces (e.g. x/20). Functions can
</p>
<p>be plotted using the curve command:
</p>
<p>cdf &lt;- function(x){1/20 &lowast; x}
curve(cdf,from=0,to=20)</p>
<p/>
</div>
<div class="page"><p/>
<p>7.2 Cumulative Distribution Function (CDF) 131
</p>
<p>X
</p>
<p>f(
X
)
</p>
<p>&minus;5 0 5 10 15 20 25
</p>
<p>0
</p>
<p>1
</p>
<p>20
</p>
<p>2
</p>
<p>20
</p>
<p>(a) PDF
</p>
<p>X
</p>
<p>F
(X
)
</p>
<p>&minus;5 0 5 10 15 20 25
</p>
<p>0
</p>
<p>5
</p>
<p>20
</p>
<p>10
</p>
<p>20
</p>
<p>15
</p>
<p>20
</p>
<p>1
</p>
<p>F(20)&minus;F(15)
</p>
<p>(b) CDF
</p>
<p>Fig.7.1 Probability density function (PDF) and cumulative distribution function (CDF) for waiting
</p>
<p>time in Example 7.2.1
</p>
<p>Alternatively, theplot command can be used to plot vectors against each other; for
</p>
<p>example, after defining a function, we can define a sequence
</p>
<p>(x&lt;-seq(0,20,0.01)), evaluate this sequence via the specified function
</p>
<p>(cdf(x)), and plot them against each other and connect the points from the sequence
</p>
<p>with a line (plot(x,cdf(x),type=&rsquo;l&rsquo;)).
</p>
<p>This example illustrates how the cumulative distribution function can be used
</p>
<p>to obtain probabilities of interest. Most importantly, if we want to calculate the
</p>
<p>probability that the random variable X takes values in the interval [x1, x2], we simply
have to look at the difference of the respective CDF values at x1 and x2. Figure 7.2a
</p>
<p>highlights that the interval probability corresponds to the difference of the CDF
</p>
<p>values on the y-axis.
</p>
<p>We can also use the probability density function to visualize P(x1 &le; X &le; x2).
We know from Theorem 7.2.1 that
</p>
<p>&int;&infin;
&minus;&infin; f (x)dx = 1, and therefore, the area under
</p>
<p>the PDF equals 1. Thus, we can interpret interval probabilities as the area under the
</p>
<p>PDF between x1 and x2. This is presented in Fig. 7.2b.
</p>
<p>7.2.2 CDF of Discrete RandomVariables
</p>
<p>Definition 7.2.3 A random variable X is defined to be discrete if its probability
</p>
<p>space is either finite or countable, i.e. if it takes only a finite or countable number of
</p>
<p>values. Note that a set V is said to be countable, if its elements can be listed, i.e.
</p>
<p>there is a one-to-one correspondence between V and the positive integers.
</p>
<p>Example 7.2.2 Consider the example of tossing of a coin where each trial results
</p>
<p>in either a head (H ) or a tail (T ), each occurring with the same probability</p>
<p/>
</div>
<div class="page"><p/>
<p>132 7 Random Variables
</p>
<p>(a)
</p>
<p>x1 x2
</p>
<p>F (x1)
</p>
<p>F (x2)
</p>
<p>x
(b)
</p>
<p>x1 x2
</p>
<p>F (x2) &minus; F (x1)
</p>
<p>Fig. 7.2 Graphical representation of the probability P(x1 &le; X &le; x2) a via the CDF and b via the
PDF&lowast;
</p>
<p>0.5. When the coin is tossed multiple times, we may observe sequences such as
</p>
<p>H, T, H, H, T, H, H, T , and T, . . .. The sample space is Ω = {H, T }. Let the
random variable X denote the number of trials required to get the third head, then
</p>
<p>X = 4 for the given sequence above. Clearly, the space of X is the set (3, 4, 5, . . .).
We can see that X is a discrete random variable because its space is finite and can
</p>
<p>be counted. We can also assign certain probabilities to each of these values, e.g.
</p>
<p>P(X = 3) = p1 and P(X = 4) = p2.
</p>
<p>Definition 7.2.4 Let X be a discrete random variable which takes k different values.
</p>
<p>The probability mass function (PMF) of X is given by
</p>
<p>f (X) = P(X = xi ) = pi for each i = 1, 2, . . . , k. (7.5)
</p>
<p>It is required that the probabilities pi satisfy the following conditions:
</p>
<p>(1) 0 &le; pi &le; 1,
(2)
</p>
<p>&sum;k
i=1 pi = 1.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.2 Cumulative Distribution Function (CDF) 133
</p>
<p>Definition 7.2.5 Given (7.5), we can write the CDF of a discrete random variable as
</p>
<p>F(x) =
k
</p>
<p>&sum;
</p>
<p>i=1
I{xi&le;x} pi , (7.6)
</p>
<p>where I is an indicator function defined as
</p>
<p>I{xi&le;x} =
{
</p>
<p>1 if xi &le; x
0 otherwise.
</p>
<p>The CDF of a discrete variable is always a step function.
</p>
<p>Working with the CDF for Discrete Random variables
</p>
<p>We can easily calculate various types of probabilities for discrete random variables
</p>
<p>using the CDF. Let a and b be some known constants, then
</p>
<p>P(X &le; a) = F(a), (7.7)
P(X &lt; a) = P(X &le; a)&minus; P(X = a) = F(a)&minus; P(X = a), (7.8)
P(X &gt; a) = 1 &minus; P(X &le; a) = 1 &minus; F(a), (7.9)
P(X &ge; a) = 1 &minus; P(X &lt; a) = 1 &minus; F(a)+ P(X = a), (7.10)
</p>
<p>P(a &le; X &le; b) = P(X &le; b)&minus; P(X &lt; a)
= F(b)&minus; F(a)+ P(X = a), (7.11)
</p>
<p>P(a &lt; X &le; b) = F(b)&minus; F(a), (7.12)
P(a &lt; X &lt; b) = F(b)&minus; F(a)&minus; P(X = b), (7.13)
P(a &le; X &lt; b) = F(b)&minus; F(a)&minus; P(X = b)+ P(X = a). (7.14)
</p>
<p>Remark 7.2.1 The Eqs. (7.7)&ndash;(7.14) can also be used for continuous variables, but in
</p>
<p>this case, P(X = a) = P(X = b) = 0 (see Theorem 7.2.3), and therefore, Eqs. (7.7)&ndash;
(7.14) can be modified accordingly.
</p>
<p>Example 7.2.3 Consider the experiment of rolling a die. There are six possible out-
</p>
<p>comes. If we define the random variable X as the number of dots observed on
</p>
<p>the upper surface of the die, then the six possible outcomes can be described as
</p>
<p>x1 = 1, x2 = 2, . . . , x6 = 6. The respective probabilities are P(X = xi ) = 1/6; i =
1, 2, . . . , 6. The PMF and CDF are therefore defined as follows:
</p>
<p>f (x) =
</p>
<p>⎧
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎨
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎩
</p>
<p>1/6 if x = 1
1/6 if x = 2
1/6 if x = 3
1/6 if x = 4
1/6 if x = 5
1/6 if x = 6
0 elsewhere.
</p>
<p>F(x) =
</p>
<p>⎧
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎨
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎪
</p>
<p>⎩
</p>
<p>0 if &minus;&infin; &lt; x &lt; 1
1/6 if 1 &le; x &lt; 2
2/6 if 2 &le; x &lt; 3
3/6 if 3 &le; x &lt; 4
4/6 if 4 &le; x &lt; 5
5/6 if 5 &le; x &lt; 6
1 if 6 &le; x &lt; &infin;.</p>
<p/>
</div>
<div class="page"><p/>
<p>134 7 Random Variables
</p>
<p>Fig. 7.3 Probability density function and cumulative distribution function for rolling a die in
</p>
<p>Example 7.2.3. &ldquo;&bull;&rdquo; relates to an included value and &ldquo;◦&rdquo; to an excluded value
</p>
<p>Both the CDF and the PDF are displayed in Fig. 7.3.
</p>
<p>We can use the CDF to calculate any desired probability, e.g. P(X &le; 5) =
F(5) = 5/6. This is shown in Fig. 7.3b where for X = 5, we obtain F(5) = 5/6
when evaluating on the y-axis. Similarly, P(3 &lt; X &le; 5) = F(5) &minus; F(3) =
(5/6) &minus; (3/6) = 2/6 can be interpreted as the difference of F(5) and F(3) on the
y-axis.
</p>
<p>7.3 Expectation andVariance of a RandomVariable
</p>
<p>We have seen that both the probability density function (or probability mass function)
</p>
<p>and the cumulative distribution function are helpful in characterizing the features of
</p>
<p>a random variable. Some other features of random variables are characterized by the
</p>
<p>concepts of expectation and variance.
</p>
<p>7.3.1 Expectation
</p>
<p>Definition 7.3.1 The expectation of a continuous random variable X , having the
</p>
<p>probability density function f (x) with
&int;
</p>
<p>|x | f (x)dx &lt; &infin;, is defined as
</p>
<p>E(X) =
&int; +&infin;
</p>
<p>&minus;&infin;
x f (x)dx . (7.15)</p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Expectation and Variance of a Random Variable 135
</p>
<p>For a discrete random variable X , which takes the values x1, x2, . . .with respective
</p>
<p>probabilities p2, p2, . . ., the expectation of X is defined as
</p>
<p>E(X) =
k
</p>
<p>&sum;
</p>
<p>i=1
xi pi = x1 P(X = x1)+ x2 P(X = x2)+ &middot; &middot; &middot; + xk P(X = xk). (7.16)
</p>
<p>The expectation of X , i.e. E(X), is usually denoted by μ = E(X) and relates to the
arithmetic mean of the distribution of the population. It reflects the central tendency
</p>
<p>of the population.
</p>
<p>Example 7.3.1 Consider again Example 7.2.1 where the waiting time for a train was
</p>
<p>described by the following probability density function:
</p>
<p>f (x) =
{
</p>
<p>1
20
</p>
<p>for 0 &le; x &le; 20
0 otherwise.
</p>
<p>We can calculate the expectation as follows:
</p>
<p>E(X) =
&int; &infin;
</p>
<p>&minus;&infin;
x f (x) dx =
</p>
<p>&int; 0
</p>
<p>&minus;&infin;
x f (x) dx +
</p>
<p>&int; 20
</p>
<p>0
</p>
<p>x f (x) dx +
&int; &infin;
</p>
<p>20
</p>
<p>x f (x) dx
</p>
<p>= 0 +
&int; 20
</p>
<p>0
</p>
<p>1
</p>
<p>20
x dx + 0 =
</p>
<p>[
</p>
<p>1
</p>
<p>40
x2
]20
</p>
<p>0
</p>
<p>=
400
</p>
<p>40
&minus; 0 = 10.
</p>
<p>The &ldquo;average&rdquo; waiting time for the train is therefore 10 min. This means that if a
</p>
<p>person has to wait for the train every day, then the person will experience waiting
</p>
<p>times varying randomly between 0 and 20 min and, on average, has to wait for 10 min.
</p>
<p>Example 7.3.2 Consider again the die roll experiment from Example 7.2.3. The
</p>
<p>probabilities for the occurrence of any xi , i = 1, 2, . . . , 6, are P(X = xi ) = 1/6.
The expectation can thus be calculated as
</p>
<p>E(X) =
6
</p>
<p>&sum;
</p>
<p>i=1
xi pi
</p>
<p>= 1 &middot; P(X = 1)+ 2 &middot; P(X = 2)+ 3 &middot; P(X = 3)+ 4 &middot; P(X = 4)
+ 5 &middot; P(X = 5)+ 6 &middot; P(X = 6)
</p>
<p>= (1 + 2 + 3 + 4 + 5 + 6)
1
</p>
<p>6
=
</p>
<p>21
</p>
<p>6
= 3.5.
</p>
<p>7.3.2 Variance
</p>
<p>The variance describes the variability of a random variable. It gives an idea about the
</p>
<p>concentration or dispersion of values around the arithmetic mean of the distribution.</p>
<p/>
</div>
<div class="page"><p/>
<p>136 7 Random Variables
</p>
<p>Definition 7.3.2 The variance of a random variable X is defined as
</p>
<p>Var(X) = E[X &minus; E(X)]2. (7.17)
The variance of a continuous random variable X is
</p>
<p>Var(X) =
&int; +&infin;
</p>
<p>&minus;&infin;
(x &minus; E(X))2 f (x)dx (7.18)
</p>
<p>where E(X) =
&int; +&infin;
&minus;&infin; x f (x)dx . Similarly, the variance of a discrete random variable
</p>
<p>X is
</p>
<p>Var(X) =
&sum;
</p>
<p>i=1
(xi &minus; E(X))2 pi (7.19)
</p>
<p>where E(X) =
&sum;
</p>
<p>i xi pi . The variance is usually denoted by σ
2 = Var(X).
</p>
<p>Definition 7.3.3 The positive square root of the variance is called the standard
</p>
<p>deviation.
</p>
<p>Example 7.3.3 Recall Examples 7.2.1 and 7.3.1. We can calculate the variance of
</p>
<p>the waiting time for a train using the probability density function
</p>
<p>f (x) =
{
</p>
<p>1
20
</p>
<p>for 0 &le; x &le; 20
0 otherwise
</p>
<p>and E(X) = 10 (already calculated in Example 7.3.1). Using (7.18), we obtain:
</p>
<p>Var(X) =
&int; &infin;
</p>
<p>&minus;&infin;
(x &minus; E(x))2 f (x) dx =
</p>
<p>&int; &infin;
</p>
<p>&minus;&infin;
(x &minus; 10)2 f (x) dx
</p>
<p>=
&int; 0
</p>
<p>&minus;&infin;
(x &minus; 10)2 f (x) dx +
</p>
<p>&int; 20
</p>
<p>0
</p>
<p>(x &minus; 10)2 f (x) dx +
&int; &infin;
</p>
<p>20
</p>
<p>(x &minus; 10)2 f (x) dx
</p>
<p>= 0 +
&int; 20
</p>
<p>0
</p>
<p>(x &minus; 10)2 &middot;
1
</p>
<p>20
dx + 0 =
</p>
<p>&int; 20
</p>
<p>0
</p>
<p>1
</p>
<p>20
(x2 &minus; 20x + 100) dx
</p>
<p>=
[
</p>
<p>1
</p>
<p>20
</p>
<p>(
</p>
<p>1
</p>
<p>3
x3 &minus; 10x2 + 100x
</p>
<p>)]20
</p>
<p>0
</p>
<p>= 33
1
</p>
<p>3
.
</p>
<p>The standard deviation is
</p>
<p>&radic;
</p>
<p>33 1
3
</p>
<p>min2 &asymp; 5.77 min.
</p>
<p>Recall that in Chap. 3, we introduced the sample variance and the sample stan-
</p>
<p>dard deviation. We already know that the standard deviation has the same unit of
</p>
<p>measurement as the variable, whereas the unit of the variance is the square of the
</p>
<p>measurement unit. The standard deviation measures how the values of a random vari-
</p>
<p>able are dispersed around the population mean. A low value of the standard deviation
</p>
<p>indicates that the values are highly concentrated around the mean. A high value of
</p>
<p>the standard deviation indicates lower concentration of the data values around the
</p>
<p>mean, and the observed values may be far away from the mean. These considerations
</p>
<p>are helpful in making connections between random variables and samples of data,
</p>
<p>see Chap. 9 for the construction of confidence intervals.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>7.3 Expectation and Variance of a Random Variable 137
</p>
<p>Example 7.3.4 Recall Example 7.3.2 where we calculated the expectation of a die
</p>
<p>roll experiment as E(X) = 3.5. With xi &isin; {1, 2, 3, 4, 5, 6} and pi = 1/6 for all i =
1, 2, 3, 4, 5, 6, the variance for this example corresponds to
</p>
<p>Var(X) =
&sum;
</p>
<p>i=1
(xi &minus; E(X))2 pi = (1 &minus; 3.5)2 &middot;
</p>
<p>1
</p>
<p>6
+ (2 &minus; 3.5)2 &middot;
</p>
<p>1
</p>
<p>6
+ (3 &minus; 3.5)2 &middot;
</p>
<p>1
</p>
<p>6
</p>
<p>+(4 &minus; 3.5)2 &middot;
1
</p>
<p>6
+ (5 &minus; 3.5)2 &middot;
</p>
<p>1
</p>
<p>6
+ (6 &minus; 3.5)2 &middot;
</p>
<p>1
</p>
<p>6
&asymp; 2.92.
</p>
<p>Theorem 7.3.1 The variance of a random variable X can be expressed as
</p>
<p>Var(X) = E(X2)&minus; [E(X)]2. (7.20)
</p>
<p>The proof is given in Appendix C.2.
</p>
<p>Example 7.3.5 In Examples 7.2.1, 7.3.1, and 7.3.3, we evaluated the waiting time
</p>
<p>for a train using the PDF
</p>
<p>f (X) =
{
</p>
<p>1
20
</p>
<p>for 0 &lt; X &le; 20
0 otherwise.
</p>
<p>We calculated the expectation and variance in Eqs. (7.15) and (7.17) as 10 min and
</p>
<p>33 1
3
</p>
<p>min2, respectively. Theorem 7.3.1 tells us that we can calculate the variance in
</p>
<p>a different way as follows:
</p>
<p>E(X2) =
&int; &infin;
</p>
<p>&minus;&infin;
x2 f (x) dx =
</p>
<p>&int; 20
</p>
<p>0
</p>
<p>1
</p>
<p>20
x2 dx
</p>
<p>=
[
</p>
<p>1
</p>
<p>60
x3
]20
</p>
<p>0
</p>
<p>= 133
1
</p>
<p>3
</p>
<p>Var(X) = E(X2)&minus; [E(X)]2 = 133
1
</p>
<p>3
&minus; 102 = 33
</p>
<p>1
</p>
<p>3
.
</p>
<p>This yields the same result as Eq. (7.18) but is much quicker.
</p>
<p>7.3.3 Quantiles of a Distribution
</p>
<p>We introduced the concept of quantiles in Chap. 3, Sect. 3.1.2. Now, we define
</p>
<p>quantiles in terms of the distribution function.
</p>
<p>Definition 7.3.4 The value x p for which the cumulative distribution function is
</p>
<p>F(x p) = p (0 &lt; p &lt; 1) (7.21)
</p>
<p>is called the p-quantile.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>138 7 Random Variables
</p>
<p>Fig. 7.4 First quartile,
</p>
<p>median, and third quartile&lowast;
</p>
<p>x0.25 x0.5 x0.75
</p>
<p>0.25
</p>
<p>0.5
</p>
<p>0.75
</p>
<p>x
</p>
<p>It follows from Definition 7.3.4 that x p is the value which divides the cumulative
</p>
<p>distribution function into two parts: the probability of observing a value left of x p is
</p>
<p>p, whereas the probability of observing a value right of x p is 1&minus; p. For example, the
0.25-quantile x0.25 describes the x-value for which the probability of observing x0.25
or any smaller value is 0.25. Figure 7.4 shows the 0.25-quantile (first quartile), the 0.5-
</p>
<p>quantile (median), and the 0.75-quantile (third quartile) in a cumulative distribution
</p>
<p>function.
</p>
<p>Example 7.3.6 Recall Examples 7.2.1, 7.3.1, 7.3.5 and Fig. 7.1b where we described
</p>
<p>the waiting time for a train by using the following CDF:
</p>
<p>F(x) =
1
</p>
<p>20
x .
</p>
<p>The first quartile x0.25 is 5 because F(5) = 5/20 = 0.25. This means that the
probability of waiting for the train for 5 min or less is 25 % and of waiting for longer
</p>
<p>than 5 min is 75 %.
</p>
<p>For continuous variables, there is a unique value which describes the p-quantile.
</p>
<p>However, for discrete variables, this may not necessarily be true. In this case, the
</p>
<p>p-quantile is chosen such that
</p>
<p>F(x p) &ge; p,
F(x) &lt; p for x &lt; x p
</p>
<p>holds.
</p>
<p>Example 7.3.7 The cumulative distribution function for rolling a die is described in
</p>
<p>Example 7.2.3 and Fig. 7.3b. The first quartile x0.25 is 2 because F(2) = 2/6 &gt; 0.25
and F(x) &lt; 0.25 for x &lt; 2.
</p>
<p>7.3.4 Standardization
</p>
<p>Standardization transforms a random variable in such a way that it has an expectation
</p>
<p>of zero and a variance of one. More details on the need for standardization are
</p>
<p>discussed in Chap. 10.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>7.4 Tschebyschev&rsquo;s Inequality 139
</p>
<p>Definition 7.3.5 A random variable Y is called standardized when
</p>
<p>E(Y ) = 0 and Var(Y ) = 1.
</p>
<p>Theorem 7.3.2 Suppose a random variable X has mean E(X) = μ and Var(X) =
σ
</p>
<p>2. Then, it can be standardized as follows:
</p>
<p>Y =
X &minus; μ
σ
</p>
<p>=
X &minus; E(X)
&radic;
</p>
<p>Var(X)
. (7.22)
</p>
<p>Example 7.3.8 In Examples 7.2.1, 7.3.1, and 7.3.5, we considered the waiting time
</p>
<p>X for a train. The random variable X can take values between 0 and 20 min, and we
</p>
<p>calculated E(X) = 10 and Var(X) = 33 1
3
. The standardized variable of X is
</p>
<p>Y =
X &minus; μ
σ
</p>
<p>=
X &minus; 10
&radic;
</p>
<p>33 1
3
</p>
<p>.
</p>
<p>One can show that E(Y ) = 0 and Var(Y ) = 1, see also Exercise 7.10 for more
details.
</p>
<p>7.4 Tschebyschev&rsquo;s Inequality
</p>
<p>If we do not know the distribution of a random variable X , we can still make state-
</p>
<p>ments about the probability that X takes values in a certain interval (which has to
</p>
<p>be symmetric around the expectation μ) if the mean μ and the variance σ2 of X are
</p>
<p>known.
</p>
<p>Theorem 7.4.1 (Tschebyschev&rsquo;s inequality) Let X be a random variable with
</p>
<p>E(X) = μ and Var(X) = σ2. It holds that
</p>
<p>P(|X &minus; μ| &ge; c) &le;
Var(X)
</p>
<p>c2
. (7.23)
</p>
<p>This is equivalent to
</p>
<p>P(|X &minus; μ| &lt; c) &ge; 1 &minus;
Var(X)
</p>
<p>c2
. (7.24)
</p>
<p>The proof is given in Appendix C.2.
</p>
<p>Example 7.4.1 In Examples 7.2.1, 7.3.1, and 7.3.5, we have worked with a random
</p>
<p>variable which describes the waiting time for a train. We determined E(X) = 10 and
Var(X) = 33 1
</p>
<p>3
. We can calculate the probability of waiting between 10&minus; 7 = 3 and
</p>
<p>10 + 7 = 17 min:
</p>
<p>P(|X &minus; μ| &lt; c) &ge; 1 &minus;
Var(X)
</p>
<p>c2
</p>
<p>P(|X &minus; 10| &lt; 7) &ge; 1 &minus;
33 1
</p>
<p>3
</p>
<p>72
&asymp; 0.32.</p>
<p/>
</div>
<div class="page"><p/>
<p>140 7 Random Variables
</p>
<p>The probability is therefore at least 0.32. However, if we apply our distributional
</p>
<p>knowledge that F(x) = 1
20
</p>
<p>x (for 0 &le; X &le; 20), then we obtain a much more precise
result which is
</p>
<p>P(3 &lt; X &lt; 17) = F(17)&minus; F(3) =
17
</p>
<p>20
&minus;
</p>
<p>3
</p>
<p>20
= 0.7.
</p>
<p>We can clearly see that Tschebyschev&rsquo;s inequality gives us the correct answer, that
</p>
<p>is P(3 &lt; X &lt; 17) is greater 0.32. Nevertheless, the approximation to the exact
</p>
<p>probability, 0.7, is rather poor. One needs to keep in mind that only the lack of
</p>
<p>distributional knowledge makes the inequality useful.
</p>
<p>7.5 Bivariate RandomVariables
</p>
<p>There are many situations in which we are interested in analysing more than one
</p>
<p>variable, say two variables. When we have more than one variable, then not only
</p>
<p>their individual distributions but also their joint distribution can be of interest. For
</p>
<p>example, we know that driving a car after drinking alcohol is not necessarily safe. If
</p>
<p>we consider two variables, the blood alcohol content X and number of car accidents
</p>
<p>Y , then we may be interested in the probability of having a high blood alcohol
</p>
<p>content and a car accident at the same time. If we analyse (X, Y ) jointly, then we are
</p>
<p>interested in their joint bivariate distribution fXY (x, y). This distribution can either
</p>
<p>be discrete or continuous.
</p>
<p>Discrete Bivariate Random Variables. Suppose we have two categorical variables
</p>
<p>X and Y which can take the values x1, x2, . . . , x I and y1, y2, . . . , yJ , respectively.
</p>
<p>Their joint probability distribution function is characterized by
</p>
<p>P(X = xi , Y = y j ) = pi j (i = 1, 2, . . . , I ; j = 1, 2, . . . , J )
</p>
<p>with
&sum;I
</p>
<p>i=1
&sum;J
</p>
<p>j=1 pi j = 1. This means that the probability of observing xi and y j
together is pi j . We can summarize this information in a contingency table as follows:
</p>
<p>Y
</p>
<p>1 2 . . . J Total
</p>
<p>1 p11 p12 &hellip; p1J p1+
2 p21 p22 &hellip; p2J p2+
</p>
<p>X
.
.
.
</p>
<p>.
</p>
<p>.
</p>
<p>.
.
.
.
</p>
<p>I pI 1 pI 2 . . . pI J pI+
Total p+1 p+2 . . . p+J 1
</p>
<p>Each cell contains a &ldquo;piece&rdquo; of the joint distribution. The entries p+1, p+2, . . . ,
p+J in the bottom row of the table summarize the marginal distribution of Y , which
is the distribution of Y without giving reference to X . The entries p1+, p+2, . . . , pI+</p>
<p/>
</div>
<div class="page"><p/>
<p>7.5 Bivariate Random Variables 141
</p>
<p>in the last column summarize the marginal distribution of X . The marginal distribu-
</p>
<p>tions can therefore be expressed as
</p>
<p>P(X = xi ) =
J
</p>
<p>&sum;
</p>
<p>j=1
pi j = pi+ i = 1, 2, . . . , I,
</p>
<p>P(Y = y j ) =
I
</p>
<p>&sum;
</p>
<p>i=1
pi j = p+ j j = 1, 2, . . . , J .
</p>
<p>The conditional distributions of X given Y = y j and Y given X = x j are given
as follows:
</p>
<p>P(X = xi |Y = y j ) = pi | j =
pi j
</p>
<p>p+ j
i = 1, 2, . . . , I,
</p>
<p>P(Y = y j |X = xi ) = p j |i =
pi j
</p>
<p>pi+
j = 1, 2, . . . , J.
</p>
<p>They summarize the distribution of X for a given value of y j (or the distribution of Y
</p>
<p>for a given value of xi ) and play a crucial role in the construction of regression models
</p>
<p>such as the linear regression model introduced in Chap. 11. Please also recall the
</p>
<p>definitions of Sect. 4.1 where we introduced conditional and marginal distributions
</p>
<p>for data samples rather than random variables.
</p>
<p>Example 7.5.1 Suppose we have a contingency table on smoking behaviour X
</p>
<p>(1 = never smoking, 2 = smoking sometimes, and 3 = smoking regularly)
and education level Y (1 = primary education, 2 = Secondary education, and
3 = tertiary education):
</p>
<p>Y
</p>
<p>1 2 3 Total
</p>
<p>X 1 0.10 0.20 0.30 0.60
</p>
<p>2 0.10 0.10 0.10 0.30
</p>
<p>3 0.08 0.01 0.01 0.10
</p>
<p>Total 0.28 0.31 0.41 1
</p>
<p>The cell entries represent the joint distribution of smoking behaviour and education
</p>
<p>level. We can interpret each entry as the probability of observing X = xi and
Y = y j simultaneously. For example, p23 = P (&ldquo;smoking sometimes and tertiary
education&rdquo;) = 0.10. The marginal distribution of X is contained in the last column
of the table and lists the probabilities of smoking (unconditional on education level),
</p>
<p>e.g. the probability of being a non-smoker in this population is 60 %. We can also
</p>
<p>interpret the conditional distributions: P(X |Y = 3) represents the distribution of
smoking behaviour among those who have tertiary education. If we are interested
</p>
<p>in the probability of smoking sometimes given tertiary education is completed, then
</p>
<p>we calculate P(X = 2|Y = 3) = p2|3 = 0.100.41 = 0.24.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>142 7 Random Variables
</p>
<p>x1 x2
</p>
<p>y1
</p>
<p>y2
</p>
<p>Fig. 7.5 Area covering all points of (X, Y ) with (x1 &le; X &le; x2, y1 &le; Y &le; y2)&lowast;
</p>
<p>Continuous Bivariate Random Variables.
</p>
<p>Definition 7.5.1 A bivariate random variable (X, Y ) is continuous if there is a func-
</p>
<p>tion fXY (x, y) such that
</p>
<p>FXY (x, y) = P(X &le; x, Y &le; y) =
&int; y
</p>
<p>&minus;&infin;
</p>
<p>&int; x
</p>
<p>&minus;&infin;
fXY (x, y) dx dy (7.25)
</p>
<p>holds.
</p>
<p>The function FXY (x, y) is the joint cumulative distribution function of X and
</p>
<p>Y ; the joint distribution function is denoted by fXY (x, y), and fXY (x, y) has to fulfil
</p>
<p>the usual conditions of a density function. Necessary and sufficient conditions that
</p>
<p>a function FXY (x, y) is a bivariate cumulative distribution function are as follows:
</p>
<p>lim
x&rarr;&minus;&infin;
</p>
<p>FXY (x, y) = 0 lim
y&rarr;&minus;&infin;
</p>
<p>FXY (x, y) = 0
</p>
<p>lim
x&rarr;&infin;
</p>
<p>FXY (x, y) = 1 lim
y&rarr;&infin;
</p>
<p>FXY (x, y) = 1
</p>
<p>and F(x2, y2)&minus; F(x1, y2)&minus; F(x2, y1)+ F(x1, y1) &ge; 0 for all x1 &lt; x2, y1 &lt; y2.
</p>
<p>The last condition is sometimes referred to as the rectangle inequality. As in
</p>
<p>the univariate case, we can use the cumulative distribution function to calcu-
</p>
<p>late interval probabilities; similarly, we look at the rectangular area defined by
</p>
<p>(x1, y1), (x1, y2), (x2, y1), and (x2, y2) in the bivariate case (instead of an interval
</p>
<p>[a, b]), see Fig. 7.5.
We can calculate the desired probabilities as follows:
</p>
<p>P(x1 &le; X &le; x2, y1 &le; Y &le; y2) =
&int; y2
</p>
<p>y1
</p>
<p>&int; x2
</p>
<p>x1
</p>
<p>fXY (x, y) dx dy.
</p>
<p>The marginal distributions of X and Y are
</p>
<p>fX (x) =
&int; &infin;
</p>
<p>&minus;&infin;
fXY (x, y)dy, fY (y) =
</p>
<p>&int; &infin;
</p>
<p>&minus;&infin;
fXY (x, y)dx,</p>
<p/>
</div>
<div class="page"><p/>
<p>7.5 Bivariate Random Variables 143
</p>
<p>Fig. 7.6 Joint and marginal distribution for Example 7.5.2
</p>
<p>respectively. Similar to the discrete case, fX (x) and fY (y) also describe the distri-
</p>
<p>bution of X unconditional on Y and the distribution of Y unconditional on X . The
</p>
<p>cumulative marginal distributions are
</p>
<p>FX (x) =
&int; x
</p>
<p>&minus;&infin;
fX (t)dt, FY (y) =
</p>
<p>&int; y
</p>
<p>&minus;&infin;
fY (t)dt.
</p>
<p>The conditional distributions can be obtained by the ratio of the joint and marginal
</p>
<p>distributions:
</p>
<p>fX |Y (x, y) =
f (x, y)
</p>
<p>f (y)
, fY |X (x, y) =
</p>
<p>f (x, y)
</p>
<p>f (x)
.
</p>
<p>Example 7.5.2 Consider the function
</p>
<p>fXY (x, y) =
{
</p>
<p>x + y for 0 &le; x &le; 1, 0 &le; y &le; 1
0 elsewhere.
</p>
<p>Suppose X and Y represent the concentrations of two drugs in the human body.
</p>
<p>Then, fXY (x, y) may represent the sum of two drug concentrations in the human
</p>
<p>body. Since there are infinite possible realizations of both X and Y , we represent
</p>
<p>their joint distribution in a figure rather than a table, see Fig. 7.6a.
</p>
<p>The marginal distributions for X and Y can be calculated as follows:
</p>
<p>fX (x) =
&int; &infin;
</p>
<p>&minus;&infin;
fXY (x, y)dy =
</p>
<p>&int; 1
</p>
<p>0
</p>
<p>(x + y) dy =
[
</p>
<p>xy +
1
</p>
<p>2
y2
]1
</p>
<p>0
</p>
<p>= x +
1
</p>
<p>2
,
</p>
<p>fY (x) =
&int; &infin;
</p>
<p>&minus;&infin;
fXY (x, y)dx =
</p>
<p>&int; 1
</p>
<p>0
</p>
<p>(x + y) dx =
[
</p>
<p>1
</p>
<p>2
x2 + xy
</p>
<p>]1
</p>
<p>0
</p>
<p>= y +
1
</p>
<p>2
.
</p>
<p>Figure 7.6b depicts the marginal distribution for X . The slope of the marginal dis-
</p>
<p>tribution is essentially the slope of the surface of the joint distribution shown in
</p>
<p>Fig. 7.6a. It is easy to see in this simple example that the marginal distribution of</p>
<p/>
</div>
<div class="page"><p/>
<p>144 7 Random Variables
</p>
<p>X is nothing but a cut in the surface of the joint distribution. Note that the condi-
</p>
<p>tional distributions fX |Y (x, y) and fY |X (x, y) can be easily calculated; for example,
fX |Y (x, y) = f (x, y)/ f (y) = (x + y)/(y + 0.5).
</p>
<p>Stochastic Independence.
</p>
<p>Definition 7.5.2 Two continuous random variables X and Y are said to be stochas-
</p>
<p>tically independent if
</p>
<p>fXY (x, y) = fX (x) fY (y). (7.26)
</p>
<p>For discrete variables, this is equivalent to
</p>
<p>P(X = xi , Y = y j ) = P(X = xi )P(Y = y j ) (7.27)
</p>
<p>being valid for all (i, j).
</p>
<p>Example 7.5.3 In Example 7.5.2, we considered the function
</p>
<p>fXY (x, y) =
{
</p>
<p>x + y for 0 &le; x &le; 1, 0 &le; y &le; 1
0 elsewhere
</p>
<p>with the marginal distributions of X and Y as fX = x + 0.5 and fY = y + 0.5,
respectively. Since fX &middot; fY = (x + 12 )(y +
</p>
<p>1
2
) �= fXY , it follows that X and Y are not
</p>
<p>independent. The interpretation is that the concentrations of the two drugs are not
</p>
<p>independent.
</p>
<p>7.6 Calculation Rules for Expectation andVariance
</p>
<p>Calculation Rules for the Expectation. For any constant values a and b, and any
</p>
<p>random variables X and Y , the following rules hold:
</p>
<p>E(a) = a, (7.28)
E(bX) = bE(X), (7.29)
</p>
<p>E(a + bX) = a + bE(X), (7.30)
E(X + Y ) = E(X)+ E(Y ) (additivity). (7.31)
</p>
<p>The proof of rule (7.30) is given in Appendix C.2.
</p>
<p>Example 7.6.1 Consider again Example 7.2.3 where we illustrated how the outcome
</p>
<p>of a die roll experiment can be captured by a random variable. There were 6 events,
</p>
<p>and X could take the values x1 = 1, x2 = 2, . . . , x6 = 6. The probability of the
occurrence of any number was P(X = xi ) = 1/6, and the expectation was calculated
as 3.5. Consider two different situations:</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Calculation Rules for Expectation and Variance 145
</p>
<p>(i) Suppose the die takes the value 10, 20, 30, 40, 50, and 60 instead of the values
</p>
<p>1, 2, 3, 4, 5, and 6. The random variable Y = 10X describes this suitably, and
its expectation is
</p>
<p>E(Y ) = E(10X) = 10E(X) = 10 &middot; 3.5 = 35
which follows from (7.29).
</p>
<p>(ii) If we are rolling two dices X1 and X2, then the expectation for the sum of the
</p>
<p>two outcomes is
</p>
<p>E(X) = E(X1 + X2) = E(X1)+ E(X2) = 3.5 + 3.5 = 7
due to (7.31).
</p>
<p>Calculation Rules for the Variance. Let a and b be any known constants and X be
</p>
<p>a random variable (discrete or continuous). Then, we have the following rules:
</p>
<p>Var(a) = 0, (7.32)
Var(bX) = b2 Var(X), (7.33)
</p>
<p>Var(a + bX) = b2 Var(X). (7.34)
The proof of rule (7.34) is given in Appendix C.2.
</p>
<p>Example 7.6.2 In Examples 7.2.1, 7.3.1, 7.3.3, and 7.3.5, we evaluated a random
</p>
<p>variable describing the waiting time for a train. Now, suppose that a person first has
</p>
<p>to catch a bus to get to the train station. If this bus arrives only every 60 min, then
</p>
<p>the PDF of the random variable Y denoting the waiting time for the bus is
</p>
<p>f (Y ) =
{
</p>
<p>1
60
</p>
<p>for 0 &lt; x &le; 60
0 otherwise .
</p>
<p>We can use Eqs. (7.15) and (7.17) to determine both the expectation and variance
</p>
<p>of Y . However, the waiting time for the bus is governed by the relation Y = 3X
where X is the waiting time for the train. Therefore, we can calculate E(Y ) =
E(3X) = 3E(X) = 3 &middot; 10 = 30 min by using rule (7.29) and the variance as
Var(Y ) = Var(3X) = 32 Var(X) = 9 &middot; 33 1
</p>
<p>3
= 300 using rule (7.33). The total
</p>
<p>waiting time is the sum of the two waiting times.
</p>
<p>7.6.1 Expectation andVariance of the Arithmetic Mean
</p>
<p>Definition 7.6.1 We define the random variables X1, X2, . . . , Xn to be i.i.d. (inde-
</p>
<p>pendently identically distributed), if all X i follow the same distribution and are
</p>
<p>stochastically independent of each other.
</p>
<p>Let X1, X2, . . . , Xn be n i.i.d. random variables with E(X i ) = μ and Var(X i ) =
σ
</p>
<p>2, i = 1, 2, . . . , n. The arithmetic mean of these variables is given by
</p>
<p>X̄ =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
X i ,</p>
<p/>
</div>
<div class="page"><p/>
<p>146 7 Random Variables
</p>
<p>which is again a random variable that follows a distribution with certain expectation
</p>
<p>and variance. A function of random variables is called a statistic. By using (7.29)
</p>
<p>and (7.31), we obtain
</p>
<p>E(X̄) =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
E(X i ) = μ. (7.35)
</p>
<p>If we apply (7.34) and recall that the variables are independent of each other, we can
</p>
<p>also calculate the variance as
</p>
<p>Var(X̄) =
1
</p>
<p>n2
</p>
<p>n
&sum;
</p>
<p>i=1
Var(X i ) =
</p>
<p>σ
2
</p>
<p>n
. (7.36)
</p>
<p>Example 7.6.3 If we toss a coin, we obtain either head or tail, and therefore,
</p>
<p>P(&ldquo;head&rdquo;) = P(&ldquo;tail&rdquo;) = 1
2
</p>
<p>. If we toss the coin n times, we have for each toss
</p>
<p>X i =
{
</p>
<p>0
</p>
<p>1
</p>
<p>for &ldquo;tail&rdquo;
</p>
<p>for &ldquo;head&rdquo;
, i = 1, . . . , n.
</p>
<p>It is straightforward to calculate the expectation and variance for each coin toss:
</p>
<p>E(X i ) = 0 &middot;
1
</p>
<p>2
+ 1 &middot;
</p>
<p>1
</p>
<p>2
=
</p>
<p>1
</p>
<p>2
,
</p>
<p>Var(X i ) = (0 &minus;
1
</p>
<p>2
)2 &middot;
</p>
<p>1
</p>
<p>2
+ (1 &minus;
</p>
<p>1
</p>
<p>2
)2 &middot;
</p>
<p>1
</p>
<p>2
=
</p>
<p>1
</p>
<p>4
&middot;
</p>
<p>1
</p>
<p>2
+
</p>
<p>1
</p>
<p>4
&middot;
</p>
<p>1
</p>
<p>2
=
</p>
<p>1
</p>
<p>4
.
</p>
<p>The arithmetic mean X̄ = 1
n
</p>
<p>&sum;n
i=1 X i describes the relative frequency of heads when
</p>
<p>the coin is tossed n times. We can now apply (7.35) and (7.36) to calculate
</p>
<p>E(X̄) =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
1/2 = 1/2
</p>
<p>and
</p>
<p>Var(X̄) =
1
</p>
<p>n2
</p>
<p>n
&sum;
</p>
<p>i=1
</p>
<p>1
</p>
<p>4
=
</p>
<p>1
</p>
<p>4n
.
</p>
<p>With this example, the interpretation of formulae (7.35) and (7.36) becomes clearer:
</p>
<p>if the probability of head is 0.5 for a single toss, then it is also 0.5 for the mean of all
</p>
<p>tosses. If we toss a coin many times, then the variance decreases when n increases.
</p>
<p>This means that a larger sample size yields a higher precision for the calculated
</p>
<p>arithmetic mean. This observation shows the basic conclusion of the next chapter:
</p>
<p>the higher the sample size, the more secure we are of our conclusions.
</p>
<p>7.7 Covariance and Correlation
</p>
<p>The variance measures the variability of a variable. Similarly, the covariance mea-
</p>
<p>sures the covariation or association between X and Y .</p>
<p/>
</div>
<div class="page"><p/>
<p>7.7 Covariance and Correlation 147
</p>
<p>7.7.1 Covariance
</p>
<p>Definition 7.7.1 The covariance between X and Y is defined as
</p>
<p>̺ = Cov(X, Y ) = E[(X &minus; E(X))(Y &minus; E(Y ))]. (7.37)
</p>
<p>The covariance is positive if, on average, larger values of X correspond to larger
</p>
<p>values of Y ; it is negative if, on average, greater values of X correspond to smaller
</p>
<p>values of Y .
</p>
<p>The probability density function of any bivariate random variable (X, Y ) is char-
</p>
<p>acterized by the expectation and variance of both X and Y ,
</p>
<p>E(X) = μX , Var(X) = σ2X ,
E(Y ) = μY , Var(Y ) = σ2Y ,
</p>
<p>as well as their covariance. We can summarize these features by using the expectation
</p>
<p>vector
</p>
<p>E
</p>
<p>(
</p>
<p>X
</p>
<p>Y
</p>
<p>)
</p>
<p>=
(
</p>
<p>E(X)
</p>
<p>E(Y )
</p>
<p>)
</p>
<p>=
(
</p>
<p>μX
</p>
<p>μY
</p>
<p>)
</p>
<p>and the covariance matrix
</p>
<p>Cov
</p>
<p>(
</p>
<p>X
</p>
<p>Y
</p>
<p>)
</p>
<p>=
(
</p>
<p>Cov(X, X) Cov(X, Y )
</p>
<p>Cov(Y, X) Cov(Y, Y )
</p>
<p>)
</p>
<p>=
(
</p>
<p>σ
2
X ̺
</p>
<p>̺ σ
2
Y
</p>
<p>)
</p>
<p>.
</p>
<p>Important properties of covariance are
</p>
<p>(i) Cov(X, Y ) = Cov(Y, X),
(ii) Cov(X, X) = Var(X),
</p>
<p>(iii) Cov(aX + b, cY + d) = ac Cov(X, Y ),
(iv) Cov(X, Y ) = E(XY ) &minus; E(X)E(Y ) where E(XY ) =
</p>
<p>&int; &int;
</p>
<p>xy f (x, y)dxdy for
</p>
<p>continuous variables and E(XY ) =
&sum;
</p>
<p>i
</p>
<p>&sum;
</p>
<p>j xi y j pi j for discrete variables,
</p>
<p>(v) If X and Y are independent, it follows that E(XY ) = E(X)E(Y ) = μXμY , and
therefore, Cov(X, Y ) = μXμY &minus; μXμY = 0.
</p>
<p>Theorem 7.7.1 (Additivity Theorem) The variance of the sum (subtraction) of X
</p>
<p>and Y is given by
</p>
<p>Var(X &plusmn; Y ) = Var(X)+ Var(Y )&plusmn; 2 Cov(X, Y ).
</p>
<p>If X and Y are independent, it follows that Cov(X, Y ) = 0 and therefore Var(X &plusmn;
Y ) = Var(X)+ Var(Y ). We omit the proof of this theorem.
</p>
<p>Example 7.7.1 Recall Example 7.6.2 where we considered the waiting time Y for
</p>
<p>a bus to the train station and the waiting time X for the waiting time for a train.
</p>
<p>Suppose their joint bivariate probability density function can be written as
</p>
<p>fXY (x, y) =
{
</p>
<p>1
1200
</p>
<p>for 0 &le; x &le; 60, 0 &le; y &le; 20
0 elsewhere.</p>
<p/>
</div>
<div class="page"><p/>
<p>148 7 Random Variables
</p>
<p>To calculate the covariance between X and Y , we need to calculate E(XY ):
</p>
<p>E(XY ) =
&int; &infin;
</p>
<p>&minus;&infin;
</p>
<p>&int; &infin;
</p>
<p>&minus;&infin;
xy f (x, y)dx dy =
</p>
<p>&int; 60
</p>
<p>0
</p>
<p>&int; 20
</p>
<p>0
</p>
<p>xy
1
</p>
<p>1200
dx dy
</p>
<p>=
&int; 60
</p>
<p>0
</p>
<p>[
</p>
<p>x
</p>
<p>1200
</p>
<p>y2
</p>
<p>2
</p>
<p>]20
</p>
<p>0
</p>
<p>dy =
&int; 60
</p>
<p>0
</p>
<p>400x
</p>
<p>2400
dy =
</p>
<p>[
</p>
<p>1
</p>
<p>6
</p>
<p>x2
</p>
<p>2
</p>
<p>]60
</p>
<p>0
</p>
<p>=
3600
</p>
<p>12
= 300 .
</p>
<p>We know from Example 7.6.2 that E(X) = 10,E(Y ) = 30,Var(X) = 33 1
3
, and
</p>
<p>Var(Y ) = 300. The covariance is thus
</p>
<p>Cov(X, Y ) = E(XY )&minus; E(X)E(Y ) = 300 &minus; 30 &middot; 10 = 0.
</p>
<p>This makes sense as the waiting times for the train and the bus should be independent
</p>
<p>of each other. Using rule (7.31), we conclude that the total expected waiting time is
</p>
<p>E(X + Y ) = E(X)+ E(Y ) = 10 + 30 = 40 min.
</p>
<p>The respective variance is
</p>
<p>Var(X + Y ) = Var(X)+ Var(Y )&minus; 2 Cov(X, Y ) = 33
1
</p>
<p>3
+ 300 &minus; 2 &middot; 0 = 333
</p>
<p>1
</p>
<p>3
</p>
<p>due to Theorem 7.7.1.
</p>
<p>7.7.2 Correlation Coefficient
</p>
<p>Definition 7.7.2 The correlation coefficient of X and Y is defined as
</p>
<p>ρ(X, Y ) =
Cov(X, Y )
</p>
<p>&radic;
Var(X)Var(Y )
</p>
<p>. (7.38)
</p>
<p>We already know from Chap. 4 that the correlation coefficient is a measure of
</p>
<p>the degree of linear relationship between X and Y . It can take values between &minus;1
and 1,&minus;1 &le; ρ(X, Y ) &le; 1. However in Chap. 4, we considered the correlation of
two samples, i.e. realizations of random variables; here, we describe the correlation
</p>
<p>coefficient of the population. Ifρ(X, Y ) = 0, then X and Y are said to be uncorrelated.
If there is a perfect linear relationship between X and Y , then ρ = 1 for a positive
relationship and ρ = &minus;1 for a negative relationship, see Appendix C.2 for the proof.
</p>
<p>Theorem 7.7.2 If X and Y are independent, they are also uncorrelated. However,
</p>
<p>if they are uncorrelated then they are not necessarily independent.
</p>
<p>Example 7.7.2 In Example 7.6.2, we estimated the covariance between the waiting
</p>
<p>time for the bus and the waiting time for the train: Cov(X, Y ) = 0. The correlation
coefficient is therefore also 0 indicating no linear relationship between the waiting
</p>
<p>times for bus and train.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>7.9 Exercises 149
</p>
<p>7.8 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� Note that there is a difference between the empirical cumulative distri-
</p>
<p>bution function introduced in Chap. 2 and the CDF introduced in this
</p>
<p>chapter. In Chap. 2, we work with the cumulative distribution of observed
</p>
<p>values in a particular sample, whereas in this chapter, we deal with ran-
</p>
<p>dom variables modelling the distribution of a general population.
</p>
<p>� The expectation and the variance of a random variable are defined as
</p>
<p>follows:
</p>
<p>Expectation Variance
</p>
<p>Discrete
&sum;n
</p>
<p>i=1 xi pi
&sum;n
</p>
<p>i=1(xi &minus; E(X))2 pi
</p>
<p>Continuous
&int; +&infin;
&minus;&infin; x f (x)dx
</p>
<p>&int; +&infin;
&minus;&infin; (x &minus; E(X))
</p>
<p>2 f (x)dx
</p>
<p>� Some important calculation rules are:
</p>
<p>E(a + bX) = a + bE(X); Var(a + bX) = b2 Var(X);
E(X + Y ) = E(X)+ E(Y ); Var(X &plusmn; Y ) = Var(X)+ Var(Y )
</p>
<p>&plusmn;2 Cov(X, Y )
</p>
<p>� Bivariate random variables (X, Y ) have a joint CDF FXY (x, y) which
</p>
<p>specifies the probability P(X &le; x; Y &le; y). The conditional distribution
of X |Y [Y |X ] is the PDF of X [Y ] for a given value Y = y [X = x].
The marginal distribution of X [Y ] is the distribution of X [Y ] without
referring to the values of Y [X ].
</p>
<p>7.9 Exercises
</p>
<p>Exercise 7.1 Consider the following cumulative distribution function of a random
</p>
<p>variable X :
</p>
<p>F(x) =
</p>
<p>⎧
</p>
<p>⎨
</p>
<p>⎩
</p>
<p>0 if x &lt; 2
</p>
<p>&minus; 1
4
</p>
<p>x2 + 2x &minus; 3 if 2 &le; x &le; 4
1 if x &gt; 4.
</p>
<p>(a) What is the PDF of X?
</p>
<p>(b) Calculate P(X &lt; 3) and P(X = 4).
(c) Determine E(X) and Var(X).</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
</div>
<div class="page"><p/>
<p>150 7 Random Variables
</p>
<p>Exercise 7.2 Joey manipulates a die to increase his chances of winning a board game
</p>
<p>against his friends. In each round, a die is rolled and larger numbers are generally an
</p>
<p>advantage. Consider the random variable X denoting the outcome of the rolled die
</p>
<p>and the respective probabilities P(X = 1 = 2 = 3 = 5) = 1/9, P(X = 4) = 2/9,
and P(X = 6) = 3/9.
</p>
<p>(a) Calculate and interpret the expectation and variance of X .
</p>
<p>(b) Imagine that the board game contains an action which makes the players use
</p>
<p>1/X rather than X . What is the expectation of Y = 1/X? Is E(Y ) = E(1/X) =
1/E(X)?
</p>
<p>Exercise 7.3 An innovative winemaker experiments with new grapes and adds a
</p>
<p>new wine to his stock. The percentage sold by the end of the season depends on the
</p>
<p>weather and various other factors. It can be modelled using the random variable X
</p>
<p>with the CDF as
</p>
<p>F(x) =
</p>
<p>⎧
</p>
<p>⎨
</p>
<p>⎩
</p>
<p>0 if x &lt; 0
</p>
<p>3x2 &minus; 2x3 if 0 &le; x &le; 1
1 if x &gt; 1.
</p>
<p>(a) Plot the cumulative distribution function with R.
</p>
<p>(b) Determine f (x).
</p>
<p>(c) What is the probability of selling at least one-third of his wine, but not more
</p>
<p>than two thirds?
</p>
<p>(d) Define the CDF in R and calculate the probability of c) again.
</p>
<p>(e) What is the variance of X?
</p>
<p>Exercise 7.4 A quality index summarizes different features of a product by means
</p>
<p>of a score. Different experts may assign different quality scores depending on their
</p>
<p>experience with the product. Let X be the quality index for a tablet. Suppose the
</p>
<p>respective probability density function is given as follows:
</p>
<p>f (x) =
{
</p>
<p>cx(2 &minus; x) if 0 &le; x &le; 2
0 elsewhere.
</p>
<p>(a) Determine c such that f (x) is a proper PDF.
</p>
<p>(b) Determine the cumulative distribution function.
</p>
<p>(c) Calculate the expectation and variance of X .
</p>
<p>(d) Use Tschebyschev&rsquo;s inequality to determine the probability that X does not
</p>
<p>deviate more than 0.5 from its expectation.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.9 Exercises 151
</p>
<p>Exercise 7.5 Consider the joint PDF for the type of customer service X (0 =
telephonic hotline, 1 = Email) and of satisfaction score Y (1 = unsatisfied, 2 = sat-
isfied, 3 = very satisfied):
</p>
<p>X\Y 1 2 3
0 0 1/2 1/4
</p>
<p>1 1/6 1/12 0
</p>
<p>(a) Determine and interpret the marginal distributions of both X and Y .
</p>
<p>(b) Calculate the 75 % quantile for the marginal distribution of Y .
</p>
<p>(c) Determine and interpret the conditional distribution of satisfaction level for X =
1.
</p>
<p>(d) Are the two variables independent?
</p>
<p>(e) Calculate and interpret the covariance of X and Y .
</p>
<p>Exercise 7.6 Consider a continuous random variable X with expectation 15 and
</p>
<p>variance 4. Determine the smallest interval [15 &minus; c, 15 + c] which contains at least
90 % of the values of X .
</p>
<p>Exercise 7.7 Let X and Y be two random variables for which only 6 possible events&mdash;
</p>
<p>A1, A2, A3, A4, A5, A6&mdash;are defined:
</p>
<p>i 1 2 3 4 5 6
</p>
<p>P(Ai ) 0.3 0.1 0.1 0.2 0.2 0.1
</p>
<p>X i &minus;1 2 2 &minus;1 &minus;1 2
Yi 0 2 0 1 2 1
</p>
<p>(a) What is the joint PDF of X and Y ?
</p>
<p>(b) Calculate the marginal distributions of X and Y .
</p>
<p>(c) Are both variables independent?
</p>
<p>(d) Determine the joint PDF for U = X + Y .
(e) Calculate E(U ) and Var(U ) and compare it with E(X) + E(Y ) and Var(X) +
</p>
<p>Var(Y ), respectively.
</p>
<p>Exercise 7.8 Recall the urn model we introduced in Chap. 5. Consider an urn with
</p>
<p>eight balls: four of them are white, three are black, and one is red. Now, two balls
</p>
<p>are drawn from the urn. The random variables X and Y are defined as follows:
</p>
<p>X =
</p>
<p>⎧
</p>
<p>⎨
</p>
<p>⎩
</p>
<p>1 black ball
</p>
<p>2 red ball in the first draw
</p>
<p>3 white ball
</p>
<p>Y =
</p>
<p>⎧
</p>
<p>⎨
</p>
<p>⎩
</p>
<p>1 black ball
</p>
<p>2 red ball in the second draw
</p>
<p>3 white ball.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_5">http://dx.doi.org/10.1007/978-3-319-46162-5_5</a></div>
</div>
<div class="page"><p/>
<p>152 7 Random Variables
</p>
<p>(a) When are X and Y independent&mdash;when the two balls are drawn with replacement
</p>
<p>or without replacement?
</p>
<p>(b) Assume the balls are drawn such that X and Y are dependent. Use the conditional
</p>
<p>distribution P(Y |X) to determine the joint PDF of X and Y .
(c) Calculate E(X),E(Y ), and ρ(X, Y ).
</p>
<p>Exercise 7.9 If X is the amount of money spent on food and other expenses during
</p>
<p>a day (in e) and Y is the daily allowance of a businesswoman, the joint density of
</p>
<p>these two variables is given by
</p>
<p>fXY (x, y) =
{
</p>
<p>c
(
</p>
<p>100&minus;x
x
</p>
<p>)
</p>
<p>if 10 &le; x &le; 100, 40 &le; y &le; 100
0 elsewhere.
</p>
<p>(a) Choose c such that fXY (x, y) is a probability density function.
</p>
<p>(b) Find the marginal distribution of X .
</p>
<p>(c) Calculate the probability that more than e75 are spent.
</p>
<p>(d) Determine the conditional distribution of Y given X .
</p>
<p>Exercise 7.10 Consider n i.i.d. random variables X i with E(X i ) = μ and Var(X i ) =
σ
</p>
<p>2 and the standardized variable Y = X&minus;μ
σ
</p>
<p>. Show that E(Y ) = 0 and Var(Y ) = 1.
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 365
</p>
<p>&lowast;Source Toutenburg, H., Heumann, C., Induktive Statistik, 4th edition, 2007,
Springer, Heidelberg</p>
<p/>
</div>
<div class="page"><p/>
<p>8Probability Distributions
</p>
<p>We introduced the concept of probability density and probability mass functions of
</p>
<p>random variables in the previous chapter. In this chapter, we are introducing some
</p>
<p>common standard discrete and continuous probability distributions which are widely
</p>
<p>used for either practical applications or constructing statistical methods described
</p>
<p>later in this book. Suppose we are interested in determining the probability of a cer-
</p>
<p>tain event. The determination of probabilities depends upon the nature of the study
</p>
<p>and various prevailing conditions which affect it. For example, the determination of
</p>
<p>the probability of a head when tossing a coin is different from the determination of
</p>
<p>the probability of rain in the afternoon. One can speculate that some mathematical
</p>
<p>functions can be defined which depict the behaviour of probabilities under different
</p>
<p>situations. Such functions have special properties and describe how probabilities
</p>
<p>are distributed under different conditions. We have already learned that they are
</p>
<p>called probability distribution functions. The form of such functions may be sim-
</p>
<p>ple or complicated depending upon the nature and complexity of the phenomenon
</p>
<p>under consideration. Let us first recall and extend the definition of independent and
</p>
<p>identically distributed random variables:
</p>
<p>Definition 8.0.1 The random variables X1, X2, . . . , Xn are called independent and
</p>
<p>identically distributed (i.i.d) if the X i (i = 1, 2, . . . , n) have the same marginal cumu-
lative distribution function F(x) and if they are mutually independent.
</p>
<p>Example 8.0.1 Suppose a researcher plans a survey on the weight of newborn babies
</p>
<p>in a country. The researcher randomly contacts 10 hospitals with a maternity ward
</p>
<p>and asks them to randomly select 20 of the newborn babies (no twins) born in the last
</p>
<p>6 months and records their weights. The sample therefore consists of 10 &times; 20 = 200
baby weights. Since the hospitals and the babies are randomly selected, the babies&rsquo;
</p>
<p>weights are therefore not known beforehand. The 200 weights can be denoted by the
</p>
<p>random variables X1, X2, . . . , X200. Note that the weights X i are random variables
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_8
</p>
<p>153</p>
<p/>
</div>
<div class="page"><p/>
<p>154 8 Probability Distributions
</p>
<p>because, depending on the size of the population, different samples consisting of
</p>
<p>200 babies can be randomly selected. Also, the babies&rsquo; weights can be seen as
</p>
<p>stochastically independent (an example of stochastically dependent weights would
</p>
<p>be the weights of twins if they are included in the sample). After collecting the
</p>
<p>weights of 200 babies, the researcher has a sample of 200 realized values (i.e. the
</p>
<p>weights in grams). The values are now known and denoted by x1, x2, . . . , x200.
</p>
<p>8.1 Standard Discrete Distributions
</p>
<p>First, we discuss some standard distributions for discrete random variables.
</p>
<p>8.1.1 Discrete Uniform Distribution
</p>
<p>The discrete uniform distribution assumes that all possible outcomes have equal
</p>
<p>probability of occurrence. A more formal definition is given as follows:
</p>
<p>Definition 8.1.1 A discrete random variable X with k possible outcomes x1, x2, . . . ,
</p>
<p>xk is said to follow a discrete uniform distribution if the probability mass function
</p>
<p>(PMF) of X is given by
</p>
<p>P(X = xi ) =
1
</p>
<p>k
, &forall;i = 1, 2, . . . , k. (8.1)
</p>
<p>If the outcomes are the natural numbers xi = i (i = 1, 2, . . . , k), the mean and vari-
ance of X are obtained as
</p>
<p>E(X) =
k + 1
</p>
<p>2
, (8.2)
</p>
<p>Var(X) =
1
</p>
<p>12
(k2 &minus; 1). (8.3)
</p>
<p>Example 8.1.1 If we roll a fair die, the outcomes &ldquo;1&rdquo;, &ldquo;2&rdquo;, . . ., &ldquo;6&rdquo; have equal prob-
</p>
<p>ability of occurring, and hence, the random variable X &ldquo;number of dots observed on
</p>
<p>the upper surface of the die&rdquo; has a uniform discrete distribution with PMF
</p>
<p>P(X = i) =
1
</p>
<p>6
, for all i = 1, 2, . . . , 6.
</p>
<p>The mean and variance of X are
</p>
<p>E(X) =
6 + 1
</p>
<p>2
= 3.5,
</p>
<p>Var(X) =
1
</p>
<p>12
(62 &minus; 1) = 35/12.</p>
<p/>
</div>
<div class="page"><p/>
<p>8.1 Standard Discrete Distributions 155
</p>
<p>Fig. 8.1 Frequency
</p>
<p>distribution of 1000
</p>
<p>generated discrete uniform
</p>
<p>random numbers with
</p>
<p>possible outcomes
</p>
<p>(2, 5, 8, 10)
</p>
<p>2 5 8 10
</p>
<p>X
</p>
<p>A
b
s
. 
F
</p>
<p>re
q
u
e
n
c
y
</p>
<p>0
5
0
</p>
<p>1
0
0
</p>
<p>1
5
0
</p>
<p>2
0
0
</p>
<p>2
5
0
</p>
<p>3
0
0
</p>
<p>Using the function sample() in R, it is easy to generate random numbers from a
</p>
<p>discrete uniform distribution. The following command generates a random sample
</p>
<p>of size 1000 from a uniform distribution with the four possible outcomes 2, 5, 8, 10
</p>
<p>and draws a bar chart of the observed numbers. The use of the set.seed() function
</p>
<p>allows to reproduce the generated random numbers at any time. It is necessary to
</p>
<p>use the option replace=TRUE to simulate draws with replacement, i.e. to guarantee
</p>
<p>that a value can occur more than once.
</p>
<p>set.seed(123789)
</p>
<p>x &lt;- sample(x=c(2,5,8,10), size=1000, replace=T,
</p>
<p>prob=c(1/4,1/4,1/4,1/4))
</p>
<p>barchart(table(x), ylim=c(0,300))
</p>
<p>A bar chart of the frequency distribution of the 1000 sampled numbers with the
</p>
<p>possible outcomes (2, 5, 8, 10) using the discrete uniform distribution is given in
</p>
<p>Fig. 8.1. We see that the 1000 generated random numbers are not exactly uniformly
</p>
<p>distributed, e.g. the numbers 5 and 10 occur more often than the numbers 2 and 8.
</p>
<p>In fact, they are only approximately uniform. We expect that the deviance from
</p>
<p>a perfect uniform distribution is getting smaller as we generate more and more
</p>
<p>random numbers but will probably never be zero for a finite number of draws. The
</p>
<p>random numbers reflect the practical situation that a sample distribution is only an
</p>
<p>approximation to the theoretical distribution from which the sample was drawn. More
</p>
<p>details on how to work with random variables in R are given in Appendix A.3.</p>
<p/>
</div>
<div class="page"><p/>
<p>156 8 Probability Distributions
</p>
<p>8.1.2 Degenerate Distribution
</p>
<p>Definition 8.1.2 A random variable X has a degenerate distribution at a, if a is
</p>
<p>the only possible outcome with P(X = a) = 1. The CDF in such a case is given by
</p>
<p>F(x) =
{
</p>
<p>0 if x &lt; a
</p>
<p>1 if x &ge; a.
</p>
<p>Further, E(X) = a and Var(X) = 0.
The degenerate distribution indicates that there is only one possible fixed outcome,
</p>
<p>and therefore, no randomness is involved. It follows that we need at least two different
</p>
<p>possible outcomes to have randomness in the observations of a random variable or
</p>
<p>random experiment. The Bernoulli distribution is such a distribution where there are
</p>
<p>only two outcomes, e.g. success and failure or male and female. These outcomes are
</p>
<p>usually denoted by the values &ldquo;0&rdquo; and &ldquo;1&rdquo;.
</p>
<p>8.1.3 Bernoulli Distribution
</p>
<p>Definition 8.1.3 A random variable X has a Bernoulli distribution if the PMF of X
</p>
<p>is given as
</p>
<p>P(X = x) =
{
</p>
<p>p if x = 1
1 &minus; p if x = 0.
</p>
<p>The cumulative distribution function (CDF) of X is
</p>
<p>F(x) =
</p>
<p>⎧
</p>
<p>⎨
</p>
<p>⎩
</p>
<p>0 if x &lt; 0
</p>
<p>1 &minus; p if 0 &le; x &lt; 1
1 if x &ge; 1.
</p>
<p>The mean (expectation) and variance of a Bernoulli random variable are calculated
</p>
<p>as
</p>
<p>E(X) = 1 &middot; p + 0 &middot; (1 &minus; p) = p (8.4)
</p>
<p>and
</p>
<p>Var(X) = (1 &minus; p)2 &middot; p + (0 &minus; p)2 &middot; (1 &minus; p) = p(1 &minus; p), (8.5)
</p>
<p>respectively.
</p>
<p>A Bernoulli distribution is useful when there are only two possible outcomes, and
</p>
<p>our interest lies in any of the two outcomes, e.g. whether a customer buys a certain
</p>
<p>product or not, or whether a hurricane hits an island or not. The outcome of an event
</p>
<p>A is usually coded as 1 which occurs with probability p. If the event of interest does
</p>
<p>not occur, i.e. the complementary event Ā occurs, the outcome is coded as 0 which
</p>
<p>occurs with probability 1 &minus; p. So p is the probability that the event of interest A
occurs.</p>
<p/>
</div>
<div class="page"><p/>
<p>8.1 Standard Discrete Distributions 157
</p>
<p>Example 8.1.2 A company organizes a raffle at an end-of-year function. There are
</p>
<p>300 lottery tickets in total, and 50 of them are marked as winning tickets. The event
</p>
<p>A of interest is &ldquo;ticket wins&rdquo; (coded as X = 1), and the probability p of having a
winning ticket is a priori (i.e. before any lottery ticket has been drawn)
</p>
<p>P(X = 1) =
50
</p>
<p>300
=
</p>
<p>1
</p>
<p>6
= p and P(X = 0) =
</p>
<p>250
</p>
<p>300
=
</p>
<p>5
</p>
<p>6
= 1 &minus; p.
</p>
<p>According to (8.4) and (8.5), the mean (expectation) and variance of X are
</p>
<p>E(X) =
1
</p>
<p>6
and Var(X) =
</p>
<p>1
</p>
<p>6
&middot;
</p>
<p>5
</p>
<p>6
=
</p>
<p>5
</p>
<p>36
respectively.
</p>
<p>8.1.4 Binomial Distribution
</p>
<p>Consider n independent trials or repetitions of a Bernoulli experiment. In each trial
</p>
<p>or repetition, we may observe either A or Ā. At the end of the experiment, we have
</p>
<p>thus observed A between 0 and n times. Suppose we are interested in the probability
</p>
<p>of A occurring k times, then the binomial distribution is useful.
</p>
<p>Example 8.1.3 Consider a coin tossing experiment where a coin is tossed ten times
</p>
<p>and the event of interest is A = &ldquo;head&rdquo;. The random variable X &ldquo;number of heads in
10 experiments&rdquo; has the possible outcomes k = 0, 1, . . . , 10. A question of interest
may be: What is the probability that a head occurs in 7 out of 10 trials; or in 5 out
</p>
<p>of 10 trials? We assume that the order in which heads (and tails) appear is not of
</p>
<p>interest, only the total number of heads is of interest.
</p>
<p>Questions of this kind are answered by the binomial distribution. This distribution
</p>
<p>can either be motivated as a repetition of n Bernoulli experiments (as in the above
</p>
<p>coin tossing example) or by the urn model (see Chap. 5): assume there are M white
</p>
<p>and N &minus; M black balls in the urn. Suppose n balls are drawn randomly from the urn,
the colour of the ball is recorded and the ball is placed back into the urn (sampling with
</p>
<p>replacement). Let A be the event of interest that a white ball is drawn from the urn.
</p>
<p>The probability of A is p = M/N (the probability of drawing a black ball is 1 &minus; p =
(N &minus; M)/N ). Since the balls are drawn with replacement, these probabilities do not
change from draw to draw. Further, let X be the random variable counting the number
</p>
<p>of white balls drawn from the urn in the n experiments. Since the order of the resulting
</p>
<p>colours of balls is not of interest in this case, there are
(
</p>
<p>n
k
</p>
<p>)
</p>
<p>combinations where k
</p>
<p>balls are white and n &minus; k balls are black. Since the balls are drawn with replacement,
every outcome of the n experiments is independent of all others. The probability that
</p>
<p>X = k, k = 0, 1, . . . , n, can therefore be calculated as
</p>
<p>P(X = k) =
(
</p>
<p>n
</p>
<p>k
</p>
<p>)
</p>
<p>pk(1 &minus; p)n&minus;k (k = 0, 1, . . . , n). (8.6)
</p>
<p>Please note that we can use the product pk(1 &minus; p)n&minus;k because the draws are inde-
pendent. The binomial coefficient
</p>
<p>(
</p>
<p>n
k
</p>
<p>)
</p>
<p>is necessary to count the number of possible
</p>
<p>orders of the black and white balls.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_5">http://dx.doi.org/10.1007/978-3-319-46162-5_5</a></div>
</div>
<div class="page"><p/>
<p>158 8 Probability Distributions
</p>
<p>Definition 8.1.4 A discrete random variable X is said to follow a binomial distribu-
</p>
<p>tion with parameters n and p if its PMF is given by (8.6). We also write X &sim; B(n; p).
The mean and variance of a binomial random variable X are given by
</p>
<p>E(X) = np, (8.7)
Var(X) = np(1 &minus; p). (8.8)
</p>
<p>Remark 8.1.1 A Bernoulli random variable is therefore B(1; p) distributed.
</p>
<p>Example 8.1.4 Consider an unfair coin where the probability of observing a tail (T )
</p>
<p>is p(T ) = 0.6. Let us denote tails by &ldquo;1&rdquo; and heads by &ldquo;0&rdquo;. Suppose the coin is
tossed three times. In total, there are the 23 = 8 following possible outcomes:
</p>
<p>Outcome X = x
1 1 1 3
</p>
<p>1 1 0 2
</p>
<p>1 0 1 2
</p>
<p>0 1 1 2
</p>
<p>1 0 0 1
</p>
<p>0 1 0 1
</p>
<p>0 0 1 1
</p>
<p>0 0 0 0
</p>
<p>Note that the first outcome, viz. (1, 1, 1) leads to x = 3, the next 3 outcomes, viz.,
(1, 1, 0), (1, 0, 1), (0, 1, 1) obtained by (=
</p>
<p>(
</p>
<p>3
2
</p>
<p>)
</p>
<p>) lead to x = 2, the next 3 outcomes,
viz., (1, 0, 0), ((0, 1, 0), (0, 0, 1) obtained by (=
</p>
<p>(
</p>
<p>3
1
</p>
<p>)
</p>
<p>) lead to x = 1, and the last
outcome, viz. (0, 0, 0) obtained by (=
</p>
<p>(
</p>
<p>3
0
</p>
<p>)
</p>
<p>) leads to x = 0. We can, for example,
calculate
</p>
<p>P(X = 2) =
(
</p>
<p>3
</p>
<p>2
</p>
<p>)
</p>
<p>0.62(1 &minus; 0.6)1 = 0.432 (or 43.2 %).
</p>
<p>Further, the mean and variance of X are
</p>
<p>E(X) = np = 3 &middot; 0.6 = 1.8, and Var(X) = np(1 &minus; p) = 3 &middot; 0.6 &middot; 0.4 = 0.72.
</p>
<p>Functions for the binomial distribution, as well as many other distributions, are
</p>
<p>implemented in R. For each of these distributions, we can easily determine the density
</p>
<p>function (PMF, PDF) for given values and parameters, determine the CDF, calculate
</p>
<p>quantiles and draw random numbers. Appendix A.3 gives more details. Nevertheless,
</p>
<p>we illustrate the concept of dealing with distributions in R in the following example.
</p>
<p>Example 8.1.5 Suppose we roll an unfair die 50 times with the probability of a tail
</p>
<p>ptail = 0.6. We thus deal with a B(50, 0.6) distribution which can be plotted using
the dbinom command. The prefix d stands for &ldquo;density&rdquo;.</p>
<p/>
</div>
<div class="page"><p/>
<p>8.1 Standard Discrete Distributions 159
</p>
<p>Fig. 8.2 PMF of a
</p>
<p>B(50, 0.6) distribution
</p>
<p>0 10 20 30 40 50
</p>
<p>0
.0
</p>
<p>0
0
.0
</p>
<p>2
0
.0
</p>
<p>4
0
.0
</p>
<p>6
0
.0
</p>
<p>8
0
.1
</p>
<p>0
</p>
<p>X
P
</p>
<p>ro
b
a
b
ili
</p>
<p>ty
</p>
<p>n &lt;- 50
</p>
<p>p &lt;- 0.6
</p>
<p>k &lt;- 0:n
</p>
<p>pmf &lt;- dbinom(k,n,p)
</p>
<p>plot(k,pmf, type=h)
</p>
<p>A plot of the PMF of a binomial distribution with n = 50 and p = 0.6 (i.e. B(50, 0.6))
is given in Fig. 8.2.
</p>
<p>Note that we can also calculate the CDF with R. We can use the pbinom(x,n,p)
</p>
<p>command, where the prefix p stands for probability, to calculate the CDF at any
</p>
<p>point. For example, suppose we are interested in P(X &ge; 30) = 1 &minus; F(29), that is
the probability of observing thirty or more tails; then we write
</p>
<p>1-pbinom(29,50,0.6)
</p>
<p>[1] 0.5610349
</p>
<p>Similarly, we can determine quantiles. For instance, the 80 % quantile q which
</p>
<p>describes that P(X &le; q) &ge; 0.8 can be obtained by the qbinom(q,n,p) command
as follows:
</p>
<p>qbinom(0.8,50,0.6)
</p>
<p>[1] 33
</p>
<p>If we want to generate 100 random realizations from a B(50, 0.6) distribution we
</p>
<p>can use the rbinom command.
</p>
<p>rbinom(100,50,0.6)
</p>
<p>The binomial distribution has some nice properties. One of them is described in
</p>
<p>the following theorem:</p>
<p/>
</div>
<div class="page"><p/>
<p>160 8 Probability Distributions
</p>
<p>Theorem 8.1.1 Let X &sim; B(n; p) and Y &sim; B(m; p) and assume that X and Y are
(stochastically) independent. Then
</p>
<p>X + Y &sim; B(n + m; p). (8.9)
</p>
<p>This is intuitively clear since we can interpret this theorem as describing the addi-
</p>
<p>tive combination of two independent binomial experiments with n and m trials, with
</p>
<p>equal probability p, respectively. Since every binomial experiment is a series of inde-
</p>
<p>pendent Bernoulli experiments, this is equivalent to a series of n + m independent
Bernoulli trials with constant success probability p which in turn is equivalent to a
</p>
<p>binomial distribution with n + m trials.
</p>
<p>8.1.5 Poisson Distribution
</p>
<p>Consider a situation in which the number of events is very large and the probability
</p>
<p>of success is very small: for example, the number of alpha particles emitted by a
</p>
<p>radioactive substance entering a particular region in a given short time interval. Note
</p>
<p>that the number of emitted alpha particles is very high but only a few particles are
</p>
<p>transmitted through the region in a given short time interval. Some other examples
</p>
<p>where Poisson distributions are useful are the number of flu cases in a country within
</p>
<p>one year, the number of tropical storms within a given area in one year, or the number
</p>
<p>of bacteria found in a biological investigation.
</p>
<p>Definition 8.1.5 A discrete random variable X is said to follow a Poisson distribution
</p>
<p>with parameter λ &gt; 0 if its PMF is given by
</p>
<p>P(X = x) =
λx
</p>
<p>x !
exp (&minus;λ) (x = 0, 1, 2, . . .). (8.10)
</p>
<p>We also write X &sim; Po(λ). The mean and variance of a Poisson random variable are
identical:
</p>
<p>E(X) = Var(X) = λ.
</p>
<p>Example 8.1.6 Suppose a country experiences X = 4 tropical storms on average per
year. Then the probability of suffering from only two tropical storms is obtained by
</p>
<p>using the Poisson distribution as
</p>
<p>P(X = 2) =
λx
</p>
<p>x !
exp(&minus;λ) =
</p>
<p>42
</p>
<p>2!
exp(&minus;4) = 0.146525.
</p>
<p>If we are interested in the probability that not more than 2 storms are experienced, then
</p>
<p>we can apply rules (7.7)&ndash;(7.13) from Chap. 7: P(X &le; 2) = P(X = 2)+ P(X =
1)+ P(X = 0) = F(2) = 0.2381033. We can calculate P(X = 1) and P(X = 0)
from (8.10) or using R. Similar to Example 8.1.5, we use the prefix d to obtain
</p>
<p>the PMF and the prefix p to work with the CDF, i.e. we can use dpois(x,λ) and
</p>
<p>ppois(x,λ) to determine P(X = x) and P(X &le; x), respectively.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>8.1 Standard Discrete Distributions 161
</p>
<p>dpois(2,4) + dpois(1,4) + dpois(0,4)
</p>
<p>[1] 0.2381033
</p>
<p>ppois(2,4)
</p>
<p>[1] 0.2381033
</p>
<p>8.1.6 Multinomial Distribution
</p>
<p>We now consider random experiments where k distinct or disjoint events A1, A2, . . . ,
</p>
<p>Ak can occur with probabilities p1, p2, . . . , pk , respectively, with the restriction
&sum;k
</p>
<p>j=1 p j = 1. For example, if eight parties compete in a political election, we may
be interested in the probability that a person votes for party A j , j = 1, 2, . . . , 8.
Similarly one might be interested in the probability whether tuberculosis is detected
</p>
<p>in the lungs (A1), in other organs (A2), or both (A3). Practically, we often use the
</p>
<p>multinomial distribution to model the distribution of categorical variables. This can
</p>
<p>be interpreted as a generalization of the binomial distribution (where only two distinct
</p>
<p>events can occur) to the situation where more than two events or outcomes can
</p>
<p>occur. If the experiment is repeated n times independently, we are interested in the
</p>
<p>probability that
</p>
<p>A1 occurs n1-times, A2 occurs n2-times, . . . , Ak occurs nk-times
</p>
<p>with
&sum;k
</p>
<p>j=1 n j = n. Since several events can occur, the outcome of one (of the n)
experiments is conveniently described by binary indicator variables. Let Vi j , i =
1, . . . , n, j = 1, . . . , k, denote the event &ldquo;A j is observed in experiment i&rdquo;, i.e.
</p>
<p>Vi j =
{
</p>
<p>1 if A j occurs in experiment i
</p>
<p>0 if A j does not occur in experiment i
</p>
<p>with probabilities P(Vi j = 1) = p j , j = 1, 2, . . . , k; then, the outcome of one
experiment is a vector of length k,
</p>
<p>Vi = (Vi1, . . . , Vi j , . . . , Vik) = (0, . . . , 1, . . . , 0),
</p>
<p>with &ldquo;1&rdquo; being present in only one position, i.e. in position j , if A j occurs in exper-
</p>
<p>iment i . Now, define (for each j = 1, . . . , k) X j =
&sum;n
</p>
<p>i=1 Vi j . Then, X j is counting
how often event A j was observed in the n independent experiments (i.e. how often
</p>
<p>Vi j was 1 in the n experiments).
</p>
<p>Definition 8.1.6 The random vector X = (X1, X2, . . . , Xk) is said to follow a
multinomial distribution if its PMF is given as
</p>
<p>P(X1 = n1, X2 = n2, . . . , Xk = nk) =
n!
</p>
<p>n1!n2! &middot; &middot; &middot; nk !
&middot; pn11 p
</p>
<p>n2
2 &middot; &middot; &middot; p
</p>
<p>nk
k (8.11)
</p>
<p>with the restrictions
&sum;k
</p>
<p>j=1 n j = n and
&sum;k
</p>
<p>j=1 p j = 1. We also write X &sim; M(n; p1,
. . . , pk). The mean of X is the (component-wise) vector
</p>
<p>E(X) = (E(X1),E(X2), . . . ,E(Xk))
= (np1, np2, . . . , npk).</p>
<p/>
</div>
<div class="page"><p/>
<p>162 8 Probability Distributions
</p>
<p>The (i, j)th element of the covariance matrix V (X) is
</p>
<p>Cov(X i , X j ) =
{
</p>
<p>npi (1 &minus; pi ) if i = j
&minus;npi p j if i �= j.
</p>
<p>Remark 8.1.2 Due to the restriction that
&sum;k
</p>
<p>j=1 n j =
&sum;k
</p>
<p>j=1 X j = n, X1, . . . , Xk are
not stochastically independent which is reflected by the negative covariance. This
</p>
<p>is also intuitively clear: if one X j gets higher, another X j &prime; , j �= j &prime;, has to become
lower to satisfy the restrictions.
</p>
<p>We use the multinomial distribution to describe the randomness of categorical
</p>
<p>variables. Suppose we are interested in the variable &ldquo;political party&rdquo;; there might
</p>
<p>be eight political parties, and we could thus summarize this variable by eight binary
</p>
<p>variables, each of them describing the event of party A j , j = 1, 2, . . . , 8, being voted
for. In this sense, X = (X1, X2, . . . , X8) follows a multinomial distribution.
</p>
<p>Example 8.1.7 Consider a simple example of the urn model. The urn contains 50
</p>
<p>balls of three colours: 25 red balls, 15 white balls, and 10 black balls. The balls are
</p>
<p>drawn from the urn with replacement. The balls are placed back into the urn after
</p>
<p>every draw, which means the draws are independent. Therefore, the probability of
</p>
<p>drawing a red ball in every draw is p1 = 2550 = 0.5. Analogously, p2 = 0.3 (for white
balls) and p3 = 0.2 (for black balls). Consider n = 4 draws. The probability of the
random event of drawing &ldquo;2 red balls, 1 white ball, and 1 black ball&rdquo; is:
</p>
<p>P(X1 = 2, X2 = 1, X3 = 1) =
4!
</p>
<p>2!1!1!
(0.5)2(0.3)1(0.2)1 = 0.18. (8.12)
</p>
<p>We would have obtained the same result in R using the dmultinom function:
</p>
<p>dmultinom(c(2,1,1),prob=c(0.5,0.3,0.2))
</p>
<p>This example demonstrates that the multinomial distribution relates to an exper-
</p>
<p>iment with replacement and without considering the order of the draws. Instead of
</p>
<p>the urn model, consider another example where we may interpret these three proba-
</p>
<p>bilities as probabilities of voting for candidate A j , j = 1, 2, 3, in an election. Now,
suppose we ask four voters about their choice, then the probability of candidate A1
receiving 2 votes, candidate A2 receiving 1 vote, and candidate A3 receiving 1 vote
</p>
<p>is 18 % as calculated in (8.12).
</p>
<p>Remark 8.1.3 In contrast to most of the distributions, the CDF of the multinomial
</p>
<p>distribution, i.e. the function calculating P(X1 &le; x1, X2 &le; x2, . . . , Xk &le; xk), is not
contained in the base R-distribution. Please note that for k = 2, the multinomial
distribution reduces to the binomial distribution.</p>
<p/>
</div>
<div class="page"><p/>
<p>8.1 Standard Discrete Distributions 163
</p>
<p>8.1.7 Geometric Distribution
</p>
<p>Consider a situation in which we are interested in determining how many independent
</p>
<p>Bernoulli trials are needed until the event of interest occurs for the first time. For
</p>
<p>instance, we may be interested in how many tickets to buy in a raffle until we win
</p>
<p>for the first time, or how many different drugs to try to successfully tackle a severe
</p>
<p>migraine, etc. The geometric distribution can be used to determine the probability
</p>
<p>that the event of interest happens at the kth trial for the first time.
</p>
<p>Definition 8.1.7 A discrete random variable X is said to follow a geometric distri-
</p>
<p>bution with parameter p if its PMF is given by
</p>
<p>P(X = k) = p(1 &minus; p)k&minus;1, k = 1, 2, 3, . . . (8.13)
</p>
<p>The mean (expectation) and variance are given by E(X) = 1/p and Var(X) =
1/p(1/p &minus; 1), respectively.
</p>
<p>Example 8.1.8 Let us consider an experiment where a coin is tossed until &ldquo;head&rdquo; is
</p>
<p>obtained for the first time. The probability of getting a head is p = 0.5 for each toss.
Using (8.13), we can determine the following probabilities:
</p>
<p>P(X = 1) = 0.5
P(X = 2) = 0.5(1 &minus; 0.5) = 0.25
P(X = 3) = 0.5(1 &minus; 0.5)2 = 0.125
P(X = 4) = 0.5(1 &minus; 0.5)3 = 0.0625
</p>
<p>. . . . . .
</p>
<p>Using the command structure for obtaining PMF&rsquo;s in R (Appendix A as well as
</p>
<p>Examples 8.1.5 and 8.1.6), we can determine the latter probability of P(X = 4) as
follows:
</p>
<p>dgeom(3,0.5)
</p>
<p>Note that the definition of X in R slightly differs from our definition. In R, k is
</p>
<p>the number of failures before the first success. This means we need to specify k &minus; 1
in the dgeom function rather than k. The mean and variance for this setting are
</p>
<p>E(X) =
1
</p>
<p>0.5
= 2; Var(X) =
</p>
<p>1
</p>
<p>0.5
</p>
<p>(
</p>
<p>1
</p>
<p>0.5
&minus; 1
</p>
<p>)
</p>
<p>= 2.
</p>
<p>8.1.8 Hypergeometric Distribution
</p>
<p>We can again use the urn model to motivate another distribution, the hypergeometric
</p>
<p>distribution. Consider an urn with We randomly draw n balls without replacement,</p>
<p/>
</div>
<div class="page"><p/>
<p>164 8 Probability Distributions
</p>
<p>M white balls
</p>
<p>N &minus; M black balls
</p>
<p>N total balls
</p>
<p>i.e. we do not place a ball back into the urn once it is drawn. The order in which the
</p>
<p>balls are drawn is assumed to be of no interest; only the number of drawn white balls
</p>
<p>is of relevance. We define the following random variable
</p>
<p>X : &ldquo;number of white balls (x) among the n drawn balls&rdquo;.
</p>
<p>To be more precise, among the n drawn balls, x are white and n &minus; x are black. There
are
</p>
<p>(
</p>
<p>M
x
</p>
<p>)
</p>
<p>possibilities to choose x white balls from the total of M white balls, and
</p>
<p>analogously, there are
(
</p>
<p>N&minus;M
n&minus;x
</p>
<p>)
</p>
<p>possibilities to choose (n &minus; x) black balls from the
total of N &minus; M black balls. In total, we draw n out of N balls. Recall the probability
definition of Laplace as the number of simple favourable events divided by all possible
</p>
<p>events. The number of combinations for all possible events is
(
</p>
<p>N
n
</p>
<p>)
</p>
<p>; the number of
</p>
<p>favourable events is
(
</p>
<p>M
x
</p>
<p>)(
</p>
<p>N&minus;M
n&minus;x
</p>
<p>)
</p>
<p>because we draw, independent of each other, x out
</p>
<p>of M balls and n &minus; x out of N &minus; M balls. Hence, the PMF of the hypergeometric
distribution is
</p>
<p>P(X = x) =
(
</p>
<p>M
x
</p>
<p>)(
</p>
<p>N&minus;M
n&minus;x
</p>
<p>)
</p>
<p>(
</p>
<p>N
n
</p>
<p>)
(8.14)
</p>
<p>for x &isin; {max(0, n &minus; (N &minus; M)), . . . ,min(n, M)}.
</p>
<p>Definition 8.1.8 A random variable X is said to follow a hypergeometric distribu-
</p>
<p>tion with parameters n, M, N , i.e. X &sim; H(n, M, N ), if its PMF is given by (8.14).
</p>
<p>Example 8.1.9 The German national lottery draws 6 out of 49 balls from a rotating
</p>
<p>bowl. Each ball is associated with a number between 1 and 49. A simple bet is to
</p>
<p>choose 6 numbers between 1 and 49. If 3 or more chosen numbers correspond to
</p>
<p>the numbers drawn in the lottery, then one wins a certain amount of money. What
</p>
<p>is the probability of choosing 4 correct numbers? We can utilize the hypergeometric
</p>
<p>distribution with x = 4, M = 6, N = 49, and n = 6 to calculate such probabilities.
The interpretation is that we &ldquo;draw&rdquo; (i.e. bet on) 4 out of the 6 winning balls and
</p>
<p>&ldquo;draw&rdquo; (i.e. bet on) another 2 out of the remaining 43 (49 &minus; 6) losing balls. In total,
we draw 6 out of 49 balls. Calculating the number of the favourable combinations and
</p>
<p>all possible combinations leads to the application of the hypergeometric distribution
</p>
<p>as follows:
</p>
<p>P(X = 4) =
(
</p>
<p>M
x
</p>
<p>)(
</p>
<p>N&minus;M
n&minus;x
</p>
<p>)
</p>
<p>(
</p>
<p>N
n
</p>
<p>)
=
</p>
<p>(
</p>
<p>6
4
</p>
<p>)(
</p>
<p>43
2
</p>
<p>)
</p>
<p>(
</p>
<p>49
6
</p>
<p>)
&asymp; 0.001 (or 0.1 %).
</p>
<p>We would have obtained the same results using the dhyper command. Its arguments
</p>
<p>are x, M, N, n, and thus, we specify
</p>
<p>dhyper(4,6,43,6)</p>
<p/>
</div>
<div class="page"><p/>
<p>8.1 Standard Discrete Distributions 165
</p>
<p>Fig. 8.3 The H(6, 43, 6)
</p>
<p>distribution
</p>
<p>0 1 2 3 4 5 6
</p>
<p>X
</p>
<p>P
ro
</p>
<p>b
a
b
ili
</p>
<p>ty
</p>
<p>0
.0
</p>
<p>0
.1
</p>
<p>0
.2
</p>
<p>0
.3
</p>
<p>0
.4
</p>
<p>0
.5
</p>
<p>The H(6, 43, 6) distribution is also visualized in Fig. 8.3. It is evident that the
</p>
<p>cumulative probability of choosing 2 or fewer correct numbers is greater than 0.9
</p>
<p>(or 90 %), but it is very unlikely to have 3 or more numbers right. This may explain
</p>
<p>why the national lottery pays out money only for 3 or more correct numbers.
</p>
<p>8.2 Standard Continuous Distributions
</p>
<p>Now, we discuss some standard probability distributions of (absolute) continuous
</p>
<p>random variables. Characteristics of continuous random variables are that the number
</p>
<p>of possible outcomes is uncountably infinite and that they have a continuous distribu-
</p>
<p>tion function F(x). It follows that the point probabilities are zero, i.e. P(X = x) = 0.
Further, we assume a unique density function f exists, such that F(x) =
</p>
<p>&int; x
</p>
<p>&minus;&infin; f (t)dt .
</p>
<p>8.2.1 Continuous Uniform Distribution
</p>
<p>A continuous analogue to the discrete uniform distribution is the continuous uniform
</p>
<p>distribution on a closed interval in R.
</p>
<p>Definition 8.2.1 A continuous random variable X is said to follow a (continuous)
</p>
<p>uniform distribution in the interval [a, b], i.e. X &sim; U (a, b), if its probability density
function (PDF) is given by
</p>
<p>f (x) =
{
</p>
<p>1
b&minus;a if a &le; x &le; b (a &lt; b)
0 otherwise.
</p>
<p>The mean and variance of X &sim; U (a, b) are
</p>
<p>E(X) =
a + b
</p>
<p>2
and Var(X) =
</p>
<p>(b &minus; a)2
</p>
<p>12
,
</p>
<p>respectively.</p>
<p/>
</div>
<div class="page"><p/>
<p>166 8 Probability Distributions
</p>
<p>Example 8.2.1 Suppose a train arrives at a subway station regularly every 10 min.
</p>
<p>If a passenger arrives at the station without knowing the timetable, then the waiting
</p>
<p>time to catch the train is uniformly distributed with density
</p>
<p>f (x) =
{
</p>
<p>1
10
</p>
<p>if 0 &le; x &le; 10
0 otherwise.
</p>
<p>The &ldquo;average&rdquo; waiting time is E(X) = (10 + 0)/2 = 5 min. The probability of wait-
ing for the train for less than 3 min is obviously 0.3 (or 30 %) which can be calculated
</p>
<p>in R using the punif(x,a,b) command (see also Appendix A.3):
</p>
<p>punif(3,0,10)
</p>
<p>8.2.2 Normal Distribution
</p>
<p>The normal distribution is one of the most important distributions used in statistics.
</p>
<p>The name was given by Carl Friedrich Gauss (1777&ndash;1855), a German mathematician,
</p>
<p>astronomer, geodesist, and physicist who observed that measurements in geodesy and
</p>
<p>astronomy randomly deviate in a symmetric way from their true values. The normal
</p>
<p>distribution is therefore also often called a Gaussian distribution.
</p>
<p>Definition 8.2.2 A random variable X is said to follow a normal distribution with
</p>
<p>parameters &micro; and σ2 if its PDF is given by
</p>
<p>f (x) =
1
</p>
<p>σ
&radic;
</p>
<p>2π
exp
</p>
<p>(
</p>
<p>&minus;
(x &minus; &micro;)2
</p>
<p>2σ2
</p>
<p>)
</p>
<p>; &minus;&infin; &lt; x &lt; &infin;,&minus;&infin; &lt; &micro; &lt; &infin;,σ2 &gt; 0.
</p>
<p>(8.15)
</p>
<p>We write X &sim; N (&micro;,σ2). The mean and variance of X are
E(X) = &micro; ; and Var(X) = σ2,
</p>
<p>respectively. If &micro; = 0 and σ2 = 1, then X is said to follow a standard normal
distribution, X &sim; N (0, 1). The PDF of a standard normal distribution is given by
</p>
<p>φ(x) =
1
</p>
<p>&radic;
2π
</p>
<p>exp(&minus;
x2
</p>
<p>2
); &minus;&infin; &lt; x &lt; &infin;.
</p>
<p>The density of a normal distribution has its maximum (see Fig. 8.4) at x = &micro;.
The density is also symmetric around &micro;. The inflexion points of the density are at
</p>
<p>(&micro;&minus; σ) and (&micro;+ σ) (Fig. 8.4). A lower σ indicates a higher concentration around
the mean &micro;. A higher σ indicates a flatter density (Fig. 8.5).
</p>
<p>The cumulative distribution function of X &sim; N (&micro;,σ2) is
</p>
<p>F(x) =
&int; x
</p>
<p>&minus;&infin;
φ(t)dt (8.16)
</p>
<p>which is often denoted as Φ(x). The value of Φ(x) for various values of x can be
</p>
<p>obtained in R following the rules introduced in Appendix A.3. For example,</p>
<p/>
</div>
<div class="page"><p/>
<p>8.2 Standard Continuous Distributions 167
</p>
<p>&micro; &minus; σ &micro; + σ&micro;
</p>
<p>Fig. 8.4 PDF of a normal distribution&lowast;
</p>
<p>N(0, 1)
</p>
<p>N(0, 0.5)
</p>
<p>N(0, 2)
</p>
<p>0
</p>
<p>Fig. 8.5 PDF of N (0, 2), N (0, 1) and N (0, 0.5) distributions&lowast;
</p>
<p>pnorm(1.96, mean = 0, sd = 1)
</p>
<p>calculates Φ(1.96) as approximately 0.975. This means, for a standard normal dis-
</p>
<p>tribution the probability P(X &le; 1.96) &asymp; 0.975.
</p>
<p>Remark 8.2.1 There is no explicit formula to solve the integral in Eq. (8.16). It has
</p>
<p>to be solved by numerical (or computational) methods. This is the reason why CDF
</p>
<p>tables are presented in almost all statistical textbooks, see Table C.1 in Appendix C.
</p>
<p>Example 8.2.2 An orange farmer sells his oranges in wooden boxes. The weights of
</p>
<p>the boxes vary and are assumed to be normally distributed with &micro; = 15 kg and σ2 =
9
4
</p>
<p>kg2. The farmer wants to avoid customers being unsatisfied because the boxes are
</p>
<p>too low in weight. He therefore asks the following question: What is the probability
</p>
<p>that a box with a weight of less than 13 kg is sold? Using thepnorm(x,&micro;,σ) command
</p>
<p>in R, we get</p>
<p/>
</div>
<div class="page"><p/>
<p>168 8 Probability Distributions
</p>
<p>pnorm(13,15,sqrt(9/4))
</p>
<p>[1] 0.09121122
</p>
<p>To calculate the probability in Example 8.2.2 manually, we first have to introduce
</p>
<p>some theoretical results.
</p>
<p>Calculation rules for normal random variables.
</p>
<p>Let X &sim; N (&micro;,σ2). Using the transformation
</p>
<p>Z =
X &minus; &micro;
σ
</p>
<p>&sim; N (0, 1), (8.17)
</p>
<p>every normally distributed random variable can be transformed into a standard nor-
</p>
<p>mal random variable. We call this transformation the Z -transformation. We can use
</p>
<p>this transformation to derive convenient calculation rules. The probability for X &le; b
is
</p>
<p>P(X &le; b) = P
(
</p>
<p>X &minus; &micro;
σ
</p>
<p>&le;
b &minus; &micro;
σ
</p>
<p>)
</p>
<p>= P
(
</p>
<p>Z &le;
b &minus; &micro;
σ
</p>
<p>)
</p>
<p>= Φ
(
</p>
<p>b &minus; &micro;
σ
</p>
<p>)
</p>
<p>. (8.18)
</p>
<p>Consequently, the probability for X &gt; a is
</p>
<p>P(X &gt; a) = 1 &minus; P(X &le; a) = 1 &minus;Φ
(
</p>
<p>a &minus; &micro;
σ
</p>
<p>)
</p>
<p>. (8.19)
</p>
<p>The probability that X realizes a value in the interval [a, b] is
</p>
<p>P(a &le; X &le; b) = P
(
</p>
<p>a &minus; &micro;
σ
</p>
<p>&le; Z &le;
b &minus; &micro;
σ
</p>
<p>)
</p>
<p>= Φ
(
</p>
<p>b &minus; &micro;
σ
</p>
<p>)
</p>
<p>&minus;Φ
(
</p>
<p>a &minus; &micro;
σ
</p>
<p>)
</p>
<p>.
</p>
<p>(8.20)
</p>
<p>Because of the symmetry of the probability density function φ(x) around its mean 0,
</p>
<p>the following equation holds for the distribution function Φ(x) of a standard normal
</p>
<p>random variable for any value a:
</p>
<p>Φ(&minus;a) = 1 &minus;Φ(a). (8.21)
</p>
<p>It follows that P(&minus;a &lt; Z &lt; a) = 2 &middot;Φ(a)&minus; 1, see also Fig. 8.6.
</p>
<p>Example 8.2.3 Recall Example 8.2.2 where a farmer sold his oranges. He was inter-
</p>
<p>ested in P(X &le; 13) for X &sim; N (15, 9/4). Using (8.17), we get
</p>
<p>P(X &le; 13) = Φ
</p>
<p>(
</p>
<p>13 &minus; 15
3
2
</p>
<p>)
</p>
<p>= Φ
(
</p>
<p>&minus;
4
</p>
<p>3
</p>
<p>)
</p>
<p>= 1 &minus;Φ
(
</p>
<p>4
</p>
<p>3
</p>
<p>)
</p>
<p>&asymp; 0.091 (or 9.1 %).
</p>
<p>To obtain Φ(4/3) &asymp; 90.9 %, we could either use R (pnorm(4/3)) or use
Table C.1.</p>
<p/>
</div>
<div class="page"><p/>
<p>8.2 Standard Continuous Distributions 169
</p>
<p>&minus;4 &minus;2 0 2 4
</p>
<p>0
.0
</p>
<p>0
.1
</p>
<p>0
.2
</p>
<p>0
.3
</p>
<p>0
.4
</p>
<p>x
</p>
<p>φ
(x
)
</p>
<p>&minus;a a
</p>
<p>2Φ(a)&minus;1
</p>
<p>Fig. 8.6 Distribution function of the standard normal distribution
</p>
<p>Distribution of the Arithmetic Mean.
</p>
<p>Assume that X &sim; N (&micro;,σ2). Consider a random sample X = (X1, X2, . . . , Xn) of
independent and identically distributed random variables X i with X i &sim; N (&micro;,σ2).
Then, the arithmetic mean X̄ = 1
</p>
<p>n
</p>
<p>&sum;n
i=1 X i follows a normal distribution with mean
</p>
<p>E(X̄) =
1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
E(X i ) = &micro;
</p>
<p>and variance
</p>
<p>Var(X̄) =
1
</p>
<p>n2
</p>
<p>n
&sum;
</p>
<p>i=1
Var(X i ) =
</p>
<p>σ2
</p>
<p>n
(8.22)
</p>
<p>where Cov(X i , X j ) = 0 for i �= j . In summary, we get
</p>
<p>X̄ &sim; N
(
</p>
<p>&micro;,
σ2
</p>
<p>n
</p>
<p>)
</p>
<p>.
</p>
<p>Remark 8.2.2 In fact, in Eq. (8.22), we have used the fact that the sum of normal
</p>
<p>random variables also follows a normal distribution, i.e.
</p>
<p>(X1 + X2) &sim; N
(
</p>
<p>&micro;1 + &micro;2,σ21 + σ
2
2
</p>
<p>)
</p>
<p>.
</p>
<p>This result can be generalized to n (not necessarily identically distributed but inde-
</p>
<p>pendent) normal random variables. In fact, it holds that if X1, X2, . . . , Xn are inde-
</p>
<p>pendent normal variables with means &micro;1,&micro;2, . . . ,&micro;n and variances σ
2
1,σ
</p>
<p>2
2, . . . ,σ
</p>
<p>2
n ,
</p>
<p>then for any real numbers a1, a2, . . . , an , it holds that
</p>
<p>(a1 X1 + a2 X2 + &middot; &middot; &middot; + an Xn) &sim; N
(
</p>
<p>a1&micro;1 + a2&micro;2 + &middot; &middot; &middot; an&micro;n, a21σ
2
1 + a
</p>
<p>2
2σ
</p>
<p>2
2 + &middot; &middot; &middot; a
</p>
<p>2
nσ
</p>
<p>2
n
</p>
<p>)
</p>
<p>.</p>
<p/>
</div>
<div class="page"><p/>
<p>170 8 Probability Distributions
</p>
<p>In general, it cannot be taken for granted that the sum of two random variables
</p>
<p>follows the same distribution as the two variables themselves. As an example, con-
</p>
<p>sider the sum of two independent uniform distributions with X1 &sim; U [0, 10] and
X2 &sim; U [20, 30]. It holds that E(X1 + X2) = E(X1)+ E(X2) and Var(X1 + X2) =
Var(X1)+ Var(X2), but X1 + X2 is obviously not uniformly distributed.
</p>
<p>8.2.3 Exponential Distribution
</p>
<p>The exponential distribution is useful in many situations, for example when one is
</p>
<p>interested in the waiting time, or lifetime, until an event of interest occurs. If we
</p>
<p>assume that the future lifetime is independent of the lifetime that has already taken
</p>
<p>place (i.e. no &ldquo;ageing&rdquo; process is working), the waiting times can be considered to
</p>
<p>be exponentially distributed.
</p>
<p>Definition 8.2.3 A random variable X is said to follow an exponential distribution
</p>
<p>with parameter λ &gt; 0 if its PDF is given by
</p>
<p>f (x) =
{
</p>
<p>λ exp(&minus;λx) if x &ge; 0
0 otherwise.
</p>
<p>(8.23)
</p>
<p>We write X &sim; Exp(λ). The mean and variance of an exponentially distributed ran-
dom variable X are
</p>
<p>E(X) =
1
</p>
<p>λ
and Var(X) =
</p>
<p>1
</p>
<p>λ2
,
</p>
<p>respectively. The CDF of the exponential distribution is given as
</p>
<p>F(x) =
{
</p>
<p>1 &minus; exp(&minus;λx) if x &ge; 0
0 otherwise.
</p>
<p>(8.24)
</p>
<p>Note, that P(X &gt; x) = 1 &minus; F(x) = exp(&minus;λx) (x &ge; 0). An interesting property of
the exponential distribution is its memorylessness: if time t has already been reached,
</p>
<p>the probability of reaching a time greater than t +∆ does not depend on t . This can
be written as
</p>
<p>P(X &gt; t +∆|X &gt; t) = P(X &gt; ∆) t,∆ &gt; 0.
</p>
<p>The result can be derived using basic probability rules as follows:
</p>
<p>P(X &gt; t +∆|X &gt; t) =
P(X &gt; t +∆ and X &gt; t)
</p>
<p>P(X &gt; t)
=
</p>
<p>P(X &gt; t +∆)
P(X &gt; t)
</p>
<p>=
exp[&minus;λ(t +∆)]
</p>
<p>exp[&minus;λt]
= exp[&minus;λ∆]
</p>
<p>= 1 &minus; F(∆) = P(X &gt; ∆).
</p>
<p>For example, suppose someone stands in a supermarket queue for t minutes. Say
</p>
<p>the person forgot to buy milk, so she leaves the queue, gets the milk, and stands in
</p>
<p>the queue again. If we use the exponential distribution to model the waiting time,
</p>
<p>we say that it does not matter what time it is: the random variable &ldquo;waiting time
</p>
<p>from standing in the queue until paying the bill&rdquo; is not influenced by how much</p>
<p/>
</div>
<div class="page"><p/>
<p>8.2 Standard Continuous Distributions 171
</p>
<p>time has elapsed already; it does not matter if we queued before or not. Please note
</p>
<p>that the memorylessness property is shared by the geometric and the exponential
</p>
<p>distributions.
</p>
<p>There is also a relationship between the Poisson and the exponential distribution:
</p>
<p>Theorem 8.2.1 The number of events Y occurring within a continuum of time is
</p>
<p>Poisson distributed with parameter λ if and only if the time between two events is
</p>
<p>exponentially distributed with parameter λ.
</p>
<p>The continuum of time depends on the problem at hand. It may be a second, a minute,
</p>
<p>3 months, a year, or any other time period.
</p>
<p>Example 8.2.4 Let Y be the random variable which counts the &ldquo;number of accesses
</p>
<p>per second for a search engine&rdquo;. Assume that Y is Poisson distributed with parameter
</p>
<p>λ = 10 (E(Y ) = 10,Var(Y ) = 10). The random variable X , &ldquo;waiting time until the
next access&rdquo;, is then exponentially distributed with parameter λ = 10. We therefore
get
</p>
<p>E(X) =
1
</p>
<p>10
, Var(X) =
</p>
<p>1
</p>
<p>102
.
</p>
<p>In this example, the continuum is 1 s. The expected number of accesses per second
</p>
<p>is therefore E(Y ) = 10, and the expected waiting time between two accesses is
E(X) = 1/10 s. The probability of experiencing a waiting time of less than 0.1 s is
</p>
<p>F(0.1) = 1 &minus; exp(&minus;λx) = 1 &minus; exp(&minus;10 &middot; 0.1) &asymp; 0.63.
In R, we can obtain the same result as
</p>
<p>pexp(0.1,10)
</p>
<p>[1] 0.6321206
</p>
<p>8.3 Sampling Distributions
</p>
<p>All the distributions introduced in this chapter up to now are motivated by practical
</p>
<p>applications. However, there are theoretical distributions which play an important
</p>
<p>role in the construction and development of various statistical tools such as those
</p>
<p>introduced in Chaps. 9&ndash;11. We call these distributions &ldquo;sampling distributions&rdquo;. Now,
</p>
<p>we discuss the χ2-, t-, and F-distributions.
</p>
<p>8.3.1 χ2-Distribution
</p>
<p>Definition 8.3.1 Let Z1, Z2 . . . , Zn be n independent and identically N (0, 1)-
</p>
<p>distributed random variables. The sum of their squares,
&sum;n
</p>
<p>i=1 Z
2
i , is then χ
</p>
<p>2-
</p>
<p>distributed with n degrees of freedom and is denoted as χ2n . The PDF of the χ
2-
</p>
<p>distribution is given in Eq. (C.7) in Appendix C.3.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>172 8 Probability Distributions
</p>
<p>The χ2-distribution is not symmetric. A χ2-distributed random variable can only
</p>
<p>realize values greater than or equal to zero. Figure 8.7a shows the χ21-, χ
2
2-, and
</p>
<p>χ25-distributions. It can be seen that the &ldquo;degrees of freedom&rdquo; specify the shape of
</p>
<p>the distribution. Their interpretation and meaning will nevertheless become clearer
</p>
<p>in the following chapters. The quantiles of the CDF of different χ2-distributions can
</p>
<p>be obtained in R using the qchisq(p,df) command. They are also listed in Table
</p>
<p>C.3 for different values of n.
</p>
<p>Theorem 8.3.1 Consider two independent random variables which areχ2m- andχ
2
n-
</p>
<p>distributed, respectively. The sum of these two random variables isχ2n+m-distributed.
</p>
<p>An important example of a χ2-distributed random variable is the sample variance
</p>
<p>(S2X ) of an i.i.d. sample of size n from a normally distributed population, i.e.
</p>
<p>(n &minus; 1)S2X
σ2
</p>
<p>&sim; χ2n&minus;1. (8.25)
</p>
<p>8.3.2 t-Distribution
</p>
<p>Definition 8.3.2 Let X and Y be two independent random variables where X &sim;
N (0, 1) and Y &sim; χ2n . The ratio
</p>
<p>X
&radic;
</p>
<p>Y/n
&sim; tn
</p>
<p>follows a t-distribution (Student&rsquo;s t-distribution) with n degrees of freedom. The
</p>
<p>PDF of the t-distribution is given in Eq. (C.8) in Appendix C.3.
</p>
<p>Figure 8.7b visualizes the t1-, t5-, and t30-distributions. The quantiles of different
</p>
<p>t-distributions can be obtained in R using the qt(p,df) command. They are also
</p>
<p>listed in Table C.2 for different values of n.
</p>
<p>An application of the t-distribution is the following: if we draw a sample of size
</p>
<p>n from a normal population N (&micro;,σ2) and calculate the arithmetic mean X̄ and the
</p>
<p>sample variance S2X , then the following theorem holds:
</p>
<p>Theorem 8.3.2 (Student&rsquo;s theorem) Let X = (X1, X2, . . . , Xn) with X i
i id.&sim; N
</p>
<p>(&micro;,σ2). The ratio
</p>
<p>(X̄ &minus; &micro;)
&radic;
</p>
<p>n
</p>
<p>SX
=
</p>
<p>(X̄ &minus; &micro;)
&radic;
</p>
<p>n
&radic;
</p>
<p>1
n&minus;1
</p>
<p>&sum;n
i+1(X i &minus; X̄)2
</p>
<p>&sim; tn&minus;1 (8.26)
</p>
<p>is then t-distributed with n &minus; 1 degrees of freedom.</p>
<p/>
</div>
<div class="page"><p/>
<p>8.3 Sampling Distributions 173
</p>
<p>0 1 2 3 4
0
</p>
<p>2
</p>
<p>χ2
1
</p>
<p>χ2
2
</p>
<p>χ2
5
</p>
<p>x
</p>
<p>f(x)
</p>
<p>(a) χ2 distributions
</p>
<p>-2 -1 0 1 2
0
</p>
<p>0.5
</p>
<p>t1
</p>
<p>t5
</p>
<p>t30
</p>
<p>x
</p>
<p>f(x)
</p>
<p>(b) t distributions
</p>
<p>Fig. 8.7 Probability density functions of χ2 and t distributions&lowast;
</p>
<p>8.3.3 F-Distribution
</p>
<p>Definition 8.3.3 Let X and Y be independent χ2m and χ
2
n-distributed random vari-
</p>
<p>ables, then the distribution of the ratio
</p>
<p>X/m
</p>
<p>Y/n
&sim; Fm,n (8.27)
</p>
<p>follows the Fisher F-distribution with (m, n) degrees of freedom. The PDF of the
</p>
<p>F-distribution is given in Eq. (C.9) in Appendix C.3.
</p>
<p>If X is a χ21-distributed random variable, then the ratio (8.27) is F1,n-distributed.
</p>
<p>The square root of this ratio is tn-distributed since the square root of a χ
2
1-distributed
</p>
<p>random variable is N (0, 1)-distributed. If W is F-distributed, Fm,n , then 1/W is
</p>
<p>Fn,m-distributed. Figure 8.8 visualizes the F5,5, F5,10 and F5,30 distributions. The
</p>
<p>Fig. 8.8 Probability density
</p>
<p>functions for different
</p>
<p>F-distributions&lowast;
</p>
<p>0 1 2 3 4
0
</p>
<p>1
</p>
<p>F5,5
</p>
<p>F5,10
</p>
<p>F5,30
</p>
<p>x
</p>
<p>f(x)</p>
<p/>
</div>
<div class="page"><p/>
<p>174 8 Probability Distributions
</p>
<p>quantiles of different F-distributions can be obtained in R using the qf(p,df1,df2)
</p>
<p>command.
</p>
<p>One application of the F-distribution relates to the ratio of two sample variances of
</p>
<p>two independent samples of size m and n, where each sample is an i.i.d. sample from
</p>
<p>a normal population, i.e. N (&micro;X ,σ
2) and N (&micro;Y ,σ
</p>
<p>2). For the sample variances S2X =
1
</p>
<p>m&minus;1
&sum;m
</p>
<p>i=1(X i &minus; X̄)2 and S2Y =
1
</p>
<p>n&minus;1
&sum;n
</p>
<p>i=1(Yi &minus; Ȳ )2 from the two populations, the
ratio
</p>
<p>S2X
</p>
<p>S2Y
&sim; Fm&minus;1,n&minus;1
</p>
<p>is F-distributed with (m &minus; 1) degrees of freedom in the numerator and (n &minus; 1)
degrees of freedom in the denominator.
</p>
<p>8.4 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� Examples of different distributions are:
</p>
<p>Distribution Example
</p>
<p>Uniform Rolling a die (discrete)
</p>
<p>Waiting for a train (continuous)
</p>
<p>Bernoulli Any binary variable such as gender
</p>
<p>Binomial Number of &ldquo;heads&rdquo; when tossing a coin n times
</p>
<p>Poisson Number of particles emitted by a radioactive source
</p>
<p>entering a small area in a given time interval
</p>
<p>Multinomial Categorical variables such as &ldquo;party voted for&rdquo;
</p>
<p>Geometric Number of raffle tickets until first ticket wins
</p>
<p>Hypergeometric National lotteries; Fisher&rsquo;s test, see p. 428
</p>
<p>Normal Height or weight of women (men)
</p>
<p>Exponential Survival time of a PC
</p>
<p>χ2 Sample variance; χ2 tests, see p. 235 ff
</p>
<p>t Confidence interval for the mean, see p. 197
</p>
<p>F Tests in the linear model, see p. 272</p>
<p/>
</div>
<div class="page"><p/>
<p>8.4 Key Points and Further Issues 175
</p>
<p>Note:
</p>
<p>� One can use R to determine values of densities (PDF/PMF), cumula-
</p>
<p>tive probability distribution functions (CDF), quantiles of the CDF, and
</p>
<p>random numbers:
</p>
<p>First letter Function Further letters Example
</p>
<p>d Density distribution name dnorm
</p>
<p>p Probability distribution name pnorm
</p>
<p>q Quantiles distribution name qnorm
</p>
<p>r Random number distribution name rnorm
</p>
<p>We encourage the use of R to obtain quantiles of sampling distributions,
</p>
<p>but Tables C.1&ndash;C.3 also list some of them.
</p>
<p>� In this chapter, we assumed the parameters such as &micro;,σ,λ, and others to
</p>
<p>be known. In Chap. 9, we will propose how to estimate these parameters
</p>
<p>from the data. In Chap. 10, we test statistical hypotheses about these
</p>
<p>parameters.
</p>
<p>� For n i.i.d. random variables X1, X2, . . . , Xn , the arithmetic mean X̄
</p>
<p>converges to a N (&micro;,σ2/n) distribution as n tends to infinity. See Appen-
</p>
<p>dix C.3 as well as Exercise 8.11 for the Theorem of Large Numbers and
</p>
<p>the Central Limit Theorem, respectively.
</p>
<p>8.5 Exercises
</p>
<p>Exercise 8.1 A company producing cereals offers a toy in every sixth cereal package
</p>
<p>in celebration of their 50th anniversary. A father immediately buys 20 packages.
</p>
<p>(a) What is the probability of finding 4 toys in the 20 packages?
</p>
<p>(b) What is the probability of finding no toy at all?
</p>
<p>(c) The packages contain three toys. What is the probability that among the 5 pack-
</p>
<p>ages that are given to the family&rsquo;s youngest daughter, she finds two toys?
</p>
<p>Exercise 8.2 A study on breeding birds collects information such as the length of
</p>
<p>their eggs (in mm). Assume that the length is normally distributed with&micro; = 42.1 mm
and σ2 = 20.82. What is the probability of
</p>
<p>(a) finding an egg with a length greater than 50 mm?
</p>
<p>(b) finding an egg between 30 and 40 mm in length?
</p>
<p>Calculate the results both manually and by using R.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>176 8 Probability Distributions
</p>
<p>Exercise 8.3 A dodecahedron is a die with 12 sides. Suppose the numbers on the die
</p>
<p>are 1&ndash;12. Consider the random variable X which describes which number is shown
</p>
<p>after rolling the die once. What is the distribution of X? Determine E(X) and Var(X).
</p>
<p>Exercise 8.4 Felix states that he is able to distinguish a freshly ground coffee blend
</p>
<p>from an ordinary supermarket coffee. One of his friends asks him to taste 10 cups
</p>
<p>of coffee and tell him which coffee he has tasted. Suppose that Felix has actually no
</p>
<p>clue about coffee and simply guesses the brand. What is the probability of at least 8
</p>
<p>correct guesses?
</p>
<p>Exercise 8.5 An advertising board is illuminated by several hundred bulbs. Some
</p>
<p>of the bulbs are fused or smashed regularly. If there are more than 5 fused bulbs on
</p>
<p>a day, the owner of the board replaces them, otherwise not. Consider the following
</p>
<p>data collected over a month which captures the number of days (ni ) on which i bulbs
</p>
<p>were broken:
</p>
<p>Fused bulbs 0 1 2 3 4 5
</p>
<p>ni 6 8 8 5 2 1
</p>
<p>(a) Suggest an appropriate distribution for X : &ldquo;number of broken bulbs per day&rdquo;.
</p>
<p>(b) What is the average number of broken bulbs per day? What is the variance?
</p>
<p>(c) Determine the probabilities P(X = x) using the distribution you chose in (a)
and using the average number of broken bulbs you calculated in (b). Compare
</p>
<p>the probabilities with the proportions obtained from the data.
</p>
<p>(d) Calculate the probability that at least 6 bulbs are fused, which means they need
</p>
<p>to be replaced.
</p>
<p>(e) Consider the random variable Y : &ldquo;time until next bulb breaks&rdquo;. What is the
</p>
<p>distribution of Y ?
</p>
<p>(f) Calculate and interpret E(Y ).
</p>
<p>Exercise 8.6 Marco&rsquo;s company organizes a raffle at an end-of-year function. There
</p>
<p>are 4000 raffle tickets to be sold, of which 500 win a prize. The price of each ticket
</p>
<p>is e1.50. The value of the prizes, which are mostly electrical appliances produced
</p>
<p>by the company, varies between e80 and e250, with an average value of e142.
</p>
<p>(a) Marco wants to have a 99 % guarantee of receiving three prizes. How much
</p>
<p>money does he need to spend? Use R to solve the question.
</p>
<p>(b) Use R to plot the function which describes the relationship between the number
</p>
<p>of tickets bought and the probability of winning at least three prizes.
</p>
<p>(c) Given the value of the prizes and the costs of the tickets, is it worth taking part
</p>
<p>in the raffle?</p>
<p/>
</div>
<div class="page"><p/>
<p>8.5 Exercises 177
</p>
<p>Exercise 8.7 A country has a ratio between male and female births of 1.05 which
</p>
<p>means that 51.22 % of babies born are male.
</p>
<p>(a) What is the probability for a mother that the first girl is born during the first three
</p>
<p>births?
</p>
<p>(b) What is the probability of getting 2 girls among 4 babies?
</p>
<p>Exercise 8.8 A fishermen catches, on average, three fish in an hour. Let Y be a
</p>
<p>random variable denoting the number of fish caught in one hour and let X be the
</p>
<p>time interval between catching two fishes. We assume that X follows an exponential
</p>
<p>distribution.
</p>
<p>(a) What is the distribution of Y ?
</p>
<p>(b) Determine E(Y ) and E(X).
</p>
<p>(c) Calculate P(Y = 5) and P(Y &lt; 1).
</p>
<p>Exercise 8.9 A restaurant sells three different types of dessert: chocolate, brownies,
</p>
<p>yogurt with seasonal fruits, and lemon tart. Years of experience have shown that the
</p>
<p>probabilities with which the desserts are chosen are 0.2, 0.3, and 0.5, respectively.
</p>
<p>(a) What is the probability that out of 5 guests, 2 guests choose brownies, 1 guest
</p>
<p>chooses yogurt, and the remaining 2 guests choose lemon tart?
</p>
<p>(b) Suppose two out of the five guests are known to always choose lemon tart. What
</p>
<p>is the probability of the others choosing lemon tart as well?
</p>
<p>(c) Determine the expectation and variance assuming a group of 20 guests.
</p>
<p>Exercise 8.10 A reinsurance company works on a premium policy for natural disas-
</p>
<p>ters. Based on experience, it is known that W = &ldquo;number of natural disasters from
October to March&rdquo; (winter) is Poisson distributed with λW = 4. Similarly, the ran-
dom variable S = &ldquo;number of natural disasters from April to September&rdquo; (summer)
is Poisson distributed with λS = 3. Determine the probability that there is at least 1
disaster during both summer and winter based on the assumption that the two random
</p>
<p>variables are independent.
</p>
<p>Exercise 8.11 Read Appendix C.3 to learn about the Theorem of Large Numbers
</p>
<p>and the Central Limit Theorem.
</p>
<p>(a) Draw 1000 realizations from a standard normal distribution using R and calculate
</p>
<p>the arithmetic mean. Repeat this process 1000 times. Evaluate the distribution
</p>
<p>of the arithmetic mean by drawing a kernel density plot and by calculating the
</p>
<p>mean and variance of it.</p>
<p/>
</div>
<div class="page"><p/>
<p>178 8 Probability Distributions
</p>
<p>(b) Repeat the procedure in (a) with an exponential distribution withλ = 1. Interpret
your findings in the light of the Central Limit Theorem.
</p>
<p>(c) Repeat the procedure in (b) using 10,000 rather than 1000 realizations. How do
</p>
<p>the results change and why?
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 375
</p>
<p>&lowast;Source Toutenburg, H., Heumann, C., Induktive Statistik, 4th edition, 2007,
Springer, Heidelberg</p>
<p/>
</div>
<div class="page"><p/>
<p>Part III
</p>
<p>Inductive Statistics</p>
<p/>
</div>
<div class="page"><p/>
<p>9Inference
</p>
<p>9.1 Introduction
</p>
<p>The first four chapters of this book illustrated how one can summarize a data set
</p>
<p>both numerically and graphically. The validity of interpretations made from such
</p>
<p>a descriptive analysis is valid only for the data set under consideration and cannot
</p>
<p>necessarily be generalized to other data. However, it is desirable to make conclusions
</p>
<p>about the entire population of interest and not only about the sample data. In this
</p>
<p>chapter, we describe the framework of statistical inference which allows us to
</p>
<p>infer from the sample data about the population of interest&ndash;at a given, prespecified
</p>
<p>uncertainty level&ndash;and knowledge about the random process generating the data.
</p>
<p>Consider an example where the objective is to forecast an election outcome.
</p>
<p>This requires us to determine the proportion of votes that each of the k participating
</p>
<p>parties is going to receive, i.e. to calculate or estimate p1, p2, . . . , pk . If it is possible
</p>
<p>to ask every voter about their party preference, then one can simply calculate the
</p>
<p>proportions p1, p2, . . . , pk for each party. However, it is logistically impossible to
</p>
<p>ask all eligible voters (which form the population in this case) about their preferred
</p>
<p>party. It seems more realistic to ask only a small fraction of voters and infer from
</p>
<p>their responses to the responses of the whole population. It is evident that there might
</p>
<p>be differences in responses between the sample and the population&mdash;but the more
</p>
<p>voters are asked, the closer we are to the population&rsquo;s preference, i.e. the higher
</p>
<p>the precision of our estimates for p1, p2, . . . , pk (the meaning of &ldquo;precision&rdquo; will
</p>
<p>become clearer later in this chapter). Also, it is intuitively clear that the sample must
</p>
<p>be a representative sample of the voters&rsquo; population to avoid any discrepancy or bias
</p>
<p>in the forecasting. When we speak of a representative sample, we mean that all the
</p>
<p>characteristics present in the population are contained in the sample too. There are
</p>
<p>many ways to get representative random samples. In fact, there is a branch of statistics,
</p>
<p>called sampling theory, which studies this subject [see, e.g. Groves et al. (2009) or
</p>
<p>Kauermann and K&uuml;chenhoff (2011) for more details]. A simple random sample is
</p>
<p>one where each voter has an equal probability of being selected in the sample and
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_9
</p>
<p>181</p>
<p/>
</div>
<div class="page"><p/>
<p>182 9 Inference
</p>
<p>each voter is independently chosen from the same population. In the following, we
</p>
<p>will assume that all samples are simple random samples. To further formalize the
</p>
<p>election forecast problem, assume that we are interested in the true proportions which
</p>
<p>each party receives on the election day. It is practically impossible to make a perfect
</p>
<p>prediction of these proportions because there are too many voters to interview, and
</p>
<p>moreover, a voter may possibly make their final decision possibly only when casting
</p>
<p>the vote and not before. The voter may change his/her opinion at any moment and may
</p>
<p>differ from what he/she claimed earlier. In statistics, we call these true proportions
</p>
<p>parameters of the population. The task is then to estimate these parameters on the
</p>
<p>basis of a sample. In the election example, the intuitive estimates for the proportions
</p>
<p>in the population are the proportions in the sample and we call them sample estimates.
</p>
<p>How to find good and precise estimates are some of the challenges that are addressed
</p>
<p>by the concept of statistical inference. Now, it is possible to describe the election
</p>
<p>forecast problem in a statistical and operational framework: estimate the parameters
</p>
<p>of a population by calculating the sample estimates. An important property of every
</p>
<p>good statistical inference procedure is that it provides not only estimates for the
</p>
<p>population parameters but also information about the precision of these estimates.
</p>
<p>Consider another example in which we would like to study the distribution of
</p>
<p>weight of children in different age categories and get an understanding of the &ldquo;nor-
</p>
<p>mal&rdquo; weight. Again, it is not possible to measure the weight of all the children of
</p>
<p>a specific age in the entire population of children in a particular country. Instead,
</p>
<p>we draw a random sample and use methods of statistical inference to estimate the
</p>
<p>weight of children in each age group. More specifically, we have several populations
</p>
<p>in this problem. We could consider all boys of a specific age and all girls of a spe-
</p>
<p>cific age as two different populations. For example, all 3-year-old boys will form
</p>
<p>one possible population. Then, a random sample is drawn from this population. It is
</p>
<p>reasonable to assume that the distribution of the weight of k-year-old boys follows a
</p>
<p>normal distribution with some unknown parameters μkb and σ
2
kb. Similarly, another
</p>
<p>population of k-year-old girls is assumed to follow a normal distribution with some
</p>
<p>unknown parameters μkg and σ
2
kg . The indices kb and kg are used to emphasize
</p>
<p>that the parameters may vary by age and gender. The task is now to calculate the
</p>
<p>estimates of the unknown parameters (in the population) of the normal distributions
</p>
<p>from the samples. Using quantiles, a range of &ldquo;normal&rdquo; weights can then be specified,
</p>
<p>e.g. the interval from the 1 % quantile to the 99 % quantile of the estimated normal
</p>
<p>distribution or, alternatively, all weights which are not more than twice the standard
</p>
<p>deviation away from the mean. Children with weights outside this interval may be
</p>
<p>categorized as underweight or overweight. Note that we make a specific assumption
</p>
<p>for the distribution class; i.e. we assume a normal distribution for the weights and
</p>
<p>estimate its parameters. We call this a parametric estimation problem because it is
</p>
<p>based on distributional assumptions. Otherwise, if no distributional assumptions are
</p>
<p>made, we speak of a nonparametric estimation problem.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 Properties of Point Estimators 183
</p>
<p>9.2 Properties of Point Estimators
</p>
<p>As we discussed in the introduction, the primary goal in statistical inference is to find
</p>
<p>a good estimate of (a) population parameter(s). The parameters are associated with
</p>
<p>the probability distribution which is believed to characterize the population; e.g. μ
</p>
<p>and σ2 are the parameters in a normal distribution N (μ,σ2). If these parameters are
</p>
<p>known, then one can characterize the entire population. In practice, these parameters
</p>
<p>are unknown, so the objective is to estimate them. One can attempt to obtain them
</p>
<p>based on a function of the sample values. But what does this function look like; and
</p>
<p>if there is more than one such function, then which is the best one? What is the best
</p>
<p>approach to estimate the population parameters on the basis of a given sample of
</p>
<p>data? The answer is given by various statistical concepts such as bias, variability,
</p>
<p>consistency, efficiency, sufficiency, and completeness of the estimates. We are going
</p>
<p>to introduce them now.
</p>
<p>Assume x = (x1, x2 . . . , xn) are the observations of a random sample from a pop-
ulation of interest. The random sample represents the realized values of a random
</p>
<p>variable X . It can be said that x1, x2 . . . , xn are the n observations collected on the
</p>
<p>random variable X . Any function of random variables is called a statistic. For exam-
</p>
<p>ple, X̄ = 1
n
</p>
<p>&sum;n
i=1 X i , max(X1, X2, . . . , Xn) etc. are functions of X1, X2, . . . , Xn ,
</p>
<p>so they are a statistic. It follows that a statistic is also a random variable. Consider
</p>
<p>a statistic T (X) which is used to estimate a population parameter θ (which may be
</p>
<p>either a scalar or a vector). We say T (X) is an estimator of θ. To indicate that we
</p>
<p>estimate θ using T (X), we use the &ldquo;hat&rdquo; ( ˆ ) symbol, i.e. we write θ̂ = T (X). When
T is calculated from the sample values x1, x2 . . . , xn , we write T (x) and call it an
</p>
<p>estimate of θ. It becomes clear that T (X) is a random variable but T (x) is its observed
</p>
<p>value (dependent on the actual sample). For example, T (X) = X̄ = 1
n
</p>
<p>&sum;n
i=1 X i is
</p>
<p>an estimator and a statistic, but T (x) = x̄ = 1
n
</p>
<p>&sum;n
i=1 xi is its estimated value from
</p>
<p>the realized sample values x1, x2, . . . , xn . Since the sample values are realizations
</p>
<p>from a random variable, each sample leads to a different value of the estimate of
</p>
<p>the population parameter. The population parameter is assumed to be a fixed value.
</p>
<p>Parameters can also be assumed to be random, for example in Bayesian statistics,
</p>
<p>but this is beyond the scope of this book.
</p>
<p>9.2.1 Unbiasedness and Efficiency
</p>
<p>Definition 9.2.1 An estimator T (X) is called an unbiased estimator of θ if
</p>
<p>Eθ(T (X)) = θ . (9.1)
The index θ denotes that the expectation is calculated with respect to the distribution
</p>
<p>whose parameter is θ.</p>
<p/>
</div>
<div class="page"><p/>
<p>184 9 Inference
</p>
<p>The bias of an estimator T (X) is defined as
</p>
<p>Biasθ(T (X)) = Eθ(T (X))&minus; θ . (9.2)
It follows that an estimator is said to be unbiased if its bias is zero.
</p>
<p>Definition 9.2.2 The variance of T (X) is defined as
</p>
<p>Varθ(T (X)) = E
{
[T (X)&minus; E(T (X))]2
</p>
<p>}
. (9.3)
</p>
<p>Both bias and variance are measures which characterize the properties of an esti-
</p>
<p>mator. In statistical theory, we search for &ldquo;good&rdquo; estimators in the sense that the bias
</p>
<p>and the variance are as small as possible and therefore the accuracy is as high as
</p>
<p>possible. Readers interested in a practical example may consult Examples 9.2.1 and
</p>
<p>9.2.2, or the explanations for Fig. 9.1.
</p>
<p>It turns out that we cannot minimize both measures simultaneously as there is
</p>
<p>always a so-called bias&ndash;variance tradeoff. A measure which combines bias and vari-
</p>
<p>ance into one measure is the mean squared error.
</p>
<p>Definition 9.2.3 The mean squared error (MSE) of T (X) is defined as
</p>
<p>MSEθ(T (X)) = E
{
[T (X)&minus; θ]2
</p>
<p>}
. (9.4)
</p>
<p>The expression (9.4) can be partitioned into two parts: the variance and the squared
</p>
<p>bias, i.e.
</p>
<p>MSEθ(T (X)) = Varθ(T (X))+ [Biasθ(T (X))]2 . (9.5)
This can be proven as follows:
</p>
<p>MSEθ(T (X)) = E[T (X)&minus; θ]2
</p>
<p>= E[(T (X)&minus; Eθ(T (X))+ (Eθ(T (X)&minus; θ)]2
</p>
<p>= E[T (X)&minus; Eθ(T (X))]2 + [Eθ(T (X))&minus; θ]2
</p>
<p>= Varθ(T (X))+ [Biasθ(T (X))]2 .
</p>
<p>Note that the calculation is based on the result that the cross product term is zero.
</p>
<p>The mean squared error can be used to compare different biased estimators.
</p>
<p>Definition 9.2.4 An estimator T1(X) is said to be MSE-better than another estimator
</p>
<p>T2(X) for estimating θ if
</p>
<p>MSEθ(T1(X)) &lt; MSEθ(T2(X)) ,
</p>
<p>where θ &isin; Θ and Θ is the parameter space, i.e. the set of all possible values of θ.
Often, Θ is R or all positive real values R+. For example, for a normal distribution,
N (μ,σ2), μ can be any real value and σ2 has to be a number greater than zero.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 Properties of Point Estimators 185
</p>
<p>Unfortunately, we cannot find an MSE-optimal estimator in the sense that an
</p>
<p>estimator is MSE-better than all other possible estimators for all possible values of
</p>
<p>θ. This becomes clear if we define the constant estimator T (x) = c (independent
of the actual sample): if θ = c, i.e. if the constant value equals the true population
parameter we want to estimate, then the MSE of this constant estimator is zero
</p>
<p>(but it will be greater than zero for all other values of θ, and the bias increases
</p>
<p>more as we move c far away from the true θ). Usually, we can only find estimators
</p>
<p>which are locally best (in a certain subset of Θ). This is why classical statistical
</p>
<p>inference restricts the search for best estimators to the class of unbiased estimators.
</p>
<p>For unbiased estimators, the MSE is equal to the variance of an estimator. In this
</p>
<p>context, the following definition is used for comparing two (unbiased) estimators.
</p>
<p>Definition 9.2.5 An unbiased estimator T1(X) is said to be more efficient than
</p>
<p>another unbiased estimator T2(X) for estimating θ if
</p>
<p>Varθ(T1(X)) &le; Varθ(T2(X)) , &forall;θ &isin; Θ ,
and
</p>
<p>Varθ(T1(X)) &lt; Varθ(T2(X))
</p>
<p>for at least one θ &isin; Θ . It turns out that restricting our search of best estimators to
unbiased estimators is sometimes a successful strategy; i.e. for many problems, a
</p>
<p>best or most efficient estimate can be found. If such an estimator exists, it is said to
</p>
<p>be UMVU (uniformly minimum variance unbiased). Uniformly means that it has the
</p>
<p>lowest variance among all other unbiased estimators for estimating the population
</p>
<p>parameter(s) θ.
</p>
<p>Consider the illustration in Fig. 9.1 to better understand the introduced concepts.
</p>
<p>Suppose we throw three darts at a target and the goal is to hit the centre of the target,
</p>
<p>i.e. the innermost circle of the dart board. The centre represents the population
</p>
<p>parameter θ. The three darts play the role of three estimates θ̂1, θ̂2, θ̂3 (based on
</p>
<p>different realizations of the sample) of the population parameter θ. Four possible
</p>
<p>situations are illustrated in Fig. 9.1. For example, in Fig. 9.1b, we illustrate the case
</p>
<p>of an estimator which is biased but has low variance: all three darts are &ldquo;far&rdquo; away
</p>
<p>from the centre of the target, but they are &ldquo;close&rdquo; together. If we look at Fig. 9.1a, c,
</p>
<p>we see that all three darts are symmetrically grouped around the centre of the target,
</p>
<p>meaning that there is no bias; however, in Fig. 9.1a there is much higher precision
</p>
<p>than in Fig. 9.1c. It is obvious that Fig. 9.1a presents an ideal situation: an estimator
</p>
<p>which is unbiased and has minimum variance.
</p>
<p>Theorem 9.2.1 Let X = (X1, X2 . . . , Xn) be an i.i.d. (random) sample of a random
variable X with population mean E(X i ) = μ and population variance V ar(X i ) =
σ2, for all i = 1, 2, . . . , n. Then the arithmetic mean X̄ =
</p>
<p>&sum;n
i=1 X i is an unbiased
</p>
<p>estimator of μ and the sample variance S2 = 1
n&minus;1
</p>
<p>&sum;n
i=1(X i &minus; X̄)2 is an unbiased
</p>
<p>estimator of σ2.</p>
<p/>
</div>
<div class="page"><p/>
<p>186 9 Inference
</p>
<p>Fig. 9.1 Illustration of bias and variance
</p>
<p>Note that the theorem holds, in general, for i.i.d. samples, irrespective of the choice
</p>
<p>of the distribution of the X i &rsquo;s. Note again that we are looking at the situation before
</p>
<p>we have any observations on X . Therefore, we again use capital letters to denote
</p>
<p>that the X i &rsquo;s are random variables which are not known beforehand (i.e. before we
</p>
<p>actually record the observations on our selected sampling units).
</p>
<p>Remark 9.2.1 The empirical variance S̃2 = 1
n
</p>
<p>&sum;n
i=1(X i &minus; X̄)2 is a biased estimate
</p>
<p>of σ2 and its bias is &minus; 1
n
σ2.
</p>
<p>Example 9.2.1 Let X1, X2 . . . , Xn be identically and independently distributed vari-
</p>
<p>ables whose population mean is μ and population variance is σ2. Then X̄ =
1
n
</p>
<p>&sum;n
i=1 X i is an unbiased estimator of μ. This can be shown as follows:
</p>
<p>E(X̄) = E
(
</p>
<p>1
</p>
<p>n
</p>
<p>n&sum;
</p>
<p>i=1
X i
</p>
<p>)
(7.29)= 1
</p>
<p>n
</p>
<p>n&sum;
</p>
<p>i=1
E(X i ) =
</p>
<p>1
</p>
<p>n
</p>
<p>n&sum;
</p>
<p>i=1
μ = μ.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 Properties of Point Estimators 187
</p>
<p>The variance of X̄ can be calculated as follows:
</p>
<p>Var(X̄) = 1
n2
</p>
<p>n&sum;
</p>
<p>i=1
Var(X i ) ,
</p>
<p>[
Cov(X i , X j ) = 0 using independence of X i &rsquo;s
</p>
<p>]
</p>
<p>= 1
n2
</p>
<p>n&sum;
</p>
<p>i=1
σ2 = σ
</p>
<p>2
</p>
<p>n
.
</p>
<p>We conclude that X̄ is an unbiased estimator ofμ and its variance is σ
2
</p>
<p>n
irrespective
</p>
<p>of the choice of the distribution of X . We have learned about the distribution of X̄
</p>
<p>already in Chap. 8, see also Appendix C.3 for the Theorem of Large Numbers and
</p>
<p>the Central Limit Theorem; however, we would like to highlight the property of
</p>
<p>&ldquo;unbiasedness&rdquo; in the current context.
</p>
<p>Now, we consider another example to illustrate that estimators may not always be
</p>
<p>unbiased but may have the same variance.
</p>
<p>Example 9.2.2 Let X1, X2 . . . , Xn be identically and independently distributed vari-
</p>
<p>ables whose population mean isμ and population variance is σ2. Then X̃ = X̄ + 1 =
1
n
</p>
<p>&sum;n
i=1(X i + 1) is a biased estimator of μ. This can be shown as follows:
</p>
<p>E(X̃)
(7.31)= E
</p>
<p>(
1
</p>
<p>n
</p>
<p>n&sum;
</p>
<p>i=1
X i
</p>
<p>)
+ E
</p>
<p>(
1
</p>
<p>n
</p>
<p>n&sum;
</p>
<p>i=1
1
</p>
<p>)
</p>
<p>(7.29)= 1
n
</p>
<p>n&sum;
</p>
<p>i=1
E(X i )+
</p>
<p>1
</p>
<p>n
&middot; n = 1
</p>
<p>n
</p>
<p>n&sum;
</p>
<p>i=1
μ+ 1
</p>
<p>= μ+ 1 �= μ .
However, the variance of X̃ is
</p>
<p>Var(X̃) = Var
(
X̄ + 1
</p>
<p>) (7.34)= Var(X̄) = σ
2
</p>
<p>n
.
</p>
<p>If we compare the two estimators X̃ = 1
n
</p>
<p>&sum;n
i=1(X i + 1) and X̄ = 1n
</p>
<p>&sum;n
i=1(X i ), we
</p>
<p>see that both have the same variance but the former (X̃) is biased. The efficiency
</p>
<p>of both estimators is thus the same. It further follows that the mean squared error
</p>
<p>of X̄ is smaller than the mean squared error of X̃ because the MSE consists of the
</p>
<p>sum of the variance and the squared bias. Therefore X̄ is MSE-better than X̃ . The
</p>
<p>comparison of bias, variance and MSE tells us that we should prefer X̄ over X̃ when
</p>
<p>estimating the population mean. This is intuitive, but the argument we make is a
</p>
<p>purely statistical one.
</p>
<p>Theorem 9.2.1 contains the following special cases:
</p>
<p>&bull; The sample mean X̄ = 1
n
</p>
<p>&sum;n
i=1 X i based on an i.i.d. random sample X1, X2, . . . ,
</p>
<p>Xn from a normally distributed population N (μ,σ
2) is an unbiased point estimator
</p>
<p>of μ.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>188 9 Inference
</p>
<p>&bull; The sample variance S2 = 1
n&minus;1
</p>
<p>&sum;n
i=1(X i &minus; X̄)2 based on an i.i.d. random sample
</p>
<p>X1, X2, . . . , Xn from a normally distributed population N (μ,σ
2) is an unbiased
</p>
<p>point estimator of σ2. The sample variance S̃2 = 1
n
</p>
<p>&sum;n
i=1(X i &minus; X̄)2 is a biased
</p>
<p>estimator for σ2, but it is asymptotically unbiased in the sense that its bias tends
</p>
<p>to zero as the sample size n tends to infinity.
</p>
<p>&bull; The sample mean X̄ = 1
n
</p>
<p>&sum;n
i=1 X i based on an i.i.d. random sample X1, X2, . . . ,
</p>
<p>Xn from a Bernoulli distributed population B(1, p) is an unbiased point estimator
</p>
<p>of the probability p.
</p>
<p>For illustration, we show the validity of the third statement. Let us consider an i.i.d.
</p>
<p>random sample X i , i = 1, 2 . . . , n, from a Bernoulli distribution, where X i = 1 if
an event occurs and X i = 0 otherwise. Here, p is the probability of occurrence of
an event in the population, i.e. p = P(X i = 1). Note that p is also the population
mean: E(X i ) = 1 &middot; p + 0 &middot; (1 &minus; p) = p, i = 1, 2, . . . , n. The arithmetic mean (rel-
ative frequency) is an unbiased estimator of p because
</p>
<p>E(X̄) = 1
n
</p>
<p>n&sum;
</p>
<p>i=1
E(X i ) =
</p>
<p>1
</p>
<p>n
</p>
<p>n&sum;
</p>
<p>i=1
p = p,
</p>
<p>and thus, we can write the estimate of p as
</p>
<p>p̂ = 1
n
</p>
<p>n&sum;
</p>
<p>i=1
X i . (9.6)
</p>
<p>Example 9.2.3 Suppose a random sample of size n = 20 of the weight of 10-year-
old children in a particular city is drawn. Let us assume that the children&rsquo;s weight
</p>
<p>in the population follows a normal distribution N (μ,σ2). The sample provides the
</p>
<p>following values of weights (in kg):
</p>
<p>40.2, 32.8, 38.2, 43.5, 47.6, 36.6, 38.4, 45.5, 44.4, 40.3
</p>
<p>34.6, 55.6, 50.9, 38.9, 37.8, 46.8, 43.6, 39.5, 49.9, 34.2
</p>
<p>To obtain an estimate of the population mean μ, we calculate the arithmetic mean of
</p>
<p>the observations as
</p>
<p>μ̂ = x̄ = 1
n
</p>
<p>n&sum;
</p>
<p>i=1
xi =
</p>
<p>1
</p>
<p>20
(40.2 + 32.8 + &middot; &middot; &middot; + 34.2) = 41.97,
</p>
<p>because it is an unbiased estimator of μ. Similarly, we use S2 to estimate σ2 because
</p>
<p>it is unbiased in comparison to S̃2. Using s2X as an estimate for σ
2 for the given
</p>
<p>observations, we get
</p>
<p>σ̂2 = s2x =
1
</p>
<p>n &minus; 1
</p>
<p>n&sum;
</p>
<p>i=1
(xi &minus; x̄)2
</p>
<p>= 1
19
</p>
<p>((40.2 &minus; 41.97)2 + &middot; &middot; &middot; + (34.2 &minus; 41.97)2) &asymp; 36.85.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 Properties of Point Estimators 189
</p>
<p>The square root of 36.85 is approximately 6.07 which is the standard deviation. Note
</p>
<p>that the standard deviation based on the sample values divided by the square root of
</p>
<p>the sample size, i.e. σ̂/
&radic;
</p>
<p>20, is called the standard error of the mean X̄ (SEM). As
</p>
<p>already introduced in Chap. 3, we obtain these results in R using the mean and var
</p>
<p>commands.
</p>
<p>Example 9.2.4 A library draws a random sample of size n = 100 members from the
members&rsquo; database to see how many members have to pay a penalty for returning
</p>
<p>books late, i.e. xi = 1. It turns out that 39 members in the sample have to pay a penalty.
Therefore, an unbiased estimator of the population proportion of all members of the
</p>
<p>library who return books late is
</p>
<p>p̂ = x̄ = 1
n
</p>
<p>n&sum;
</p>
<p>i=1
xi =
</p>
<p>1
</p>
<p>100
&middot; 39 = 39
</p>
<p>100
= 0.39.
</p>
<p>Remark 9.2.2 Unbiasedness and efficiency can also be defined asymptotically: we
</p>
<p>say, for example, that an estimator is asymptotically unbiased, if the bias approaches
</p>
<p>zero when the sample size tends to infinity. The concept of asymptotic efficiency
</p>
<p>involves some mathematical knowledge which is beyond the intended scope of
</p>
<p>this book. Loosely speaking, an asymptotic efficient estimator is an estimator
</p>
<p>which achieves the lowest possible (asymptotic) variance under given distribu-
</p>
<p>tional assumptions. The estimators introduced in Sect. 9.3.1, which are based on the
</p>
<p>maximum likelihood principle, have these properties (under certain mathematically
</p>
<p>defined regularity conditions).
</p>
<p>Next, we illustrate the properties of consistency and sufficiency of an estimator.
</p>
<p>9.2.2 Consistency of Estimators
</p>
<p>For a good estimator, as the sample size increases, the values of the estimator should
</p>
<p>get closer to the parameter being estimated. This property of estimators is referred
</p>
<p>to as consistency.
</p>
<p>Definition 9.2.6 Let T1, T2, . . . , Tn, be a sequence of estimators for the parameter
</p>
<p>θ where Tn = Tn(X1, X2, . . . , Xn) is a function of X1, X2, . . . , Xn . The sequence
{Tn} is a consistent sequence of estimators for θ if for every ǫ &gt; 0,
</p>
<p>lim
n&rarr;&infin;
</p>
<p>P [|Tn &minus; θ| &lt; ǫ] = 1
</p>
<p>or equivalently
</p>
<p>lim
n&rarr;&infin;
</p>
<p>P [|Tn &minus; θ| &ge; ǫ] = 0.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>190 9 Inference
</p>
<p>This definition says that as the sample size n increases, the probability that Tn is
</p>
<p>getting closer to θ is approaching 1. This means that the estimator Tn is getting
</p>
<p>closer to the parameter θ as n grows larger. Note that there is no information on how
</p>
<p>fast Tn is converging to θ in the sense of convergence defined above.
</p>
<p>Example 9.2.5 Let X1, X2 . . . , Xn be identically and independently distributed vari-
</p>
<p>ables with expectation μ and variance σ2. Then for X̄n = 1n
&sum;n
</p>
<p>i=1 X i , we have
E(X̄n) = μ and Var(X̄n) = σ2/n. For any ǫ &gt; 0, we can write the following:
</p>
<p>P
[
|X̄n &minus; μ| &ge; ǫ
</p>
<p>]
= P
</p>
<p>[
|X̄n &minus; μ| &ge;
</p>
<p>cσ&radic;
n
</p>
<p>]
</p>
<p>where ǫ = cσ/&radic;n. Using Tschebyschev&rsquo;s inequality (Theorem 7.4.1, p. 139), we
get 1
</p>
<p>c2
= σ2/nǫ2, and therefore
</p>
<p>P
</p>
<p>[
|X̄n &minus; μ| &ge;
</p>
<p>cσ&radic;
n
</p>
<p>]
&le; 1
</p>
<p>c2
= σ
</p>
<p>2
</p>
<p>nǫ2
</p>
<p>and
</p>
<p>lim
n&rarr;&infin;
</p>
<p>P
</p>
<p>[
|X̄n &minus; μ| &ge;
</p>
<p>cσ&radic;
n
</p>
<p>]
&le; lim
</p>
<p>n&rarr;&infin;
σ2
</p>
<p>nǫ2
= 0,
</p>
<p>provided σ2 is finite. Hence X̄n, n = 1, 2, . . . , converges to μ and therefore X̄n is a
consistent estimator of μ.
</p>
<p>Remark 9.2.3 We call this type of consistency weak consistency. Another definition
</p>
<p>is MSE consistency, which says that an estimator is MSE consistent if MSE &minus;&rarr; 0
as n &rarr; &infin;. If the estimator is unbiased, it is sufficient that Var &minus;&rarr; 0 as n &rarr; &infin;. If
Tn(X) is MSE consistent, it is also weakly consistent. Therefore, it follows that an
</p>
<p>unbiased estimator with its variance approaching zero as the sample size approaches
</p>
<p>infinity is both MSE consistent and weakly consistent.
</p>
<p>In Example 9.2.5, the variance of Tn(X) = X̄n is σ2/n which goes to zero as n
goes to &infin; and therefore X̄n is both weakly consistent and MSE consistent.
</p>
<p>9.2.3 Sufficiency of Estimators
</p>
<p>Sufficiency is another criterion to judge the quality of an estimator. Before delving
</p>
<p>deeper into the subject matter, we first try to understand some basic concepts.
</p>
<p>Consider two independent random variables X and Y , each following a N (μ, 1)
</p>
<p>distribution. We conclude that both X and Y contain information about μ. Consider
</p>
<p>two estimators of μ as μ̂1 = X + Y and μ̂2 = X &minus; Y . Suppose we want to know
whether to use μ̂1 or μ̂2 to estimate μ. We notice that E(μ̂1) = E(X)+ E(Y ) = μ+
μ = 2μ, E(μ̂2) = E(X)&minus; E(Y ) = μ&minus; μ = 0, Var(μ̂1) = Var(X)+ Var(Y ) = 1 +
1 = 2 and Var(μ̂2) = Var(X)+ Var(Y ) = 1 + 1 = 2. Using the additivity property
of the normal distribution, which was introduced in Remark 8.2.2, we can say that
</p>
<p>μ̂1 &sim; N (2μ, 2) and μ̂2 &sim; N (0, 2). So μ̂1 contains information about μ, whereas μ̂2</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>9.2 Properties of Point Estimators 191
</p>
<p>does not contain any information about μ. In other words, μ̂2 loses the information
</p>
<p>about μ. We call this property &ldquo;loss of information&rdquo;.
</p>
<p>If we want to make conclusions about μ using both X and Y , we need to acknowl-
</p>
<p>edge that the dimension of them is 2. On the other hand, if we use μ̂1 or equivalently
</p>
<p>μ̂1/2 &sim; N (μ, 12 ), then we need to concentrate only on one variable and we say that
it has dimension 1. It follows that μ̂1 and μ̂1/2 provide the same information about
</p>
<p>μ as provided by the entire sample on both X and Y . So we can say that either μ̂1
or μ̂1/2 is sufficient to provide the same information about μ that can be obtained
</p>
<p>on the basis of the entire sample. This is the idea behind the concept of sufficiency
</p>
<p>and it results in the reduction of dimension. In general, we can say that if all the
</p>
<p>information about μ contained in the sample of size n can be obtained, for example,
</p>
<p>through the sample mean then it is sufficient to use this one-dimensional summary
</p>
<p>statistic to make inference about μ.
</p>
<p>Definition 9.2.7 Let X1, X2, . . . , Xn be a random sample from a probability density
</p>
<p>function (or probability mass function) f (x, θ). A statistic T is said to be sufficient
</p>
<p>for θ if the conditional distribution of X1, X2, . . . , Xn given T = t is independent
of θ.
</p>
<p>The Neyman&ndash;Fisher Factorization Theorem provides a practical way to find suf-
</p>
<p>ficient statistics.
</p>
<p>Theorem 9.2.2 (Neyman&ndash;Fisher Factorization Theorem (NFFT)) Let X1, X2, . . . ,
</p>
<p>Xn be a random sample from a probability density function (or probability mass
</p>
<p>function) f (x, θ). A statistic T = T (x1, x2, . . . , xn) is said to be sufficient for θ if
and only if the joint density of X1, X2, . . . , Xn can be factorized as
</p>
<p>f (x1, x2, . . . , xn; θ) = g(t, θ) &middot; h(x1, x2, . . . , xn)
where h(x1, x2, . . . , xn) is nonnegative and does not involve θ; and g(t, θ) is a non-
</p>
<p>negative function of θ which depends on x1, x2, . . . , xn only through t, which is a
</p>
<p>particular value of T .
</p>
<p>This theorem holds for discrete random variables too. Any one-to-one function of
</p>
<p>a sufficient statistic is also sufficient. A function f is called one-to-one if whenever
</p>
<p>f (a) = f (b) then a = b.
</p>
<p>Example 9.2.6 Let X1, X2, . . . , Xn be a random sample from N (μ, 1) where μ is
</p>
<p>unknown. We attempt to find a sufficient statistic for μ. Consider the following
</p>
<p>function as the joint distribution of x1, x2, . . . , xn (whose interpretation will become
</p>
<p>clearer in the next section):
</p>
<p>f (x1, x2, . . . , xn;μ) =
(
</p>
<p>1&radic;
2π
</p>
<p>)n
exp
</p>
<p>(
&minus;1
</p>
<p>2
</p>
<p>n&sum;
</p>
<p>i=1
(xi &minus; μ)2
</p>
<p>)
</p>
<p>=
(
</p>
<p>1&radic;
2π
</p>
<p>)n
exp
</p>
<p>(
&minus;nμ
</p>
<p>2
</p>
<p>2
+ μ
</p>
<p>n&sum;
</p>
<p>i=1
xi
</p>
<p>)
exp
</p>
<p>(
&minus;1
</p>
<p>2
</p>
<p>n&sum;
</p>
<p>i=1
x2i
</p>
<p>)
.</p>
<p/>
</div>
<div class="page"><p/>
<p>192 9 Inference
</p>
<p>Here
</p>
<p>g(t,μ) =
(
</p>
<p>1&radic;
2π
</p>
<p>)n
exp
</p>
<p>(
&minus;nμ
</p>
<p>2
</p>
<p>2
+ μ
</p>
<p>n&sum;
</p>
<p>i=1
xi
</p>
<p>)
,
</p>
<p>h(x1, x2, . . . , xn) = exp
(
&minus;1
</p>
<p>2
</p>
<p>n&sum;
</p>
<p>i=1
x2i
</p>
<p>)
,
</p>
<p>t = t (x1, x2, . . . , xn) =
n&sum;
</p>
<p>i=1
xi .
</p>
<p>Using the Neyman&ndash;Fisher Factorization Theorem, we conclude that T = T (X1,
X2, . . . , Xn) =
</p>
<p>&sum;n
i=1 X i is a sufficient statistic for μ. Also, T = T (X1,
</p>
<p>X2, . . . , Xn) = X̄ is sufficient for μ as it is a one-to-one statistic of
&sum;n
</p>
<p>i=1 X i . On
the other hand, T = X̄2 is not sufficient for μ as it is not a one-to-one function of&sum;n
</p>
<p>i=1 X i . The important point here is that X̄ is a function of the sufficient statistic and
hence a good estimator for μ. It is thus summarizing the sample information about
</p>
<p>the parameter of interest in a complete yet parsimonious way. Another, multivariate,
</p>
<p>example of sufficiency is given in Appendix C.4.
</p>
<p>9.3 Point Estimation
</p>
<p>In the previous section, we introduced and discussed various properties of estimators.
</p>
<p>In this section, we want to show how one can find estimators with good properties. In
</p>
<p>the general case, properties such as unbiasedness and efficiency cannot be guaranteed
</p>
<p>for a finite sample. But often, the properties can be shown to hold asymptotically.
</p>
<p>9.3.1 Maximum Likelihood Estimation
</p>
<p>We have used several estimators throughout the book without stating explicitly that
</p>
<p>they are estimators. For example, we used the sample mean (X̄ ) to estimate μ in
</p>
<p>a N (μ,σ2) distribution; we also used the sample proportion (relative frequency) to
</p>
<p>estimate p in a B(1, p) distribution, etc. The obvious question is how to obtain a good
</p>
<p>statistic to estimate an unknown parameter, for example how to determine that the
</p>
<p>sample mean can be used to estimate μ. We need a general framework for parameter
</p>
<p>estimation. The method of maximum likelihood provides such an approach. For the
</p>
<p>purpose of illustration, we introduce the method of maximum likelihood estimation
</p>
<p>with an example using the Bernoulli distribution.
</p>
<p>Example 9.3.1 Consider an i.i.d. random sample X = (X1, X2, . . . , Xn) from a
Bernoulli population with p = P(X i = 1) and (1 &minus; p) = P(X i = 0). The joint
probability mass function for a given set of realizations x1, x2, . . . , xn (i.e. the data) is</p>
<p/>
</div>
<div class="page"><p/>
<p>9.3 Point Estimation 193
</p>
<p>P(X1 = x1, X2 = x2, . . . , Xn = xn|p) = P(X1 = x1|p) &middot; &middot; &middot; &middot; &middot; P(Xn = xn|p)
</p>
<p>=
n&prod;
</p>
<p>i=1
pxi (1 &minus; p)1&minus;xi . (9.7)
</p>
<p>This is a function of (x1, x2, . . . , xn) given the parameter p. The product results
</p>
<p>from the fact that the draws are independent and the fact that pxi (1 &minus; p)1&minus;xi = p if
xi = 1 and pxi (1 &minus; p)1&minus;xi = 1 &minus; p if xi = 0. That is, the term pxi (1 &minus; p)1&minus;xi cov-
ers results from both possible outcomes. Now, consider a random sample where the
</p>
<p>values x = (x1, x2, . . . , xn) are known, for example x = (0, 1, 0, 0, . . . , 1). Then,
(9.7) can be seen as a function of p because (x1, x2, . . . , xn) is known. In this case,
</p>
<p>after obtaining a sample of data, the function is called the likelihood function and
</p>
<p>can be written as
</p>
<p>L(x1, x2, . . . , xn|p) =
n&prod;
</p>
<p>i=1
px1(1 &minus; p)1&minus;xi . (9.8)
</p>
<p>The joint density function of X1, X2, . . . , Xn is called the likelihood function.
</p>
<p>For better understanding, consider a sample of size 5 with x = (x1 = 1, x2 = 1, x3 =
0, x4 = 1, x5 = 0). The likelihood (function) is
</p>
<p>L(1, 1, 0, 1, 0|p) = p &middot; p &middot; (1 &minus; p) &middot; p &middot; (1 &minus; p) = p3(1 &minus; p)2 . (9.9)
The maximum likelihood estimation principle now says that the estimator p̂ of p
</p>
<p>is the value of p which maximizes the likelihood (9.8) or (9.9). In other words,
</p>
<p>the maximum likelihood estimate is the value which maximizes the probability of
</p>
<p>observing the realized sample from the likelihood function. In general, i.e. for any
</p>
<p>sample, we have to maximize the likelihood function (9.9) with respect to p. We use
</p>
<p>the well-known principle of maxima&ndash;minima to maximize the likelihood function in
</p>
<p>this case. In principle, any other optimization procedure can also be used, for example
</p>
<p>numerical algorithms such as the Newton&ndash;Raphson algorithm. If the likelihood is
</p>
<p>differentiable, the first-order condition for the maximum is that the first derivative
</p>
<p>with respect to p is zero. For maximization, we can transform the likelihood by a
</p>
<p>strictly monotone increasing function. This guarantees that the potential maximum
</p>
<p>is taken at the same point as in the original likelihood. A good and highly common
</p>
<p>choice is the natural logarithm since it transforms products in sums and sums are
</p>
<p>easy to differentiate by differentiating each term in the sum. The log-likelihood in
</p>
<p>our example is therefore
</p>
<p>l(1, 1, 0, 1, 0|p) = ln L(1, 1, 0, 1, 0, |p) = ln
{
</p>
<p>p3(1 &minus; p)2
}
</p>
<p>(9.10)
</p>
<p>= 3 ln(p)+ 2 ln(1 &minus; p) (9.11)
where ln denotes the natural logarithm function and we use the rules
</p>
<p>ln(a &middot; b) = ln(a)+ ln(b) , a &gt; 0, b &gt; 0
ln
</p>
<p>(a
b
</p>
<p>)
= ln(a)&minus; ln(b) , a &gt; 0, b &gt; 0
</p>
<p>ln
(
</p>
<p>ab
)
= b ln(a) , a &gt; 0 .</p>
<p/>
</div>
<div class="page"><p/>
<p>194 9 Inference
</p>
<p>Fig. 9.2 Illustration of the likelihood and log-likelihood function of a binomial distribution
</p>
<p>Taking the first derivative of (9.10) with respect to p results in
</p>
<p>&part;l(1, 1, 0, 1, 0|p)
&part; p
</p>
<p>= 3
p
&minus; 2
</p>
<p>1 &minus; p . (9.12)
</p>
<p>Setting (9.12) to zero and solving for p leads to
</p>
<p>3
</p>
<p>p
&minus; 2
</p>
<p>1 &minus; p = 0
</p>
<p>3
</p>
<p>p
= 2
</p>
<p>1 &minus; p
3(1 &minus; p) = 2p
</p>
<p>5p = 3
</p>
<p>p̂ML =
3
</p>
<p>5
= 1
</p>
<p>5
(1 + 1 + 0 + 1 + 0) = x̄ .
</p>
<p>The value of the second-order partial derivative of (9.9) with respect to p at p = p̂ML
is negative which ensures that p̂ML maximizes the likelihood function. It follows from
</p>
<p>this example that the maximum likelihood estimate for p leads to the well-known
</p>
<p>arithmetic mean. Figure 9.2 shows the likelihood function and the log-likelihood
</p>
<p>function as functions of p, where p &isin; [0, 1]. The figures show that the likelihood
function and the log-likelihood function have the same maxima at p = 3/5 = 0.6.
</p>
<p>Maximum likelihood estimators have some important properties: they are usually
</p>
<p>consistent, asymptotically unbiased, asymptotically normally distributed, asymptot-
</p>
<p>ically efficient, and sufficient. Even if they are not, a function of a sufficient statistic
</p>
<p>can always be found which has such properties. This is the reason why maximum
</p>
<p>likelihood estimation is popular. By &ldquo;asymptotically&rdquo; we mean that the properties
</p>
<p>hold as n tends to infinity, i.e. as the sample size increases. There might be other
</p>
<p>good estimators in a particular context, for example estimators that are efficient and
</p>
<p>not only asymptotically efficient; however, in general, the ML principle is a great</p>
<p/>
</div>
<div class="page"><p/>
<p>9.3 Point Estimation 195
</p>
<p>choice in many circumstances. We are going to use it in the following sections and
</p>
<p>chapters, for instance for general point estimation and in the linear regression model
</p>
<p>(Chap. 11).
</p>
<p>Remark 9.3.1 More examples of maximum likelihood estimators are given in
</p>
<p>Exercises 9.1&ndash;9.3.
</p>
<p>9.3.2 Method of Moments
</p>
<p>The method of moments is another well-known method to derive the estimators for
</p>
<p>population parameters. Below, we outline this principle briefly by way of example.
</p>
<p>The idea is that the population parameters of interest can be related to the moments
</p>
<p>(e.g. expectation, variance) of the distribution of the considered random variables.
</p>
<p>A simple case is the estimator for the expected value E(X) = μ of a population
using an i.i.d. random sample X = (X1, . . . , Xn). In this case, μ̂ = X̄ is the natural
moment estimator of μ. Further, since E(X2) = σ2 + μ2, an estimator of σ2 + μ2 is
1
n
</p>
<p>&sum;n
i=1 X
</p>
<p>2
i . Using X̄
</p>
<p>2 as an estimator for μ2, this results in the biased, but asymp-
</p>
<p>totically unbiased estimate
</p>
<p>σ̂2 = 1
n
</p>
<p>n&sum;
</p>
<p>i=1
X2i &minus;
</p>
<p>(
1
</p>
<p>n
</p>
<p>n&sum;
</p>
<p>i=1
X i
</p>
<p>)2
= 1
</p>
<p>n
</p>
<p>n&sum;
</p>
<p>i=1
(X i &minus; X̄)2 .
</p>
<p>An extension of this method is the generalized method of moments (GMM). GMM
</p>
<p>estimators have interesting properties: under relatively week conditions (not further
</p>
<p>discussed here), they are consistent and asymptotically normal, as well as efficient
</p>
<p>in the class of those estimators that do not use any additional information besides
</p>
<p>the information included in the moment conditions. Usually, they require a two-step
</p>
<p>estimating approach or an iterative estimating procedure.
</p>
<p>The least squares estimator for a linear regression model with i.i.d. random
</p>
<p>errors, discussed in detail in Chap. 11, can be seen as a special case of a GMM
</p>
<p>estimator.
</p>
<p>9.4 Interval Estimation
</p>
<p>9.4.1 Introduction
</p>
<p>Let us first consider an example to understand what we mean by interval estimation.
</p>
<p>Consider a situation in which a lady wants to know the time taken to travel from her
</p>
<p>home to the train station. Suppose she makes 20 trips and notes down the time taken.
</p>
<p>To get an estimate of the expected time, one can use the arithmetic mean. Let us say
</p>
<p>x̄ = 25 min. This is the point estimate for the expected travelling time. It may not be
appropriate to say that she will always take exactly 25 min to reach the train station.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>196 9 Inference
</p>
<p>Rather the time may vary by a few minutes each time. To take this into account, the
</p>
<p>time can be estimated in the form of an interval: it may then be found that the time
</p>
<p>varies mostly between 20 and 30 min. Such a statement is more informative. Both
</p>
<p>expectation and variation of the data are taken into account. The interval (20, 30 min)
</p>
<p>provides a range in which most of the values are expected to lie. We call this concept
</p>
<p>interval estimation.
</p>
<p>A point estimate on its own does not take into account the precision of the estimate.
</p>
<p>The deviation between the point estimate and the true parameter (e.g. |x̄ &minus; μ|) can be
substantial, especially when the sample size is small. To incorporate the information
</p>
<p>about the precision of an estimate in the estimated value, a confidence interval can
</p>
<p>be constructed. It is a random interval with lower and upper bounds, Il(X) and
</p>
<p>Iu(X), such that the unknown parameter θ is covered by a prespecified probability
</p>
<p>of at least 1 &minus; α:
Pθ(Il(X) &le; θ &le; Iu(X)) &ge; 1 &minus; α. (9.13)
</p>
<p>The probability 1 &minus; α is called the confidence level or confidence coefficient, Il(X)
is called the lower confidence bound or lower confidence limit and Iu(X) is called
</p>
<p>the upper confidence bound or upper confidence limit. It is important to note that
</p>
<p>the bounds are random and the parameter is a fixed value. This is the reason why
</p>
<p>we say that the true parameter is covered by the interval with probability 1 &minus; α and
not that the probability that the interval contains the parameter is 1 &minus; α. Please note
that some software packages use the term &ldquo;error bar&rdquo; when referring to confidence
</p>
<p>intervals.
</p>
<p>Frequency interpretation of the confidence interval: Suppose N independent
</p>
<p>samples X( j), j = 1, 2, . . . , N , of size n are sampled from the same population
and N confidence intervals of the form [Il(X( j)), Iu(X( j))] are calculated. If N is
large enough, then on an average N (1 &minus; α) of the intervals (9.13) cover the true
parameter.
</p>
<p>Example 9.4.1 Let a random variable follow a normal distribution with μ = 10 and
σ2 = 1. Suppose we draw a sample of n = 10 observations repeatedly. The sample
will differ in each draw, and hence, the mean and the confidence interval will also
</p>
<p>differ. The data sets are realizations from random variables. Have a look at Fig. 9.3
</p>
<p>which illustrates the mean and the 95 % confidence intervals for 6 random samples.
</p>
<p>They vary with respect to the mean and the confidence interval width. Most of the
</p>
<p>means are close toμ = 10, but not all. Similarly, most confidence intervals, but not all,
include μ. This is the idea of the frequency interpretation of the confidence interval:
</p>
<p>different samples will yield different point and interval estimates. Most of the times
</p>
<p>the interval will cover μ, but not always. The coverage probability is specified by
</p>
<p>1 &minus; α, and the frequency interpretation means that we expect that (approximately)
(1 &minus; α) &middot; 100 % of the intervals to cover the true parameter μ. In that sense, the
location of the interval will give us some idea about where the true but unknown
</p>
<p>population parameter μ lies, while the length of the interval reflects our uncertainty
</p>
<p>about μ: the wider the interval is, the higher is our uncertainty about the location
</p>
<p>of μ.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.4 Interval Estimation 197
</p>
<p>Fig. 9.3 Frequency
</p>
<p>interpretation of confidence
</p>
<p>intervals
</p>
<p>We now introduce the following confidence intervals:
</p>
<p>&bull; Confidence interval for the mean μ of a normal distribution.
&bull; Confidence interval for the probability p of a binomial random variable.
&bull; Confidence interval for the odds ratio.
</p>
<p>9.4.2 Confidence Interval for the Mean of a Normal Distribution
</p>
<p>Confidence Interval for &micro; When σ2 = σ20 is Known.
Let X1, X2, . . . , Xn be an i.i.d. sample from a N (μ,σ
</p>
<p>2
0) distribution where σ
</p>
<p>2
0 is
</p>
<p>assumed to be known. We use the point estimate X̄ = 1
n
</p>
<p>&sum;n
i=1 X i to estimate μ
</p>
<p>and construct a confidence interval around the mean μ. Using the Central Limit
</p>
<p>Theorem (Appendix C.3, p. 426), it follows that X̄ follows a N (μ,σ20/n) distribution.
</p>
<p>Therefore
&radic;
</p>
<p>n(X̄ &minus; μ)/σ0 &sim; N (0, 1), and it follows that
</p>
<p>Pμ
</p>
<p>(∣∣∣∣
&radic;
</p>
<p>n(X̄ &minus; μ)
σ0
</p>
<p>∣∣∣∣ &le; z1&minus; α2
)
= 1 &minus; α (9.14)
</p>
<p>where z1&minus;α/2 denotes the (1 &minus; α/2) quantile of the standard normal distribution
N (0, 1). We solve this inequality for the unknown μ and get the desired confidence
</p>
<p>interval as follows:
</p>
<p>Pμ
</p>
<p>[
&minus;z1&minus; α2 &le;
</p>
<p>(&radic;
n(X̄ &minus; μ)
</p>
<p>σ0
</p>
<p>)
&le; z1&minus; α2
</p>
<p>]
= 1 &minus; α
</p>
<p>or
</p>
<p>Pμ
</p>
<p>[
X̄ &minus; z1&minus;α/2
</p>
<p>σ0&radic;
n
&le; μ &le; X̄ + z1&minus;α/2
</p>
<p>σ0&radic;
n
</p>
<p>]
= 1 &minus; α .</p>
<p/>
</div>
<div class="page"><p/>
<p>198 9 Inference
</p>
<p>The confidence interval for μ is thus obtained as
</p>
<p>[Il(X), Iu(X)] =
[
</p>
<p>X̄ &minus; z1&minus;α/2
σ0&radic;
</p>
<p>n
, X̄ + z1&minus;α/2
</p>
<p>σ0&radic;
n
</p>
<p>]
. (9.15)
</p>
<p>This is known as (1 &minus; α)% confidence interval for μ or the confidence interval for
μ with confidence coefficient α.
</p>
<p>We can use the R function qnorm or Table C.1 to obtain z1&minus; α2 , see also Sects. 8.4,
A.3, and C.7. For example, for α = 0.05 and α = 0.01 we get z1&minus; α2 = z0.975 = 1.96
and z1&minus; α2 = z0.995 = 2.576 using qnorm(0.975) and qnorm(0.995). This gives us
the quantiles we need to determine a 95 % and 99 % confidence interval, respectively.
</p>
<p>Example 9.4.2 We consider again Example 9.2.3 where we evaluated the weight of
</p>
<p>10-year-old children. Assume that the variance is known to be 36; then the upper and
</p>
<p>lower limits of a 95 % confidence interval for the expected weightμ can be calculated
</p>
<p>as follows:
</p>
<p>Il(X) = X̄ &minus; z1&minus;α/2
σ0&radic;
</p>
<p>n
= 41.97 &minus; 1.96
</p>
<p>&radic;
36&radic;
20
</p>
<p>&asymp; 39.34 ,
</p>
<p>Iu(X) = X̄ + z1&minus;α/2
σ0&radic;
</p>
<p>n
= 41.97 + 1.96
</p>
<p>&radic;
36&radic;
20
</p>
<p>&asymp; 44.59.
</p>
<p>We get the confidence interval [Iu(X), Io(X)] = [39.34, 44.59]. With 95 % confi-
dence, the true parameter μ is covered by the interval [39.34, 44.59].
</p>
<p>Confidence Interval for &micro; When σ2 is Unknown.
</p>
<p>Let X1, X2, . . . , Xn be an i.i.d. sample from N (μ,σ
2) where σ2 is assumed to be
</p>
<p>unknown and is being estimated by the sample variance S2X . We know from Sect. 8.3.1
</p>
<p>that
(n &minus; 1)S2X
</p>
<p>σ2
&sim; χ2n&minus;1 .
</p>
<p>It can be shown that X̄ and S2X are stochastically independent. Thus, we know that
</p>
<p>&radic;
n(X̄ &minus; μ)
</p>
<p>SX
&sim; tn&minus;1
</p>
<p>follows a t-distribution with n &minus; 1 degrees of freedom. We can use this result to
determine the confidence interval for μ as
</p>
<p>Pμ
</p>
<p>[
&minus;t1&minus; α2 ,n&minus;1 &le;
</p>
<p>(&radic;
n(X̄ &minus; μ)
</p>
<p>SX
</p>
<p>)
&le; t1&minus; α2 ,n&minus;1
</p>
<p>]
= 1 &minus; α
</p>
<p>or
</p>
<p>Pμ
</p>
<p>[
X̄ &minus; t1&minus; α2 ,n&minus;1
</p>
<p>SX&radic;
n
&le; μ &le; X̄ + t1&minus; α2 ,n&minus;1
</p>
<p>SX&radic;
n
</p>
<p>]
= 1 &minus; α .</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>9.4 Interval Estimation 199
</p>
<p>The confidence interval for μ is thus obtained as
</p>
<p>[Il(X), Iu(X)] =
[
</p>
<p>X̄ &minus; tn&minus;1;1&minus;α/2 &middot;
SX&radic;
</p>
<p>n
, X̄ + tn&minus;1;1&minus;α/2 &middot;
</p>
<p>SX&radic;
n
</p>
<p>]
(9.16)
</p>
<p>which is the 100(1 &minus; α)% confidence interval for μ or the confidence interval for μ
with confidence coefficient α.
</p>
<p>The interval (9.16) is, in general, wider than the interval (9.15) for identical α and
</p>
<p>identical sample size n, since the unknown parameter σ2 is estimated by S2X which
</p>
<p>induces additional uncertainty. The quantiles for the t-distribution can be obtained
</p>
<p>using the R command qt or Table C.2.
</p>
<p>Example 9.4.3 Consider Example 9.4.2 where we evaluated the weight of 10-year-
</p>
<p>old children. We have already calculated the point estimate of μ as x̄ = 41.97. With
t19;0.975 = 2.093, obtained via qt(0.975,19) or Table C.2, the upper and lower
limits of a 95 % confidence interval for μ are obtained as
</p>
<p>Iu(X) = x̄ &minus; t19;0.975 &middot;
sX&radic;
</p>
<p>n
= 41.97 &minus; 2.093 &middot; 6.07&radic;
</p>
<p>20
&asymp; 39.12 ,
</p>
<p>Io(X) = x̄ + t19;0.975 &middot;
sX&radic;
</p>
<p>n
= 41.97 + 2.093 &middot; 6.07&radic;
</p>
<p>20
&asymp; 44.81 .
</p>
<p>Therefore, the confidence interval is [Il(X), Iu(X)] = [39.13, 44.81]. In R, we can
use the conf.int value of the t.test command to get a confidence interval for the
</p>
<p>mean (see also Example 10.3.3 for more details on t.test). The default is a 95 %
</p>
<p>confidence interval, but it can be changed easily if desired:
</p>
<p>x &lt;- c(40.2, 32.8, 38.2, 43.5, ..., 49.9, 34.2)
</p>
<p>t.test(x,conf.level = 0.95)$conf.int
</p>
<p>[1] 39.12384 44.80616
</p>
<p>There is no unique best way to draw the calculated confidence intervals in R.
</p>
<p>Among many other options, one can simply work with the plot functionality or
</p>
<p>use geom_errorbar in conjunction with a ggplot object created with the library
</p>
<p>ggplot2, or use the plotCI command in the library plotrix.
</p>
<p>9.4.3 Confidence Interval for a Binomial Probability
</p>
<p>Let X1, X2, . . . , Xn be an i.i.d. sample from a Bernoulli distribution B(1, p). Then
</p>
<p>Y =
&sum;n
</p>
<p>i=1 X i has a binomial distribution B(n, p).
We have already introduced p̂ as an estimator for p:
</p>
<p>p̂ = 1
n
</p>
<p>n&sum;
</p>
<p>i=1
X i =
</p>
<p>1
</p>
<p>n
Y.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>200 9 Inference
</p>
<p>From (8.8), we know that Var(Y ) = np(1 &minus; p). Applying rule (7.33), the variance
of the estimator p̂ is
</p>
<p>Var( p̂) = p(1 &minus; p)
n
</p>
<p>and it can be estimated by
</p>
<p>S2
p̂
= p̂(1 &minus; p̂)
</p>
<p>n
.
</p>
<p>Nowadays, the exact confidence intervals of the binomial distribution function can
</p>
<p>be easily calculated using computer implementations. Nevertheless, (i) for a suffi-
</p>
<p>ciently large sample size n, (ii) if p is not extremely low or high, and (iii) if the
</p>
<p>condition np(1 &minus; p) &ge; 9 is fulfilled, we can use an approximation based on the nor-
mal distribution to calculate confidence intervals. To be more specific, one can show
</p>
<p>that
</p>
<p>Z = p̂ &minus; p&radic;
p̂(1 &minus; p̂)/n
</p>
<p>approx .&sim; N (0, 1). (9.17)
</p>
<p>This gives us
</p>
<p>P
</p>
<p>[
p̂ &minus; z1&minus;α/2
</p>
<p>&radic;
p̂(1 &minus; p̂)
</p>
<p>n
&le; p &le; p̂ + z1&minus;α/2
</p>
<p>&radic;
p̂(1 &minus; p̂)
</p>
<p>n
</p>
<p>]
&asymp; 1 &minus; α, (9.18)
</p>
<p>and we get a confidence interval for p as
[
</p>
<p>p̂ &minus; z1&minus;α/2
&radic;
</p>
<p>p̂(1 &minus; p̂)
n
</p>
<p>, p̂ + z1&minus;α/2
&radic;
</p>
<p>p̂(1 &minus; p̂)
n
</p>
<p>]
. (9.19)
</p>
<p>Example 9.4.4 We look again at Example 9.2.4 where we evaluated the proportion
</p>
<p>of members who had to pay a penalty. Out of all borrowers, 39 % brought back their
</p>
<p>books late and thus had to pay a fee. A 95 % confidence interval for the probability
</p>
<p>p of bringing back a book late can be constructed using the normal approximation,
</p>
<p>since n p̂(1 &minus; p̂) = 100 &middot; 0.39 &middot; 0.61 = 23.79 &gt; 9. With z1&minus;α/2 = z0.975 = 1.96 and
p̂ = 0.39, we get the 95 % confidence interval as
</p>
<p>[
0.39 &minus; 1.96
</p>
<p>&radic;
0.39 &middot; 0.61
</p>
<p>100
, 0.39 + 1.96
</p>
<p>&radic;
0.39 &middot; 0.61
</p>
<p>100
</p>
<p>]
= [0.294, 0.486].
</p>
<p>In R, an exact confidence interval can be found using the function binom.test:
</p>
<p>binom.test(x=39,n=100)$conf.int
</p>
<p>[1] 0.2940104 0.4926855
</p>
<p>One can see that the exact and approximate confidence limits differ slightly due
</p>
<p>to the normal approximation which approximates the exact binomial probabilities.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>9.4 Interval Estimation 201
</p>
<p>9.4.4 Confidence Interval for the Odds Ratio
</p>
<p>In Chap. 4, we introduced the odds ratio to determine the strength of association
</p>
<p>between two binary variables. One may be interested in the dispersion of the odds
</p>
<p>ratio and hence calculate a confidence interval for it. Recall the notation for 2 &times; 2
contingency tables:
</p>
<p>Y Total (row)
</p>
<p>y1 y2
</p>
<p>x1 a b a + bX
x2 c d c + d
</p>
<p>Total (column) a + c b + d n
</p>
<p>In the spirit of the preceding sections, we can interpret the entries in this con-
</p>
<p>tingency table as population parameters. For example, a describes the absolute fre-
</p>
<p>quency of observations in the population for which Y = y1 and X = x1. If we have
a sample then we can estimate a by the number of observed observations n11 for
</p>
<p>which Y = y1 and X = x1. We can thus view n11 to be an estimator for a, n12 to be
an estimator for b, n21 to be an estimator for c, and n22 to be an estimator for d. It
</p>
<p>follows that
</p>
<p>ÔR = n11n22
n12n21
</p>
<p>(9.20)
</p>
<p>serves as the point estimate for the population odds ratio OR = ad/bc. To construct
a confidence interval for the odds ratio, we need to work on a log-scale. The log odds
</p>
<p>ratio,
</p>
<p>θ0 = ln OR = ln a &minus; ln b &minus; ln c + ln d, (9.21)
takes the natural logarithm of the odds ratio. It is evident that it can be estimated
</p>
<p>using the observed absolute frequencies of the joint frequency distribution of X and
</p>
<p>Y :
</p>
<p>θ̂0 = ln ÔR = ln
n11n22
</p>
<p>n12n21
. (9.22)
</p>
<p>It can be shown that θ̂0 follows approximately a normal distribution with expectation
</p>
<p>θ0 and standard deviation
</p>
<p>σ̂
θ̂0
</p>
<p>=
(
</p>
<p>1
</p>
<p>n11
+ 1
</p>
<p>n22
+ 1
</p>
<p>n12
+ 1
</p>
<p>n21
</p>
<p>) 1
2
</p>
<p>. (9.23)
</p>
<p>Following the reasoning explained in the earlier section on confidence intervals for
</p>
<p>binomial probabilities, we can calculate the 100(1 &minus; α)% confidence interval for θ0
under a normal approximation as follows:
</p>
<p>[
θ̂0 &minus; z1&minus; α2 σ̂θ̂0 , θ̂0 + z1&minus; α2 σ̂θ̂0
</p>
<p>]
= [Iu, Io] . (9.24)</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>202 9 Inference
</p>
<p>Since we are interested in the confidence interval of the odds ratio, and not the log
</p>
<p>odds ratio, we need to transform back the lower and upper bound of the confidence
</p>
<p>interval as [
exp(Iu), exp(Io)
</p>
<p>]
. (9.25)
</p>
<p>Example 9.4.5 Recall Example 4.2.5 from Chap. 4 where we were interested in the
</p>
<p>association of smoking with a particular disease. The data is summarized in the
</p>
<p>following 2 &times; 2 contingency table:
</p>
<p>Smoking Total (row)
</p>
<p>Yes No
</p>
<p>Yes 34 66 100
Disease
</p>
<p>No 22 118 140
</p>
<p>Total (column) 56 184 240
</p>
<p>The odds ratio was estimated to be 2.76, and we therefore concluded that the chances
</p>
<p>of having the particular disease is 2.76 times higher for smokers compared with non-
</p>
<p>smokers. To calculate a 95 % confidence intervals, we need θ̂0 = ln(2.76), z1&minus; α2 &asymp;
1.96 and
</p>
<p>σ̂
θ̂0
</p>
<p>=
(
</p>
<p>1
</p>
<p>n11
+ 1
</p>
<p>n22
+ 1
</p>
<p>n12
+ 1
</p>
<p>n21
</p>
<p>) 1
2
</p>
<p>=
(
</p>
<p>1
</p>
<p>34
+ 1
</p>
<p>118
+ 1
</p>
<p>66
+ 1
</p>
<p>22
</p>
<p>) 1
2
</p>
<p>&asymp; 0.314.
</p>
<p>The confidence interval for the log odds ratio is
</p>
<p>[ln(2.76)&minus; 1.96 &middot; 0.314, ln(2.76)+ 1.96 &middot; 0.314] &asymp; [0.40, 1.63] .
Exponentiation of the confidence interval bounds yields the 95 % confidence interval
</p>
<p>for the odds ratio as
</p>
<p>[1.49, 5.11] .
</p>
<p>There are many ways to obtain the same results in R. One option is to use the
</p>
<p>oddsratio function of the library epitools. Note that we need to specify &ldquo;wald&rdquo;
</p>
<p>under the methods option to get confidence intervals which use the normal approxi-
</p>
<p>mation as we did in this case.
</p>
<p>library(epitools)
</p>
<p>smd &lt;- matrix(c(34,22,66,118),ncol=2,nrow=2) #data
</p>
<p>oddsratio(smd,method='wald')</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>9.5 Sample Size Determinations 203
</p>
<p>9.5 Sample Size Determinations
</p>
<p>Confidence intervals help us estimating the precision of point estimates. What if
</p>
<p>we are required to adhere to a prespecified precision level? We know that the vari-
</p>
<p>ance decreases as the sample size increases. In turn, confidence intervals become
</p>
<p>narrower. On the other hand, increasing the sample size has its own consequences.
</p>
<p>For example, the cost and time involved in setting up experiments, or conducting
</p>
<p>a survey, increases. In these situations it is important to find a balance between the
</p>
<p>variability of the estimates and the sample size. We cannot control the variability in
</p>
<p>the data in most of the situations, but it is possible to control the sample size and
</p>
<p>therefore the precision of our estimates. For example, we can control the number
</p>
<p>of people to be interviewed in a survey&mdash;given the resources which are available.
</p>
<p>We discuss how to determine the number of observations needed to get a particular
</p>
<p>precision (length) of the confidence interval. We find the answers to such questions
</p>
<p>using the formulae for confidence intervals.
</p>
<p>Sample Size Calculation for &micro;.
</p>
<p>Let us consider the situation where we are interested in estimating the population
</p>
<p>mean μ. The length of the confidence interval (9.15) for the point estimate X̄ is
</p>
<p>2z1&minus;α/2
σ0&radic;
</p>
<p>n
. (9.26)
</p>
<p>We would now like to fix the width of the confidence interval and come up with
</p>
<p>a sample size which is required to achieve this width. Let us fix the length of the
</p>
<p>confidence interval as
</p>
<p>∆ = 2z1&minus;α/2
σ0&radic;
</p>
<p>n
. (9.27)
</p>
<p>Assume we have knowledge of σ0. The knowledge about σ0 can be obtained, for
</p>
<p>example, through a pilot study or past experience with the experiment. We are inter-
</p>
<p>ested in obtaining the value of n for which a confidence interval has a fixed confidence
</p>
<p>width of ∆ or less. Rearranging (9.27) gives us
</p>
<p>n &ge;
[
2
</p>
<p>z1&minus;α/2σ0
∆
</p>
<p>]2
. (9.28)
</p>
<p>This means a minimum or optimum sample size is
</p>
<p>nopt =
[
2
</p>
<p>z1&minus;α/2σ0
∆
</p>
<p>]2
. (9.29)
</p>
<p>The sample size nopt ensures that the 1 &minus; α confidence interval for μ has at most
length ∆. But note that we have assumed that σ0 is known. If we do not know σ0
(which is more likely in practice), we have to make an assumption about it, e.g. by
</p>
<p>using an estimate from a former study, a pilot study, or other external information.
</p>
<p>Practically, (9.28) is used in the case of known and unknown σ20 .</p>
<p/>
</div>
<div class="page"><p/>
<p>204 9 Inference
</p>
<p>Example 9.5.1 A call centre is interested in determining the expected length of a
</p>
<p>telephone call as precisely as possible. The requirements are that the 95 % confidence
</p>
<p>interval forμ should have a width of 1 min. Suppose that the call centre has developed
</p>
<p>a pilot study in which σ0 was estimated to be 5 min. The sample size n that is needed
</p>
<p>to estimate the expected length of the phone calls with the desired precision is:
</p>
<p>n &ge;
[
</p>
<p>2z1&minus;α/2σ0
∆
</p>
<p>]2
=
</p>
<p>[
2 &times; 1.96 &times; 5
</p>
<p>1
</p>
<p>]2
&asymp; 384.
</p>
<p>This means that at least 384 calls are required to get the desired confidence interval
</p>
<p>width.
</p>
<p>Sample Size Calculation for p.
</p>
<p>We can follow the earlier reasoning and determine the optimum sample size for a
</p>
<p>specific confidence interval width using the confidence interval definition (9.19).
</p>
<p>Since the width of the confidence interval is
</p>
<p>∆ = 2z1&minus;α/2
&radic;
</p>
<p>p̂(1 &minus; p̂)
n
</p>
<p>,
</p>
<p>we get
</p>
<p>n &ge;
[
2
</p>
<p>z1&minus;α/2
∆
</p>
<p>]2
p̂(1 &minus; p̂). (9.30)
</p>
<p>Example 9.5.2 A factory may be interested in the probability of an error in an oper-
</p>
<p>ating process. The length of the confidence interval should be &plusmn;2 %, i.e. ∆ = 0.04.
Suppose it is speculated that the error probability is 10 %; we may then use p̂ = 0.1
as our prior judgment for the true value of p. This yields
</p>
<p>n &ge;
[
2
</p>
<p>z1&minus;α/2
∆
</p>
<p>]2
p̂(1 &minus; p̂) =
</p>
<p>[
2 &times; 1.96
</p>
<p>0.04
</p>
<p>]2
0.1 &middot; (1 &minus; 0.1) &asymp; 865. (9.31)
</p>
<p>This means we need a sample size of at least 865 to obtain the desired width of the
</p>
<p>confidence interval for p.
</p>
<p>The above examples for both μ and p have shown us that without external knowl-
</p>
<p>edge about the research question of interest, it is difficult to come up with an appro-
</p>
<p>priate sample size. Results may vary considerably depending on what type of infor-
</p>
<p>mation is assumed to be known. With limited knowledge, it can be useful to report
</p>
<p>results for different widths of confidence intervals and hypothesized values of p or
</p>
<p>σ0.
</p>
<p>Sample size calculations can be highly complex in many practical situations and
</p>
<p>may not remain as simple as in the examples considered here. For example, Chap. 10
</p>
<p>uses additional concepts in the context of hypothesis testing, such as the power,
</p>
<p>which can be taken into consideration when estimating sample sizes. However,</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>9.5 Sample Size Determinations 205
</p>
<p>in this case, calculations and interpretations become more difficult and complex.
</p>
<p>A detailed overview of sample size calculations can be found in Chow et al. (2007)
</p>
<p>and Bock (1997).
</p>
<p>9.6 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� We have introduced important point estimates for the parameters of a nor-
</p>
<p>mal and a binomial distribution:
</p>
<p>x̄ for μ, S2 for σ2, x̄ for p.
</p>
<p>In general, the choice of these point estimates is not arbitrary but follows
</p>
<p>some principles of statistical inference such as maximum likelihood esti-
</p>
<p>mation, or least squares estimation (introduced in Chap. 11).
</p>
<p>� The maximum likelihood estimator is usually consistent, asymptotically
</p>
<p>unbiased, asymptotically normally distributed, and asymptotically effi-
</p>
<p>cient.
</p>
<p>� The validity of all results in this chapter depends on the assumption that
</p>
<p>the data is complete and has no missing values. Incomplete data may yield
</p>
<p>different conclusions.
</p>
<p>� A confidence interval is defined in terms of upper and lower confidence
</p>
<p>limits and covers the true target parameter with probability 1 &minus; α. Confi-
dence intervals are often constructed as follows:
</p>
<p>point estimate &plusmn; quantile &middot;
&radic;
</p>
<p>variance of point estimate︸ ︷︷ ︸
standard error
</p>
<p>.
</p>
<p>� More detailed introductions to inference are presented in Casella and
</p>
<p>Berger (2002) and Young and Smith (2005).
</p>
<p>9.7 Exercises
</p>
<p>Exercise 9.1 Consider an i.i.d. sample of size n from a Po(λ) distributed random
</p>
<p>variable X .</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>206 9 Inference
</p>
<p>(a) Determine the maximum likelihood estimate for λ.
</p>
<p>(b) What does the log-likelihood function look like for the following realizations:
</p>
<p>x1 = 4, x2 = 3, x3 = 8, x4 = 6, x5 = 6? Plot the function using R. Hint: The
curve command can be used to plot functions.
</p>
<p>(c) Use the Neyman&ndash;Fisher Factorization Theorem to argue that the maximum like-
</p>
<p>lihood estimate obtained in (a) is a sufficient statistic for λ.
</p>
<p>Exercise 9.2 Consider an i.i.d. sample of size n from a N (μ,σ2) distributed random
</p>
<p>variable X .
</p>
<p>(a) Determine the maximum likelihood estimator for μ under the assumption that
</p>
<p>σ2 = 1.
(b) Now determine the maximum likelihood estimator for μ for an arbitrary σ2.
</p>
<p>(c) What is the maximum likelihood estimate for σ2?
</p>
<p>Exercise 9.3 Let X1, X2, . . . , Xn be n i.i.d. random variables which follow a uni-
</p>
<p>form distribution, U (0, θ). Write down the likelihood function and argue, without
</p>
<p>differentiating the function, what the maximum likelihood estimate of θ is.
</p>
<p>Exercise 9.4 Let X1, X2, . . . , Xn be n i.i.d. random variables which follow an expo-
</p>
<p>nential distribution. An intelligent statistician proposes to use the following two
</p>
<p>estimators to estimate μ = 1/λ:
</p>
<p>(i) Tn(X) = nXmin with Xmin = min(X1, . . . , Xn) and Xmin &sim; Exp(nλ),
(ii) Vn(X) = n&minus;1
</p>
<p>&sum;n
i=1 X i .
</p>
<p>(a) Are both Tn(X) and Vn(X) (asymptotically) unbiased for μ?
</p>
<p>(b) Calculate the mean squared error of both estimators. Which estimator is more
</p>
<p>efficient?
</p>
<p>(c) Is Vn(X) MSE consistent, weakly consistent, both, or not consistent at all?
</p>
<p>Exercise 9.5 A national park in Namibia determines the weight (in kg) of a sample
</p>
<p>of common eland antelopes:
</p>
<p>450 730 700 600 620 660 850 520 490 670 700 820
</p>
<p>910 770 760 620 550 520 590 490 620 660 940 790
</p>
<p>Calculate
</p>
<p>(a) the point estimate of μ and σ2 and
</p>
<p>(b) the confidence interval for μ (α = 0.05).
</p>
<p>under the assumption that the weight is normally distributed.
</p>
<p>(c) Use R to reproduce the results from (b).</p>
<p/>
</div>
<div class="page"><p/>
<p>9.7 Exercises 207
</p>
<p>Exercise 9.6 We are interested in the heights of the players of the two basketball
</p>
<p>teams &ldquo;Brose Baskets Bamberg&rdquo; and &ldquo;Bayer Giants Leverkusen&rdquo; as well as the
</p>
<p>football team &ldquo;SV Werder Bremen&rdquo;. The following summary statistics are given:
</p>
<p>N Minimum Maximum Mean Std. dev.
</p>
<p>Bamberg 16 185 211 199.06 7.047
</p>
<p>Leverkusen 14 175 210 196.00 9.782
</p>
<p>Bremen 23 178 195 187.52 5.239
</p>
<p>Calculate a 95 % confidence interval forμ for all three teams and interpret the results.
</p>
<p>Exercise 9.7 A married couple tosses a coin after each dinner to determine who has
</p>
<p>to wash the dishes. If the coin shows &ldquo;head&rdquo;, then the husband has to wash the dishes,
</p>
<p>and if the coin shows &ldquo;tails&rdquo;, then the wife has to wash the dishes. After 98 dinners,
</p>
<p>the wife notes that the coin has shown head 59 times.
</p>
<p>(a) Estimate the probability that the wife has to wash the dishes.
</p>
<p>(b) Calculate and interpret the 95 % confidence interval for p.
</p>
<p>(c) How many dinners are needed to estimate the true probability for the coin show-
</p>
<p>ing &ldquo;head&rdquo; with a precision of &plusmn;0.5 % under the assumption that the coin is
fair?
</p>
<p>Exercise 9.8 Suppose 93 out of 104 pupils have passed the final examination at a
</p>
<p>certain school.
</p>
<p>(a) Calculate a 95 % confidence interval for the probability of failing the examination
</p>
<p>both by manual calculations and by using R, and compare the results.
</p>
<p>(b) At county level 3.2 % of pupils failed the examination. Are the school&rsquo;s pupils
</p>
<p>worse than those in the whole county?
</p>
<p>Exercise 9.9 To estimate the audience rate for several TV stations, 3000 households
</p>
<p>are asked to allow a device, which records which TV station is watched, to be
</p>
<p>installed on their TVs. 2500 agreed to participate. Assume it is of interest to estimate
</p>
<p>the probability of someone switching on the TV and watching the show &ldquo;Germany&rsquo;s
</p>
<p>next top model&rdquo;.
</p>
<p>(a) What is the precision with which the probability can be estimated?
</p>
<p>(b) What source of bias could potentially influence the estimates?</p>
<p/>
</div>
<div class="page"><p/>
<p>208 9 Inference
</p>
<p>Exercise 9.10 An Olympic decathlon athlete is interested in his performance com-
</p>
<p>pared with the performance of other athletes. He is a good runner and interested in
</p>
<p>his 100 m results compared with those of other athletes.
</p>
<p>(a) He uses the decathlon data from this book (Appendix A.2) to come up with
</p>
<p>σ̂ = s = 0.233. What sample size does he need to calculate a 95 % confidence
interval for the mean running time which is precise to &plusmn;0.1 s?
</p>
<p>(b) Calculate a 95 % confidence interval for the mean running time (x̄ = 10.93) of
the 30 athletes captured in the data set in Chap. A.2. Interpret the width of this
</p>
<p>interval compared with the width determined in a).
</p>
<p>(c) The runner&rsquo;s own best time is 10.86 s. He wants to be among the best 10 % of all
</p>
<p>athletes. Calculate an appropriate confidence interval to compare his time with
</p>
<p>the 10 % best times.
</p>
<p>Exercise 9.11 Consider the pizza delivery data described in Chap. A.4. We distin-
</p>
<p>guish between pizzas delivered on time (i.e. in less than 30 min) and not delivered on
</p>
<p>time (i.e. in more than 30 min). The contingency table for delivery time and operator
</p>
<p>looks as follows:
</p>
<p>Operator Total
</p>
<p>Laura Melissa
</p>
<p>&lt;30 min 163 151 314
</p>
<p>&ge;30 min 475 477 952
Total 638 628 1266
</p>
<p>(a) Calculate and interpret the odds ratio and its 95 % confidence interval.
</p>
<p>(b) Reproduce the results from (a) using R.
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 384</p>
<p/>
</div>
<div class="page"><p/>
<p>10Hypothesis Testing
</p>
<p>10.1 Introduction
</p>
<p>We introduced point and interval estimation of parameters in the previous chapter.
</p>
<p>Sometimes, the research question is less ambitious in the sense that we are not inter-
</p>
<p>ested in precise estimates of a parameter, but we only want to examine whether
</p>
<p>a statement about a parameter of interest or the research hypothesis is true or not
</p>
<p>(although we will see later in this chapter that there is a connection between confi-
</p>
<p>dence intervals and statistical tests, called duality). Another related issue is that once
</p>
<p>an analyst estimates the parameters on the basis of a random sample, (s)he would
</p>
<p>like to infer something about the value of the parameter in the population. Statisti-
</p>
<p>cal hypothesis tests facilitate the comparison of estimated values with hypothetical
</p>
<p>values.
</p>
<p>Example 10.1.1 As a simple example, consider the case where we want to find out
</p>
<p>whether the proportion of votes for a party P in an election will exceed 30 % or
</p>
<p>not. Typically, before the election, we will try to get representative data about the
</p>
<p>election proportions for different parties (e.g. by telephone interviews) and then make
</p>
<p>a statement like &ldquo;yes&rdquo;, we expect that P will get more than 30 % of the votes or &ldquo;no&rdquo;,
</p>
<p>we do not have enough evidence that P will get more than 30 % of the votes. In
</p>
<p>such a case, we will only know after the election whether our statement was right or
</p>
<p>wrong. Note that the term representative data only means that the sample is similar
</p>
<p>to the population with respect to the distributions of some key variables, e.g. age,
</p>
<p>gender, and education. Since we use one sample to compare it with a fixed value
</p>
<p>(30 %), we call it a one-sample problem.
</p>
<p>Example 10.1.2 Consider another example in which a clinical study is conducted
</p>
<p>to compare the effectiveness of a new drug (B) to an established standard drug (A)
</p>
<p>for a specific disease, for example too high blood pressure. Assume that, as a first
</p>
<p>step, we want to find out whether the new drug causes a higher reduction in blood
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_10
</p>
<p>209</p>
<p/>
</div>
<div class="page"><p/>
<p>210 10 Hypothesis Testing
</p>
<p>pressure than the already established older drug. A frequently used study design for
</p>
<p>this question is a randomized (i.e. patients are randomly allocated to one of the two
</p>
<p>treatments) controlled clinical trial (double blinded, i.e. neither the patient nor the
</p>
<p>doctor know which of the drugs a patient is receiving during the trial), conducted in
</p>
<p>a fixed time interval, say 3 months. A possible hypothesis is that the average change
</p>
<p>in the blood pressure in group B is higher than in group A, i.e. δB &gt; δA where
</p>
<p>δ j = &micro; j0 &minus; &micro; j3, j = A, B and &micro; j0 is the average blood pressure at baseline before
measuring the blood pressure again after 3 months (&micro; j3). Note that we expect both
</p>
<p>the differences δA and δB to be positive, since otherwise we would have some doubt
</p>
<p>that either drug is effective at all. As a second step (after statistically proving our
</p>
<p>hypothesis), we are interested in whether the improvement of B compared to A is
</p>
<p>relevant in a medical or biological sense and is valid for the entire population or
</p>
<p>not. This will lead us again to the estimation problems of the previous chapter, i.e.
</p>
<p>quantifying an effect using point and interval estimation. Since we are comparing two
</p>
<p>drugs, we need to have two samples from each of the drugs; hence, we have a two-
</p>
<p>sample problem. Since the patients receiving A are different from those receiving
</p>
<p>B in this example, we refer to it as a &ldquo;two-independent-samples problem&rdquo;.
</p>
<p>Example 10.1.3 In another example, we consider an experiment in which a group
</p>
<p>of students receives extra mathematical tuition. Their ability to solve mathematical
</p>
<p>problems is evaluated before and after the extra tuition. We are interested in knowing
</p>
<p>whether the ability to solve mathematical problems increases after the tuition, or not.
</p>
<p>Since the same group of students is used in a pre&ndash;post experiment, this is called a
</p>
<p>&ldquo;two-dependent-samples problem&rdquo; or a &ldquo;paired data problem&rdquo;.
</p>
<p>10.2 Basic Definitions
</p>
<p>10.2.1 One- and Two-Sample Problems
</p>
<p>In one-sample problems, the data is usually assumed to arise as one sample from a
</p>
<p>defined population. In two-sample problems, the data originates in the form of two
</p>
<p>samples possibly from two different populations. The heterogeneity is often modelled
</p>
<p>by assuming that the two populations only differ in some parameters or key quantities
</p>
<p>such as expectation (i.e. mean), median, or variance. As in our introductory example,
</p>
<p>the samples can either be independent (as in the drug Example 10.1.2) or dependent
</p>
<p>(as in the evaluation Example 10.1.3).
</p>
<p>10.2.2 Hypotheses
</p>
<p>A researcher may have a research question for which the truth about the population
</p>
<p>of interest is unknown. Suppose data can be obtained using a survey, observation, or</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Basic Definitions 211
</p>
<p>an experiment: if, given a prespecified uncertainty level, a statistical test based on
</p>
<p>the data supports the hypothesis about the population, we say that this hypothesis is
</p>
<p>statistically proven. Note that the research question has to be operationalized before
</p>
<p>it can be tested by a statistical test. Consider the drug Example 10.1.2: we want to
</p>
<p>examine whether the new drug B has a greater blood pressure lowering effect than
</p>
<p>the standard drug A. We have several options to operationalize this research question
</p>
<p>into a statistical set-up. One is to test whether the average reduction (from baseline to
</p>
<p>3 months) of the blood pressure is higher (and positive) for drug B than drug A. We
</p>
<p>then state our hypotheses in terms of expected values (i.e. &micro;). Why do we have to use
</p>
<p>the expected values &micro; and not simply compare the arithmetic means x̄? The reason is
</p>
<p>that the superiority of B shown in the sample will only be valid for this sample and
</p>
<p>not necessarily for another sample. We need to show the superiority of B in the entire
</p>
<p>population, and hence, our hypothesis needs to reflect this. Another option would
</p>
<p>be, for example, to use median changes in blood pressure values instead of mean
</p>
<p>changes in blood pressure values. An important point is that the research hypothesis
</p>
<p>which we want to prove has to be formulated as the statistical alternative hypothesis,
</p>
<p>often denoted by H1. The reason for this will become clearer later in this chapter.
</p>
<p>The opposite of the research hypothesis has to be formulated as the statistical null
</p>
<p>hypothesis, denoted by H0. In the drug example, the alternative and null hypotheses
</p>
<p>are, respectively,
</p>
<p>H1 : δB &gt; δA
and
</p>
<p>H0 : δB &le; δA.
We note that the two hypotheses are disjoint and the union of them covers all possible
</p>
<p>differences of δB and δA. There is a boundary value (δB = δA) which separates the
two hypotheses. Since we want to show the superiority of B, the hypothesis was
</p>
<p>formulated as a one-sided hypothesis. Note that there are different ways to formulate
</p>
<p>two-sample hypotheses; for example, H1 : δB &gt; δA is equivalent to H1 : δB &minus; δA &gt;
0. In fact, it is very common to formulate two-sample hypotheses as differences,
</p>
<p>which we will see later in this chapter.
</p>
<p>10.2.3 One- and Two-Sided Tests
</p>
<p>We distinguish between one-sided and two-sided hypotheses and tests. In the previous
</p>
<p>section, we gave an example of a one-sided test.
</p>
<p>For an unknown population parameter θ (e.g. &micro;) and a fixed value θ0 (e.g. 5), the
</p>
<p>following three cases have to be distinguished:
</p>
<p>Case Null hypothesis Alternative hypothesis
</p>
<p>(a) θ = θ0 θ �= θ0 Two-sided test problem
(b) θ &ge; θ0 θ &lt; θ0 One-sided test problem
(c) θ &le; θ0 θ &gt; θ0 One-sided test problem</p>
<p/>
</div>
<div class="page"><p/>
<p>212 10 Hypothesis Testing
</p>
<p>Example 10.2.1 One-sample problems often test whether a target value is achieved
</p>
<p>or not. For example, consider the null hypothesis as
</p>
<p>&bull; H0 : average filling weight of packages of flour = 1 kg
&bull; H0 : average body height (men) = 178 cm.
</p>
<p>The alternative hypothesis H1 is formulated as deviation from the target value. If
</p>
<p>deviations in both directions are interesting, then H1 is formulated as a two-sided
</p>
<p>hypothesis,
</p>
<p>&bull; H1 : average body height (men) �= 178 cm.
</p>
<p>If deviations in a specific direction are the subject of interest, then H1 is formulated
</p>
<p>as a one-sided hypothesis, for example,
</p>
<p>&bull; H1 : average filling weight of flour packages is lower than 1 kg.
&bull; H1 : average filling weight of flour packages is greater than 1 kg.
</p>
<p>Two-sample problems often examine differences of two samples. Suppose the
</p>
<p>null hypothesis H0 is related to the average weight of flour packages filled by two
</p>
<p>machines, say 1 and 2. Then, the null hypothesis is
</p>
<p>&bull; H0 : average weight of flour packages filled by machine 1 = average weight of
flour packages filled by machine 2.
</p>
<p>Then, H1 can be formulated as a one-sided or two-sided hypothesis. If we want to
</p>
<p>prove that machine 1 and machine 2 have different filling weights, then H1 would
</p>
<p>be formulated as a two-sided hypothesis
</p>
<p>&bull; H1 : average filling weight of machine 1 �= average filling weight of machine 2.
</p>
<p>If we want to prove that machine 1 has lower average filling weight than machine 2,
</p>
<p>H1 would be formulated as a one-sided hypothesis
</p>
<p>&bull; H1 : average filling weight of machine 1 &lt; average filling weight of machine 2.
</p>
<p>If we want to prove that machine 2 has lower filling weight than machine 1, H1
would be formulated as a one-sided hypothesis
</p>
<p>&bull; H1 : average filling weight of machine 1 &gt; average filling weight of machine 2.
</p>
<p>Remark 10.2.1 Note that we have not considered the following situation: H0 : θ �=
θ0, H1 : θ = θ0. In general, with the tests described in this chapter, we cannot prove
the equality of a parameter to a predefined value and neither can we prove the
</p>
<p>equality of two parameters, as in H0 : θ1 �= θ2, H1 : θ1 = θ2. We can, for example,</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Basic Definitions 213
</p>
<p>not prove (statistically) that machines 1 and 2 in the previous example provide equal
</p>
<p>filling weight. This would lead to the more complex class of equivalence tests, which
</p>
<p>is a topic beyond the scope of this book.
</p>
<p>10.2.4 Type I and Type II Error
</p>
<p>If we undertake a statistical test, two types of error can occur.
</p>
<p>&bull; The hypothesis H0 is true but is rejected; this error is called type I error.
&bull; The hypothesis H0 is not rejected although it is wrong; this is called type II error.
</p>
<p>When a hypothesis is tested, then the following four situations are possible:
</p>
<p>H0 is true H0 is not true
</p>
<p>H0 is not rejected Correct decision Type II error
</p>
<p>H0 is rejected Type I error Correct decision
</p>
<p>The significance level is the probability of type I error, P(H1|H0) = α, which is the
probability of rejecting H0 (accepting H1) if H0 is true. If we construct a test, the
</p>
<p>significance level α is prespecified, e.g. α = 0.05. A significance test is constructed
such that the probability of a type I error does not exceed α while the probability of a
</p>
<p>type II error depends on the true but unknown parameter values in the population(s)
</p>
<p>and the sample size. Therefore, the two errors are not symmetrically treated in a
</p>
<p>significance test. In fact, the type II error β, P(H0|H1) = β is not controlled by
the construction of the test and can become very high, sometimes up to 1 &minus; α.
This is the reason why a test not rejecting H0 is not a (statistical) proof of H0.
</p>
<p>In mathematical statistics, one searches for the best test which maintains α and
</p>
<p>minimizes β. Minimization of both α and β simultaneously is not possible. The
</p>
<p>reason is that when α increases then β decreases and vice versa. So one of the errors
</p>
<p>needs to be fixed and the other error is minimized. Consequently, the error which
</p>
<p>is considered more serious is fixed and then the other error is minimized. The tests
</p>
<p>discussed in the below sections are obtained based on the assumption that the type I
</p>
<p>error is more serious than the type II error. So the test statistics are obtained by fixing
</p>
<p>α and then minimizing β. In fact, the null hypothesis is framed in such a way that
</p>
<p>it implies that the type I error is more serious than the type II error. The probability
</p>
<p>1 &minus; β = P(H1|H1) is called the power of the test. It is the probability of making a
decision in favour of the research hypothesis H1, if it is true, i.e. the probability of
</p>
<p>detecting a correct research hypothesis.</p>
<p/>
</div>
<div class="page"><p/>
<p>214 10 Hypothesis Testing
</p>
<p>10.2.5 How to Conduct a Statistical Test
</p>
<p>In general, we can follow the steps described below to test a hypothesis about a
</p>
<p>population parameter based on a sample of data.
</p>
<p>(1) Define the distributional assumptions for the random variables of interest, and
</p>
<p>specify them in terms of population parameters (e.g. θ or &micro; and σ). This is neces-
</p>
<p>sary for parametric tests. There are other types of tests, so-called nonparametric
</p>
<p>tests, where the assumptions can be relaxed in the sense that we do not have to
</p>
<p>specify a particular distribution, see Sect. 10.6ff. Moreover, for some tests the
</p>
<p>distributional assumptions can be relaxed if the sample size is large.
</p>
<p>(2) Formulate the null hypothesis and the alternative hypothesis as described in
</p>
<p>Sects. 10.2.2 and 10.2.3.
</p>
<p>(3) Fix a significance value (often called type I error) α, for example α = 0.05, see
also Sect. 10.2.4.
</p>
<p>(4) Construct a test statistic T (X) = T (X1, X2, . . . , Xn). The distribution of T has
to be known under the null hypothesis H0. We note again that (X1, X2, . . . ,
</p>
<p>Xn) refers to the random variables before drawing the actual sample and
</p>
<p>x1, x2, . . . , xn are the realized values (observations) in the sample.
</p>
<p>(5) Construct a critical region K for the statistic T , i.e. a region where&mdash;if T falls
</p>
<p>in this region&mdash;H0 is rejected, such that
</p>
<p>PH0(T (X) &isin; K ) &le; α .
The notation PH0(&middot;) means that this inequality must hold for all parameter values
θ that belong to the null hypothesis H0. Since we assume that we know the
</p>
<p>distribution of T (X) under H0, the critical region is defined by those values of
</p>
<p>T (X) which are unlikely (i.e. with probability of less than α) to be observed
</p>
<p>under the null hypothesis. Note that although T (X) is a random variable, K is a
</p>
<p>well-defined region, see Fig. 10.1 for an example.
</p>
<p>(6) Calculate t (x) = T (x1, x2, . . . , xn) based on the realized sample values X1 =
x1, X2 = x2, . . . , Xn = xn .
</p>
<p>(7) Decision rule: if t (x) falls into the critical region K , the null hypothesis H0
is rejected. The alternative hypothesis is then statistically proven. If t (x) falls
</p>
<p>outside the critical region, H0 is not rejected.
</p>
<p>t (x) &isin; K : H0 rejected &rArr; H1 is statistically significant,
t (x) /&isin; K : H0 not rejected and therefore accepted.
</p>
<p>The next two paragraphs show how to arrive at the test decisions from step 7 in
</p>
<p>a different way. Readers interested in an example of a statistical test may jump
</p>
<p>to Sect. 10.3.1 and possibly also Example 10.3.1.</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Basic Definitions 215
</p>
<p>10.2.6 Test Decisions Using the p-Value
</p>
<p>Statistical software usually does not show us all the steps of hypothesis testing as
</p>
<p>outlined in Sect. 10.2.5. It is common that instead of calculating and reporting the
</p>
<p>critical values, the test statistic is printed together with the so-called p-value. It is
</p>
<p>possible to use the p-value instead of critical regions for making test decisions. The
</p>
<p>p-value of the test statistic T (X) is defined as follows:
</p>
<p>two-sided case: PH0(|T | &ge; t (x)) = p-value
one-sided case: PH0(T &ge; t (x)) = p-value
</p>
<p>PH0(T &le; t (x)) = p-value
It can be interpreted as the probability of observing results equal to, or more extreme
</p>
<p>than those actually observed if the null hypothesis was true. Then, the decision rule
</p>
<p>is
</p>
<p>H0 is rejected if the p-value is smaller than the prespecified significance level α.
</p>
<p>Otherwise, H0 cannot be rejected.
</p>
<p>Example 10.2.2 Assume that we are dealing with a two-sided test and assume further
</p>
<p>that the test statistic T (x) is N (0, 1)-distributed under H0. The significance level is
</p>
<p>α = 0.05. If we observe, for example, t = 3, then the p-value is PH0(|T | &ge; 3). This
can be calculated in R as
</p>
<p>2*(1-pnorm(3))
</p>
<p>because pnorm() is used to calculate P(X &le; x), and therefore, 1-pnorm() can be
used to calculate P(X &gt; x). We have to multiply with two because we are deal-
</p>
<p>ing with a two-sided hypothesis. The result is p = 0.002699796. Therefore, H0 is
rejected. The one-sided p-value is half of the two-sided p-value, i.e. P(T &ge; 3) =
P(T &le; 3) = 0.001349898, and is not necessarily reported by R. It is therefore impor-
tant to look carefully at the R output when dealing with one-sided hypotheses.
</p>
<p>The p-value is sometimes also called the significance, although we prefer the term
</p>
<p>p-value. We use the term significance only in the context of a test result: a test is
</p>
<p>(statistically) significant if (and only if) H0 can be rejected.
</p>
<p>Unfortunately, the p-value is often over-interpreted: both a test and the p-value
</p>
<p>can only provide a yes/no decision: either H0 is rejected or not. Interpreting the p-
</p>
<p>value as the probability that the null hypothesis is true is wrong! It is also incorrect to
</p>
<p>say that the p-value is the probability of making an error during the test decision. In
</p>
<p>our (frequentist) context, hypotheses are true or false and no probability is assigned
</p>
<p>to them. It can also be misleading to speak of &ldquo;highly significant&rdquo; results if the p-
</p>
<p>value is very small. A last remark: the p-value itself is a random variable: under the
</p>
<p>null hypothesis, it follows a uniform distribution, i.e. p &sim; U (0, 1).</p>
<p/>
</div>
<div class="page"><p/>
<p>216 10 Hypothesis Testing
</p>
<p>10.2.7 Test Decisions Using Confidence Intervals
</p>
<p>There is an interesting and useful relationship between confidence intervals and
</p>
<p>hypothesis tests. If the null hypothesis H0 is rejected at the significance level α, then
</p>
<p>there exists a 100(1 &minus; α)% confidence interval which yields the same conclusion as
the test: if the appropriate confidence interval does not contain the value θ0 targeted
</p>
<p>in the hypothesis, then H0 is rejected. We call this duality. For example, recall
</p>
<p>Example 10.1.2 where we were interested in whether the average change in blood
</p>
<p>pressure for drug B is higher than for drug A, i.e. H1 : δB &gt; δA. This hypothesis is
equivalent to H1 : δB &minus; δA &gt; δ0 = 0. In the following section, we develop tests to
decide whether H1 is statistically significant or not. Alternatively, we could construct
</p>
<p>a 100(1 &minus; α)% confidence interval for the difference δB &minus; δA and evaluate whether
the interval contains δ0 = 0 or not; if yes, we accept H0; otherwise, we reject it. For
some of the tests introduced in following section, we refer to the confidence intervals
</p>
<p>which lead to the same results as the corresponding test.
</p>
<p>10.3 Parametric Tests for Location Parameters
</p>
<p>10.3.1 Test for the Mean When the Variance is Known (One-Sample
Gauss Test)
</p>
<p>We develop a hypothesis test to test whether the unknown mean (expectation) &micro; of a
</p>
<p>N (&micro;,σ2)-distributed random variable X either differs from a specific value &micro; = &micro;0
or is smaller (or greater) than &micro;0. We assume that the variance σ
</p>
<p>2 = σ20 is known.
We apply the scheme of Sect. 10.2.5 step by step to develop the test procedure and
</p>
<p>then give an illustrative example.
</p>
<p>1. Distributional assumption: The random variable X follows a N (&micro;,σ20)- distribu-
</p>
<p>tion with known variance σ20 . We assume that an i.i.d. random sample is drawn from
</p>
<p>X1, X2, . . . , Xn where the X i s follow the same distribution as X , i = 1, 2, . . . , n.
2. Define any of the following set of hypotheses H0 and H1:
</p>
<p>H0 : &micro; = &micro;0 versus H1 : &micro; �= &micro;0, (two-sided test)
H0 : &micro; &le; &micro;0 versus H1 : &micro; &gt; &micro;0, (one-sided test)
H0 : &micro; &ge; &micro;0 versus H1 : &micro; &lt; &micro;0, (one-sided test).
</p>
<p>3. Specify the probability of a type I error α: Often α = 0.05 = 5 % is chosen.
4. Construct a test statistic: The unknown mean, i.e. the expectation &micro;, is usually
</p>
<p>estimated by the sample mean x̄ . We already know that if the X i s are i.i.d., then the
</p>
<p>sample mean is normally distributed. Under the assumption that H0 is true,
</p>
<p>X̄ = 1
n
</p>
<p>n
&sum;
</p>
<p>i=1
X i
</p>
<p>H0&sim; N (&micro;0,σ20/n),</p>
<p/>
</div>
<div class="page"><p/>
<p>10.3 Parametric Tests for Location Parameters 217
</p>
<p>where
H0&sim; means the &ldquo;distribution under H0&rdquo;. If we standardize the mean under H0,
</p>
<p>we get a N (0, 1)-distributed test statistic
</p>
<p>T (X) = X̄ &minus; &micro;0
σ0
</p>
<p>&radic;
n
</p>
<p>H0&sim; N (0, 1),
</p>
<p>see also Theorem 7.3.2. Note that T (X) follows a normal distribution even if the
</p>
<p>X i s are not normally distributed and if n is large enough which follows from the
</p>
<p>Central Limit Theorem (Appendix C.3). One can conclude that the distributional
</p>
<p>assumption from step 1 is thus particularly important for small samples, but not
</p>
<p>necessarily important for large samples. As a rule of thumb, n &ge; 30 is considered
to be a large sample. This rule is based on the knowledge that a t-distribution with
</p>
<p>more than 30 degrees of freedom gets very close to a N (0, 1)-distribution.
</p>
<p>5. Critical region: Since the test statistic T (X) is N (0, 1)-distributed, we get the
</p>
<p>following critical regions, depending on the hypothesis:
</p>
<p>Case H0 H1 Critical region K
</p>
<p>(a) &micro; = &micro;0 &micro; �= &micro;0 K = (&minus;&infin;,&minus;z1&minus;α/2) &cup; (z1&minus;α/2,&infin;)
(b) &micro; &le; &micro;0 &micro; &gt; &micro;0 K = (z1&minus;α,&infin;)
(c) &micro; &ge; &micro;0 &micro; &lt; &micro;0 K = (&minus;&infin;, zα = &minus;z1&minus;α)
</p>
<p>For case (a) with H0: &micro; = &micro;0 and H1: &micro; �= &micro;0, we are interested in extreme
values of the test statistic on both tails: very small values and very large values of the
</p>
<p>test statistic give us evidence that H0 is wrong (because the statistic is mainly driven
</p>
<p>by the difference of the sample mean and the test value &micro;0 for a fixed variance),
</p>
<p>see Fig. 10.1. In such a two-sided test, when the distribution of the test statistic is
</p>
<p>symmetric, we divide the critical region into two equal parts and assign each region
</p>
<p>of size α/2 to the left and right tails of the distribution. For α = 0.05, 2.5 % of the
most extreme values towards the right end of the distribution and 2.5 % of the most
</p>
<p>extreme values towards the left end of the distribution give us enough evidence that
</p>
<p>H0 is wrong and can be rejected and that H1 is accepted. It is also clear why α is
</p>
<p>zα/2 = &minus;z1&minus;α/2 z1&minus;α/2
</p>
<p>Fig. 10.1 Critical region of a two-sided one-sample Gauss-test H0: &micro; = &micro;0 versus H1: &micro; �= &micro;0.
The critical region K = (&minus;&infin;,&minus;z1&minus;α/2) &cup; (z1&minus;α/2,&infin;) has probability mass α if H0 is true&lowast;</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>218 10 Hypothesis Testing
</p>
<p>z1&minus;α
</p>
<p>Fig. 10.2 Critical region of a one-sided one-sample Gauss test H0: &micro; &le; &micro;0 versus H1: &micro; &gt; &micro;0.
The critical region K = (z1&minus;α,&infin;) has probability mass α if H0 is true&lowast;
</p>
<p>the probability of a type I error: the most extreme values in the two tails together
</p>
<p>have 5 % probability and are just the probability that the test statistic falls into the
</p>
<p>critical region although H0 is true. Also, these areas are those which have the least
</p>
<p>probability of occurring if H0 is true. For α = 0.05, we get z1&minus; α2 = 1.96.
</p>
<p>For case (b), only one direction is of interest. The critical region lies on the right
</p>
<p>tail of the distribution of the test statistic. A very large value of the test statistic has
</p>
<p>a low probability of occurrence if H0 is true. An illustration is given in Fig. 10.2: for
</p>
<p>α = 0.05, we get z1&minus;α = 1.64 and any values greater than 1.64 are unlikely to be
observed under H0. Analogously, the critical region for case (c) is constructed. Here,
</p>
<p>the shaded area (critical region) is on the left-hand side. In this case, for α = 0.05,
we get zα = &minus;z1&minus;α = &minus;1.64.
</p>
<p>6. Realization of the test statistic: For an observed sample x1, x2, . . . , xn , the arith-
</p>
<p>metic mean
</p>
<p>x̄ = 1
n
</p>
<p>n
&sum;
</p>
<p>i=1
xi
</p>
<p>is used to calculate the realized (observed) test statistic t (x) = T (x1, x2,. . . , xn) as
</p>
<p>t (x) = x̄ &minus; &micro;0
σ0
</p>
<p>&radic;
n.
</p>
<p>7. Test decision: If the realized test statistic from step 6 falls into the critical region,
</p>
<p>H0 is rejected (and therefore, H1 is statistically proven). Table 10.1 summarizes the
</p>
<p>test decisions depending on t (x) and the quantiles defining the appropriate critical
</p>
<p>regions.
</p>
<p>Example 10.3.1 A bakery supplies loaves of bread to supermarkets. The stated sell-
</p>
<p>ing weight (and therefore the required minimum expected weight) is &micro; = 2 kg.
However, not every package weighs exactly 2 kg because there is variability in the
</p>
<p>weights. It is therefore important to find out if the average weight of the loaves</p>
<p/>
</div>
<div class="page"><p/>
<p>10.3 Parametric Tests for Location Parameters 219
</p>
<p>Table 10.1 Rules to make test decisions for the one-sample Gauss test (and the two-sample Gauss
</p>
<p>test, the one-sample approximate binomial test, and the two-sample approximate binomial test&mdash;
</p>
<p>which are all discussed later in this chapter)
</p>
<p>Case H0 H1 Reject H0 if
</p>
<p>(a) &micro; = &micro;0 &micro; �= &micro;0 |t (x)| &gt; z1&minus;α/2
(b) &micro; &ge; &micro;0 &micro; &lt; &micro;0 t (x) &lt; zα
(c) &micro; &le; &micro;0 &micro; &gt; &micro;0 t (x) &gt; z1&minus;α
</p>
<p>is significantly smaller than 2 kg. The weight X (measured in kg) of the loaves is
</p>
<p>assumed to be normally distributed. We assume that the variance σ20 = 0.12 is known
from experience. A supermarket draws a sample of n = 20 loaves and weighs them.
The average weight is calculated as x̄ = 1.97 kg. Since the supermarket wants to be
sure that the weights are, on average, not lower than 2 kg, a one-sided hypothesis
</p>
<p>is appropriate and is formulated as H0: &micro; &ge; &micro;0 = 2 kg versus H1: &micro; &lt; &micro;0 = 2 kg.
The significance level is specified as α = 0.05, and therefore, z1&minus;α = 1.64. The test
statistic is calculated as
</p>
<p>t (x) = x̄ &minus; &micro;0
σ0
</p>
<p>&radic;
n = 1.97 &minus; 2
</p>
<p>0.1
</p>
<p>&radic;
20 = &minus;1.34.
</p>
<p>The null hypothesis is not rejected, since t (x) = &minus;1.34 &gt; &minus;1.64 = &minus;z1&minus;0.05 =
z0.05.
</p>
<p>Interpretation: The sample average x̄ = 1.97 kg is below the target value of&micro; = 2 kg.
But there is not enough evidence to reject the hypothesis that the sample comes from
</p>
<p>a N (2, 0.12)-distributed population. The probability to observe a sample of size
</p>
<p>n = 20 with an average of at most 1.97 in a N (2, 0.12)-distributed population is
greater than α = 0.05 = 5 %. The difference between x̄ = 1.97 kg and the target
value &micro; = 2 kg is not statistically significant.
</p>
<p>Remark 10.3.1 The Gauss test assumes the variance to be known, which is often
</p>
<p>not the case in practice. The t-test (Sect. 10.3.2) assumes that the variance needs to
</p>
<p>be estimated. The t-test is therefore commonly employed when testing hypotheses
</p>
<p>about the mean. Its usage is outlined below. In R, the command Gauss.test from
</p>
<p>the library compositions offers an implementation of the Gauss test.
</p>
<p>10.3.2 Test for the Mean When the Variance is Unknown
(One-Sample t-Test)
</p>
<p>If the variance σ2 is unknown, hypotheses about the mean &micro; of a normal random
</p>
<p>variable X &sim; N (&micro;,σ2) can be tested in a similar way to the one-sample Gauss
test. The difference is that the unknown variance is estimated from the sample. An</p>
<p/>
</div>
<div class="page"><p/>
<p>220 10 Hypothesis Testing
</p>
<p>unbiased estimator of σ2 is the sample variance
</p>
<p>S2X =
1
</p>
<p>n &minus; 1
</p>
<p>n
&sum;
</p>
<p>i=1
(X i &minus; X̄)2.
</p>
<p>The test statistic is therefore
</p>
<p>T (X) = X̄ &minus; &micro;0
SX
</p>
<p>&radic;
n,
</p>
<p>which follows a t-distribution with n &minus; 1 degrees of freedom if H0 is true, as we
know from Theorem 8.3.2.
</p>
<p>Critical regions and test decisions
</p>
<p>Since T (X) follows a t-distribution under H0, the critical regions refer to the regions
</p>
<p>of the t-distribution which are unlikely to be observed under H0:
</p>
<p>Case H0 H1 Critical region K
</p>
<p>(a) &micro; = &micro;0 &micro; �= &micro;0 K = (&minus;&infin;,&minus;tn&minus;1;1&minus;α/2) &cup; (tn&minus;1;1&minus;α/2,&infin;)
(b) &micro; &ge; &micro;0 &micro; &lt; &micro;0 K = (&minus;&infin;,&minus;tn&minus;1;1&minus;α)
(c) &micro; &le; &micro;0 &micro; &gt; &micro;0 K = (tn&minus;1;1&minus;α,&infin;)
</p>
<p>The hypothesis H0 is rejected if the realized test statistic, i.e.
</p>
<p>t (x) = x̄ &minus; &micro;0
sX
</p>
<p>&radic;
n,
</p>
<p>falls into the critical region. The critical regions are based on the appropriate quantiles
</p>
<p>of the t-distribution with (n &minus; 1) degrees of freedom, as outlined in Table 10.2.
</p>
<p>Example 10.3.2 We again consider Example 10.3.1. Now we assume that the vari-
</p>
<p>ance of the loaves is unknown. Suppose a random sample of size n = 20 has an
arithmetic mean of x̄ = 1.9668 and a sample variance of s2 = 0.09272. We want to
test whether this result contradicts the two-sided hypothesis H0: &micro; = 2, that is case
(a). The significance level is fixed at α = 0.05. For the realized test statistic t (x), we
calculate
</p>
<p>t (x) = x̄ &minus; &micro;0
sX
</p>
<p>&radic;
n = 1.9668 &minus; 2
</p>
<p>0.0927
</p>
<p>&radic;
20 = &minus;1.60.
</p>
<p>Table 10.2 Rules to make test decisions for the one-sample t-test (and the two-sample t-test, and
</p>
<p>the paired t-test, both explained below)
</p>
<p>Case H0 H1 Reject H0, if
</p>
<p>(a) &micro; = &micro;0 &micro; �= &micro;0 |t (x)| &gt; tn&minus;1;1&minus;α/2
(b) &micro; &ge; &micro;0 &micro; &lt; &micro;0 t (x) &lt; &minus;tn&minus;1;1&minus;α
(c) &micro; &le; &micro;0 &micro; &gt; &micro;0 t (x) &gt; tn&minus;1;1&minus;α</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>10.3 Parametric Tests for Location Parameters 221
</p>
<p>H0 is not rejected since |t | = 1.60 &lt; 2.09 = t19;0.975, where the quantiles &plusmn;2.09
are defining the critical region (see Table C.2 or use R: qt(0.975,19)). The same
</p>
<p>results can be obtained in R using the t.test() function, see Example 10.3.3 for
</p>
<p>more details. Or, we can directly calculate the (two-sided) p-value as
</p>
<p>2*(1-pt(abs(1.6), df=19))
</p>
<p>This yields a p-value of 0.1260951 which is not smaller than α, and therefore,
</p>
<p>H0 is not rejected.
</p>
<p>10.3.3 Comparing the Means of Two Independent Samples
</p>
<p>In a two-sample problem, we may be interested in comparing the means of two inde-
</p>
<p>pendent samples. Assume that we have two samples of two normally distributed vari-
</p>
<p>ables X &sim; N (&micro;X ,σ2X ) and Y &sim; N (&micro;Y ,σ2Y ) of size n1 and n2, i.e. X1, X2, . . . , Xn1
are i.i.d. with the same distribution as X and Y1, Y2, . . . , Yn2 are i.i.d. with the same
</p>
<p>distribution as Y . We can specify the following hypotheses:
</p>
<p>Case Null hypothesis Alternative hypothesis
</p>
<p>(a) &micro;X = &micro;Y &micro;X �= &micro;Y Two-sided test problem
(b) &micro;X &ge; &micro;Y &micro;X &lt; &micro;Y One-sided test problem
(c) &micro;X &le; &micro;Y &micro;X &gt; &micro;Y One-sided test problem
</p>
<p>We distinguish another three cases:
</p>
<p>1. σ2X and σ
2
Y are known.
</p>
<p>2. σ2X and σ
2
Y are unknown, but they are assumed to be equal, i.e. σ
</p>
<p>2
X = σ2Y .
</p>
<p>3. Both σ2X and σ
2
Y are unknown and unequal (σ
</p>
<p>2
X �= σ2Y ).
</p>
<p>Case 1: The variances are known (two-sample Gauss test).
</p>
<p>If the null hypothesis H0: &micro;X = &micro;Y is true, then, using the usual rules for the normal
distribution and the independence of the samples,
</p>
<p>X̄ &sim; N
(
</p>
<p>&micro;X ,
σ2X
n1
</p>
<p>)
</p>
<p>,
</p>
<p>Ȳ &sim; N
(
</p>
<p>&micro;Y ,
σ2Y
n2
</p>
<p>)
</p>
<p>,
</p>
<p>and
</p>
<p>(X̄ &minus; Ȳ ) &sim; N
(
</p>
<p>&micro;Y &minus; &micro;Y ,
σ2X
n1
</p>
<p>+
σ2Y
n2
</p>
<p>)
</p>
<p>.</p>
<p/>
</div>
<div class="page"><p/>
<p>222 10 Hypothesis Testing
</p>
<p>It follows that the test statistic
</p>
<p>T (X, Y) = X̄ &minus; Ȳ&radic;
σ2X
n1
</p>
<p>+ σ
2
Y
</p>
<p>n2
</p>
<p>(10.1)
</p>
<p>follows a standard normal distribution, T (X, Y) &sim; N (0, 1). The realized test statistic
is
</p>
<p>t (x, y) = x̄ &minus; ȳ&radic;
σ2X
n1
</p>
<p>+ σ
2
Y
</p>
<p>n2
</p>
<p>. (10.2)
</p>
<p>The test procedure is identical to the procedure of the one-sample Gauss test intro-
</p>
<p>duced in Sect. 10.3.1; that is, the test decision is based on Table 10.1.
</p>
<p>Case 2: The variances are unknown, but equal (two-sample t-test).
</p>
<p>We denote the unknown variance of both distributions as σ2 (i.e. both the populations
</p>
<p>are assumed to have varianceσ2). We estimateσ2 by using the pooled sample variance
</p>
<p>where each sample is assigned weights relative to the sample size:
</p>
<p>S2 =
(n1 &minus; 1)S2X + (n2 &minus; 1)S2Y
</p>
<p>n1 + n2 &minus; 2
. (10.3)
</p>
<p>The test statistic
</p>
<p>T (X, Y) = X̄ &minus; Ȳ
S
</p>
<p>&radic;
</p>
<p>n1 &middot; n2
n1 + n2
</p>
<p>(10.4)
</p>
<p>with S as in (10.3) follows a t-distribution with n1 + n2 &minus; 2 degrees of freedom if
H0 is true. The realized test statistic is
</p>
<p>t (x, y) = x̄ &minus; ȳ
s
</p>
<p>&radic;
</p>
<p>n1 &middot; n2
n1 + n2
</p>
<p>. (10.5)
</p>
<p>The test procedure is identical to the procedure of the one-sample t-test; that is, the
</p>
<p>test decision is based on Table 10.2.
</p>
<p>Case 3: The variances are unknown and unequal (Welch test).
</p>
<p>We test H0: &micro;X = &micro;Y versus H1: &micro;X �= &micro;Y given σ2X �= σ2Y and both σ2X and σ2Y
are unknown. This problem is also known as the Behrens&ndash;Fisher problem and is the
</p>
<p>most frequently used test when comparing two means in practice. The test statistic
</p>
<p>can be written as
</p>
<p>T (X, Y) =
∣
</p>
<p>∣X̄ &minus; Ȳ
∣
</p>
<p>∣
</p>
<p>&radic;
</p>
<p>S2X
n1
</p>
<p>+ S
2
Y
</p>
<p>n2
</p>
<p>, (10.6)
</p>
<p>which is approximately t-distributed with v degrees of freedom:
</p>
<p>v =
(
</p>
<p>s2x
</p>
<p>n1
+
</p>
<p>s2y
</p>
<p>n2
</p>
<p>)2
</p>
<p>/
</p>
<p>⎛
</p>
<p>⎜
</p>
<p>⎝
</p>
<p>(
</p>
<p>s2x /n1
)2
</p>
<p>n1 &minus; 1
+
</p>
<p>(
</p>
<p>s2y/n2
</p>
<p>)2
</p>
<p>n2 &minus; 1
</p>
<p>⎞
</p>
<p>⎟
</p>
<p>⎠
(10.7)</p>
<p/>
</div>
<div class="page"><p/>
<p>10.3 Parametric Tests for Location Parameters 223
</p>
<p>where s2x and s
2
y are the estimated values of S
</p>
<p>2
X = 1n&minus;1
</p>
<p>&sum;n
i=1(X i &minus; X̄)2 and S2Y =
</p>
<p>1
n&minus;1
</p>
<p>&sum;n
i=1(Yi &minus; Ȳ )2, respectively. The test procedure, using the observed test statistic
</p>
<p>t (x, y) = |x̄ &minus; ȳ|&radic;
s2X
n1
</p>
<p>+ s
2
Y
</p>
<p>n2
</p>
<p>, (10.8)
</p>
<p>is identical to the procedure of the one-sample t-test; that is, the test decision is based
</p>
<p>on Table 10.2 except that the degrees of freedom are not n &minus; 1 but v. If v is not an
integer, it can be rounded off to an integer value.
</p>
<p>Example 10.3.3 A small bakery sells cookies in packages of 500 g. The cookies are
</p>
<p>handmade and the packaging is either done by the baker himself or his wife. Some
</p>
<p>customers conjecture that the wife is more generous than the baker. One customer
</p>
<p>does an experiment: he buys packages of cookies packed by the baker and his wife
</p>
<p>on 16 different days and weighs the packages. He gets the following two samples
</p>
<p>(one for the baker, one for his wife).
</p>
<p>Weight (wife) (X ) 512 530 498 540 521 528 505 523
</p>
<p>Weight (baker) (Y ) 499 500 510 495 515 503 490 511
</p>
<p>We want to test whether the complaint of the customers is justified. Let us start
</p>
<p>with the following simple hypotheses:
</p>
<p>H0 : &micro;x = &micro;y versus H1 : &micro;x �= &micro;y,
i.e. we only want to test whether the weights are different, not that the wife is making
</p>
<p>heavier cookie packages. Since the variances are unknown, we assume that case 3 is
</p>
<p>the right choice. We calculate and obtain x̄ = 519.625, ȳ = 502.875, s2X = 192.268,
and s2Y = 73.554. The test statistic is:
</p>
<p>t (x, y) = |x̄ &minus; ȳ|&radic;
s2X
n1
</p>
<p>+ s
2
Y
</p>
<p>n2
</p>
<p>= |519.625 &minus; 502.875|&radic;
192.268
</p>
<p>8
+ 73.554
</p>
<p>8
</p>
<p>&asymp; 2.91.
</p>
<p>The degrees of freedom are:
</p>
<p>v =
(
</p>
<p>192.268
</p>
<p>8
+ 73.554
</p>
<p>8
</p>
<p>)2
</p>
<p>/
</p>
<p>(
</p>
<p>(192.268/8)2
</p>
<p>7
+ (73.554/8)
</p>
<p>2
</p>
<p>7
</p>
<p>)
</p>
<p>&asymp; 11.67 &asymp; 12.
</p>
<p>Since |t (x)| = 2.91 &gt; 2.18 = t12;0.975, it follows that H0 is rejected. Therefore, H1 is
statistically significant. This means that the mean weight of the wife&rsquo;s packages is
</p>
<p>different from the mean weight of the baker&rsquo;s packages. Let us refine the hypothesis
</p>
<p>and try to find out whether the wife&rsquo;s packages have a higher mean weight. The
</p>
<p>hypotheses are now:
</p>
<p>H0 : &micro;x &le; &micro;y versus H1 : &micro;x &gt; &micro;y .</p>
<p/>
</div>
<div class="page"><p/>
<p>224 10 Hypothesis Testing
</p>
<p>The test statistic remains the same but the critical region and the degrees of freedom
</p>
<p>change. Thus, H0 is rejected if t (x, y) &gt; tv;1&minus;α. Using tv;1&minus;α = t12;0.95 &asymp; 1.78 and
t (x, y) = 2.91, it follows that the null hypothesis can be rejected. The mean weight
</p>
<p>of the wife&rsquo;s packages is greater than the mean weight of the baker&rsquo;s packages.
</p>
<p>In R, we would have obtained the same result using the t.test command:
</p>
<p>x &lt;- c(512,530,498,540,521,528,505,523)
</p>
<p>y &lt;- c(499,500,510,495,515,503,490,511)
</p>
<p>t.test(x,y,alternative='greater')
</p>
<p>Welch Two-Sample t-test
</p>
<p>data: x and y
</p>
<p>t = 2.9058, df = 11.672, p-value = 0.006762
</p>
<p>alternative hypothesis: true difference in means is greater
</p>
<p>than 0...
</p>
<p>Note that we have to specify the alternative hypothesis under the option alter-
</p>
<p>native. The output shows us the test statistic (2.9058), the degrees of freedom
</p>
<p>(11.672), the alternative hypothesis&mdash;but not the decision rule. We know that H0
is rejected if t (x, y) &gt; tv;1&minus;α, so the decision is easy in this case: we simply have
to calculate t12;0.95 using qt(0.95,12) in R. A simpler way to arrive at the same
decision is to use the p-value. We know that H0 is rejected if p &lt; α which is the
</p>
<p>case in this example. It is also worthwhile mentioning that R displays the hypothe-
</p>
<p>ses slightly differently from ours: our alternative hypothesis is &micro;x &gt; &micro;y which is
</p>
<p>identical to the statement &micro;x &minus; &micro;y &gt; 0, as shown by R, see also Sect. 10.2.2.
If we specify two.sided as an alternative (which is the default), a confidence
</p>
<p>interval for the mean difference is also part of the output:
</p>
<p>t.test(x,y,alternative='two.sided')
</p>
<p>...
</p>
<p>95 % confidence interval:
</p>
<p>4.151321 29.348679
</p>
<p>It can be seen that the confidence interval of the difference does not cover the &ldquo;0&rdquo;.
</p>
<p>Therefore, the null hypothesis is rejected. This is the duality property referred to
</p>
<p>earlier in this chapter: the test decision is the same, no matter whether one evaluates
</p>
<p>(i) the confidence interval, (ii) the test statistic, or (iii) the p-value.
</p>
<p>Any kind of t-test can be calculated with the t.test command: for example,
</p>
<p>the two-sample t-test requires to specify the option var.equal=TRUE while the
</p>
<p>Welch test is calculated when the (default) option var.equal=FALSE is set. We can
</p>
<p>also conduct a one-sample t-test. Suppose we are interested in whether the mean</p>
<p/>
</div>
<div class="page"><p/>
<p>10.3 Parametric Tests for Location Parameters 225
</p>
<p>weight of the wife&rsquo;s packages of cookies is greater than 500 g; then, we could test
</p>
<p>the hypotheses:
</p>
<p>H0 : &micro;x &le; 500 versus H1 : &micro;x &gt; 500.
In R, we simply have to specify &micro;0:
</p>
<p>t.test(x,mu=500,alternative='greater')
</p>
<p>which gives us
</p>
<p>One-Sample t-test
</p>
<p>data: x
</p>
<p>t = 4.0031, df = 7, p-value = 0.002585
</p>
<p>alternative hypothesis: true mean is greater than 500
</p>
<p>...
</p>
<p>10.3.4 Test for Comparing the Means of Two Dependent Samples
(Paired t-Test)
</p>
<p>Suppose there are two dependent continuous random variables X and Y with E(X) =
&micro;X and E(Y ) = &micro;Y . They could be dependent because we measure the same variable
twice on the same subjects at different times. Typically, this is the case in pre&ndash;post
</p>
<p>experiments, for example when we measure the weight of a person before starting a
</p>
<p>special diet and after finishing the diet; or when evaluating household expenditures
</p>
<p>on electronic appliances in two consecutive years. We then say that the samples
</p>
<p>are paired, or dependent. Since the same variable is measured twice on the same
</p>
<p>subject, it makes sense to calculate a difference between the two respective values.
</p>
<p>Let D = X &minus; Y denote the random variable &ldquo;difference of X and Y &rdquo;. If H0:&micro;X = &micro;Y
is true, then the expected difference is zero, and we get E(D) = &micro;D = 0. This means
testing H0 : &micro;X = &micro;Y is identical to testing &micro;X &minus; &micro;Y = &micro;D = 0. We further assume
that D is normally distributed if H0:&micro;X = &micro;Y is true (or equivalently if H0:&micro;D = 0 is
true), i.e. D &sim; N (0,σ2D). For a random sample (D1, D2, . . . , Dn) of the differences,
the test statistic
</p>
<p>T (X, Y) = T (D) = D̄
SD
</p>
<p>&radic;
n (10.9)
</p>
<p>is t-distributed with n &minus; 1 degrees of freedom. The sample mean is D̄ =
&sum;n
</p>
<p>i=1 /Di n
and the sample variance is
</p>
<p>S2D =
&sum;n
</p>
<p>i=1(Di &minus; D̄)2
n &minus; 1</p>
<p/>
</div>
<div class="page"><p/>
<p>226 10 Hypothesis Testing
</p>
<p>which is an estimator of σ2D . The realized test statistic is thus
</p>
<p>t (d) = d̄
sd
</p>
<p>&radic;
n (10.10)
</p>
<p>where d̄ =
&sum;n
</p>
<p>i=1 di/n and s
2
d =
</p>
<p>&sum;n
i=1(di &minus; d̄)2/n &minus; 1.
</p>
<p>The two-sided test H0: &micro;D = 0 versus H1: &micro;D �= 0 and the one-sided tests H0:
&micro;D &le; 0 versus H1: &micro;D &gt; 0 or H0: &micro;D &ge; 0 versus H1: &micro;D &lt; 0 can be derived as in
Sect. 10.3.2; that is, the test decision is based on Table 10.2. In fact, the paired t-test
</p>
<p>is a one-sample t-test on the differences of X and Y .
</p>
<p>Example 10.3.4 In an experiment, n = 10 students have to solve different tasks
before and after drinking a cup of coffee. Let Y and X denote the random variables
</p>
<p>&ldquo;number of points before/after drinking a cup of coffee&rdquo;. Assume that a higher
</p>
<p>number of points means that the student is performing better. Since the test is repeated
</p>
<p>on the same students, we have a paired sample. The data is given in the following
</p>
<p>table:
</p>
<p>i yi (before) xi (after) di = xi &minus; yi (di &minus; d̄)2
1 4 5 1 0
</p>
<p>2 3 4 1 0
</p>
<p>3 5 6 1 0
</p>
<p>4 6 7 1 0
</p>
<p>5 7 8 1 0
</p>
<p>6 6 7 1 0
</p>
<p>7 4 5 1 0
</p>
<p>8 7 8 1 0
</p>
<p>9 6 5 &minus;1 4
10 2 5 3 4
</p>
<p>Total 10 8
</p>
<p>We calculate
</p>
<p>d̄ = 1 and s2d =
8
</p>
<p>9
= 0.9432,
</p>
<p>respectively. For the realized test statistic t (d), using α = 0.05, we get
</p>
<p>t (d) = 1
0.943
</p>
<p>&radic;
10 = 3.35 &gt; t9;0.95 = 1.83,
</p>
<p>such that H0: &micro;X &le; &micro;Y is rejected and H1: &micro;X &gt; &micro;Y is accepted. We can conclude
(for this example) that drinking coffee significantly increased the problem-solving
</p>
<p>capacity of the students.</p>
<p/>
</div>
<div class="page"><p/>
<p>10.3 Parametric Tests for Location Parameters 227
</p>
<p>In R, we would have obtained the same results using the t.test function and
</p>
<p>specifying the option paired=TRUE:
</p>
<p>yp &lt;- c(4,3,5,6,7,6,4,7,6,2)
</p>
<p>xp &lt;- c(5,4,6,7,8,7,5,8,5,5)
</p>
<p>t.test(xp,yp,paired=TRUE)
</p>
<p>Paired t-test
</p>
<p>data: xp and yp
</p>
<p>t = 3.3541, df = 9, p-value = 0.008468
</p>
<p>alternative hypothesis: true difference in means != 0
</p>
<p>95 % confidence interval:
</p>
<p>0.325555 1.674445
</p>
<p>sample estimates:
</p>
<p>mean of the differences
</p>
<p>1
</p>
<p>We can make the test decision using the R output in three different ways:
</p>
<p>(i) We compare the test statistic (t = &minus;3.35) with the critical value (1.83, obtained
via qt(0.95,9)).
</p>
<p>(ii) We evaluate whether the p-value (0.008468) is smaller than the significance
</p>
<p>level α = 0.05.
(iii) We evaluate whether the confidence interval for the mean difference covers &ldquo;0&rdquo;
</p>
<p>or not.
</p>
<p>10.4 Parametric Tests for Probabilities
</p>
<p>10.4.1 One-Sample Binomial Test for the Probability p
</p>
<p>Test construction and hypotheses.
</p>
<p>Let X be a Bernoulli B(1; p) random variable with the two possible outcomes 1
and 0, which indicate occurrence and non-occurrence of an event of interest A. The
</p>
<p>probability for A in the population is p. From the sample X = (X1, X2, . . . , Xn) of
independent B(1; p)-distributed random variables, we calculate the mean (relative
frequency) as p̂ = 1
</p>
<p>n
</p>
<p>&sum;n
i=1 X i which is an unbiased estimate of p. The following
</p>
<p>hypotheses may thus be of interest:
</p>
<p>Case Null hypothesis Alternative hypothesis
</p>
<p>(a) p = p0 p �= p0 Two-sided problem
(b) p &ge; p0 p &lt; p0 One-sided problem
(c) p &le; p0 p &gt; p0 One-sided problem</p>
<p/>
</div>
<div class="page"><p/>
<p>228 10 Hypothesis Testing
</p>
<p>In the following, we describe two possible solutions, one exact approach and an
</p>
<p>approximate solution. The approximate solution is based on the approximation of
</p>
<p>the binomial distribution by the normal distribution, which is appropriate if n is
</p>
<p>sufficiently large and the condition np(1 &minus; p) &ge; 9 holds (i.e. p is neither too small
nor too large). First, we present the approximate solution and then the exact one.
</p>
<p>Test statistic and test decisions.
</p>
<p>(a) Approximate binomial test. We define the standardized test statistic as
</p>
<p>T (X) = p̂ &minus; p0&radic;
p0(1 &minus; p0)
</p>
<p>&radic;
n. (10.11)
</p>
<p>It holds approximately that T (X) &sim; N (0, 1), given that the conditions that (i)
n is sufficiently large and (ii) np(1 &minus; p) &ge; 9 are satisfied. The test can then
be conducted along the lines of the Gauss test in Sect. 10.3.1; that is, the test
</p>
<p>decision is based on Table 10.1.
</p>
<p>Example 10.4.1 We return to Example 10.1.1. Let us assume that a representative
</p>
<p>sample of size n = 2000 has been drawn from the population of eligible voters, from
which 700 (35 %) have voted for the party of interest P . The research hypothesis
</p>
<p>(which has to be stated as H1) is that more than 30 % (i.e. p0 = 0.3) of the eligible
voters cast their votes for party P . The sample is in favour of H1 because p̂ = 35 %,
but to draw conclusions for the proportion of voters of party P in the population,
</p>
<p>we have to conduct a binomial test. Since n is large and np(1 &minus; p) = 2000 &middot; 0.35 &middot;
0.65 = 455 &ge; 9, the assumptions for the use of the test statistic (10.11) are satisfied.
We can write down the realized test statistic as
</p>
<p>t (x) = p̂ &minus; p0&radic;
p0(1 &minus; p0)
</p>
<p>&radic;
n = 0.35 &minus; 0.3&radic;
</p>
<p>0.3(1 &minus; 0.3)
&radic;
</p>
<p>2000 = 4.8795.
</p>
<p>Using α = 0.05, it follows that T (X) = 4.8795 &gt; z1&minus;α = 1.64, and thus, the null
hypothesis H0 : p &le; 0.3 can be rejected. Therefore, H1 : p &gt; 0.3 is statistically
significant; that is, the proportion of votes for party P is greater than 30 %.
</p>
<p>(b) The exact binomial test can be constructed using the knowledge that under H0,
</p>
<p>Y =
&sum;n
</p>
<p>i=1 X i (i.e. the number of successes) follows a binomial distribution. In
fact, we can use Y directly as the test statistic:
</p>
<p>T (X) = Y &sim; B(n, p0) .
The observed test statistic is t (x) =
</p>
<p>&sum;
</p>
<p>i xi . For the two-sided case (a), the two
</p>
<p>critical numbers cl and cr (cl &lt; cr ) which define the critical region, have to be
</p>
<p>found such that
</p>
<p>PH0(Y &le; cl) &le;
α
</p>
<p>2
and PH0(Y &ge; cr ) &le;
</p>
<p>α
</p>
<p>2
.
</p>
<p>The null hypothesis is rejected if the test statistic, i.e. Y , is greater than or equal
</p>
<p>to cr or less than or equal to cl . For the one-sided case, a critical number c has
</p>
<p>to be found such that
</p>
<p>PH0(Y &le; c) &le; α</p>
<p/>
</div>
<div class="page"><p/>
<p>10.4 Parametric Tests for Probabilities 229
</p>
<p>for hypotheses of type (b) and
</p>
<p>PH0(Y &ge; c) &le; α
for hypotheses of type (c). If Y is less than the critical value c (for case (b)) or
</p>
<p>greater than the critical value (for case (c)), the null hypothesis is rejected.
</p>
<p>Example 10.4.2 We consider again Example 10.1.1 where we looked at the popula-
</p>
<p>tion of eligible voters, from which 700 (35 %) have voted for the party of interest P .
</p>
<p>The observed test statistic is t (x) =
&sum;
</p>
<p>i xi = 700 and the alternative hypothesis is
H1 : p &ge; 0.3, as in case (c). There are at least two ways in which we can obtain the
results:
</p>
<p>(i) Long way: We can calculate the test statistic and compare it to the critical region.
</p>
<p>To get the critical region, we search c such that
</p>
<p>Pp=0.3(Y &ge; c) &le; 0.05 ,
which equates to
</p>
<p>Pp=0.3(Y &lt; c) &ge; 0.95
and can be calculated in R as:
</p>
<p>qbinom(p=0.95, prob=0.3, size=2000)
</p>
<p>[1] 634
</p>
<p>Since Y = 700 &gt; c = 634 we reject the null hypothesis. As in Example 10.4.1,
we conclude that there is enough evidence that the proportion of votes for party
</p>
<p>P is greater than 30 %.
</p>
<p>(ii) Short way: The above result can be easily obtained in R using the binom.
</p>
<p>test() command. We need to specify the number of &ldquo;successes&rdquo; (here: 700),
</p>
<p>the number of &ldquo;failures&rdquo; (2000 &minus; 700 = 1300), and the alternative hypothesis:
</p>
<p>binom.test(c(700,1300),p=0.3,alternative='greater')
</p>
<p>data: c(700, 1300)
</p>
<p>number of successes = 700, number of trials = 2000,
</p>
<p>p-value = 8.395e-07
</p>
<p>alternative hypothesis: true probability of success
</p>
<p>is greater than 0.3
</p>
<p>95 % confidence interval:
</p>
<p>0.332378 1.000000
</p>
<p>probability of success
</p>
<p>0.35</p>
<p/>
</div>
<div class="page"><p/>
<p>230 10 Hypothesis Testing
</p>
<p>Both the p-value (which is smaller than α = 0.05) and the confidence interval
(for which we do not show the calculation) confirm the rejection of the null
</p>
<p>hypothesis.
</p>
<p>Note that
</p>
<p>binom.test(x=700,n=2000,p=0.3, alternative='greater')
</p>
<p>returns the same result.
</p>
<p>10.4.2 Two-Sample Binomial Test
</p>
<p>Test construction and hypotheses.
</p>
<p>We consider now the case of two independent i.i.d. samples from Bernoulli distrib-
</p>
<p>utions with parameters p1 and p2.
</p>
<p>X = (X1, X2, . . . , Xn1), X i &sim; B(1; p1)
Y = (Y1, Y2, . . . , Yn2), Yi &sim; B(1; p2).
</p>
<p>The sums
</p>
<p>X =
n1
&sum;
</p>
<p>i=1
X i &sim; B(n1; p1), Y =
</p>
<p>n2
&sum;
</p>
<p>i=1
Yi &sim; B(n2; p2)
</p>
<p>follow binomial distributions. One of the following hypotheses may be of interest:
</p>
<p>Case Null hypothesis Alternative hypothesis
</p>
<p>(a) p1 = p2 p1 �= p2 Two-sided problem
(b) p1 &ge; p2 p1 &lt; p2 One-sided problem
(c) p1 &le; p2 p1 &gt; p2 One-sided problem
</p>
<p>Similar to the one-sample case, both exact and approximate tests exist. Here, we only
</p>
<p>present the approximate test. The exact test of Fisher is presented in Appendix C.5,
</p>
<p>p. 428. Let n1 and n2 denote the sample sizes. Then, X/n1 and Y/n2 are approxi-
</p>
<p>mately normally distributed:
</p>
<p>X
</p>
<p>n1
</p>
<p>approx .&sim; N
(
</p>
<p>p1,
p1(1 &minus; p1)
</p>
<p>n1
</p>
<p>)
</p>
<p>,
</p>
<p>Y
</p>
<p>n2
</p>
<p>approx .&sim; N
(
</p>
<p>p2,
p2(1 &minus; p2)
</p>
<p>n2
</p>
<p>)
</p>
<p>.
</p>
<p>Their difference D
</p>
<p>D
approx .&sim; N
</p>
<p>(
</p>
<p>0, p(1 &minus; p)
(
</p>
<p>1
</p>
<p>n1
+ 1
</p>
<p>n2
</p>
<p>))</p>
<p/>
</div>
<div class="page"><p/>
<p>10.4 Parametric Tests for Probabilities 231
</p>
<p>is normally distributed too under H0 (given p = p1 = p2 holds). Since the proba-
bilities p1 and p2 are identical under H0, we can pool the two samples and estimate
</p>
<p>p by
</p>
<p>p̂ = X + Y
n1 + n2
</p>
<p>. (10.12)
</p>
<p>Test statistic and test decision.
</p>
<p>The test statistic
</p>
<p>T (X, Y) = D&radic;
p̂(1 &minus; p̂)
</p>
<p>(
</p>
<p>1
n1
</p>
<p>+ 1
n2
</p>
<p>)
</p>
<p>, (10.13)
</p>
<p>follows a N (0, 1)-distribution if n1 and n2 are sufficiently large and p is not near the
</p>
<p>boundaries 0 and 1 (one could use, for example, again the condition np(1 &minus; p) &gt; 9
with n = n1 + n2). The realized test statistic can be calculated using the observed
difference d̂ = p̂1 &minus; p̂2. The test can be conducted for the one-sided and the two-
sided case as the Gauss test introduced in Sect. 10.3.1; that is, the decision rules from
</p>
<p>Table 10.1 can be applied.
</p>
<p>Example 10.4.3 Two competing lotteries claim that every fourth lottery ticket wins.
</p>
<p>Suppose we want to test whether the probabilities of winning are different for the
</p>
<p>two lotteries, i.e. H0 : p1 = p2 and H1 : p1 �= p2. We have the following data
</p>
<p>n Winning Not winning
</p>
<p>Lottery A 63 14 49
</p>
<p>Lottery B 45 13 32
</p>
<p>We can estimate the probabilities of a winning ticket for each lottery, as well as the
</p>
<p>respective difference, as
</p>
<p>p̂A =
14
</p>
<p>63
, p̂B =
</p>
<p>13
</p>
<p>45
, d̂ = p̂A &minus; p̂B = &minus;
</p>
<p>1
</p>
<p>15
.
</p>
<p>Under H0, an estimate for p following (10.12) is
</p>
<p>p̂ = 14 + 13
63 + 45 =
</p>
<p>27
</p>
<p>108
= 0.25.
</p>
<p>The test statistic can be calculated as
</p>
<p>t (x, y) =
&minus; 1
</p>
<p>15
&radic;
</p>
<p>0.25(1 &minus; 0.25)
(
</p>
<p>1
63
</p>
<p>+ 1
45
</p>
<p>)
</p>
<p>= &minus;0.79.
</p>
<p>H0 is not rejected since |t (x, y)| = 0.79 &lt; 1.96 = z1&minus;0.05/2. Thus, there is no statis-
tical evidence for different winning probabilities for the two lotteries. These hypothe-
</p>
<p>ses can be tested in R using the Test of Fisher, see Appendix C.5, p. 428, for more
</p>
<p>details.</p>
<p/>
</div>
<div class="page"><p/>
<p>232 10 Hypothesis Testing
</p>
<p>10.5 Tests for Scale Parameters
</p>
<p>There are various tests available to test hypotheses about scale parameters. Such
</p>
<p>tests are useful when one is interested in the dispersion of a variable, for example
</p>
<p>in quality control where the variability of a process may be of interest. One-sample
</p>
<p>tests of hypotheses for the variance of a normal distribution, e.g. hypotheses such
</p>
<p>as H0 : σ2 = σ20 , can be tested by the χ2-test for the variance, see Appendix C.5,
p. 430. Two-sample problems can be addressed by the F-test (which is explained in
</p>
<p>Appendix C.5, p. 431); or by other tests such as the Levene test or Bartlett&rsquo;s test,
</p>
<p>which are also available in R (leveneTest in the package car, bartlett in the
</p>
<p>base distribution of R).
</p>
<p>10.6 Wilcoxon&ndash;Mann&ndash;Whitney (WMW) U-Test
</p>
<p>Test construction and hypotheses.
</p>
<p>The WMW U -test is often proposed as an alternative to the t-test because it also
</p>
<p>focuses on location but not on the expected value &micro;. It is a nonparametric test
</p>
<p>and useful in situations where skewed distributions are compared with each other.
</p>
<p>We consider two independent random samples X = (X1, X2, . . . , Xn1) and Y =
(Y1, Y2, , . . . , Yn2) from two populations with observed values (x1, x2, . . . , xn1) and
</p>
<p>(y1, y2, . . . , yn2), respectively. In this case, the null hypothesis H0 considering the
</p>
<p>location can be formulated as
</p>
<p>H0 : P(X &gt; Y ) = P(Y &gt; X) =
1
</p>
<p>2
.
</p>
<p>The null hypothesis can be interpreted in the following way: the probability that a
</p>
<p>randomly drawn observation from the first population has a value x that is greater
</p>
<p>(or lower) than the value y of a randomly drawn subject from the second population
</p>
<p>is 1
2
</p>
<p>. The alternative hypothesis H1 is then
</p>
<p>H1 : P(X &gt; Y ) �= P(Y &gt; X) .
This means we are comparing the entire distribution of two variables. If there is a
</p>
<p>location shift in the sense that one distribution is shifted left (or right) compared
</p>
<p>with the other distribution, the null hypothesis will be rejected because this shift
</p>
<p>can be seen as part of the alternative hypothesis P(X &gt; Y ) �= P(Y &gt; X). In fact,
under some assumptions, the hypothesis can even be interpreted as comparing two
</p>
<p>medians, and this is what is often done in practice.
</p>
<p>Observed test statistic.
</p>
<p>To construct the test statistic, it is necessary to merge (x1, x2, . . . , xn1) and (y1, y2,
</p>
<p>. . . , yn2) into one sorted sample, usually in ascending order, while keeping the infor-
</p>
<p>mation which value belongs to which sample. For now, we assume that all values of
</p>
<p>the two samples are distinct; that is, no ties are present. Then, each observation has</p>
<p/>
</div>
<div class="page"><p/>
<p>10.6 Wilcoxon&ndash;Mann&ndash;Whitney (WMW) U-Test 233
</p>
<p>a rank between 1 and (n1 + n2). Let R1+ be the sum of ranks of the x-sample and
let R2+ be the sum of ranks of the y-sample. The test statistic is defined as U , where
U is the minimum of the two values U1, U2, U = min(U1, U2) with
</p>
<p>U1 = n1 &middot; n2 +
n1(n1 + 1)
</p>
<p>2
&minus; R1+, (10.14)
</p>
<p>U2 = n1 &middot; n2 +
n2(n2 + 1)
</p>
<p>2
&minus; R2+. (10.15)
</p>
<p>Test decision.
</p>
<p>H0 is rejected if U &lt; un1,n2;α. Here, un1,n2;α is the critical value derived from the
distribution of U under the null hypothesis. The exact (complex) distribution can,
</p>
<p>for example, be derived computationally (in R). We are presenting an approximate
</p>
<p>solution together with its implementation in R.
</p>
<p>Since U1 + U2 = n1 &middot; n2, it is sufficient to compute only Ri+ and U = min{Ui ,
n1n2 &minus; Ui } (i = 1 or i = 2 are chosen such that Ri+ is calculated for the sample
with the lower sample size). For n1, n2 &ge; 8, one can use the approximation
</p>
<p>T (X, Y) =
U &minus; n1&middot;n2
</p>
<p>2
&radic;
</p>
<p>n1 &middot; n2 &middot; (n1 + n2 + 1)
12
</p>
<p>approx .&sim; N (0, 1) (10.16)
</p>
<p>as the test statistic. For two-sided hypotheses, H0 is rejected if |t (x, y)| &gt; z1&minus;α/2;
for one-sided hypotheses H0 is rejected if |t (x, y)| &gt; z1&minus;α. In the case of ties, the
denominator of the test statistic in (10.16) can be modified as
</p>
<p>T (X, Y) =
U &minus; n1&middot;n2
</p>
<p>2
&radic;
</p>
<p>&radic;
</p>
<p>&radic;
</p>
<p>&radic;
</p>
<p>&radic;
</p>
<p>[
</p>
<p>n1 &middot; n2
n(n &minus; 1)
</p>
<p>]
</p>
<p>⎡
</p>
<p>⎣
</p>
<p>n3 &minus; n
12
</p>
<p>&minus;
G
&sum;
</p>
<p>j=1
</p>
<p>t3j &minus; t j
12
</p>
<p>⎤
</p>
<p>⎦
</p>
<p>approx .&sim; N (0, 1),
</p>
<p>where G is the number of different (groups of) ties and t j denotes the number of tied
</p>
<p>ranks in tie group j .
</p>
<p>Example 10.6.1 In a study, the reaction times (in seconds) to a stimulus were mea-
</p>
<p>sured for two groups. One group drank a strong coffee before the stimulus and the
</p>
<p>other group drank only the same amount of water. There were 9 study participants
</p>
<p>in the coffee group and 10 participants in the water group. The following reaction
</p>
<p>times were recorded:
</p>
<p>Reaction time 1 2 3 4 5 6 7 8 9 10
</p>
<p>Coffee group (C) 3.7 4.9 5.2 6.3 7.4 4.4 5.3 1.7 2.9
</p>
<p>Water group (W) 4.5 5.1 6.2 7.3 8.7 4.2 3.3 8.9 2.6 4.8
</p>
<p>We test with the U -test whether there is a location difference between the two groups.
</p>
<p>First, the ranks of the combined sample are calculated as:</p>
<p/>
</div>
<div class="page"><p/>
<p>234 10 Hypothesis Testing
</p>
<p>1 2 3 4 5 6 7 8 9 10 Total
</p>
<p>Value (C) 3.7 4.9 5.2 6.3 7.4 4.4 5.3 1.7 2.9
</p>
<p>Rank (C) 5 10 12 15 17 7 13 1 3 83
</p>
<p>Value (W) 4.5 5.1 6.2 7.3 8.7 4.2 3.3 8.9 2.6 4.8
</p>
<p>Rank (W) 8 11 14 16 18 6 4 19 2 9 107
</p>
<p>With RC+ = 83 and RW+ = 107, we get
</p>
<p>U1 = n1 &middot; n2 +
n1(n1 + 1)
</p>
<p>2
&minus; RC+ = 9 &middot; 10 +
</p>
<p>9 &middot; 10
2
</p>
<p>&minus; 83 = 52,
</p>
<p>U2 = n1 &middot; n2 +
n2(n2 + 1)
</p>
<p>2
&minus; RW+ = 9 &middot; 10 +
</p>
<p>10 &middot; 11
2
</p>
<p>&minus; 107 = 38.
</p>
<p>With n1, n2 &ge; 8 and U = U2 = 38,
</p>
<p>t (x, y) =
U &minus; n1&middot;n2
</p>
<p>2
&radic;
</p>
<p>n1 &middot; n2 &middot; (n1 + n2 + 1)
12
</p>
<p>=
38 &minus; 9&middot;10
</p>
<p>2
&radic;
</p>
<p>9 &middot; 10 &middot; (9 + 10 + 1)
12
</p>
<p>&asymp; &minus;0.572.
</p>
<p>Since |t (x, y)| = 0.572 &lt; z1&minus;α/2 = 1.96, the null hypothesis cannot be rejected;
that is, there is no statistical evidence that the two groups have different reaction
</p>
<p>times.
</p>
<p>In R, one can use the wilcox.test command to obtain the results:
</p>
<p>coffee &lt;- c(3.7, 4.9, 5.2, 6.3, ..., 2.9)
</p>
<p>water &lt;- c(4.5, 5.1, 6.2, ..., 4.8)
</p>
<p>wilcox.test(coffee, water)
</p>
<p>The output is
</p>
<p>Wilcoxon rank sum test
</p>
<p>data: coffee.sample and water.sample
</p>
<p>W = 38, p-value = 0.6038
</p>
<p>alternative hypothesis: true location shift is not equal to 0
</p>
<p>We can see that the null hypothesis is not rejected because p = 0.6038 &gt; α =
0.05. The displayed test statistic is W which equates to our statistic U2. The alternative
</p>
<p>hypothesis in R is framed as location shift, an interpretation which has already been
</p>
<p>given earlier in the chapter. Note that the test also suggests that the medians of the
</p>
<p>two samples are not statistically different.</p>
<p/>
</div>
<div class="page"><p/>
<p>10.7 χ2-Goodness-of-Fit Test 235
</p>
<p>10.7 χ2-Goodness-of-Fit Test
</p>
<p>Test construction.
</p>
<p>The χ2-goodness-of-fit test is one of the most popular tests for testing the goodness
</p>
<p>of fit of the observed data to a distribution. The construction principle is very general
</p>
<p>and can be used for variables of any scale. The test statistic is derived such that the
</p>
<p>observed absolute frequencies are compared with the expected absolute frequencies
</p>
<p>under the null hypothesis H0.
</p>
<p>Example 10.7.1 Consider an experiment where a die is rolled n = 60 times. Under
the null hypothesis H0, we assume that the die is fair, i.e. pi = 16 , i = 1, 2, . . . , 6,
where pi = P(X = i). We could have also said that H0 is the hypothesis that the
rolls are following a discrete uniform distribution. Thus, the expected absolute fre-
</p>
<p>quencies under H0 are npi = 60 &middot; 16 = 10, while the observed frequencies in the
sample are Ni , i = 1, 2, . . . , 6. The Ni generally deviate from npi . The χ2-statistic
is based on the squared differences,
</p>
<p>&sum;6
i=1(Ni &minus; npi )2, and becomes large as the
</p>
<p>differences between the observed and the expected frequencies become larger. The
</p>
<p>χ2-test statistic is a modification of this sum by scaling each squared difference by
</p>
<p>the expected frequencies, npi , and is explained below.
</p>
<p>With a nominal variable, we can proceed as in Example 10.7.1. If the scale of the
</p>
<p>variable is ordinal or continuous, the number of different values can be large. Note
</p>
<p>that in the most extreme case, we can have as many different values as observations
</p>
<p>(n), leading to Ni = 1 for all i = 1, 2, . . . , n. Then, it is necessary to group the data
into k intervals before applying the χ2-test. The reason is that the general theory of
</p>
<p>the χ2-test assumes that the number k (which was 6 in Example 10.7.1 above) is
</p>
<p>fixed and does not grow with the number of observations n; that is, the theory says
</p>
<p>that the χ2-test only works properly if k is fixed and n is large. For this reason, we
</p>
<p>group the sample X = (X1, X2, . . . , Xn) into k classes as shown in Sect. 2.1.
</p>
<p>Class 1 2 &middot; &middot; &middot; k Total
Number of observations n1 n2 &middot; &middot; &middot; nk n
</p>
<p>The choice of the class intervals is somewhat arbitrary. As a rule of thumb npi &gt; 5
</p>
<p>should hold for most class intervals. The general hypotheses can be formulated in
</p>
<p>the form of distribution functions:
</p>
<p>H0 : F(x) = F0(x) versus H1 : F(x) �= F0(x).
Test statistic.
</p>
<p>The test statistic is defined as
</p>
<p>T (X) = t (x) = χ2 =
k
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>(Ni &minus; npi )2
npi
</p>
<p>. (10.17)</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
</div>
<div class="page"><p/>
<p>236 10 Hypothesis Testing
</p>
<p>Here,
</p>
<p>&bull; Ni (i = 1, 2, . . . , k) are the absolute frequencies of observations of the sample X
in class i , Ni is a random variable with realization ni in the observed sample;
</p>
<p>&bull; pi (i = 1, 2, . . . , k) are calculated from the distribution under H0, F0(x), and are
the (hypothetical) probabilities that an observation of X falls in class i ;
</p>
<p>&bull; npi are the expected absolute frequencies in class i under H0.
</p>
<p>Test decision.
</p>
<p>For a significance level α, H0 is rejected if t (x) is greater than the (1 &minus; α)-quantile
of the χ2-distribution with k &minus; 1 &minus; r degrees of freedom, i.e. if
</p>
<p>t (x) = χ2 &gt; ck&minus;1&minus;r,1&minus;α.
Note that r is the number of parameters of F0(x), if these parameters are estimated
</p>
<p>from the sample. The χ2-test statistic is only asymptotically χ2-distributed under
</p>
<p>H0.
</p>
<p>Example 10.7.2 Let F0(x) be the distribution function of the test distribution. If
</p>
<p>one specifies a normal distribution such as F0(x) = N (3, 10), or a discrete uniform
distribution with pi = 0.25 (i = 1, 2, 3, 4), then r = 0, since no parameters have
to be estimated from the data. Otherwise, if we simply want to test whether the
</p>
<p>data is generated from a normal distribution N (&micro;,σ2) or the data follows a normal
</p>
<p>distribution N (&micro;,σ2), then &micro; and σ2 may be estimated from the sample by x̄ and s2.
</p>
<p>Then, r = 2 and the number of degrees of freedom is reduced.
</p>
<p>Example 10.7.3 Gregor Mendel (1822&ndash;1884) conducted crossing experiments with
</p>
<p>pea plants of different shape and colour. Let us look at the outcome of a pea crossing
</p>
<p>experiment with the following results:
</p>
<p>Crossing result Round Round Edged Edged
</p>
<p>Yellow Green Yellow Green
</p>
<p>Observations 315 108 101 32
</p>
<p>Mendel had the hypothesis that the four different types occur in proportions of
</p>
<p>9:3:3:1, that is
</p>
<p>p1 =
9
</p>
<p>16
, p2 =
</p>
<p>3
</p>
<p>16
, p3 =
</p>
<p>3
</p>
<p>16
, p4 =
</p>
<p>1
</p>
<p>16
.
</p>
<p>The hypotheses are
</p>
<p>H0 : P(X = i) = pi versus H1 : P(X = i) �= pi , i = 1, 2, 3, 4.
With n = 556 observations, the test statistic can be calculated from the following
observed and expected frequencies:</p>
<p/>
</div>
<div class="page"><p/>
<p>10.7 χ2-Goodness-of-Fit Test 237
</p>
<p>i Ni pi npi
</p>
<p>1 315 9
16
</p>
<p>312.75
</p>
<p>2 108 3
16
</p>
<p>104.25
</p>
<p>3 101 3
16
</p>
<p>104.25
</p>
<p>4 32 1
16
</p>
<p>34.75
</p>
<p>The χ2-test statistic is calculated as
</p>
<p>t (x) = χ2 = (315 &minus; 312.75)
2
</p>
<p>312.75
+ &middot; &middot; &middot; + (32 &minus; 34.75)
</p>
<p>2
</p>
<p>34.75
= 0.47.
</p>
<p>Since χ2 = 0.47 &lt; 7.815 = χ20.95,3 = c0.95,3, the null hypothesis is not rejected.
</p>
<p>Statistically, there is no evidence that Mendel was wrong with his 9:3:3:1 assumption.
</p>
<p>In R, the test can be conducted by applying the chisq.test command:
</p>
<p>chisq.test(c(315, 108, 101, 32),
</p>
<p>p=c(9/16,3/16,3/16,1/16))
</p>
<p>qchisq(df=3, p=0.95)
</p>
<p>which leads to the following output
</p>
<p>Chi-squared test for given probabilities
</p>
<p>data: c(315, 108, 101, 32)
</p>
<p>X-squared = 0.47, df = 3, p-value = 0.9254
</p>
<p>and the critical value is
</p>
<p>[1] 7.814728
</p>
<p>Remark 10.7.1 In this example, the data was already summarized in a frequency
</p>
<p>table. For raw data, the table command can be used to preprocess the data, i.e. we
</p>
<p>can use chisq.test(table(var1,var2)).
</p>
<p>Another popular goodness-of-fit test is the test of Kolmogorov&ndash;Smirnov. There
</p>
<p>are two different versions of this test, one for the one-sample scenario and one for the
</p>
<p>two-sample scenario. The null hypothesis for the latter is that the two independent
</p>
<p>samples come from the same distribution. In R, the command ks.test() can be
</p>
<p>used to perform Kolmogorov&ndash;Smirnov tests.</p>
<p/>
</div>
<div class="page"><p/>
<p>238 10 Hypothesis Testing
</p>
<p>10.8 χ2-Independence Test and Other χ2-Tests
</p>
<p>In Chap. 4, we introduced different methods to describe the association between
</p>
<p>two variables. Several association measures are possibly suitable if the variables are
</p>
<p>categorical, for example Cramer&rsquo;s V , Goodman&rsquo;s and Kruskal&rsquo;s γ, Spearman&rsquo;s rank
</p>
<p>correlation coefficient, and the odds ratio. If we are not interested in the strength of
</p>
<p>association but rather in finding out whether there is an association at all, one can
</p>
<p>use the χ2-independence test.
</p>
<p>Test construction.
</p>
<p>In the following we assume that we observe a sample from a bivariate discrete
</p>
<p>distribution of two variables X and Y which can be summarized in a contingency
</p>
<p>table with absolute frequencies ni j , (i = 1, 2, . . . , I ; j = 1, 2 . . . , J ):
</p>
<p>Y
</p>
<p>1 2 &middot; &middot; &middot; J
X 1 n11 n12 &middot; &middot; &middot; n1J n1+
</p>
<p>2 n21 n22 &middot; &middot; &middot; n2J n2+
.
.
.
</p>
<p>.
</p>
<p>.
</p>
<p>.
.
.
.
</p>
<p>.
</p>
<p>.
</p>
<p>.
.
.
.
</p>
<p>I n I 1 n I 2 &middot; &middot; &middot; n I J n I+
n+1 n+2 &middot; &middot; &middot; n+J n
</p>
<p>Remember that
</p>
<p>ni+ is the i th row sum,
n+ j is the j th column sum, and
n is the total number of observations.
</p>
<p>The hypotheses are H0: X and Y are independent versus H1 : X and Y are not
independent. If X and Y are independent, then the expected frequencies mi j are
</p>
<p>m̂i j = nπ̂i j =
ni+n+ j
</p>
<p>n
. (10.18)
</p>
<p>Test statistic.
</p>
<p>Pearson&rsquo;s χ2-test statistic was introduced in Chap. 4, Eq. (4.6). It is
</p>
<p>T (X, Y) = χ2 =
I
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>J
&sum;
</p>
<p>j=1
</p>
<p>(ni j &minus; mi j )2
mi j
</p>
<p>,
</p>
<p>where mi j = nπi j = nπi+π+ j (expected absolute cell frequencies under H0).
Strictly speaking, mi j are the true, unknown expected frequencies under H0 and
</p>
<p>are estimated by m̂i j = nπi+π+ j , such that the realized test statistic equates to
</p>
<p>t (x, y) = χ2 =
I
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>J
&sum;
</p>
<p>j=1
</p>
<p>(ni j &minus; m̂i j )2
m̂i j
</p>
<p>. (10.19)</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>10.8 χ2-Independence Test and Other χ2-Tests 239
</p>
<p>Test decision.
</p>
<p>The number of degrees of freedom under H0 is (I &minus; 1)(J &minus; 1), where I &minus; 1 are the
parameters which have to be estimated for the marginal distribution of X , and J &minus; 1
are the number of parameters for the marginal distribution of Y . The test decision is:
</p>
<p>Reject H0, if t (x, y) = χ2 &gt; c(I&minus;1)(J&minus;1);1&minus;α.
Note that the alternative hypothesis H1 is very general. If H0 is rejected, nothing can
</p>
<p>be said about the structure of the dependence of X and Y from the χ2-value itself.
</p>
<p>Example 10.8.1 Consider the following contingency table. Here, X describes the
</p>
<p>educational level (1: primary, 2: secondary, 3: tertiary) and Y the preference for a
</p>
<p>specific political party (1: Party A, 2: Party B, 3: Party C). Our null hypothesis is that
</p>
<p>the two variables are independent, and we want to show the alternative hypothesis
</p>
<p>which says that there is a relationship between them.
</p>
<p>Y Total
</p>
<p>1 2 3
</p>
<p>X 1 100 200 300 600
</p>
<p>2 100 100 100 300
</p>
<p>3 80 10 10 100
</p>
<p>Total 280 310 410 1000
</p>
<p>For the (estimated) expected frequencies m̂i j = ni+n+ jn , we get
</p>
<p>Y
</p>
<p>1 2 3
</p>
<p>X 1 168 186 246
</p>
<p>2 84 93 123
</p>
<p>3 28 31 41
</p>
<p>For example: m̂11 = 600 &middot; 280/1000 = 168. The test statistic is
</p>
<p>t (x, y) =
I
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>J
&sum;
</p>
<p>j=1
</p>
<p>(ni j &minus; m̂i j )2
m̂i j
</p>
<p>= (100 &minus; 168)
2
</p>
<p>168
+ &middot; &middot; &middot; + (10 &minus; 41)
</p>
<p>2
</p>
<p>41
&asymp; 182.54.
</p>
<p>Since χ24;0.95 = 9.49 &lt; t (x, y) = 182.54, H0 is rejected.</p>
<p/>
</div>
<div class="page"><p/>
<p>240 10 Hypothesis Testing
</p>
<p>In R, either the summarized data (as shown below) can be used to calcu-
</p>
<p>late the test statistic or the raw data (summarized in a contingency table via
</p>
<p>table(var1,var2)):
</p>
<p>ct &lt;- matrix(nrow=3,ncol=3,byrow=T,
</p>
<p>data=c(100,200,300,100,100,100,80,10,10))
</p>
<p>chisq.test(ct)
</p>
<p>qchisq(df=(3-1)*(3-1), p=0.95)
</p>
<p>The output is
</p>
<p>Pearson&rsquo;s Chi-squared test
</p>
<p>data: contingency.table
</p>
<p>X-squared = 182.5428, df = 4, p-value &lt; 2.2e-16
</p>
<p>with the critical value
</p>
<p>[1] 9.487729
</p>
<p>which confirms our earlier manual calculations. The p-value is smaller thanα = 0.05
which further confirms that the null hypothesis has to be rejected.
</p>
<p>For a binary outcome, the χ2-test of independence can be formulated as a test for
</p>
<p>the null hypothesis that the proportions of the binary variable are equal in several
</p>
<p>(&ge;2) groups, i.e. for a K &times; 2 (or 2 &times; K ) table. This test is called the χ2-test of
homogeneity.
</p>
<p>Example 10.8.2 Consider two variables X and Y , where X is describing the rating
</p>
<p>of a coffee brand with the categories &ldquo;bad taste&rdquo; and &ldquo;good taste&rdquo; and Y denotes
</p>
<p>three age subgroups, e.g. &ldquo;18&ndash;25&rdquo;, &ldquo;25&ndash;35&rdquo;, and &ldquo;35&ndash;45&rdquo;. The observed data is
</p>
<p>Y
</p>
<p>18&ndash;25 25&ndash;35 35&ndash;45 Total
</p>
<p>X Bad 10 30 65 105
</p>
<p>Good 90 70 35 195
</p>
<p>Total 100 100 100 300
</p>
<p>Assume H0 is the hypothesis that the probabilities P(X = &lsquo;good&rsquo;|Y = &lsquo;18&ndash;25&rsquo;),
P(X = &lsquo;good&rsquo;|Y = &lsquo;25&ndash;35&rsquo;), and P(X = &lsquo;good&rsquo;|Y = &lsquo;35&ndash;45&rsquo;) are all equal. Then,
we can use the function either prop.test or chisq.test in R to test this
</p>
<p>hypothesis:</p>
<p/>
</div>
<div class="page"><p/>
<p>10.8 χ2-Independence Test and Other χ2-Tests 241
</p>
<p>prop.test(x=rbind(c(10,30,65), c(90,70,35) ))
</p>
<p>chisq.test(x=rbind(c(10,30,65), c(90,70,35) ))
</p>
<p>This produces the following outputs:
</p>
<p>3-sample test for equality of proportions
</p>
<p>data: cbind(c(10, 30, 65), c(90, 70, 35))
</p>
<p>X-squared = 68.1319, df = 2, p-value = 1.605e-15
</p>
<p>alternative hypothesis: two.sided
</p>
<p>sample estimates:
</p>
<p>prop 1 prop 2 prop 3
</p>
<p>0.10 0.30 0.65
</p>
<p>and
</p>
<p>Pearson&rsquo;s Chi-squared test
</p>
<p>data: cbind(c(10, 30, 65), c(90, 70, 35))
</p>
<p>X-squared = 68.1319, df = 2, p-value = 1.605e-15
</p>
<p>The results (test statistic, p-value) are identical and H0 is rejected. Note that
</p>
<p>prop.test strictly expects a K &times; 2 table (i.e. exactly 2 columns).
</p>
<p>Remark 10.8.1 For 2 &times; 2-tables with small sample sizes and therefore small cell
frequencies, it is recommended to use the exact test of Fisher as described in Appen-
</p>
<p>dix C.5.
</p>
<p>Remark 10.8.2 The test described in Example 10.8.2 is a special case (since one
</p>
<p>variable is binary) of the generalχ2-test of homogeneity. Theχ2-test of homogeneity
</p>
<p>is valid for any K &times; C table, where K is the number of subgroups of a variable Y
and C is the number of values of the outcome X of interest. The null hypothesis H0
assumes that the conditional distributions of X given Y are identical in all subgroups,
</p>
<p>i.e.
</p>
<p>P(X = xc|Y = yk) = P(X = xc|Y = yk&prime;)
forall c = 1, 2, . . . , C; k, k&prime; = 1, 2, . . . , K , k �= k&prime;. Again, the usual χ2-test statistic
can be used.</p>
<p/>
</div>
<div class="page"><p/>
<p>242 10 Hypothesis Testing
</p>
<p>10.9 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� A graphical summary on when to use the tests introduced in this chapter
</p>
<p>is given in Appendices D.2 and D.3.
</p>
<p>� To arrive at a test decision, i.e. accept H0 or reject it, it does not matter
</p>
<p>whether one compares the test statistic to the critical region, one uses the
</p>
<p>p-value obtained from statistical software, or one evaluates the appropri-
</p>
<p>ate confidence interval. However, it is important not to misinterpret the
</p>
<p>p-value (see Sect. 10.2.6) and to choose the correct confidence interval.
</p>
<p>� There is a difference between relevance and significance. A test might be
</p>
<p>significant, but the point estimate of the quantity of interest may not be
</p>
<p>relevant from a substantive point of view. Similarly, a test might not be
</p>
<p>significant, but the point and interval estimates may still yield relevant
</p>
<p>conclusions.
</p>
<p>� The test statistic of the t-test (one-sample, two-sample, paired) is asymp-
</p>
<p>totically normally distributed. This means that for relatively large n (as
</p>
<p>a rule of thumb &gt;30 per group) the sample does not need to come from a
</p>
<p>normal distribution. However, the application of the t-test makes sense
</p>
<p>only when the expectation &micro; can be interpreted meaningfully; this may
</p>
<p>not be the case for skewed distributions or distributions with outliers.
</p>
<p>10.10 Exercises
</p>
<p>Exercise 10.1 Two people, A and B, are suspects for having committed a crime
</p>
<p>together. Both of them are interrogated in separate rooms. The jail sentence depends
</p>
<p>on who confesses to have committed the crime, and who does not:
</p>
<p>B does not confess B does confess
</p>
<p>A does not confess Each serves 1 year A: 3 years; B: goes free
</p>
<p>A does confess A: goes free; B: 3 years Each serves 2 years
</p>
<p>A has two hypotheses:
</p>
<p>H0 : B does not confess versus H1 : B does confess.
Given the possible sentences he decides to not confess if H0 is true and to confess
</p>
<p>otherwise. Explain the concepts of type I error and type II error for this situation.
</p>
<p>Comment on the consequences if these errors are made.</p>
<p/>
</div>
<div class="page"><p/>
<p>10.10 Exercises 243
</p>
<p>Exercise 10.2 A producer of chocolate bars hypothesizes that his production does
</p>
<p>not adhere to the weight standard of 100 g. As a measure of quality control, he weighs
</p>
<p>15 bars and obtains the following results in grams:
</p>
<p>96.40, 97.64, 98.48, 97.67, 100.11, 95.29, 99.80, 98.80, 100.53, 99.41, 97.64,
</p>
<p>101.11, 93.43, 96.99, 97.92
</p>
<p>It is assumed that the production process is standardized in the sense that the variation
</p>
<p>is controlled to be σ = 2.
</p>
<p>(a) What are the hypotheses regarding the expected weight &micro; for a two-sided test?
</p>
<p>(b) Which test should be used to test these hypotheses?
</p>
<p>(c) Conduct the test that was suggested to be used in (b). Use α = 0.05.
(d) The producer wants to show that the expected weight is smaller than 100 g. What
</p>
<p>are the appropriate hypotheses to use?
</p>
<p>(e) Conduct the test for the hypothesis in (d). Again use α = 0.05.
</p>
<p>Exercise 10.3 Christian decides to purchase the new CD by Bruce Springsteen. His
</p>
<p>first thought is to buy it online, via an online auction. He discovers that he can also
</p>
<p>buy the CD immediately, without bidding at an auction, from the same online store.
</p>
<p>He also looks at the price at an internet book store which was recommended to him
</p>
<p>by a friend. He notes down the following prices (in e):
</p>
<p>Internet book store 16.95
</p>
<p>Online store, no auction 18.19, 16.98, 19.97, 16.98, 18.19, 15.99, 13.79, 15.90,
</p>
<p>15.90, 15.90, 15.90, 15.90, 19.97, 17.72
</p>
<p>Online store, auction 10.50, 12.00, 9.54, 10.55, 11.99, 9.30, 10.59, 10.50, 10.01,
</p>
<p>11.89, 11.03, 9.52, 15.49, 11.02
</p>
<p>(a) Calculate and interpret the arithmetic mean, variance, standard deviation, and
</p>
<p>coefficient of variation for the online store, both for the auction and non-auction
</p>
<p>offers.
</p>
<p>(b) Test the hypothesis that the mean price at the online store (no auction) is unequal
</p>
<p>to e16.95 (α = 0.05).
(c) Calculate a confidence interval for the mean price at the online store (no auction)
</p>
<p>and interpret your findings in the light of the hypothesis in (b).
</p>
<p>(d) Test the hypothesis that the mean price at the online store (auction) is less than
</p>
<p>e16.95 (α = 0.05).
(e) Test the hypothesis that the mean non-auction price is higher than the mean
</p>
<p>auction price. Assume that (i) the variances are equal in both samples and (ii)
</p>
<p>the variances are unequal (α = 0.05).
(f) Test the hypothesis that the variance of the non-auction price is unequal to the
</p>
<p>variance of the auction price (α = 0.05).</p>
<p/>
</div>
<div class="page"><p/>
<p>244 10 Hypothesis Testing
</p>
<p>(g) Use the U -test to compare the location of the auction and non-auction prices.
</p>
<p>Compare the results with those of (e).
</p>
<p>(h) Calculate the results of (a)&ndash;(g) with R.
</p>
<p>Exercise 10.4 Ten of Leonard&rsquo;s best friends try a new diet: the &ldquo;Banting&rdquo; diet. Each
</p>
<p>of them weighs him/herself before and after the diet. The data is as follows:
</p>
<p>Person (i) 1 2 3 4 5 6 7 8 9 10
</p>
<p>Before diet (xi ) 80 95 70 82 71 70 120 105 111 90
</p>
<p>After diet (yi ) 78 94 69 83 65 69 118 103 112 88
</p>
<p>Choose a test and a confidence interval to test whether there is a difference between
</p>
<p>the mean weight before and after the diet (α = 0.05).
</p>
<p>Exercise 10.5 A company producing clothing often finds deficient T-shirts among
</p>
<p>its production.
</p>
<p>(a) The company&rsquo;s controlling department decides that the production is no longer
</p>
<p>profitable when there are more than 10 % deficient shirts. A sample of 230 shirts
</p>
<p>yields 30 shirts which contain deficiencies. Use the approximate binomial test
</p>
<p>to decide whether the T-shirt production is profitable or not (α = 0.05).
(b) Test the same hypothesis as in (a) using the exact binomial test. You can use R
</p>
<p>to determine the quantiles needed for the calculation.
</p>
<p>(c) The company is offered a new cutting machine. To test whether the change of
</p>
<p>machine helps to improve the production quality, 115 sample shirts are evaluated,
</p>
<p>7 of which have deficiencies. Use the two-sample binomial test to decide whether
</p>
<p>the new machine yields improvement or not (α = 0.05).
(d) Test the same hypothesis as in (c) using the test of Fisher in R.
</p>
<p>Exercise 10.6 Two friends play a computer game and each of them repeats the same
</p>
<p>level 10 times. The scores obtained are:
</p>
<p>1 2 3 4 5 6 7 8 9 10
</p>
<p>Player 1 91 101 112 99 108 88 99 105 111 104
</p>
<p>Player 2 261 47 40 29 64 6 87 47 98 351
</p>
<p>(a) Player 2 insists that he is the better player and suggests to compare their mean
</p>
<p>performance. Use an appropriate test (α = 0.05) to test this hypothesis.
(b) Player 1 insists that he is the better player. He proposes to not focus on the mean
</p>
<p>and to use the U -test for comparison. What are the advantages and disadvantages
</p>
<p>of using this test compared with (a)? What are the results (α = 0.05)?</p>
<p/>
</div>
<div class="page"><p/>
<p>10.10 Exercises 245
</p>
<p>Exercise 10.7 Otto loves gummy bears and buys 10 packets at a factory store. He
</p>
<p>opens all packets and sorts them by their colour. He counts 222 white gummy bears,
</p>
<p>279 red gummy bears, 251 orange gummy bears, 232 yellow gummy bears, and
</p>
<p>266 green ones. He is disappointed since white (pineapple flavour) is his favourite
</p>
<p>flavour. He hypothesizes that the producer of the bears does not uniformly distribute
</p>
<p>the bears into the packets. Choose an appropriate test to find out whether Otto&rsquo;s
</p>
<p>speculation could be true.
</p>
<p>Exercise 10.8 We consider Exercise 4.4 where we evaluated which of the passengers
</p>
<p>from the Titanic were rescued. The data was summarized as follows:
</p>
<p>1. Class 2. Class 3. Class Staff Total
</p>
<p>Rescued 202 125 180 211 718
</p>
<p>Not rescued 135 160 541 674 1510
</p>
<p>(a) The hypothesis derived from the descriptive analysis was that travel class and
</p>
<p>rescue status are not independent. Test this hypothesis.
</p>
<p>(b) Interpret the following R output:
</p>
<p>4-sample test for equality of proportions
</p>
<p>data: titanic
</p>
<p>X-squared = 182.06, df = 3, p-value &lt; 2.2e-16
</p>
<p>alternative hypothesis: two.sided
</p>
<p>sample estimates:
</p>
<p>prop 1 prop 2 prop 3 prop 4
</p>
<p>0.5994065 0.4385965 0.2496533 0.2384181
</p>
<p>(c) Summarize the data in a 2&times;2 table: passengers from the first and second class
should be grouped together, and third class passengers and staff should be
</p>
<p>grouped together as well. Is the probability of being rescued higher in the first
</p>
<p>and second class? Provide an answer using the following three tests: exact test
</p>
<p>of Fisher, χ2-independence test, and χ2-homogeneity test. You can use R to
</p>
<p>conduct the test of Fisher.
</p>
<p>Exercise 10.9 We are interested in understanding how well the t-test can detect
</p>
<p>differences with respect to the mean. We use R to draw 3 samples each of 20 obser-
</p>
<p>vations from three different normal distributions: X &sim; N (5, 22), Y1 &sim; N (4, 22), and
Y2 &sim; N (3.5, 22). The summary statistics of this experiment are as follows:</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>246 10 Hypothesis Testing
</p>
<p>&bull; x̄ = 4.97, s2x = 2.94,
&bull; ȳ1 = 4.55, s2y1 = 2.46,
&bull; ȳ2 = 3.27, s2y2 = 3.44.
</p>
<p>(a) Use the t-test to compare the means of X and Y1.
</p>
<p>(b) Use the t-test to compare the means of X and Y2.
</p>
<p>(c) Interpret the results from (a) and (b).
</p>
<p>Exercise 10.10 Access the theatre data described in Appendix A.4. The data sum-
</p>
<p>marizes a survey conducted on visitors of a local Swiss theatre in terms of age, sex,
</p>
<p>annual income, general expenditure on cultural activities, expenditure on theatre vis-
</p>
<p>its, and the estimated expenditure on theatre visits in the year before the survey was
</p>
<p>done.
</p>
<p>(a) Compare the mean expenditure on cultural activities for men and women using
</p>
<p>the Welch test (α = 0.05).
(b) Would the conclusions change if the two-sample t-test or the U -test were used
</p>
<p>for comparison?
</p>
<p>(c) Test the hypothesis that women spend on average more money on theatre visits
</p>
<p>than men (α = 0.05).
(d) Compare the mean expenditure on theatre visits in the year of the survey and the
</p>
<p>preceding year (α = 0.05).
</p>
<p>Exercise 10.11 Use R to read in and analyse the pizza data described in Appen-
</p>
<p>dix A.4 (assume α = 0.05).
</p>
<p>(a) The manager&rsquo;s aim is to deliver pizzas in less than 30 min and with a temperature
</p>
<p>of greater than 65 ◦C. Use an appropriate test to evaluate whether these aims have
been reached on average.
</p>
<p>(b) If it takes longer than 40 min to deliver the pizza, then the customers are promised
</p>
<p>a free bottle of wine. This offer is only profitable if less than 15 % of deliveries
</p>
<p>are too late. Test the hypothesis p &lt; 0.15.
</p>
<p>(c) The manager wonders whether there is any relationship between the operator
</p>
<p>taking the phone call and the pizza temperature. Assume that a hot pizza is
</p>
<p>defined to be one with a temperature greater 65 ◦C. Use the test of Fisher, the
χ2-independence test, and the χ2-test of homogeneity to test his hypothesis.
</p>
<p>(d) Each branch employs the same number of staff. It would thus be desirable if each
</p>
<p>branch receives the same number of orders. Use an appropriate test to investigate
</p>
<p>this hypothesis.
</p>
<p>(e) Is the proportion of calls taken by each operator the same in each branch?
</p>
<p>(f) Test whether there is a relationship between drivers and branches.</p>
<p/>
</div>
<div class="page"><p/>
<p>10.10 Exercises 247
</p>
<p>Exercise 10.12 The authors of this book went to visit historical sites in India. None of
</p>
<p>them has a particularly strong interest in photography, and they speculated that each
</p>
<p>of them would take about the same number of pictures on their trip. After returning
</p>
<p>home, they counted 110, 118, and 105 pictures, respectively. Use an appropriate test
</p>
<p>to find out whether their speculation was correct (α = 0.01).
</p>
<p>&rarr; Solutions to all exercises in this chapter can be found on p. 393
</p>
<p>&lowast;Source Toutenburg, H., Heumann, C., Induktive Statistik, 4th edition, 2007,
Springer, Heidelberg</p>
<p/>
</div>
<div class="page"><p/>
<p>11Linear Regression
</p>
<p>We learnt about various measures of association in Chap. 4. Such measures are
</p>
<p>used to understand the degree of relationship or association between two variables.
</p>
<p>The correlation coefficient of Bravais&ndash;Pearson, for example, can help us to quantify
</p>
<p>the degree of a linear relationship, but it does not tell us about the functional form
</p>
<p>of a relationship. Moreover, any association of interest may depend on more than
</p>
<p>one variable, and we would therefore like to explore multivariate relationships. For
</p>
<p>example, consider a situation where we measured the body weights and the long jump
</p>
<p>results (distances) of school children taking part in a competition. The correlation
</p>
<p>coefficient of Bravais&ndash;Pearson between the body weight and distance jumped can
</p>
<p>tell us how strong or weak the association between the two variables is. It can also
</p>
<p>tell us whether the distance jumped increases or decreases with the body weight in
</p>
<p>the sense that a negative correlation coefficient indicates shorter jumps for higher
</p>
<p>body weights, whereas a positive coefficient implies longer jumps for higher body
</p>
<p>weights. Suppose we want to know how far a child with known body weight, say
</p>
<p>50 kg, will jump. Such questions cannot be answered from the value and sign of the
</p>
<p>correlation coefficient. Another question of interest may be to explore whether the
</p>
<p>relationship between the body weight and distance jumped is linear or not. One may
</p>
<p>also be interested in the joint effect of age and body weight on the distance jumped.
</p>
<p>Could it be that older children, who have on average a higher weight than younger
</p>
<p>children, perform better? What would be the association of weight and the long jump
</p>
<p>results of children of the same age? Such questions are addressed by linear regression
</p>
<p>analysis which we introduce in this chapter.
</p>
<p>In many situations, the outcome does not depend on one variable but on several
</p>
<p>variables. For example, the recovery time of a patient after an operation depends on
</p>
<p>several factors such as weight, haemoglobin level, blood pressure, body temperature,
</p>
<p>diet control, rehabilitation, and others. Similarly, the weather depends on many fac-
</p>
<p>tors such as temperature, pressure, humidity, speed of winds, and others. Multiple
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5_11
</p>
<p>249</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>250 11 Linear Regression
</p>
<p>Fig. 11.1 Scatter plots
</p>
<p>linear regression, introduced in Sect. 11.6, addresses the issue where the outcome
</p>
<p>depends on more than one variable.
</p>
<p>To begin with, we consider only two quantitative variables X and Y in which the
</p>
<p>outcome Y depends on X and we explore the quantification of their relationship.
</p>
<p>Examples Examples of associations in which we might be interested in are:
</p>
<p>&bull; body height (X ) and body weight (Y ) of persons,
&bull; speed (X) and braking distance (Y ) measured on cars,
&bull; money invested (in e) in the marketing of a product (X) and sales figures for this
</p>
<p>product (in e) (Y ) measured in various branches,
</p>
<p>&bull; amount of fertilizer used (X ) and yield of rice (Y ) measured on different acres,
and
</p>
<p>&bull; temperature (X ) and hotel occupation (Y ) measured in cities.
</p>
<p>11.1 The Linear Model
</p>
<p>Consider the scatter plots from Fig. 4.2 on p. 80. Plotting X -values against Y -values
</p>
<p>enables us to visualize the relationship between two variables. Figure 11.1a reviews
</p>
<p>what a positive (linear) association between X and Y looks like: the higher the X
</p>
<p>values, the higher the Y -values (and vice versa). The plot indicates that there may
</p>
<p>be a linear relationship between X and Y . On the other hand, Fig. 11.1b displays a
</p>
<p>scatter plot which shows no clear relationship between X and Y . The R2 measure,
</p>
<p>shown in the two figures and explained in more detail later, equates to the squared
</p>
<p>correlation coefficient of Bravais&ndash;Pearson.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>11.1 The Linear Model 251
</p>
<p>To summarize the observed association between X and Y , we can postulate the
</p>
<p>following linear relationship between them:
</p>
<p>Y = α + βX. (11.1)
This Eq. (11.1) represents a straight line where α is the intercept and β represents
</p>
<p>the slope of the line. The slope indicates the change in the Y -value when the X -value
</p>
<p>changes by one unit. If the sign of β is positive, it indicates that the value of Y
</p>
<p>increases as the value of X increases. If the sign of β is negative, it indicates that the
</p>
<p>value of Y decreases as the value of X increases. When X = 0, then Y = α. If α = 0,
then Y = βX represents a line passing through the origin. Suppose the height and
body weights in the example of school children are represented in Fig. 11.1a. This
</p>
<p>has the following interpretation: when the height of a child increases by 1 cm, then
</p>
<p>the body weight increases by β kilograms. The slope β in Fig. 11.1a would certainly
</p>
<p>be positive because we have a positive linear relationship between X and Y . Note
</p>
<p>that in this example, the intercept term has no particular meaning because when the
</p>
<p>height X = 0, the body weight Y = α = 0. The scatter diagram in Fig. 11.1b does
not exhibit any clear relationship between X and Y . Still, the slope of a possible line
</p>
<p>would likely be somewhere around 0.
</p>
<p>It is obvious from Fig. 11.1a that by assuming a linear relationship between X
</p>
<p>and Y , any straight line will not exactly match the data points in the sense that it
</p>
<p>cannot pass through all the observations: the observations will lie above and below
</p>
<p>the line. The line represents a model to describe the process generating the data.
</p>
<p>In our context, a model is a mathematical representation of the relationship
</p>
<p>between two or more variables. A model has two components&mdash;variables (e.g. X, Y )
</p>
<p>and parameters (e.g. α, β). A model is said to be linear if it is linear in its parameters.
</p>
<p>A model is said to be nonlinear if it is nonlinear in its parameters (e.g. β2 instead
</p>
<p>of β). Now assume that each observation potentially deviates by ei from the line in
</p>
<p>Fig. 11.1a. The linear model in Eq. (11.1) can then be written as follows to take this
</p>
<p>into account:
</p>
<p>Y = α + βX + e. (11.2)
Suppose we have n observations (x1, y1), (x2, y2), . . . , (xn, yn), then each obser-
</p>
<p>vation satisfies
</p>
<p>yi = α + βxi + ei . (11.3)
Each deviation ei is called an error. It represents the deviation of the data points
</p>
<p>(xi , yi ) from the regression line. The line in Fig. 11.1a is the fitted (regression)
</p>
<p>line which we will discuss in detail later. We assume that the errors ei are iden-
</p>
<p>tically and independently distributed with mean 0 and constant variance σ 2, i.e.
</p>
<p>E(ei ) = 0,Var(ei ) = σ 2 for all i = 1, 2, . . . , n. We will discuss these assumptions
in more detail in Sect. 11.7.
</p>
<p>In the model (11.2), Y is called the response, response variable, dependent
</p>
<p>variable or outcome; X is called the covariate, regressor or independent variable.
</p>
<p>The scalars α and β are the parameters of the model and are described as regression
</p>
<p>coefficients or parameters of the linear model. In particular,α is called the intercept
</p>
<p>term and β is called the slope parameter.</p>
<p/>
</div>
<div class="page"><p/>
<p>252 11 Linear Regression
</p>
<p>It may be noted that if the regression parametersα and β are known, then the linear
</p>
<p>model is completely known. An important objective in identifying the model is to
</p>
<p>determine the values of the regression parameters using the available observations
</p>
<p>for X and Y . It can be understood from Fig. 11.1a that an ideal situation would be
</p>
<p>when all the data points lie exactly on the line or, in other words, the error ei is zero
</p>
<p>for each observation. It seems meaningful to determine the values of the parameters
</p>
<p>in such a way that the errors are minimized.
</p>
<p>There are several methods to estimate the values of the regression parameters. In
</p>
<p>the remainder of this chapter, we describe the methods of least squares and maximum
</p>
<p>likelihood estimation.
</p>
<p>11.2 Method of Least Squares
</p>
<p>Suppose n sets of observations Pi = (xi , yi ), i = 1, 2, . . . , n, are obtained on two
variables P = (X, Y ) and are plotted in a scatter plot. An example of four observa-
tions, (x1, y1), (x2, y2), (x3, y3), and (x4, y4), is given in Fig. 11.2.
</p>
<p>The method of least squares says that a line can be fitted to the given data set such
</p>
<p>that the errors are minimized. This implies that one can determine α and β such that
</p>
<p>the sum of the squared distances between the data points and the line Y = α + βX
is minimized. For example, in Fig. 11.2, the first data point (x1, y1) does not lie on
</p>
<p>the plotted line and the deviation is e1 = y1 &minus; (α + βx1). Similarly, we obtain the
</p>
<p>x1 x2 x3 x4
</p>
<p>y1
</p>
<p>y2
</p>
<p>y3
</p>
<p>y4
</p>
<p>e1
e2
</p>
<p>e3 e4
</p>
<p>�y = α+ βx
</p>
<p>α
</p>
<p>Slope
</p>
<p>Fig. 11.2 Regression line, observations, and errors ei
&lowast;</p>
<p/>
</div>
<div class="page"><p/>
<p>11.2 Method of Least Squares 253
</p>
<p>difference of the other three data points from the line: e2, e3, e4. The error is zero if
</p>
<p>the point lies exactly on the line. The problem we would like to solve in this example
</p>
<p>is to minimize the sum of squares of e1, e2, e3, and e4, i.e.
</p>
<p>min
α,β
</p>
<p>4&sum;
</p>
<p>i=1
(yi &minus; α &minus; βxi )2. (11.4)
</p>
<p>We want the line to fit the data well. This can generally be achieved by choosing
</p>
<p>α and β such that the squared errors of all the n observations are minimized:
</p>
<p>min
α,β
</p>
<p>n&sum;
</p>
<p>i=1
e2i = min
</p>
<p>α,β
</p>
<p>n&sum;
</p>
<p>i=1
(yi &minus; α &minus; βxi )2. (11.5)
</p>
<p>If we solve this optimization problem by the principle of maxima and minima, we
</p>
<p>obtain estimates of α and β as
</p>
<p>β̂ = Sxy
Sxx
</p>
<p>=
&sum;
</p>
<p>(xi&minus;x̄)(yi&minus;ȳ)&sum;
(xi&minus;x̄)2 =
</p>
<p>&sum;n
i=1 xi yi&minus;nx̄ ȳ&sum;n
</p>
<p>i=1 x
2
i &minus;nx̄2
</p>
<p>α̂ = ȳ &minus; b̂x̄
</p>
<p>}
, (11.6)
</p>
<p>see Appendix C.6 for a detailed derivation. Here, α̂ and β̂ represent the estimates of
</p>
<p>the parameters α and β, respectively, and are called the least squares estimator of
</p>
<p>α and β, respectively. This gives us the model y = α̂ + β̂x which is called the fitted
model or the fitted regression line. The literal meaning of &ldquo;regression&rdquo; is to move
</p>
<p>back. Since we are acquiring the data and then moving back to find the parameters
</p>
<p>of the model using the data, it is called a regression model. The fitted regression
</p>
<p>line y = α̂ + β̂x describes the postulated relationship between Y and X . The sign
of β determines whether the relationship between X and Y is positive or negative.
</p>
<p>If the sign of β is positive, it indicates that if X increases, then Y increases too. On
</p>
<p>the other hand, if the sign of β is negative, it indicates that if X increases, then Y
</p>
<p>decreases. For any given value of X , say xi , the predicted value ŷi is calculated by
</p>
<p>ŷi = α̂ + β̂xi
and is called the i th fitted value.
</p>
<p>If we compare the observed data point (xi , yi )with the point suggested (predicted,
</p>
<p>fitted) by the regression line, (xi , ŷi ), the difference between yi and ŷi is called the
</p>
<p>residual and is given as
</p>
<p>êi = yi &minus; ŷi = yi &minus; (α̂ + β̂xi ). (11.7)
This can be viewed as an estimator of the error ei . Note that it is not really an estimator
</p>
<p>in the true statistical sense because ei is random and so it cannot be estimated.
</p>
<p>However, since the ei are unknown and êi measures the same difference between the
</p>
<p>estimated and true values of the y&rsquo;s, see for example Fig. 11.2, it can be treated as
</p>
<p>estimating the error ei .</p>
<p/>
</div>
<div class="page"><p/>
<p>254 11 Linear Regression
</p>
<p>Example 11.2.1 A physiotherapist advises 12 of his patients, all of whom had the
</p>
<p>same knee surgery done, to regularly perform a set of exercises. He asks them to
</p>
<p>record how long they practise. He then summarizes the average time they practised
</p>
<p>(X , time in minutes) and how long it takes them to regain their full range of motion
</p>
<p>again (Y , time in days). The results are as follows:
</p>
<p>i 1 2 3 4 5 6 7 8 9 10 11 12
</p>
<p>xi 24 35 64 20 33 27 42 41 22 50 36 31
</p>
<p>yi 90 65 30 60 60 80 45 45 80 35 50 45
</p>
<p>To estimate the linear regression line y = α̂ + β̂x , we first calculate x̄ = 35.41
and ȳ = 57.08. To obtain Sxy and Sxx we need the following table:
</p>
<p>i xi yi (xi &minus; x̄) (yi &minus; ȳ) (xi &minus; x̄)(yi &minus; ȳ) (xi &minus; x̄)2
1 24 90 &minus;11.41 32.92 &minus;375.61 130.19
2 35 65 &minus;0.41 7.92 &minus;3.25 0.17
3 64 30 28.59 &minus;27.08 &minus;774.22 817.39
4 20 60 &minus;15.41 2.92 &minus;45.00 237.47
5 33 60 &minus;2.41 2.92 &minus;7.27 5.81
6 27 80 &minus;8.41 22.92 &minus;192.75 70.73
7 42 45 6.59 &minus;12.08 &minus;79.61 43.43
8 41 45 5.59 &minus;12.08 &minus;67.53 31.25
9 22 80 &minus;13.41 22.92 &minus;307.36 179.83
10 50 35 14.59 &minus;22.08 &minus;322.14 212.87
11 36 50 0.59 &minus;7.08 &minus;4.18 0.35
12 31 45 &minus;4.41 &minus;12.08 53.27 19.45
</p>
<p>Total &minus;2125.65 1748.94
</p>
<p>Using (11.6), we can now easily find the least squares estimates α̂ and β̂ as
</p>
<p>β̂ = Sxy
Sxx
</p>
<p>=
&sum;
</p>
<p>(xi &minus; x̄)(yi &minus; ȳ)&sum;
(xi &minus; x̄)2
</p>
<p>= &minus;2125.65
1748.94
</p>
<p>&asymp; &minus;1.22,
</p>
<p>α̂ = ȳ &minus; β̂ x̄ = 57.08 &minus; (&minus;1.215) &middot; 35.41 = 100.28.
The fitted regression line is therefore
</p>
<p>y = 100.28 &minus; 1.22 &middot; x .
We can interpret the results as follows:
</p>
<p>&bull; For an increase of 1 min in exercising, the recovery time decreases by 1.22 days
because β̂ = &minus;1.22. The negative sign of β̂ indicates that the relationship between
exercising time and recovery time is negative; i.e. as exercise time increases, the
</p>
<p>recovery time decreases.
</p>
<p>&bull; When comparing two patients with a difference in exercising time of 10 min,
the linear model estimates a difference in recovery time of 12.2 days because
</p>
<p>10 &middot; 1.22 = 12.2.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.2 Method of Least Squares 255
</p>
<p>Fig. 11.3 Scatter plot and
</p>
<p>regression line for
</p>
<p>Example 11.2.1
</p>
<p>0 10 20 30 40 50 60 70
</p>
<p>0
2
</p>
<p>0
4
</p>
<p>0
6
</p>
<p>0
8
</p>
<p>0
1
</p>
<p>0
0
</p>
<p>Exercise Time
</p>
<p>R
e
</p>
<p>c
o
v
e
</p>
<p>ry
 T
</p>
<p>im
e
</p>
<p>&bull; The model predicts an average recovery time of 100.28&minus;1.22 &middot; 38 = 53.92 days
for a patient who practises the set of exercises for 38 min.
</p>
<p>&bull; If a patient did not exercise at all, the recovery time would be predicted as â =
100.28 days by the model. However, see item (i) in Sect. 11.2.1 below about
</p>
<p>interpreting a regression line outside of the observed data range.
</p>
<p>We can also obtain these results by using R. The command lm(Y&sim;X) fits a linear
model and provides the estimates of α̂ and β̂.
</p>
<p>lm(Y&sim;X)
</p>
<p>We can draw the regression line onto a scatter plot using the command abline,
</p>
<p>see also Fig. 11.3.
</p>
<p>plot(X,Y)
</p>
<p>abline(a=100.28,b=-1.22)
</p>
<p>11.2.1 Properties of the Linear Regression Line
</p>
<p>There are a couple of interesting results related to the regression line and the least
</p>
<p>square estimates.
</p>
<p>(i) As a rule of thumb, one should interpret the regression line ŷi = α̂ + β̂xi only in
the interval [x(1), x(n)]. For example, if X denotes &ldquo;Year&rdquo;, with observed values</p>
<p/>
</div>
<div class="page"><p/>
<p>256 11 Linear Regression
</p>
<p>from 1999 to 2015, and Y denotes the &ldquo;annual volume of sales of a particular
</p>
<p>company&rdquo;, then a prediction for the year 2030 may not be meaningful or valid
</p>
<p>because a linear relationship discovered in the past may not continue to hold in
</p>
<p>the future.
</p>
<p>(ii) For the points P̂i = (xi , ŷi ), forming the regression line, we can write
ŷi = α̂ + β̂xi = ȳ + β̂(xi &minus; x̄). (11.8)
</p>
<p>(iii) It follows for xi = x̄ that ŷi = ȳ, i.e. the point (x̄, ȳ) always lies on the regres-
sion line. The linear regression line therefore always passes through (x̄, ȳ).
</p>
<p>(iv) The sum of the residuals is zero. The i th residual is defined as
</p>
<p>êi = yi &minus; ŷi = yi &minus; (α̂ + β̂xi ) = yi &minus; [ȳ + β̂(xi &minus; x̄)].
The sum is therefore
</p>
<p>n&sum;
</p>
<p>i=1
êi =
</p>
<p>n&sum;
</p>
<p>i=1
yi &minus;
</p>
<p>n&sum;
</p>
<p>i=1
ȳ &minus; β̂
</p>
<p>n&sum;
</p>
<p>i=1
(xi &minus; x̄)
</p>
<p>= n ȳ &minus; n ȳ &minus; β̂(nx̄ &minus; nx̄) = 0. (11.9)
(v) The arithmetic mean of ŷ is the same as the arithmetic mean of y:
</p>
<p>&macr;̂y = 1
n
</p>
<p>n&sum;
</p>
<p>i=1
ŷi =
</p>
<p>1
</p>
<p>n
(n ȳ + β̂(nx̄ &minus; nx̄)) = ȳ. (11.10)
</p>
<p>(vi) The least squares estimate β̂ has a direct relationship with the correlation coef-
</p>
<p>ficient of Bravais&ndash;Pearson:
</p>
<p>β̂ = Sxy
Sxx
</p>
<p>= Sxy&radic;
Sxx
</p>
<p>&radic;
Syy
</p>
<p>&middot;
&radic;
</p>
<p>Syy
</p>
<p>Sxx
= r
</p>
<p>&radic;
Syy
</p>
<p>Sxx
. (11.11)
</p>
<p>The slope of the regression line is therefore proportional to the correlation coef-
</p>
<p>ficient r : a positive correlation coefficient implies a positive estimate of β and
</p>
<p>vice versa. However, a stronger correlation does not necessarily imply a steeper
</p>
<p>slope in the regression analysis because the slope depends upon
&radic;
</p>
<p>Syy/Sxx as
</p>
<p>well.
</p>
<p>11.3 Goodness of Fit
</p>
<p>While one can easily fit a linear regression model, this does not mean that the model
</p>
<p>is necessarily good. Consider again Fig. 11.1: In Fig. 11.1a, the regression line is
</p>
<p>clearly capturing the linear trend seen in the scatter plot. The fit of the model to the
</p>
<p>data seems good. Figure 11.1b shows however that the data points vary considerably
</p>
<p>around the line. The quality of the model does not seem to be very good. If we would
</p>
<p>use the regression line to predict the data, we would likely obtain poor results. It
</p>
<p>is obvious from Fig. 11.1 that the model provides a good fit to the data when the
</p>
<p>observations are close to the line and capture a linear trend.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Goodness of Fit 257
</p>
<p>R
2
=0.97
</p>
<p>(a) Strong linear relationship
</p>
<p>R
2
=0.57
</p>
<p>(b) Weak linear relationship
</p>
<p>Fig. 11.4 Different goodness of fit for different data
</p>
<p>A look at the scatter plot provides a visual and qualitative approach to judging
</p>
<p>the quality of the fitted model. Consider Fig. 11.4a, b which both show a linear trend
</p>
<p>in the data, but the observations in Fig. 11.4a are closer to the regression line than
</p>
<p>those in Fig. 11.4b. Therefore, the goodness of fit is worse in the latter figure and any
</p>
<p>quantitative measure should capture this.
</p>
<p>A quantitative measure for the goodness of fit can be derived by means of vari-
</p>
<p>ance decomposition of the data. The total variation of y is partitioned into two
</p>
<p>components&mdash;sum of squares due to the fitted model and sum of squares due to
</p>
<p>random errors in the data:
n&sum;
</p>
<p>i=1
(yi &minus; ȳ)2
</p>
<p>︸ ︷︷ ︸
SQTotal
</p>
<p>=
n&sum;
</p>
<p>i=1
(ŷi &minus; ȳ)2
</p>
<p>︸ ︷︷ ︸
SQRegression
</p>
<p>+
n&sum;
</p>
<p>i=1
(yi &minus; ŷi )2
</p>
<p>︸ ︷︷ ︸
SQError
</p>
<p>. (11.12)
</p>
<p>The proof of the above equation is given in Appendix C.6.
</p>
<p>The left-hand side of (11.12) represents the total variability in y with respect to
</p>
<p>ȳ. It is proportional to the sample variance (3.21) and is called SQTotal (total sum of
</p>
<p>squares). The first term on the right-hand side of the equation measures the variability
</p>
<p>which is explained by the fitted linear regression model (SQRegression, sum of squares
</p>
<p>due to regression); the second term relates to the error sum of squares (SQError) and
</p>
<p>reflects the variation due to random error involved in the fitted model. Larger values
</p>
<p>of SQError indicate that the deviations of the observations from the regression line are
</p>
<p>large. This implies that the model provides a bad fit to the data and that the goodness
</p>
<p>of fit is low.
</p>
<p>Obviously, one would like to have a fit in which the error sum of squares is as
</p>
<p>small as possible. To judge the goodness of fit, one can therefore look at the error
</p>
<p>sum of squares in relation to the total sum of squares: in an ideal situation, if the error
</p>
<p>sum of squares equals zero, the total sum of squares is equal to the sum of squares
</p>
<p>due to regression and the goodness of fit is optimal. On the other hand, if the sum of
</p>
<p>squares due to error is large, it will make the sum of squares due to regression smaller</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>258 11 Linear Regression
</p>
<p>and the goodness of fit should be bad. If the sum of squares due to regression is zero,
</p>
<p>it is evident that the model fit is the worst possible. These thoughts are reflected in
</p>
<p>the criterion for the goodness of fit, also known as R2:
</p>
<p>R2 = SQRegression
SQTotal
</p>
<p>= 1 &minus; SQError
SQTotal
</p>
<p>. (11.13)
</p>
<p>It follows from the above definition that 0 &le; R2 &le; 1. The closer R2 is to 1, the better
the fit because SQError will then be small. The closer R
</p>
<p>2 is to 0, the worse the fit,
</p>
<p>because SQError will then be large. If R
2 takes any other value, say R2 = 0.7, it
</p>
<p>means that only 70 % of the variation in data is explained by the fitted model, and
</p>
<p>hence, in simple language, the model is 70 % good. An important point to remember
</p>
<p>is that R2 is defined only when there is an intercept term in the model (an assumption
</p>
<p>we make throughout this chapter). So it is not used to measure the goodness of fit in
</p>
<p>models without an intercept term.
</p>
<p>Example 11.3.1 Consider again Fig. 11.1: In Fig. 11.1a, the line and data points fit
</p>
<p>well together. As a consequence R2 is high, R2 = 0.82. Figure 11.1b shows data
points with large deviations from the regression line; therefore, R2 is small, here
</p>
<p>R2 = 0.002. Similarly, in Fig. 11.4a, an R2 of 0.97 relates to an almost perfect
model fit, whereas in Fig. 11.4b, the model describes the data only moderately well
</p>
<p>(R2 = 0.57).
</p>
<p>Example 11.3.2 Consider again Example 11.2.1 where we analysed the relationship
</p>
<p>between exercise intensity and recovery time for patients convalescing from knee
</p>
<p>surgery. To calculate R2, we need the following table:
</p>
<p>i yi ŷi (yi &minus; ȳ) (yi &minus; ȳ)2 (ŷi &minus; ȳ) (ŷi &minus; ȳ)2
1 90 70.84 32.92 1083.73 13.76 189.34
</p>
<p>2 65 57.42 7.92 62.73 0.34 0.12
</p>
<p>3 30 22.04 &minus;27.08 733.33 &minus;35.04 1227.80
4 60 75.72 2.92 8.53 18.64 347.45
</p>
<p>5 60 59.86 2.92 8.53 2.78 7.73
</p>
<p>6 80 67.18 22.92 525.33 10.10 102.01
</p>
<p>7 45 48.88 &minus;12.08 145.93 &minus;8.2 67.24
8 45 50.10 &minus;12.08 145.93 &minus;6.83 48.72
9 80 73.28 22.92 525.33 16.20 262.44
</p>
<p>10 35 39.12 &minus;22.08 487.53 &minus;17.96 322.56
11 50 56.20 &minus;7.08 50.13 &minus;0.88 0.72
12 45 62.30 &minus;12.08 145.93 5.22 27.25
</p>
<p>Total 3922.96 2603.43
</p>
<p>We calculate R2 with these results as
</p>
<p>R2 = SQRegression
SQTotal
</p>
<p>=
&sum;n
</p>
<p>i=1(ŷi &minus; ȳ)2&sum;n
i=1(yi &minus; ȳ)2
</p>
<p>= 2603.43
3922.96
</p>
<p>= 0.66.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Goodness of Fit 259
</p>
<p>We conclude that the regression model provides a reasonable but not perfect fit to
</p>
<p>the data because 0.66 is not close to 0, but also not very close to 1. About 66 % of the
</p>
<p>variability in the data can be explained by the fitted linear regression model. The rest
</p>
<p>is random error: for example, individual variation in the recovery time of patients
</p>
<p>due to genetic and environmental factors, surgeon performance, and others.
</p>
<p>We can also obtain this result in R by looking at the summary of the linear model:
</p>
<p>summary(lm(Y&sim;X))
</p>
<p>Please note that we give a detailed explanation of the model summary in Sect. 11.7.
</p>
<p>There is a direct relationship between R2 and the correlation coefficient of
</p>
<p>Bravais&ndash;Pearson r :
</p>
<p>R2 = r2 =
(
</p>
<p>Sxy&radic;
Sxx Syy
</p>
<p>)2
. (11.14)
</p>
<p>The proof is given in Appendix C.6.
</p>
<p>Example 11.3.3 Consider again Examples 11.3 and 11.5 where we analysed the
</p>
<p>association of exercising time and time to regain full range of motion after knee
</p>
<p>surgery. We calculated R2 = 0.66. We therefore know that the correlation coefficient
is r =
</p>
<p>&radic;
R2 =
</p>
<p>&radic;
0.66 &asymp; 0.81.
</p>
<p>11.4 Linear Regression with a Binary Covariate
</p>
<p>Until now, we have assumed that the covariate X is continuous. It is however also
</p>
<p>straightforward to fit a linear regression model when X is binary, i.e. if X has two
</p>
<p>categories. In this case, the values of X in the first category are usually coded as
</p>
<p>0 and the values of X in the second category are coded as 1. For example, if the
</p>
<p>binary variable is &ldquo;gender&rdquo;, we replace the word &ldquo;male&rdquo; with the number 0 and
</p>
<p>the word &ldquo;female&rdquo; with 1. We can then fit a linear regression model using these
</p>
<p>numbers, but the interpretation differs from the interpretations in case of a continuous
</p>
<p>variable. Recall the definition of the linear model, Y = α + βX + e with E(e) = 0;
if X = 0 (male) then E(Y |X = 0) = α and if X = 1 (female), then E(Y |X = 1) =
α + β &middot; 1 = α + β. Thus, α is the average value of Y for males, i.e. E(Y |X = 0),
andβ = E(Y |X = 1)&minus; E(Y |X = 0). It follows that those subjects with X = 1 (e.g.
females) have on average Y -values which areβ units higher than subjects with X = 0
(e.g. males).</p>
<p/>
</div>
<div class="page"><p/>
<p>260 11 Linear Regression
</p>
<p>Example 11.4.1 Recall Examples 11.2.1, 11.3.2, and 11.3.3 where we analysed the
</p>
<p>association of exercising time and recovery time after knee surgery. We keep the
</p>
<p>values of Y (recovery time, in days) and replace values of X (exercising time, in
</p>
<p>minutes) with 0 for patients exercising for less than 40 min and with 1 for patients
</p>
<p>exercising for 40 min or more. We have therefore a new variable X indicating whether
</p>
<p>a patient is exercising a lot (X = 1) or not (X = 0). To estimate the linear regression
line ŷ = α̂ + β̂x , we first calculate x̄ = 4/12 and ȳ = 57.08. To obtain Sxy and Sxx ,
we need the following table:
</p>
<p>i xi yi (xi &minus; x̄) (yi &minus; ȳ) (xi &minus; x̄)(yi &minus; ȳ) (xi &minus; x̄)2
</p>
<p>1 0 90 &minus; 4
12
</p>
<p>32.92 &minus;10.97 0.11
</p>
<p>2 0 65 &minus; 4
12
</p>
<p>7.92 &minus;2.64 0.11
3 1 30 8
</p>
<p>12
&minus;27.08 &minus;18.05 0.44
</p>
<p>4 0 60 &minus; 4
12
</p>
<p>2.92 &minus;0.97 0.11
5 0 60 &minus; 4
</p>
<p>12
2.92 &minus;0.97 0.11
</p>
<p>6 0 80 &minus; 4
12
</p>
<p>22.92 &minus;7.64 0.11
7 1 45 8
</p>
<p>12
&minus;12.08 &minus;8.05 0.44
</p>
<p>8 1 45 8
12
</p>
<p>&minus;12.08 &minus;8.05 0.44
9 0 80 &minus; 4
</p>
<p>12
22.92 &minus;7.64 0.11
</p>
<p>10 1 35 8
12
</p>
<p>&minus;22.08 &minus;14.72 0.44
11 0 50 &minus; 4
</p>
<p>12
&minus;7.08 2.36 0.11
</p>
<p>12 0 45 &minus; 4
12
</p>
<p>&minus;12.08 4.03 0.11
Total Total &minus;72.34 2.64
</p>
<p>We can now calculate the least squares estimates of α and β using (11.6) as
</p>
<p>β̂ = Sxy
Sxx
</p>
<p>=
&sum;
</p>
<p>(xi &minus; x̄)(yi &minus; ȳ)&sum;
(xi &minus; x̄)2
</p>
<p>= &minus;72.34
2.64
</p>
<p>&asymp; &minus;27.4,
</p>
<p>α̂ = ȳ &minus; β̂ x̄ = 57.08 &minus; (&minus;27.4) &middot; 4
12
</p>
<p>= 66.2.
</p>
<p>The fitted regression line is:
</p>
<p>y = 66.2 &minus; 27.4 &middot; x .
The interpretation is:
</p>
<p>&bull; The average recovery time for patients doing little exercise is 66.2 &minus; 27.4 &middot; 0 =
66.2 days.
</p>
<p>&bull; Patients exercising heavily (x = 1) have, on average, a 27.4 days shorter recovery
period (β = &minus;27.4) than patients with a short exercise time (x = 0).
</p>
<p>&bull; The average recovery time for patients exercising heavily is 38.8 days (66.2 &minus;
27.4 &middot; 1 for x = 1).
</p>
<p>&bull; These interpretations are visualized in Fig. 11.5. Because &ldquo;exercise time&rdquo; (X )
is considered to be a nominal variable (two categories representing the intervals
</p>
<p>[0; 40) and (40;&infin;)), we can plot the regression line on a scatter plot as two parallel
lines.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.5 Linear Regression with a Transformed Covariate 261
</p>
<p>Fig. 11.5 Scatter plot and
</p>
<p>regression lines for
</p>
<p>Examples 11.4.1 and 11.5.1
</p>
<p>20 30 40 50 60 70
</p>
<p>2
0
</p>
<p>4
0
</p>
<p>6
0
</p>
<p>8
0
</p>
<p>1
0
</p>
<p>0
</p>
<p>Exercise Time
</p>
<p>R
e
</p>
<p>c
o
v
e
</p>
<p>ry
 T
</p>
<p>im
e
</p>
<p>b
^
=27.5
</p>
<p>binary X
</p>
<p>square root of X
</p>
<p>11.5 Linear Regression with a Transformed Covariate
</p>
<p>Recall that a model is said to be linear when it is linear in its parameters. The definition
</p>
<p>of a linear model is not at all related to the linearity in the covariate. For example,
</p>
<p>Y = α + β2 X + e
is not a linear model because the right-hand side of the equation is not a linear
</p>
<p>function in β. However,
</p>
<p>Y = α + βX2 + e
is a linear model. This model can be fitted as for any other linear model: we obtain
</p>
<p>α̂ and β̂ as usual and simply use the squared values of X instead of X . This can
</p>
<p>be justified by considering X&lowast; = X2, and then, the model is written as Y = α +
βX&lowast; + e which is again a linear model. Only the interpretation changes: for each
unit increase in the squared value of X , i.e. X&lowast;, Y increases by β units. Such an
interpretation is often not even needed. One could simply plot the regression line of
</p>
<p>Y on X&lowast; to visualize the functional form of the effect. This is also highlighted in the
following example.
</p>
<p>Example 11.5.1 Recall Examples 11.2.1, 11.3.2, 11.3.3, and 11.4.1 where we
</p>
<p>analysed the association of exercising time and recovery time after knee surgery. We
</p>
<p>estimated β̂ as &minus;1.22 by using X as it is, as a continuous variable, see also Fig. 11.3.
When using a binary X , based on a cut-off of 40 min, we obtained β̂ = &minus;27.4, see
also Fig. 11.5. If we now use
</p>
<p>&radic;
X rather than X , we obtain β̂ = &minus;15.1. This means for</p>
<p/>
</div>
<div class="page"><p/>
<p>262 11 Linear Regression
</p>
<p>an increase of 1 unit of the square root of exercising time, the recovery time decreases
</p>
<p>by 15.1 days. Such an interpretation will be difficult to understand for many people.
</p>
<p>It is better to plot the linear regression line y = 145.8 &minus; 15.1 &middot; &radic;x , see Fig. 11.5. We
can see that the new nonlinear line (obtained from a linear model) fits the data nicely
</p>
<p>and it may even be preferable to a straight regression line. Moreover, the value of α
</p>
<p>substantially increased with this modelling approach, highlighting that no exercis-
</p>
<p>ing at all may severely delay recovery from the surgery (which is biologically more
</p>
<p>meaningful). In R, we obtain these results by either creating a new variable
&radic;
</p>
<p>X or
</p>
<p>by using the I() command which allows specifying transformations in regression
</p>
<p>models.
</p>
<p>newX &lt;- sqrt(X)
</p>
<p>lm(Y&sim;newX) #option 1
lm(Y&sim;I(sqrt(X))) #option 2
</p>
<p>Generally the covariate X can be replaced by any transformation of it, such as
</p>
<p>using log(X),
&radic;
</p>
<p>X , sin(X), or X2. The details are discussed in Sect. 11.6.3. It is
</p>
<p>also possible to compare the quality and goodness of fit of models with different
</p>
<p>transformations (see Sect. 11.8).
</p>
<p>11.6 Linear Regression with Multiple Covariates
</p>
<p>Up to now, we have only considered two variables&mdash;Y and X . We therefore assume
</p>
<p>that Y is affected by only one covariate X . However, in many situations, there might
</p>
<p>be more than one covariate which affects Y and consequently all of them are relevant
</p>
<p>to the analysis (see also Sect. 11.10 on the difference between association and causa-
</p>
<p>tion). For example, the yield of a crop depends on several factors such as quantity of
</p>
<p>fertilizer, irrigation, and temperature, among others. In another example, in the pizza
</p>
<p>data set (described in Appendix A.4), many variables could potentially be associated
</p>
<p>with delivery time&mdash;driver, amount of food ordered, operator handling the order,
</p>
<p>whether it is a weekend, and so on. A reasonable question to ask is: Do different
</p>
<p>drivers have (on average) a different delivery time&mdash;given they deal with the same
</p>
<p>operator, the amount of food ordered is the same, the day is the same, etc. These kind
</p>
<p>of questions can be answered with multiple linear regression. The model contains
</p>
<p>more than one, say p, covariates X1, X2, . . . , X p. The linear model (11.2) can be
</p>
<p>extended as
</p>
<p>Y = β0 + β1 X1 + &middot; &middot; &middot; + βp X p + e. (11.15)
Note that the intercept term is denoted here by β0. In comparison with (11.2), α = β0
and β = β1.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.6 Linear Regression with Multiple Covariates 263
</p>
<p>Example 11.6.1 For the pizza delivery data, a particular linear model with multiple
</p>
<p>covariates could be specified as follows:
</p>
<p>Delivery Time = β0 + β1Number pizzas ordered + β2Weekend(0/1)
+β3Operator (0/1) + e.
</p>
<p>11.6.1 Matrix Notation
</p>
<p>If we have a data set of n observations, then every set of observations satisfies model
</p>
<p>(11.15) and we can write
</p>
<p>y1 = β0 + β1x11 + β2x12 + &middot; &middot; &middot; + βpx1p +e1
y2 = β0 + β1x21 + β2x22 + &middot; &middot; &middot; + βpx2p +e2
...
</p>
<p>...
...
</p>
<p>yn = β0 + β1xn1 + β2xn2 + &middot; &middot; &middot; + βpxnp +en (11.16)
It is possible to write the n equations in (11.16) in matrix notation as
</p>
<p>y = Xβ + e (11.17)
where
</p>
<p>y =
</p>
<p>⎛
⎜⎜⎜⎝
</p>
<p>y1
y2
...
</p>
<p>yn
</p>
<p>⎞
⎟⎟⎟⎠ , X =
</p>
<p>⎛
⎜⎜⎜⎝
</p>
<p>1 x11 x12 &middot; &middot; &middot; x1p
1 x21 x22 &middot; &middot; &middot; x2p
...
</p>
<p>1 xn1 xn2 &middot; &middot; &middot; xnp
</p>
<p>⎞
⎟⎟⎟⎠ , β =
</p>
<p>⎛
⎜⎜⎜⎝
</p>
<p>β0
β1
...
</p>
<p>βp
</p>
<p>⎞
⎟⎟⎟⎠ , e =
</p>
<p>⎛
⎜⎜⎜⎝
</p>
<p>e1
e2
...
</p>
<p>en
</p>
<p>⎞
⎟⎟⎟⎠ .
</p>
<p>The letters y,X,β, e are written in bold because they refer to vectors and matrices
</p>
<p>rather than scalars. The capital letter X makes it clear that X is a matrix of order
</p>
<p>n &times; p representing the n observations on each of the covariates X1, X2, . . . , X p.
Similarly, y is a n &times; 1 vector of n observations on Y,β is a p &times; 1 vector of regression
coefficients associated with X1, X2, . . . , X p, and e is a n &times; 1 vector of n errors. The
lower case letter x relates to a vector representing a variable which means we can
</p>
<p>denote the multiple linear model from now on also as
</p>
<p>y = β01 + β1x1 + &middot; &middot; &middot; + βpxp + e (11.18)
where 1 is the n &times; 1 vector of 1&rsquo;s. We assume that E(e) = 0 and Cov(e) = σ 2 I (see
Sect. 11.9 for more details).
</p>
<p>We would like to highlight that X is not the data matrix. The matrix X is called
</p>
<p>the design matrix and contains both a column of 1&rsquo;s denoting the presence of the
</p>
<p>intercept term and all explanatory variables which are relevant to the multiple linear
</p>
<p>model (including possible transformations and interactions, see Sects. 11.6.3 and
</p>
<p>11.7.3). The errors e reflect the deviations of the observations from the regression
</p>
<p>line and therefore the difference between the observed and fitted relationships. Such
</p>
<p>deviations may occur for various reasons. For example, the measured values can be</p>
<p/>
</div>
<div class="page"><p/>
<p>264 11 Linear Regression
</p>
<p>affected by variables which are not included in the model, the variables may not be
</p>
<p>accurately measured, there is unmeasured genetic variability in the study population,
</p>
<p>and all of which are covered in the error e. The estimate of β is obtained by using the
</p>
<p>least squares principle by minimizing
&sum;n
</p>
<p>i=1 e
2
i = e&prime;e. The least squares estimate
</p>
<p>of β is given by
</p>
<p>β̂ = (X&prime;X)&minus;1X&prime;y. (11.19)
The vector β̂ contains the estimates of (β0, β1, . . . , βp)
</p>
<p>&prime;. We can interpret it as
earlier: β̂0 is the estimate of the intercept which we obtain because we have added the
</p>
<p>column of 1&rsquo;s (and is identical to α in (11.1)). The estimates β̂1, β̂2, . . . , β̂p refer to
</p>
<p>the regression coefficients associated with the variables x1, x2, . . . , xp, respectively.
</p>
<p>The interpretation of β̂ j is that it represents the partial change in yi when the value
</p>
<p>of xi changes by one unit keeping all other covariates fixed.
</p>
<p>A possible interpretation of the intercept term is that when all covariates equal
</p>
<p>zero then
</p>
<p>E(y) = β0 + β1 &middot; 0 + &middot; &middot; &middot; + βp &middot; 0 = β0. (11.20)
There are many situations in real life for which there is no meaningful interpretation
</p>
<p>of the intercept term because one or many covariates cannot take the value zero. For
</p>
<p>instance, in the pizza data set, the bill can never be e0, and thus, there is no need
</p>
<p>to describe the average delivery time for a given bill of e0. The intercept term here
</p>
<p>serves the purpose of improvement of the model fit, but it will not be interpreted.
</p>
<p>In some situations, it may happen that the average value of y is zero when all
</p>
<p>covariates are zero. Then, the intercept term is zero as well and does not improve
</p>
<p>the model. For example, suppose the salary of a person depends on two factors&mdash;
</p>
<p>education level and type of qualification. If any person is completely illiterate, even
</p>
<p>then we observe in practice that his salary is never zero. So in this case, there is a
</p>
<p>benefit of the intercept term. In another example, consider that the velocity of a car
</p>
<p>depends on two variables&mdash;acceleration and quantity of petrol. If these two variables
</p>
<p>take values of zero, the velocity is zero on a plane surface. The intercept term will
</p>
<p>therefore be zero as well and yields no model improvement.
</p>
<p>Example 11.6.2 Consider the pizza data described in Appendix A.4. The data matrix
</p>
<p>X is as follows:
</p>
<p>X =
</p>
<p>⎛
⎜⎜⎜⎝
</p>
<p>Day Date Time &middot; &middot; &middot; Discount
Thursday 1-May-14 35.1 &middot; &middot; &middot; 1
Thursday 1-May-14 25.2 &middot; &middot; &middot; 0
</p>
<p>...
...
</p>
<p>Saturday 31-May-14 35.7 &middot; &middot; &middot; 0
</p>
<p>⎞
⎟⎟⎟⎠
</p>
<p>Suppose the manager has the hypothesis that the operator and the overall bill (as
</p>
<p>a proxy for the amount ordered from the customer) influence the delivery time. We
</p>
<p>can postulate a linear model to describe this relationship as
</p>
<p>Delivery Time = β0 + β1Bill + β2Operator + e.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.6 Linear Regression with Multiple Covariates 265
</p>
<p>The model in matrix notation is as follows:⎛
⎜⎜⎜⎝
</p>
<p>35.1
</p>
<p>25.2
...
</p>
<p>35.7
</p>
<p>⎞
⎟⎟⎟⎠
</p>
<p>︸ ︷︷ ︸
y
</p>
<p>=
</p>
<p>⎛
⎜⎜⎜⎝
</p>
<p>1 58.4 1
</p>
<p>1 26.4 0
...
</p>
<p>...
...
</p>
<p>1 42.7 0
</p>
<p>⎞
⎟⎟⎟⎠
</p>
<p>︸ ︷︷ ︸
X
</p>
<p>⎛
⎝
β0
β1
β2
</p>
<p>⎞
⎠
</p>
<p>︸ ︷︷ ︸
β
</p>
<p>+
</p>
<p>⎛
⎜⎜⎜⎝
</p>
<p>e1
e2
...
</p>
<p>e1266
</p>
<p>⎞
⎟⎟⎟⎠
</p>
<p>︸ ︷︷ ︸
e
</p>
<p>To understand the associations in the data, we need to estimate β which we obtain by
</p>
<p>the least squares estimator β̂ = (X&prime;X)&minus;1X&prime;y. Rather than doing this tiresome task
manually, we use R:
</p>
<p>lm(time&sim;bill+operator)
</p>
<p>If we have more than one covariate in a linear regression model, we simply add
</p>
<p>all of them separated by the + sign when specifying the model formula in the lm()
function. We obtain β̂0 = 23.1, β̂1 = 0.26, β̂2 = 0.16. The interpretation of these
parameters is as follows:
</p>
<p>&bull; For each extrae that is spent, the delivery time increases by 0.26 min. Or, for each
extra e10 spent, the delivery time increases on average by 2.6 min.
</p>
<p>&bull; The delivery time is on average 0.16 min longer for operator 1 compared with
operator 0.
</p>
<p>&bull; For operator 0 and a bill of e0, the expected delivery time is β0 = 23.1 min.
However, there is no bill ofe0, and therefore, the interceptβ0 cannot be interpreted
</p>
<p>meaningfully here and is included only for improvement of the model fit.
</p>
<p>11.6.2 Categorical Covariates
</p>
<p>We now consider the case when covariates are categorical rather than continuous.
</p>
<p>Examples
</p>
<p>&bull; Region: East, West, South, North,
&bull; Marital status: single, married, divorced, widowed,
&bull; Day: Monday, Tuesday, . . ., Sunday.
</p>
<p>We have already described how to treat a categorical variable which consists of
</p>
<p>two categories, i.e. a binary variable: one category is replaced by 1&rsquo;s and the other
</p>
<p>category is replaced by 0&rsquo;s subjects who belong to the category x = 1 have on average
y-values which are β̂ units higher than those subjects with x = 0.</p>
<p/>
</div>
<div class="page"><p/>
<p>266 11 Linear Regression
</p>
<p>Consider a variable x which has more than two categories, say k &gt; 2 categories. To
</p>
<p>include such a variable in a regression model, we create k &minus; 1 new variables xi , i =
1, 2, . . . , k &minus; 1. Similar to how we treat binary variables, each of these variables is
a dummy variable and consists of 1&rsquo;s for units which belong to the category of
</p>
<p>interest and 0&rsquo;s for the other category
</p>
<p>xi =
{
</p>
<p>1 for category i ,
</p>
<p>0 otherwise.
(11.21)
</p>
<p>The category for which we do not create a dummy variable is called the reference
</p>
<p>category, and the interpretation of the parameters of the dummy variables is with
</p>
<p>respect to this category. For example, for category i , the y-values are on average βi
higher than for the reference category. The concept of creating dummy variables and
</p>
<p>interpreting them is explained in the following example.
</p>
<p>Example 11.6.3 Consider again the pizza data set described in Appendix A.4. The
</p>
<p>manager may hypothesize that the delivery times vary with respect to the branch.
</p>
<p>There are k = 3 branches: East, West, Centre. Instead of using the variable x =
branch, we create (k &minus; 1), i.e. (3 &minus; 1) = 2 new variables denoting x1 = East and
x2 = West. We set x1 = 1 for those deliveries which come from the branch in the
East and set x1 = 0 for other deliveries. Similarly, we set x2 = 1 for those deliveries
which come from the West and x2 = 0 for other deliveries. The data then is as follows:
</p>
<p>⎛
⎜⎜⎜⎜⎜⎜⎜⎜⎜⎜⎝
</p>
<p>Delivery y (Delivery Time) x (Branch) x1 (East) x2 (West)
</p>
<p>1 35.1 East 1 0
</p>
<p>2 25.2 East 1 0
</p>
<p>3 45.6 West 0 1
</p>
<p>4 29.4 East 1 0
</p>
<p>5 30.0 West 0 1
</p>
<p>6 40.3 Centre 0 0
...
</p>
<p>...
...
</p>
<p>...
</p>
<p>1266 35.7 West 0 1
</p>
<p>⎞
⎟⎟⎟⎟⎟⎟⎟⎟⎟⎟⎠
</p>
<p>Deliveries which come from the East have x1 = 1 and x2 = 0, deliveries which
come from the West have x1 = 0 and x2 = 1, and deliveries from the Centre have
x1 = 0 and x2 = 0. The regression model of interest is thus
</p>
<p>y = β0 + β1East + β2West + e.
We can calculate the least squares estimate β̂ = (β̂0, β̂1, β̂2)&prime; = (X&prime;X)&minus;1X&prime;y via R:
either (i) we create the dummy variables ourselves or (ii) we ask R to create it for
</p>
<p>us. This requires that &ldquo;branch&rdquo; is a factor variable (which it is in our data, but if it
</p>
<p>was not, then we would have to define it in the model formula via as.factor()).
</p>
<p>East &lt;- as.numeric(branch=='East')
</p>
<p>West &lt;- as.numeric(branch=='West')
</p>
<p>lm(time&sim; East+West) # option 1
lm(time&sim; branch) # option 2a
lm(time&sim; as.factor(branch)) # option 2b</p>
<p/>
</div>
<div class="page"><p/>
<p>11.6 Linear Regression with Multiple Covariates 267
</p>
<p>We obtain the following results:
</p>
<p>Y = 36.3 &minus; 5.2East &minus; 1.1West.
The interpretations are as follows:
</p>
<p>&bull; The average delivery time for the branch in the Centre is 36.3 min, the delivery
time for the branch in the East is 36.3 &minus; 5.2 = 31.1 min, and the predicted delivery
time for the West is 36.3 &minus; 1.1 = 35.2 min.
</p>
<p>&bull; Therefore, deliveries arrive on average 5.2 min earlier in the East compared with
the centre (β̂1 = &minus;5.2), and deliveries in the West arrive on average 1.1 min earlier
than in the centre (β̂2 = &minus;1.1). In other words, it takes 5.2 min less to deliver a
pizza in the East than in the Centre. The deliveries in the West take on average
</p>
<p>1.1 min less than in the Centre.
</p>
<p>Consider now a covariate with k = 3 categories for which we create two new
dummy variables, x1 and x2. The linear model is y = β0 + β1x1 + β2x2 + e.
</p>
<p>&bull; For x1 = 1, we obtain E(y) = β0 + β1 &middot; 1 + β2 &middot; 0 = β0 + β1 &equiv; E(y|x1 = 1,
x2 = 0);
</p>
<p>&bull; For x2 = 1, we obtain E(y) = β0 + β1 &middot; 0 + β2 &middot; 1 = β0 + β2 &equiv; E(y|x1 = 0,
x2 = 1); and
</p>
<p>&bull; For the reference category (x1 = x2 = 0), we obtain y = β0 + β1 &middot; 0 + β2 &middot; 0 =
β0 &equiv; E(y|x1 = x2 = 0).
</p>
<p>We can thus conclude that the intercept β0 = E(y|x1 = 0, x2 = 0) describes the
average y for the reference category, that β1 = E(y|x1 = 1, x2 = 0)&minus; E(y|x1 =
0, x2 = 0) describes the difference between the first and the reference category,
and that β2 = E(y|x1 = 0, x2 = 1)&minus; E(y|x1 = 0, x2 = 0) describes the difference
between the second and the reference category.
</p>
<p>Remark 11.6.1 There are other ways of recoding categorical variables, such as effect
</p>
<p>coding. However, we do not describe them in this book.
</p>
<p>11.6.3 Transformations
</p>
<p>As we have already outlined in Sect. 11.5, if x is transformed by a function T (x) =
(T (x1), T (x2), . . . , T (xn)) then
</p>
<p>y = f (x) = β0 + β1T (x)+ e (11.22)
is still a linear model because the model is linear in its parameters β. Popular trans-
</p>
<p>formations T (x) are log(x),
&radic;
</p>
<p>x, exp(x), xp, among others. The choice of such a
</p>
<p>function is typically motivated by the application and data at hand. Alternatively, a
</p>
<p>relationship between y and x can be modelled via a polynomial as follows:
</p>
<p>y = f (x) = β0 + β1x + β2x2 + &middot; &middot; &middot; + βpxp + e. (11.23)</p>
<p/>
</div>
<div class="page"><p/>
<p>268 11 Linear Regression
</p>
<p>Fig. 11.6 Scatter plot and
</p>
<p>regression lines for Example
</p>
<p>11.6.4
</p>
<p>20 30 40 50 60 70
</p>
<p>2
0
</p>
<p>4
0
</p>
<p>6
0
</p>
<p>8
0
</p>
<p>1
0
</p>
<p>0
</p>
<p>Exercise Time
</p>
<p>R
e
</p>
<p>c
o
v
e
</p>
<p>ry
 T
</p>
<p>im
e
</p>
<p>linear
</p>
<p>polynomial, quadratic
</p>
<p>polynomial, cubic
</p>
<p>Example 11.6.4 Consider again Examples 11.2.1, 11.3.2, 11.3.3, 11.4.1, and 11.5.1
</p>
<p>where we analysed the association of intensity of exercising and recovery time after
</p>
<p>knee surgery. The linear regression line was estimated as
</p>
<p>Recovery Time = 100.28 &minus; 1.22 Exercising Time.
One could question whether the association is indeed linear and fit the second- and
</p>
<p>third-order polynomials:
</p>
<p>Recovery Time = β0 &minus; β1Exercise + β2Exercise2,
Recovery Time = β0 &minus; β1Exercise + β2Exercise2 + β3Exercise3.
</p>
<p>To obtain the estimates we can use R:
</p>
<p>lm(Y&sim;X+I(X2))
lm(Y&sim;X+I(X2)+I(X3))
</p>
<p>The results are β0 = 121.8, β1 = &minus;2.4, β2 = 0.014 and β0 = 12.9, β1 = 6.90,
β2 = &minus;0.23, β3 = 0.002 for the two models respectively. While it is difficult to
interpret these coefficients directly, we can simply plot the regression lines on a
</p>
<p>scatter plot (see Fig. 11.6).
</p>
<p>We see that the regression based on the quadratic polynomial visually fits the
</p>
<p>data slightly better than the linear polynomial. It seems as if the relation between
</p>
<p>recovery time and exercise time is not exactly linear and the association is better
</p>
<p>modelled through a second-order polynomial. The regression line based on the cubic
</p>
<p>polynomial seems to be even closer to the measured points; however, the functional
</p>
<p>form of the association looks questionable. Driven by a single data point, we obtain a</p>
<p/>
</div>
<div class="page"><p/>
<p>11.6 Linear Regression with Multiple Covariates 269
</p>
<p>regression line which suggests a heavily increased recovery time for exercising times
</p>
<p>greater than 65 min. While it is possible that too much exercising causes damage to
</p>
<p>the knee and delays recovery, the data does not seem to be clear enough to support
</p>
<p>the shape suggested by the model. This example illustrates the trade-off between
</p>
<p>fit (i.e. how good the regression line fits the data) and parsimony (i.e. how well a
</p>
<p>model can be understood if it becomes more complex). Section 11.8 explores this
</p>
<p>non-trivial issue in more detail.
</p>
<p>Transformations of the Outcome Variable. It is also possible to apply transforma-
</p>
<p>tions to the outcome variable. While in many situations, this makes interpretations
</p>
<p>quite difficult, a log transformation is quite common and easy to interpret. Consider
</p>
<p>the log-linear model
</p>
<p>log y = β01 + β1x1 + &middot; &middot; &middot; + βpxp + e
where y is required to be greater than 0. Exponentiating on both sides leads to
</p>
<p>y = eβ01 &middot; eβ1x1 &middot; &middot; &middot; &middot; &middot; eβpxp &middot; ee.
It can be easily seen that a one unit increase in xj multiplies y by e
</p>
<p>β j . Therefore, if
</p>
<p>y is log-transformed, one simply interprets exp(β) instead of β. For example, if y
</p>
<p>is the yearly income, x denotes gender (1 = male, 0 = female), and β1 = 0.2 then
one can say that a man&rsquo;s income is exp(0.2) = 1.22 times higher (i.e. 22 %) than a
woman&rsquo;s.
</p>
<p>11.7 The Inductive View of Linear Regression
</p>
<p>So far we have introduced linear regression as a method which describes the rela-
</p>
<p>tionship between dependent and independent variables through the best fit to the
</p>
<p>data. However, as we have highlighted in earlier chapters, often we are interested
</p>
<p>not only in describing the data but also in drawing conclusions from a sample about
</p>
<p>the population of interest. For instance, in an earlier example, we have estimated the
</p>
<p>association of branch and delivery time for the pizza delivery data. The linear model
</p>
<p>was estimated as delivery time = 36.3 &minus; 5.2 East &minus; 1.1 West; this indicates that the
delivery time is on average 5.2 min shorter for the branch in the East of the town
</p>
<p>compared with the central branch and 1.1 min shorter for the branch in the West com-
</p>
<p>pared with the central branch. When considering all pizza deliveries (the population),
</p>
<p>not only those collected by us over the period of a month (the sample), we might ask
</p>
<p>ourselves whether 1.1 min is a real difference valid for the entire population or just
</p>
<p>caused by random error involved in the sample we chose. In particular, we would
</p>
<p>also like to know what the 95 % confidence interval for our parameter estimate is.
</p>
<p>Does the interval cover &ldquo;zero&rdquo;? If yes, we might conclude that we cannot be very
</p>
<p>sure that there is an association and do not reject the null hypothesis that βWest = 0.
In reference to Chaps. 9 and 10, we now apply the concepts of statistical inference
</p>
<p>and testing in the context of regression analysis.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>270 11 Linear Regression
</p>
<p>Point and interval estimation in the linear model. We now rewrite the model for
</p>
<p>the purpose of introducing statistical inference to linear regression as
</p>
<p>y = β01 + β1x1 + &middot; &middot; &middot; + βpxp + e
= Xβ + e with e &sim; N (0, σ 2I) . (11.24)
</p>
<p>where y is the n &times; 1 vector of outcomes and X is the n &times; (p + 1) design matrix
(including a column of 1&rsquo;s for the intercept). The identity matrix I consists of 1&rsquo;s on
</p>
<p>the diagonal and 0&rsquo;s elsewhere, and the parameter vector is β = (β0, β1, . . . , βp)&prime;.
We would like to estimate β to make conclusions about a relationship in the pop-
</p>
<p>ulation. Similarly, e reflects the random errors in the population. Most importantly,
</p>
<p>the linear model now contains assumptions about the errors. They are assumed to
</p>
<p>be normally distributed, N (0, σ 2 I ), which means that the expectation of the errors
</p>
<p>is 0,E(ei ) = 0, the variance is Var(ei ) = σ 2 (and therefore the same for all ei ), and
it follows from Var(e) = σ 2I that Cov(ei , ei &prime;) = 0 for all i 
= i &prime;. The assumption of a
normal distribution is required to construct confidence intervals and test of hypothe-
</p>
<p>ses statistics. More details about these assumptions and the procedures to test their
</p>
<p>validity on the basis of a given sample of data are explained in Sect. 11.9.
</p>
<p>The least squares estimate of β is obtained by
</p>
<p>β̂ = (X&prime;X)&minus;1X&prime;y. (11.25)
It can be shown that β̂ follow a normal distribution with mean E(β̂) = β and covari-
ance matrix Var(β̂) = σ 2I as
</p>
<p>β̂ &sim; N (β, σ 2(X&prime;X)&minus;1). (11.26)
Note that β̂ is unbiased (since E(β̂) = β); more details about (11.26) can be found
in Appendix C.6. An unbiased estimator of σ 2 is
</p>
<p>σ̂ 2 = (y &minus; Xβ̂)
&prime;(y &minus; Xβ̂)
</p>
<p>n &minus; (p + 1) =
ê&prime;ê
</p>
<p>n &minus; (p + 1) =
1
</p>
<p>n &minus; (p + 1)
</p>
<p>n&sum;
</p>
<p>i=1
ê2i . (11.27)
</p>
<p>The errors are estimated from the data as ê = y &minus; Xβ̂ and are called residuals.
Before giving a detailed data example, we would like to outline how to draw
</p>
<p>conclusions about the population of interest from the linear model. As we have seen,
</p>
<p>both β andσ 2 are unknown in the model and are estimated from the data using (11.25)
</p>
<p>and (11.27). These are our point estimates. We note that if β j = 0, then β j xj = 0,
and then, the model will not contain the term β j xj. This means that the covariate xj
does not contribute to explaining the variation in y. Testing the hypothesis β j = 0
is therefore equivalent to testing whether x j is associated with y or not in the sense
</p>
<p>that it helps to explain the variations in y or not. To test whether the point estimate is
</p>
<p>different from zero, or whether the deviations of estimates from zero can be explained
</p>
<p>by random variation, we have the following options:</p>
<p/>
</div>
<div class="page"><p/>
<p>11.7 The Inductive View of Linear Regression 271
</p>
<p>1. The 100(1 &minus; α)% confidence interval for each β̂ j is
β̂ j &plusmn; tn&minus;p&minus;1;1&minus;α/2 &middot; σ̂β̂ j (11.28)
</p>
<p>with σ̂
β̂
=
</p>
<p>&radic;
s j j σ̂ 2 where s j j is the j th diagonal element of the matrix (X
</p>
<p>&prime;X)&minus;1.
If the confidence interval does not overlap 0, then we can conclude that β is
</p>
<p>different from 0 and therefore xi is associated with y and it is a relevant variable. If
</p>
<p>the confidence interval includes 0, we cannot conclude that there is an association
</p>
<p>between xi and y.
</p>
<p>2. We can formulate a formal test which tests if β̂ j is different from 0. The hypothe-
</p>
<p>ses are:
</p>
<p>H0 : β j = 0 versus H1 : β j 
= 0.
The test statistic
</p>
<p>T = β̂ j&radic;
σ̂
β̂2j
</p>
<p>follows a tn&minus;p&minus;1 distribution under H0. If |T | &gt; tn&minus;p&minus;1;1&minus;α/2, we can reject the
null hypothesis (at α level of significance); otherwise, we accept it.
</p>
<p>3. The decisions we get from the confidence interval and the T -statistic from points
</p>
<p>1 and 2 are identical to those obtained by checking whether the p-value (see also
</p>
<p>Sect. 10.2.6) is smaller than α, in which case we also reject the null hypothesis.
</p>
<p>Example 11.7.1 Recall Examples 11.2.1, 11.3.2, 11.3.3, 11.4.1, 11.5.1, and 11.6.4
</p>
<p>where we analysed the association of exercising time and time of recovery from knee
</p>
<p>surgery. We can use R to obtain a full inductive summary of the linear model:
</p>
<p>summary(lm(Y&sim;X))
</p>
<p>Coefficients:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 100.1244 10.3571 9.667 2.17e-06 ***
</p>
<p>X -1.2153 0.2768 -4.391 0.00135 **
</p>
<p>---
</p>
<p>Signif. codes: 0 *** 0.001 ** 0.01 * 0.05 . 0.1 1
</p>
<p>Residual standard error: 11.58 on 10 degrees of freedom
</p>
<p>Now, we explain the meaning and interpretation of different terms involved in the
</p>
<p>output.
</p>
<p>&bull; Under &ldquo;Estimate&rdquo;, the parameter estimates are listed and we read that the linear
model is fitted as y (recovery time) = 100.1244 &minus; 1.2153 &middot; x (exercise time). The
subtle differences to Example 11.2.1 are due to rounding of numerical values.
</p>
<p>&bull; The variance is estimated as σ̂ 2 = 11.582 (&ldquo;Residual standard error&rdquo;). This is
easily calculated manually using the residual sum of squares:
</p>
<p>&sum;
ê2i /(n &minus; p &minus; 1) =
</p>
<p>1/10 &middot; {(90 &minus; 70.84)2 + &middot; &middot; &middot; + (45 &minus; 62.30)2} = 11.582.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>272 11 Linear Regression
</p>
<p>&bull; The standard errors σ̂
β̂
</p>
<p>are listed under &ldquo;Std. Error&rdquo;. Given that n &minus; p &minus; 1 =
12 &minus; 1 &minus; 1 = 10, and therefore t10;0.975 = 2.28, we can construct a confidence
interval for age:
</p>
<p>&minus;1.22 &plusmn; 2.28 &middot; 0.28 = [&minus;1.86;&minus;0.58]
The interval does not include 0, and we therefore conclude that there is an asso-
</p>
<p>ciation between exercising time and recovery time. The random error involved
</p>
<p>in the data is not sufficient to explain the deviation of β̂i = &minus;1.22 from 0 (given
α = 0.05).
</p>
<p>&bull; We therefore reject the null hypothesis that β j = 0. This can also be seen by com-
paring the test statistic (listed under &ldquo;t value&rdquo; and obtained by (β̂ j &minus; 0)/
</p>
<p>&radic;
σ̂ 2
β̂
=
</p>
<p>&minus;1.22/0.277) with t10,0.975, | &minus; 4.39| &gt; 2.28. Moreover, p = 0.001355 &lt; α =
0.05. We can say that there is a significant association between exercising and
</p>
<p>recovery time.
</p>
<p>Sometimes, one is interested in whether a regression model is useful in the sense
</p>
<p>that all βi &rsquo;s are different from zero, and we therefore can conclude that there is an
</p>
<p>association between any xi and y. The null hypothesis is
</p>
<p>H0 : β1 = β2 = &middot; &middot; &middot; = βp = 0
and can be tested by the overall F-test
</p>
<p>F = (ŷ &minus; ȳ)
&prime;(ŷ &minus; ȳ)/(p)
</p>
<p>(y &minus; ŷ)&prime;(y &minus; ŷ)/(n &minus; p &minus; 1) =
n &minus; p &minus; 1
</p>
<p>p
</p>
<p>&sum;
i (ŷi &minus; ȳ)2&sum;
</p>
<p>i e
2
i
</p>
<p>.
</p>
<p>The null hypothesis is rejected if F &gt; F1&minus;α;p,n&minus;p&minus;1. Note that the null hypothesis in
this case tests only the equality of slope parameters and does not include the intercept
</p>
<p>term.
</p>
<p>Example 11.7.2 In this chapter, we have already explored the associations between
</p>
<p>branch, operator, and bill with delivery time for the pizza data (Appendix A.4). If we
</p>
<p>fit a multiple linear model including all of the three variables, we obtain the following
</p>
<p>results:
</p>
<p>summary(lm(time&sim;branch+bill+operator))
</p>
<p>Coefficients:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 26.19138 0.78752 33.258 &lt; 2e-16 ***
</p>
<p>branchEast -3.03606 0.42330 -7.172 1.25e-12 ***
</p>
<p>branchWest -0.50339 0.38907 -1.294 0.196
</p>
<p>bill 0.21319 0.01535 13.885 &lt; 2e-16 ***
</p>
<p>operatorMelissa 0.15973 0.31784 0.503 0.615
</p>
<p>---
</p>
<p>Signif. codes: 0 *** 0.001 ** 0.01 * 0.05 . 0.1 1
</p>
<p>Residual standard error: 5.653 on 1261 degrees of freedom
</p>
<p>Multiple R-squared: 0.2369, Adjusted R-squared: 0.2345
</p>
<p>F-statistic: 97.87 on 4 and 1261 DF, p-value: &lt; 2.2e-16</p>
<p/>
</div>
<div class="page"><p/>
<p>11.7 The Inductive View of Linear Regression 273
</p>
<p>By looking at the p-values in the last column, one can easily see (without calculat-
</p>
<p>ing the confidence intervals or evaluating the t-statistic) that there is a significant asso-
</p>
<p>ciation between the bill and delivery time; also, it is evident that the average delivery
</p>
<p>time in the branch in the East is significantly different (&asymp; 3 min less) from the central
branch (which is the reference category here). However, the estimated difference in
</p>
<p>delivery times for both the branches in the West and the operator was not found to be
</p>
<p>significantly different from zero. We conclude that some variables in the model are
</p>
<p>associated with delivery time, while for others, we could not show the existence of
</p>
<p>such an association. The last line of the output confirms this: the overall F-test has a
</p>
<p>test statistic of 97.87 which is larger than F1&minus;α;p,n&minus;p&minus;1 = F0.95;4,1261 = 2.37; there-
fore, the p-value is smaller 0.05 (2.2 &times; 10&minus;16) and the null hypothesis is rejected. The
test suggests that there is at least one variable which is associated with delivery time.
</p>
<p>11.7.1 Properties of Least Squares and Maximum Likelihood
Estimators
</p>
<p>The least squares estimator of β has several properties:
</p>
<p>1. The least squares estimator of β is unbiased, E(β̂) = β (see Appendix C.6 for
the proof).
</p>
<p>2. The estimator σ̂ 2 as introduced in equation (11.27) is also unbiased, i.e. E(σ̂ 2) =
σ 2.
</p>
<p>3. The least squares estimator of β is consistent, i.e. β̂ converges to β as n approaches
</p>
<p>infinity.
</p>
<p>4. The least squares estimator of β is asymptotically normally distributed.
</p>
<p>5. The least squares estimator of β has the smallest variance among all linear and
</p>
<p>unbiased estimators (best linear unbiased estimator) of β.
</p>
<p>We do not discuss the technical details of these properties in detail. It is more
</p>
<p>important to know that the least squares estimator has good features and that is
</p>
<p>why we choose it for fitting the model. Since we use a &ldquo;good&rdquo; estimator, we expect
</p>
<p>that the model will also be &ldquo;good&rdquo;. One may ask whether it is possible to use a
</p>
<p>different estimator. We have already made distributional assumptions in the model:
</p>
<p>we require the errors to be normally distributed, given that it is indeed possible to
</p>
<p>apply the maximum likelihood principle to obtain estimates for β and σ 2 in our
</p>
<p>set-up.
</p>
<p>Theorem 11.7.1 For the linear model (11.24), the least squares estimator and the
</p>
<p>maximum likelihood estimator for β are identical. However, the maximum likelihood
</p>
<p>estimator of σ 2 is σ̂ 2ML = 1/n(ê&prime;ê) of σ 2 which is a biased estimator of σ 2, but it is
asymptotically unbiased.
</p>
<p>How to obtain the maximum likelihood estimator for the linear model is presented in
</p>
<p>Appendix C.6. The important message of Theorem 11.7.1 is that no matter whether
</p>
<p>we apply the least squares principle or the maximum likelihood principle, we always</p>
<p/>
</div>
<div class="page"><p/>
<p>274 11 Linear Regression
</p>
<p>obtain β̂ = (X&prime;X)&minus;1X&prime;y; this does not apply when estimating the variance, but it is
an obvious choice to go for the unbiased estimator (11.27) in any given analysis.
</p>
<p>11.7.2 The ANOVA Table
</p>
<p>A table that is frequently shown by software packages when performing regression
</p>
<p>analysis is the analysis of variance (ANOVA) table. This table can have several mean-
</p>
<p>ings and interpretations and may look slightly different depending on the context in
</p>
<p>which it is used. We focus here on its interpretation i) as a way to summarize the
</p>
<p>effect of categorical variables and ii) as a hypothesis test to compare k means. This
</p>
<p>is illustrated in the following example.
</p>
<p>Example 11.7.3 Recall Example 11.6.3 where we established the relationship
</p>
<p>between branch and delivery time as
</p>
<p>Delivery Time = 36.3 &minus; 5.2East &minus; 1.1West.
The R output for the respective linear model is as follows:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 36.3127 0.2957 122.819 &lt; 2e-16 ***
</p>
<p>branchEast -5.2461 0.4209 -12.463 &lt; 2e-16 ***
</p>
<p>branchWest -1.1182 0.4148 -2.696 0.00711 **
</p>
<p>We see that the average delivery time of the branches in the East and the Centre
</p>
<p>(reference category) is different and that the average delivery time of the branches in
</p>
<p>the West and the Centre is different (because p &lt; 0.05). This is useful information,
</p>
<p>but it does not answer the question if branch as a whole influences the delivery time.
</p>
<p>It seems that this is the case, but the hypothesis we may have in mind may be
</p>
<p>H0 : μEast = μWest = μCentre
which corresponds to
</p>
<p>H0 : βEast = βWest = βCentre
in the context of the regression model. These are two identical hypotheses because
</p>
<p>in the regression set-up, we are essentially comparing three conditional means
</p>
<p>E(Y |X = x1) = E(Y |X = x2) = E(Y |X = x3). The ANOVA table summarizes the
corresponding F-Test which tests this hypothesis:
</p>
<p>m1 &lt;- lm(time&sim;branch)
anova(m1)
</p>
<p>Response: time
</p>
<p>Df Sum Sq Mean Sq F value Pr(&gt;F)
</p>
<p>branch 2 6334 3166.8 86.05 &lt; 2.2e-16 ***
</p>
<p>Residuals 1263 46481 36.8</p>
<p/>
</div>
<div class="page"><p/>
<p>11.7 The Inductive View of Linear Regression 275
</p>
<p>We see that the null hypothesis of 3 equal means is rejected because p is close to
</p>
<p>zero.
</p>
<p>What does this table mean more generally? If we deal with linear regression with
</p>
<p>one (possibly categorical) covariate, the table will be as follows:
</p>
<p>df Sum of squares Mean squares F-statistic
</p>
<p>Var p SQReg. MSR=SQReg./p MSR/MSE
</p>
<p>Res n &minus; p &minus; 1 SQError MSE= SQError/(n &minus; p &minus; 1)
</p>
<p>The table summarizes the sum of squares regression and residuals (see Sect. 11.3 for
</p>
<p>the definition), standardizes them by using the appropriate degrees of freedom (df),
</p>
<p>and uses the corresponding ratio as the F-statistic. Note that in the above example,
</p>
<p>this corresponds to the overall F-test introduced earlier. The overall F-test tests the
</p>
<p>hypothesis that any β j is different from zero which is identical to the hypothesis
</p>
<p>above. Thus, if we fit a linear regression model with one variable, the ANOVA table
</p>
<p>will yield the same conclusions as the overall F-test which we obtain through the
</p>
<p>main summary. However, if we consider a multiple linear regression model, the
</p>
<p>ANOVA table may give us more information.
</p>
<p>Example 11.7.4 Suppose we are not only interested in the branch, but also in how
</p>
<p>the pizza delivery times are affected by operator and driver. We may for example
</p>
<p>hypothesize that the delivery time is identical for all drivers given they deliver for
</p>
<p>the same branch and speak to the same operator. In a standard regression output, we
</p>
<p>would get 4 coefficients for 5 drivers which would help us to compare the average
</p>
<p>delivery time of each driver to the reference driver; it would however not tell us if
</p>
<p>on an average, they all have the same delivery time. The overall F-test would not
</p>
<p>help us either because it would test if any β j is different from zero which includes
</p>
<p>coefficients from branch and operator, not only driver. Using the anova command
</p>
<p>yields the results of the F-test of interest:
</p>
<p>m2 &lt;- lm(time&sim;branch+operator+driver)
anova(m2)
</p>
<p>Response: time
</p>
<p>Df Sum Sq Mean Sq F value Pr(&gt;F)
</p>
<p>branch 2 6334 3166.8 88.6374 &lt; 2.2e-16 ***
</p>
<p>operator 1 16 16.3 0.4566 0.4994
</p>
<p>driver 4 1519 379.7 10.6282 1.798e-08 ***
</p>
<p>Residuals 1258 44946 35.7
</p>
<p>We see that the null hypothesis of equal delivery times of the drivers is rejected.
</p>
<p>We can also test other hypotheses with this output: for instance, the null hypothesis
</p>
<p>of equal delivery times for each operator is not rejected because p &asymp; 0.5.</p>
<p/>
</div>
<div class="page"><p/>
<p>276 11 Linear Regression
</p>
<p>11.7.3 Interactions
</p>
<p>It may be possible that the joint effect of some covariates affects the response.
</p>
<p>For example, drug concentrations may have a different effect on men, woman, and
</p>
<p>children; a fertilizer could work differently in different geographical areas; or a new
</p>
<p>education programme may show benefit only with certain teachers. It is fairly simple
</p>
<p>to target such questions in linear regression analysis by using interactions. Interac-
</p>
<p>tions are measured as the product of two (or more) variables. If either one or both
</p>
<p>variables are categorical, then one simply builds products for each dummy variable,
</p>
<p>thus creating (k &minus; 1)&times; (l &minus; 1) new variables when dealing with two categorical
variables (with k and l categories respectively). These product terms are called inter-
</p>
<p>actions and estimate how an association of one variable differs with respect to the
</p>
<p>values of the other variable. Now, we give examples for continuous&ndash;categorical,
</p>
<p>categorical&ndash;categorical, and continuous&ndash;continuous interactions for two variables
</p>
<p>x1 and x2.
</p>
<p>Categorical&ndash;Continuous Interaction. Suppose one variable x1 is categorical with
</p>
<p>k categories, and the other variable x2 is continuous. Then, k &minus; 1 new variables
have to be created, each consisting of the product of the continuous variable and a
</p>
<p>dummy variable, x2 &times; x1i , i &isin; 1, . . . , k &minus; 1. These variables are added to the regres-
sion model in addition to the main effects relating to x1 and x2 as follows:
</p>
<p>y = β0 + β1x11 + &middot; &middot; &middot; + βk&minus;1x1k&minus;1 + βkx2
+βk+1x11x2 + &middot; &middot; &middot; + βpx1k&minus;1x2 + e.
</p>
<p>It follows that for the reference category of x1, the effect of x2 is just βk (because
</p>
<p>each x2x1i is zero since each x1 j is zero). However, the effect for all other categories
</p>
<p>is β2 + β j where β j refers to x1jx2. Therefore, the association between x2 and the
outcome y differs by β j between category j and the reference category. Testing
</p>
<p>H0 : β j = 0 thus helps to identify whether there is an interaction effect with respect
to category j or not.
</p>
<p>Example 11.7.5 Consider again the pizza data described in Appendix A.4. We may
</p>
<p>be interested in whether the association of delivery time and temperature varies
</p>
<p>with respect to branch. In addition to time and branch, we therefore need additional
</p>
<p>interaction variables. Since there are 3 branches, we need 3 &minus; 1 = 2 interaction
variables which are essentially the product of (i) time and branch &ldquo;East&rdquo; and (ii)
</p>
<p>time and branch &ldquo;West&rdquo;. This can be achieved in R by using either the &ldquo;⋆&rdquo; operator
</p>
<p>(which will create both the main and interaction effects) or the &ldquo;:&rdquo; operator (which
only creates the interaction term).
</p>
<p>int.model.1 &lt;- lm(temperature&sim;time&lowast;branch)
int.model.2 &lt;- lm(temperature&sim;time+branch+time:branch)
summary(int.model.1)
</p>
<p>summary(int.model.2)</p>
<p/>
</div>
<div class="page"><p/>
<p>11.7 The Inductive View of Linear Regression 277
</p>
<p>Coefficients:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 70.718327 1.850918 38.207 &lt; 2e-16 ***
</p>
<p>time -0.288011 0.050342 -5.721 1.32e-08 ***
</p>
<p>branchEast 10.941411 2.320682 4.715 2.69e-06 ***
</p>
<p>branchWest 1.102597 2.566087 0.430 0.66750
</p>
<p>time:branchEast -0.195885 0.066897 -2.928 0.00347 **
</p>
<p>time:branchWest 0.004352 0.070844 0.061 0.95103
</p>
<p>The main effects of the model tell us that the temperature is almost 11 degrees
</p>
<p>higher for the eastern branch compared to the central branch (reference) and about
</p>
<p>1 degree higher for the western branch. However, only the former difference is
</p>
<p>significantly different from 0 (since the p-value is smaller than α = 0.05). Moreover,
the longer the delivery time, the lower the temperature (0.29 degrees for each minute).
</p>
<p>The parameter estimates related to the interaction imply that this association differs
</p>
<p>by branch: the estimate is indeed βtime = &minus;0.29 for the reference branch in the
Centre, but the estimate for the branch in the East is&minus;0.29 &minus; 0.196 = &minus;0.486 and the
estimate for the branch in the West is &minus;0.29 + 0.004 = &minus;0.294. However, the latter
difference in the association of time and temperature is not significantly different
</p>
<p>from zero. We therefore conclude that the delivery time and pizza temperature are
</p>
<p>negatively associated and this is more strongly pronounced in the eastern branch
</p>
<p>compared to the other two branches. It is also possible to visualize this by means of
</p>
<p>a separate regression line for each branch, see Fig. 11.7.
</p>
<p>Fig. 11.7 Interaction of
</p>
<p>delivery time and branch in
</p>
<p>Example 11.7.5
</p>
<p>0 10 20 30 40 50 60
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>7
0
</p>
<p>8
0
</p>
<p>9
0
</p>
<p>Delivery Time (in Minutes)
</p>
<p>T
e
</p>
<p>m
p
</p>
<p>e
ra
</p>
<p>tu
re
</p>
<p> (
in
</p>
<p> D
e
</p>
<p>g
re
</p>
<p>e
s
 C
</p>
<p>e
ls
</p>
<p>iu
s
)
</p>
<p>Centre
</p>
<p>East
</p>
<p>West</p>
<p/>
</div>
<div class="page"><p/>
<p>278 11 Linear Regression
</p>
<p>&bull; Centre: Temperature = 70.7 &minus; 0.29 &times; time,
&bull; East: Temperature = 70.7 + 10.9 &minus; (0.29 + 0.195)&times; time,
&bull; West: Temperature = 70.7 + 1.1 &minus; (0.29 &minus; 0.004)&times; time.
</p>
<p>One can see that the pizzas delivered by the branch in the East are overall hotter
</p>
<p>but longer delivery times level that benefit off. One might speculate that the delivery
</p>
<p>boxes from the eastern branch are not properly closed and therefore&mdash;despite the
</p>
<p>overall good performance&mdash;the temperature falls more rapidly over time for this
</p>
<p>branch.
</p>
<p>Categorical&ndash;Categorical Interaction. For two categorical variables x1 and x2, with
</p>
<p>k and l categories, respectively, (k &minus; 1)&times; (l &minus; 1) new dummy variables x1i &times; x2 j
need to be created as follows:
</p>
<p>y = β0 + β1x11 + &middot; &middot; &middot; + βk&minus;1x1k&minus;1 + βkx21 + &middot; &middot; &middot; + βk+l&minus;2x2l&minus;1
+βk+l&minus;1x11x21 + &middot; &middot; &middot; + βpx1k&minus;1x2l&minus;1 + e.
</p>
<p>The interpretation of the regression parameters of interest is less complicated than
</p>
<p>it looks at first. If the interest is in x1, then the estimate referring to the category of
</p>
<p>interest (i.e. x1i ) is interpreted as usual&mdash;with the difference that it relates only to
</p>
<p>the reference category of x2. The effect of x1i may vary with respect to x2, and the
</p>
<p>sum of the respective main and interaction effects for each category of x2 yields
</p>
<p>the respective estimates. These considerations are explained in more detail in the
</p>
<p>following example.
</p>
<p>Example 11.7.6 Consider again the pizza data. If we have the hypothesis that the
</p>
<p>delivery time depends on the operator (who receives the phone calls), but the effect is
</p>
<p>different for different branches, then a regression model with branch (3 categories, 2
</p>
<p>dummy variables), operator (2 categories, one dummy variable), and their interaction
</p>
<p>(2 new variables) can be used.
</p>
<p>lm(time&sim;operator*branch)
</p>
<p>Coefficients:
Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 36.4203 0.4159 87.567 &lt;2e-16 ***
operatorMelissa -0.2178 0.5917 -0.368 0.7129
branchEast -5.6685 0.5910 -9.591 &lt;2e-16 ***
branchWest -1.3599 0.5861 -2.320 0.0205 *
operatorMelissa:branchEast 0.8599 0.8425 1.021 0.3076
operatorMelissa:branchWest 0.4842 0.8300 0.583 0.5598</p>
<p/>
</div>
<div class="page"><p/>
<p>11.7 The Inductive View of Linear Regression 279
</p>
<p>The interaction terms can be interpreted as follows:
</p>
<p>&bull; If we are interested in the operator, we see that the delivery time is on aver-
age 0.21 min shorter for operator &ldquo;Melissa&rdquo;. When this operator deals with a
</p>
<p>branch other than the reference (Centre), the estimate changes to &minus;0.21 + 0.86 =
0.64 min longer delivery in the case of branch &ldquo;East&rdquo; and &minus;0.21 + 0.48 =
0.26 min for branch &ldquo;West&rdquo;.
</p>
<p>&bull; If we are interested in the branches, we observe that the delivery time is shortest
for the eastern branch which has on average a 5.66 min shorter delivery time
</p>
<p>than the central branch. However, this is the estimate for the reference operator
</p>
<p>only; if operator &ldquo;Melissa&rdquo; is in charge, then the difference in delivery times
</p>
<p>for the two branches is only &minus;5.66 + 0.86 = &minus;4.8 min. The same applies when
comparing the western branch with the central branch: depending on the operator,
</p>
<p>the difference between these two branches is estimated as either&minus;1.36 or&minus;1.36 +
0.48 = 0.88 min, respectively.
</p>
<p>&bull; The interaction terms are not significantly different from zero. We therefore con-
clude that the hypothesis of different delivery times for the two operators, possibly
</p>
<p>varying by branch, could not be confirmed.
</p>
<p>Continuous&ndash;Continuous Interaction. It is also possible to add an interaction of
</p>
<p>two continuous variables. This is done by adding the product of these two variables
</p>
<p>to the model. If x1 and x2 are two continuous variables, then x1x2 is the new variable
</p>
<p>added in the model as an interaction effect as
</p>
<p>y = β1x1 + β2x2 + β3x1x2 + e.
</p>
<p>Example 11.7.7 If we again consider the pizza data, with pizza temperature as an
</p>
<p>outcome, we may wish to test for an interaction of bill and time.
</p>
<p>Coefficients:
Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 92.555943 2.747414 33.688 &lt; 2e-16 ***
bill -0.454381 0.068322 -6.651 4.34e-11 ***
time -0.679537 0.086081 -7.894 6.31e-15 ***
bill:time 0.008687 0.002023 4.294 1.89e-05 ***
</p>
<p>The R output above reveals that there is a significant interaction effect. The inter-
</p>
<p>pretation is more difficult here. It is clear that a longer delivery time and a larger bill
</p>
<p>decrease the pizza&rsquo;s temperature. However, for a large product of bill and time (i.e.,
</p>
<p>when both are large), these associations are less pronounced because the negative
</p>
<p>coefficients become more and more outweighed by the positive interaction term. On
</p>
<p>the contrary, for a small bill and short delivery time, the temperature can be expected
</p>
<p>to be quite high.
</p>
<p>Combining Estimates. As we have seen in the examples in this section, it can
</p>
<p>make sense to combine regression estimates when interpreting interaction effects.
</p>
<p>While it is simple to obtain the point estimates, it is certainly also important to report</p>
<p/>
</div>
<div class="page"><p/>
<p>280 11 Linear Regression
</p>
<p>their 95 % confidence intervals. As we know from Theorem 7.7.1, the variance of
</p>
<p>the combination of two random variables can be obtained by Var(X &plusmn; Y ) = σ 2XY =
Var(X)+ Var(Y )&plusmn; 2 Cov(X, Y ). We can therefore estimate a confidence interval
for the combined estimate β̂i + β̂ j as
</p>
<p>(β̂i + β̂ j )&plusmn; tn&minus;p&minus;1;1&minus;α/2 &middot; σ̂(β̂i+β̂ j ) (11.29)
</p>
<p>where σ̂
(β̂i+β̂ j ) is obtained from the estimated covariance matrix Ĉov(β̂) via
</p>
<p>σ̂
(β̂i+β̂ j ) =
</p>
<p>&radic;
V̂ar(βi )+ V̂ar(β j )+ 2̂Cov(βi , β j ).
</p>
<p>Example 11.7.8 Recall Example 11.7.5 where we estimated the association between
</p>
<p>pizza temperature, delivery time, and branch. There was a significant interaction
</p>
<p>effect for time and branch. Using R, we obtain the covariance matrix as follows:
</p>
<p>mymodel &lt;- lm(temperature&sim;time*branch)
vcov(mymodel)
</p>
<p>(Int.) time East West time:East time:West
(Int.) 3.4258 -0.09202 -3.4258 -3.4258 0.09202 0.09202
time -0.0920 0.00253 0.0920 0.0920 -0.00253 -0.00253
branchEast -3.4258 0.09202 5.3855 3.4258 -0.15232 -0.09202
branchWest -3.4258 0.09202 3.4258 6.5848 -0.09202 -0.17946
time:East 0.0920 -0.00253 -0.1523 -0.0920 0.00447 0.00253
time:West 0.0920 -0.00253 -0.0920 -0.1794 0.00253 0.00501
</p>
<p>The point estimate for the association between time and temperature in the eastern
</p>
<p>branch is &minus;0.29 &minus; 0.19 (see Example 11.7.5). The standard error is calculated as&radic;
0.00253 + 0.00447 &minus; 2 &middot; 0.00253 = 0.044. The confidence interval is therefore
</p>
<p>&minus;0.48 &plusmn; 1.96 &middot; 0.044 = [&minus;0.56;&minus;0.39].
</p>
<p>Remark 11.7.1 If there is more than one interaction term, then it is generally possible
</p>
<p>to test whether there is an overall interaction effect, such as β1 = β2 = β3 = β4 = 0
in the case of four interaction variables. These tests belong to the general class of
</p>
<p>&ldquo;linear hypotheses&rdquo;, and they are not explained in this book. It is also possible to
</p>
<p>create interactions between more than two variables. However, the interpretation
</p>
<p>then becomes difficult.
</p>
<p>11.8 Comparing Different Models
</p>
<p>There are many situations where different multiple linear models can be fitted to a
</p>
<p>given data set, but it is unclear which is the best one. This relates to the question of
</p>
<p>which variables should be included in a model and which ones can be removed.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>11.8 Comparing Different Models 281
</p>
<p>For example, when we modelled the association of recovery time and exercising
</p>
<p>time by using different transformations, it remained unclear which of the proposed
</p>
<p>transformations was the best. In the pizza delivery example, we have about ten
</p>
<p>covariates: Does it make sense to include all of them in the model or do we understand
</p>
<p>the associations in the data better by restricting ourselves to the few most important
</p>
<p>variables? Is it necessary to include interactions or not?
</p>
<p>There are various model selection criteria to compare the quality of different
</p>
<p>fitted models. They can be useful in many situations, but there are also a couple of
</p>
<p>limitations which make model selection a difficult and challenging task.
</p>
<p>Coefficient of Determination (R2). A possible criterion to check the goodness of
</p>
<p>fit of a model is the coefficient of determination (R2). We discussed its development,
</p>
<p>interpretation, and philosophy in Sect. 11.3 (see p. 256 for more details).
</p>
<p>Adjusted R2. Although R2 is a reasonable measure for the goodness of fit of a
</p>
<p>model, it also has some limitations. One limitation is that if the number of covariates
</p>
<p>increases, R2 increases too (we omit the theorem and the proof for this statement).
</p>
<p>The added variables may not be relevant, but R2 will still increase, wrongly indicating
</p>
<p>an improvement in the fitted model. This criterion is therefore not a good measure
</p>
<p>for model selection. An adjusted version of R2 is defined as
</p>
<p>R2ad j = 1 &minus;
SQError/(n &minus; p &minus; 1)
</p>
<p>SQTotal/(n &minus; 1)
. (11.30)
</p>
<p>It can be used to compare the goodness of fit of models with a different number
</p>
<p>of covariates. Please note that both R2 and R2ad j are only defined when there is an
</p>
<p>intercept term in the model (which we assume throughout the chapter).
</p>
<p>Example 11.8.1 In Fig. 11.6, the association of exercising time and recovery time
</p>
<p>after knee surgery is modelled linearly, quadratically, and cubically; in Fig. 11.5,
</p>
<p>this association is modelled by means of a square-root transformation. The model
</p>
<p>summary in R returns both R2 (under &ldquo;Multiple R-squared&rdquo;) and the adjusted R2
</p>
<p>(under &ldquo;adjusted R-squared&rdquo;). The results are as follows:
</p>
<p>R2 R2ad j
</p>
<p>Linear 0.6584 0.6243
</p>
<p>Quadratic 0.6787 0.6074
</p>
<p>Cubic 0.7151 0.6083
</p>
<p>Square root 0.6694 0.6363
</p>
<p>It can be seen that R2 is larger for the models with more variables; i.e. the cubic
</p>
<p>model (which includes three variables) has the largest R2. The adjusted R2, which
</p>
<p>takes the different model sizes into account, favours the model with the square-root
</p>
<p>transformation. This model provides therefore the best fit to the data among the four
</p>
<p>models considered using R2.</p>
<p/>
</div>
<div class="page"><p/>
<p>282 11 Linear Regression
</p>
<p>Akaike&rsquo;s Information Criterion (AIC) is another criterion for model selection. The
</p>
<p>AIC is based on likelihood methodology and has its origins in information theory.
</p>
<p>We do not give a detailed motivation of this criterion here. It can be written for the
</p>
<p>linear model as
</p>
<p>AIC = n log
(
</p>
<p>SQError
</p>
<p>n
</p>
<p>)
+ 2(p + 1). (11.31)
</p>
<p>The smaller the AIC, the better the model. The AIC takes not only the fit to the data
</p>
<p>via SQError into account but also the parsimony of the model via the term 2(p + 1).
It is in this sense a more mature criterion than R2ad j which considers only the fit
</p>
<p>to the data via SQError. Akaike&rsquo;s Information Criterion can be calculated in R via
</p>
<p>the extractAIC() command. There are also other commands, but the results differ
</p>
<p>slightly because the different formulae use different constant terms. However, no
</p>
<p>matter what formula is used, the results regarding the model choice are always the
</p>
<p>same.
</p>
<p>Example 11.8.2 Consider again Example 11.8.1. R2ad j preferred the model which
</p>
<p>includes exercising time via a square-root transformation over the other options. The
</p>
<p>AIC value for the model where exercise time is modelled linearly is 60.59, when
</p>
<p>modelled quadratically 61.84, when modelled cubically 62.4, and 60.19 for a square-
</p>
<p>root transformation. Thus, in line with R2ad j , the AIC also prefers the square-root
</p>
<p>transformation.
</p>
<p>Backward selection. Two models, which differ only by one variable x j , can be
</p>
<p>compared by simply looking at the test result for β j = 0: if the null hypothesis is
rejected, the variable is kept in the model; otherwise, the other model is chosen. If
</p>
<p>there are more than two models, then it is better to consider a systematic approach to
</p>
<p>comparing them. For example, suppose we have 10 potentially relevant variables and
</p>
<p>we are not sure which of them to include in the final model. There are 210 = 1024
possible different combinations of variables and in turn so many choices of models!
</p>
<p>The inclusion or deletion of variables can be done systematically with various proce-
</p>
<p>dures, for example with backward selection (also known as backward elimination)
</p>
<p>as follows:
</p>
<p>1. Start with the full model which contains all variables of interest, Υ = {x1, x2,
. . . , xp}.
</p>
<p>2. Remove the variable xi &isin; Υ which optimizes a criterion, i.e. leads to the smallest
AIC (the highest R2ad j , the highest test statistic, or the smallest significance)
</p>
<p>among all possible choices.
</p>
<p>3. Repeat step 2. until a stop criterion is fulfilled, i.e. until no improvement regarding
</p>
<p>AIC, R2, or the p-value can be achieved.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.8 Comparing Different Models 283
</p>
<p>There are several other approaches. Instead of moving in the backward direction,
</p>
<p>we can also move in the forward direction. Forward selection starts with a model
</p>
<p>with no covariates and adds variables as long as the model continues to improve with
</p>
<p>respect to a particular criterion. The stepwise selection approach combines forward
</p>
<p>selection and backward selection: either one does backward selection and checks in
</p>
<p>between whether adding variables yields improvement, or one does forward selection
</p>
<p>and continuously checks whether removing the already added variables improves the
</p>
<p>model.
</p>
<p>Example 11.8.3 Consider the pizza data: if delivery time is the outcome, and branch,
</p>
<p>bill, operator, driver, temperature, and number of ordered pizzas are potential covari-
</p>
<p>ates, we may decide to include only the relevant variables in a final model. Using
</p>
<p>the stepAIC function of the library(MASS) allows us implementing backward
</p>
<p>selection with R.
</p>
<p>library(MASS)
</p>
<p>ms &lt;- lm(time&sim;branch+bill+operator+driver
+temperature+pizzas)
</p>
<p>stepAIC(ms, direction='back')
</p>
<p>At the first step, the R output states that the AIC of the full model is 4277.56.
</p>
<p>Then, the AIC values are displayed when variables are removed: 4275.9 if operator
</p>
<p>is removed, 4279.2 if driver is removed, and so on. One can see that the AIC is
</p>
<p>minimized if operator is excluded.
</p>
<p>Start: AIC=4277.56
</p>
<p>time ~ branch+bill+operator+driver+temperature+pizzas
</p>
<p>Df Sum of Sq RSS AIC
</p>
<p>- operator 1 9.16 36508 4275.9
</p>
<p>&lt;none&gt; 36499 4277.6
</p>
<p>- driver 4 279.71 36779 4279.2
</p>
<p>- branch 2 532.42 37032 4291.9
</p>
<p>- pizzas 1 701.57 37201 4299.7
</p>
<p>- temperature 1 1931.50 38431 4340.8
</p>
<p>- bill 1 2244.28 38743 4351.1
</p>
<p>Now R fits the model without operator. The AIC is 4275.88. Excluding further
</p>
<p>variables does not improve the model with respect to the AIC.</p>
<p/>
</div>
<div class="page"><p/>
<p>284 11 Linear Regression
</p>
<p>Step: AIC=4275.88
</p>
<p>time ~ branch + bill + driver + temperature + pizzas
</p>
<p>Df Sum of Sq RSS AIC
</p>
<p>9.572480563&gt;enon&lt;
</p>
<p>- driver 4 288.45 36797 4277.8
</p>
<p>- branch 2 534.67 37043 4290.3
</p>
<p>- pizzas 1 705.53 37214 4298.1
</p>
<p>- temperature 1 1923.92 38432 4338.9
</p>
<p>- bill 1 2249.60 38758 4349.6
</p>
<p>We therefore conclude that the final &ldquo;best&rdquo; model includes all variables considered,
</p>
<p>except operator. Using stepwise selection (with option both instead of back) yields
</p>
<p>the same results. We could now interpret the summary of the chosen model.
</p>
<p>Limitations and further practical considerations. The above discussions of vari-
</p>
<p>able selection approaches makes it clear that there are a variety of options to compare
</p>
<p>fitted models, but there is no unique best way to do so. Different criteria are based
</p>
<p>on different philosophies and may lead to different outcomes. There are a few con-
</p>
<p>siderations that should however always be taken into account:
</p>
<p>&bull; If categorical variables are included in the model, then all respective dummy vari-
ables need to be considered as a whole: all dummy variables of this variable should
</p>
<p>either be removed or kept in the model. For example, a variable with 3 categories
</p>
<p>is represented by two dummy variables in a regression model. In the process of
</p>
<p>model selection, both of these variables should either be kept in the model or
</p>
<p>removed, but not just one of them.
</p>
<p>&bull; A similar consideration refers to interactions. If an interaction is added to the
model, then the main effects should be kept in the model as well. This enables
</p>
<p>straightforward interpretations as outlined in Sect. 11.7.3.
</p>
<p>&bull; The same applies to polynomials. If adding a cubic transformation of xi, the squared
transformation as well as the linear effect should be kept in the model.
</p>
<p>&bull; When applying backward, forward, or stepwise regression techniques, the results
may vary considerably depending on the method chosen! This may give different
</p>
<p>models for the same data set. Depending on the strategy used to add and remove
</p>
<p>variables, the choice of the criterion (e.g. AIC versus p-values), and the detailed
</p>
<p>set-up (e.g. if the strategy is to add/remove a variable if the p-value is smaller than
</p>
<p>α, then the choice of α is important), one may obtain different results.
</p>
<p>&bull; All the above considerations show that model selection is a non-trivial task which
should always be complemented by substantial knowledge of the subject matter.
</p>
<p>If there are not too many variables to choose from, simply reporting the full model
</p>
<p>can be meaningful too.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.9 Checking Model Assumptions 285
</p>
<p>11.9 Checking Model Assumptions
</p>
<p>The assumptions made for the linear model mostly relate to the error terms: e &sim;
N (0, σ 2I). This implies a couple of things: i) the difference between y and Xβ
</p>
<p>(which is e) needs to follow a normal distribution, ii) the variance for each error ei
is constant as σ 2 and therefore does not depend on i , and iii) there is no correlation
</p>
<p>between the error terms, Cov(ei , ei &prime;) = 0 for all i, i &prime;. We also assume that Xβ is
adequate in the sense that we included all relevant variables and interactions in the
</p>
<p>model and that the estimator β̂ is stable and adequate due to influential observations
</p>
<p>or highly correlated variables. Now, we demonstrate how to check assumptions i)
</p>
<p>and ii).
</p>
<p>Normality assumption. The errors e are assumed to follow a normal distribution.
</p>
<p>We never know the errors themselves. The only possibility is to estimate the errors
</p>
<p>by means of the residuals ê = y &minus; Xβ̂. To ensure that the estimated residuals are
comparable to the scale of a standard normal distribution, they can be standardized
</p>
<p>via
</p>
<p>ê&lowast;i =
êi
</p>
<p>σ̂ 2
&radic;
</p>
<p>1 &minus; Pi i
where Pi i is the i th diagonal element of the hat matrix P = X(X&prime;X)&minus;1X&prime;. Generally,
the estimated standardized residuals are used to check the normality assumption. To
</p>
<p>obtain a first impression about the error distribution, one can simply plot a histogram
</p>
<p>of the standardized residuals. The normality assumption is checked with a QQ-plot
</p>
<p>where the theoretical quantiles of a standard normal distribution are plotted against
</p>
<p>the quantiles from the standardized residuals. If the data approximately matches the
</p>
<p>bisecting line, then we have evidence for fulfilment of the normality assumption
</p>
<p>(Fig. 11.8a), otherwise we do not (Fig. 11.8b).
</p>
<p>&minus;3 &minus;2 &minus;1 0 1 2 3
</p>
<p>&minus;
3
</p>
<p>&minus;
2
</p>
<p>&minus;
1
</p>
<p>0
1
</p>
<p>2
3
</p>
<p>Theoretical Quantiles
</p>
<p>S
ta
</p>
<p>n
d
a
rd
</p>
<p>iz
e
d
 r
</p>
<p>e
s
id
</p>
<p>u
a
ls
</p>
<p>Theoretical Quantiles
</p>
<p>(a) Normality without problems
</p>
<p>&minus;3 &minus;2 &minus;1 0 1 2 3
</p>
<p>&minus;
2
</p>
<p>0
2
</p>
<p>4
</p>
<p>Theoretical Quantiles
</p>
<p>S
ta
</p>
<p>n
d
a
rd
</p>
<p>iz
e
d
 r
</p>
<p>e
s
id
</p>
<p>u
a
ls
</p>
<p>Theoretical Quantiles
</p>
<p>(b) Normality with some problems
</p>
<p>Fig. 11.8 Checking the normality assumption with a QQ-plot</p>
<p/>
</div>
<div class="page"><p/>
<p>286 11 Linear Regression
</p>
<p>Small deviations from the normality assumption are not a major problem as the
</p>
<p>least squares estimator of β remains unbiased. However, confidence intervals and
</p>
<p>tests of hypothesis rely on this assumption, and particularly for small sample sizes
</p>
<p>and/or stronger violations of the normality assumptions, these intervals and conclu-
</p>
<p>sions from tests of hypothesis no longer remain valid. In some cases, these problems
</p>
<p>can be fixed by transforming y.
</p>
<p>Heteroscedasticity. If errors have a constant variance, we say that the errors are
</p>
<p>homoscedastic and we call this phenomenon homoscedasticity. When the variance
</p>
<p>of errors is not constant, we say that the errors are heteroscedastic. This phenom-
</p>
<p>enon is also known as heteroscedasticity. If the variance σ 2 depends on i , then
</p>
<p>the variability of the ei will be different for different groups of observations. For
</p>
<p>example, the daily expenditure on food (y) may vary more among persons with a
</p>
<p>high income (x1), so fitting a linear model yields stronger variability of the ei among
</p>
<p>higher income groups. Plotting the fitted values ŷi (or alternatively xi ) against the
</p>
<p>standardized residuals (or a transformation thereof) can help to detect whether or not
</p>
<p>problems exist. If there is no pattern in the plot (random plot), then there is likely no
</p>
<p>violation of the assumption (see Fig. 11.10a). However, if there is a systematic trend,
</p>
<p>i.e. higher/lower variability for higher/lower ŷi , then this indicates heteroscedasticity
</p>
<p>(Fig. 11.10b, trumpet plot). The consequences are again that confidence intervals and
</p>
<p>tests may no longer be correct; again, in some situations, a transformation of y can
</p>
<p>help.
</p>
<p>Example 11.9.1 Recall Example 11.8.3 where we identified a good model to describe
</p>
<p>the delivery time for the pizza data. Branch, bill, temperature, number of pizzas
</p>
<p>ordered, and driver were found to be associated with delivery time. To explore
</p>
<p>whether the normality assumption is fulfilled for this model, we can create a his-
</p>
<p>togram for the standardized residuals (using the R function rstandard()). A QQ-
</p>
<p>plot is contained in the various model diagnostic plots of the plot() function.
</p>
<p>fm &lt;- lm(time&sim;branch+bill+driver+temperature
+pizzas)
</p>
<p>hist(rstandard(fm))
</p>
<p>plot(fm, which=2)
</p>
<p>Figure 11.9 shows a reasonably symmetric distribution of the residuals, maybe
</p>
<p>with a slightly longer tail to the right. As expected for a standard normal distribution,
</p>
<p>not many observations are larger than 2 or smaller than&minus;2 (which are close to the 2.5
and 97.5 % quantiles). The QQ-plot also points towards a normal error distribution</p>
<p/>
</div>
<div class="page"><p/>
<p>11.9 Checking Model Assumptions 287
</p>
<p>Standardized residuals
</p>
<p>F
re
</p>
<p>q
u
e
n
c
y
</p>
<p>&minus;4 &minus;2 0 2 4
</p>
<p>0
5
0
</p>
<p>1
0
0
</p>
<p>1
5
0
</p>
<p>2
0
0
</p>
<p>2
5
0
</p>
<p>(a) Via the histogram of the standardized
residuals
</p>
<p>&minus;3 &minus;2 &minus;1 0 1 2 3
</p>
<p>&minus;
2
</p>
<p>&minus;
1
</p>
<p>0
1
</p>
<p>2
3
</p>
<p>4
</p>
<p>Theoretical Quantiles
</p>
<p>S
ta
</p>
<p>n
d
a
rd
</p>
<p>iz
e
d
 r
</p>
<p>e
s
id
</p>
<p>u
a
ls
</p>
<p>lm(time ~ branch + bill + driver + temperature + pizzas)
</p>
<p>Theoretical Quantiles
</p>
<p>(b) Via a QQ-plot of the standardized
residuals
</p>
<p>Fig. 11.9 Checking the normality assumption in Example 11.9.1
</p>
<p>because the observed quantiles lie approximately on the bisecting line. It seems that
</p>
<p>the lowest residuals deviate a bit from the expected normal distribution, but not
</p>
<p>extremely. The normality assumption does not seem to be violated.
</p>
<p>Plotting the fitted values ŷi against the square root of the absolute values of the
</p>
<p>standardized residuals (=
&radic;
|ê&lowast;i |, used by R for stability reasons) yields a plot with
</p>
<p>no visible structure (see Fig. 11.10a). There is no indication of heteroscedasticity.
</p>
<p>20 25 30 35 40 45
</p>
<p>0
.0
</p>
<p>0
.5
</p>
<p>1
.0
</p>
<p>1
.5
</p>
<p>2
.0
</p>
<p>Fitted Values
</p>
<p>|S
ta
</p>
<p>n
d
a
rd
</p>
<p>iz
e
d
 r
</p>
<p>e
s
id
</p>
<p>u
a
ls
</p>
<p>|
</p>
<p>(a) Example 11.9.1: chaos plot
</p>
<p>20 25 30 35 40 45
</p>
<p>0
.0
</p>
<p>0
.5
</p>
<p>1
.0
</p>
<p>1
.5
</p>
<p>2
.0
</p>
<p>2
.5
</p>
<p>Fitted Values
</p>
<p>|S
ta
</p>
<p>n
d
a
rd
</p>
<p>iz
e
d
 r
</p>
<p>e
s
id
</p>
<p>u
a
ls
</p>
<p>|
</p>
<p>(b) Violation: σ2 depends on i
</p>
<p>Fig. 11.10 Checking the heteroscedasticity assumption</p>
<p/>
</div>
<div class="page"><p/>
<p>288 11 Linear Regression
</p>
<p>plot(fm, which=3)
</p>
<p>Figure 11.10b shows an artificial example where heteroscedasticity occurs: the
</p>
<p>higher the fitted values, the higher is the variation of residuals. This is also called a
</p>
<p>trumpet plot.
</p>
<p>11.10 Association Versus Causation
</p>
<p>There is a difference between association and causation: association says that higher
</p>
<p>values of X relate to higher values of Y (or vice versa), whereas causation says that
</p>
<p>because values of X are higher, values of Y are higher too. Regression analysis, as
</p>
<p>introduced in this chapter, establishes associations between X i &rsquo;s and Y , not causation,
</p>
<p>unless strong assumptions are made.
</p>
<p>For example, recall the pizza delivery example from Appendix A.4. We have seen
</p>
<p>in several examples and exercises that the delivery time varies by driver. In fact, in a
</p>
<p>multiple linear regression model where Y is the delivery time, and the covariates are
</p>
<p>branch, bill, operator, driver, and temperature, we get significant differences of the
</p>
<p>mean delivery times of some drivers (e.g. Domenico and Bruno). Does this mean that
</p>
<p>because Domenico is the driver, the pizzas are delivered faster? Not necessarily. If
</p>
<p>Domenico drives the fastest scooter, then this may be the cause of his speedy deliv-
</p>
<p>eries. However, we have not measured the variable &ldquo;type of scooter&rdquo; and thus cannot
</p>
<p>take it into account. The result we obtain from the regression model is still useful
</p>
<p>because it provides the manager with useful hypotheses and predictions about his
</p>
<p>delivery times, but the interpretation that the driver&rsquo;s abilities cause shorter delivery
</p>
<p>times may not necessarily be appropriate.
</p>
<p>This example highlights that one of the most important assumptions to interpret
</p>
<p>regression parameters in a causal way is to have measured (and used) all variables
</p>
<p>X i which affect both the outcome Y and the variable of interest A (e.g. the variable
</p>
<p>&ldquo;driver&rdquo; above). Another assumption is that the relationship between all X i &rsquo;s and
</p>
<p>Y is modelled correctly, for example non-linear if appropriate. Moreover, we need
</p>
<p>some a priori assumptions about how the variables relate to each other, and some
</p>
<p>technical assumptions need to be met as well. The interested reader is referred to
</p>
<p>Hernan and Robins (2017) for more details.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.11 Key Points and Further Issues 289
</p>
<p>11.11 Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� If X is a continuous variable, the parameter β in the linear regression
</p>
<p>model Y = α + βX + e can be interpreted as follows:
</p>
<p>&ldquo;For each unit of increase in X , there is an increase of β units in E(Y ).&rdquo;
</p>
<p>� If X can take a value of zero, then it can be said that
</p>
<p>&ldquo;For X = 0,E(Y ) equals α.&rdquo;
</p>
<p>If X = 0 is out of the data range or implausible, it does not make sense
to interpret α.
</p>
<p>� A model is said to be linear when it is linear in its parameters.
</p>
<p>� It is possible to include many different covariates in the regression
</p>
<p>model: they can be binary, log-transformed, or take any other form,
</p>
<p>and it is still a linear model. The interpretation of these variables is
</p>
<p>always conditional on the other variables; i.e. the reported association
</p>
<p>assumes that all other variables in the model are held fixed.
</p>
<p>� To evaluate whether xj is associated with y, it is useful to test whether
</p>
<p>β j = 0. If the null hypothesis H0 : β j = 0 is rejected (i.e. the p-value is
smaller than α), one says that there is a significant association of xj and
</p>
<p>y. However, note that a non-significant result does not necessarily mean
</p>
<p>there is no association, it just means we could not show an association.
</p>
<p>� An important assumption in the multivariate linear model y = Xβ + e
relates to the errors:
</p>
<p>e &sim; N (0, σ 2I).
To check whether the errors are (approximately) normally distributed,
</p>
<p>one can plot the standardized residuals in a histogram or a QQ-plot. The
</p>
<p>heteroscedasticity assumption (i.e. σ 2 does not depend on i) is tested
</p>
<p>by plotting the fitted values (ŷi ) against the standardized residuals (êi ).
</p>
<p>The plot should show no pattern (random plot).
</p>
<p>� Different models can be compared by systematic hypothesis testing,
</p>
<p>R2ad j , AIC, and other methods. Different methods may yield different
</p>
<p>results, and there is no unique best option.</p>
<p/>
</div>
<div class="page"><p/>
<p>290 11 Linear Regression
</p>
<p>11.12 Exercises
</p>
<p>Exercise 11.1 The body mass index (BMI) and the systolic blood pressure of 6
</p>
<p>people were measured to study a cardiovascular disease. The data are as follows:
</p>
<p>Body mass index 26 23 27 28 24 25
</p>
<p>Systolic blood pressure 170 150 160 175 155 150
</p>
<p>(a) The research hypothesis is that a high BMI relates to a high blood pressure.
</p>
<p>Estimate the linear model where blood pressure is the outcome and BMI is the
</p>
<p>covariate. Interpret the coefficients.
</p>
<p>(b) Calculate R2 to judge the goodness of fit of the model.
</p>
<p>Exercise 11.2 A psychologist speculates that spending a lot of time on the internet
</p>
<p>has a negative effect on children&rsquo;s sleep. Consider the following data on hours of deep
</p>
<p>sleep (Y ) and hours spent on the internet (X ) where xi and yi are the observations
</p>
<p>on internet time and deep sleep time of the i th (i = 1, 2, . . . , 9) child respectively:
</p>
<p>Child i 1 2 3 4 5 6 7 8 9
</p>
<p>Internet time xi (in h) 0.3 2.2 0.5 0.7 1.0 1.8 3.0 0.2 2.3
</p>
<p>Sleep time yi (in h) 5.8 4.4 6.5 5.8 5.6 5.0 4.8 6.0 6.1
</p>
<p>(a) Estimate the linear regression model for the given data and interpret the coeffi-
</p>
<p>cients.
</p>
<p>(b) Calculate R2 to judge the goodness of fit of the model.
</p>
<p>(c) Reproduce the results of a) and b) in R and plot the regression line.
</p>
<p>(d) Now assume that we only distinguish between spending more than 1 hour on the
</p>
<p>internet (X = 1) and spending less than (or equal to) one hour on the internet
(X = 0). Estimate the linear model again and compare the results. How can β̂
now be interpreted? Describe how β̂ changes if those who spend more than one
</p>
<p>hour on the internet are coded as 0 and the others as 1.
</p>
<p>Exercise 11.3 Consider the following data on weight and height of 17 female stu-
</p>
<p>dents:
</p>
<p>Student i 1 2 3 4 5 6 7 8 9
</p>
<p>Weight yi 68 58 53 60 59 60 55 62 58
</p>
<p>Height xi 174 164 164 165 170 168 167 166 160
</p>
<p>Student i 10 11 12 13 14 15 16 17
</p>
<p>Weight y 53 53 50 64 77 60 63 69
</p>
<p>Height x 160 163 157 168 179 170 168 170
</p>
<p>(a) Calculate the correlation coefficient of Bravais&ndash;Pearson (use
&sum;n
</p>
<p>i=1 xi yi =
170, 821, x̄ = 166.65, ȳ = 60.12,
</p>
<p>&sum;n
i=1 y
</p>
<p>2
i = 62, 184,
</p>
<p>&sum;n
i=1 x
</p>
<p>2
i = 472, 569).
</p>
<p>What does this imply with respect to a linear regression of height on weight?</p>
<p/>
</div>
<div class="page"><p/>
<p>11.12 Exercises 291
</p>
<p>(b) Now estimate and interpret the linear regression model where &ldquo;weight&rdquo; is the
</p>
<p>outcome.
</p>
<p>(c) Predict the weight of a student with a height 175 cm.
</p>
<p>(d) Now produce a scatter plot of the data (manually or by using R) and interpret it.
</p>
<p>(e) Add the following two points to the scatter plot (x18, y18) = (175, 55) and
(x19, y19) = (150, 75). Speculate how the linear regression estimate will change
after adding these points.
</p>
<p>(f) Re-estimate the model using all 19 observations and
&sum;
</p>
<p>xi yi = 191, 696 and&sum;
x2i = 525, 694.
</p>
<p>(g) Given the results of the two regression models: What are the general implications
</p>
<p>with respect to the least squares estimator of β?
</p>
<p>Exercise 11.4 To study the association of the monthly average temperature (in ◦C,
X ) and hotel occupation (in %, Y ), we consider data from three cities: Polenca
</p>
<p>(Mallorca, Spain) as a summer holiday destination, Davos (Switzerland) as a winter
</p>
<p>skiing destination, and Basel (Switzerland) as a business destination.
</p>
<p>Month Davos Polenca Basel
</p>
<p>X Y X Y X Y
</p>
<p>Jan &minus;6 91 10 13 1 23
Feb &minus;5 89 10 21 0 82
Mar 2 76 14 42 5 40
</p>
<p>Apr 4 52 17 64 9 45
</p>
<p>May 7 42 22 79 14 39
</p>
<p>Jun 15 36 24 81 20 43
</p>
<p>Jul 17 37 26 86 23 50
</p>
<p>Aug 19 39 27 92 24 95
</p>
<p>Sep 13 26 22 36 21 64
</p>
<p>Oct 9 27 19 23 14 78
</p>
<p>Nov 4 68 14 13 9 9
</p>
<p>Dec 0 92 12 41 4 12
</p>
<p>(a) Interpret the following regression model output where the outcome is &ldquo;hotel
</p>
<p>occupation&rdquo; and &ldquo;temperature&rdquo; is the covariate.
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 50.33459 7.81792 6.438 2.34e-07 ***
</p>
<p>X 0.07717 0.51966 0.149 0.883
</p>
<p>(b) Interpret the following output where &ldquo;city&rdquo; is treated as a covariate and &ldquo;hotel
</p>
<p>occupation&rdquo; is the outcome.
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 48.3333 7.9457 6.083 7.56e-07 ***
</p>
<p>cityDavos 7.9167 11.2369 0.705 0.486
</p>
<p>cityPolenca 0.9167 11.2369 0.082 0.935</p>
<p/>
</div>
<div class="page"><p/>
<p>292 11 Linear Regression
</p>
<p>(c) Interpret the following output and compare it with the output from b):
</p>
<p>Analysis of Variance Table
</p>
<p>Response: Y
</p>
<p>Df Sum Sq Mean Sq F value Pr(&gt;F)
</p>
<p>city 2 450.1 225.03 0.297 0.745
</p>
<p>Residuals 33 25001.2 757.61
</p>
<p>(d) In the following multiple linear regression model, both &ldquo;city&rdquo; and &ldquo;tempera-
</p>
<p>ture&rdquo; are treated as covariates. How can the coefficients be interpreted?
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 44.1731 10.9949 4.018 0.000333 ***
</p>
<p>X 0.3467 0.6258 0.554 0.583453
</p>
<p>cityDavos 9.7946 11.8520 0.826 0.414692
</p>
<p>cityPolenca -1.1924 11.9780 -0.100 0.921326
</p>
<p>(e) Now consider the regression model for hotel occupation and temperature fitted
</p>
<p>separately for each city: How can the results be interpreted and what are the
</p>
<p>implications with respect to the models estimated in (a)&ndash;(d)? How can the models
</p>
<p>be improved?
</p>
<p>Davos:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 73.9397 4.9462 14.949 3.61e-08 ***
</p>
<p>X -2.6870 0.4806 -5.591 0.000231 ***
</p>
<p>Polenca:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) -22.6469 16.7849 -1.349 0.20701
</p>
<p>X 3.9759 0.8831 4.502 0.00114 **
</p>
<p>Basel:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 32.574 13.245 2.459 0.0337 *
</p>
<p>X 1.313 0.910 1.443 0.1796
</p>
<p>(f) Describe what the design matrix will look like if city, temperature, and the
</p>
<p>interaction between them are included in a regression model.
</p>
<p>(g) If the model described in (f) is fitted the output is as follows:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 32.5741 10.0657 3.236 0.002950 **
</p>
<p>X 1.3133 0.6916 1.899 0.067230 .
</p>
<p>cityDavos 41.3656 12.4993 3.309 0.002439 **
</p>
<p>cityPolenca -55.2210 21.0616 -2.622 0.013603 *
</p>
<p>X:cityDavos -4.0003 0.9984 -4.007 0.000375 ***
</p>
<p>X:cityPolenca 2.6626 1.1941 2.230 0.033388 *
</p>
<p>Interpret the results.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.12 Exercises 293
</p>
<p>(h) Summarize the association of temperature and hotel occupation by city&mdash;
</p>
<p>including 95 % confidence intervals&mdash;using the interaction model. The covari-
</p>
<p>ance matrix is as follows:
</p>
<p>(Int.) X Davos Polenca X:Davos X:Polenca
</p>
<p>(Int.) 101.31 -5.73 -101.31 -101.31 5.73 5.73
</p>
<p>X -5.73 0.47 5.73 5.73 -0.47 -0.47
</p>
<p>Davos -101.31 5.73 156.23 101.31 -9.15 -5.73
</p>
<p>Polenca -101.31 5.73 101.31 443.59 -5.73 -22.87
</p>
<p>X:Davos 5.73 -0.47 -9.15 -5.73 0.99 0.47
</p>
<p>X:Polenca 5.73 -0.47 -5.73 -22.87 0.47 1.42
</p>
<p>Exercise 11.5 The theatre data (see Appendix A.4) describes the monthly expen-
</p>
<p>diture on theatre visits of 699 residents of a Swiss city. It captures not only the
</p>
<p>expenditure on theatre visits (in SFR) but also age, gender, yearly income (in 1000
</p>
<p>SFR), and expenditure on cultural activities in general as well as expenditure on
</p>
<p>theatre visits in the preceding year.
</p>
<p>(a) The summary of the multiple linear model where expenditure on theatre visits
</p>
<p>is the outcome is as follows:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) -127.22271 19.15459 -6.642 6.26e-11 ***
</p>
<p>Age 0.39757 0.19689 [1] [2]
</p>
<p>Sex 22.22059 5.22693 4.251 2.42e-05 ***
</p>
<p>Income 1.34817 0.20947 6.436 2.29e-10 ***
</p>
<p>Culture 0.53664 0.05053 10.620 &lt;2e-16 ***
</p>
<p>Theatre_ly 0.17191 0.11711 1.468 0.1426
</p>
<p>How can the missing values [1] and [2] be calculated?
(b) Interpret the model diagnostics in Fig. 11.11.
</p>
<p>(c) Given the diagnostics in (b), how can the model be improved? Plot a histogram
</p>
<p>of theatre expenditure in R if you need further insight.
</p>
<p>(d) Consider the model where theatre expenditure is log-transformed:
</p>
<p>Coefficients:
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 2.9541546 0.1266802 23.320 &lt; 2e-16 ***
</p>
<p>Age 0.0038690 0.0013022 2.971 0.00307 **
</p>
<p>Sex 0.1794468 0.0345687 5.191 2.75e-07 ***
</p>
<p>Income 0.0087906 0.0013853 6.346 4.00e-10 ***
</p>
<p>Culture 0.0035360 0.0003342 10.581 &lt; 2e-16 ***
</p>
<p>Theatre_ly 0.0013492 0.0007745 1.742 0.08197 .
</p>
<p>How can the coefficients be interpreted?</p>
<p/>
</div>
<div class="page"><p/>
<p>294 11 Linear Regression
</p>
<p>Fig. 11.11 Checking the model assumptions
</p>
<p>&minus;3 &minus;2 &minus;1 0 1 2 3
</p>
<p>&minus;
3
</p>
<p>&minus;
2
</p>
<p>&minus;
1
</p>
<p>0
1
</p>
<p>2
3
</p>
<p>4
</p>
<p>Theoretical Quantiles
</p>
<p>S
ta
</p>
<p>n
d
a
rd
</p>
<p>iz
e
d
 r
</p>
<p>e
s
id
</p>
<p>u
a
ls
</p>
<p>lm(I(log(Theatre)) ~ Age + Sex + Income + Culture + Theatre_ly)
</p>
<p>Theoretical Quantiles
</p>
<p>(a) QQ-plot
</p>
<p>3.5 4.0 4.5 5.0 5.5 6.0
</p>
<p>0
.0
</p>
<p>0
.5
</p>
<p>1
.0
</p>
<p>1
.5
</p>
<p>2
.0
</p>
<p>2
.5
</p>
<p>Fitted Values
</p>
<p>|S
ta
</p>
<p>n
d
a
rd
</p>
<p>iz
e
d
 r
</p>
<p>e
s
id
</p>
<p>u
a
ls
</p>
<p>|
</p>
<p>(b) Fitted values vs. residuals
</p>
<p>Fig. 11.12 Checking the model assumptions
</p>
<p>(e) Judge the quality of the model from d) by means of Figs. 11.12a and 11.12b.
</p>
<p>What do they look like compared with those from b)?
</p>
<p>Exercise 11.6 Consider the pizza delivery data described in Appendix A.4.
</p>
<p>(a) Read the data into R. Fit a multiple linear regression model with delivery time
</p>
<p>as the outcome and temperature, branch, day, operator, driver, bill, number of
</p>
<p>ordered pizzas, and discount customer as covariates. Give a summary of the
</p>
<p>coefficients.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.12 Exercises 295
</p>
<p>(b) Use R to calculate the 95 % confidence intervals of all coefficients. Hint: the
</p>
<p>standard errors of the coefficients can be accessed either via the covariance
</p>
<p>matrix or the model summary.
</p>
<p>(c) Reproduce the least squares estimate of σ 2. Hint: use residuals() to obtain
</p>
<p>the residuals.
</p>
<p>(d) Now use R to estimate both R2 and R2ad j . Compare the results with the model
</p>
<p>output from a).
</p>
<p>(e) Use backward selection by means of the stepAIC function from the library MASS
</p>
<p>to find the best model according to AIC.
</p>
<p>(f) Obtain R2ad j from the model identified in e) and compare it to the full model
</p>
<p>from a).
</p>
<p>(g) Identify whether the model assumptions are satisfied or not.
</p>
<p>(h) Are all variables from the model in (e) causing the delivery time to be either
</p>
<p>delayed or improved?
</p>
<p>(i) Test whether it is useful to add a quadratic polynomial of temperature to the
</p>
<p>model.
</p>
<p>(j) Use the model identified in (e) to predict the delivery time of the last captured
</p>
<p>delivery (i.e. number 1266). Use thepredict() command to ease the calculation
</p>
<p>of the prediction.
</p>
<p>&rarr; Solutions of all exercises in this chapter can be found on p. 409
</p>
<p>&lowast;Source Toutenburg, H., Heumann, C., Deskriptive Statistik, 7th edition, 2009,
Springer, Heidelberg</p>
<p/>
</div>
<div class="page"><p/>
<p>AAppendix: Introduction to R
</p>
<p>Background
</p>
<p>The open-source software R was developed as a free implementation of the language
</p>
<p>S which was designed as a language for statistical computation, statistical program-
</p>
<p>ming, and graphics. The main intention was to allow users to explore data in an
</p>
<p>easy and interactive way, supported by meaningful graphical representations. The
</p>
<p>statistical software R was originally created by Ross Ihaka and Robert Gentleman
</p>
<p>(University of Auckland, New Zealand).
</p>
<p>Installation and Basic Functionalities
</p>
<p>&bull; The &ldquo;base&rdquo; R version, i.e. the software with its most relevant commands, can
be downloaded from https://www.r-project.org/. After installing R, it is recom-
</p>
<p>mended to install an editor too. An editor allows the user to conveniently save and
</p>
<p>display R-code, submit this code to the R console (i.e. the R software itself), and
</p>
<p>control the settings and the output. A popular choice of editor is RStudio (free of
</p>
<p>charge) which can be downloaded from https://www.rstudio.com/ (see Fig. A.1
</p>
<p>for a screenshot of the software). There are alternative good editors, for example
</p>
<p>&ldquo;Tinn-R&rdquo; (http://sourceforge.net/projects/tinn-r/).
</p>
<p>&bull; A lot of additional user-written packages are available online and can be
installed within the R console or using the R menu. Within the console, the
</p>
<p>install.packages("package to install") function can be used. Please
</p>
<p>note that an internet connection is required.
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5
</p>
<p>297</p>
<p/>
<div class="annotation"><a href="https://www.r-project.org/">https://www.r-project.org/</a></div>
<div class="annotation"><a href="https://www.rstudio.com/">https://www.rstudio.com/</a></div>
<div class="annotation"><a href="http://sourceforge.net/projects/tinn-r/">http://sourceforge.net/projects/tinn-r/</a></div>
</div>
<div class="page"><p/>
<p>298 Appendix A: Introduction to R
</p>
<p>F
ig
</p>
<p>.A
.1
</p>
<p>S
cr
ee
n
sh
o
t
o
f
</p>
<p>R
S
tu
d
io
</p>
<p>w
it
h
th
e
co
m
m
an
d
w
in
d
o
w
(t
</p>
<p>o
p
</p>
<p>le
ft
),
th
e
o
u
tp
u
t
w
in
d
o
w
(&ldquo;
co
n
so
le
&rdquo;,
i.
e.
</p>
<p>R
it
se
lf
,
b
</p>
<p>o
tt
</p>
<p>o
m
</p>
<p>le
ft
),
an
d
a
p
lo
t
w
in
d
o
w
(r
</p>
<p>ig
h
t)
.
O
th
er
</p>
<p>w
in
d
o
w
s
(e
.g
.
ab
o
u
t
th
e
en
v
ir
o
n
m
en
t
o
r
p
ac
k
ag
e
u
p
d
at
es
)
ar
e
cl
o
se
d</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 299
</p>
<p>Statistics has a close relationship to algebra: data sets can be seen as matrices, and
</p>
<p>variables as vectors. R makes use of these structures and this is why we first intro-
</p>
<p>duce data structure functionalities before explaining some of the most relevant basic
</p>
<p>statistical commands.
</p>
<p>R as a Calculator, Basic Data Structures and Arithmetic
Operations
</p>
<p>&bull; The character # marks the beginning of a comment. All characters until the end of
the line are ignored by R. We use # to comment on our R-code.
</p>
<p>&bull; If we know the name of a command we would like to use, and we want to learn
about its functionality, typing ?command in the R command line prompt displays
</p>
<p>a help page, e.g.
</p>
<p>?mean
</p>
<p>displays a help page for the arithmetic mean function.
</p>
<p>&bull; Using
example(mean)
</p>
<p>shows application examples of the respective function.
</p>
<p>&bull; The command c(1,2,3,4,5) combines the numbers 1, 2, 3, 4 and 5 into a vector
(e.g. a variable).
</p>
<p>&bull; Vectors can be assigned to an &ldquo;object&rdquo;. For example,
</p>
<p>X &lt;- c(2,12,22,32)
</p>
<p>assigns a numeric vector of length 4 to the object X. In general, the arrow sign
</p>
<p>(&lt;&minus;) is a very important concept to store data, summaries, and outputs in objects
(i.e. the name in the front of the &lt;&minus; sign). Note that R is case sensitive; i.e. X and
x are two different variable names. Instead of &ldquo;&lt;&minus;&rdquo;, one can also use &ldquo;=&rdquo;.
</p>
<p>&bull; Sequences of numbers can be created using the seq and rep commands. For
example,
</p>
<p>seq(1,10)
</p>
<p>and
</p>
<p>rep(1,10)
</p>
<p>yield
</p>
<p>[1] 1 2 3 4 5 6 7 8 9 10
</p>
<p>and
</p>
<p>[1] 1 1 1 1 1 1 1 1 1 1
</p>
<p>respectively.</p>
<p/>
</div>
<div class="page"><p/>
<p>300 Appendix A: Introduction to R
</p>
<p>&bull; Basic data structures are vectors, matrices, arrays, lists, and data frames. They
can contain numeric values, logical values or even characters (strings). In the latter
</p>
<p>case, arithmetic operations are not allowed.
</p>
<p>&ndash; A numeric vector of length 5 can be constructed by the command
</p>
<p>x &lt;- vector(mode="numeric", length=5)
</p>
<p>The elements can be accessed by squared brackets: [ ]. For example,
</p>
<p>x[3] &lt;- 4
</p>
<p>assigns the value 4 to the third element of the object x. Logical vectors containing
</p>
<p>the values TRUE and FALSE are also possible. In arithmetic operations, TRUE
</p>
<p>corresponds to 1 and FALSE corresponds to 0 (which is the default). Consider
</p>
<p>the following example:
</p>
<p>x.log &lt;- vector(mode="logical", length=4)
</p>
<p>x.log[1] = x.log[3] = x.log[4] = TRUE
</p>
<p>mean(x.log)
</p>
<p>returns as output 0.75 because themean of (1, 0, 1, 1)=(TRUE, FALSE, TRUE,
</p>
<p>TRUE) is 0.75.
</p>
<p>&ndash; A matrix can be constructed by the matrix() command:
</p>
<p>x &lt;- matrix(nrow=4, ncol=2, data=1:8, byrow=T)
</p>
<p>creates a 4&times; 2matrix, where the data values are the natural numbers 1, 2, 3, . . . ,
8 which are stored row-wise in the matrix,
</p>
<p>[,1] [,2]
</p>
<p>[1,] 1 2
</p>
<p>[2,] 3 4
</p>
<p>[3,] 5 6
</p>
<p>[4,] 7 8
</p>
<p>because of the parameter byrow=T (which is equivalent to byrow=TRUE). The
</p>
<p>default is byrow=F which would store the data column-wise.
</p>
<p>&ndash; Arrays are more general data structures than vectors and matrices in the sense
</p>
<p>that they can have more than two dimensions. For instance,
</p>
<p>x &lt;- array(data=1:12, dim=c(3,2,2))
</p>
<p>creates a three-dimensional array with 3 &middot; 2 &middot; 2 = 12 elements.
&ndash; A list can contain objects of different types. For example, a list element can be
</p>
<p>a vector or matrix. Lists can be initialized by the command list and can grow
</p>
<p>dynamically. It is important to understand that list elements should be accessed
</p>
<p>by the name of the entry via the dollar sign or using double brackets:</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 301
</p>
<p>x &lt;- list(one=c(1,2,3,4,5),two=c("Hello", "world", "!"))
</p>
<p>x
</p>
<p>$one
</p>
<p>[1] 1 2 3 4 5
</p>
<p>$two
</p>
<p>[1] "Hello" "world" "!"
</p>
<p>x[[2]]
</p>
<p>[1] "Hello" "world" "!"
</p>
<p>x$one
</p>
<p>[1] 1 2 3 4 5
</p>
<p>&ndash; A data frame is the standard data structure for storing a data set with rows as
</p>
<p>observations and columns as variables. Many statistical procedures in R (such
</p>
<p>as the lm function for linear models) expect a data frame. A data frame is
</p>
<p>conceptually not much different from a matrix and can either be initialized by
</p>
<p>reading a data set from an external file or by binding several column vectors.
</p>
<p>As an example, we consider three variables (age, favourite hobby, and favourite
</p>
<p>animal) each with five observations:
</p>
<p>age &lt;- c(25,33,30,40,28)
</p>
<p>hobby &lt;- c("Reading","Sports","Games","Reading","Games")
</p>
<p>animal &lt;- c("Elephant", "Giraffe", NA, "Monkey", "Cat")
</p>
<p>dat &lt;- data.frame(age,hobby,animal)
</p>
<p>names(dat) &lt;- c("Age","Favourite.hobby","Favourite.animal")
</p>
<p>dat
</p>
<p>The resulting output is
</p>
<p>&gt; dat
</p>
<p>Age Favourite.hobby Favourite.animal
</p>
<p>1 25 Reading Elephant
</p>
<p>2 33 Sports Giraffe
</p>
<p>3 30 Games &lt;NA&gt;
</p>
<p>4 40 Reading Monkey
</p>
<p>5 28 Games Cat
</p>
<p>where NA denotes a missing value. With write.table or a specialized version
</p>
<p>thereof such as write.csv (for writing the data in a file using comma-separated
</p>
<p>fields), a data frame can be saved in a file. The command sequence
</p>
<p>write.csv(x=dat,file="toy.csv",row.names=FALSE)
</p>
<p>read.dat &lt;- read.csv(file="toy.csv")
</p>
<p>read.dat</p>
<p/>
</div>
<div class="page"><p/>
<p>302 Appendix A: Introduction to R
</p>
<p>saves the data frame as an external (comma-separated) file and then loads the
</p>
<p>data again using read.csv.
</p>
<p>Individual elements of the data frame can be accessed using squared brackets, as
</p>
<p>for matrices. For example, dat[1,2] returns the first observation of the second
</p>
<p>variable column for the data set dat. Individual columns (variables) can also be
</p>
<p>selected using the $ sign:
</p>
<p>dat$Age
</p>
<p>returns the age column:
</p>
<p>[1] 25 33 30 40 28
</p>
<p>&bull; The factor command is very useful to store nominal variables, and the command
ordered is ideal for ordinal variables. Both commands are extremely important
</p>
<p>since factor variables with more than two categories are automatically expanded
</p>
<p>into several columns of dummy variables if necessary, e.g. if they are included as
</p>
<p>covariates in a linear model. In the previous paragraph, two factor variables have
</p>
<p>already been created. This can be confirmed by typing
</p>
<p>is.factor(dat$Favourite.hobby)
</p>
<p>is.factor(dat$Favourite.animal)
</p>
<p>which return the value TRUE. Have a look at the following two factor variables:
</p>
<p>sex &lt;- factor("female","male","male","female","female")
</p>
<p>grade &lt;- ordered(c("low", "medium", "low", "high", "high"),
</p>
<p>levels=c("low", "medium","high"))
</p>
<p>Please note that by default alphabetical order is used to order the categories (e.g.
</p>
<p>female is coded as 1 and male as 2). However, the mapping of integers to strings
</p>
<p>can be controlled by the user as seen for the variable &ldquo;grade&rdquo;:
</p>
<p>grade
</p>
<p>returns
</p>
<p>[1] low medium low high high
</p>
<p>Levels: low &lt; medium &lt; high</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 303
</p>
<p>&bull; Basic arithmetic operations can be applied directly to a numeric vector. Basic
operations are addition +, subtraction &minus;, multiplication &lowast; and division /, inte-
ger division %/%, modulo operation %%, and exponentiation with two possible
</p>
<p>notations: &lowast;&lowast; or ˆ. Examples are given as:
</p>
<p>2^3 # command
</p>
<p>[1] 8 # output
</p>
<p>2**3 # command
</p>
<p>[1] 8 # output
</p>
<p>2^0.5 # command
</p>
<p>[1] 1.414214 # output
</p>
<p>c(2,3,5,7)^2 # command: application to a vector
</p>
<p>[1] 4 9 25 49 # output
</p>
<p>c(2,3,5,7)^c(2,3) # command: !!! ATTENTION!
</p>
<p>[1] 4 27 25 343 # output
</p>
<p>c(1,2,3,4,5,6)^c(2,3,4) # command
</p>
<p>[1] 1 8 81 16 125 1296 #output
</p>
<p>c(2,3,5,7)^c(2,3,4) # command: !!! WARNING MESSAGE!
</p>
<p>[1] 4 27 625 49
</p>
<p>Warning message:
</p>
<p>longer object length
</p>
<p>is not a multiple of shorter object length
</p>
<p>in: c(2, 3, 5, 7)^c(2, 3, 4)
</p>
<p>The last four commands show the &ldquo;recycling property&rdquo; of R. It tries to match the
</p>
<p>vectors with respect to the length if possible. In fact,
</p>
<p>c(2,3,5,7)^c(2,3)
</p>
<p>is expanded to
</p>
<p>c(2,3,5,7)^c(2,3,2,3)
</p>
<p>The last example shows that R gives a warning if the length of the shorter vector
</p>
<p>cannot be expanded to the length of the longer vector by a simple multiplication
</p>
<p>with a natural number (2, 3, 4, . . .). Here
</p>
<p>c(2,3,5,7)^c(2,3,4)
</p>
<p>is expanded to
</p>
<p>c(2,3,5,7)^c(2,3,4,2)</p>
<p/>
</div>
<div class="page"><p/>
<p>304 Appendix A: Introduction to R
</p>
<p>such that not all elements of
</p>
<p>c(2,3,4)
</p>
<p>are &ldquo;recycled&rdquo;.
</p>
<p>More on indexing
</p>
<p>The standard ways of accessing/indexing elements in a vector, matrix, list, or data
</p>
<p>frame have already been introduced above, but R allows a lot more flexible accessing
</p>
<p>of elements.
</p>
<p>1. Selecting elements using vectors of positive numbers (letters and LETTERS
</p>
<p>show the 26 letters of the alphabet)
</p>
<p>letters[1:3]
</p>
<p>letters[ c(2,4,6) ]
</p>
<p>[1] "a" "b" "c"
</p>
<p>[1] "b" "d" "f"
</p>
<p>2. Selecting elements using logical vectors
</p>
<p>x &lt;- 1:10 # numbers 1 to 10
</p>
<p>x[ (x&gt;5) ] # selecting any number &gt;5
</p>
<p>x[ (x%%2==0) ] # numbers that are divisible by 2
</p>
<p>x[(x%%2==1)] # numbers that are not divisible by 2
</p>
<p>x[5] &lt;- NA # 5th element of x is defined
</p>
<p># to be missing (NA)
</p>
<p>x
</p>
<p>y &lt;- x[!is.na(x)] # all x which are not missing
</p>
<p>y
</p>
<p>returns the output
</p>
<p>[1] 6 7 8 9 10
</p>
<p>[1] 2 4 6 8 10
</p>
<p>[1] 1 3 5 7 9
</p>
<p>[1] 1 2 3 4 NA 6 7 8 9 10
</p>
<p>[1] 1 2 3 4 6 7 8 9 10</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 305
</p>
<p>3. Selecting (deleting) elements using negative numbers
</p>
<p>x &lt;- 1:10
</p>
<p>x[-(1:5)] # x, but delete first five entries of x
</p>
<p>returns the output
</p>
<p>[1] 6 7 8 9 10
</p>
<p>because the first five elements have been removed.
</p>
<p>4. Selecting elements using characters
</p>
<p>x &lt;- c(Water=1, Juice=2, Lemonade=3 )
</p>
<p>names(x)
</p>
<p>x["Juice"]
</p>
<p>returns the output
</p>
<p>[1] "Water" "Juice" "Lemonade"
</p>
<p>Juice
</p>
<p>2
</p>
<p>Standard Functions
</p>
<p>Some standard functions and their roles in R are
</p>
<p>abs() Absolute value
</p>
<p>sqrt() Square root
</p>
<p>round(), floor(), ceiling() Rounding, up and down
</p>
<p>sum(), prod() Sum and product
</p>
<p>log(), log10(), log2() Logarithms
</p>
<p>exp() Exponential function
</p>
<p>sin(), cos(), tan(), Trigonometric functions
</p>
<p>asin(), acos(), atan()
</p>
<p>sinh(), cosh(), tanh(), Hyperbolic functions
</p>
<p>asinh(x), acosh(), atanh(x)
</p>
<p>All functions can again be applied directly to numeric vectors.</p>
<p/>
</div>
<div class="page"><p/>
<p>306 Appendix A: Introduction to R
</p>
<p>Statistical Functions
</p>
<p>Some statistical functions and their roles in R are
</p>
<p>mean(), var() Mean and variance
</p>
<p>cov(), cor() Covariance and correlation
</p>
<p>min(), max() Minimum and maximum
</p>
<p>Note: the arguments of the functions vary depending on the chosen method. For
</p>
<p>example, the mean() function can be applied to general R objects where averaging
</p>
<p>makes sense (numeric or logical vectors, but also, e.g. matrices). The functions
</p>
<p>var(), cov(), cor() expect oneor twonumeric vectors,matrices, or data frames.
</p>
<p>Minimum and maximum functions work also with a comma-separated list of values,
</p>
<p>i.e.
</p>
<p>min(2, 6.7, 1.2, 8.0)
</p>
<p>provides the same result (1.2) as
</p>
<p>min(c(2, 6.7, 1.2, 8.0))
</p>
<p>Examples:
</p>
<p>mean( c(1,2,5,6) )
</p>
<p>[1] 3.5
</p>
<p>var( c(1,2,5,6) )
</p>
<p>[1] 5.666667
</p>
<p>Note that var(), cov() use the factor 1/(n &minus; 1) for the unbiased estimate of the
variance instead of 1/n for the empirical variance, i.e. 1/3 in the example above.
</p>
<p>Both functions can also be applied to several vectors or a matrix. Then the covariance
</p>
<p>matrix (and correlation matrix in case of cor()) is computed. For example, consider
</p>
<p>two variables
</p>
<p>age.v &lt;- c(25,30,35,40)
</p>
<p>income.v &lt;- c(2000, 2500, 2800, 3200)
</p>
<p>Then both commands return the symmetric covariance matrix (with variances as the
</p>
<p>diagonal entries and covariances as the non-diagonal entries).</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 307
</p>
<p>var(cbind(age.v, income.v))
</p>
<p>age.v income.v
</p>
<p>age.v 41.66667 3250.0
</p>
<p>income.v 3250.00000 255833.3
</p>
<p>cov(cbind(age.v, income.v))
</p>
<p>age.v income.v
</p>
<p>age.v 41.66667 3250.0
</p>
<p>income.v 3250.00000 255833.3
</p>
<p>The (Pearson) correlation between the two variables is calculated as 0.9954293.
</p>
<p>cor(cbind(age.v, income.v))
</p>
<p>age.v income.v
</p>
<p>age.v 1.0000000 0.9954293
</p>
<p>income.v 0.9954293 1.0000000
</p>
<p>The Spearman rank correlation is perfectly 1, since both vectors are in increasing
</p>
<p>order:
</p>
<p>cor(cbind(age.v, income.v), method="spearman")
</p>
<p>age.v income.v
</p>
<p>age.v 1 1
</p>
<p>income.v 1 1
</p>
<p>More Useful Functions
</p>
<p>Some more commonly used standard functions and their roles in R are as follows:
</p>
<p>&bull; Cumulative sum and product:
</p>
<p>x &lt;- c( 1,3, 2, 5)
</p>
<p>cumsum(x) # 1, 1+3, 1+3+2, 1+3+2+5
</p>
<p>cumprod(x) # 1, 1*3, 1*3*2, 1*3*2*5
</p>
<p>give the output
</p>
<p>[1] 1 4 6 11
</p>
<p>[1] 1 3 6 30</p>
<p/>
</div>
<div class="page"><p/>
<p>308 Appendix A: Introduction to R
</p>
<p>&bull; Factorial:
</p>
<p>factorial(5)
</p>
<p>returns 5! as
</p>
<p>[1] 120
</p>
<p>&bull; Binomial coefficient
(
</p>
<p>n
k
</p>
<p>)
</p>
<p>:
</p>
<p>choose(4,2)
</p>
<p>returns
(4
2
</p>
<p>)
</p>
<p>as
</p>
<p>[1] 6
</p>
<p>Mathematical Constants
</p>
<p>The number π is a mathematical constant, the ratio of a circle&rsquo;s circumference to its
</p>
<p>diameter, and is commonly approximated as 3.14159. It is directly available in R as
</p>
<p>pi.
</p>
<p>pi
</p>
<p>[1] 3.141593
</p>
<p>Other &ldquo;constants&rdquo; are
</p>
<p>Inf, -Inf &infin;,&minus;&infin;
NaN Not a Number: e.g. 0/0[1] NaN
NA Not Available: missing values
</p>
<p>NULL empty set
</p>
<p>Assignment Operator for Creating Functions
</p>
<p>The assignment operator&lt;&minus; (&ldquo;less than&rdquo; sign followed by hyphen) has already been
introduced above in the context of variables. Alternatively, = (equality sign) can be
used. One can create one&rsquo;s own functions: the function is an object with a namewhich
</p>
<p>takes values specified in the round brackets and returns what has been specified in the
</p>
<p>curly braces. For example, the following function myfunction returns a polynomial
</p>
<p>of degree 3 for a given argument x . Note that by default all four coefficients are equal
</p>
<p>to 1.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 309
</p>
<p>my.function &lt;- function(x,a=1,b=1,c=1,d=1){
</p>
<p>h &lt;- a+b*x+c*x^2+d*x^3
</p>
<p>return(h)
</p>
<p>}
</p>
<p>my.function(2)
</p>
<p>[1] 15
</p>
<p>my.function(x=2, a=4, b=3)
</p>
<p>[1] 22
</p>
<p>Loops and Conditions
</p>
<p>The concept of loops is convenient when some operation has to be repeated. Loops
</p>
<p>can be utilized in various ways, for example, via for or while. Conditions are
</p>
<p>specified with the if statement. For example,
</p>
<p>x &lt;- 1:10
</p>
<p>for(i in 1:10){ if(x[i]&gt;5){x[i] &lt;- x[i]+i}
</p>
<p>}
</p>
<p>x
</p>
<p>returns
</p>
<p>[1] 1 2 3 4 5 12 14 16 18 20
</p>
<p>In this example, x is a vector with 10 elements: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10. For
</p>
<p>each element x[i], we replace x[i] with x[i]+i if the condition x[i]&gt;5 is true;
</p>
<p>otherwise we do not.
</p>
<p>Statistical Functions
</p>
<p>Now we consider some basic statistical functions in R. For illustration, we use
</p>
<p>the painters data in the following example. This data is available after loading the
</p>
<p>library MASS (only a subset is shown below). The data lists the subjective assessment,
</p>
<p>on a 0 to 20 integer scale, of 54 classical painters. The painters were assessed on
</p>
<p>four characteristics: composition, drawing, colour, and expression. The data is due
</p>
<p>to the eighteenth-century art critic, de Piles. Use ?painters for more information
</p>
<p>on the data set.
</p>
<p>library(MASS)
</p>
<p>painters</p>
<p/>
</div>
<div class="page"><p/>
<p>310 Appendix A: Introduction to R
</p>
<p>shows
</p>
<p>Composition Drawing Colour Expression School
</p>
<p>Da Udine 10 8 16 3 A
</p>
<p>Da Vinci 15 16 4 14 A
</p>
<p>Del Piombo 8 13 16 7 A
</p>
<p>Del Sarto 12 16 9 8 A
</p>
<p>Fr. Penni 0 15 8 0 A
</p>
<p>The Summary Function
</p>
<p>The summary function allows a quick overview of a data frame. For numeric vari-
</p>
<p>ables, the five-point summary (which is also used in a simple box plot, see Sect. 3.3)
</p>
<p>is calculated together with the arithmetic mean. For factor variables, the absolute
</p>
<p>frequencies of the most frequent categories are printed. If the factor has more than
</p>
<p>six categories, the other categories are summarized in a separate category&mdash;Other.
</p>
<p>summary(painters)
</p>
<p>yields
</p>
<p>Composition Drawing ... School
</p>
<p>Min. : 0.00 Min. : 6.00 ... A :10
</p>
<p>1st Qu.: 8.25 1st Qu.:10.00 ... D :10
</p>
<p>Median :12.50 Median :13.50 ... E : 7
</p>
<p>Mean :11.56 Mean :12.46 ... G : 7
</p>
<p>3rd Qu.:15.00 3rd Qu.:15.00 ... B : 6
</p>
<p>Max. :18.00 Max. :18.00 ... C : 6
</p>
<p>... (Other) : 8
</p>
<p>The summary function can also be applied to a single variable:
</p>
<p>summary(painters$School)
</p>
<p>returns
</p>
<p>A B C D E F G H
</p>
<p>10 6 6 10 7 4 7 4</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 311
</p>
<p>Accessing Subgroups in Data Frames
</p>
<p>Subgroups, i.e. groups of observations which share the same feature(s) of one or
</p>
<p>several variables, can be accessed using the subset command.
</p>
<p>subset(painters, School=="F")
</p>
<p>accesses all painters for which School==&lsquo;&lsquo;F&rsquo;&rsquo; holds.
</p>
<p>Composition Drawing Colour Expression School
</p>
<p>Durer 8 10 10 8 F
</p>
<p>Holbein 9 10 16 13 F
</p>
<p>Pourbus 4 15 6 6 F
</p>
<p>Van Leyden 8 6 6 4 F
</p>
<p>This is a more elegant method than selecting these observations by specifying a
</p>
<p>condition in squared brackets via the [rows,columns] argument.
</p>
<p>painters[ painters[["School"]] == "F", ]
</p>
<p>Note that the explained structure is an important one: we access the rows and columns
</p>
<p>of a matrix or data set by using the [rows,columns] argument. Here we access all
</p>
<p>rows for which the variable &ldquo;school&rdquo; is &ldquo;F&rdquo;. If, in addition, we also want to restrict
</p>
<p>the data set to the first two variables, we can write:
</p>
<p>painters[ painters[["School"]] == "F", c(1,2)]
</p>
<p>Similarly,
</p>
<p>subset(painters, Composition &lt;= 6)
</p>
<p>gives the output
</p>
<p>Composition Drawing Colour Expression School
</p>
<p>Fr. Penni 0 15 8 0 A
</p>
<p>Perugino 4 12 10 4 A
</p>
<p>Bassano 6 8 17 0 D
</p>
<p>Bellini 4 6 14 0 D
</p>
<p>Murillo 6 8 15 4 D
</p>
<p>Palma Vecchio 5 6 16 0 D
</p>
<p>Caravaggio 6 6 16 0 E
</p>
<p>Pourbus 4 15 6 6 F
</p>
<p>Uninteresting columns can be eliminated using negative indexing. For instance,
</p>
<p>in the following example,</p>
<p/>
</div>
<div class="page"><p/>
<p>312 Appendix A: Introduction to R
</p>
<p>subset(painters, School=="F", select=c(-3,-5) )
</p>
<p>Composition Drawing Expression
</p>
<p>Durer 8 10 8
</p>
<p>Holbein 9 10 13
</p>
<p>Pourbus 4 15 6
</p>
<p>Van Leyden 8 6 4
</p>
<p>the third and the fifth columns (Colour and School) are not shown.
</p>
<p>The operator %in% allows for more complex searches. For instance,
</p>
<p>subset(painters, Drawing %in% c(6,7,8,9) &amp; Composition==10)
</p>
<p>returns the following output:
</p>
<p>Composition Drawing Colour Expression School
</p>
<p>Da Udine 10 8 16 3 A
</p>
<p>J. Jordaens 10 8 16 6 G
</p>
<p>Bourdon 10 8 8 4 H
</p>
<p>i.e. those painterswith a drawing score between 6 and 9 (= any numberwhichmatches
</p>
<p>6, or 7, or 8, or 9).
</p>
<p>Stratifying a Data Frame and Applying Commands to a List
</p>
<p>Sometimes it is of interest to apply statistical commands (such as summary) to several
</p>
<p>subgroups. If this is the case, the data is partitioned into different groups using split
</p>
<p>and then lapply applies a function to each of these groups. The command split
</p>
<p>partitions the data set by values of a specific variable. For example, we first stratify
</p>
<p>the painters data with respect to the painter&rsquo;s school:
</p>
<p>splitted &lt;- split(painters, painters$School)
</p>
<p>splitted
</p>
<p>$A
</p>
<p>Composition Drawing Colour Expression School
</p>
<p>Da Udine 10 8 16 3 A
</p>
<p>Da Vinci 15 16 4 14 A
</p>
<p>Del Piombo 8 13 16 7 A
</p>
<p>Del Sarto 12 16 9 8 A
</p>
<p>Fr. Penni 0 15 8 0 A
</p>
<p>Guilio Romano 15 16 4 14 A</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 313
</p>
<p>Michelangelo 8 17 4 8 A
</p>
<p>Perino del Vaga 15 16 7 6 A
</p>
<p>Perugino 4 12 10 4 A
</p>
<p>Raphael 17 18 12 18 A
</p>
<p>$B
</p>
<p>Composition Drawing Colour Expression School
</p>
<p>F. Zucarro 10 13 8 8 B
</p>
<p>Fr. Salviata 13 15 8 8 B
</p>
<p>Parmigiano 10 15 6 6 B
</p>
<p>Primaticcio 15 14 7 10 B
</p>
<p>T. Zucarro 13 14 10 9 B
</p>
<p>Volterra 12 15 5 8 B
</p>
<p>$C
</p>
<p>...
</p>
<p>Note, that splitted is now a list,
</p>
<p>is.list(splitted)
</p>
<p>returns
</p>
<p>[1] TRUE
</p>
<p>while the objects splitted$A to splitted$H are data frames.
</p>
<p>is.data.frame(splitted$A)
</p>
<p>returns
</p>
<p>[1] TRUE
</p>
<p>Secondly, as indicated above, the command lapply allows us to apply a function to
</p>
<p>a list. For instance,
</p>
<p>lapply(splitted, summary)
</p>
<p>applies the summary function to all data frames in the list splitted (output not
</p>
<p>shown). See also ?apply, ?sapply, ?tapply, and ?mapply for similar opera-
</p>
<p>tions.</p>
<p/>
</div>
<div class="page"><p/>
<p>314 Appendix A: Introduction to R
</p>
<p>Sorting, Ranking, Finding Duplicates, and Unique Values
</p>
<p>&bull; Sorting a vector:
</p>
<p>x &lt;- c( 1,3, 2, 5)
</p>
<p>sort(x)
</p>
<p>sort(x, decreasing=TRUE)
</p>
<p>returns the ordered values in decreasing order as
</p>
<p>[1] 5 3 2 1
</p>
<p>See also the command order for showing the order of vector elements.
</p>
<p>&bull; Calculating ranks;
</p>
<p>x &lt;- c( 10,30, 20, 50, 20)
</p>
<p>rank(x)
</p>
<p>returns the following output:
</p>
<p>[1] 1.0 4.0 2.5 5.0 2.5
</p>
<p>&bull; Finding duplicate values:
</p>
<p>x &lt;- c( 1,3, 2, 5, 2)
</p>
<p>duplicated(x)
</p>
<p>indicates which values occur more than once:
</p>
<p>[1] FALSE FALSE FALSE FALSE TRUE
</p>
<p>&bull; Removing duplicates:
</p>
<p>x &lt;- c( 1,3, 2, 5, 2)
</p>
<p>unique(x)
</p>
<p>shows the output as
</p>
<p>[1] 1 3 2 5
</p>
<p>This means unique finds out how many different values a vector has.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 315
</p>
<p>Categorizing Numeric Variables
</p>
<p>Continuous variables (vectors) can be categorized using the cut command.
</p>
<p>x &lt;- c(1.3, 1.5, 2.5, 3.8, 4.1, 5.9, 7.1, 8.4, 9.0)
</p>
<p>xdiscrete &lt;- cut(x, breaks=c(-Inf, 2, 5, 8, Inf) )
</p>
<p>is.factor(xdiscrete)
</p>
<p>xdiscrete
</p>
<p>table(xdiscrete)
</p>
<p>returns
</p>
<p>[1] TRUE
</p>
<p>[1] (-Inf,2] (-Inf,2] (2,5] (2,5] (2,5] (5,8] (5,8] (8,Inf]
</p>
<p>[9] (8,Inf]
</p>
<p>Levels: (-Inf,2] (2,5] (5,8] (8,Inf]
</p>
<p>(-Inf,2] (2,5] (5,8] (8,Inf]
</p>
<p>2 3 2 2
</p>
<p>Random Variables
</p>
<p>&bull; R has built-in functions for several probability density/mass functions (PMF/PDF),
(probability) distribution function (i.e. the CDF), quantile functions and for gen-
</p>
<p>erating random numbers.
</p>
<p>&bull; The function names use the following scheme:
</p>
<p>First letter Function Further letters
</p>
<p>d density distribution name
</p>
<p>p probability distribution name
</p>
<p>q quantiles distribution name
</p>
<p>r random number distribution name
</p>
<p>&bull; Examples:
</p>
<p>dnorm(x=0)
</p>
<p>[1] 0.3989423
</p>
<p>returns the value of the density function (i.e. P(X = x)) of a N (0, 1)-distribution
at x = 0, which is 1/
</p>
<p>&radic;
2π.
</p>
<p>pnorm(q=0)
</p>
<p>pnorm(q=1.96)
</p>
<p>[1] 0.5
</p>
<p>[1] 0.9750021</p>
<p/>
</div>
<div class="page"><p/>
<p>316 Appendix A: Introduction to R
</p>
<p>returns the value of the CDF of a N (0, 1)-distribution at q , i.e.Φ(q) = P(X &le; q).
</p>
<p>qnorm(p=0.95)
</p>
<p>returns the value
</p>
<p>[1] 1.644854
</p>
<p>which is the 95% quantile of a N (0, 1)-distribution.
</p>
<p>X &lt;- rnorm(n=4)
</p>
<p>X
</p>
<p>returns a vector of four normal random numbers of a N (0, 1)-distribution:
</p>
<p>[1] -0.90826678 -0.09089654 -0.47679821 1.22137230
</p>
<p>Note that a repeated application of this function leads to different randomnumbers.
</p>
<p>To get a reproducible sequence of random numbers, a seed value needs to be set:
</p>
<p>set.seed(89234512)
</p>
<p>X &lt;- rnorm(n=4)
</p>
<p>X
</p>
<p>If all three commands are executed, then the sequence is (using the standard random
</p>
<p>generator)
</p>
<p>[1] -1.07628865 0.37797715 0.04925738 -0.22137107
</p>
<p>&bull; The following functions for distributions can be used:
</p>
<p>Model distributions
</p>
<p>Function Distribution
</p>
<p>beta Beta
</p>
<p>binom Binomial
</p>
<p>cauchy Cauchy
</p>
<p>exp Exponential
</p>
<p>gamma Gamma
</p>
<p>geom Geometric
</p>
<p>hyper Hypergeometric
</p>
<p>lnorm Log&ndash;normal
</p>
<p>norm Normal
</p>
<p>pois Poisson
</p>
<p>unif Uniform
</p>
<p>mvnorm Multivariate normal (in package mvtnorm)</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 317
</p>
<p>Test distributions
</p>
<p>Function Distribution
</p>
<p>chisq χ2
</p>
<p>f F
</p>
<p>signrank Wilcoxon signed rank (1 sample)
</p>
<p>t t
</p>
<p>wilcox Wilcoxon rank sum (2 samples)
</p>
<p>&bull; For convenience, we list a few important PDF and CDF values in Sect. C.
</p>
<p>Key Points and Further Issues
</p>
<p>Note:
</p>
<p>� R uses the following data structures: vectors, matrices, arrays, lists, and
</p>
<p>data frames.
</p>
<p>� Entries ofmatrices and data frames can be accessed using squared brack-
</p>
<p>ets. For example, data[1:5,2] refers to the first five observations of
</p>
<p>the second column (variable) of the data. Variables of data frames can
</p>
<p>also be accessed via the $ sign, e.g. via data$variable.
</p>
<p>� If operations such as statistical analyses have to be repeated on several
</p>
<p>subgroups, using split together with lapply is a viable option. Alter-
</p>
<p>natively, loops (e.g. for) together with conditions (such as if) can be
</p>
<p>used.
</p>
<p>� R contains the most relevant statistical functions needed
</p>
<p>for descriptive and inductive analyses (as shown through-
</p>
<p>out the book). User-written packages can be installed using
</p>
<p>install.packages(&lsquo;&lsquo;package_name&rsquo;&rsquo;).
</p>
<p>� Readers who are interested in learning more about R are referred to
</p>
<p>Albert and Rizzo (2012), Crawley (2013), Dalgaard (2008), Ligges
</p>
<p>(2008), and Everitt and Hothorn (2011).</p>
<p/>
</div>
<div class="page"><p/>
<p>318 Appendix A: Introduction to R
</p>
<p>Data Sets
</p>
<p>From the data used in this book, we publish some relevant data sets, along with
</p>
<p>solutions of the R-exercises, on https://chris.userweb.mwn.de/book/. The important
</p>
<p>data sets are explained in the following paragraphs.
</p>
<p>Pizza Delivery Data
</p>
<p>The pizza delivery data (pizza_delivery.csv, see also Table A.1) is a simulated
</p>
<p>data set. The data refers to an Italian restaurant which offers home delivery of pizza.
</p>
<p>It contains the orders received during a period of one month: May 2014. There are
</p>
<p>three branches of the restaurant. The pizza delivery is centrally managed: an operator
</p>
<p>receives a phone call and forwards the order to the branch which is nearest to the
</p>
<p>customer&rsquo;s address. One of the five drivers (two of whom only work part time at the
</p>
<p>weekend) delivers the order. The data set captures the number of pizzas ordered as
</p>
<p>well as the final bill (in e) which may also include drinks, salads, and pasta dishes.
</p>
<p>The owner of the business observed an increased number of complaints, mostly
</p>
<p>because pizzas arrive too late and too cold. To improve the service quality of his
</p>
<p>business, the owner wants to measure (i) the time from call to delivery and (ii) the
</p>
<p>pizza temperature at arrival (which can be donewith a special device). Ideally, a pizza
</p>
<p>arrives within 30 min of the call; if it takes longer than 40 min, then the customers
</p>
<p>are promised a free bottle of wine (which is not always handed out though). The
</p>
<p>temperature of the pizza should be above 65 ◦Cat the time of delivery. The analysis of
the data aims to determine the factors which influence delivery time and temperature
</p>
<p>of the pizzas.
</p>
<p>Table A.1 First few rows of the pizza delivery data
</p>
<p>day date time operator branch driver temperature
</p>
<p>1 Thursday 1 May 2014 35.1 Laura East Bruno 68.3
</p>
<p>2 Thursday 1 May 2014 25.2 Melissa East Salvatore 71.0
</p>
<p>3 Thursday 1 May 2014 45.6 Melissa West Salvatore 53.4
</p>
<p>4 Thursday 1 May 2014 29.4 Melissa East Salvatore 70.3
</p>
<p>5 Thursday 1 May 2014 30.0 Melissa West Salvatore 71.5
</p>
<p>6 Thursday 1 May 2014 40.3 Melissa Centre Bruno 60.8
</p>
<p>...
</p>
<p>bill pizzas free_wine got_wine discount_customer
</p>
<p>1 58.4 4 0 0 1
</p>
<p>2 26.4 2 0 0 0
</p>
<p>3 58.1 3 1 0 0
</p>
<p>4 35.2 3 0 0 0
</p>
<p>5 38.4 2 0 0 0
</p>
<p>6 61.8 4 1 1 0
</p>
<p>....</p>
<p/>
<div class="annotation"><a href="https://chris.userweb.mwn.de/book/">https://chris.userweb.mwn.de/book/</a></div>
</div>
<div class="page"><p/>
<p>Appendix A: Introduction to R 319
</p>
<p>Table A.2 First few rows of the decathlon data from the 2004 Olympic Games in Athens data
</p>
<p>100m Long.jump Shot.put High.jump 400m
</p>
<p>Roman Sebrle 10.85 7.84 16.36 2.12 48.36
</p>
<p>Bryan Clay 10.44 7.96 15.23 2.06 49.19
</p>
<p>Dmitriy Karpov 10.50 7.81 15.93 2.09 46.81
</p>
<p>Dean Macey 10.89 7.47 15.73 2.15 48.97
</p>
<p>Chiel Warners 10.62 7.74 14.48 1.97 47.97
</p>
<p>Attila Zsivoczky 10.91 7.14 15.31 2.12 49.40
</p>
<p>...
</p>
<p>110m.hurdle Discus Pole.vault Javelin 1500m
</p>
<p>Roman Sebrle 14.05 48.72 5.0 70.52 280.01
</p>
<p>Bryan Clay 14.13 50.11 4.9 69.71 282.00
</p>
<p>Dmitriy Karpov 13.97 51.65 4.6 55.54 278.11
</p>
<p>Dean Macey 14.56 48.34 4.4 58.46 265.42
</p>
<p>Chiel Warners 14.01 43.73 4.9 55.39 278.05
</p>
<p>Attila Zsivoczky 14.95 45.62 4.7 63.45 269.54
</p>
<p>...
</p>
<p>Decathlon Data
</p>
<p>This data (decathlon.csv, see also TableA.2) describes the results of the decathlon
</p>
<p>competition during the 2004 Olympic Games in Athens. The performance of all 30
</p>
<p>athletes in the 100 m race (in seconds), long jump (in metres), shot-put (in metres),
</p>
<p>high jump (in metres), 400 m race (in seconds), 110 m hurdles race (in seconds),
</p>
<p>discus competition (inmetres), pole vault (inmetres), javelin competition (inmetres),
</p>
<p>and 1500 m race (in seconds) are recorded in the data set.
</p>
<p>Theatre Data
</p>
<p>This data (theatre.csv, see also Table A.3) summarizes a survey conducted on
</p>
<p>699 participants in a big Swiss city. The survey participants are all frequent visitors
</p>
<p>to a local theatre and were asked about their age, sex (gender, female = 1), annual
income (in 1000 SFR), general expenditure on cultural activities (&ldquo;Culture&rdquo;, in SFR
</p>
<p>per month), expenditure on theatre visits (in SFR per month), and their estimated
</p>
<p>expenditure on theatre visits in the year before the survey was done (in SFR per
</p>
<p>month).
</p>
<p>Table A.3 First few rows of the theatre data
</p>
<p>Age Sex Income Culture Theatre Theatre_ly
</p>
<p>1 31 1 90.5 181 104 150
</p>
<p>2 54 0 73.0 234 116 140
</p>
<p>3 56 1 74.3 289 276 125
</p>
<p>4 36 1 73.6 185 75 130
</p>
<p>5 24 1 109.0 191 172 140
</p>
<p>6 25 0 93.1 273 168 130
</p>
<p>...</p>
<p/>
</div>
<div class="page"><p/>
<p>BAppendix: Solutions to Exercises
</p>
<p>Solutions to Chapter 1
</p>
<p>Solution to Exercise 1.1
</p>
<p>(a) The population consists of all employees of the airline. This may include admin-
</p>
<p>istration staff, pilots, stewards, cleaning personnel, and others. Each single
</p>
<p>employee relates to an observation in the survey.
</p>
<p>(b) The population comprises all students who take part in the examination. Each
</p>
<p>student represents an observation.
</p>
<p>(c) All people suffering high blood pressure in the study area (city, province, country,
</p>
<p>. . .), are the population of interest. Each of these persons is an observation.
</p>
<p>Solution to Exercise 1.2 The population in this study refers to all leopards in the
</p>
<p>park. Only a few of the leopards are equipped with the GPS devices. This is the
</p>
<p>sample on which the study is conducted in. Each leopard refers to an observation.
</p>
<p>The measurements are taken for each leopard in the sample. The GPS coordinates
</p>
<p>allow to determine the position during the entire day. Important variables to capture
</p>
<p>would therefore be X1 = &ldquo;latitude&rdquo;, X2 = &ldquo;longitude&rdquo;, and X3 = &ldquo;time&rdquo;. Each
variable would take on certain values for each observation; for example, the first
</p>
<p>leopard may have been observed at latitude 32◦ at a certain time point, and thus
x11 = 32◦.
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5
</p>
<p>321</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_1">http://dx.doi.org/10.1007/978-3-319-46162-5_1</a></div>
</div>
<div class="page"><p/>
<p>322 Appendix B: Solutions to Exercises
</p>
<p>Solution to Exercise 1.3
</p>
<p>Qualitative: Preferred political party, eye colour, gender,
</p>
<p>blood type, subject line of an email.
</p>
<p>Quantitative and discrete: Shoe size, customer satisfaction on a scale from
</p>
<p>1 to 10, number of goals in a hockey match.
</p>
<p>Quantitative and continuous: Time to travel to work, price of a canteen meal,
</p>
<p>wavelength of light, delivery time of a parcel,
</p>
<p>height of a child.
</p>
<p>Solution to Exercise 1.4
</p>
<p>(a) The choice of a political party is measured on a nominal scale. The names of the
</p>
<p>parties do not have a natural order.
</p>
<p>(b) Typically the level of a computer game is measured on an ordinal scale: for
</p>
<p>example, level 10 may be more difficult than level 5, but this does not imply that
</p>
<p>level 10 is twice as difficult as level 5, or that the difference in difficulty between
</p>
<p>levels 2 and 3 is the same as the difference between levels 10 and 11.
</p>
<p>(c) The production time of a car is measured on a continuous scale (ratio scale). In
</p>
<p>practice, it may be measured in days from the start of the production.
</p>
<p>(d) This variable is measured on a continuous scale (ratio scale). Typically, the age
</p>
<p>is captured in years starting from the day of birth.
</p>
<p>(e) Calender year is a continuous variable which is measured on an interval scale.
</p>
<p>Note that the year which we define as &ldquo;zero&rdquo; is arbitrary, and it varies from
</p>
<p>culture to culture. Because the year zero is arbitrary, and we also have dates
</p>
<p>before this year, the calender year is measured on an interval scale.
</p>
<p>(f) The scale is continuous (ratio scale).
</p>
<p>(g) The scale of ID numbers is nominal. The ID number may indeed consist of
</p>
<p>numbers; however, &ldquo;112233&rdquo; does not refer to something half as much/good as
</p>
<p>&ldquo;224466&rdquo;. The number is descriptive.
</p>
<p>(h) The final rank is measured on an ordinal scale. The ranks can be clearly ordered,
</p>
<p>and the participants can be ranked by using their final results. However the first
</p>
<p>winner may not have &ldquo;double&rdquo; the beauty of the second winner, it is merely a
</p>
<p>ranking.
</p>
<p>(i) The intelligence quotient is a variable on a continuous scale. It is constructed
</p>
<p>in such a way that differences are interpretative&mdash;i.e. being 10 points above or
</p>
<p>10 points below the average score of 100 points means the same deviation from
</p>
<p>the average. However, ratios cannot be interpreted, so the intelligence quotient
</p>
<p>is measured on an interval scale.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 323
</p>
<p>Solution to Exercise 1.5
</p>
<p>(a) The data is provided in .csv format. We thus read it in with the read.csv()
</p>
<p>command (after we have set a working directory with setwd()):
</p>
<p>setwd('C:/directory')
</p>
<p>pizza &lt;- read.csv('pizza_delivery.csv')
</p>
<p>(b) The data can be viewed by means of the fix() or View() command or simply
</p>
<p>being printed:
</p>
<p>fix(pizza)
</p>
<p>pizza
</p>
<p>(c) We can access the data, as for any matrix, by using squared brackets [, ], see also
Appendix A.1. The first entry in the brackets refers to the row and the second
</p>
<p>entry to the columns. Each entry either is empty (referring to every row/column)
</p>
<p>or consists of a vector or sequence describing the columns/rowswewant to select.
</p>
<p>This means that we obtain the first 5 rows and variables via pizza[1:5,1:5].
</p>
<p>If we give the new data the name &ldquo;pizza2&rdquo; we simply need to type:
</p>
<p>pizza2 &lt;- pizza[1:5,1:5]
</p>
<p>pizza2
</p>
<p>We can save this new data either as a .dat file (with write.table()), or as a
</p>
<p>.csv file (with write.csv()), or directly as an R data file (with save()) which
</p>
<p>gives us access to our entire R session.
</p>
<p>write.csv(pizza2,file='pizza2.csv')
</p>
<p>write.table(pizza2,file='pizza2.dat')
</p>
<p>save(pizza2,file='pizza2.Rdata')
</p>
<p>(d) We can access any variable by means of the $ sign. If we type pizza$new we
</p>
<p>create a new variable in the pizza data set called &ldquo;new&rdquo;. Therefore, a simple way
</p>
<p>to add a variable to the data set is as follows:
</p>
<p>pizza$NewTemperature &lt;- 32+1.8*pizza$temperature
</p>
<p>(e)
</p>
<p>attach(pizza)
</p>
<p>NewTemperature</p>
<p/>
</div>
<div class="page"><p/>
<p>324 Appendix B: Solutions to Exercises
</p>
<p>Fig. B.1 Applying str() to the pizza data
</p>
<p>(f) We can apply all these commands onto the object &ldquo;pizza&rdquo;. The command
</p>
<p>str(pizza) gives us an overview of the data set, see also Fig. B.1. The output
</p>
<p>shows that the data set contains 1266 observations (deliveries) and 13 variables.
</p>
<p>We can also see which of these variables are factors (categorical with defined
</p>
<p>categories) and which are numerical. We also see the first actual numbers for
</p>
<p>the each variable and the coding scheme used for the categories of the factor
</p>
<p>variables. The command dim summarizes the dimension of the data, i.e. the
</p>
<p>number of rows and columns of the data matrix. Colnames gives us the names
</p>
<p>of the variables from the data set, and so does names. The commands nrow and
</p>
<p>ncol give us the number of rows and columns, respectively. Applying head and
</p>
<p>tail to the data prints the first and last rows of the data, respectively.
</p>
<p>Solution to Exercise 1.6
</p>
<p>(a) The appropriate study design is a survey. The information would be obtained via
</p>
<p>a questionnaire given to a sample of parents. It is not a controlled experiment
</p>
<p>because we do not manipulate one particular variable, while controlling others;
</p>
<p>we rather collect data on all variables of interest.
</p>
<p>(b) There are different options to ask for parents&rsquo; attitudes: of course one could
</p>
<p>simply ask &ldquo;what do you think of immunization?&rdquo;; however, capturing long
</p>
<p>answers in a variable &ldquo;attitude&rdquo; may make it difficult to summarize and distil the
</p>
<p>information obtained. A common way to deal with such variables is to translate
</p>
<p>a concept into a score: for example, one could ask 5 &ldquo;yes/no&rdquo;-type questions
</p>
<p>(instead of one general question) which relate to attitudes towards immunization,
</p>
<p>such as &ldquo;do you think immunization may be harmful for your child?&rdquo; or &ldquo;do you
</p>
<p>agree that it is a priority to immunize infants in their first year of life?&rdquo; The
</p>
<p>number of answers that show a positive attitude towards immunization can be
</p>
<p>summed up. If there are 5 questions, there are up to 5 points &ldquo;to earn&rdquo;. Thus,
</p>
<p>each parent may be asked 5 questions and his/her attitude can be summarized
</p>
<p>on a scale ranging from 0 to 5, depending on the answers given.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 325
</p>
<p>(c) The following variables are needed:
</p>
<p>&bull; Attitude: possibly several variables are needed to capture parents&rsquo; information
in a score, see (b) for details. The scale is ordinal because a higher score relates
</p>
<p>to a more positive attitude towards immunization, but the differences between
</p>
<p>different score levels cannot be interpreted meaningfully.
</p>
<p>&bull; Immunized: a binary (&ldquo;yes&ndash;no&rdquo; type) variable capturing whether the parent
agrees to immunization against chickenpox for their youngest child or not.
</p>
<p>This is a nominal variable.
</p>
<p>&bull; Gender: to compare &ldquo;Immunized&rdquo; for male and female parents. This is a
nominal variable.
</p>
<p>&bull; Age: to compare the age distribution in the group of parents whowould immu-
nize their child with the age distribution in the groupwhowould not immunize
</p>
<p>their child. Age is measured on a continuous scale.
</p>
<p>(d) A data set might look as follows:
</p>
<p>⎛
</p>
<p>⎜
⎝
</p>
<p>Parent A1 . . . A5 Attitude Immunization Gender Age
</p>
<p>1 yes . . . yes 3 yes male 35
</p>
<p>2 no . . . yes 2 no female 26
...
</p>
<p>...
...
</p>
<p>...
...
</p>
<p>...
...
</p>
<p>⎞
</p>
<p>⎟
⎠
</p>
<p>where A1, . . . , A5 refer to variables capturing attitudes towards immunization
</p>
<p>and &ldquo;Attitude&rdquo; is the score variable summarizing these questions. The questions
</p>
<p>may be written down as follows:
</p>
<p>&bull; What is the average attitude score towards immunization among parents and
how much does it vary?
</p>
<p>&bull; What percentage of parents answer &ldquo;yes&rdquo; when asked whether they would
immunize their youngest child against chickenpox?
</p>
<p>&bull; What is the difference in the proportion calculated in (b) when stratified by
gender?
</p>
<p>&bull; What is the average age of those parents who would immunize their child
compared with the average age of those parents who would not immunize
</p>
<p>their child?
</p>
<p>Chapter 2
</p>
<p>Solution to Exercise 2.1
</p>
<p>(a) The table shows the relative frequencies of each party and not the absolute
</p>
<p>frequencies. We can thus draw a bar chart where the relative frequencies of
</p>
<p>votes are plotted on the y-axis and different parties are plotted on the x-axis. In
</p>
<p>R, we can first type in the data by defining two vectors and then use the &ldquo;barplot&rdquo;
</p>
<p>command to draw the bar chart (Fig. B.2a). Typing &ldquo;?barplot&rdquo; and &ldquo;?par&rdquo; shows
</p>
<p>the graphical options to improve the presentation and look of the graph:</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
</div>
<div class="page"><p/>
<p>326 Appendix B: Solutions to Exercises
</p>
<p>ANC DA EFF IFP COPE Others
</p>
<p>Parties
</p>
<p>V
o
te
</p>
<p>s
 (
</p>
<p>%
)
</p>
<p>0
.0
</p>
<p>0
.1
</p>
<p>0
.2
</p>
<p>0
.3
</p>
<p>0
.4
</p>
<p>0
.5
</p>
<p>0
.6
</p>
<p>0
.7
</p>
<p>(a) Results of the 2014 elections
</p>
<p>ANC DA EFF IFP COPE Others
</p>
<p>Parties
</p>
<p>D
if
fe
</p>
<p>re
n
c
e
</p>
<p>&minus;
0
.1
</p>
<p>0
&minus;
</p>
<p>0
.0
</p>
<p>5
0
.0
</p>
<p>0
0
.0
</p>
<p>5
0
.1
</p>
<p>0
</p>
<p>(b) Difference in results between the
2014 and 2009 elections
</p>
<p>Fig. B.2 Bar charts for national elections in South Africa
</p>
<p>results2014 &lt;- c(0.6215,0.2223,0.0635,0.0240,0.0067,0.0620)
</p>
<p>barplot(results2014)
</p>
<p>barplot(results2014,names.arg=c('ANC','DA','EFF','IFP','COPE',
</p>
<p>'Others'), col=gray.colors(6),ylim=c(0,0.7),xlab='Parties',ylab =
</p>
<p>'Votes(%)')
</p>
<p>(b) There are several options to compare the results. Of course, one can simply plot
</p>
<p>the two bar charts with each bar chart representing one election. It would be
</p>
<p>important for this solution to ensure that the y-axes are identical in both the
</p>
<p>plots. However, if we want to compare the election results in one graph then we
</p>
<p>can plot the difference between the two elections, i.e. the win/loss per party. The
</p>
<p>bar chart for the new variable &ldquo;difference in proportion of votes between the two
</p>
<p>elections&rdquo; is shown in Fig. B.2 and is obtained as follows:
</p>
<p>results2009 &lt;- c(0.6590,0.1666,0,0.0455,0.0742,0.0547)
</p>
<p>difference &lt;- results2014-results2009
</p>
<p>barplot(difference)
</p>
<p>Remark Another solution would be to create subcategories on the x-axis: for exam-
</p>
<p>ple, there would be categories such as &ldquo;ANC 2009 results&rdquo; and &ldquo;ANC 2014 results&rdquo;,
</p>
<p>followed by &ldquo;DA 2009 results&rdquo; and &ldquo;DA 2014 results&rdquo;, and so on.
</p>
<p>Solution to Exercise 2.2
</p>
<p>(a) The scale of X is continuous. However, please note that the number of values
</p>
<p>X can practically take is limited (90 min plus extra time, recorded in 1 min
</p>
<p>intervals).</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 327
</p>
<p>Table B.1 Frequency table and other information for the variable &ldquo;time until first goal&rdquo;
</p>
<p>j [e j&minus;1, e j ) n j f j d j h j F(x)
1 [0, 15) 19 1955 15
</p>
<p>19
825
</p>
<p>19
55
</p>
<p>2 [15, 30) 17 1755 15
17
825
</p>
<p>36
55
</p>
<p>3 [30, 45) 6 655 15
6
825
</p>
<p>42
55
</p>
<p>4 [45, 60) 5 555 15
5
825
</p>
<p>47
55
</p>
<p>5 [60, 75) 4 455 15
4
825
</p>
<p>51
55
</p>
<p>6 [75, 90) 2 255 15
2
825
</p>
<p>53
55
</p>
<p>7 [90, 96) 2 255 6
2
825 1
</p>
<p>Total 56 1
</p>
<p>(b) It is straightforward to obtain the frequency table, aswell as the other information
</p>
<p>needed to obtain the histogram and the ECDF, see Table B.1.
</p>
<p>(c) We need to obtain the heights for each category to obtain the histogram using
</p>
<p>h j = f j/d j , see Table B.1.
</p>
<p>(d) We obtain the histogram and kernel density plot in R (Fig. B.3a) using the
</p>
<p>commands
</p>
<p>goals &lt;- c(6,24,91,...,7)
</p>
<p>hist(goals, breaks=c(0,15,30,45,60,75,90,96))
</p>
<p>plot(density(goals, adjust=1,kernel='gaussian'))
</p>
<p>Time (in min)
</p>
<p>D
e
n
s
it
y
</p>
<p>0 20 40 60 80 100
</p>
<p>0
.0
</p>
<p>0
0
</p>
<p>0
.0
</p>
<p>0
5
</p>
<p>0
.0
</p>
<p>1
0
</p>
<p>0
.0
</p>
<p>1
5
</p>
<p>0
.0
</p>
<p>2
0
</p>
<p>0
.0
</p>
<p>2
5
</p>
<p>(a) Histogram
</p>
<p>0 50 100
</p>
<p>0
.0
</p>
<p>0
0
</p>
<p>0
.0
</p>
<p>0
5
</p>
<p>0
.0
</p>
<p>1
0
</p>
<p>0
.0
</p>
<p>1
5
</p>
<p>Time (in min)
</p>
<p>D
e
n
s
it
y
</p>
<p>(b) Kernel density plot
</p>
<p>Fig. B.3 Distribution of time to goal</p>
<p/>
</div>
<div class="page"><p/>
<p>328 Appendix B: Solutions to Exercises
</p>
<p>0 20 40 60 80 100
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>Time (in min)
</p>
<p>F
(x
</p>
<p>)
</p>
<p>(a) Original data
</p>
<p>0 20 40 60 80 100
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>Time (in min)
</p>
<p>F
(x
</p>
<p>)
</p>
<p>(b) Grouped data
</p>
<p>Fig. B.4 Empirical cumulative distribution function for the variable &ldquo;time until first goal&rdquo;
</p>
<p>(e) The ECDF values for F(x) are calculated using the relative frequencies f (x),
</p>
<p>see Table B.1.
</p>
<p>(f) (i) We can easily plot the ECDF (Fig. B.4a) for the original data using the R
</p>
<p>command
</p>
<p>plot.ecdf(goals)
</p>
<p>(ii) Generating the ECDF for the grouped data requires more effort and is not
</p>
<p>necessarily intuitive: first we categorize the continuous variable using the
</p>
<p>function cut. We use the label option to indicate that the name of each
</p>
<p>category corresponds to the upper limit of the respective interval. This new
</p>
<p>variable is a &ldquo;factor&rdquo; variable and the plot.ecdf function does not work
</p>
<p>with this type of variable.We need to first change the &ldquo;factor&rdquo; variable into a
</p>
<p>&ldquo;character&rdquo; variable with strings corresponding to the labels and coerce this
</p>
<p>into numeric values. Then we use plot.ecdf, see also Fig. B.4b. Alterna-
</p>
<p>tively, we can directly replace the raw values with numbers corresponding
</p>
<p>to the upper interval limits.
</p>
<p>goals_cat &lt;- cut(goals, breaks=c(0,15,30,45,60,75,90,96),
</p>
<p>labels=c(15,30,45,60,75,90,96))
</p>
<p>plot.ecdf(as.numeric(as.character(goals_cat))
</p>
<p>(g) To solve the exercises, we simply use Formula (2.11) and Rules (2.3ff.)
</p>
<p>(i) H(X &le; 45) = F(45) = 4255 &asymp; 0.76.
</p>
<p>(ii) H(X &gt; 80) = 1&minus; F(80) = 1&minus;
(
51
55 +
</p>
<p>2/55
15 (80&minus; 75)
</p>
<p>)
</p>
<p>&asymp; 0.085.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 329
</p>
<p>(iii) H(20 &le; X &le; 65) = F(65)&minus; F(20) = 4755 +
4/55
15 &middot; (65&minus; 60)&minus;
</p>
<p>(
19
55+
</p>
<p>17/55
15 &middot; (20&minus; 15)
</p>
<p>)
</p>
<p>&asymp; 0.43.
</p>
<p>(h) We know from (2.11) that
</p>
<p>F(x p) = p = F(e j&minus;1)+ h j (x p &minus; e j&minus;1)
with h j = f j/d j which relates to
</p>
<p>x p = e j&minus;1 +
p &minus; F(e j&minus;1)
</p>
<p>h j
.
</p>
<p>We are interested in x0.8 because 80 % of the matches have seen a goal at this
</p>
<p>time point:
</p>
<p>x0.8 = 45+
0.8 &minus; 4356
</p>
<p>1
168
</p>
<p>= 50.4.
</p>
<p>We conclude that 80 % of the &ldquo;first goals&rdquo; happened up to 50.4 min.
</p>
<p>Solution to Exercise 2.3
</p>
<p>(a) We obtain the relative frequencies for the first and fourth intervals as 0.125 (h j &middot;
d j = 0.125 &middot; 1). Accordingly, for the other two intervals, we obtain frequencies
of f j = 3 &middot; 0.125 = 0.375.
</p>
<p>(b) We obtain the absolute frequencies for the first and fourth intervals as 250 (2000 &middot;
0.125). For the other intervals, we obtain 750 (2000 &middot; 0.375).
</p>
<p>Solution to Exercise 2.4
</p>
<p>(a) The absolute frequencies n j are evident from the following table:
</p>
<p>j e j&minus;1 e j F(e j ) f j n j (= f j n) d j a j
1 8 14 0.25 0.25 0.25 &middot; 500 = 125 6 11
2 14 22 0.40 0.15 75 8 18
</p>
<p>3 22 34 0.75 0.35 175 12 28
</p>
<p>4 34 50 0.97 0.22 110 16 42
</p>
<p>5 50 82 1.00 0.03 15 32 66
</p>
<p>(b) We obtain F(X &gt; 34) = 1&minus; F(34) = 1&minus; 0.75 = 0.25.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
</div>
<div class="page"><p/>
<p>330 Appendix B: Solutions to Exercises
</p>
<p>Table B.2 Information needed to calculate the ECDF
</p>
<p>Score 1 2 3 4 5 6 7 8 9 10
</p>
<p>Results 1 3 8 8 27 30 11 6 4 2
</p>
<p>f j
1
</p>
<p>100
3
</p>
<p>100
8
</p>
<p>100
8
</p>
<p>100
27
100
</p>
<p>30
100
</p>
<p>11
100
</p>
<p>6
100
</p>
<p>4
100
</p>
<p>2
100
</p>
<p>F j
1
</p>
<p>100
4
</p>
<p>100
12
100
</p>
<p>20
100
</p>
<p>47
100
</p>
<p>77
100
</p>
<p>88
100
</p>
<p>94
100
</p>
<p>98
100 1
</p>
<p>Fig. B.5 Empirical
</p>
<p>cumulative distribution
</p>
<p>function for the variable
</p>
<p>&ldquo;score&rdquo;
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>Score
</p>
<p>F
(x
</p>
<p>)
28.2%
</p>
<p>89.4%
</p>
<p>Solution to Exercise 2.5
</p>
<p>(a) The data needed to calculate and draw the ECDF is summarized in Table B.2;
</p>
<p>the ECDF is plotted in Fig. B.5.
</p>
<p>(b) It follows from Table B.2 that F(3) = 12% and F(9) = 98%.
(c) The grey solid line in Fig. B.5 summarizes the ECDF for the grouped data.
</p>
<p>It goes from (0, 0) to (1, 1) with a breakpoint at (5, 0.47) since F(5) = 0.47
summarizes the information for the group &ldquo;disagree&rdquo;. Using (2.11) we calculate:
</p>
<p>F(3) = F(e j&minus;1)+
f j
</p>
<p>d j
(x &minus; e j&minus;1)
</p>
<p>= F(0)+ 0.47
5
</p>
<p>&middot; (3&minus; 0) = 28.2%
</p>
<p>F(9) = F(5)+ 0.53
5
</p>
<p>&middot; (9&minus; 5) = 89.4%.
</p>
<p>(d) The results of (b) and (c) are very different. The formula applied in (c) assumes
</p>
<p>that the values in each category are uniformly distributed, i.e. that within each
</p>
<p>category, each value occurs as often as each other value. However, we know from
</p>
<p>(a) that this is not true: there are more values towards the central score numbers.
</p>
<p>The assumption used in (c) is therefore inappropriate as also highlighted in
</p>
<p>Fig. B.5.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_2">http://dx.doi.org/10.1007/978-3-319-46162-5_2</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 331
</p>
<p>Solution to Exercise 2.6 We read in and attach the data as follows:
</p>
<p>setwd('C:/directory')
</p>
<p>pizza &lt;- read.csv('pizza_delivery.csv')
</p>
<p>attach(pizza)
</p>
<p>(a) We need the options ylim, xlim, ylab, xlab, col to adjust the
</p>
<p>histogram produced with hist(). We then add a dashed (lty=2) line
</p>
<p>(type=&rsquo;l&rsquo;), which is thick (lwd=3), from (65, 0) to (65, 400) using the lines()
</p>
<p>command. See also Fig. B.6a.
</p>
<p>hist(temperature,xlab='Temperature',xlim=c(40,90),
</p>
<p>ylim=c(0,400),col='lightgrey',ylab='Number of deliveries')
</p>
<p>lines(c(65,65),c(0,400),type='l',lty=2,lwd=3)
</p>
<p>(b) We can create the histogram as follows, see also Fig. B.6b:
</p>
<p>library(ggplot2)
</p>
<p>p1 &lt;- ggplot(data=pizza,aes(x=temperature))
</p>
<p>p2 &lt;- p1 + geom_histogram(fill='darkgrey',alpha=0.5,binwidth=2.5)
</p>
<p>+ scale_y_continuous('Number of deliveries')
</p>
<p>plot(p2)
</p>
<p>(c) A possible solution is as follows, see also Fig. B.6c:
</p>
<p>barplot(table(driver),ylim=c(0,200),col=gray.colors(7),
</p>
<p>ylab='Number of deliveries', xlab='Driver',main='Title'))
</p>
<p>(d) We can produce the graph (Fig. B.6d) as follows:
</p>
<p>p3 &lt;- qplot(driver,data=pizza,aes=('bar'),fill=day)
</p>
<p>p4 &lt;- p3 + scale_fill_grey() +theme_bw()
</p>
<p>plot(p4)</p>
<p/>
</div>
<div class="page"><p/>
<p>332 Appendix B: Solutions to Exercises
</p>
<p>T
e
</p>
<p>m
p
e
ra
</p>
<p>tu
re
</p>
<p>Number of deliveries
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>7
0
</p>
<p>8
0
</p>
<p>9
0
</p>
<p>0100200300400
</p>
<p>(a
)
w
it
h
h
i
s
t
(
)
</p>
<p>0
</p>
<p>5
0
</p>
<p>1
0
0
</p>
<p>1
5
0
</p>
<p>2
0
0
</p>
<p>4
0
</p>
<p>6
0
</p>
<p>8
0
</p>
<p>T
e
m
</p>
<p>p
e
ra
</p>
<p>tu
re
</p>
<p>Number of deliveries
</p>
<p>(b
)
w
it
h
g
g
p
l
o
t
fr
o
m
</p>
<p>li
b
ra
ry
</p>
<p>g
g
p
l
o
t
2
</p>
<p>B
ru
</p>
<p>n
o
</p>
<p>D
o
</p>
<p>m
e
</p>
<p>n
ic
</p>
<p>o
L
</p>
<p>u
ig
</p>
<p>i
M
</p>
<p>a
ri
</p>
<p>o
S
</p>
<p>a
lv
</p>
<p>a
to
</p>
<p>re
</p>
<p>T
it
le
</p>
<p>D
ri
</p>
<p>v
e
r
</p>
<p>Number of deliveries
</p>
<p>0100200300400
</p>
<p>(c
)
w
it
h
b
a
r
c
h
a
r
t
(
)
</p>
<p>0
</p>
<p>1
0
0
</p>
<p>2
0
0
</p>
<p>3
0
0
</p>
<p>B
ru
</p>
<p>n
o
</p>
<p>D
o
m
</p>
<p>e
n
ic
</p>
<p>o
L
u
ig
</p>
<p>i
M
</p>
<p>a
ri
</p>
<p>o
S
</p>
<p>a
lv
</p>
<p>a
to
</p>
<p>re
</p>
<p>D
ri
</p>
<p>v
e
r
</p>
<p>Number of deliveries
</p>
<p>d
a
y F
ri
</p>
<p>d
a
y
</p>
<p>M
o
</p>
<p>n
d
</p>
<p>a
y
</p>
<p>S
a
</p>
<p>tu
rd
</p>
<p>a
y
</p>
<p>S
u
</p>
<p>n
d
</p>
<p>a
y
</p>
<p>T
h
</p>
<p>u
rs
</p>
<p>d
a
y
</p>
<p>T
u
e
s
d
a
y
</p>
<p>W
e
</p>
<p>d
n
</p>
<p>e
s
d
</p>
<p>a
y
</p>
<p>(d
)
w
it
h
q
p
l
o
t
fr
o
m
</p>
<p>li
b
ra
ry
</p>
<p>g
g
p
l
o
t
2
</p>
<p>F
ig
</p>
<p>.B
.6
</p>
<p>C
re
at
in
g
fi
g
u
re
s
w
it
h
</p>
<p>R</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 333
</p>
<p>Chapter 3
</p>
<p>Solution to Exercise 3.1
</p>
<p>(a) The arithmetic means can be calculated as follows:
</p>
<p>x̄D =
1
</p>
<p>10
</p>
<p>10
&sum;
</p>
<p>i=1
xi =
</p>
<p>1
</p>
<p>10
(12.5+ &middot; &middot; &middot; + 17.5) = 17.32,
</p>
<p>x̄A =
1
</p>
<p>10
</p>
<p>10
&sum;
</p>
<p>i=1
xi =
</p>
<p>1
</p>
<p>10
(342+ &middot; &middot; &middot; + 466) = 612.4.
</p>
<p>The ordered values of the two variables are:
</p>
<p>i: 1 2 3 4 5 6 7 8 9 10
</p>
<p>------------------------------------------------------
</p>
<p>D: 7.6 12.1 12.5 14.8 16.2 16.5 17.5 18.5 27.4 29.9
</p>
<p>A: 238 342 398 466 502 555 670 796 912 1245
</p>
<p>x̃0.5,D =
1
</p>
<p>2
(x̃(5) + x̃(6)) =
</p>
<p>1
</p>
<p>2
(16.2+ 16.5) = 16.35,
</p>
<p>x̃0.5,A =
1
</p>
<p>2
(x̃(5) + x̃(6)) =
</p>
<p>1
</p>
<p>2
(502+ 555) = 528.5.
</p>
<p>(b) Wehavenα = 10 &middot; 0.25 = 2.5which is not an integer.Wecan therefore calculate
the 25 % quantiles, i.e. the first quartiles, as
</p>
<p>x̃0.25,D = x̃(3) = 12.5; x̃0.25,A = x̃(3) = 398.
Similarly, nα = 10 &middot; 0.75 = 7.5 is not an integer and thus
</p>
<p>x̃0.75,D = x̃(8) = 18.5; x̃0.75,A = x̃(8) = 796.
One can see that the distributions for both variables are not symmetric. For
</p>
<p>example, when looking at the distance hiked, the difference between the median
</p>
<p>and the first quartile (16.35&minus; 12.5) is much larger than the difference between
the median and the third quartile (18.5&minus; 16.35); this indicates a distribution that
is skewed towards the left.
</p>
<p>(c) We can calculate the interquartile ranges as follows:
</p>
<p>dQ,A = 796&minus; 398 = 398; dQ,D = 18.5&minus; 12.5 = 6.
The mean absolute deviations are:
</p>
<p>DD(x̃0.5) = =
1
</p>
<p>10
(|7.6&minus; 16.35| + &middot; &middot; &middot; + |29.9&minus; 16.35|) = 4.68,
</p>
<p>DA(x̃0.5) = =
1
</p>
<p>10
(|238&minus; 528.5| + &middot; &middot; &middot; + |1245&minus; 528.5|) = 223.2.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>334 Appendix B: Solutions to Exercises
</p>
<p>The variances of both the variables are
</p>
<p>s̃2D =
1
</p>
<p>10
([7.6&minus; 16.35]2 + &middot; &middot; &middot; + [29.9&minus; 16.35]2) &asymp; 41.5,
</p>
<p>s̃2A =
1
</p>
<p>10
([238&minus; 528.5]2 + &middot; &middot; &middot; + [1245&minus; 528.5]2) &asymp; 82, 314.
</p>
<p>The standard deviations are therefore s̃D =
&radic;
41.5 and s̃A =
</p>
<p>&radic;
82, 314.
</p>
<p>(d) To answer this question, we can use the rules of linear transformations.
</p>
<p>ȳ
(3.4)= 0+ 3.28x̄ = 3.28 &middot; 528.5 = 1722.48,
</p>
<p>s̃2y
(3.29)= b2s̃2x = 3.282 &middot; 272.2 &asymp; 2928.
</p>
<p>(e) To draw the box plots, we can use the results from (a), (b), and (c) in this
</p>
<p>solution. The median, first quartile, third quartile, and the interquartile range
</p>
<p>have already been calculated. It is also easy to determine the minimum and
</p>
<p>maximum values from the table of ordered values in (a). What is missing is the
</p>
<p>knowledge ofwhether to treat some of the values as extreme values or not. For the
</p>
<p>distance hiked, an extreme value would be any value&gt;18.5+ 1.5&times; 6 = 27.5 or
&lt;12.5&minus; 1.5&times; 6 = 3.5. It follows that there is only one extreme value: 29.9 km.
For the maximum altitude, there is no extreme value because there is no value
</p>
<p>&gt;796+ 1.5&times; 398 = 1292 or &lt;398&minus; 1.5&times; 398 = &minus;199. The box plots are
shown in Fig. B.7a, b.
</p>
<p>1
0
</p>
<p>1
5
</p>
<p>2
0
</p>
<p>2
5
</p>
<p>3
0
</p>
<p>D
is
</p>
<p>ta
n
</p>
<p>c
e
</p>
<p> (
in
</p>
<p> k
m
</p>
<p>)
</p>
<p>(a) Box plot for distance hiked
</p>
<p>2
0
0
</p>
<p>4
0
0
</p>
<p>6
0
0
</p>
<p>8
0
0
</p>
<p>1
0
0
0
</p>
<p>1
2
0
0
</p>
<p>A
lt
it
u
</p>
<p>d
e
</p>
<p> (
in
</p>
<p> m
)
</p>
<p>(b) Box plot for maximum altitude
</p>
<p>Fig. B.7 Box plots for Exercise 3.1</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 335
</p>
<p>(f) The data can be summarized as follows:
</p>
<p>Class intervals (5; 15] (15; 20] (20; 30]
n j 4 4 2
</p>
<p>f j 4/10 4/10 2/10
&sum;
</p>
<p>f j 4/10 8/10 1
</p>
<p>We can calculate the weighted arithmetic mean by using the relative frequencies
</p>
<p>f j and the middle of the intervals m j :
</p>
<p>x̄ =
&sum;
</p>
<p>j
</p>
<p>f j m j =
4
</p>
<p>10
&middot; 10+ 4
</p>
<p>10
&middot; 17.5+ 2
</p>
<p>10
&middot; 25 = 16.
</p>
<p>To estimate the weighted median, we need to determine the class for which
</p>
<p>m&minus;1
&sum;
</p>
<p>j=1
f j &lt; 0.5 and
</p>
<p>m
&sum;
</p>
<p>j=1
f j &ge; 0.5
</p>
<p>holds. This is clearly the case for the second class K2 = (15; 20]. Thus
</p>
<p>x̃0.5 = em&minus;1 +
0.5&minus;
</p>
<p>&sum;m&minus;1
j=1 f j
</p>
<p>fm
dm = 15+
</p>
<p>0.5&minus; 0.4
0.4
</p>
<p>&middot; 5 = 16.25.
</p>
<p>(g) If the raw data is known, then the variance for the grouped data will be identical
</p>
<p>to the variance calculated in (c). For educational purposes, we show the identity
</p>
<p>here. The variance for grouped data can be calculated as:
</p>
<p>s̃2 = 1
n
</p>
<p>k
&sum;
</p>
<p>j=1
n j (x̄ j &minus; x̄)2
</p>
<p>︸ ︷︷ ︸
</p>
<p>between
</p>
<p>+ 1
n
</p>
<p>k
&sum;
</p>
<p>j=1
n j s̃
</p>
<p>2
j
</p>
<p>︸ ︷︷ ︸
</p>
<p>within
</p>
<p>Using the arithmetic mean x̄ = 17.32 as well as the means in each class, x̄1 =
11.75, x̄2 = 17.225, and x̄3 = 28.65, we can calculate the variance between the
classes:
</p>
<p>s̃2b =
1
</p>
<p>10
([4 &middot; (11.75&minus; 17.32)2] + [4 &middot; (17.225&minus; 17.32)2]
</p>
<p>+[2 &middot; (28.65&minus; 17.32)2]) = 38.08735.
The variances within each class are:
</p>
<p>s̃21 =
1
</p>
<p>4
[(7.6&minus; 11.75)2 + &middot; &middot; &middot; + (14.8&minus; 11.75)2] = 6.8025,
</p>
<p>s̃22 =
1
</p>
<p>4
[(16.2&minus; 17.225)2 + &middot; &middot; &middot; + (18.5&minus; 17.225)2] = 0.956875,
</p>
<p>s̃23 =
1
</p>
<p>2
[(27.4&minus; 28.65)2 + (29.9&minus; 28.65)2] = 1.5625.</p>
<p/>
</div>
<div class="page"><p/>
<p>336 Appendix B: Solutions to Exercises
</p>
<p>We thus get
</p>
<p>s̃2w =
1
</p>
<p>10
(4 &middot; 6.8025+ 4 &middot; 0.956875+ 2 &middot; 1.5625) = 3.41625.
</p>
<p>The total variance is therefore s̃2 = s̃2w + s̃2b = 3.41625+ 38.08735 &asymp; 41.5.
The results will typically differ if we do not know the raw data: we have to
</p>
<p>replace the arithmetic means within each class, x̄ j , with the middle of each class
</p>
<p>a j , i.e. a1 = 10, a2 = 17.5, a3 = 25:
</p>
<p>s̃2b =
1
</p>
<p>10
([4 &middot; (10&minus; 17.32)2] + [4 &middot; (17.5&minus; 17.32)2]
</p>
<p>+[2 &middot; (25&minus; 17.32)2]) = 33.2424.
We further get
</p>
<p>s̃21 =
1
</p>
<p>4
[(7.6&minus; 10)2 + &middot; &middot; &middot; + (14.8&minus; 10)2] = 9.865,
</p>
<p>s̃22 =
1
</p>
<p>4
[(16.2&minus; 17.5)2 + &middot; &middot; &middot; + (18.5&minus; 17.5)2] = 0.9225,
</p>
<p>s̃23 =
1
</p>
<p>2
[(27.4&minus; 25)2 + (29.9&minus; 25)2] = 1.5625,
</p>
<p>and
</p>
<p>s̃2w =
1
</p>
<p>10
(4 &middot; 9.865+ 4 &middot; 0.9225+ 2 &middot; 14.885) = 7.292.
</p>
<p>The variance is s̃2 = s̃2w + s̃2b = 7.292+ 33.2424 &asymp; 40.5. The approximation
is therefore good. However, please note that the between-class variance was
</p>
<p>estimated too low, but the within-class variance was estimated too high; only
</p>
<p>the combination of the two variance components led to reasonable results in this
</p>
<p>example. It is evident that the approximation in the third class was not ideal. The
</p>
<p>middle of the interval, 25, was not a good proxy for the true mean in this class,
</p>
<p>28.65.
</p>
<p>(h) It is easy to calculate the mean and the median:
</p>
<p>distance &lt;- c(12.5,29.9,...,17.5)
</p>
<p>altitude &lt;- c(342,1245,...,466)
</p>
<p>mean(distance)
</p>
<p>mean(altitude)
</p>
<p>median(distance)
</p>
<p>median(altitude)
</p>
<p>We can use the quantile function, together with the probs option, to get the
</p>
<p>quantiles:</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 337
</p>
<p>quantile(distance,probs=0.75)
</p>
<p>quantile(distance,probs=0.25)
</p>
<p>quantile(altitude,probs=0.75)
</p>
<p>quantile(altitude,probs=0.25)
</p>
<p>However, the reader will see that the results differ slightly from our results
</p>
<p>obtained in (b). As noted in Example 3.1.5, R offers nine different ways to obtain
</p>
<p>quantiles, each of which can be chosen by the type argument. The difference
</p>
<p>between these options cannot be understood easily without a background in
</p>
<p>probability theory. It may, however, be worth highlighting that we get the same
</p>
<p>results as in (b) if we choose the type=2 option in this example. The interquartile
</p>
<p>ranges can be calculated by means of the difference of the quantiles obtained
</p>
<p>above. To determine the mean absolute deviation, we have to program our own
</p>
<p>function:
</p>
<p>amd &lt;- function(mv){1/length(mv)*sum(abs(mv-median(mv)))}
</p>
<p>amd(distance)
</p>
<p>amd(altitude)
</p>
<p>We can calculate the variance using the var command. However, as noted in
</p>
<p>Example 3.2.4, on p. 52, R uses 1/(n &minus; 1) rather than 1/n when calculating the
variance. This important alternative formula for variance estimation is explained
</p>
<p>in Chap. 9, Theorem 9.2.1. To obtain the results from (c), we hence need to
</p>
<p>multiply the output from R by (n &minus; 1)/n:
</p>
<p>var(altitude)*9/10
</p>
<p>var(distance)*9/10
</p>
<p>The box plots can be drawn by using the boxplot command:
</p>
<p>boxplot(altitude)
</p>
<p>boxplot(distance)
</p>
<p>The weighted mean is obtained as follows:
</p>
<p>weighted.mean(c(10,17.5,25),c(4/10,4/10,2/10))</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>338 Appendix B: Solutions to Exercises
</p>
<p>Solution to Exercise 3.2
</p>
<p>(a) We need to solve the equation that defines the arithmetic mean:
</p>
<p>x̄ = 1
n
</p>
<p>&sum;
</p>
<p>i
</p>
<p>xi
</p>
<p>&minus;90 = 1
10
</p>
<p>(200+ 600&minus; 200&minus; 200&minus; 200&minus; 100&minus; 100&minus; 400+ 0+ R)
</p>
<p>&minus;90 = 1
10
</p>
<p>(&minus;400+ R)
&rArr; R = &minus;500.
</p>
<p>(b) The mode is x̄M = &minus;200. Using nα = 2.5 and nα = 7.5, respectively, we can
determine the quartiles as follows:
</p>
<p>x̃0.25 = x(3) = &minus;200,
x̃0.75 = x(8) = 0.
</p>
<p>The interquartile range is dQ = 0&minus; (&minus;200) = 200.
(c) It is not possible to use the coefficient of variation because some of the values
</p>
<p>are negative.
</p>
<p>Solution to Exercise 3.3 We calculate
</p>
<p>nm = n &minus; nw &minus; nc = 100&minus; 45&minus; 20 = 35.
Using the formula for the arithmetic mean for grouped data,
</p>
<p>x̄ = 1
n
(nw x̄w + nm x̄m + nc x̄c),
</p>
<p>we further get
</p>
<p>x̄m =
1
</p>
<p>nm
(nx̄ &minus; nw x̄w &minus; nc x̄c)
</p>
<p>= 1
35
</p>
<p>(100 &middot; 15&minus; 45 &middot; 16&minus; 20 &middot; 7.5) = 18.
</p>
<p>Similarly, we can use the Theorem of Variance Decomposition, Eq. (3.27), to calcu-
</p>
<p>late the variance for the grouped data:
</p>
<p>s2 = s2w + s2b =
1
</p>
<p>n
(nws
</p>
<p>2
w + nms2m + ncs2c )
</p>
<p>+1
n
</p>
<p>(
</p>
<p>nw(x̄w &minus; x̄)2 + nm(x̄m &minus; x̄)2 + nc(x̄c &minus; x̄)2
)
</p>
<p>.
</p>
<p>This yields
</p>
<p>s2m =
1
</p>
<p>nm
</p>
<p>[
</p>
<p>ns2 &minus; nws2w &minus; ncs2c &minus; nw(x̄w &minus; x̄)2 &minus; nm(x̄m &minus; x̄)2 &minus; nc(x̄c &minus; x̄)2
]
</p>
<p>= 1
35
</p>
<p>(100 &middot; 19.55&minus; 45 &middot; 6&minus; 20 &middot; 3&minus; 45 &middot; 12 &minus; 35 &middot; 32 &minus; 20 &middot; 7.52) = 4.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 339
</p>
<p>Solution to Exercise 3.4
</p>
<p>(a) We evaluate a period of 6 years which means that T = 0, 1, 2, 3, 4, 5. To deter-
mine the average growth rate, we need to first calculate the geometric mean.
</p>
<p>There are two options to facilitate this:
</p>
<p>(i) Solution:
</p>
<p>Bt/Bt&minus;1 = (&minus;, 1.04, 1.125, 0.925, 1.2, 0.933)
x̄G = (1.04 &middot; 1.125 &middot; 0.925 &middot; 1.2 &middot; 0.933)1/5 = 1.04.
</p>
<p>(ii) Easier solution:
</p>
<p>x̄G = (28/23)1/5 = 1.04.
</p>
<p>Since x̄G = 1.04, the average growth rate is r = 1.04&minus; 1 = 4 %.
(b) To predict the number of members in 2018, we could apply the average growth
</p>
<p>rate to the number of members in 2016 for two consecutive years:
</p>
<p>B2018 = x̄G B2017, B2017 = x̄G B2016, &rArr; B2018 = x̄2G B2016
B2018 = 1.042 &middot; 28 = 30.28 &asymp; 31.
</p>
<p>(c) We could use the approach outlined in (b) to predict the number of members
</p>
<p>in 2025. However, this assumes that the average growth rate between 2011 and
</p>
<p>2016 remains valid until 2025. This is rather unrealistic. The number ofmembers
</p>
<p>of the club increases in some years, but decreases in other years. There is no
</p>
<p>guarantee that the pattern observed until 2016 can be generalized to the future.
</p>
<p>This highlights that statistical methodology should in general be used with care
</p>
<p>when making long-term future predictions.
</p>
<p>(d) The invested money is
&sum;
</p>
<p>i xi =e 250 million. We deal with partially grouped
data because the club&rsquo;s members invest in groups, but the invested sum is clearly
</p>
<p>defined and not part of a group or interval. We can thus summarize the data as
</p>
<p>follows:
</p>
<p>(i) 1 2 3 4
</p>
<p>Number of members 10 8 8 4
</p>
<p>Rel. number of members f j 10/30 8/30 8/30 4/30
</p>
<p>ũi =
&sum;
</p>
<p>j f j 10/30 18/30 26/30 1
</p>
<p>Money invested xi 40 60 70 80
</p>
<p>Rel. amount per group 40/250 60/250 70/250 80/250
</p>
<p>vi 40/250 100/250 170/250 1
</p>
<p>The Lorenz curve is plotted in Fig. B.8.</p>
<p/>
</div>
<div class="page"><p/>
<p>340 Appendix B: Solutions to Exercises
</p>
<p>ui
</p>
<p>v
i
</p>
<p>0 10/30 18/30 26/30 1
</p>
<p>0
</p>
<p>4/25
</p>
<p>10/25
</p>
<p>17/25
</p>
<p>1
</p>
<p>Fig. B.8 Lorenz curve
</p>
<p>(e) The Gini coefficient can be calculated using formula (3.37) as follows:
</p>
<p>G = 1&minus; 1
30
</p>
<p>(10(0+ 4/25)+ 8(4/25+ 2/5)+ 8(2/5+ 17/25)
</p>
<p>+ 4(17/25+ 1)) = 1&minus; 268/375 = 107/375 = 0.2853.
</p>
<p>G+
(3.39)= 30/29 &middot; 107/375 = 214/725 = 0.2952.
</p>
<p>The concentration of investment is thus rather weak.
</p>
<p>Solution to Exercise 3.5 Let us look at Fig. 3.8b first. The quantiles coincide approx-
</p>
<p>imately with the bisection line. This means that the distribution of &ldquo;length of service&rdquo;
</p>
<p>is similar for men and women. They have worked for about the same amount of time
</p>
<p>for the company. For example, the median service time should be approximately
</p>
<p>the same for men and women, the first quartile should be very similar too, the third
</p>
<p>quartile should be similar too, and so on. However, Fig. 3.8a shows a somewhat dif-
</p>
<p>ferent pattern: the quantiles for men are consistently higher than those for women.
</p>
<p>For example, the median salary will be higher for men. In conclusion, we see that
</p>
<p>men and women have a similar length of service in the company, but earn less.
</p>
<p>Solution to Exercise 3.6 There are many ways in which a &ldquo;mode&rdquo; function can be
</p>
<p>programmed.We present a simple and understandable solution, not themost efficient
</p>
<p>one. Recall that table constructs a frequency table. This table shows immediately
</p>
<p>which value(s) occur(s) most often in the data. How can we extract it? Applying the</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 341
</p>
<p>0 0.8 1
0
</p>
<p>0.1
</p>
<p>1
</p>
<p>(a) For Exercise 3.7 a)
</p>
<p>0 0.2 1
00
</p>
<p>1
</p>
<p>(b) For Exercise 3.7 b)
</p>
<p>0 1
0
</p>
<p>1
</p>
<p>(c) For Exercise 3.7 c)
</p>
<p>Fig. B.9 Lorenz curves
</p>
<p>names function on the table returns the names of the values represented in the table.
</p>
<p>The only thing we need to do is to choose the name which corresponds to the value
</p>
<p>which has been counted most. This yields the following function:
</p>
<p>mymode &lt;- function(vec){
</p>
<p>mt &lt;- table(vec)
</p>
<p>names(mt)[mt == max(mt)]
</p>
<p>}
</p>
<p>This function will work in general, though it returns a character vector. Using
</p>
<p>as.numeric is one option to make the character string numeric, if necessary.
</p>
<p>Solution to Exercise 3.7
</p>
<p>(a) In this exercise, we do not have individual data; i.e. we do not know how much
</p>
<p>each inhabitant earns. The summarized data simply tells us about the wealth
</p>
<p>of two groups. For simplicity and for illustrative purposes, we assume that the
</p>
<p>wealth is equally distributed in each group. We determine (ũi , ṽi ) as (0.8, 0.1)
</p>
<p>and (1, 1) because 80 % of the population earn 10 % of the wealth and 100 %
</p>
<p>of the population earn everything. The respective Lorenz curve is illustrated in
</p>
<p>Fig. B.9a.
</p>
<p>(b) The upper class lost its wealth. This means that 20 % of the population do not
</p>
<p>own anything at all. However, the remaining 80 % owns the rest. This yields
</p>
<p>(ũi , ṽi ) of (0.2, 0) and (1, 1), see also Fig. B.9b.
</p>
<p>(c) In this scenario, 20%of the population leave the country.However, the remaining
</p>
<p>80 %&mdash;which are now 100 % of the population&mdash;earn the rest. The money is
</p>
<p>equally distributed between the population. Figure B.9c shows this situation.</p>
<p/>
</div>
<div class="page"><p/>
<p>342 Appendix B: Solutions to Exercises
</p>
<p>Solution to Exercise 3.8
</p>
<p>(a) It is necessary to use the harmonic mean to calculate the average speed. Using
</p>
<p>w1 = n1/n = 180/418 &asymp; 0.43, w2 = 117/418 &asymp; 0.28, and w3 = 121/418 &asymp;
0.29 we get
</p>
<p>x̄H =
1
</p>
<p>&sum;k
i=1
</p>
<p>wi
xi
</p>
<p>= 1
0.43/48+ 0.28/37+ 0.29/52 &asymp; 45.2 km/h.
</p>
<p>(b) Travelling at 45.2 km/h means travelling about 361 km in 8 h. The bus will not
</p>
<p>be in time.
</p>
<p>Solution to Exercise 3.9
</p>
<p>(a) The sum of investment is
&sum;
</p>
<p>i xi = e18, 020. To calculate and draw the Lorenz
curve, we need the following table:
</p>
<p>(i) 1 2 3 4
</p>
<p>investment xi 800 2220 4700 10300
</p>
<p>f j 1/4 1/4 1/4 1/4
</p>
<p>ui 1/4 2/4 3/4 1
</p>
<p>relative investment 0.044 0.123 0.261 0.572
</p>
<p>vi 0.044 0.168 0.428 1
</p>
<p>The curve is presented in Fig. B.10.
</p>
<p>(b) We can calculate the Gini coefficient as follows:
</p>
<p>G
(3.37)= 1&minus; 1
</p>
<p>4
[(0+ 0.044)+ (0.044+ 0.168)+ (0.168+ 0.428)
</p>
<p>+ (0.428+ 1)] = 1&minus; 1
4
&middot; 2.28 = 0.43.
</p>
<p>G+
(3.39)= n
</p>
<p>n &minus; 1G =
4
</p>
<p>3
&middot; 0.43 = 0.57.
</p>
<p>(c) The Gini coefficient remains the same as the relative investment stays the same.
</p>
<p>(d) Using the library ineq we can easily reproduce the results in R:
</p>
<p>library(ineq)
</p>
<p>investment &lt;- c(800,10300,4700,2200)
</p>
<p>plot(Lc(investment))
</p>
<p>ineq(investment)</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 343
</p>
<p>ui
</p>
<p>v
i
</p>
<p>0 0.25 0.5 0.75 1
</p>
<p>0
</p>
<p>0.044
</p>
<p>0.168
</p>
<p>0.428
</p>
<p>1
</p>
<p>Fig. B.10 Lorenz curve for investment sum
</p>
<p>However, please note that the ineq command calculates the unstandardized
</p>
<p>Gini coefficient.
</p>
<p>Solution to Exercise 3.10
</p>
<p>(a) The easiest way to get all these measures is to use the summary function and
</p>
<p>apply it to the data columns which relate to quantitative variables:
</p>
<p>setwd('C:/yourpath')
</p>
<p>pizza &lt;- read.csv('pizza_delivery.csv')
</p>
<p>attach(pizza)
</p>
<p>summary(pizza[,c('time','temperature','bill','pizzas')])
</p>
<p>We then get the following output:
</p>
<p>time temperature bill pizzas
</p>
<p>Min. :12.27 Min. :41.76 Min. : 9.10 Min. : 1.000
</p>
<p>1st Qu.:30.06 1st Qu.:58.24 1st Qu.:35.50 1st Qu.: 2.000
</p>
<p>Median :34.38 Median :62.93 Median :42.90 Median : 3.000
</p>
<p>Mean :34.23 Mean :62.86 Mean :42.76 Mean : 3.013
</p>
<p>3rd Qu.:38.58 3rd Qu.:67.23 3rd Qu.:50.50 3rd Qu.: 4.000
</p>
<p>Max. :53.10 Max. :87.58 Max. :75.00 Max. :11.000</p>
<p/>
</div>
<div class="page"><p/>
<p>344 Appendix B: Solutions to Exercises
</p>
<p>(b) We can use the quantile function:
</p>
<p>quantile(time,probs=0.99)
</p>
<p>quantile(temperature,probs=0.99)
</p>
<p>The results are 48.62 min for delivery time and 79.87 ◦C for temperature. This
means 99 % of the delivery times are less than or equal to 48.62 min and 1 % of
</p>
<p>deliveries are greater than or equal to 48.62 min. Similarly, only 1 % of pizzas
</p>
<p>were delivered with a temperature greater than 79.87 ◦C.
</p>
<p>(c) The following simple function calculates the absolute mean deviation:
</p>
<p>amdev &lt;- function(mv){1/length(mv)*sum(abs(mv-mean(mv)))}
</p>
<p>amdev(temperature)
</p>
<p>(d) We can use the scale, mean, and var commands, respectively.
</p>
<p>sc.time &lt;- scale(time)
</p>
<p>mean(sc.time)
</p>
<p>var(sc.time)
</p>
<p>As one would expect, the mean is zero and the variance is 1 for the scaled
</p>
<p>variable.
</p>
<p>(e) The boxplot command draws a box plot; the range option specifies the range
</p>
<p>for which extreme values are defined. As specified in the help files, range=0
</p>
<p>produces a box plot with no extreme values.
</p>
<p>boxplot(temperature,range=0)
</p>
<p>boxplot(time,range=0)
</p>
<p>The box plots are displayed in Fig. B.11.
</p>
<p>(f) We use the cut command to create a variable which has the categories (10, 20],
(20, 30], (30, 40], (40, 50], (50, 60], respectively.Using the intervalmid-points,
as well as the relative frequencies in each class (obtained via the table com-
</p>
<p>mand), we get:
</p>
<p>tc &lt;- cut(time,breaks=seq(10,60,10))
</p>
<p>weighted.mean(c(15,25,35,45,55),table(tc)/sum(table(tc)))
</p>
<p>[1] 34.18641
</p>
<p>mean(time)
</p>
<p>[1] 34.22955
</p>
<p>The weighted mean is very similar to the mean from the raw data, see output
</p>
<p>above.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 345
</p>
<p>3
0
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>7
0
</p>
<p>8
0
</p>
<p>9
0
</p>
<p>1
0
0
</p>
<p>T
e
m
</p>
<p>p
e
ra
</p>
<p>tu
re
</p>
<p>(a) For temperature
</p>
<p>1
0
</p>
<p>2
0
</p>
<p>3
0
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>D
e
liv
</p>
<p>e
ry
</p>
<p> T
im
</p>
<p>e
 (
</p>
<p>in
 m
</p>
<p>in
u
te
</p>
<p>s
)
</p>
<p>(b) For delivery time
</p>
<p>Fig. B.11 Box plots
</p>
<p>(g) The plots can be reproduced by using the qqplot command:
</p>
<p>qqplot(time[driver=='Luigi'],time[driver=='Domenico'])
</p>
<p>qqplot(time[driver=='Mario'],time[driver=='Salvatore'])
</p>
<p>Chapter 4
</p>
<p>Solution to Exercise 4.1
</p>
<p>(a) We need the following table to calculate the correlation coefficient R:
</p>
<p>Caf&eacute; (i) xi R(xi ) yi R(yi ) di d
2
i
</p>
<p>1 3 1 6 2 &minus;1 1
2 8 4 7 3 1 1
</p>
<p>3 7 3 10 5 &minus;2 4
4 9 5 8 4 1 1
</p>
<p>5 5 2 4 1 1 1
</p>
<p>R = 1&minus;
6
&sum;n
</p>
<p>i=1 d
2
i
</p>
<p>n(n2 &minus; 1) = 1&minus;
6(1+ 1+ 4+ 1+ 1)
</p>
<p>5(25&minus; 1) = 1&minus; 0.4 = 0.6.
</p>
<p>There is a moderate-to-strong positive correlation between the ratings of the two
</p>
<p>coffee enthusiasts. In general, a high rating from one staff member implies a
</p>
<p>rather high rating from the other staff member.
</p>
<p>(b) Above we have assigned ranks in an increasing order; i.e. the lowest xi/yi gets
</p>
<p>the lowest rank (1) and the highest xi/yi gets the highest rank (5). If we use</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>346 Appendix B: Solutions to Exercises
</p>
<p>decreasing order and assign the lowest rank to the highest values, we get the
</p>
<p>following results:
</p>
<p>Caf&eacute; (i) xi R(xi ) yi R(yi ) di d
2
i
</p>
<p>1 3 5 6 4 1 1
</p>
<p>2 8 2 7 3 &minus;1 1
3 7 3 10 1 2 4
</p>
<p>4 9 1 8 2 &minus;1 1
5 5 4 4 5 &minus;1 1
</p>
<p>As in (a), we have
&sum;
</p>
<p>i d
2
i = 8 and therefore, the results are identical: R = 0.6.
</p>
<p>Depending on whether ranks are assigned in an increasing order or a decreasing
</p>
<p>order, the sign of di differs, but the calculation of R is not affected since the
</p>
<p>squared values of di are used for its calculation and the sign of di is thus not
</p>
<p>important.
</p>
<p>(c) We can summarize the ratings in a 2&times; 2 table:
</p>
<p>X Y
</p>
<p>Coffee Bad 2 1
</p>
<p>Quality Good 3 4
</p>
<p>The odds ratio is O R = (2&times; 4)/(3&times; 1) = 2. The chance of rating a coffee as
good is twice as likely for person X compared to person Y .
</p>
<p>Solution to Exercise 4.2
</p>
<p>(a) The expected frequencies (under independence) are:
</p>
<p>Satisfied Unsatisfied
</p>
<p>Car 74&middot;58150 = 28.61
76&middot;58&middot;
150 = 29.39
</p>
<p>Car (diesel engine) 74&middot;60150 = 29.6
76&middot;60
150 = 30.4
</p>
<p>Motorbike 74&middot;32150 = 15.79
76&middot;32
150 = 16.21</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 347
</p>
<p>We therefore have
</p>
<p>χ2 =
k
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>l
&sum;
</p>
<p>j=1
</p>
<p>(
</p>
<p>ni j &minus; ni+n+ jn
)2
</p>
<p>ni+n+ j
n
</p>
<p>= (33&minus; 28.61)
2
</p>
<p>28.61
+ (25&minus; 29.39)
</p>
<p>2
</p>
<p>29.39
+ (29&minus; 29.6)
</p>
<p>2
</p>
<p>29.6
</p>
<p>+ (31&minus; 30.4)
2
</p>
<p>30.4
+ (12&minus; 15.79)
</p>
<p>2
</p>
<p>15.79
+ (20&minus; 16.21)
</p>
<p>2
</p>
<p>16.21
= 0.6736+ 0.6557+ 0.0122+ 0.0112+ 0.9097+ 0.8861 = 3.1485.
</p>
<p>The maximum value χ2 can take is 150(2&minus; 1) = 150 which indicates that there
is almost no association between type of vehicle and satisfaction with the insur-
</p>
<p>ance. The other measures can be calculated as follows:
</p>
<p>V =
</p>
<p>&radic;
</p>
<p>χ2
</p>
<p>n(min(k, l)&minus; 1) =
&radic;
</p>
<p>3.1485
</p>
<p>150(2&minus; 1) = 0.14.
</p>
<p>Ccorr:
</p>
<p>Ccorr =
&radic;
</p>
<p>min(k, l)
</p>
<p>min(k, l)&minus; 1
</p>
<p>&radic;
</p>
<p>χ2
</p>
<p>χ2 + n =
</p>
<p>=
&radic;
</p>
<p>2
</p>
<p>1
</p>
<p>&radic;
</p>
<p>3.1485
</p>
<p>3.1485+ 150 =
&radic;
2
&radic;
0.02056 &asymp; 0.20.
</p>
<p>The small values of V and Ccorr confirm that the association is rather weak.
</p>
<p>(b) The summarized table looks as follows:
</p>
<p>Satisfied Unsatisfied
</p>
<p>Car 62 56
</p>
<p>Motorbike 12 20
</p>
<p>Using (4.7), we obtain
</p>
<p>χ2 = n(ad &minus; bc)
2
</p>
<p>(a + d)(c + d)(a + c)(b + d)
</p>
<p>= 150(1240&minus; 672)
2
</p>
<p>118 &middot; 32 &middot; 74 &middot; 76 =
48, 393, 600
</p>
<p>21, 236, 224
&asymp; 2.2788.
</p>
<p>The maximum value χ2 can take is 150(2&minus; 1). The association is therefore
weak. The odds ratio is
</p>
<p>O R = ad
bc
</p>
<p>= 62 &middot; 20
12 &middot; 56 =
</p>
<p>1240
</p>
<p>672
&asymp; 1.845.
</p>
<p>The chances of being satisfied with the insurance are 1.845 times higher among
</p>
<p>those who drive a car.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>348 Appendix B: Solutions to Exercises
</p>
<p>Fig. B.12 Scatter diagram
</p>
<p>for speed limit and number
</p>
<p>of deaths
</p>
<p>50 55 60 65 70 75 80
</p>
<p>3
.0
</p>
<p>3
.5
</p>
<p>4
.0
</p>
<p>4
.5
</p>
<p>5
.0
</p>
<p>5
.5
</p>
<p>6
.0
</p>
<p>speed limit (miles/h)
</p>
<p>d
e
a
th
</p>
<p>s
(c) All χ2-based statistics suggest that there is only a small association between the
</p>
<p>two variables, for both the 2&times; 3 and the 2&times; 2 tables. However, the odds ratio
gives us a more nuanced interpretation, showing that customers driving a car
</p>
<p>are somewhat more satisfied with their insurance. The question is whether the
</p>
<p>additional information from the odds ratio is stable and trustworthy. Confidence
</p>
<p>intervals for the odds ratio can provide guidance under such circumstances, see
</p>
<p>Sect. 9.4.4 for more details.
</p>
<p>Solution to Exercise 4.3
</p>
<p>(a) The scatter plot is given inFig.B.12. The black circles show thefive observations.
</p>
<p>A positive relationship can be discovered: the higher the speed limit, the higher
</p>
<p>the number of deaths. However, &ldquo;Italy&rdquo; (the observation on the top right) is the
</p>
<p>observation which gives the graph a visible pattern and drives our impression
</p>
<p>about the potential relationship.
</p>
<p>(b) Using x̄ = 61 and ȳ = 4.86 we obtain
Sxx = (55&minus; 61)2 + (55&minus; 61)2 + &middot; &middot; &middot; + (75&minus; 61)2 = 270
Syy = (4.1&minus; 4.86)2 + (4.7&minus; 4.86)2 + &middot; &middot; &middot; + (6.1&minus; 4.86)2 = 2.512
Sxy = (55&minus; 61)(4.1&minus; 4.86)+ &middot; &middot; &middot; + (75&minus; 61)(6.1&minus; 4.86) = 23.2</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 349
</p>
<p>and therefore
</p>
<p>r = Sxy&radic;
Sxx Syy
</p>
<p>23.2&radic;
270 &middot; 2.512
</p>
<p>= 0.891.
</p>
<p>The correlation coefficient of Spearman is calculated using the following table:
</p>
<p>Country (i) xi R(xi ) yi R(yi ) di d
2
i
</p>
<p>Denmark 55 4.5 4.1 5 &minus;0.5 0.25
Japan 55 4.5 4.7 3 1.5 2.25
</p>
<p>Canada 60 2.5 4.3 4 &minus;1.5 2.25
Netherlands 60 2.5 5.1 2 0.5 0.25
</p>
<p>Italy 75 1 6.1 1 0 0
</p>
<p>This yields
</p>
<p>R = 1&minus;
6
&sum;n
</p>
<p>i=1 d
2
i
</p>
<p>n(n2 &minus; 1) = 1&minus;
6 &middot; 5
</p>
<p>5(25&minus; 1) = 0.75.
</p>
<p>Please note that above we averaged the ranks for ties. The R function cor uses a
</p>
<p>more complicated approach; this is why the results differ slightly when using R.
</p>
<p>(c) The results stay the same. Pearson&rsquo;s correlation coefficient is invariant with
</p>
<p>respect to linear transformations which means that it does not matter whether
</p>
<p>we use miles/h or km/h.
</p>
<p>(d) (i) The grey square in Fig. B.12 represents the additional observation. The
</p>
<p>overall pattern of the scatter plot changes with this new observation pair:
</p>
<p>the positive relationship between speed limit and number of traffic deaths
</p>
<p>is not so clear anymore. This emphasizes how individual observations may
</p>
<p>affect our impression of a scatter plot.
</p>
<p>(ii) Based on the same approach as in (b), we can calculate x̄ = 62.5, ȳ =
4.6333, Sxx = 337.5, Syy = 4.0533, Sxy = 13, and r = 0.3515. A single
observation changes our conclusions from a strong positive relationship
</p>
<p>to a moderate-to-weak relationship. It is evident that Pearson&rsquo;s correlation
</p>
<p>coefficient is volatile and may be affected heavily by outliers or extreme
</p>
<p>observations.
</p>
<p>Solution to Exercise 4.4
</p>
<p>(a) The contingency table for the absolute frequencies is as follows:
</p>
<p>1. Class 2. Class 3. Class Staff Total
</p>
<p>Rescued 202 125 180 211 718
</p>
<p>Not rescued 135 160 541 674 1510
</p>
<p>Total 337 285 721 885 2228</p>
<p/>
</div>
<div class="page"><p/>
<p>350 Appendix B: Solutions to Exercises
</p>
<p>(b) To obtain the conditional relative frequency distributions, we calculate the pro-
</p>
<p>portion of passengers rescued (X ) for each travel class (Y ). In the notation of
</p>
<p>Definition 4.1.1, we determine f
X |Y
</p>
<p>i | j = fi j/ f+ j = ni j/n+ j for all i and j . For
example, frescued|1. class = 202/337 = 0.5994. This yields
</p>
<p>1. Class 2. Class 3. Class Staff
</p>
<p>Rescued 0.5994 0.4386 0.2497 0.2384
</p>
<p>Not rescued 0.4006 0.5614 0.7503 0.7616
</p>
<p>It is evident that the proportion of passengers being rescued differs by travel
</p>
<p>class. It can be speculated that there is an association between the two variables
</p>
<p>pointing towards better chances of being rescued among passengers from higher
</p>
<p>travel classes.
</p>
<p>(c) Using (4.3), we get
</p>
<p>1. Class 2. Class 3. Class Staff Total
</p>
<p>Rescued 108.6 91.8 232.4 285.2 718
</p>
<p>Not rescued 228.4 193.2 488.6 599.8 1510
</p>
<p>Total 337 285 721 885 2228
</p>
<p>which can be used to calculate χ2 and V as follows:
</p>
<p>χ2 =
k
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>l
&sum;
</p>
<p>j=1
</p>
<p>(
</p>
<p>ni j &minus; ni+n+ jn
)2
</p>
<p>ni+n+ j
n
</p>
<p>= (202&minus; 108.6)
2
</p>
<p>108.6
+ (125&minus; 91.8)
</p>
<p>2
</p>
<p>91.8
</p>
<p>+ (180&minus; 232.4)
2
</p>
<p>232.4
+ (211&minus; 285.2)
</p>
<p>2
</p>
<p>285.2
+ (135&minus; 228.4)
</p>
<p>2
</p>
<p>228.4
</p>
<p>+ (160&minus; 193.2)
2
</p>
<p>193.2
+ (541&minus; 488.6)
</p>
<p>2
</p>
<p>488.6
+ (674&minus; 599.8)
</p>
<p>2
</p>
<p>599.8
= 80.33+ 12.01+ 11.82+ 19.30+ 38.19+ 5.71+ 5.62+ 9.18
= 182.16.
</p>
<p>V =
</p>
<p>&radic;
</p>
<p>χ2
</p>
<p>n(min(k, l)&minus; 1) =
&radic;
</p>
<p>182.16
</p>
<p>2228(2&minus; 1) = 0.286.
</p>
<p>The value of V indicates a moderate or weak relationship between the two
</p>
<p>variables. This is in contradiction to the hypothesis derived from the conditional
</p>
<p>distributions in (b).
</p>
<p>(d) The table is as follows:
</p>
<p>1. Class/2. Class 3. Class/Staff Total
</p>
<p>Rescued 327 391 718
</p>
<p>Not rescued 295 1215 1510
</p>
<p>Total 622 1606 2228</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 351
</p>
<p>Using (4.7) we get
</p>
<p>χ2 = 2228(327 &middot; 1215&minus; 295 &middot; 391)
2
</p>
<p>718 &middot; 1510 &middot; 622 &middot; 1606 = 163.55.
</p>
<p>and therefore V =
&radic;
</p>
<p>163.55
2228 = 0.271.
</p>
<p>There are several relative risks that can be calculated, for example:
</p>
<p>f1|1
f1|2
</p>
<p>= n11/n+1
n12/n+2
</p>
<p>= 327/622
391/1606
</p>
<p>&asymp; 2.16,
</p>
<p>f2|1
f2|2
</p>
<p>= n21/n+1
n22/n+2
</p>
<p>= 295/622
1215/1606
</p>
<p>&asymp; 0.63.
</p>
<p>The proportion of passengerswhowere rescuedwas 2.16 times higher in the 1./2.
</p>
<p>class compared to the 3. class and staff. Similarly, the proportion of passengers
</p>
<p>who were not rescued was 0.62 times lower in the 1./2. class compared to the 3.
</p>
<p>class and staff. The odds ratio is O R = a&middot;d
b&middot;c =
</p>
<p>397,305
115,345 = 3.444. This is nothing
</p>
<p>but the ratio of the relative risks, i.e. 2.16/0.63. The chance of being rescued
</p>
<p>(i.e. the ratio rescued/not rescued) was almost 3.5 times higher for the 1./2. class
</p>
<p>compared to the 3. class and staff.
</p>
<p>(e) While Cramer&rsquo;s V led to rather conservative conclusions regarding a possible
</p>
<p>relationship of travel class and rescue status, the conditional relative frequency
</p>
<p>distribution, the relative risks, and the odds ratio support the hypothesis that, at
</p>
<p>least to some degree, the chances of being rescued were higher in better travel
</p>
<p>classes. This makes sense because better travel classes were located towards the
</p>
<p>top of the ship with best access to the lifeboats while both third-class passengers
</p>
<p>and large numbers of the staff were located and working in the bottom of the
</p>
<p>ship, where the water came in first.
</p>
<p>Solution to Exercise 4.5
</p>
<p>(a) Using (4.17) and (4.18), we get
</p>
<p>r = Sxy&radic;
Sxx Syy
</p>
<p>=
&sum;36
</p>
<p>i=1 xi yi &minus; 36x̄ ȳ
&radic;
</p>
<p>ns̃2x ns̃
2
y
</p>
<p>= 22776&minus; 36 &middot; 12.22 &middot; 51.28
n
&radic;
</p>
<p>s̃2x s̃
2
y
</p>
<p>= 216.9
36
&radic;
76.95 &middot; 706.98
</p>
<p>&asymp; 0.026.
</p>
<p>This indicates that there is no linear relationship between temperature and hotel
</p>
<p>occupancy.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>352 Appendix B: Solutions to Exercises
</p>
<p>(b) The scatter plot shows no clear pattern. This explains why the correlation coeffi-
</p>
<p>cient is close to 0. However, if we look only at the points for each city separately,
</p>
<p>we see different structures for different cities: a possible negative relationship
</p>
<p>for Davos (D), a rather positive relationship for Polenca (P) and no visible rela-
</p>
<p>tionship for Basel (B). This makes sense because for winter holiday destinations
</p>
<p>hotel occupancy should be higher when the temperature is low and for summer
</p>
<p>holiday destinations occupancy should be high in the summer months.
</p>
<p>(c) We type in the data by specifying three variables: temperature (X), occu-
</p>
<p>pancy (Y ) and city (Z). We then simply use the cor command to calculate
</p>
<p>the correlation&mdash;and condition on the values of Z which we are interested in:
</p>
<p>X &lt;- c(-6,-5,2,...,9,4)
</p>
<p>Y &lt;- c(91,89,76,...,9,12)
</p>
<p>Z &lt;- c(rep('Davos',12),rep('Polenca',12),rep('Basel',12))
</p>
<p>cor(X[Z=='Davos'],Y[Z=='Davos'])
</p>
<p>cor(X[Z=='Basel'],Y[Z=='Basel'])
</p>
<p>cor(X[Z=='Polenca'],Y[Z=='Polenca'])
</p>
<p>This yields correlation coefficients of&minus;0.87 for Davos, 0.42 for Basel and 0.82
for Polenca. It is obvious that looking at X and Y only indicates no correlation,
</p>
<p>but the information from Z shows strong linear relationships in subgroups. This
</p>
<p>example shows the limitations of using correlation coefficients and the necessity
</p>
<p>to think in a multivariate way. Regression models offer solutions. We refer the
</p>
<p>reader to Chap. 11, in particular Sect. 11.7.3 for more details.
</p>
<p>Solution to Exercise 4.6
</p>
<p>(a) We use the visual rule of thumb and work from the top left to the bottom right for
</p>
<p>the concordant pairs and from the top right to the bottom left for the discordant
</p>
<p>pairs:
</p>
<p>K = 82 &middot; 43+ 82 &middot; 9+ 82 &middot; 2+ 82 &middot; 10+ 8 &middot; 2+ 8 &middot; 10+ 4 &middot; 10+ 4 &middot; 9
+43 &middot; 10 = 5850
</p>
<p>D = 4 &middot; 8+ 9 &middot; 2 = 50
</p>
<p>γ = K &minus; D
K + D =
</p>
<p>5800
</p>
<p>5900
= 0.98.
</p>
<p>(b)
</p>
<p>χ2 =
k
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>l
&sum;
</p>
<p>j=1
</p>
<p>(
</p>
<p>ni j &minus;
ni+n+ j
</p>
<p>n
</p>
<p>)2
</p>
<p>ni+n+ j
n
</p>
<p>=
(82&minus; 86&middot;90158 )2
</p>
<p>86&middot;90
158
</p>
<p>+
(4&minus; 49&middot;86158 )2
</p>
<p>49&middot;86
158</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 353
</p>
<p>+
(0&minus; 19&middot;86158 )2
</p>
<p>19&middot;86
158
</p>
<p>+
(8&minus; 90&middot;60158 )2
</p>
<p>90&middot;60
158
</p>
<p>+
(43&minus; 49&middot;60158 )2
</p>
<p>49&middot;60
158
</p>
<p>+
(9&minus; 60&middot;19158 )2
</p>
<p>60&middot;19
158
</p>
<p>+
(0&minus; 12&middot;90158 )2
</p>
<p>12&middot;90
158
</p>
<p>+
(2&minus; 12&middot;49158 )2
</p>
<p>12&middot;49
158
</p>
<p>+
(10&minus; 12&middot;19158 )2
</p>
<p>12&middot;19
158
</p>
<p>= 22.25.19.27+ 10.34+ 20.05+ 31.98+ 0.47+ 6.84+ 0.80+ 50.74
= 162.74.
</p>
<p>V =
</p>
<p>&radic;
</p>
<p>χ2
</p>
<p>n(min(k, l)&minus; 1) =
&radic;
</p>
<p>162.74
</p>
<p>158 &middot; 2 &asymp; 0.72.
</p>
<p>(c) The table is as follows:
</p>
<p>Use a leash
</p>
<p>Agree or no. Disagree Total
</p>
<p>Use for concerts Agree or no. 137 9 146
</p>
<p>Disagree 2 10 12
</p>
<p>Total 139 19 158
</p>
<p>(d) The relative risk can either be summarized as:
</p>
<p>2/139
</p>
<p>10/19
&asymp; 0.03 or 10/19
</p>
<p>2/139
&asymp; 36.6.
</p>
<p>The proportion of those who disagree with using the park for summer concerts is
</p>
<p>0.03 times lower in the group who agree or have no opinion about using leashes
</p>
<p>for dogs compared to those who disagree. Similarly, the proportion of those who
</p>
<p>disagree with using the park for summer concerts is 36.6 times higher in the
</p>
<p>group who also disagree with using leashes for dogs compared to those who do
</p>
<p>not disagree.
</p>
<p>(e) The odds ratio is OR = (137 &middot; 10)/(2 &middot; 9) &asymp; 36.1.
</p>
<p>&bull; The chance of not disagreeing with the concert proposal is 36.1 times higher
for those who also do not disagree with the leash proposal.
</p>
<p>&bull; The chance of not disagreeing with the leash proposal is 36.1 times higher for
those who also do not disagree with the concert proposal.
</p>
<p>&bull; In simpler words: The chance of agreeing or having no opinion for one of the
questions is 36.1 times higher if the person also has no opinion or agrees with
</p>
<p>the other question.
</p>
<p>(f)
</p>
<p>γ = 137 &middot; 10&minus; 9 &middot; 2
137 &middot; 10+ 9 &middot; 2 =
</p>
<p>1352
</p>
<p>1388
= 0.974.</p>
<p/>
</div>
<div class="page"><p/>
<p>354 Appendix B: Solutions to Exercises
</p>
<p>(g) In general, it makes sense to use all the information available, i.e. to use the
</p>
<p>ordinal structure of the data and all three categories. While it is clear that γ is
</p>
<p>superior to V in our example, one may argue that the relative risks or the odds
</p>
<p>ratio could be more useful because they provide an intuitive quantification on
</p>
<p>how the two variables relate to each other rather than just giving a summary
</p>
<p>of strength and direction of association. However, as we have seen earlier, the
</p>
<p>interpretations of the relative risks and the odds ratio are quite clumsy in this
</p>
<p>example. It can be difficult to follow the somewhat complicated interpretation.
</p>
<p>A simple summary would be to say that agreement with both questions was
</p>
<p>strongly associated (γ = 0.98).
</p>
<p>Solution to Exercise 4.7 We use the definition of the correlation coefficient, replace
</p>
<p>yi with a + bxi and replace ȳ with a + bx̄ to obtain
</p>
<p>r =
&sum;n
</p>
<p>i=1(xi &minus; x̄)(a + bxi &minus; (a + bx̄))
&radic;
&sum;n
</p>
<p>i=1(xi &minus; x̄)2
&sum;n
</p>
<p>i=1(a + bxi &minus; (a + bx̄))2
.
</p>
<p>This equates to:
</p>
<p>r =
&sum;n
</p>
<p>i=1(xi &minus; x̄)(b(xi &minus; x̄))
&radic;
&sum;n
</p>
<p>i=1(xi &minus; x̄)2
&sum;n
</p>
<p>i=1(b(xi &minus; x̄))2
=
</p>
<p>b
&sum;n
</p>
<p>i=1(xi &minus; x̄)2
&radic;
</p>
<p>b2
&sum;n
</p>
<p>i=1(xi &minus; x̄)2
&sum;n
</p>
<p>i=1(xi &minus; x̄)2
= 1.
</p>
<p>Solution to Exercise 4.8
</p>
<p>(a) We read in the data, make sure the first column is recognized as containing the
</p>
<p>row names, attach the data, and obtain the correlation using the cor command:
</p>
<p>decathlon &lt;- read.csv('decathlon.csv', row.names=1)
</p>
<p>attach(decathlon)
</p>
<p>cor(X.Discus,X.High.jump)
</p>
<p>The correlation is 0.52984. This means there is a moderate-to-strong positive
</p>
<p>correlation; i.e. the longer the distance the discus is thrown, the higher the height
</p>
<p>in the high jump competition.
</p>
<p>(b) There are 10 variables. For the first variable, we can calculate the correlationwith
</p>
<p>9 other variables. For the second variable, we can also calculate the correlation
</p>
<p>with 9 other variables. However, we have already calculated one out of the
</p>
<p>9 correlations, i.e. when analysing variable number one. So it is sufficient to
</p>
<p>calculate 8 correlations for the second variable. Similarly, we need another 7
</p>
<p>correlations for the third variable, 6 correlations for the fourth variable, and so on.
</p>
<p>In total, we therefore need to have 9+ 8+ 7+ &middot; &middot; &middot; + 1 = 45 correlations. Since
the correlation coefficient describes the relationship between two variables, it</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 355
</p>
<p>Fig. B.13 Correlation matrix
</p>
<p>for the decathlon data
</p>
<p>1
</p>
<p>&minus;0.7
</p>
<p>&minus;0.37
</p>
<p>&minus;0.31
</p>
<p>0.63
</p>
<p>0.54
</p>
<p>&minus;0.23
</p>
<p>&minus;0.26
</p>
<p>&minus;0.01
</p>
<p>0.06
</p>
<p>&minus;0.7
</p>
<p>1
</p>
<p>0.2
</p>
<p>0.35
</p>
<p>&minus;0.67
</p>
<p>&minus;0.54
</p>
<p>0.25
</p>
<p>0.29
</p>
<p>0.09
</p>
<p>&minus;0.15
</p>
<p>&minus;0.37
</p>
<p>0.2
</p>
<p>1
</p>
<p>0.61
</p>
<p>&minus;0.2
</p>
<p>&minus;0.25
</p>
<p>0.67
</p>
<p>0.02
</p>
<p>0.38
</p>
<p>0.13
</p>
<p>&minus;0.31
</p>
<p>0.35
</p>
<p>0.61
</p>
<p>1
</p>
<p>&minus;0.17
</p>
<p>&minus;0.33
</p>
<p>0.52
</p>
<p>&minus;0.04
</p>
<p>0.2
</p>
<p>0
</p>
<p>0.63
</p>
<p>&minus;0.67
</p>
<p>&minus;0.2
</p>
<p>&minus;0.17
</p>
<p>1
</p>
<p>0.52
</p>
<p>&minus;0.14
</p>
<p>&minus;0.12
</p>
<p>&minus;0.05
</p>
<p>0.55
</p>
<p>0.54
</p>
<p>&minus;0.54
</p>
<p>&minus;0.25
</p>
<p>&minus;0.33
</p>
<p>0.52
</p>
<p>1
</p>
<p>&minus;0.22
</p>
<p>&minus;0.15
</p>
<p>&minus;0.08
</p>
<p>0.18
</p>
<p>&minus;0.23
</p>
<p>0.25
</p>
<p>0.67
</p>
<p>0.52
</p>
<p>&minus;0.14
</p>
<p>&minus;0.22
</p>
<p>1
</p>
<p>&minus;0.18
</p>
<p>0.25
</p>
<p>0.22
</p>
<p>&minus;0.26
</p>
<p>0.29
</p>
<p>0.02
</p>
<p>&minus;0.04
</p>
<p>&minus;0.12
</p>
<p>&minus;0.15
</p>
<p>&minus;0.18
</p>
<p>1
</p>
<p>&minus;0.07
</p>
<p>0.18
</p>
<p>&minus;0.01
</p>
<p>0.09
</p>
<p>0.38
</p>
<p>0.2
</p>
<p>&minus;0.05
</p>
<p>&minus;0.08
</p>
<p>0.25
</p>
<p>&minus;0.07
</p>
<p>1
</p>
<p>&minus;0.25
</p>
<p>0.06
</p>
<p>&minus;0.15
</p>
<p>0.13
</p>
<p>0
</p>
<p>0.55
</p>
<p>0.18
</p>
<p>0.22
</p>
<p>0.18
</p>
<p>&minus;0.25
</p>
<p>1
</p>
<p>X
.1
</p>
<p>0
0
</p>
<p>m
</p>
<p>X
.L
</p>
<p>o
n
</p>
<p>g
.j
u
</p>
<p>m
p
</p>
<p>X
.S
</p>
<p>h
o
</p>
<p>t.
p
</p>
<p>u
t
</p>
<p>X
.H
</p>
<p>ig
h
</p>
<p>.j
u
</p>
<p>m
p
</p>
<p>X
.4
</p>
<p>0
0
</p>
<p>m
</p>
<p>X
.1
</p>
<p>1
0
</p>
<p>m
.h
</p>
<p>u
rd
</p>
<p>le
</p>
<p>X
.D
</p>
<p>is
c
u
</p>
<p>s
</p>
<p>X
.P
</p>
<p>o
le
</p>
<p>.v
a
</p>
<p>u
lt
</p>
<p>X
.J
</p>
<p>a
v
e
</p>
<p>lin
e
</p>
<p>X
.1
</p>
<p>5
0
</p>
<p>0
m
</p>
<p>X.100m
</p>
<p>X.Long.jump
</p>
<p>X.Shot.put
</p>
<p>X.High.jump
</p>
<p>X.400m
</p>
<p>X.110m.hurdle
</p>
<p>X.Discus
</p>
<p>X.Pole.vault
</p>
<p>X.Javeline
</p>
<p>X.1500m
</p>
<p>makes sense to summarize the results in a contingency table, similar to a matrix,
</p>
<p>see Fig. B.13.
</p>
<p>(c) Using cor(decathlon) yields the correlation coefficients between all variable
</p>
<p>pairs. This ismuch simpler than calculating the correlation coefficient for each of
</p>
<p>the 45 comparisons.Note that the correlationmatrix provides the 45 comparisons
</p>
<p>both in the upper triangle and in the lower triangle of the table. We know that
</p>
<p>r(X, Y ) = r(Y, X), but R still provides us with both, although they are identical.
Note that the diagonal elements are 1 because r(X, X) = 1.
</p>
<p>(d) One way to omit rows with missing data automatically is to use the na.omit
</p>
<p>command:
</p>
<p>cor(na.omit(decathlon))
</p>
<p>The results are displayed in Fig. B.13. We see moderate-to-strong correlations
</p>
<p>between the 100 m race, 400 m race, 110 m hurdle race and long jump. This
</p>
<p>may reflect the speed-and-athletic component of the decathlon contest. We also
</p>
<p>see moderate-to-strong correlations between the shot-put, high jump, and discus
</p>
<p>events. This may reflect the strength-and-technique component of the contest.
</p>
<p>The other disciplines also show correlations which make sense, but they are
</p>
<p>rather weak and may reflect the uniqueness of these disciplines.</p>
<p/>
</div>
<div class="page"><p/>
<p>356 Appendix B: Solutions to Exercises
</p>
<p>Solution to Exercise 4.9
</p>
<p>(a) A possible code is listed below:
</p>
<p>pizza &lt;- read.csv('pizza_delivery.csv')
</p>
<p>pizza$tempcat &lt;- cut(pizza$temperature, breaks=c(0,65,100))
</p>
<p>pizza$timecat &lt;- cut(pizza$time, breaks=c(0,30,100))
</p>
<p>attach(pizza)
</p>
<p>addmargins(table(tempcat,timecat))
</p>
<p>timecat
</p>
<p>tempcat (0,30] (30,100] Sum
</p>
<p>(0,65] 101 691 792
</p>
<p>(65,100] 213 261 474
</p>
<p>Sum 314 952 1266
</p>
<p>We can see that there is a higher proportion of high temperature ((65, 100]) in
the category of short delivery times ((0, 30]) compared to long delivery times
((30, 100]).
</p>
<p>(b) Using the data from (a), we can calculate the odds ratio:
</p>
<p>(101&lowast;261)/(213&lowast;691)
</p>
<p>Thus, the chances of receiving a cold pizza are 0.18 lower if the delivery time is
</p>
<p>short.
</p>
<p>(c) We use the vcd and ryouready packages to determine the desired measures of
</p>
<p>association:
</p>
<p>library(vcd)
</p>
<p>library(ryouready)
</p>
<p>library(lattice)
</p>
<p>assocstats(xtabs(&sim;tempcat+timecat))
ord.gamma(table(tempcat,timecat))
</p>
<p>ord.tau(table(tempcat,timecat))
</p>
<p>barchart(table(tempcat,timecat),horizontal=F,stack=T)</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 357
</p>
<p>tempcat
</p>
<p>a
b
s
o
lu
</p>
<p>te
 f
re
</p>
<p>q
u
e
n
c
ie
</p>
<p>s
</p>
<p>0
</p>
<p>200
</p>
<p>400
</p>
<p>600
</p>
<p>800
</p>
<p>(0,65] (65,100]
</p>
<p>timecat
(0,30] (30,100]
</p>
<p>(a) Stacked bar chart for the catego-
rical time and temperature variables
</p>
<p>20 30 40 50
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>7
0
</p>
<p>8
0
</p>
<p>Time
</p>
<p>T
e
m
</p>
<p>p
e
ra
</p>
<p>tu
re
</p>
<p>(b) Scatter plot for temperature and
time
</p>
<p>Bruno Domenico Luigi Mario Salvatore
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>7
0
</p>
<p>8
0
</p>
<p>Driver
</p>
<p>T
e
m
</p>
<p>p
e
ra
</p>
<p>tu
re
</p>
<p>(c) Temperature by driver
</p>
<p>Laura Melissa
</p>
<p>4
0
</p>
<p>5
0
</p>
<p>6
0
</p>
<p>7
0
</p>
<p>8
0
</p>
<p>Operator
</p>
<p>T
e
m
</p>
<p>p
e
ra
</p>
<p>tu
re
</p>
<p>(d) Temperature by operator
</p>
<p>Fig. B.14 Plots for Exercise 4.9
</p>
<p>Cramer&rsquo;s V is 0.361, Stuart&rsquo;s τc is &minus;0.302, and γ is &minus;0.696. The first two
measures indicate a moderate-to-weak relationship between temperature and
</p>
<p>delivery time. It is clear from the last two measures that this relationship is
</p>
<p>negative, i.e. that shorter delivery times imply higher temperatures. However,
</p>
<p>interestingly, τc and γ provide us with a different strengths of association. In
</p>
<p>any case, it is clear that for shorter delivery times the customers receive warmer
</p>
<p>pizzas, as evident from the stacked bar chart (Fig. B.14a).
</p>
<p>(d) The scatter plot (Fig. B.14b) shows a decreasing temperature for an increasing
</p>
<p>delivery time. This is also highlighted in the correlation coefficients which are
</p>
<p>&minus;0.43 and &minus;0.39 for Bravais&ndash;Pearson and Spearman, respectively.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>358 Appendix B: Solutions to Exercises
</p>
<p>plot(time,temperature)
</p>
<p>cor(time,temperature)
</p>
<p>cor(time,temperature,method='spearman')
</p>
<p>(e) It makes sense to compare continuous variables (temperature, number of pizzas,
</p>
<p>bill) using the correlation coefficient from Bravais&ndash;Pearson. The relationships
</p>
<p>between temperature and driver and operator could be visualized using stratified
</p>
<p>box plots.
</p>
<p>boxplot(temperature&sim;driver)
boxplot(temperature&sim;operator)
cor(temperature,pizzas)
</p>
<p>cor(temperature,bill)
</p>
<p>The correlation coefficients are &minus;0.37 and &minus;0.42 for number of pizzas and
bill, respectively. More pizzas and a higher bill are associated with a lower
</p>
<p>temperature. The box plots (Fig. B.14c, d) show variation in the delivery times
</p>
<p>of the different drivers, but almost identical delivery times for the two operators.
</p>
<p>These results give us a first idea about the relationship in the data. However,
</p>
<p>they do not tell us the full story. For example: is the pizza temperature for higher
</p>
<p>bills low because a higher bill means more pizzas, and therefore, a less efficient
</p>
<p>preparation of the food? Is one driver faster because he mainly delivers for a
</p>
<p>particular branch? Could it be that the operators have a different performance
</p>
<p>but because they deal with different branches and drivers, these differences are
</p>
<p>not visible? To address these questions, a multivariate perspective is needed.
</p>
<p>Regression models, as introduced in Chap. 11, provide some answers.
</p>
<p>Chapter 5
</p>
<p>Solution to Exercise 5.1 There are n = 10 guests and m = 2 guests shake hands
with each other. The order is not important: two guests shake hands no matter who
</p>
<p>is &ldquo;drawn first&rdquo;. It is also not possible to shake hands with oneself which means that
</p>
<p>in terms of the urn model, we have the &ldquo;no replacement&rdquo; case. Therefore, we obtain
</p>
<p>the solution as (
n
</p>
<p>m
</p>
<p>)
</p>
<p>=
(
10
</p>
<p>2
</p>
<p>)
</p>
<p>= 10 &middot; 9
2 &middot; 1 = 45
</p>
<p>handshakes in total.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_5">http://dx.doi.org/10.1007/978-3-319-46162-5_5</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 359
</p>
<p>Solution to Exercise 5.2 We assume that it is not relevant to know which student
</p>
<p>gets tested at which time point. We are thus dealing with combinations without
</p>
<p>considering the order. We have n = 25 and m = 5 and therefore obtain:
</p>
<p>(a) a total number of
(25
5
</p>
<p>)
</p>
<p>= 53,130 possibilities.
</p>
<p>(b) a total number of
(25+5&minus;1
</p>
<p>5
</p>
<p>)
</p>
<p>=
(29
5
</p>
<p>)
</p>
<p>= 118,755 possibilities.
</p>
<p>In R, the commands choose(25,5) and choose(29,5), respectively provide the
</p>
<p>required results.
</p>
<p>Solution to Exercise 5.3 The board consists of n = 381 knots. Each knot is either
occupied or not. We may thus assume a &ldquo;drawing&rdquo; without replacement in the sense
</p>
<p>that each knot can be drawn (occupied) only once. If we place m = 64 counters on
the board, then we can simultaneously think of &ldquo;drawing&rdquo; 64 occupied knots out of
</p>
<p>a total of 381 knots. The order in which we draw is not relevant&mdash;either a knot is
</p>
<p>occupied or not. The total number of combinations is
(
</p>
<p>n
m
</p>
<p>)
</p>
<p>=
(381
64
</p>
<p>)
</p>
<p>&asymp; 4.35 &middot; 1073. We
obtain the final number in R using the command choose(381,64).
</p>
<p>Solution to Exercise 5.4 We obtain the results (again using the command
</p>
<p>choose(n,m) in R) as follows:
</p>
<p>(a) The customer takes the beers &ldquo;with replacement&rdquo; because the customer can
</p>
<p>choose among any type of beer for each position in the tray. One can also think
</p>
<p>of an urn model with 6 balls relating to the six different beers, where beers are
</p>
<p>drawn with replacement and placed on the tray. The order in which the beers are
</p>
<p>placed on the tray is not relevant. We thus have
(
</p>
<p>n + m &minus; 1
m
</p>
<p>)
</p>
<p>=
(
6+ 20&minus; 1
</p>
<p>20
</p>
<p>)
</p>
<p>=
(
25
</p>
<p>20
</p>
<p>)
</p>
<p>= 53, 130
</p>
<p>combinations.
</p>
<p>(b) If the customer insists on having at least one beer per brewery on his tray, then
</p>
<p>6 out of the 20 positions of the tray are already occupied. Based on the same
</p>
<p>thoughts as in (a), we calculate the total number of combinations as
(
</p>
<p>n + m &minus; 1
m
</p>
<p>)
</p>
<p>=
(
6+ 14&minus; 1
</p>
<p>14
</p>
<p>)
</p>
<p>=
(
19
</p>
<p>14
</p>
<p>)
</p>
<p>= 11, 628.
</p>
<p>Solution to Exercise 5.5 Since each team has exactly one final place, we have a
</p>
<p>&ldquo;without replacement&rdquo; situation. Using n = 32 and m = 3 (and choose(n,m) in R)
yields</p>
<p/>
</div>
<div class="page"><p/>
<p>360 Appendix B: Solutions to Exercises
</p>
<p>(a) 32!
(32&minus;3)! =
</p>
<p>(32
3
</p>
<p>)
</p>
<p>3! = 29, 760 and
</p>
<p>(b)
(32
3
</p>
<p>)
</p>
<p>= 4960.
</p>
<p>Solution to Exercise 5.6 There are n = 12 different letters for m = 4 positions of
the membership code. Each letter can be used more than once if desired and we
</p>
<p>thus obtain nm = 124 = 20,736 possible combinations. We therefore conclude that
</p>
<p>sufficient membership codes are left. However, this may not last long and the book
</p>
<p>store may still wish to create another solution for its membership codes.
</p>
<p>Solution to Exercise 5.7 For each member of the jury, there are 61 scoring options:
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
</p>
<p>1 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9
</p>
<p>. . .
</p>
<p>. . .
</p>
<p>5 5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9
</p>
<p>6
</p>
<p>Different jury members are allowed to assign the same scores. We thus deal with
</p>
<p>combinations &ldquo;with replacement&rdquo;. To verify this, just think of an urn with 61 balls
</p>
<p>where each ball refers to one possible score. Now one ball is drawn, assigned to a
</p>
<p>specific jury member and then put back into the urn. Since each score is &ldquo;attached&rdquo;
</p>
<p>to a particular jury member, we have combinations with consideration of the order
</p>
<p>and therefore obtain a total of nm = 619 &asymp; 1.17 &middot; 1016 possibilities. If you have
difficulties in understanding the role of &ldquo;replacement&rdquo; and &ldquo;order&rdquo; in this example,
</p>
<p>recall that each member has 61 scoring options: thus, 61&times; 61&times; &middot; &middot; &middot; &times; 61 (9 times)
combinations are possible.
</p>
<p>Solution to Exercise 5.8
</p>
<p>(a) We obtain:
(
2
</p>
<p>0
</p>
<p>)
</p>
<p>= 1 &harr;
(
</p>
<p>n
</p>
<p>2
</p>
<p>)
</p>
<p>=
(
2
</p>
<p>2
</p>
<p>)
</p>
<p>= 1;
(
3
</p>
<p>1
</p>
<p>)
</p>
<p>= 3 &harr;
(
</p>
<p>n
</p>
<p>2
</p>
<p>)
</p>
<p>=
(
3
</p>
<p>2
</p>
<p>)
</p>
<p>= 3;
(
4
</p>
<p>2
</p>
<p>)
</p>
<p>= 6 &harr;
(
</p>
<p>n
</p>
<p>2
</p>
<p>)
</p>
<p>=
(
4
</p>
<p>2
</p>
<p>)
</p>
<p>= 6;
(
5
</p>
<p>3
</p>
<p>)
</p>
<p>= 10 &harr;
(
</p>
<p>n
</p>
<p>2
</p>
<p>)
</p>
<p>=
(
5
</p>
<p>2
</p>
<p>)
</p>
<p>= 10.
</p>
<p>(b) Based on the observations from (a) we conclude that each entry on the diagonal
</p>
<p>line can be represented by
(
</p>
<p>n
2
</p>
<p>)
</p>
<p>. The sum of two consecutive entries is thus
(
</p>
<p>n
2
</p>
<p>)
</p>
<p>+</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 361
</p>
<p>(
n+1
2
</p>
<p>)
</p>
<p>. Using the fourth relation in (5.5), it follows that:
(
</p>
<p>n
</p>
<p>2
</p>
<p>)
</p>
<p>+
(
</p>
<p>n + 1
2
</p>
<p>)
</p>
<p>(5.5)= n(n &minus; 1)
2
</p>
<p>+ (n + 1)n
2
</p>
<p>= n(n &minus; 1+ n + 1)
2
</p>
<p>= n &middot; 2n
2
</p>
<p>= n2.
</p>
<p>Chapter 6
</p>
<p>Solution to Exercise 6.1
</p>
<p>(a) We obtain
</p>
<p>&bull; A &cap; B = {8}.
&bull; B &cap; C = {&empty;}.
&bull; A &cap; C = {0, 4, 8, 9, 15}.
&bull; C \ A = {4, 9, 15}.
&bull; Ω \ (B &cup; A &cup; C) = {6, 7, 11, 13, 14}.
</p>
<p>(b) The solutions are:
</p>
<p>&bull; P(F̄) = 1&minus; P(F) = 0.5.
&bull; P(G) = 1&minus; P(E)&minus; P(F) = 0.3.
&bull; P(E &cap; G) = 0 because the events are pairwise disjoint.
&bull; P(E \ E) = 0.
&bull; P(E &cup; F) = P(E)+ P(F) = 0.7.
</p>
<p>Solution to Exercise 6.2 We know that the probability of failing the practical exam-
</p>
<p>ination is P(P E) = 0.25, of failing the theoretical examination is P(T E) = 0.15,
and of failing both is P(P E &cap; T E) = 0.1.
</p>
<p>(a) If we ask for the probability of failing in at least one examination, we imply
</p>
<p>that either the theoretical examination, or the practical examination, or both
</p>
<p>are not passed. We can therefore calculate the union of events P(P E &cup; T E) =
P(P E)+ P(T E)&minus; P(T E &cap; P E) = 0.25+ 0.15&minus; 0.1 = 0.3.
</p>
<p>(b) P(P E\T E) = P(P E)&minus; P(P E &cap; T E) = 0.25&minus; 0.1 = 0.15.
(c) P(P E &cup; T E) = 1&minus; P(P E &cup; T E) = 1&minus; 0.3 = 0.7.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_5">http://dx.doi.org/10.1007/978-3-319-46162-5_5</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_6">http://dx.doi.org/10.1007/978-3-319-46162-5_6</a></div>
</div>
<div class="page"><p/>
<p>362 Appendix B: Solutions to Exercises
</p>
<p>(d) We are interested in the probability of the person failing exactly in one exam.This
</p>
<p>corresponds to P(M\C &cup; C\M) = P(M &cup; C)&minus; P(C &cap; M) = 0.3&minus; 0.1 =
0.2.
</p>
<p>Solution to Exercise 6.3 The total number of possible simple events is |�| = 12. The
number of favourable simple events is
</p>
<p>(a) |A| = 6 (i.e. the numbers 2, 4, 6, 8, 10, 12). Hence, P(A) = 612 =
1
2 .
</p>
<p>(b) |B| = 3 (i.e. the numbers 10, 11, 12). Hence, P(B) = 312 =
1
4 .
</p>
<p>(c) |C | = 2 (i.e. the numbers 10, 12). Hence, P(A &cap; B) = 212 =
1
6 .
</p>
<p>(d) |D| = 7 (i.e. the numbers 2, 4, 6, 8, 10, 11, 12). Hence, P(A &cup; B) = 712 .
</p>
<p>Solution to Exercise 6.4 The total number of simple events is
(12
2
</p>
<p>)
</p>
<p>.
</p>
<p>(a) The number of favourable simple events is one and therefore P(right two
</p>
<p>presents) = |A||�| =
1
</p>
<p>(122 )
&asymp; 0.015.
</p>
<p>(b) The number of favourable simple events is
(10
2
</p>
<p>)
</p>
<p>because the person draws two
</p>
<p>presents out of the ten &ldquo;wrong&rdquo; presents:
</p>
<p>P(wrong two presents) = |A||�| =
(10
2
</p>
<p>)
</p>
<p>/
(12
2
</p>
<p>)
</p>
<p>&asymp; 0.682. InSect. 8.1.8,we explain
the hypergeometric distribution which will shed further light on this exercise.
</p>
<p>Solution to Exercise 6.5
</p>
<p>(a) Let V denote the event that there is too much salt in the soup and let L denote
</p>
<p>the event that the chef is in love. We know that
</p>
<p>P(V ) = 0.2 &rArr; P(V̄ ) = 0.8.
Similarly, we have
</p>
<p>P(L) = 0.3 &rArr; P(L̄) = 0.7.
We therefore get:
</p>
<p>P(V &cap; L) = P(V |L) &middot; P(L) = 0.6 &middot; 0.3 = 0.18.
P(V̄ &cap; L) = P(L)&minus; P(V &cap; L) = 0.3&minus; 0.18 = 0.12.
P(V &cap; L̄) = P(V )&minus; P(V &cap; L) = 0.2&minus; 0.18 = 0.02.
P(V̄ &cap; L̄) = P(V̄ )&minus; P(V̄ &cap; L) = 0.8&minus; 0.12 = 0.68.
</p>
<p>This yields the following contingency table:</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 363
</p>
<p>V V̄ Total
</p>
<p>L 0.18 0.12 0.3
</p>
<p>L̄ 0.02 0.68 0.7
</p>
<p>Total 0.2 0.8 1
</p>
<p>(b) The variables are not stochastically independent since, for example, P(V ) &middot;
P(L) = 0.3 &middot; 0.2 = 0.06 �= 0.18 = P(V &cap; L).
</p>
<p>Solution to Exercise 6.6
</p>
<p>(a) We define the following events: G = Basil is treated well, Ḡ = Basil is not
treated well; E = Basil survives, Ē = Basil dies. We know that
</p>
<p>P(Ḡ) = 1
3
&rArr; P(G) = 2
</p>
<p>3
; P(E |G) = 1
</p>
<p>2
; P(E |Ḡ) = 3
</p>
<p>4
.
</p>
<p>Using the Law of Total Probability, we get
</p>
<p>P(E) = P(E |G) &middot; P(G)+ P(E |Ḡ) &middot; P(Ḡ)
</p>
<p>= 1
2
&middot; 2
3
+ 3
</p>
<p>4
&middot; 1
3
= 1
</p>
<p>3
+ 1
</p>
<p>4
= 7
</p>
<p>12
&asymp; 0.58.
</p>
<p>(b) We can use Bayes&rsquo; Theorem to answer the question:
</p>
<p>P(Ḡ|E) = P(E |Ḡ) &middot; P(Ḡ)
P(E |Ḡ) &middot; P(Ḡ)+ P(E |G) &middot; P(G)
</p>
<p>=
3
4 &middot;
</p>
<p>1
3
</p>
<p>7
12
</p>
<p>= 3
7
&asymp; 0.43.
</p>
<p>Solution to Exercise 6.7 We define the following events and probabilities
</p>
<p>&bull; A: Bill never paid, P(A) = 0.05 &rArr; P( Ā) = 0.95.
&bull; M: Bill paid too late, P(M) = ?
&bull; P(M | Ā) = 0.2.
&bull; P(M |A) = 1 because someone who never pays will always pay too late.
</p>
<p>(a) We are interested in P(M), the probability that someone does not pay his bill in
</p>
<p>a particular month, either because he is not able to or he pays too late. We can
</p>
<p>use the Law of Total Probability to obtain the results:
</p>
<p>P(M) = P(M |A)P(A)+ P(M | Ā)P( Ā)
= 0.05 &middot; 1+ 0.2 &middot; 0.95 = 0.24.</p>
<p/>
</div>
<div class="page"><p/>
<p>364 Appendix B: Solutions to Exercises
</p>
<p>(b) We can use Bayes&rsquo; Theorem to obtain the results:
</p>
<p>P(A | M) = P(A)P(M | A)
P(M)
</p>
<p>= 0.05
0.24
</p>
<p>= 0.208.
</p>
<p>(c) If the bill was not paid in a particular month, the probability is 20.8 % that it will
</p>
<p>never be paid, and 78.2 % that it will be paid. One could argue that a preventive
</p>
<p>measure that affects almost 79 % of trustworthy customers are not ideal and the
</p>
<p>bank should therefore not block a credit card if a bill is not paid on time.
</p>
<p>Solution to Exercise 6.8
</p>
<p>(a) The &ldquo;and&rdquo; operator refers to the joint distribution of two variables. In our exam-
</p>
<p>ple, we want to know the probability of being infected and having been trans-
</p>
<p>ported by the truck. This probability can be directly obtained from the respective
</p>
<p>entry in the contingency table: 40 out of 200 cows fulfil both criteria and thus
</p>
<p>P(B &cap; A) = 40
200
</p>
<p>.
</p>
<p>(b) We can use P(A) = 100200 = P( Ā) to obtain:
</p>
<p>P(B|A) = P(B &cap; A)
P(A)
</p>
<p>= 40/200
100/200
</p>
<p>= 40
100
</p>
<p>.
</p>
<p>(c) Using these results and P(B) = 60200 , and P(B̄) =
140
200 = 1&minus; P(B), we obtain
</p>
<p>P(B| Ā) = P(B &cap; Ā)
P( Ā)
</p>
<p>= 20/200
100/200
</p>
<p>= 20
100
</p>
<p>by using the Law of Total Probability. We can thus calculate
</p>
<p>P(B) = P(B|A)P(A)+ P(B| Ā)P( Ā)
= 0.40 &middot; 0.50+ 0.20 &middot; 0.50 = 0.30.
</p>
<p>This means that the probability of a cow being infected is 30 %. Alternatively,
</p>
<p>we could have simply looked at the marginal distribution of the contingency
</p>
<p>table to get P(B) = 60/200 = 0.3.
</p>
<p>Solution to Exercise 6.9
</p>
<p>(a) The two shots are independent of each other and thus
</p>
<p>P(A &cap; B) = 0.4 &middot; 0.5 = 0.2.
P(A &cup; B) = 0.4+ 0.5&minus; 0.2 = 0.7.
</p>
<p>(b) We need to calculate
</p>
<p>P(A\B &cup; B\A) = 0.4&minus; 0.2+ 0.5&minus; 0.2 = 0.5.
</p>
<p>(c)
</p>
<p>P(B\A) = 0.5&minus; 0.2 = 0.3.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 365
</p>
<p>Chapter 7
</p>
<p>Solution to Exercise 7.1
</p>
<p>(a) The first derivative of the CDF yields the PDF, F &prime;(x) = f (x):
</p>
<p>f (x) =
</p>
<p>⎧
</p>
<p>⎨
</p>
<p>⎩
</p>
<p>0 if x &lt; 2
</p>
<p>&minus; 12 x + 2 if 2 &le; x &le; 4
0 if x &gt; 4.
</p>
<p>(b) We know from Theorem 7.2.3 that for any continuous variable P(X = x0) = 0
and therefore P(X = 4) = 0. We calculate P(X &lt; 3) = P(X &le; 3)&minus; P(X =
3) = F(3)&minus; 0 = &minus; 94 + 6&minus; 3 = 0.75.
</p>
<p>(c) Using (7.15), we obtain the expectation as
</p>
<p>E(X) =
&int; &infin;
</p>
<p>&minus;&infin;
x f (x) dx =
</p>
<p>&int; 2
</p>
<p>&minus;&infin;
x0 dx +
</p>
<p>&int; 4
</p>
<p>2
</p>
<p>x
</p>
<p>(
</p>
<p>&minus;1
2
</p>
<p>x + 2
)
</p>
<p>dx +
&int; &infin;
</p>
<p>4
</p>
<p>x0 dx
</p>
<p>= 0+
&int; 4
</p>
<p>2
</p>
<p>(
</p>
<p>&minus;1
2
</p>
<p>x2 + 2x
)
</p>
<p>dx + 0
</p>
<p>=
[
</p>
<p>&minus;1
6
</p>
<p>x3 + x2
]4
</p>
<p>2
</p>
<p>=
(
</p>
<p>&minus;64
6
</p>
<p>+ 16
)
</p>
<p>&minus;
(
</p>
<p>&minus;8
6
+ 4
</p>
<p>)
</p>
<p>= 8
3
.
</p>
<p>Given that we have already calculated E(X), we can use Theorem 7.3.1 to cal-
</p>
<p>culate the variance as Var(X) = E(X2)&minus; [E(X)]2. The expectation of X2 is
</p>
<p>E(X2) =
&int; 4
</p>
<p>2
</p>
<p>x2
(
</p>
<p>&minus;1
2
</p>
<p>x + 2
)
</p>
<p>dx =
&int; 4
</p>
<p>2
</p>
<p>(
</p>
<p>&minus;1
2
</p>
<p>x3 + 2x2
)
</p>
<p>dx
</p>
<p>=
[
</p>
<p>&minus;1
8
</p>
<p>x4 + 2
3
</p>
<p>x3
]4
</p>
<p>2
</p>
<p>=
(
</p>
<p>&minus;32+ 128
3
</p>
<p>)
</p>
<p>&minus;
(
</p>
<p>&minus;2+ 16
3
</p>
<p>)
</p>
<p>= 22
3
.
</p>
<p>We thus obtain Var(X) = 223 &minus;
(
8
3
</p>
<p>)2 = 66&minus;649 =
2
9 .
</p>
<p>Solution to Exercise 7.2
</p>
<p>(a) The probability mass function of X is
</p>
<p>xi 1 2 3 4 5 6
</p>
<p>P(X = x) 19
1
9
</p>
<p>1
9
</p>
<p>2
9
</p>
<p>1
9
</p>
<p>3
9
</p>
<p>Using (7.16), we calculate the expectation as
</p>
<p>E(X) = 1 &middot; 1
9
+ 2 &middot; 1
</p>
<p>9
+ 3 &middot; 1
</p>
<p>9
+ 4 &middot; 2
</p>
<p>9
+ 5 &middot; 1
</p>
<p>9
+ 6 &middot; 3
</p>
<p>9
</p>
<p>= 1+ 2+ 3+ 8+ 5+ 18
9
</p>
<p>= 37
9
</p>
<p>&asymp; 4.1.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>366 Appendix B: Solutions to Exercises
</p>
<p>To obtain the variance, we need
</p>
<p>E(X2) = 1 &middot; 1
9
+ 4 &middot; 1
</p>
<p>9
+ 9 &middot; 1
</p>
<p>9
+ 16 &middot; 2
</p>
<p>9
+ 25 &middot; 1
</p>
<p>9
+ 36 &middot; 3
</p>
<p>9
</p>
<p>= 1+ 4+ 9+ 32+ 25+ 108
9
</p>
<p>= 179
9
</p>
<p>.
</p>
<p>Therefore, using Var(X) = E(X2)&minus; [E(X)]2, we get
</p>
<p>Var(X) = 179
9
</p>
<p>&minus;
(
37
</p>
<p>9
</p>
<p>)2
</p>
<p>= 1611&minus; 1369
81
</p>
<p>= 242
81
</p>
<p>&asymp; 2.98.
</p>
<p>The manipulated die yields on average higher values than a fair die because its
</p>
<p>expectation is 4.1 &gt; 3.5. The variability of is, however, similar because 2.98 &asymp;
2.92.
</p>
<p>(b) The probability mass function of Y = 1
X
is:
</p>
<p>yi = 1xi 1
1
2
</p>
<p>1
3
</p>
<p>1
4
</p>
<p>1
5
</p>
<p>1
6
</p>
<p>P( 1
X
= y) 19
</p>
<p>1
9
</p>
<p>1
9
</p>
<p>2
9
</p>
<p>1
9
</p>
<p>3
9
</p>
<p>The expectation can hence be calculated as
</p>
<p>E(Y ) = E
(
1
</p>
<p>X
</p>
<p>)
</p>
<p>= 1 &middot; 1
9
+ 1
</p>
<p>2
&middot; 1
9
+ 1
</p>
<p>3
&middot; 1
9
+ 1
</p>
<p>4
&middot; 2
9
+ 1
</p>
<p>5
&middot; 1
9
+ 1
</p>
<p>6
&middot; 3
9
</p>
<p>= 1
9
+ 1
</p>
<p>18
+ 1
</p>
<p>27
+ 1
</p>
<p>18
+ 1
</p>
<p>45
+ 1
</p>
<p>18
= 91
</p>
<p>270
.
</p>
<p>Comparing the results from (a) and (b) shows clearly that E( 1
X
) �= 1E(X) . Recall
</p>
<p>that E(bX) = bE(X). It is interesting to see that for some transformations T (X)
it holds that E(T (X)) = T (E(X)), but for some it does not. This reminds us to
be careful when thinking of the implications of transformations.
</p>
<p>Solution to Exercise 7.3
</p>
<p>(a) There are several ways to plot the CDF. One possibility is to define the function
</p>
<p>and plot it with the curve command. Since the function has different defini-
</p>
<p>tions for the intervals [&infin;, 0), [0, 1], (1,&infin;], we need to take this into account.
Remember that a logical statement in R corresponds to a number, i.e. TRUE = 1
</p>
<p>and FALSE = 0; we can thus simply add the different pieces of the function and
</p>
<p>multiply them with a condition which specifies if X is contained in the interval
</p>
<p>or not (Fig. B.15):</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 367
</p>
<p>&minus;0.5 0.0 0.5 1.0 1.5
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>x
</p>
<p>F
(x
</p>
<p>)
</p>
<p>Fig. B.15 Cumulative distribution function for the proportion of wine sold
</p>
<p>cdf &lt; &minus;function(x){
(3 &lowast; x 2̂&minus; 2 &lowast; xˆ3) &lowast; (x &lt;= 1&amp; x &gt;= 0)+ 1 &lowast; (x &gt; 1)+ 0 &lowast; (x &lt; 0)
}
curve(cdf,from=-0.5,to=1.5)
</p>
<p>(b) The PDF is
</p>
<p>d
</p>
<p>dx
F(x) = F &prime;(x) = f (x) =
</p>
<p>{
</p>
<p>6(x &minus; x2) if 0 &le; x &le; 1
0 elsewhere.
</p>
<p>(c)
</p>
<p>P
</p>
<p>(
1
</p>
<p>3
&le; X &le; 2
</p>
<p>3
</p>
<p>)
</p>
<p>=
&int; 2
</p>
<p>3
</p>
<p>1
3
</p>
<p>f (x)dx = F
(
2
</p>
<p>3
</p>
<p>)
</p>
<p>&minus; F
(
1
</p>
<p>3
</p>
<p>)
</p>
<p>=
[
</p>
<p>3
</p>
<p>(
2
</p>
<p>3
</p>
<p>)2
</p>
<p>&minus; 2
(
2
</p>
<p>3
</p>
<p>)3
]
</p>
<p>&minus;
[
</p>
<p>3
</p>
<p>(
1
</p>
<p>3
</p>
<p>)2
</p>
<p>&minus; 2
(
1
</p>
<p>3
</p>
<p>)3
]
</p>
<p>= 0.48149.
</p>
<p>(d) We have already defined the CDF in (a). We can now simply plug in the x-values
</p>
<p>of interest:
</p>
<p>cdf(2/3)-cdf(1/3)</p>
<p/>
</div>
<div class="page"><p/>
<p>368 Appendix B: Solutions to Exercises
</p>
<p>(e) The variance can be calculated as follows:
</p>
<p>E(X) =
&int; 1
</p>
<p>0
</p>
<p>x6(x &minus; x2)dx = 6 &middot;
&int; 1
</p>
<p>0
</p>
<p>(x2 &minus; x3)dx
</p>
<p>= 6
[
1
</p>
<p>3
x3 &minus; 1
</p>
<p>4
x4
]1
</p>
<p>0
</p>
<p>= 6 &middot;
(
1
</p>
<p>3
&minus; 1
</p>
<p>4
</p>
<p>)
</p>
<p>= 0.5
</p>
<p>E(X2) =
&int; 1
</p>
<p>0
</p>
<p>x26(x &minus; x2)dx = 6 &middot;
&int; 1
</p>
<p>0
</p>
<p>(x3 &minus; x4)dx
</p>
<p>= 6
[
1
</p>
<p>4
x4 &minus; 1
</p>
<p>5
x5
]1
</p>
<p>0
</p>
<p>= 6 &middot;
(
1
</p>
<p>4
&minus; 1
</p>
<p>5
</p>
<p>)
</p>
<p>= 0.3
</p>
<p>Var(X) = E(X2)&minus; [E(X)]2 = 0.3&minus; 0.52 = 0.05.
</p>
<p>Solution to Exercise 7.4
</p>
<p>(a) Two conditions need to be satisfied for f (x) to be a proper PDF:
</p>
<p>(i)
&int; 2
0 f (x)dx = 1:
</p>
<p>&int; 2
</p>
<p>0
</p>
<p>f (x)dx =
&int; 2
</p>
<p>0
</p>
<p>c &middot; x(2&minus; x)dx = c
&int; 2
</p>
<p>0
</p>
<p>x(2&minus; x)dx
</p>
<p>=c
&int; 2
</p>
<p>0
</p>
<p>(2x &minus; x2)dx = c
[
</p>
<p>x2 &minus; 1
3
</p>
<p>x3
]2
</p>
<p>0
</p>
<p>=c
[
</p>
<p>4&minus; 8
3
&minus; (0&minus; 0)
</p>
<p>]
</p>
<p>= c &middot; 4
3
</p>
<p>!= 1
</p>
<p>=&rArr;c = 3
4
.
</p>
<p>(ii) f (x) &ge; 0:
</p>
<p>f (x) = 3
4
</p>
<p>x(2&minus; x) &ge; 0 &forall; x &isin; [0, 2].
</p>
<p>(b) We calculate
</p>
<p>F(x) = P(X &le; x) =
&int; x
</p>
<p>0
</p>
<p>f (t)dt =
&int; x
</p>
<p>0
</p>
<p>3
</p>
<p>4
t (2&minus; t)dt
</p>
<p>= 3
4
</p>
<p>&int; x
</p>
<p>0
</p>
<p>(2t &minus; t2)dt = 3
4
</p>
<p>[
</p>
<p>t2 &minus; 1
3
</p>
<p>t3
]x
</p>
<p>0
</p>
<p>= 3
4
</p>
<p>[
</p>
<p>x2 &minus; 1
3
</p>
<p>x3 &minus; 0
]
</p>
<p>= 3
4
</p>
<p>x2
(
</p>
<p>1&minus; 1
3
</p>
<p>x
</p>
<p>)</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 369
</p>
<p>and therefore
</p>
<p>F(x) =
</p>
<p>⎧
</p>
<p>⎪
⎪
⎪
⎪
⎨
</p>
<p>⎪
⎪
⎪
⎪
⎩
</p>
<p>0 if x &lt; 0
</p>
<p>3
4 x
</p>
<p>2(1&minus; 13 x) if 0 &le; x &le; 2
</p>
<p>1 if 2 &lt; x .
</p>
<p>(c) The expectation is
</p>
<p>E(X) =
&int; 2
</p>
<p>0
</p>
<p>x f (x)dx = 3
4
</p>
<p>&int; 2
</p>
<p>0
</p>
<p>(2x2 &minus; x3)dx
</p>
<p>= 3
4
</p>
<p>[
2
</p>
<p>3
x3 &minus; 1
</p>
<p>4
x4
]2
</p>
<p>0
</p>
<p>= 3
4
</p>
<p>[
2
</p>
<p>3
&middot; 8&minus; 1
</p>
<p>4
&middot; 16&minus; 0
</p>
<p>]
</p>
<p>= 3
4
</p>
<p>[
16
</p>
<p>3
&minus; 12
</p>
<p>3
</p>
<p>]
</p>
<p>= 3
4
&middot; 4
3
= 1.
</p>
<p>Using Var(X) = E(X2)&minus; (E(X))2, we calculate the variance as
</p>
<p>E(X2) =
&int; 2
</p>
<p>0
</p>
<p>x2 f (x)dx = 3
4
</p>
<p>&int; 2
</p>
<p>0
</p>
<p>(2x3 &minus; x4)dx
</p>
<p>= 3
4
</p>
<p>[
2
</p>
<p>4
x4 &minus; 1
</p>
<p>5
x5
]2
</p>
<p>0
</p>
<p>= 3
4
</p>
<p>[
2
</p>
<p>4
&middot; 16&minus; 1
</p>
<p>5
&middot; 32&minus; 0
</p>
<p>]
</p>
<p>= 6&minus; 3 &middot; 32
4 &middot; 5 = 6&minus;
</p>
<p>3 &middot; 8
5
</p>
<p>= 6
5
</p>
<p>Var(X) = 6
5
&minus; 12 = 1
</p>
<p>5
.
</p>
<p>(d)
</p>
<p>P(|X &minus; μ| &le; 0.5) &ge; 1&minus; σ
2
</p>
<p>c2
= 1&minus;
</p>
<p>( 15 )
</p>
<p>(0.5)2
= 1&minus; 0.8 = 0.2.
</p>
<p>Solution to Exercise 7.5
</p>
<p>(a) The marginal distributions are obtained by the row and column sums of the joint
</p>
<p>PDF, respectively. For example, P(X = 1) =
&sum;J
</p>
<p>j=1 p1 j = p1+ = 1/4.
</p>
<p>X P(X = xi ) Y P(Y = yi )
0 3/4 1 1/6
</p>
<p>1 1/4 2 7/12
</p>
<p>3 1/4</p>
<p/>
</div>
<div class="page"><p/>
<p>370 Appendix B: Solutions to Exercises
</p>
<p>The marginal distribution of X tells us how many customers sought help via the
</p>
<p>telephone hotline (75 %) and via email (25 %). The marginal distribution of Y
</p>
<p>represents the distribution of the satisfaction level, highlighting that more than
</p>
<p>half of the customers (7/12) were &ldquo;satisfied&rdquo;.
</p>
<p>(b) To determine the 75 % quantile with respect to Y , we need to find the value
</p>
<p>y0.75 for which F(y0.75) &ge; 0.75 and F(y) &lt; 0.75 for y &lt; y0.75. Y takes the
values 1, 2, 3. The quantile cannot be y0.75 = 1 because F(1) = 1/6 &lt; 0.75.
The 75 % quantile is y0.75 = 2 because F(2) = 1/6+ 7/12 = 3/4 &ge; 0.75 and
for all values which are smaller than 2 we get F(x) &lt; 0.75.
</p>
<p>(c) We can calculate the conditional distribution using P(Y = y j |X = 1) = p1 j/
p1+ = p1 j/(1/6+ 1/12+ 0) = p1 j/(0.25). Therefore,
</p>
<p>P(Y = 1|X = 1) = 1/6
1/4
</p>
<p>= 2
3
,
</p>
<p>P(Y = 2|X = 1) = 1/12
1/4
</p>
<p>= 1
3
,
</p>
<p>P(Y = 3|X = 1) = 0
1/4
</p>
<p>= 0.
</p>
<p>Among those who used the email customer service two-thirds were unsatisfied,
</p>
<p>one-third were satisfied, and no one was very satisfied.
</p>
<p>(d) As we know from (7.27), two discrete random variables are said to be indepen-
</p>
<p>dent if P(X = xi , Y = y j ) = P(X = xi )P(Y = y j ). However, in our example,
P(X = 0, Y = 1) = P(X = 0)P(X = 1) = 34 &middot;
</p>
<p>1
6 �= 0. This means that X and
</p>
<p>Y are not independent.
</p>
<p>(e) The covariance of X and Y is defined as Cov(X, Y ) = E(XY )&minus; E(X)E(Y ). We
calculate
</p>
<p>E(X) = 0 &middot; 3
4
+ 1 &middot; 1
</p>
<p>4
= 1
</p>
<p>4
</p>
<p>E(Y ) = 1 &middot; 1
6
+ 2 &middot; 7
</p>
<p>12
+ 3 &middot; 1
</p>
<p>4
= 25
</p>
<p>12
</p>
<p>E(XY ) = 0 &middot; 1 &middot; 0+ 1 &middot; 1 &middot; 1
6
+ 0 &middot; 2 &middot; 1
</p>
<p>2
+ 1 &middot; 2 &middot; 1
</p>
<p>12
+ 0 &middot; 3 &middot; 1
</p>
<p>4
+ 1 &middot; 3 &middot; 0
</p>
<p>= 2
6
</p>
<p>Cov(X, Y ) = 2
6
&minus; 1
</p>
<p>4
&middot; 25
12
</p>
<p>= &minus; 3
16
</p>
<p>.
</p>
<p>Since Cov(X, Y ) &lt; 0, we conclude that there is a negative relationship between
</p>
<p>X and Y : the higher the values of X , the lower the values of Y&mdash;and vice
</p>
<p>versa. For example, those who use the email-based customer service (X = 1)
are less satisfied than those who use the telephone customer service (X = 0).
It is, however, evident that in this example the values of X have no order and
</p>
<p>therefore, care must be exercised in interpreting the covariance.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 371
</p>
<p>Solution to Exercise 7.6 Using Tschebyschev&rsquo;s inequality (7.24)
</p>
<p>P(|X &minus; μ| &lt; c) &ge; 0.9 = 1&minus; Var(X)
c2
</p>
<p>,
</p>
<p>we can determine c as follows:
</p>
<p>1&minus; Var(X)
c2
</p>
<p>= 0.9
</p>
<p>c2 = Var(X)
0.1
</p>
<p>= 4
0.1
</p>
<p>= 40
</p>
<p>c = &plusmn;
&radic;
40 = &plusmn;6.325.
</p>
<p>Thus, the interval is [15&minus; 6.325; 15+ 6.325] = [8.675; 21.325].
</p>
<p>Solution to Exercise 7.7
</p>
<p>(a) The joint PDF is:
</p>
<p>Y
</p>
<p>0 1 2
</p>
<p>&minus;1 0.3 0.2 0.2
X
</p>
<p>2 0.1 0.1 0.1
</p>
<p>(b) The marginal distributions are obtained from the row and column sums of the
</p>
<p>joint PDF, respectively:
</p>
<p>X &minus;1 2 Y 0 1 2
P(X = x) 0.7 0.3 P(Y = y) 0.4 0.3 0.3
</p>
<p>(c) The random variables X and Y are independent if
</p>
<p>P(X = x, Y = y) = P(X = x)P(Y = y) &forall;x, y.
However, in our example we have, for example,
</p>
<p>P(X = &minus;1, Y = 0) = 0.3 �= P(X = &minus;1) &middot; P(Y = 0) = 0.7 &middot; 0.4 = 0.28.
Hence, the two variables are not independent.
</p>
<p>(d) The joint distribution of X and Y can be used to obtain the desired distribution
</p>
<p>of U . For example, If X = &minus;1 and Y = 0, then U = X + Y = &minus;1. The respec-
tive probability is P(U = &minus;1) = 0.3 because P(U = &minus;1) = P(X = &minus;1, Y =
0) = 0.3 and there is no other combination of X - and Y -values which yields
X + Y = &minus;1. The distribution of U is therefore as follows:</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>372 Appendix B: Solutions to Exercises
</p>
<p>k &minus;1 0 1 2 3 4
P(U = k) 0.3 0.2 0.2 0.1 0.1 0.1
</p>
<p>(e) We calculate
</p>
<p>E(U ) =
4
</p>
<p>&sum;
</p>
<p>k=&minus;1
k &middot; P(U = k) = 0.8
</p>
<p>E(X) = (&minus;1)0.7+ 2 &middot; 0.3 = &minus;0.1
E(Y ) = 0 &middot; 0.4+ 1 &middot; 0.3+ 2 &middot; 0.3 = 0.9
</p>
<p>E(U 2) = 0.3 &middot; (&minus;1)2 + &middot; &middot; &middot; + 0.1 &middot; 42 = 3.4
E(X2) = 0.7 &middot; (&minus;1)2 + 0.3 &middot; 22 = 1.9
E(Y 2) = 0.4 &middot; 02 + 0.3 &middot; 12 + 0.3 &middot; 22 = 1.5
</p>
<p>Var(U ) = E(U 2)&minus; [E(U )]2 = 3.4&minus; (0.8)2 = 2.76
Var(X) = E(X2)&minus; [E(X)]2 = 1.9&minus; (&minus;0.1)2 = 1.89
Var(Y ) = E(Y 2)&minus; [E(Y )]2 = 1.5&minus; (0.9)2 = 0.69.
</p>
<p>It can be seen that E(X)+ E(Y ) = &minus;0.1+ 0.9 = 0.8 = E(U ). This makes
sense because we know from (7.31) that E(X + Y ) = E(X)+ E(Y ). However,
Var(U ) = 2.76 �= Var(X)+ Var(Y ) = 1.89+ 0.69. This follows from (7.7.1)
which says that Var(X &plusmn; Y ) = Var(X)+ Var(Y )&plusmn; 2Cov(X, Y ) and therefore,
Var(X &plusmn; Y ) = Var(X)+ Var(Y ) only if the covariance is 0. We know from (c)
that X and Y are not independent and thus Cov(X, Y ) �= 0.
</p>
<p>Solution to Exercise 7.8
</p>
<p>(a) The random variables X and Y are independent if the balls are drawn with
</p>
<p>replacement. This becomes clear by understanding that drawing with replace-
</p>
<p>ment implies that for both the draws, the same balls are in the urn and the
</p>
<p>conditions in each draw remain the same. The first draw has no implications for
</p>
<p>the second draw.
</p>
<p>If we were drawing the balls without replacement, then the first draw could possibly
</p>
<p>have implications for the second draw: for instance, if the first ball drawn was red,
</p>
<p>then the second one could not be red because there is only one red ball in the urn.
</p>
<p>This means that drawing without replacement implies dependency of X and Y . This
</p>
<p>can also be seen by evaluating the independence assumption (7.27):
</p>
<p>P(X = 2, Y = 2) = 0 �= P(X = 2) &middot; P(Y = 2) = 1
8
&middot; 1
8
.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 373
</p>
<p>(b) The marginal probabilities P(X = xi ) can be obtained from the given informa-
tion. For example, 3 out of 8 balls are black and thus P(X = 1) = 3/8. The
conditional distributions P(Y |X = xi ) can be calculated easily by realizing that
under the assumed dependency of X and Y , the second draw is always based on
</p>
<p>7 balls (8 balls minus the one drawn under the condition X = xi )&mdash;e.g. if the
first ball drawn is black, then 7 balls, 2 of which are black, remain in the urn and
</p>
<p>P(Y = 1|X = 1) = 2/7. We thus calculate
</p>
<p>P(Y = 1, X = 1) = P(Y = 1|X = 1)P(X = 1) = 2
7
&middot; 3
8
= 6
</p>
<p>56
</p>
<p>P(Y = 1, X = 2) = P(Y = 1|X = 2)P(X = 2) = 3
7
&middot; 1
8
= 3
</p>
<p>56
. . .
</p>
<p>P(Y = 3, X = 3) = P(Y = 3|X = 3)P(X = 3) = 3
7
&middot; 4
8
= 12
</p>
<p>56
</p>
<p>and obtain
</p>
<p>Y
</p>
<p>1 2 3
</p>
<p>1 656
3
56
</p>
<p>12
56
</p>
<p>X 2 356 0
4
56
</p>
<p>3 1256
4
56
</p>
<p>12
56
</p>
<p>(c) The expectations are
</p>
<p>E(X) = 1 &middot; 3
8
+ 2 &middot; 1
</p>
<p>8
+ 3 &middot; 4
</p>
<p>8
= 17
</p>
<p>8
</p>
<p>E(Y ) = E(X) = 17
8
.
</p>
<p>To estimate ρ(X, Y ), we need Cov(X, Y ) as well as Var(X) and Var(Y ):
</p>
<p>E(XY ) = 1 6
56
</p>
<p>+ 2 3
56
</p>
<p>+ 312
56
</p>
<p>+ 2 3
56
</p>
<p>+ 4 &middot; 0+ 6 4
56
</p>
<p>+ 312
56
</p>
<p>+ 6 4
56
</p>
<p>+ 912
56
</p>
<p>= 246
56
</p>
<p>E(X2) = E(Y 2) = 12 3
8
+ 22 1
</p>
<p>8
+ 32 4
</p>
<p>8
= 43
</p>
<p>8
</p>
<p>Var(X) = E(X2)&minus; [E(X)]2 = 43
8
</p>
<p>&minus;
(
17
</p>
<p>8
</p>
<p>)2
</p>
<p>= 55
64
</p>
<p>Var(Y ) = Var(X) = 55
64
</p>
<p>.</p>
<p/>
</div>
<div class="page"><p/>
<p>374 Appendix B: Solutions to Exercises
</p>
<p>Using (7.38) and Cov(X, Y ) = E(XY )&minus; E(X)E(Y ), we obtain
</p>
<p>ρ = Cov(X, Y )&radic;
Var(X) &middot; Var(Y )
</p>
<p>=
246
56 &minus;
</p>
<p>289
64
</p>
<p>&radic;
</p>
<p>55
64 &middot;
</p>
<p>55
64
</p>
<p>= &minus;0.143.
</p>
<p>Solution to Exercise 7.9
</p>
<p>(a) The constant c must satisfy
</p>
<p>&int; 100
</p>
<p>40
</p>
<p>&int; 100
</p>
<p>10
</p>
<p>c
</p>
<p>(
100&minus; x
</p>
<p>x
</p>
<p>)
</p>
<p>dx dy =
&int; 100
</p>
<p>40
</p>
<p>&int; 100
</p>
<p>10
</p>
<p>100c
</p>
<p>x
&minus; c dx dy != 1
</p>
<p>and therefore
</p>
<p>&int; 100
</p>
<p>40
[100c ln(x)&minus; cx]10010 dy =
</p>
<p>&int; 100
</p>
<p>40
</p>
<p>100c ln 100&minus; 100c &minus; 100c ln(10)+ 10c dy
</p>
<p>which is
</p>
<p>&int; 100
</p>
<p>40
</p>
<p>100c
</p>
<p>(
</p>
<p>ln
100
</p>
<p>10
&minus; 1+ 1
</p>
<p>10
</p>
<p>)
</p>
<p>dy = [100cy (ln 10&minus; 9/10)]10040
= 600c(10 ln 10&minus; 9) &rarr; c &asymp; 0.00012.
</p>
<p>(b) The marginal distribution is
</p>
<p>fX (x) =
&int; 100
</p>
<p>40
</p>
<p>c
</p>
<p>(
100&minus; x
</p>
<p>x
</p>
<p>)
</p>
<p>dy =
[
</p>
<p>c
</p>
<p>(
100&minus; x
</p>
<p>x
</p>
<p>)
</p>
<p>y
</p>
<p>]100
</p>
<p>40
</p>
<p>= 100c
(
100&minus; x
</p>
<p>x
</p>
<p>)
</p>
<p>&minus; 40c
(
100&minus; x
</p>
<p>x
</p>
<p>)
</p>
<p>&asymp; 0.00713
(
100&minus; x
</p>
<p>x
</p>
<p>)
</p>
<p>for 10 &le; x &le; 100.
</p>
<p>(c) To determine P(X &gt; 75), we need the cumulative marginal distribution of X :
</p>
<p>FX (x) =
&int; x
</p>
<p>&minus;&infin;
fX (t)dt =
</p>
<p>&int; x
</p>
<p>10
</p>
<p>0.00713
</p>
<p>(
100&minus; t
</p>
<p>t
</p>
<p>)
</p>
<p>dt
</p>
<p>=
&int; x
</p>
<p>10
</p>
<p>0.00713
</p>
<p>t
&minus; 0.00713 dt = [0.713 ln(t)&minus; 0.00713]x10
</p>
<p>= 0.713 ln(x)&minus; 0.00713x &minus; 0.00713 ln(10)+ 0.00713 &middot; 10.
Now we can calculate
</p>
<p>P(X &gt; 75) = 1&minus; P(X &le; 75) = 1&minus; FX (75) = 1&minus; 0.973 &asymp; 2.7 %.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 375
</p>
<p>(d) The conditional distribution is
</p>
<p>fY |X (x, y) =
f (x, y)
</p>
<p>f (x)
=
</p>
<p>c
(
100&minus;x
</p>
<p>x
</p>
<p>)
</p>
<p>60c
(
100&minus;x
</p>
<p>x
</p>
<p>) = 1
60
</p>
<p>.
</p>
<p>Solution to Exercise 7.10 If we evaluate the expectation with respect to Y , then both
</p>
<p>μ and σ can be considered to be constants. We can therefore write
</p>
<p>E(Y ) = E
(
</p>
<p>X &minus; μ
σ
</p>
<p>)
</p>
<p>= 1
σ
(E(X)&minus; μ).
</p>
<p>Since E(X) = μ, it follows that E(Y ) = 0. The variance is
</p>
<p>Var(Y ) = Var
(
</p>
<p>X &minus; μ
σ
</p>
<p>)
</p>
<p>.
</p>
<p>Applying Var(a + bX) = b2Var(X) to this equation yields a = μ, b = 1
σ
and there-
</p>
<p>fore
</p>
<p>Var(Y ) = 1
σ2
</p>
<p>Var(X) = σ
2
</p>
<p>σ2
= 1.
</p>
<p>Chapter 8
</p>
<p>Solution to Exercise 8.1 The random variable X: &ldquo;number of packages with a toy&rdquo; is
</p>
<p>binomially distributed. In each of n = 20 &ldquo;trials&rdquo;, a toy can be foundwith probability
p = 16 .
</p>
<p>(a) We thus get
</p>
<p>P(X = 4) =
(
</p>
<p>n
</p>
<p>k
</p>
<p>)
</p>
<p>pk(1&minus; p)n&minus;k =
(
20
</p>
<p>4
</p>
<p>)(
1
</p>
<p>6
</p>
<p>)4(5
</p>
<p>6
</p>
<p>)16
</p>
<p>&asymp; 0.20.
</p>
<p>(b) Similarly, we calculate
</p>
<p>P(X = 0) =
(
</p>
<p>n
</p>
<p>k
</p>
<p>)
</p>
<p>pk(1&minus; p)n&minus;k =
(
20
</p>
<p>0
</p>
<p>)(
1
</p>
<p>6
</p>
<p>)0(5
</p>
<p>6
</p>
<p>)20
</p>
<p>= 0.026.
</p>
<p>(c) This question relates to a hypergeometric distribution: there are N = 20 pack-
ages with M = 3 packages with toys and N &minus; M = 17 packages without a toy.
The daughter gets n = 5 packages and we are interested in P(X = 2). Hence,
we get
</p>
<p>P(X = 2) =
(
</p>
<p>M
x
</p>
<p>)(
N&minus;M
n&minus;x
</p>
<p>)
</p>
<p>(
N
n
</p>
<p>) =
(3
2
</p>
<p>)(17
3
</p>
<p>)
</p>
<p>(20
5
</p>
<p>) &asymp; 0.13.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>376 Appendix B: Solutions to Exercises
</p>
<p>Solution to Exercise 8.2 Given X &sim; N (42.1, 20.82), we get:
</p>
<p>(a)
</p>
<p>P(X &ge; 50) = 1&minus; P(X &le; 50) = 1&minus; φ
(
</p>
<p>x &minus; μ
σ
</p>
<p>)
</p>
<p>= 1&minus; φ
(
50&minus; 42.1
</p>
<p>20.8
</p>
<p>)
</p>
<p>= 1&minus; φ(0.37) &asymp; 0.35.
</p>
<p>We obtain the same results in R as follows:
</p>
<p>1-pnorm(50,42.1,20.8)
</p>
<p>(b)
</p>
<p>P(30 &le; X &le; 40) = P(X &le; 40)&minus; P(X &le; 30)
</p>
<p>= φ
(
40&minus; 42.1
</p>
<p>20.8
</p>
<p>)
</p>
<p>&minus; φ
(
30&minus; 42.1
</p>
<p>20.8
</p>
<p>)
</p>
<p>= φ(&minus;0.096)&minus; φ(&minus;0.577) = 1&minus; 0.538&minus; 1+ 0.718
&asymp; 18%.
</p>
<p>We would have obtained the same results in R using:
</p>
<p>pnorm(40,42.1,20.8)-pnorm(30,42.1,20.8)
</p>
<p>Solution to Exercise 8.3 The random variable X follows a discrete uniform distrib-
</p>
<p>ution because pi = 112 for each xi . The expectation and variance are therefore
</p>
<p>E(X) = k + 1
2
</p>
<p>= 12+ 1
2
</p>
<p>= 6.5,
</p>
<p>Var(X) = 1
12
</p>
<p>(122 &minus; 1) &asymp; 11.92.
</p>
<p>Solution to Exercise 8.4 Each guess is a Bernoulli experiment where the right
</p>
<p>answer is given with a probability of 50 %. The number of correct guesses therefore
</p>
<p>follows a binomial distribution, i.e. X &sim; B(10; 0.5). The probability of giving the
right answer at least 8 times is identical to the probability of not being wrong more</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 377
</p>
<p>than 2 times. We can thus calculate P(X &ge; 8) as P(X &le; 2):
</p>
<p>P(X = 0) =
(
10
</p>
<p>0
</p>
<p>)
</p>
<p>0.50(1&minus; 0.5)10 &asymp; 0.000977
</p>
<p>P(X = 1) =
(
10
</p>
<p>1
</p>
<p>)
</p>
<p>0.51(1&minus; 0.5)9 &asymp; 0.009766
</p>
<p>P(X = 2) =
(
10
</p>
<p>2
</p>
<p>)
</p>
<p>0.52(1&minus; 0.5)8 &asymp; 0.043945.
</p>
<p>This relates to
</p>
<p>P(X &le; 2) = P(X = 0)+ P(X = 1)+ P(X = 2)
= 0.000977+ 0.009766+ 0.043945 &asymp; 0.0547.
</p>
<p>We would have obtained the same results in R using:
</p>
<p>pbinom(2,10,0.5)
</p>
<p>1-pbinom(7,10,0.5)
</p>
<p>Solution to Exercise 8.5
</p>
<p>(a) It seems appropriate to model the number of fused bulbs with a Poisson dis-
</p>
<p>tribution. We assume, however, that the probabilities of fused bulbs on two
</p>
<p>consecutive days are independent of each other; i.e. they only depend on λ but
</p>
<p>not on the time t .
</p>
<p>(b) The arithmetic mean is
</p>
<p>x̄ = 1
30
</p>
<p>(0+ 1 &middot; 8+ 2 &middot; 8+ &middot; &middot; &middot; + 5 &middot; 1) = 52
30
</p>
<p>= 1.7333
</p>
<p>which means that, on an average, 1.73 bulbs are fused per day. The variance is
</p>
<p>s2 = 1
30
</p>
<p>(0+ 12 &middot; 8+ 22 &middot; 8+ &middot; &middot; &middot; + 52 &middot; 1)&minus; 1.73332
</p>
<p>= 142
30
</p>
<p>&minus; 3.0044 = 1.72889.
</p>
<p>We see that mean and variance are similar, which is an indication that the
</p>
<p>choice of a Poisson distribution is appropriate since we assume E(X) = λ and
Var(X) = λ.
</p>
<p>(c) The following table lists the proportions (i.e. relative frequencies f j ) together
</p>
<p>with the probabilities P(X = x) from a Po(1.73)-distribution. As a reference,
we also list the probabilities from a Po(2)-distribution since it is not practically
</p>
<p>possible that 1.73 bulbs stop working and it may hence be an option to round
</p>
<p>the mean.</p>
<p/>
</div>
<div class="page"><p/>
<p>378 Appendix B: Solutions to Exercises
</p>
<p>fi Po(1.73) Po(2)
</p>
<p>P(X = 0) 0.2 0.177 0.135
P(X = 1) 0.267 0.307 0.27
P(X = 2) 0.267 0.265 0.27
P(X = 3) 0.167 0.153 0.18
P(X = 4) 0.067 0.067 0.09
P(X = 5) 0.033 0.023 0.036
</p>
<p>One can see that observed proportions and expected probabilities are close
</p>
<p>together which indicates again that the choice of a Poisson distribution was
</p>
<p>appropriate. Chapter 9 gives more details on how to estimate parameters, such
</p>
<p>as λ, from data if it is unknown.
</p>
<p>(d) Using λ = 1.73, we calculate
</p>
<p>P(X &gt; 5) = 1&minus; P(X &le; 5) = 1&minus;
5
</p>
<p>&sum;
</p>
<p>i=0
</p>
<p>λi
</p>
<p>i ! exp(&minus;λ)
</p>
<p>= 1&minus; exp(&minus;1.73)
(
</p>
<p>1.730
</p>
<p>0! +
1.731
</p>
<p>1! + &middot; &middot; &middot; +
1.735
</p>
<p>5!
</p>
<p>)
</p>
<p>= 1&minus; 0.99 = 0.01.
Thus, the bulbs are replaced on only 1 % of the days.
</p>
<p>(e) If X follows a Poisson distribution then, given Theorem 8.2.1, Y follows an
</p>
<p>exponential distribution with λ = 1.73.
</p>
<p>(f) The expectation of an exponentially distributed variable is
</p>
<p>E(Y ) = 1
λ
= 1
</p>
<p>1.73
= 0.578.
</p>
<p>This means that, on average, it takes more than half a day until one of the bulbs
</p>
<p>gets fused.
</p>
<p>Solution to Exercise 8.6
</p>
<p>(a) Let X be a random variable describing &ldquo;the number x of winning tickets
</p>
<p>among n bought tickets&rdquo;; then X follows the hypergeometric distribution
</p>
<p>X &sim; H(n, 500, 4000). We need to determine n for the conditions specified.
We are interested in
</p>
<p>P(X &ge; 3) = 1&minus; P(X = 2)&minus; P(X = 1)&minus; P(X = 0).
Using the PMF of the hypergeometric distribution
</p>
<p>P(X = x) =
(
</p>
<p>M
x
</p>
<p>)(
N&minus;M
n&minus;x
</p>
<p>)
</p>
<p>(
N
n
</p>
<p>) ,</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 379
</p>
<p>this equates to
</p>
<p>P(X &ge; 3) = 1&minus;
(500
</p>
<p>2
</p>
<p>)(4000&minus;500
n&minus;2
</p>
<p>)
</p>
<p>(4000
n
</p>
<p>) &minus;
(500
</p>
<p>1
</p>
<p>)(4000&minus;500
n&minus;1
</p>
<p>)
</p>
<p>(4000
1
</p>
<p>) &minus;
(500
</p>
<p>0
</p>
<p>)(4000&minus;500
n
</p>
<p>)
</p>
<p>(4000
n
</p>
<p>) .
</p>
<p>We have the following requirement:
</p>
<p>1&minus;
(500
</p>
<p>2
</p>
<p>)(4000&minus;500
n&minus;2
</p>
<p>)
</p>
<p>(4000
n
</p>
<p>) &minus;
(500
</p>
<p>1
</p>
<p>)(4000&minus;500
n&minus;1
</p>
<p>)
</p>
<p>(4000
1
</p>
<p>) &minus;
(500
</p>
<p>0
</p>
<p>)(4000&minus;500
n
</p>
<p>)
</p>
<p>(4000
n
</p>
<p>)
</p>
<p>!
&ge; 0.99.
</p>
<p>To solve this equation, we can program this function for P(X &gt; 3; n) in R and
evaluate it for different numbers of tickets sold, e.g. between 50 and 100 tickets:
</p>
<p>raffle &lt;- function(n){
</p>
<p>p &lt;- 1-((choose(500,2)*choose(3500,n-2))/(choose(4000,n)))
</p>
<p>-((choose(500,1)*choose(3500,n-1))/(choose(4000,n)))
</p>
<p>-((choose(500,0)*choose(3500,n))/(choose(4000,n)))
</p>
<p>return(p)
</p>
<p>}
</p>
<p>raffle(50:100)
</p>
<p>raffle(63:64)
</p>
<p>The output shows that at least 64 tickets need to be bought to have a 99%
</p>
<p>guarantee that at least three tickets win. This equates to spending e 96.
</p>
<p>(b) We can plot the function as follows:
</p>
<p>nb &lt;- seq(1:75)
</p>
<p>plot(nb,tombola(nb),type='l')
</p>
<p>Figure B.16 shows the relationship between the number of tickets bought and
</p>
<p>the probability of having at least three winning tickets.
</p>
<p>(c) The solution of (a) shows that it is well worth taking part in the raffle: Marco
</p>
<p>pays e96 and with a probability of 99 % and he wins at least three prizes which
</p>
<p>are worth e142 &middot; 3 = 426. More generally, the money generated by the raffle
is e1.50&times; 4000 = 6000, but the prizes are worth e142 &middot; 500 = 71, 000. One
may suspect that the company produces the appliances much more cheaply than
</p>
<p>they are sold for and is thus so generous.</p>
<p/>
</div>
<div class="page"><p/>
<p>380 Appendix B: Solutions to Exercises
</p>
<p>0 20 40 60
</p>
<p>0
.0
</p>
<p>0
.2
</p>
<p>0
.4
</p>
<p>0
.6
</p>
<p>0
.8
</p>
<p>1
.0
</p>
<p>Number of tickets
</p>
<p>P
ro
</p>
<p>b
a
</p>
<p>b
ili
</p>
<p>ty
 f
o
</p>
<p>r 
a
</p>
<p>t 
le
</p>
<p>a
s
t 
</p>
<p>3
 p
</p>
<p>ri
c
e
</p>
<p>s
</p>
<p>Fig. B.16 Probability to have at least three winning tickets given the number of tickets bought
</p>
<p>Solution to Exercise 8.7 The probability of getting a girl is p = 1&minus; 0.5122 =
0.4878.
</p>
<p>(a) We are dealing with a geometric distribution here. Since we are interested in
</p>
<p>P(X &le; 3), we can calculate:
P(X = 1) = 0.4878
P(X = 2) = 0.4878(1&minus; 0.4878) = 0.2498512
P(X = 3) = 0.4878(1&minus; 0.4878)2 = 0.1279738
P(X &le; 3) = P(X = 1)+ P(X = 2)+ P(X = 3) = 0.865625.
</p>
<p>We would have obtained the same result in R using:
</p>
<p>pgeom(2,0.4878)
</p>
<p>Note that we have to specify &ldquo;2&rdquo; rather than &ldquo;3&rdquo; for x because R takes the number
</p>
<p>of unsuccessful trials rather the number of trials until success.
</p>
<p>(b) Herewedealwith a binomial distributionwith k = 2 and n = 4.We can calculate
P(X = 2) as follows:
</p>
<p>P(X = k) =
(
</p>
<p>n
</p>
<p>k
</p>
<p>)
</p>
<p>pk(1&minus; p)n&minus;k
</p>
<p>=
(
4
</p>
<p>2
</p>
<p>)
</p>
<p>0.48782 &middot; (1&minus; 0.4878)2 = 0.3745536.
</p>
<p>R would have given us the same result using the dbinom(2,4,0.4878) com-
</p>
<p>mand.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 381
</p>
<p>Solution to Exercise 8.8
</p>
<p>(a) The random variable Y follows a Poisson distribution, see Theorem 8.2.1 for
</p>
<p>more details.
</p>
<p>(b) The fisherman catches, on average, 3 fish an hour. We can thus assume that the
</p>
<p>rate λ is 3 and thus E(Y ) = λ = 3. Similarly, E(X) = 1
λ
= 13 which means that
</p>
<p>it takes, on average, 20 min to catch another fish.
</p>
<p>(c) Using the PDF of the Poisson distribution, we get:
</p>
<p>P(Y = 5) = 3
5
</p>
<p>5! exp(&minus;3) = 0.1 = 10%
</p>
<p>P(Y &lt; 1) = P(Y = 0) = 3
0
</p>
<p>0! exp(&minus;3) &asymp; 0.0498 &asymp; 5%.
</p>
<p>We would have obtained the same results in R using the dpois(5,3) and
</p>
<p>dpois(0,3) commands.
</p>
<p>Solution to Exercise 8.9 The random variable X = &ldquo;choice of dessert&rdquo; follows a
multinomial distribution. More precisely, X1 describes whether chocolate brownies
</p>
<p>were chosen, X2 describeswhether yoghurt was chosen, X3 describeswhether lemon
</p>
<p>tart was chosen and X = {X1, X2, X3}.
</p>
<p>(a) Using the PMF of the multinomial distribution, we get
</p>
<p>P(X1 = n1, X2 = n2, . . . , Xk = nk) =
n!
</p>
<p>n1!n2! &middot; &middot; &middot; nk !
&middot; pn11 &middot; &middot; &middot; p
</p>
<p>nk
k
</p>
<p>P(X1 = 2, X2 = 1, X3 = 2) =
5!
</p>
<p>2!1!2! &middot; 0.2
2 &middot; 0.31 &middot; 0.52
</p>
<p>= 9%.
We would have obtained the same results in R as follows:
</p>
<p>dmultinom(c(2,1,2),prob=c(0.2,0.3,0.5))
</p>
<p>(b) The probability of choosing lemon tart for the first two guests is 1. We thus need
</p>
<p>to determine the probability that 3 out of the remaining 3 guests order lemon
</p>
<p>tart:
</p>
<p>P(X1 = 0, X2 = 0, X3 = 3) =
3!
</p>
<p>0!0!3! &middot; 0.2
0 &middot; 0.30 &middot; 0.53
</p>
<p>= 12.5%.
Using dmultinom(c(0,0,3),prob=c(0.2,0.3,0.5)) in R, we get the same
</p>
<p>result.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>382 Appendix B: Solutions to Exercises
</p>
<p>(c) The expectation vector is
</p>
<p>E(X) = (np1, . . . , npk) = (20 &middot; 0.2, 20 &middot; 3, 20 &middot; 0.5) = (4, 6, 10).
This means we expect 4 guests to order brownies, 6 to order yoghurt, and 10 to
</p>
<p>order lemon tart. The covariance matrix can be determined as follows:
</p>
<p>Cov(X i , X j ) =
{
</p>
<p>npi (1&minus; pi ) if i = j
&minus;npi p j if i �= j.
</p>
<p>Using n = 20, p1 = 0.2, p2 = 0.3 and p3 = 0.5, we obtain the covariance
matrix as:
</p>
<p>⎛
</p>
<p>⎝
</p>
<p>3.2 &minus;1.2 &minus;2
&minus;1.2 4.2 &minus;3
&minus;2 &minus;3 5
</p>
<p>⎞
</p>
<p>⎠
</p>
<p>Solution to Exercise 8.10
</p>
<p>P(S &ge; 1, W &ge; 1) indep.= P(S &ge; 1) &middot; P(W &ge; 1)
= (1&minus; P(S = 0)) &middot; (1&minus; P(W = 0))
</p>
<p>= (1&minus; e&minus;3 3
0
</p>
<p>0! ) &middot; (1&minus; e
&minus;4 4
</p>
<p>0
</p>
<p>0! )
</p>
<p>&asymp; 0.93.
</p>
<p>Solution to Exercise 8.11
</p>
<p>(a) Random numbers of a normal distribution can be generated using the rnorm
</p>
<p>command. By default μ = 0 and σ = 1 (see ?rnorm), so we do not need to
specify these parameters. We simply need to set n = 1000. The mean of the
1000 realizations can thus be obtained using mean(rnorm(1000)). We can, for
</p>
<p>example, write a for loop to repeat this process 1000 times. An empty (=NA)
</p>
<p>vector of size 1000 can be used to store and evaluate the results:
</p>
<p>set.seed(24121980)
</p>
<p>R &lt;- 1000
</p>
<p>means &lt;- c(rep(NA,R))
</p>
<p>for(i in 1:R){means[i] &lt;- mean(rnorm(1000))}
</p>
<p>mean(means)
</p>
<p>[1] -0.0007616465
</p>
<p>var(means)
</p>
<p>[1] 0.0009671311
</p>
<p>plot(density(means))
</p>
<p>Wesee that themean of the arithmeticmeans is close to zero, but not exactly zero.
</p>
<p>The variance is approximately σ2/n = 1/1000 = 0.001, as one would expect</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 383
</p>
<p>Fig. B.17 Kernel density
</p>
<p>plot of the distribution
</p>
<p>simulated in Exercise 8.11a
</p>
<p>&minus;0.10 &minus;0.05 0.00 0.05 0.10
</p>
<p>0
2
</p>
<p>4
6
</p>
<p>8
1
</p>
<p>0
1
</p>
<p>2
</p>
<p>from the Central Limit Theorem. The distribution is symmetric, similar to a
</p>
<p>normal distribution, see Fig. B.17. It follows that X̄n is approximately N (μ,
σ2
</p>
<p>n
)
</p>
<p>distributed, as one could expect from the Theorem of Large Numbers and the
</p>
<p>Central Limit Theorem. It is important to understand that X̄ is not fixed but a
</p>
<p>random variable which follows a distribution, i.e. the normal distribution.
</p>
<p>(b) We can use the same code as above, except we use the exponential instead of
</p>
<p>the normal distribution:
</p>
<p>means2 &lt;- c(rep(NA,R))
</p>
<p>for(i in 1:R){means2[i] &lt;- mean(rexp(1000))}
</p>
<p>mean(means2)
</p>
<p>[1] 1.001321
</p>
<p>var(means2)
</p>
<p>[1] 0.001056113
</p>
<p>plot(density(means))
</p>
<p>The realizations are i.i.d. observations. Once can see that, as in a), X̄n is approx-
</p>
<p>imately N (μ, σ
2
</p>
<p>n
) = N (1, 1/1000) distributed. It is evident that the X i do not
</p>
<p>necessarily need to follow a normal distribution for X̄ to follow a normal distri-
</p>
<p>bution, see also Fig. B.18a.
</p>
<p>(c) Increasing the number of repetitions makes the distribution look closer to a
</p>
<p>normal distribution, see Fig. B.18b. This visualizes that as n tends to infinity X̄n
</p>
<p>gets closer to a N (μ, σ
2
</p>
<p>n
)-distribution.</p>
<p/>
</div>
<div class="page"><p/>
<p>384 Appendix B: Solutions to Exercises
</p>
<p>0.90 0.95 1.00 1.05 1.10
</p>
<p>0
2
</p>
<p>4
6
</p>
<p>8
1
0
</p>
<p>1
2
</p>
<p>(a) 1,000 repetitions
</p>
<p>0.90 0.95 1.00 1.05 1.10 1.15
</p>
<p>0
2
</p>
<p>4
6
</p>
<p>8
1
0
</p>
<p>1
2
</p>
<p>(b) 10,000 repetitions
</p>
<p>Fig. B.18 Kernel density plots for Exercises 8.11b and 8.11c
</p>
<p>Chapter 9
</p>
<p>Solution to Exercise 9.1
</p>
<p>(a) The exercise tells us that X i
i id&sim; Po(λ), i = 1, 2, . . . , n. Let us look at the real-
</p>
<p>izations x1, x2, . . . , xn : under the assumption of independence, which we know
</p>
<p>is fulfilled because the X i &rsquo;s are i.i.d., and we can write the likelihood function
</p>
<p>as the product of the n PMF&rsquo;s of the Poisson distribution:
</p>
<p>L(θ; x) =
n
&prod;
</p>
<p>i=1
f (xi ; θ) =
</p>
<p>n
&prod;
</p>
<p>i=1
</p>
<p>λxi
</p>
<p>xi !
e&minus;λ = λ
</p>
<p>&sum;
</p>
<p>xi
</p>
<p>&prod;
</p>
<p>xi !
e&minus;nλ.
</p>
<p>It is better to work on a log-scale because it is easy to differentiate. The results
</p>
<p>are identical no matter whether we use the likelihood function or the log-
</p>
<p>likelihood function because the log transformation is monotone in nature. The
</p>
<p>log-likelihood function is:
</p>
<p>ln L =
&sum;
</p>
<p>xi ln λ&minus; ln(x1! &middot; &middot; &middot; xn !)&minus; nλ.
Differentiating with respect to λ yields
</p>
<p>&part; ln L
</p>
<p>&part;λ
= 1
</p>
<p>λ
</p>
<p>&sum;
</p>
<p>xi &minus; n != 0
which gives us the ML estimate:
</p>
<p>λ̂ = 1
n
</p>
<p>&sum;
</p>
<p>xi = x̄ .
</p>
<p>We need to confirm that the second derivative is &lt; 0 at λ̂ = x̄ ; otherwise, the
solution would be a minimum rather than a maximum. We get
</p>
<p>&part;2 ln L
</p>
<p>&part;λ2
= &minus; 1
</p>
<p>λ̂2
</p>
<p>&sum;
</p>
<p>xi = &minus;
n
</p>
<p>λ̂
&lt; 0.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 385
</p>
<p>It follows that the arithmetic mean x̄ = λ̂ is the maximum likelihood estimator
for the parameter λ of a Poisson distribution.
</p>
<p>(b) Using the results from (a) we can write the log-likelihood function for x1 =
4, x2 = 3, x3 = 8, x4 = 6, x5 = 6 as:
</p>
<p>ln L = 27 ln λ&minus; ln(4! 3! 8! 6! 6!)&minus; 5λ.
because
</p>
<p>&sum;
</p>
<p>xi = 27. We can write down this function in R as follows:
</p>
<p>MLP &lt;- function(lambda){
</p>
<p>27&lowast;log(lambda) - log(factorial(4)&lowast;...&lowast;factorial(6)) -
5&lowast;lambda
}
</p>
<p>The function can be plotted using the curve command:
</p>
<p>curve(MLP, from=0, to=10)
</p>
<p>Figure B.19 shows the log-likelihood function. It can be seen that the function
</p>
<p>reaches its maximum at x̄ = 5.4.
(c) Using (a) we can write the likelihood function as
</p>
<p>L(θ; x) =
n
&prod;
</p>
<p>i=1
f (xi ; θ) =
</p>
<p>n
&prod;
</p>
<p>i=1
</p>
<p>λxi
</p>
<p>xi !
e&minus;λ = λ
</p>
<p>&sum;
</p>
<p>xi
</p>
<p>&prod;
</p>
<p>xi !
e&minus;nλ = λ
</p>
<p>&sum;
</p>
<p>xi e&minus;nλ
︸ ︷︷ ︸
</p>
<p>g(t,λ)
</p>
<p>1
&prod;
</p>
<p>xi !
︸ ︷︷ ︸
</p>
<p>h(x1,...,xn)
</p>
<p>.
</p>
<p>Fig. B.19 Illustration of the
</p>
<p>log-likelihood function
</p>
<p>0 2 4 6 8 10
</p>
<p>&minus;
8
</p>
<p>0
&minus;
</p>
<p>6
0
</p>
<p>&minus;
4
</p>
<p>0
&minus;
</p>
<p>2
0
</p>
<p>λ
</p>
<p>lo
g
</p>
<p>&minus;
lik
</p>
<p>e
lih
</p>
<p>o
o
</p>
<p>d
</p>
<p>x=5.4</p>
<p/>
</div>
<div class="page"><p/>
<p>386 Appendix B: Solutions to Exercises
</p>
<p>This means T =
&sum;n
</p>
<p>i=1 xi is sufficient for λ. The arithmetic mean, which is
the maximum likelihood estimate, is a one-to-one function of T and therefore
</p>
<p>sufficient too.
</p>
<p>Solution to Exercise 9.2
</p>
<p>(a) The probability density function of a normal distribution equates to
</p>
<p>f (x) = 1
σ
&radic;
2π
</p>
<p>exp
</p>
<p>(
</p>
<p>&minus; (x &minus; μ)
2
</p>
<p>2σ2
</p>
<p>)
</p>
<p>with&infin; &lt; x &lt; &infin;,&minus;&infin; &lt; μ &lt; &infin;,σ2 &gt; 0. The likelihood function is therefore
</p>
<p>L(x1, x2, . . . , xn|μ,σ2) =
(
</p>
<p>1&radic;
2πσ2
</p>
<p>)n
</p>
<p>exp
</p>
<p>(
</p>
<p>&minus;
n
&sum;
</p>
<p>i=1
</p>
<p>(xi &minus; μ)2
2σ2
</p>
<p>)
</p>
<p>.
</p>
<p>To find the maximum of L(x1, x2, . . . , xn|μ,σ2), it is again easier to work with
the log-likelihood function, which is
</p>
<p>l = ln L(x1, x2, . . . , xn|μ,σ2) = &minus;
n
</p>
<p>2
ln 2π &minus; n
</p>
<p>2
ln σ2 &minus;
</p>
<p>n
&sum;
</p>
<p>i=1
</p>
<p>(
(xi &minus; μ)2
</p>
<p>2σ2
</p>
<p>)
</p>
<p>.
</p>
<p>Assuming σ2 to be 1, differentiating the log-likelihood function with respect to
</p>
<p>μ, and equating it to zero gives us
</p>
<p>&part;l
</p>
<p>&part;μ
= 2
</p>
<p>n
&sum;
</p>
<p>i=1
</p>
<p>(
xi &minus; μ
12
</p>
<p>)
</p>
<p>= 0 &hArr; nμ =
n
&sum;
</p>
<p>i=1
xi .
</p>
<p>The ML estimate is therefore μ̂ = x̄ .
(b) Looking at the differentiated log-likelihood function in (a) shows us that the ML
</p>
<p>estimate of μ is always the arithmetic mean, no matter whether σ2 is 1 or any
</p>
<p>other number.
</p>
<p>(c) Differentiating the log-likelihood function from (a) with respect to σ2 yields
</p>
<p>&part;l
</p>
<p>&part;σ2
= &minus;n
</p>
<p>2
</p>
<p>1
</p>
<p>σ2
+ 1
</p>
<p>2σ4
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; μ)2 = 0.
</p>
<p>Using μ̂ = x̄ we calculate &part;l
&part;σ2
</p>
<p>= 0 as
</p>
<p>σ̂2 = 1
n
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; μ̂)2 =
</p>
<p>1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; x̄)2.
</p>
<p>Since the parameter θ = (μ,σ2) is two-dimensional, it follows that one needs to
solve two ML equations, where μ̂ML is estimated first, and σ̂
</p>
<p>2
ML second (as we
</p>
<p>did above). It follows further that one needs to look at the positive definiteness</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 387
</p>
<p>of a matrix (the so-called information matrix) when checking that the second-
</p>
<p>order derivatives of the estimates are positive and therefore the estimates yield
</p>
<p>a maximum rather then a minimum. However, we omit this lengthy and time-
</p>
<p>consuming task here.
</p>
<p>Solution to Exercise 9.3 The probability density function of U (0, θ) is
</p>
<p>f (x) = 1
θ
</p>
<p>if 0 &lt; x &lt; θ and 0 otherwise.
</p>
<p>Note that this equates to the PDF from Definition 8.2.1 for a = 0 and b = θ. The
likelihood function is therefore
</p>
<p>L(x1, x2, . . . , xn|θ) =
(
1
</p>
<p>θ
</p>
<p>)n
</p>
<p>if 0 &lt; xi &lt; θ and 0 otherwise.
</p>
<p>One can see that L(x1, x2, . . . , xn|θ) increases as θ decreases. The maximum of
the likelihood function is therefore achieved for the smallest valid θ. In particular, θ is
</p>
<p>minimized when θ &ge; max (x1, x2, . . . , xn) = x(n). This follows from the definition
of the PDFwhich requires that 0 &lt; xi &lt; θ and therefore θ &gt; xi . Thus, the maximum
</p>
<p>likelihood estimate of θ is x(n), the greatest observed value in the sample.
</p>
<p>Solution to Exercise 9.4
</p>
<p>(a) Tn(X) is unbiased, and therefore also asymptotically unbiased, because
</p>
<p>E(Tn(X)) = E(nXmin)
(7.29)= n 1
</p>
<p>nλ
= 1
</p>
<p>λ
= μ.
</p>
<p>Similarly, Vn(X) is unbiased, and therefore also asymptotically unbiased,
</p>
<p>because
</p>
<p>E(Vn(X)) = E
(
</p>
<p>1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
X i
</p>
<p>)
</p>
<p>(7.29)= 1
n
</p>
<p>n
&sum;
</p>
<p>i=1
E(X i ) =
</p>
<p>1
</p>
<p>n
n
1
</p>
<p>λ
= μ.
</p>
<p>(b) To calculate the MSE we need to determine the bias and the variance of the
</p>
<p>estimators as we know from Eq. (9.5). It follows from (a) that both estimators
</p>
<p>are unbiased and hence the bias is 0. For the variances we get:
</p>
<p>Var(Tn(X)) = Var(nXmin)
(7.33)= n2Var(Xmin) = n2
</p>
<p>1
</p>
<p>n2λ2
= μ2.
</p>
<p>Var(Vn(X)) = Var
(
</p>
<p>1
</p>
<p>n
</p>
<p>n
&sum;
</p>
<p>i=1
X i
</p>
<p>)
</p>
<p>(7.33)= 1
n2
</p>
<p>n
&sum;
</p>
<p>i=1
Var(X i ) =
</p>
<p>1
</p>
<p>n2
n
1
</p>
<p>λ2
= 1
</p>
<p>n
μ2.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>388 Appendix B: Solutions to Exercises
</p>
<p>Since the mean squared error consists of the sum of the variance and squared
</p>
<p>bias, the MSE for Tn(X) and Vn(X) are μ
2 and n&minus;1μ2, respectively. One can
</p>
<p>see that the larger n, the more superior Vn(X) over Tn(X) in terms of the mean
</p>
<p>squared error. In other words, Vn(X) is more efficient than Tn(X) because its
</p>
<p>variance is lower for any n &gt; 1.
</p>
<p>(c) Using the results from (b), we get
</p>
<p>lim
n&rarr;&infin;
</p>
<p>MSE(Vn(X)) = lim
n&rarr;&infin;
</p>
<p>1
</p>
<p>n
μ2 = 0.
</p>
<p>Thismeans theMSEapproaches 0 asn tends to infinity. Therefore,Vn(X) isMSE
</p>
<p>consistent for μ. Since Vn(X) is MSE consistent, it is also weakly consistent.
</p>
<p>Solution to Exercise 9.5
</p>
<p>(a) The point estimate of μ is x̄ which is
</p>
<p>μ̂ = x̄ = 1
n
</p>
<p>n
&sum;
</p>
<p>i=1
xi =
</p>
<p>1
</p>
<p>24
(450+ &middot; &middot; &middot; + 790) = 667.92.
</p>
<p>The variance of σ2 can be estimated unbiasedly using s2:
</p>
<p>σ̂2 = s2 = 1
n &minus; 1
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; x̄)2
</p>
<p>= 1
23
</p>
<p>((450&minus; 667.92)2 + &middot; &middot; &middot; + (790&minus; 667.92)2) &asymp; 18, 035.
</p>
<p>(b) The variance is unknown and needs to be estimated. We thus need the t-
</p>
<p>distribution to construct the confidence interval. We can determine t23;0.975 &asymp;
2.07 usingqt(0.975,23) orTableC.2 (though the latter is not detailed enough),
</p>
<p>α = 0.05, x̄ = 667.97 and σ̂2 = 18, 035. This yields
</p>
<p>Il(X) = x̄ &minus; tn&minus;1;1&minus;α/2 &middot;
s&radic;
n
= 667.92&minus; t23;0.975 &middot;
</p>
<p>&radic;
18, 035&radic;
24
</p>
<p>&asymp; 611.17,
</p>
<p>Iu(X) = x̄ + tn&minus;1;1&minus;α/2 &middot;
s&radic;
n
667.92&minus; t23;0.975 &middot;
</p>
<p>&radic;
18, 035&radic;
24
</p>
<p>&asymp; 724.66.
</p>
<p>The confidence interval for μ is thus [611.17; 724.66].
</p>
<p>(c) We can reproduce these results in R as follows:
</p>
<p>eland &lt;- c(450,730,700,600,620,,790)
</p>
<p>t.test(eland)$conf.int</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 389
</p>
<p>Solution to Exercise 9.6
</p>
<p>&bull; Let us start with the confidence interval for the &ldquo;Brose Baskets Bamberg&rdquo;. Using
t15;0.975 = 2.1314 (qt(0.975,15) or Table C.2) andα = 0.05, we can determine
the confidence interval as follows:
</p>
<p>Il(Ba) = x̄ &minus; tn&minus;1;1&minus;α/2 &middot;
s&radic;
n
= 199.06&minus; t15;0.975 &middot;
</p>
<p>7.047&radic;
16
</p>
<p>= 195.305,
</p>
<p>Iu(Ba) = x̄ + tn&minus;1;1&minus;α/2 &middot;
s&radic;
n
= 199.06+ t15;0.975 &middot;
</p>
<p>7.047&radic;
16
</p>
<p>= 202.815.
</p>
<p>Thus, we get [195.305; 202.815].
&bull; For the &ldquo;Bayer Giants Leverkusen&rdquo;, we use t13;0.975 = 2.1604 to get
</p>
<p>Il(L) = x̄ &minus; tn&minus;1;1&minus;α/2 &middot;
s&radic;
n
= 196&minus; t13;0.975 &middot;
</p>
<p>9.782&radic;
14
</p>
<p>= 190.352,
</p>
<p>Iu(L) = x̄ + tn&minus;1;1&minus;α/2 &middot;
s&radic;
n
= 196+ t13;0.975 &middot;
</p>
<p>9.782&radic;
14
</p>
<p>= 201.648.
</p>
<p>This leads to a confidence interval of [190.352; 201.648].
&bull; For &ldquo;Werder Bremen&rdquo;, we need to use the quantile t22,0.975 = 2.0739 which yields
a confidence interval of
</p>
<p>Il(Br) = x̄ &minus; tn&minus;1;1&minus;α/2 &middot;
s&radic;
n
= 187.52&minus; t22;0.975 &middot;
</p>
<p>5.239&radic;
23
</p>
<p>= 185.255,
</p>
<p>Iu(Br) = x̄ + tn&minus;1;1&minus;α/2 &middot;
s&radic;
n
= 187.25+ t22;0.975 &middot;
</p>
<p>5.239&radic;
23
</p>
<p>= 189.786.
</p>
<p>The interval is therefore [185.255; 189.786].
&bull; The mean heights of the basketball teams are obviously larger than the mean
height of the football team. The two confidence intervals of the basketball teams
</p>
<p>overlap, whereas the intervals of the football team with the two basketball teams
</p>
<p>do not overlap. It is evident that this indicates that the height of football players is
</p>
<p>substantially less than the height of basketball players. In Chap. 10, we will learn
</p>
<p>that confidence intervals can be used to test hypotheses about mean differences.
</p>
<p>Solution to Exercise 9.7
</p>
<p>(a) Using n = 98, we calculate an unbiased point estimate for p using x̄ = p̂. Note
that xi = 1 if the wife has to wash the dishes.
</p>
<p>p̂ = 1
n
</p>
<p>n
&sum;
</p>
<p>i=1
xi =
</p>
<p>1
</p>
<p>98
&middot; 59 = 59
</p>
<p>98
&asymp; 0.602.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>390 Appendix B: Solutions to Exercises
</p>
<p>(b) Since n p̂(1&minus; p̂) = 98 &middot; 0.602 &middot; 0.398 = 23.48 &gt; 9 and p is sufficiently large,
we can use the normal approximation to calculate a confidence interval for p.
</p>
<p>Using z1&minus;α/2 = z0.975 = 1.96, we obtain
</p>
<p>Il(X) = 0.602&minus; 1.96
&radic;
</p>
<p>0.602 &middot; 0.398
98
</p>
<p>= 0.505,
</p>
<p>Iu(X) = 0.602+ 1.96
&radic;
</p>
<p>0.602 &middot; 0.398
98
</p>
<p>= 0.699.
</p>
<p>This yields a confidence interval of [0.505, 0.699]. Note that the confidence
interval does not contain p = 0.5which is the probability that would be expected
if the coin was fair. This is a clear sign that the coin might be unfair.
</p>
<p>(c) If the coin is fair, we can use p̂ = 0.5 as our prior judgement. We would then
need
</p>
<p>n &ge;
[ z1&minus;α/2
</p>
<p>Δ
</p>
<p>]2
p̂(1&minus; p̂)
</p>
<p>&ge;
[
1.96
</p>
<p>0.005
</p>
<p>]2
</p>
<p>0.52 = 38, 416
</p>
<p>dinners to get the desired precision&mdash;which is not possible as this would con-
</p>
<p>stitute a time period of more than 100 years. This shows that the expectation of
</p>
<p>such a high precision is unrealistic and needs to be modified. However, as the
</p>
<p>results of (b) show, the coin may not be fair. If the coin is indeed unfair, we may
</p>
<p>have, for example, p = 0.6 and 1&minus; p = 0.4 which gives a smaller sample size.
We can thus interpret the sample size as a conservative estimate of the highest
</p>
<p>number of dinners needed.
</p>
<p>Solution to Exercise 9.8 If a student fails then xi = 1. We know that
&sum;
</p>
<p>xi = 11 and
n = 104.
</p>
<p>(a) Using x̄ = p as point estimate, we get p̂ = 11104 &asymp; 0.106 = 10.6 %. Using
z1&minus;α/2 = z0.975 = 1.96, we can calculate the confidence interval as
</p>
<p>0.106&plusmn; 1.96 &middot;
&radic;
</p>
<p>0.106 &middot; 0.894
104
</p>
<p>= [0.047; 0.165] .
</p>
<p>Using R we get:
</p>
<p>binom.test(11,104)$conf.int
</p>
<p>[1] 0.05399514 0.18137316
</p>
<p>This result is different because the above command does not use the normal
</p>
<p>approximation. In addition, p is rather small which means that care must be
</p>
<p>exercised when using the results of the confidence interval with normal approx-
</p>
<p>imation in this context.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 391
</p>
<p>(b) The point estimate of 10.6% is substantially higher than 3.2%. The lower bound
</p>
<p>confidence interval is still larger than the proportion of failures at county level.
</p>
<p>This indicates that the school is doing worse than most other schools in the
</p>
<p>county.
</p>
<p>Solution to Exercise 9.9
</p>
<p>(a) Whether the i th household has switched on the TV and watches &ldquo;Germany&rsquo;s
</p>
<p>next top model&rdquo; (GNTM) relates to a random variable X i with
</p>
<p>X i = 1 : if TV switched on and household watching GNTM
X i = 0 : if TV switched off or household watches another show.
</p>
<p>It follows that X =
&sum;2500
</p>
<p>i=1 X i is the random variable describing the number of
TVs, out of 2500 TVs, which are switched on and show GNTM. Since the X i &rsquo;s
</p>
<p>can be assumed to be i.i.d., we can say that X follows a binomial distribution,
</p>
<p>i.e. X &sim; B(2500; p) with p unknown. The length of the confidence interval for
p,
</p>
<p>[
</p>
<p>p̂ &minus; z1&minus;α/2
&radic;
</p>
<p>p̂(1&minus; p̂)
n
</p>
<p>, p̂ + z1&minus;α/2
&radic;
</p>
<p>p̂(1&minus; p̂)
n
</p>
<p>]
</p>
<p>,
</p>
<p>is
</p>
<p>L = 2z1&minus;α/2
&radic;
</p>
<p>p̂(1&minus; p̂)
n
</p>
<p>.
</p>
<p>Unfortunately, p̂(1&minus; p̂) is unknown but p̂(1&minus; p̂) &le; 14 because the maximum
value for p̂(1&minus; p̂) is 0.25 if p̂ = 0.5. Hence
</p>
<p>L &le; 2z1&minus;α/2
</p>
<p>&radic;
</p>
<p>1
4
</p>
<p>n
= 1.96&radic;
</p>
<p>2500
= 0.0392.
</p>
<p>Thismeans the precision is half the length, i.e.&plusmn;0.0196 = &plusmn;1.96%, in theworst
case.
</p>
<p>(b) There is the danger of selection bias. A total of 500 households refused to
</p>
<p>take part in the study. It may be that their preferences regarding TV shows are
</p>
<p>different from the other 2500 households. For example, it may well be possible
</p>
<p>that those watching almost no TV refuse to be included; or that those watching
</p>
<p>TV shows which are considered embarrassing by society are refusing as well.
</p>
<p>In general, missing data may cause point estimates to be biased, depending on
</p>
<p>the underlying mechanism causing the absence.</p>
<p/>
</div>
<div class="page"><p/>
<p>392 Appendix B: Solutions to Exercises
</p>
<p>Solution to Exercise 9.10
</p>
<p>(a) Using z1&minus;α/2 = 1.96 and σ̂ = 0.233, we obtain an optimal sample size of at
least
</p>
<p>nopt &ge;
[
</p>
<p>2
z1&minus;α/2σ0
</p>
<p>Δ
</p>
<p>]2
=
</p>
<p>[
</p>
<p>2 &middot; 1.96 &middot; 0.233
0.2
</p>
<p>]2
</p>
<p>= 20.85.
</p>
<p>To calculate a confidence interval with a width of not more than 0.2 s, the results
</p>
<p>of at least 21 athletes are needed.
</p>
<p>(b) The sample size is 30. Thus, the confidence interval width should be smaller
</p>
<p>than 0.2 s. This is indeed true as the calculations show:
</p>
<p>[10.93&plusmn; t0.975;29
︸ ︷︷ ︸
</p>
<p>2.045
</p>
<p>&middot;0.233&radic;
30
</p>
<p>] = [10.84; 11.02].
</p>
<p>The width is only 0.18 s.
</p>
<p>(c) If we calculate a 80 % confidence interval, then the lower confidence limit
</p>
<p>corresponds to the running time which is achieved by only 10 % of the athletes
</p>
<p>(of the population). Using t0.9;29 &asymp; 1.31 we get
</p>
<p>[10.93&plusmn; 1.31 &middot; 0.233&radic;
30
</p>
<p>] = [10.87; 10.99].
</p>
<p>The athlete&rsquo;s best time is thus below the lower confidence limit. He is among
</p>
<p>the top 10 % of all athletes, using the results of the confidence interval.
</p>
<p>Solution to Exercise 9.11
</p>
<p>(a) The odds ratio is
</p>
<p>O R = 163 &middot; 477
475 &middot; 151 &asymp; 1.08.
</p>
<p>This means the chances that a pizza arrives in time are about 1.08 times higher
</p>
<p>for Laura compared with Melissa. To calculate the 95 % confidence interval, we
</p>
<p>need θ̂0 = ln(1.08) &asymp; 0.077, z1&minus;α/2 &asymp; 1.96, and
</p>
<p>σ̂
θ̂0
</p>
<p>=
(
</p>
<p>1
</p>
<p>163
+ 1
</p>
<p>475
+ 1
</p>
<p>151
+ 1
</p>
<p>477
</p>
<p>) 1
2
</p>
<p>= 0.13.
</p>
<p>The interval for the log odds ratio is
</p>
<p>[ln(1.08)&plusmn; 1.96 &middot; 0.13] &asymp; [&minus;0.18; 0.33] .
Exponentiating the interval gives us the 95 % confidence interval for the odds
</p>
<p>ratio which is [0.84; 1.39]. This indicates that the odds of Laura&rsquo;s pizzas arriving
earlier than Melissa&rsquo;s are not much different from one. While the point estimate
</p>
<p>tells us that Laura&rsquo;s pizzas are delivered 1.08 times faster, the confidence interval
</p>
<p>tells us that there is uncertainty around this estimate in the sense that it could
</p>
<p>also be smaller than 1 and Melissa may not necessarily work more slowly than
</p>
<p>Laura.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 393
</p>
<p>(b) We can reproduce the results in R by attaching the pizza data, creating a cat-
</p>
<p>egorical delivery time variable (using cut) and then applying the oddsratio
</p>
<p>command from the library epitools onto the contingency table:
</p>
<p>attach(pizza)
</p>
<p>timecat &lt;- cut(time, breaks=c(-1,30,150))
</p>
<p>library(epitools)
</p>
<p>oddsratio(table(timecat,operator), method='wald')
</p>
<p>Chapter 10
</p>
<p>Solution to Exercise 10.1 A type I error is defined as the probability of rejecting H0
if H0 is true. This error occurs if A thinks that B does confess, but B does not. In this
</p>
<p>scenario, A confesses, goes free, and B serves a three-year sentence. A type II error
</p>
<p>is defined as the probability of accepting H0, despite the fact that H0 is wrong. In
</p>
<p>this case, B does confess, but A does not. In this scenario, B goes free and A serves
</p>
<p>a three-year sentence. A type II error is therefore worse for A. With a statistical test,
</p>
<p>we always control the type I error, but not the type II error.
</p>
<p>Solution to Exercise 10.2
</p>
<p>(a) The hypotheses are
</p>
<p>H0 : μ = 100 versus H1 : μ �= 100.
</p>
<p>(b) It is a one-sample problem for μ: thus, for known variance, the Gauss test can
</p>
<p>be used; the t-test otherwise, see also Appendix D. Since, in this exercise, σ
</p>
<p>is assumed to be known we can use the Gauss test; i.e. we can compare the
</p>
<p>test statistic with the normal distribution (as opposed to the t-distribution when
</p>
<p>using the t-test). The sample size is small: we must therefore assume a normal
</p>
<p>distribution for the data.
</p>
<p>(c) To calculate the realized test statistic, we need the arithmetic mean x̄ = 98.08.
Then we obtain
</p>
<p>t (x) = x̄ &minus; μ
σ
</p>
<p>&middot;
&radic;
</p>
<p>n = 98.08&minus; 100
2
</p>
<p>&middot;
&radic;
15 = &minus;1.92
</p>
<p>2
&middot;
&radic;
15 = &minus;3.72.
</p>
<p>We reject H0 if |t (x)| &gt; z1&minus; α2 = 1.96. Since |t (x)| = 3.72 &gt; 1.96, the null
hypothesis can be rejected. The test is significant. There is enough evidence
</p>
<p>to suggest that the observed weights do not come from a normal distribution
</p>
<p>with mean 100 g.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>394 Appendix B: Solutions to Exercises
</p>
<p>(d) To show thatμ &lt; 100, we need to conduct a one-sided test.Most importantly, the
</p>
<p>research hypothesis of interest needs to be stated as the alternative hypothesis:
</p>
<p>H0 : μ &ge; 100 versus H1 : μ &lt; 100.
</p>
<p>(e) The test statistic is the same as in (b): t (x) = &minus;3.72. However, the critical region
changes. H0 gets rejected if t (x) &lt; &minus;z1&minus;α = &minus;1.64. Again, the null hypothesis
is rejected. The producer was right in hypothesizing that the average weight of
</p>
<p>his chocolate bars was lower than 100 g.
</p>
<p>Solution to Exercise 10.3
</p>
<p>(a) We calculate
</p>
<p>No auction Auction
</p>
<p>x̄ 16.949 10.995
</p>
<p>s2 2.948 2.461
</p>
<p>s 1.717 1.569
</p>
<p>v 0.101 0.143
</p>
<p>Note that we use the unbiased estimates for the variance and the standard devia-
</p>
<p>tion as explained in Chap. 9; i.e. we use 1/(n &minus; 1) rather than 1/n. It is evident
that the mean price of the auctions (μa) is lower than the mean non-auction
</p>
<p>price (μna), and also lower than the price from the online book store. There is,
</p>
<p>however, a higher variability in relation to the mean for the auction prices. One
</p>
<p>may speculate that the best offers are found in the auctions, but that there are no
</p>
<p>major differences between the online store and the internet book store, i.e.
</p>
<p>&bull; μna �= e16.95,
&bull; μa &lt; e16.95,
&bull; μna &gt; μa .
</p>
<p>(b) We can use the t-test to test the hypotheses
</p>
<p>H0 : μna = 16.95 versus H1 : μna �= 16.95.
The test statistic is
</p>
<p>t (x) = x̄ &minus; μ
σ
</p>
<p>&middot;
&radic;
</p>
<p>n = 16.949&minus; 16.95
1.717
</p>
<p>&middot;
&radic;
14 = &minus;0.002.
</p>
<p>Using the decision rules from Table 10.2, we conclude that H0 gets rejected if
</p>
<p>|t (x)| &gt; t13,0.975 = 2.16. We can calculate t13,0.975 either by using Table C.2
or by using R (qt(0.975,13)). Since |t (x)| = 0.002 ≯ 2.16, we keep the null
hypothesis. There is not enough evidence to suggest that the prices of the online
</p>
<p>store differ from e16.95 (which is the price from the internet book store).</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 395
</p>
<p>(c) Using (9.6) we can calculate the upper and lower limits of the confidence interval
</p>
<p>as,
</p>
<p>x̄ + tn&minus;1;1&minus;α/2 &middot;
sX&radic;
</p>
<p>n
= 16.949+ t13;0.975
</p>
<p>︸ ︷︷ ︸
</p>
<p>=2.16
</p>
<p>&middot;1.717&radic;
14
</p>
<p>= 17.94
</p>
<p>x̄ &minus; tn&minus;1;1&minus;α/2 &middot;
sX&radic;
</p>
<p>n
= 16.949&minus; t13;0.975
</p>
<p>︸ ︷︷ ︸
</p>
<p>=2.16
</p>
<p>&middot;1.717&radic;
14
</p>
<p>= 15.96
</p>
<p>respectively. The confidence interval does contain μ0 = 16.95; hence, the null
hypothesis μ = μ0 = 16.95 cannot be rejected. This is the same conclusion as
obtained from the one-sample t-test from above.
</p>
<p>(d) We test the following hypotheses:
</p>
<p>H0 : μa &ge; 16.95 versus H1 : μa &lt; 16.95.
The realized test statistic is
</p>
<p>t (x) = x̄ &minus; μ
σ
</p>
<p>&middot;
&radic;
</p>
<p>n = 10.995&minus; 16.95
1.569
</p>
<p>&middot;
&radic;
14 = &minus;14.201.
</p>
<p>Table 10.2 tells us that H0 gets rejected if t (x) &lt; &minus;t13,0.95. Since &minus;14.201 &lt;
&minus;2.16 we reject H0. The test confirms our hypothesis that the mean auction
prices are lower than e16.95, i.e. the price from the book store.
</p>
<p>(e) We need to conduct two tests: the two-sample t-test for the assumption of equal
</p>
<p>variances and the Welch test for the assumption of different variances.
</p>
<p>(i) Two-sample t-test:
</p>
<p>H0 : μna &le; μa versus H1 : μna &gt; μa .
To calculate the test statistic (10.4), we need to determine the pooled sample
</p>
<p>variance:
</p>
<p>s2 = (nna &minus; 1)s
2
na + (na &minus; 1)s2a
</p>
<p>nna + na &minus; 2
</p>
<p>= (14&minus; 1)2.948+ (14&minus; 1)2.461
14+ 14&minus; 2 &asymp; 2.705
</p>
<p>The test statistic is
</p>
<p>t (x) = x̄na &minus; x̄a
s
</p>
<p>&middot;
&radic;
</p>
<p>nna &middot; na
nna + na
</p>
<p>= 16.949&minus; 10.995&radic;
2.705
</p>
<p>&middot;
&radic;
</p>
<p>14 &middot; 14
14+ 14
</p>
<p>= 5.954
1.645
</p>
<p>&middot;
&radic;
</p>
<p>196
</p>
<p>28
= 3.621 &middot;
</p>
<p>&radic;
7 = 9.578.
</p>
<p>We reject H0 if t (x) &gt; tnna+na&minus;2,0.95 = t26,0.95 = 1.71. Table C.2 does not
list the quantile; thus, one uses R (qt(0.95,26)) to determine the quantile.
</p>
<p>Since 9.578 &gt; 1.71, we reject the null hypothesis. The test is significant.
</p>
<p>There is enough evidence to conclude that the mean auction prices are lower
</p>
<p>than the mean non-auction prices.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>396 Appendix B: Solutions to Exercises
</p>
<p>(ii) Welch test: For the Welch test, we calculate the test statistic, using (10.6)
</p>
<p>as:
</p>
<p>t (x) = |x̄na &minus; x̄a |&radic;
s2na
nna
</p>
<p>+ s
2
a
</p>
<p>na
</p>
<p>= |16.949&minus; 10.995|&radic;
2.948
14 +
</p>
<p>2.461
14
</p>
<p>= 9.578.
</p>
<p>To calculate the critical value, we need the degrees of freedom:
</p>
<p>v =
(
</p>
<p>s2na
</p>
<p>nna
+ s
</p>
<p>2
a
</p>
<p>na
</p>
<p>)2
</p>
<p>/
</p>
<p>((
</p>
<p>s2na/nna
)2
</p>
<p>nna &minus; 1
+
</p>
<p>(
</p>
<p>s2a/na
)2
</p>
<p>na &minus; 1
</p>
<p>)
</p>
<p>=
(
2.948
</p>
<p>14
+ 2.461
</p>
<p>14
</p>
<p>)2
</p>
<p>/
</p>
<p>(
</p>
<p>(2.948/14)2
</p>
<p>13
+ (2.461/14)
</p>
<p>2
</p>
<p>13
</p>
<p>)
</p>
<p>&asymp; 25.79
We reject H0 if t (x) &gt; tv,0.95. Using tv,0.95 = 1.706 (in R obtained as
qt(0.95,25.79)) and t (x) = 9.578, we reject the null hypothesis. The
conclusions are identical to using the two-sample t-test (in this example).
</p>
<p>Interestingly, the two test statistics are similar which indicates that the
</p>
<p>assumption of equal variances in case (i) was not unreasonable.
</p>
<p>(f) The F-test relies on the assumption of the normal distribution and tests the
</p>
<p>hypotheses:
</p>
<p>H0 : σ2na = σ2a versus H1 : σ2na �= σ2a .
We can calculate the test statistic as described in Appendix C:
</p>
<p>t (x) = s
2
na
</p>
<p>s2a
= 2.949
</p>
<p>2.461
= 1.198.
</p>
<p>The F-distribution is not symmetric around 0; thus, we need to calculate two crit-
</p>
<p>ical values: fn1&minus;1;n2&minus;1;1&minus;α/2 and fn1&minus;1;n2&minus;1;α/2. Using R we get f13,13,0.975 =
3.115 (qf(0.975,13,13)) and f13,13,0.025 = 13.115 = 0.321 (qf(0.025,13,13)).
H0 is rejected if t (x) &gt; fn1&minus;1;n2&minus;1;1&minus;α/2 or t (x) &lt; fn1&minus;1;n2&minus;1;α/2. Since0.321 &lt;
1.198 &lt; 3.115 we do not reject H0. This means there is strong evidence that the
</p>
<p>two variances are equal. This is also reassuring with respect to using the two-
</p>
<p>sample t-test above (which assumes equal variances). However, note that testing
</p>
<p>the equality of variances with the F-test and then using the two-sample t-test or
</p>
<p>Welch test based on the outcome of the F-test is not ideal and not necessarily
</p>
<p>correct. In practice, it is best to simply use the Welch test (rather than the t-test),
</p>
<p>which is also the default option in the R function t.test.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 397
</p>
<p>(g) We need the following table to calculate the rank sums:
</p>
<p>Value 9.3 9.52 9.54 10.01 10.5 10.5 10.55 10.59 11.02 11.03
</p>
<p>Sample a a a a a a a a a a
</p>
<p>Rank 1 2 3 4 5 6 7 8 9 10
</p>
<p>Value 11.89 11.99 12 13.79 15.49 15.9 15.9 15.9 15.9 15.9
</p>
<p>Sample a a a na a na na na na na
</p>
<p>Rank 11 12 13 14 15 16 17 18 19 20
</p>
<p>Value 15.99 16.98 16.98 17.72 18.19 18.19 19.97 19.97
</p>
<p>Sample na na na na na na na na
</p>
<p>Rank 21 22 23 24 25 26 27 28
</p>
<p>We can calculate the rank sums as Rna+ = 13+ 15+ &middot; &middot; &middot; + 28 = 300 and
Ra+ = 1+ 2+ &middot; &middot; &middot; + 13+ 15 = 106, respectively. Thus
</p>
<p>U1 = 142 +
14 &middot; 15
</p>
<p>2
&minus; 106 = 195; U2 = 142 +
</p>
<p>14 &middot; 15
2
</p>
<p>&minus; 300 = 1.
</p>
<p>With U = min(195, 1) = 1 we can calculate the test statistic, which is approx-
imately normally distributed, as:
</p>
<p>t (x, y) =
U &minus; n1&middot;n22
</p>
<p>&radic;
</p>
<p>n1 &middot; n2 &middot; (n1 + n2 + 1)
12
</p>
<p>=
1&minus; 1422
</p>
<p>&radic;
</p>
<p>14 &middot; 14 &middot; 29
12
</p>
<p>&asymp; &minus;4.46
</p>
<p>Since |t (x, y)| = 4.46 &gt; z1&minus;α/2 = 1.96, the null hypothesis can be rejected.We
conclude that the locations of the two distributions are shifted. Obviously the
</p>
<p>prices of the auction are smaller in general, and so is the median.
</p>
<p>(h) We can type in the data and evaluate the summary statistics using the mean,
</p>
<p>var, and sd commands:
</p>
<p>na &lt;- c(18.19,16.98,19.97,...,17.72)
</p>
<p>a &lt;- c(10.5,12.0, 9.54,..., 11.02)
</p>
<p>mean(na)
</p>
<p>mean(a)
</p>
<p>var(na)
</p>
<p>...
</p>
<p>The t.test command can be used to answer questions (b)&ndash;(e). For (b) and (c)
</p>
<p>we use
</p>
<p>t.test(na,mu=16.95)</p>
<p/>
</div>
<div class="page"><p/>
<p>398 Appendix B: Solutions to Exercises
</p>
<p>One-sample t-test
</p>
<p>data: na
</p>
<p>t = -0.0031129, df = 13, p-value = 0.9976
</p>
<p>alternative hypothesis: true mean is not equal to 16.95
</p>
<p>95 percent confidence interval:
</p>
<p>15.95714 17.94001
</p>
<p>sample estimates:
</p>
<p>mean of x
</p>
<p>16.94857
</p>
<p>The test decision can bemade bymeans of either the p-value (= 0.9976 &gt; 0.05)
or the confidence interval ([15.95; 17.94], which covers 16.95). To answer (d)
</p>
<p>and (e) we need to make use of the option alternative which specifies the
</p>
<p>alternative hypothesis:
</p>
<p>t.test(a,mu=16.95,alternative='less')
</p>
<p>t.test(na,a, alternative='greater')
</p>
<p>Note that the two-sample test provides a confidence interval for the difference
</p>
<p>of the means. Questions (f) and (g) can be easily solved by using the var.test
</p>
<p>and wilcox.test commands:
</p>
<p>var.test(na,a)
</p>
<p>wilcox.test(na,a)
</p>
<p>F-test to compare two variances
</p>
<p>data: na and a
</p>
<p>F = 1.198, num df = 13, denom df = 13, p-value = 0.7496
</p>
<p>alternative hypothesis: true ratio of variances not equal to 1
</p>
<p>95 percent confidence interval:
</p>
<p>0.3845785 3.7317371
</p>
<p>sample estimates:
</p>
<p>ratio of variances
</p>
<p>1.197976
</p>
<p>Wilcoxon rank sum test with continuity correction
</p>
<p>data: na and a
</p>
<p>W = 195, p-value = 8.644e-06
</p>
<p>alternative hypothesis: true location shift is not equal to 0</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 399
</p>
<p>The test decision is best made by using the p-value.
</p>
<p>Solution to Exercise 10.4 Since the data before and after the diet is dependent
</p>
<p>(weight measured on the same subjects), we need to use the paired t-test. To calculate
</p>
<p>the test statistic, we need to first determine the weight differences:
</p>
<p>Person i 1 2 3 4 5 6 7 8 9 10
</p>
<p>Before diet 80 95 70 82 71 70 120 105 111 90
</p>
<p>After diet 78 94 69 83 65 69 118 103 112 88
</p>
<p>Differences d 2 1 1 &minus;1 6 1 2 2 &minus;1 2
</p>
<p>Using d̄ = 1.5 and
</p>
<p>s2d =
1
</p>
<p>10&minus; 1 &middot; (0.5
2 + 0.52 + 0.52 + 2.52 + 4.52 + &middot; &middot; &middot; + 0.52) = 3.83,
</p>
<p>we calculate the test statistic as
</p>
<p>t (d) = d̄
sd
</p>
<p>&radic;
n = 1.5&radic;
</p>
<p>3.83
</p>
<p>&radic;
10 = 2.42.
</p>
<p>The null hypothesis is rejected because |t (d)| = 2.42 &gt; t9;0.975 = 2.26. This means
the mean weight before and after the diet is different. We would have obtained the
</p>
<p>same results by calculating the confidence interval for the differences:
</p>
<p>[
</p>
<p>d̄ &plusmn; tn&minus;1;1&minus;α/2
sd&radic;
</p>
<p>n
</p>
<p>]
</p>
<p>&hArr;
[
</p>
<p>1.5&plusmn; 2.26 &middot;
&radic;
3.83&radic;
10
</p>
<p>]
</p>
<p>= [0.1; 2.9].
</p>
<p>Since the confidence interval does not overlapwith zero,we reject the null hypothesis;
</p>
<p>there is enough evidence that the mean difference is different (i.e. greater) from zero.
</p>
<p>While the test is significant and suggests a weight difference, it is worth noting that
</p>
<p>the mean benefit from the diet is only 1.5 kg. Whether this is a relevant reduction in
</p>
<p>weight has to be decided by the ten people experimenting with the diet.
</p>
<p>Solution to Exercise 10.5
</p>
<p>(a) The production is no longer profitable if the probability of finding a deficient
</p>
<p>shirt is greater than 10 %. This equates to the hypotheses:
</p>
<p>H0 : p &le; 0.1 versus H0 : p &gt; 0.1.</p>
<p/>
</div>
<div class="page"><p/>
<p>400 Appendix B: Solutions to Exercises
</p>
<p>The sample proportion of deficient shirts is p̂ = 35230 =
7
46 . Since np(1&minus; p) =
</p>
<p>230 &middot; 110 &middot;
9
10 &gt; 9 we can use the test statistic
</p>
<p>t (x) = p̂ &minus; p0&radic;
p0(1&minus; p0)
</p>
<p>&radic;
n =
</p>
<p>7
46 &minus;
</p>
<p>1
10
</p>
<p>&radic;
</p>
<p>1
10 &middot;
</p>
<p>9
10
</p>
<p>&middot;
&radic;
230
</p>
<p>= 6
115
</p>
<p>&middot; 10
3
</p>
<p>&middot;
&radic;
230 = 4
</p>
<p>23
&middot;
&radic;
230 = 2.638.
</p>
<p>The null hypothesis gets rejected because t (x) = 2.638 &gt; z0.95 = 1.64. It seems
the production is no longer profitable.
</p>
<p>(b) The test statistic is t (x) =
&sum;
</p>
<p>xi = 30. The critical region can be determined by
calculating
</p>
<p>PH0(Y &le; cl) &le; 0.025 and PH0(Y &ge; cr ) &le; 0.975.
Using R we get
</p>
<p>qbinom(p=0.975,prob=0.1,size=230)
</p>
<p>[1] 32
</p>
<p>qbinom(p=0.025,prob=0.1,size=230)
</p>
<p>[1] 14
</p>
<p>The test statistic (t (x) = 30) does not fall outside the critical region ([14; 32]);
therefore, the null hypothesis is not rejected. The same result is obtained by
</p>
<p>using the binomial test in R: binom.test(c(30,200),p=0.1). This yields
</p>
<p>a p-value of 0.11239 and a confidence interval covering 10 % ([0.09; 0.18]).
</p>
<p>Interestingly, the approximate binomial test rejects the null hypothesis, whereas
</p>
<p>the exact test keeps it. Since the latter test is more precise, it is recommended to
</p>
<p>follow its outcome.
</p>
<p>(c) The research hypothesis is that the newmachine produces fewer deficient shirts:
</p>
<p>H0 : pnew &ge; pold versus H1 : pnew &lt; pold.
To calculate the test statistic, we need the following:
</p>
<p>d̂ = xnew
nnew
</p>
<p>&minus; xold
nold
</p>
<p>= 7
115
</p>
<p>&minus; 7
46
</p>
<p>= &minus; 21
230
</p>
<p>p̂ = xnew + xold
nnew + nold
</p>
<p>= 7+ 35
230+ 115 =
</p>
<p>42
</p>
<p>345
= 14
</p>
<p>115
.
</p>
<p>This yields:
</p>
<p>t (xnew, xold) =
d̂
</p>
<p>&radic;
</p>
<p>p̂(1&minus; p̂)( 1
nnew
</p>
<p>+ 1
nold
</p>
<p>)
</p>
<p>=
&minus; 21230
</p>
<p>&radic;
</p>
<p>14
115 &middot;
</p>
<p>101
115 (
</p>
<p>1
115 +
</p>
<p>1
230 )
</p>
<p>=
&minus; 21230&radic;
</p>
<p>0.1069 &middot; 0.013
= &minus;0.0913
</p>
<p>0.0373
= &minus;2.448.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 401
</p>
<p>The null hypothesis is rejected because t (xnew, xold) = &minus;2.448 &lt; z0.05 =
&minus;z0.95 = &minus;1.64. This means we accept the alternative hypothesis that the new
machine is better than the old one.
</p>
<p>(d) The data can be summarized in the following table:
</p>
<p>Machine 1 Machine 2
</p>
<p>Deficient 30 7
</p>
<p>Fine 200 112
</p>
<p>To test the hypotheses established in (c), we apply the fisher.test command
</p>
<p>onto the contingency table:
</p>
<p>fisher.test(matrix(c(30,200,7,112),ncol=2))
</p>
<p>This yields a p-value of 0.0438 suggesting, as the test in (c), that the null hypoth-
</p>
<p>esis should be rejected. Note that the confidence interval for the odds ratio, also
</p>
<p>reported by R, does not necessarily yield the same conclusion as the test of
</p>
<p>Fisher.
</p>
<p>Solution to Exercise 10.6
</p>
<p>(a) To compare the two means, we should use the Welch test (since the variances
</p>
<p>cannot be assumed to be equal). The test statistic is
</p>
<p>t (x, y) = |x̄ &minus; ȳ|&radic;
s22
n2
</p>
<p>+ s
2
1
</p>
<p>n1
</p>
<p>= |103&minus; 101.8|&radic;
12599.56
</p>
<p>10 +
62.84
10
</p>
<p>&asymp; 0.0337.
</p>
<p>The alternative hypothesis is H1 : μ2 &gt; μ1; i.e. we deal with a one-sided hypoth-
esis. The null hypothesis is rejected if t (x, y) &gt; tv;1&minus;α. Calculating
</p>
<p>v =
(
</p>
<p>s21
</p>
<p>n1
+ s
</p>
<p>2
2
</p>
<p>n2
</p>
<p>)2
</p>
<p>/
</p>
<p>((
</p>
<p>s21/n1
)2
</p>
<p>n1 &minus; 1
+
</p>
<p>(
</p>
<p>s22/n2
)2
</p>
<p>n2 &minus; 1
</p>
<p>)
</p>
<p>=
(
62.844
</p>
<p>10
+ 12599
</p>
<p>10
</p>
<p>)2
</p>
<p>/
</p>
<p>(
</p>
<p>(62.844/10)2
</p>
<p>9
+ (12599/10)
</p>
<p>2
</p>
<p>9
</p>
<p>)
</p>
<p>&asymp; 9.09
</p>
<p>yields t9.09;0.95 = 1.831 (using qt(0.95,9.09) in R; or looking at Table C.2
for 9 degrees of freedom). Therefore, t (x, y) &lt; t9.09;0.95 and the null hypothesis
is not rejected. This means player 2 could not prove that he scores higher on
</p>
<p>average.</p>
<p/>
</div>
<div class="page"><p/>
<p>402 Appendix B: Solutions to Exercises
</p>
<p>(b) We have to first rank the merged data:
</p>
<p>Value 6 29 40 47 47 64 87 88 91 98
</p>
<p>Sample 2 2 2 2 2 2 2 1 1 2
</p>
<p>Rank 1 2 3 4 5 6 7 8 9 10
</p>
<p>Value 99 99 101 104 105 108 111 112 261 351
</p>
<p>Sample 1 1 1 1 1 1 1 1 2 2
</p>
<p>Rank 11 12 13 14 15 16 17 18 19 20
</p>
<p>This gives us R1+ = 8+ 9+ &middot; &middot; &middot; + 18 = 133, R2+ = 1+ 2+ &middot; &middot; &middot; + 20 = 77,
U1 = 102 + (10 &middot; 11)/2&minus; 133 = 22,U2 = 102 + (10 &middot; 11)/2&minus; 77 = 78, and
therefore U = 22. The test statistic can thus be calculated as
</p>
<p>t (x, y) =
U &minus; n1&middot;n22
</p>
<p>&radic;
</p>
<p>n1 &middot; n2 &middot; (n1 + n2 + 1)
12
</p>
<p>=
22&minus; 1022
</p>
<p>&radic;
</p>
<p>10 &middot; 10 &middot; 21
12
</p>
<p>&asymp;= &minus;2.12.
</p>
<p>Since |t (x, y)| = 2.12 &gt; z1&minus;α = 1.64, the null hypothesis is rejected. The test
supports the alternative hypothesis of higher points for player 1. The U -test has
</p>
<p>the advantage of not being focused on the expectation μ. The two samples are
</p>
<p>clearly different: the second player scores with much more variability and his
</p>
<p>distribution of scores is clearly not symmetric and normally distributed. Since
</p>
<p>the sample is small, and the assumption of a normal distribution is likely not
</p>
<p>met, it makes sense to not use the t-test. Moreover, because the distribution is
</p>
<p>skewed the mean may not be a sensible measure of comparison. The two tests
</p>
<p>yield different conclusions in this example which shows that one needs to be
</p>
<p>careful in framing the right hypotheses. A drawback of the U -test is that it uses
</p>
<p>only ranks and not the raw data: it thus uses less information than the t-test
</p>
<p>which would be preferred when comparing means of a reasonably sized sample.
</p>
<p>Solution to Exercise 10.7 Otto speculates that the probability of finding a bear
</p>
<p>of colour i is 0.2, i.e. pwhite = 0.2, pred = 0.2, porange = 0.2, pyellow = 0.2, and
pgreen = 0.2. This hypothesis can be tested by using the χ2 goodness-of-fit test.
The test statistic is
</p>
<p>t (x) = χ2 =
k
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>(Ni &minus; npi )2
npi
</p>
<p>= 1
250
</p>
<p>(222&minus; 250)2 + (279&minus; 250)2
</p>
<p>+ (251&minus; 250)2 + (232&minus; 250)2 + (266&minus; 250)2 = 8.824.
The null hypothesis cannot be rejected because t (x) = 8.824 ≯ c4&minus;1&minus;0;0.95 = 9.49.
While the small number of white bears might be disappointing, the test suggests that
</p>
<p>there is not enough evidence to reject the hypothesis of equal probabilities.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 403
</p>
<p>Solution to Exercise 10.8
</p>
<p>(a) To answer this question, we need to conduct the χ2-independence test. The test
</p>
<p>statistic t (x, y) is identical to Pearson&rsquo;s χ2 statistic, introduced in Chap. 4. In
</p>
<p>Exercise 4.4, we have calculated this statistic already, χ2 &asymp; 182, see p. 350
for the details. The null hypothesis of independence is rejected if t (x, y) =
χ2 &gt; c(I&minus;1)(J&minus;1);1&minus;α. With I = 2 (number of rows), and J = 4 (number of
columns) we get c3;0.95 = 7.81 using Table C.3 (or qchisq(0.95,3) in R).
Since 182 &gt; 7.81, we reject the null hypothesis of independence.
</p>
<p>(b) The output refers to a χ2 test of homogeneity: the null hypothesis is that the
</p>
<p>proportion of passengers rescued is identical for the different travel classes. This
</p>
<p>hypothesis is rejected because p is smaller than α = 0.05. It is evident that the
proportions of rescued passengers in the first two classes (60%, 43.9%) aremuch
</p>
<p>higher than in the other classes (25 %, 23.8 %). One can see that the test statistic
</p>
<p>(182.06) is identical to (a). This is not surprising: the χ2-independence test and
</p>
<p>the χ2 test of homogeneity are technically identical, but the null hypotheses
</p>
<p>differ. In (a), we showed that &ldquo;rescue status&rdquo; and &ldquo;travel class&rdquo; are independent;
</p>
<p>in (b), we have seen that the conditional distributions of rescue status given travel
</p>
<p>class differ by travel class, i.e. that the proportions of those rescued differ by the
</p>
<p>categories 1. class/2. class/3. class/staff.
</p>
<p>(c) The summarized table is as follows:
</p>
<p>1. Class/2. Class 3. Class/Staff Total
</p>
<p>Rescued 327 391 718
</p>
<p>Not rescued 295 1215 1510
</p>
<p>Total 622 1606 2228
</p>
<p>Using (4.7) we get
</p>
<p>t (x, y) = χ2 = 2228(327 &middot; 1215&minus; 295 &middot; 391)
2
</p>
<p>718 &middot; 1510 &middot; 622 &middot; 1606 = 163.55.
</p>
<p>The χ2-independence test and the χ2 test of homogeneity are technically identi-
</p>
<p>cal: H0 is rejected if t (x, y) &gt; c(I&minus;1)(J&minus;1);1&minus;α. Since 163.55 &gt; c1;0.95 = 3.84
the null hypothesis is rejected. As highlighted in (b) this has two interpretations:
</p>
<p>(i) &ldquo;rescue status&rdquo; and &ldquo;travel class&rdquo; are independent (independence test) and (ii)
</p>
<p>the conditional distributions of rescue status given travel class differ by travel
</p>
<p>class (homogeneity test). The second interpretation implies that the probability
</p>
<p>of being rescued differs by travel class. The null hypothesis of the same prob-
</p>
<p>abilities of being rescued is also rejected using the test of Fisher. Summarizing
</p>
<p>the data in a matrix and applying the fisher.test command yields a p-value
</p>
<p>smaller than α = 0.05.
</p>
<p>fisher.test(matrix(c(327,295,391,1215),ncol=2,nrow=2))</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_4">http://dx.doi.org/10.1007/978-3-319-46162-5_4</a></div>
</div>
<div class="page"><p/>
<p>404 Appendix B: Solutions to Exercises
</p>
<p>Solution to Exercise 10.9
</p>
<p>(a) The hypotheses are:
</p>
<p>H0 : μX = μY1 versus H1 : μX �= μY1.
The pooled variance,
</p>
<p>s2 = 19 &middot; 2.94+ 19 &middot; 2.46
39
</p>
<p>= 102.6
39
</p>
<p>= 2.631,
</p>
<p>is needed to calculate the test statistic:
</p>
<p>t (x, y) = 4.97&minus; 4.55
1.622
</p>
<p>&middot;
&radic;
</p>
<p>400
</p>
<p>40
= 0.42
</p>
<p>1.622
&middot;
&radic;
10 = 0.8188.
</p>
<p>H0 is rejected if |t (x, y)| &gt; t38,0.975 &asymp; 2.02. Since |t (x, y)| = 0.8188 we do not
reject the null hypothesis.
</p>
<p>(b) The hypotheses are:
</p>
<p>H0 : μX = μY2 versus H1 : μX �= μY2.
The pooled variance,
</p>
<p>s2 = 19 &middot; 2.94+ 19 &middot; 3.44
39
</p>
<p>= 3.108,
</p>
<p>is needed to calculate the test statistic:
</p>
<p>t (x, y) = 4.97&minus; 3.27
1.763
</p>
<p>&middot;
&radic;
10 = 3.049.
</p>
<p>H0 is rejected because |t (x, y)| = 3.049 &gt; t38,0.975 &asymp; 2.02.
(c) In both (a) and (b), there exists a true difference in themean. However, only in (b)
</p>
<p>is the t-test able to detect the difference. This highlights that smaller differences
</p>
<p>can only be detected if the sample size is sufficiently large. However, if the
</p>
<p>sample size is very large, it may well be that the test detects a difference where
</p>
<p>there is no difference.
</p>
<p>Solution to Exercise 10.10
</p>
<p>(a) After reading in and attaching the data, we can simply use the t.test command
</p>
<p>to compare the expenditure of the two samples:
</p>
<p>theatre &lt;- read.csv('theatre.csv')
</p>
<p>attach(theatre)
</p>
<p>t.test(Culture[Sex==1],Culture[Sex==0])</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 405
</p>
<p>Welch Two-Sample t-test
</p>
<p>data: Culture[Sex == 1] and Culture[Sex == 0]
</p>
<p>t = -1.3018, df = 667.43, p-value = 0.1934
</p>
<p>alternative hypothesis: true difference not equal to 0
</p>
<p>95 percent confidence interval:
</p>
<p>-12.841554 2.602222
</p>
<p>sample estimates:
</p>
<p>mean of x mean of y
</p>
<p>217.5923 222.7120
</p>
<p>We see that the null hypothesis is not rejected because p = 0.1934 &gt; α (also,
the confidence interval overlaps with &ldquo;0&rdquo;).
</p>
<p>(b) A two-sample t-test and a U -test yield the same conclusion. The p-values,
</p>
<p>obtained with
</p>
<p>wilcox.test(Culture[Sex==1],Culture[Sex==0])
</p>
<p>t.test(Culture[Sex==1],Culture[Sex==0],var.equal=TRUE)
</p>
<p>are 0.1946 and 0.145, respectively. Interestingly, the test statistic of the two-
</p>
<p>sample t-test is almost identical to the one from theWelch test in (a) (&minus;1.2983)&mdash;
this indicates that the assumption of equal variances may not be unreasonable.
</p>
<p>(c) We can use the usual t.test command together with the option alternative
</p>
<p>= &rsquo;greater&rsquo; to get the solution.
</p>
<p>t.test(Theatre[Sex==1],Theatre[Sex==0],
</p>
<p>alternative='greater')
</p>
<p>Here, p is much smaller than 0.001; hence, the null hypothesis can be rejected.
</p>
<p>Women spend more on theatre visits than men.
</p>
<p>(d) We deal with dependent (paired) data because different variables (expenditure
</p>
<p>this year versus expenditure last year) are measured on the same observations.
</p>
<p>Thus, we need to use the paired t-test&mdash;which we can use in R by specifying
</p>
<p>the paired option:
</p>
<p>t.test(Theatre,Theatre_ly,paired=TRUE)</p>
<p/>
</div>
<div class="page"><p/>
<p>406 Appendix B: Solutions to Exercises
</p>
<p>Paired t-test
</p>
<p>data: Theatre and Theatre_ly
</p>
<p>t = 1.0925, df = 698, p-value = 0.275
</p>
<p>alternative hypothesis: true difference in means is != 0
</p>
<p>95 percent confidence interval:
</p>
<p>-2.481496 8.707533
</p>
<p>sample estimates:
</p>
<p>mean of the differences
</p>
<p>3.113019
</p>
<p>Both the p-value (which is greater than 0.05) and the confidence interval (over-
</p>
<p>lapping with &ldquo;0&rdquo;) state that the null hypothesis should be kept. The mean differ-
</p>
<p>ence in expenditure (3.1 SFR) is not large enough to suggest that this difference
</p>
<p>is not caused by chance. Visitors spend, on average, about the same in the two
</p>
<p>years.
</p>
<p>Solution to Exercise 10.11
</p>
<p>(a) We can use the one-sample t-test to answer both questions:
</p>
<p>t.test(temperature,mu=65,alternative='greater')
</p>
<p>t.test(time,mu=30,alternative='less')
</p>
<p>One-sample t-test
</p>
<p>data: temperature
</p>
<p>t = -11.006, df = 1265, p-value = 1
</p>
<p>alternative hypothesis: true mean is greater than 65
</p>
<p>...
</p>
<p>data: time
</p>
<p>t = 23.291, df = 1265, p-value = 1
</p>
<p>alternative hypothesis: true mean is less than 30
</p>
<p>We cannot confirm that the mean delivery time is less than 30 min and that
</p>
<p>the mean temperature is greater than 65 ◦C. This is not surprising: we have
already seen in Exercise 3.10 that the manager should be unsatisfied with the
</p>
<p>performance of his company.
</p>
<p>(b) We can use the exact binomial test to investigate H0 : p &ge; 0.15 and H1 : p &lt;
0.15. For the binom.test command, we need to know the numbers of successes
</p>
<p>and failures, i.e. the number of deliveries where a free wine should have been</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 407
</p>
<p>given to the customer. Applying the table commands yields 229 and 1037
</p>
<p>deliveries, respectively.
</p>
<p>table(free_wine)
</p>
<p>binom.test(c(229,1037),p=0.15,alternative='less')
</p>
<p>Exact binomial test
</p>
<p>data: c(229, 1037)
</p>
<p>number of successes = 229, number of trials = 1266,
</p>
<p>p-value = 0.9988 alternative hypothesis: true probability
</p>
<p>is less than 0.15
</p>
<p>95 percent confidence interval:
</p>
<p>0.0000000 0.1996186
</p>
<p>sample estimates, probability of success: 0.1808847
</p>
<p>The null hypothesis cannot be rejected because p = 0.9988 &gt; α = 0.05 and
because the confidence interval covers p = 0.15. We get the same results if we
use the variable &ldquo;got_wine&rdquo; instead of &ldquo;free_wine&rdquo;. While the test says that we
</p>
<p>cannot exclude the possibility that the probability of receiving a free wine is
</p>
<p>less than 15 %, the point estimate of 18 % suggests that the manager still has to
</p>
<p>improve the timeliness of the deliveries or stop the offer of free wine.
</p>
<p>(c) We first need to create a new categorical variable (using cut) which divides the
</p>
<p>temperatures into two parts: below and above 65 ◦C. Then we can simply apply
the test commands (fisher.test, chisq.test, prop.test) to the table of
</p>
<p>branch and temperature:
</p>
<p>hot &lt;- cut(temperature,breaks=c(-Inf,65,Inf))
</p>
<p>fisher.test(table(hot,operator))
</p>
<p>chisq.test(table(hot,operator))
</p>
<p>prop.test(table(hot,operator))
</p>
<p>We know that the two χ2 tests lead to identical results. For both of them the p-
</p>
<p>value is 0.2283 which suggests that we should keep the null hypothesis. There
</p>
<p>is not enough evidence which would support that the proportion of hot pizzas
</p>
<p>differs by operator, i.e. that the two variables are independent! The test of Fisher
</p>
<p>yields the same result (p = 0.2227).
(d) The null hypothesis is that the proportion of deliveries is the same for each
</p>
<p>branch: H0 : pEast = pWest = pCentre. To test this hypothesis, we need a χ2
goodness-of-fit test:
</p>
<p>chisq.test(table(branch))</p>
<p/>
</div>
<div class="page"><p/>
<p>408 Appendix B: Solutions to Exercises
</p>
<p>Chi-squared test for given probabilities
</p>
<p>data: table(branch)
</p>
<p>X-squared = 0.74408, df = 2, p-value = 0.6893
</p>
<p>The null hypothesis of equal proportions is therefore not rejected (p &gt; α =
0.05).
</p>
<p>(e) To compare three proportions we need to use the χ2 homogeneity test:
</p>
<p>prop.test(table(branch, operator))
</p>
<p>X-squared = 0.15719, df = 2, p-value = 0.9244
</p>
<p>alternative hypothesis: two.sided
</p>
<p>sample estimates:
</p>
<p>prop 1 prop 2 prop 3
</p>
<p>0.5059382 0.5097561 0.4965517
</p>
<p>We can see that the proportions are almost identical and that the null hypothesis
</p>
<p>is not rejected (p = 0.9244).
(f) To test this relationship, we use the χ2-independence test:
</p>
<p>chisq.test(table(driver, branch))
</p>
<p>X-squared = 56.856, df = 8, p-value = 1.921e-09
</p>
<p>The null hypothesis of independence is rejected.
</p>
<p>Solution to Exercise 10.12 To test the hypothesis pShalabh = pHeumann
= pSchomaker = 1/3 we use the χ2 goodness-of-fit test. The test statistic is
</p>
<p>χ2 =
k
</p>
<p>&sum;
</p>
<p>i=1
</p>
<p>(Ni &minus; npi )2
npi
</p>
<p>= 1
111
</p>
<p>[(110&minus; 111)2 + (118&minus; 111)2 + (105&minus; 111)2]
</p>
<p>= (1+ 49+ 36)/111 &asymp; 0.77
H0 gets rejected if χ
</p>
<p>2 = 0.77 &gt; c3&minus;1&minus;0,1&minus;0.01 = 9.21. Thus, the null hypothesis is
not rejected. We accept that all three authors took about one-third of the pictures.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 409
</p>
<p>Chapter 11
</p>
<p>Solution to Exercise 11.1
</p>
<p>(a) Calculating x̄ = 16 (26+ 23+ 27+ 28+ 24+ 25) = 25.5 and ȳ =
1
6 (170+
</p>
<p>150+ 160+ 175+ 155+ 150) = 160, we obtain the following table needed
for the estimation of α̂ and β̂:
</p>
<p>Body mass index Systolic blood pressure
</p>
<p>xi xi &minus; x̄ (xi &minus; x̄)2 yi yi &minus; ȳ (yi &minus; ȳ)2 vi
26 0.5 0.25 170 10 100 5
</p>
<p>23 &minus;2.5 6.25 150 &minus;10 100 25
27 1.5 2.25 160 0 0 0
</p>
<p>28 2.5 6.25 175 15 225 37.5
</p>
<p>24 &minus;1.5 2.25 155 &minus;5 25 7.5
25 &minus;0.5 0.25 150 &minus;10 100 5
</p>
<p>Total 153 17.5 960 550 80
</p>
<p>With
&sum;
</p>
<p>i vi =
&sum;
</p>
<p>i (xi &minus; x̄) &middot; (yi &minus; ȳ) = 80, it follows that Sxy = 80. Moreover,
we get Sxx =
</p>
<p>&sum;
</p>
<p>i (xi &minus; x̄)2 = 17.5 and Syy =
&sum;
</p>
<p>i (yi &minus; ȳ)2 = 550. The para-
meter estimates are therefore
</p>
<p>β̂ = Sxy
Sxx
</p>
<p>= 80
17.5
</p>
<p>&asymp; 4.57,
</p>
<p>α̂ = ȳ &minus; β̂ x̄ = 160&minus; 4.57 &middot; 25.5 = 43.465.
A one-unit increase in the BMI therefore relates to a 4.57 unit increase in the
</p>
<p>blood pressure. The model suggests a positive association between BMI and
</p>
<p>systolic blood pressure. It is impossible to have a BMI of 0; therefore, α̂ cannot
</p>
<p>be interpreted meaningfully here.
</p>
<p>(b) Using (11.14), we obtain R2 as
</p>
<p>R2 = r2 =
(
</p>
<p>Sxy
&radic;
</p>
<p>Sxx Syy
</p>
<p>)2
</p>
<p>=
(
</p>
<p>80&radic;
17.5 &middot; 550
</p>
<p>)2
</p>
<p>&asymp; 0.66.
</p>
<p>Thus 66 % of the data&rsquo;s variability can be explained by the model. The goodness
</p>
<p>of fit is good, but not perfect.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>410 Appendix B: Solutions to Exercises
</p>
<p>Solution to Exercise 11.2
</p>
<p>(a) To estimate β̂, we use the second equality from (11.6):
</p>
<p>β̂ =
&sum;n
</p>
<p>i=1 xi yi &minus; nx̄ ȳ
&sum;n
</p>
<p>i=1 x
2
i &minus; nx̄2
</p>
<p>.
</p>
<p>Calculating x̄ = 1.333, ȳ = 5.556,
&sum;n
</p>
<p>i=1 xi yi = 62.96,
&sum;n
</p>
<p>i=1 x
2
i = 24.24,
</p>
<p>and
&sum;n
</p>
<p>i=1 y
2
i = 281.5 leads to
</p>
<p>β̂ = 62.91&minus; 9 &middot; 1.333 &middot; 5.556
24.24&minus; 9 &middot; 1.3332 &asymp;
</p>
<p>&minus;3.695
8.248
</p>
<p>&asymp; &minus;0.45,
</p>
<p>α̂ = ȳ &minus; β̂ x̄ = 5.556+ 0.45 &middot; 1.333 &asymp; 6.16,
ŷi = 6.16&minus; 0.45xi .
</p>
<p>For children who spend no time on the internet at all, this model predicts 6.16 h
</p>
<p>of deep sleep. Each hour spent on the internet decreases the time in deep sleep
</p>
<p>by 0.45 h which is 27 min.
</p>
<p>(b) Using the results from (a) and Syy =
&sum;n
</p>
<p>i=1 y
2
i &minus; n ȳ2 &asymp; 3.678 yields:
</p>
<p>R2 = r2 =
S2xy
</p>
<p>Sxx Syy
= (&minus;3.695)
</p>
<p>2
</p>
<p>8.248 &middot; 3.678 &asymp; 0.45.
</p>
<p>About 45 % of the variation can be explained by the model. The fit of the model
</p>
<p>to the data is neither very good nor very bad.
</p>
<p>(c) After collecting the data in two vectors (c()), printing a summary of the linear
</p>
<p>model (summary(lm())) reproduces the results. A scatter plot can be produced
</p>
<p>by plotting the two vectors against each other (plot()). The regression line can
</p>
<p>be added with abline():
</p>
<p>it &lt;- c(0.3,2.2,...,2.3)
</p>
<p>sleep &lt;- c(5.8,4.4,...,6.1)
</p>
<p>summary(lm(sleep&sim;it))
plot(it,sleep)
</p>
<p>abline(a=6.16,b=-0.45)
</p>
<p>The plot is displayed in Fig. B.20.
</p>
<p>(d) Treating X as a binaryvariable yields the followingvalues: 0, 1, 0, 0, 0, 1, 1, 0, 1.
</p>
<p>We therefore have x̄ = 0.444,
&sum;
</p>
<p>x2i = 4, and
&sum;
</p>
<p>xi yi = 4.4+ 5.0+ 4.8+
6.1 = 20.3. Since the Y -values stay the same we calculate
</p>
<p>β̂ =
&sum;n
</p>
<p>i=1 xi yi &minus; nx̄ ȳ
&sum;n
</p>
<p>i=1 x
2
i &minus; nx̄2
</p>
<p>= 20.3&minus; 9 &middot; 5.556 &middot; 0.444
4&minus; 9 &middot; 0.4442 &asymp; &minus;0.85.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 411
</p>
<p>Fig. B.20 Scatter plot and
</p>
<p>regression line for the
</p>
<p>association of internet use
</p>
<p>and deep sleep
</p>
<p>0.5 1.0 1.5 2.0 2.5 3.0
</p>
<p>4
.5
</p>
<p>5
.0
</p>
<p>5
.5
</p>
<p>6
.0
</p>
<p>6
.5
</p>
<p>internet time (in h)
</p>
<p>d
e
</p>
<p>e
p
</p>
<p> s
le
</p>
<p>e
p
</p>
<p> (
in
</p>
<p> h
)
</p>
<p>Thus, those children who are on the internet for a long time (i.e. &gt;1 h) sleep on
</p>
<p>average 0.85 h (=51 min) less. If we change the coding of 1&rsquo;s and 0&rsquo;s, β̂ will
just have a different sign: β̂ = 0.85. In this case, we can conclude that children
who spend less time on the internet sleep on average 0.85 h longer than children
</p>
<p>who spend more time on the internet. This is the same conclusion and highlights
</p>
<p>that the choice of coding does not affect the interpretation of the results.
</p>
<p>Solution to Exercise 11.3
</p>
<p>(a) The correlation coefficient is
</p>
<p>r = Sxy&radic;
Syy Sxx
</p>
<p>= 170, 821&minus; 17 &middot; 166.65 &middot; 60.12&radic;
(62, 184&minus; 17 &middot; 60.122)(472, 569&minus; 17 &middot; 166.652)
</p>
<p>= 498.03&radic;
738.955 &middot; 441.22
</p>
<p>= 0.87.
</p>
<p>This indicates strong positive correlation: the higher the height, the higher
</p>
<p>the weight. Since R2 = r2 = 0.872 &asymp; 0.76, we already know that the fit of
a linear regression model will be good (no matter whether height or weight
</p>
<p>is treated as outcome). From (11.11), we also know that β̂ will be positive.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>412 Appendix B: Solutions to Exercises
</p>
<p>150 155 160 165 170 175 180 185
</p>
<p>5
0
</p>
<p>5
5
</p>
<p>6
0
</p>
<p>6
5
</p>
<p>7
0
</p>
<p>7
5
</p>
<p>Height
</p>
<p>W
e
</p>
<p>ig
h
</p>
<p>t
</p>
<p>(x18,y18)
</p>
<p>(x19,y19)
</p>
<p>with 17 obs.
</p>
<p>with 19 obs.
</p>
<p>Fig. B.21 Scatter plot and regression line for both 17 and 19 observations
</p>
<p>(b) We know from (a) that Sxy = 498.03 and that Sxx = 441.22. The least
squares estimates are therefore
</p>
<p>β̂ = 498.03
441.22
</p>
<p>= 1.129,
</p>
<p>α̂ = 60.12&minus; 166.65 &middot; 1.129 = &minus;128.03.
Each centimetre difference in height therefore means a 1.129 kg difference
</p>
<p>in weight. It is not possible to interpret α̂ meaningfully in this example.
</p>
<p>(c) The prediction is
</p>
<p>&minus;128.03+ 1.129 &middot; 175 = 69.545 kg.
</p>
<p>(d)&ndash;(g) The black dots in Fig. B.21 show the scatter plot of the data. There is clearly
</p>
<p>a positive association in that greater height implies greater weight. This is
</p>
<p>also emphasized by the regression line estimated in (b). The two additional
</p>
<p>points appear in dark grey in the plot. It is obvious that they do not match the
</p>
<p>pattern observed in the original 17 data points. One may therefore speculate
</p>
<p>that with the inclusion of the two new points β̂ will be smaller. To estimate
</p>
<p>the new regression line we need
</p>
<p>x̄ = 1
19
</p>
<p>(17 &middot; 166.65+ 150+ 175) = 166.21,
</p>
<p>ȳ = 1
19
</p>
<p>(17 &middot; 60.12+ 75+ 55) = 60.63.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 413
</p>
<p>This yields
</p>
<p>β̂ =
&sum;n
</p>
<p>i=1 xi yi &minus; nx̄ ȳ
&sum;n
</p>
<p>i=1 x
2
i &minus; nx̄2
</p>
<p>= 191696&minus; 19 &middot; 166.21 &middot; 60.63
525694&minus; 19 &middot; 166.212 =
</p>
<p>227.0663
</p>
<p>804.4821
</p>
<p>&asymp; 0.28.
This shows that the two added points shrink the estimate from 1.129 to 0.28.
</p>
<p>The association becomes less clear. This is an insightful example showing
</p>
<p>that least squares estimates are generally sensitive to outliers which can
</p>
<p>potentially affect the results.
</p>
<p>Solution to Exercise 11.4
</p>
<p>(a) The point estimate of β suggests a 0.077 % increase of hotel occupation for
</p>
<p>each one degree increase in temperature. However, the null hypothesis of β = 0
cannot be rejected because p = 0.883 &gt; 0.05. We therefore cannot show an
association between temperature and hotel occupation.
</p>
<p>(b) The average hotel occupation is higher in Davos (7.9 %) and Polenca (0.9 %)
</p>
<p>compared with Basel (reference category). However, these differences are not
</p>
<p>significant. Both H0 : βDavos = 0 and H0 : βPolenca = 0 cannot be rejected.
The model cannot show a significant difference in hotel occupation between
</p>
<p>Davos/Polenca and Basel.
</p>
<p>(c) The analysis of variance table tells us that the null hypothesis of equal average
</p>
<p>temperatures in the three cities (β1 = β2 = 0) cannot be rejected. Note that in
this example the overall F-test would have given us the same results.
</p>
<p>(d) In the multivariate model, the main conclusions of (a) and (b) do not change:
</p>
<p>testing H0 : β j = 0 never leads to the rejection of the null hypothesis.We cannot
show an association between temperature and hotel occupation (given the city);
</p>
<p>and we cannot show an association between city and hotel occupation (given the
</p>
<p>temperature).
</p>
<p>(e) Stratifying the data yields considerably different results compared to (a)&ndash;(c): In
</p>
<p>Davos, where tourists go for skiing, each increase of 1 ◦C relates to a drop in hotel
occupation of 2.7 %. The estimate β̂ &asymp; &minus;2.7 is also significantly different from
zero (p = 0.000231). In Polenca, a summer holiday destination, an increase of
1 ◦C implies an increase of hotel occupation of almost 4 %. This estimate is also
significantly different from zero (p = 0.00114 &lt; 0.05). In Basel, a business
destination, there is a somewhat higher hotel occupation for higher temperatures
</p>
<p>(β̂ = 1.3); however, the estimate is not significantly different from zero. While
there is no overall association between temperature and hotel occupation (see
</p>
<p>(a) and (c)), there is an association between them if one looks at the different
</p>
<p>cities separately. This suggests that an interaction between temperature and city
</p>
<p>should be included in the model.</p>
<p/>
</div>
<div class="page"><p/>
<p>414 Appendix B: Solutions to Exercises
</p>
<p>(f) The design matrix contains a column of 1&rsquo;s (to model the intercept), the temper-
</p>
<p>ature and two dummies for the categorical variable &ldquo;city&rdquo; because it has three
</p>
<p>categories. The matrix also contains the interaction terms which are both the
</p>
<p>product of temperature and Davos and temperature and Polenca. The matrix has
</p>
<p>36 rows because there are 36 observations: 12 for each city.
</p>
<p>⎛
</p>
<p>⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝
</p>
<p>Int. Temp. Davos Polenca Temp.&times;Davos Temp.&times;Polenca
1 1 &minus;6 1 0 &minus;6 0
2 1 &minus;5 1 0 &minus;5 0
...
</p>
<p>...
...
</p>
<p>...
...
</p>
<p>...
...
</p>
<p>12 1 0 1 0 0 0
</p>
<p>13 1 10 0 1 0 10
...
</p>
<p>...
...
</p>
<p>...
...
</p>
<p>...
...
</p>
<p>24 1 12 0 1 0 12
</p>
<p>25 1 1 0 0 0 0
...
</p>
<p>...
...
</p>
<p>...
...
</p>
<p>...
...
</p>
<p>36 1 4 0 0 0 0
</p>
<p>⎞
</p>
<p>⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠
</p>
<p>(g) Both interaction terms are significantly different from zero (p = 0.000375 and
p = 0.033388). The estimate of temperature therefore differs by city, and the
estimate of city differs by temperature. For the reference city of Basel, the associ-
</p>
<p>ation between temperature and hotel occupation is estimated as 1.31; for Davos
</p>
<p>it is 1.31&minus; 4.00 = &minus;2.69 and for Polenca 1.31+ 2.66 = 3.97. Note that these
results are identical to (d) where we fitted three different regressions&mdash;they are
</p>
<p>just summarized in a different way.
</p>
<p>(h) From (f) it follows that the point estimates for βtemperature are 1.31 for Basel,
</p>
<p>&minus;2.69 for Davos, and 3.97 for Polenca. Confidence intervals for these estimates
can be obtained via (11.29):
</p>
<p>(β̂i + β̂ j )&plusmn; tn&minus;p&minus;1;1&minus;α/2 &middot; σ̂(β̂i+β̂ j ).
</p>
<p>We calculate tn&minus;p&minus;1;1&minus;α/2 = t36&minus;5&minus;1,0.975 = t30,0.975 = 2.04. With
Var(βtemp.) = 0.478 (obtained via 0.69162 from the model output or from the
second row and second column of the covariance matrix), Var(βtemp:Davos) =
0.997,Var(βPolenca) = 1.43,Cov(βtemp.,βtemp:Davos) = &minus;0.48, and also
Cov(βtemp.,βtemp:Polenca) = &minus;0.48 we obtain:
</p>
<p>σ̂
(β̂temp.+β̂Davos) =
</p>
<p>&radic;
0.478+ 0.997&minus; 2 &middot; 0.48 &asymp; 0.72,
</p>
<p>σ̂
(β̂temp.+β̂Polenca) =
</p>
<p>&radic;
0.478+ 1.43&minus; 2 &middot; 0.48 &asymp; 0.97,
</p>
<p>σ̂
(β̂temp.+β̂Basel) =
</p>
<p>&radic;
0.478+ 0+ 0 &asymp; 0.69.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 415
</p>
<p>The 95 % confidence intervals are therefore:
</p>
<p>Davos: [&minus;2.69&plusmn; 2.04 &middot; 0.72] &asymp; [&minus;4.2;&minus;1.2],
Polenca: [3.97&plusmn; 2.04 &middot; 0.97] &asymp; [2.0; 5.9],
Basel: [1.31&plusmn; 2.04 &middot; 0.69] &asymp; [&minus;0.1; 2.7].
</p>
<p>Solution to Exercise 11.5
</p>
<p>(a) The missing value [1] can be calculated as
</p>
<p>T = β̂i &minus; βi
σ̂
β̂i
</p>
<p>= 0.39757&minus; 0
0.19689
</p>
<p>= 2.019.
</p>
<p>Since t699&minus;5&minus;1,0.975 = 1.96 and 2.019 &gt; 1.96, it is clear that the p-value
from [2] is smaller than 0.05. The exact p-value can be calculated in R via
(1-pt(2.019, 693))*2which yields 0.0439. The pt command gives the
</p>
<p>probability value for the quantile of 2.019 (with 693 degrees of freedom):
</p>
<p>0.978. Therefore, with probability (1&minus; 0.978)% a value is right of 2.019 in
the respective t-distribution which gives, multiplied by two to account for a
</p>
<p>two-sided test, the p-value.
</p>
<p>(b)&ndash;(c) The plot on the left shows that the residuals are certainly not normally distrib-
</p>
<p>uted as required by the model assumptions. The dots do not approximately
</p>
<p>match the bisecting line. There are too many high positive residuals which
</p>
<p>means that we are likely dealing with a right-skewed distribution of residu-
</p>
<p>als. The plot on the right looks alright: no systematic pattern can be seen; it
</p>
<p>is a random plot. The histogram of both theatre expenditure and log(theatre
</p>
<p>expenditure) suggests that a log-transformation may improve the model,
</p>
<p>see Fig. B.22. Log-transformations are often helpful when the outcome&rsquo;s
</p>
<p>distribution is skewed to the right.
</p>
<p>(d) Since the outcome is log-transformed, we can apply the interpretation of a
</p>
<p>log-linear model:
</p>
<p>&bull; Each year&rsquo;s increase in age yields an exp(0.0038) = 1.0038 times higher
(=0.38 %) expenditure on theatre visits. Therefore, a 10-year age dif-
ference relates to an exp(10 &middot; 0.0038) = 1.038 times higher expenditure
(=3.8 %).
</p>
<p>&bull; Women (gender = 1) spend on average (given the other variables)
exp(0.179) &asymp; 1.20 times more money on theatre visits.
</p>
<p>&bull; Each 1000 SFR more yearly income relates to an exp(0.0088) = 1.0088
times higher expenditure on theatre visits. A difference in 10,000 SFR per
</p>
<p>year therefore amounts to an 8.8 % difference in expenditure.
</p>
<p>&bull; Each extra Swiss Franc spent on cultural activities is associated with an
exp(0.00353) = 1.0035 times higher expenditure on theatre visits.</p>
<p/>
</div>
<div class="page"><p/>
<p>416 Appendix B: Solutions to Exercises
</p>
<p>expenditure for theatre visits (in SFR)
</p>
<p>F
re
</p>
<p>q
u
e
n
c
y
</p>
<p>0 100 200 300 400 500
</p>
<p>0
5
0
</p>
<p>1
0
0
</p>
<p>1
5
0
</p>
<p>2
0
0
</p>
<p>2
5
0
</p>
<p>(a) Expenditure
</p>
<p>log&minus;expenditure for theatre visits (in SFR)
</p>
<p>F
re
</p>
<p>q
u
e
n
c
y
</p>
<p>3.0 3.5 4.0 4.5 5.0 5.5 6.0 6.5
</p>
<p>0
2
0
</p>
<p>4
0
</p>
<p>6
0
</p>
<p>8
0
</p>
<p>1
0
0
</p>
<p>1
2
0
</p>
<p>(b) log(expenditure)
</p>
<p>Fig. B.22 Histogram of the outcome
</p>
<p>&bull; Except for theatre expenditure from the preceding year, all β j are signifi-
cantly different from zero.
</p>
<p>(e) While in (b) the residuals were clearly not normally distributed, this assump-
</p>
<p>tion seems to be fulfilled now: the QQ-plot shows dots which lie approxi-
</p>
<p>mately on the bisecting line. The fitted values versus residuals plot remains
</p>
<p>a chaos plot. In conclusion, the log-transformation of the outcome helped
</p>
<p>to improve the quality of the model.
</p>
<p>Solution to Exercise 11.6
</p>
<p>(a) The multivariate model is obtained by using the lm() command and separating
</p>
<p>the covariates with the + sign. Applying summary() to the model returns the
comprehensive summary.
</p>
<p>mp &lt;- lm(time &sim; temperature + branch + day + operator + driver
+ bill + pizzas + discount_customer)
</p>
<p>summary(mp)</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 417
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) 40.42270 2.00446 20.166 &lt; 2e-16 ***
</p>
<p>temperature -0.20823 0.02594 -8.027 2.28e-15 ***
</p>
<p>branchEast -1.60263 0.42331 -3.786 0.000160 ***
</p>
<p>branchWest -0.11912 0.37330 -0.319 0.749708
</p>
<p>dayMonday -1.15858 0.63300 -1.830 0.067443 .
</p>
<p>daySaturday 0.88163 0.50161 1.758 0.079061 .
</p>
<p>daySunday 1.01655 0.56103 1.812 0.070238 .
</p>
<p>dayThursday 0.78895 0.53006 1.488 0.136895
</p>
<p>dayTuesday 0.79284 0.62538 1.268 0.205117
</p>
<p>dayWednesday 0.25814 0.60651 0.426 0.670468
</p>
<p>operatorMelissa -0.15791 0.34311 -0.460 0.645435
</p>
<p>driverDomenico -2.59296 0.73434 -3.531 0.000429 ***
</p>
<p>driverLuigi -0.80863 0.58724 -1.377 0.168760
</p>
<p>driverMario -0.39501 0.43678 -0.904 0.365973
</p>
<p>driverSalvatore -0.50410 0.43480 -1.159 0.246519
</p>
<p>bill 0.14102 0.01600 8.811 &lt; 2e-16 ***
</p>
<p>pizzas 0.55618 0.11718 4.746 2.31e-06 ***
</p>
<p>discount_customer -0.28321 0.36848 -0.769 0.442291
</p>
<p>---
</p>
<p>Signif. codes: 0 *** 0.001 ** 0.01 * 0.05 . 0.1 1
</p>
<p>Residual standard error: 5.373 on 1248 degrees of freedom
</p>
<p>Multiple R-squared: 0.3178, Adjusted R-squared: 0.3085
</p>
<p>F-statistic: 34.2 on 17 and 1248 DF, p-value: &lt; 2.2e-16
</p>
<p>The output shows that lower temperature, higher bills, and more ordered pizzas
</p>
<p>increase the delivery times. The branch in the East is the fastest, and so is
</p>
<p>the driver Domenico. While there are differences with respect to day, discount
</p>
<p>customers, and the operator, they are not significant at the 5 % level.
</p>
<p>(b) The confidence intervals are calculated as: β̂i &plusmn; tn&minus;p&minus;1;1&minus;α/2 &middot; σ̂β̂ . We know
from the model output from (a) that there are 1248 degrees of freedom (1266
</p>
<p>observations &minus; 18 estimated coefficients). The respective quantile from the t-
distribution is obtained with the qt() function. The coefficients are accessed via
</p>
<p>the coefficients command (alternatively: mp$coefficients); the variances
</p>
<p>of the coefficients are either accessed via the diagonal elements of the covariance
</p>
<p>matrix (diag(vcov(mp))) or the model summary
</p>
<p>(summary(mp)[[4]][,2])&mdash;both of which are laborious. The summary of
</p>
<p>coefficients, lower confidence limit (lcl), and upper confidence limit (ucl) may
</p>
<p>be summarized in a matrix, e.g. via merging the individual columns with the
</p>
<p>cbind command.</p>
<p/>
</div>
<div class="page"><p/>
<p>418 Appendix B: Solutions to Exercises
</p>
<p>lcl &lt;- coefficients(mp) - qt(0.975,1248)*sqrt(diag(vcov(mp)))
</p>
<p>ucl &lt;- coefficients(mp) + qt(0.975,1248)*sqrt(diag(vcov(mp)))
</p>
<p>cbind(coefficients(mp),lcl,ucl)
</p>
<p>lcl ucl
</p>
<p>(Intercept) 40.4227014 36.4902223 44.3551805
</p>
<p>temperature -0.2082256 -0.2591146 -0.1573366
</p>
<p>branchEast -1.6026299 -2.4331162 -0.7721436
</p>
<p>branchWest -0.1191190 -0.8514880 0.6132501
</p>
<p>dayMonday -1.1585828 -2.4004457 0.0832801
</p>
<p>...
</p>
<p>(c) The variance is estimated as the residual sum of squares divided by the degrees
</p>
<p>of freedom, see also (11.27). Applying the residuals command to the model
</p>
<p>and using other basic operations yields an estimated variance of 28.86936.
</p>
<p>sum(residuals(mp)̂ 2)/(mp$df.residual)
</p>
<p>Taking the square root of the result yields
&radic;
28.86936 = 5.37 which is also
</p>
<p>reported in the model output from (a) under &ldquo;Residual standard error&rdquo;.
</p>
<p>(d) The sum of squares error is defined as
&sum;n
</p>
<p>i=1(yi &minus; ŷi )2. The total sum of squares
is
&sum;n
</p>
<p>i=1(yi &minus; ȳ)2. This can be easily calculated in R. The goodness of fit is then
obtained as R2 = 1&minus; SQError/SQTotal = 0.3178. Dividing SQError by n &minus; p &minus;
1 = 1266&minus; 17&minus; 1 = 1248 and SQTotal by n &minus; 1 = 1265 yields R2adj = 0.3085.
This corresponds to the model output from (a).
</p>
<p>SQE &lt;- sum(residuals(mp)̂ 2)
</p>
<p>SQT &lt;- sum((time-mean(time))̂ 2)
</p>
<p>1-(SQE/SQT)
</p>
<p>1-((SQE/1248)/(SQT/1265))
</p>
<p>(e) Applying stepAIC to the fitted model (with option &ldquo;back&rdquo; for backward selec-
</p>
<p>tion) executes the model selection by means of AIC.
</p>
<p>library(MASS)
</p>
<p>stepAIC(mp, direction='back')</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 419
</p>
<p>The output shows that the full model has an AIC of 4275.15. The smallest AIC
</p>
<p>is achieved by removing the operator variable from the model.
</p>
<p>Step: AIC=4275.15
</p>
<p>time ~ temperature + branch + day + operator + driver + bill +
</p>
<p>pizzas + discount_customer
</p>
<p>Df Sum of Sq RSS AIC
</p>
<p>- operator 1 6.11 36035 4273.4
</p>
<p>- discount_customer 1 17.05 36046 4273.8
</p>
<p>&lt;none&gt; 36029 4275.2
</p>
<p>- day 6 448.79 36478 4278.8
</p>
<p>- driver 4 363.91 36393 4279.9
</p>
<p>- branch 2 511.10 36540 4289.0
</p>
<p>- pizzas 1 650.39 36679 4295.8
</p>
<p>- temperature 1 1860.36 37889 4336.9
</p>
<p>- bill 1 2241.30 38270 4349.6
</p>
<p>The reduced model has an AIC of 4273.37. Removing the discount customer
</p>
<p>variable from the model yields an improved AIC (4272.0 &lt; 4273.37).
</p>
<p>Step: AIC=4273.37
</p>
<p>time ~ temperature + branch + day + driver + bill + pizzas +
</p>
<p>discount_customer
</p>
<p>Df Sum of Sq RSS AIC
</p>
<p>- discount_customer 1 17.57 36053 4272.0
</p>
<p>&lt;none&gt; 36035 4273.4
</p>
<p>- day 6 452.00 36487 4277.1
</p>
<p>- driver 4 364.61 36400 4278.1
</p>
<p>- branch 2 508.57 36544 4287.1
</p>
<p>- pizzas 1 649.54 36685 4294.0
</p>
<p>- temperature 1 1869.98 37905 4335.4
</p>
<p>- bill 1 2236.19 38271 4347.6
</p>
<p>The model selection procedure stops here as removing any variable would only
</p>
<p>increase the AIC, not decrease it.
</p>
<p>Step: AIC=4271.98
</p>
<p>time ~ temperature + branch + day + driver + bill + pizzas
</p>
<p>Df Sum of Sq RSS AIC
</p>
<p>&lt;none&gt; 36053 4272.0
</p>
<p>- day 6 455.62 36508 4275.9
</p>
<p>- driver 4 368.18 36421 4276.8
</p>
<p>- branch 2 513.17 36566 4285.9
</p>
<p>- pizzas 1 657.07 36710 4292.8
</p>
<p>- temperature 1 1878.24 37931 4334.3
</p>
<p>- bill 1 2228.88 38282 4345.9</p>
<p/>
</div>
<div class="page"><p/>
<p>420 Appendix B: Solutions to Exercises
</p>
<p>The final model, based on backward selection with AIC, includes day, driver,
</p>
<p>branch, number of pizzas ordered, temperature, and bill.
</p>
<p>(f) Fitting the linear model with the variables obtained from (e) and obtaining the
</p>
<p>summary of it yields an R2adj of 0.3092.
</p>
<p>mps &lt;- lm(time &sim; temperature + branch + day + driver + bill +
pizzas)
</p>
<p>summary(mps)
</p>
<p>This is only marginally higher than the goodness of fit from the full model
</p>
<p>(0.3092 &gt; 0.3085). While the selected model is better than the model with all
</p>
<p>variables, both, with respect to AIC and R2adj, the results are very close and
</p>
<p>remind us of the possible instability of applying automated model selection
</p>
<p>procedures.
</p>
<p>(g) Both the normality assumption and heteroscedasticity can be checked by apply-
</p>
<p>ing plot() to the model. From the many graphs provided we concentrate on
</p>
<p>the second and third of them:
</p>
<p>plot(mps, which=2)
</p>
<p>plot(mps, which=3)
</p>
<p>Figure B.23a shows that the residuals are approximately normally distributed
</p>
<p>because the dots lie approximately on the bisecting line. There are some smaller
</p>
<p>deviations at the tails but they are not severe. The plot of the fitted values versus
</p>
<p>&minus;3 &minus;2 &minus;1 0 1 2 3
</p>
<p>&minus;
2
</p>
<p>&minus;
1
</p>
<p>0
1
</p>
<p>2
3
</p>
<p>4
</p>
<p>Theoretical Quantiles
</p>
<p>S
ta
</p>
<p>n
d
a
rd
</p>
<p>iz
e
d
 r
</p>
<p>e
s
id
</p>
<p>u
a
ls
</p>
<p>lm(time ~ temperature + branch + day + driver + bill + pizzas)
</p>
<p>Theoretical Quantiles
</p>
<p>(a) QQ-plot
</p>
<p>20 25 30 35 40 45
</p>
<p>0
.0
</p>
<p>0
.5
</p>
<p>1
.0
</p>
<p>1
.5
</p>
<p>2
.0
</p>
<p>Fitted Values
</p>
<p>|S
ta
</p>
<p>n
d
a
rd
</p>
<p>iz
e
d
 r
</p>
<p>e
s
id
</p>
<p>u
a
ls
</p>
<p>|
</p>
<p>(b) Fitted values vs. residuals
</p>
<p>Fig. B.23 Checking the model assumptions</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B: Solutions to Exercises 421
</p>
<p>the square root of the absolute values of the residuals shows no pattern; it is a
</p>
<p>random plot (Fig. B.23b). There seems to be no heteroscedasticity.
</p>
<p>(h) Not all variables identified in (e) represent necessarily a &ldquo;cause&rdquo; for delayed or
</p>
<p>improved delivery time. It makes sense to speculate that becausemany pizzas are
</p>
<p>being delivered (and need to be made!) the delivery time increases. There might
</p>
<p>also be reasonswhya certain driver is improving the delivery time:maybehedoes
</p>
<p>not care about red lights. This could be investigated further given the results of
</p>
<p>the model above. However, high temperature does not cause the delivery time to
</p>
<p>be shorter; likely it is the other way around: the temperature is hotter because the
</p>
<p>delivery time is shorter. However, all of these considerations remain speculation.
</p>
<p>A regressionmodel only exhibits associations. If there is a significant association,
</p>
<p>we know that given an accepted error (e.g. 5 %), values of x are higher when
</p>
<p>values of y are higher. This is useful but it does not say whether x caused y or
</p>
<p>vice versa.
</p>
<p>(i) To check whether it is worth to add a polynomial, we simply add the squared
</p>
<p>temperature to the model. To make R understand that we apply a transformation
</p>
<p>we need to use I().
</p>
<p>mps2 &lt;- lm(time &sim; temperature + I(temperatureˆ2) +
I(temperatureˆ3) + branch + day + driver + bill + pizzas)
summary(mps2)
</p>
<p>Estimate Std. Error t value Pr(&gt;|t|)
</p>
<p>(Intercept) -18.954965 8.795301 -2.155 0.03134 *
</p>
<p>temperature 1.736692 0.282453 6.149 1.05e-09 ***
</p>
<p>I(temperature^2) -0.015544 0.002247 -6.917 7.36e-12 ***
</p>
<p>branchEast -1.429772 0.416107 -3.436 0.00061 ***
</p>
<p>...
</p>
<p>It can be seen that the null hypothesis H0 : βtemp2 = 0 is rejected. This indicates
that it is worthwhile to assume a quadratic relationship between temperature and
</p>
<p>delivery time.
</p>
<p>(j) The prediction can be obtained by the predict command as follows:
</p>
<p>predict(mps,pizza[1266,])
</p>
<p>The prediction is 36.5 min and therefore 0.8 min higher than the real delivery
</p>
<p>time.</p>
<p/>
</div>
<div class="page"><p/>
<p>CAppendix:Technical Appendix
</p>
<p>More details on Chap. 3
</p>
<p>Proof of equation (3.27).
</p>
<p>s̃2 = 1
n
</p>
<p>k
&sum;
</p>
<p>j=1
</p>
<p>&sum;
</p>
<p>xi&isin;K j
(xi &minus; x̄)2 =
</p>
<p>1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
</p>
<p>&sum;
</p>
<p>xi&isin;K j
(xi &minus; x̄ j + x̄ j &minus; x̄)2
</p>
<p>= 1
n
</p>
<p>k
&sum;
</p>
<p>j=1
</p>
<p>&sum;
</p>
<p>xi&isin;K j
(xi &minus; x̄ j )2
</p>
<p>︸ ︷︷ ︸
</p>
<p>[i]
</p>
<p>+ 1
n
</p>
<p>k
&sum;
</p>
<p>j=1
</p>
<p>&sum;
</p>
<p>xi&isin;K j
(x̄ j &minus; x̄)2
</p>
<p>︸ ︷︷ ︸
</p>
<p>[i i]
</p>
<p>+ 2
n
</p>
<p>k
&sum;
</p>
<p>j=1
</p>
<p>&sum;
</p>
<p>xi&isin;K j
(xi &minus; x̄ j )(x̄ j &minus; x̄)
</p>
<p>︸ ︷︷ ︸
</p>
<p>[i i i]
We obtain the following expressions for [i]&ndash;[i i i]:
</p>
<p>[i] = 1
n
</p>
<p>k
&sum;
</p>
<p>j=1
n j
</p>
<p>1
</p>
<p>n j
</p>
<p>&sum;
</p>
<p>xi&isin;K j
(xi &minus; x̄ j )2 =
</p>
<p>1
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
n j s̃
</p>
<p>2
j ,
</p>
<p>[i i] = 1
n
</p>
<p>k
&sum;
</p>
<p>j=1
n j (x̄ j &minus; x̄)2 ,
</p>
<p>[i i i] = 2
n
</p>
<p>k
&sum;
</p>
<p>j=1
(x̄ j &minus; x̄)
</p>
<p>&sum;
</p>
<p>xi&isin;K j
(xi &minus; x̄ j ) =
</p>
<p>2
</p>
<p>n
</p>
<p>k
&sum;
</p>
<p>j=1
(x̄ j &minus; x̄) 0 = 0.
</p>
<p>Since [i] is thewithin-class variance and [i i] is the between-class variance, Eq. (3.27)
holds.
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5
</p>
<p>423</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_3">http://dx.doi.org/10.1007/978-3-319-46162-5_3</a></div>
</div>
<div class="page"><p/>
<p>424 Appendix C: Technical Appendix
</p>
<p>More details on Chap. 7
</p>
<p>Proof of Theorem 7.2.3. Consider the interval (x0 &minus; δ, x0] with δ &ge; 0. From (7.12)
it follows that P(x0 &minus; δ &lt; X &le; x0) = F(x0)&minus; F(x0 &minus; δ) and therefore
</p>
<p>P(X = x0) = lim
δ&rarr;0
</p>
<p>P(x0 &minus; δ &lt; X &le; x0)
</p>
<p>= lim
δ&rarr;0
</p>
<p>[F(x0)&minus; F(x0 &minus; δ)]
</p>
<p>= F(x0)&minus; F(x0) = 0.
</p>
<p>Proof of Theorem 7.3.1.
</p>
<p>Var(X)
(7.17)= E(X &minus; μ)2
= E(X2 &minus; 2μX + μ2)
</p>
<p>(7.28&minus;7.31)= E(X2)&minus; 2μE(X)+ E(μ2)
= E(X2)&minus; 2μ2 + μ2
= E(X2)&minus; [E(X)]2.
</p>
<p>Proof of Theorem 7.4.1. We define a discrete random variable Y as
</p>
<p>Y =
{
</p>
<p>0 if |X &minus; μ| &lt; c
c2 if |X &minus; μ| &ge; c. (C.1)
</p>
<p>The respective probabilities are P(|X &minus; μ| &lt; c) = p1 and P(|X &minus; μ| &ge; c) = p2.
The definition of Y in (C.1) implies that
</p>
<p>Y &le; |X &minus; μ|2
</p>
<p>since for |X &minus; μ|2 &lt; c2 Y takes the value y1 = 0 and therefore Y &le; |X &minus; μ|2. If
|X &minus; μ|2 &ge; c2Y takes the value y2 = c2, and therefore Y &le; |X &minus; μ|2. Using this
knowledge, we obtain
</p>
<p>E(Y ) &le; E(X &minus; μ)2 = Var(X).
However, for Y we also have
</p>
<p>E(Y ) = 0 &middot; p1 + c2 &middot; p2 = c2P(|X &minus; μ| &ge; c)
which means that we can summarize the above findings in the following inequality:
</p>
<p>c2P(|X &minus; μ| &ge; c) &le; Var(X).
This equates to Tschebyschev&rsquo;s inequality. Using P( Ā) = 1&minus; P(A), i.e.
</p>
<p>P(|X &minus; μ| &ge; c) = 1&minus; P(|X &minus; μ| &lt; c),
we obtain the second formula of Tschebyschev&rsquo;s inequality:
</p>
<p>P(|X &minus; μ| &lt; c) &ge; 1&minus; Var(X)
c2
</p>
<p>.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>Appendix C: Technical Appendix 425
</p>
<p>Proof of rule (7.30). For discrete variables, we have
</p>
<p>E(a + bX) (7.16)=
&sum;
</p>
<p>i
</p>
<p>(a + bxi )pi =
&sum;
</p>
<p>api + bxi pi = a
&sum;
</p>
<p>i
</p>
<p>pi + b
&sum;
</p>
<p>i
</p>
<p>xi pi .
</p>
<p>Since
&sum;
</p>
<p>i pi = 1 and
&sum;
</p>
<p>i xi pi = E(X), we obtain E(a + bX) = a + bE(X), which
is rule (7.30). In the continuous case, we have
</p>
<p>E(a + bX) =
&int; &infin;
</p>
<p>&minus;&infin;
(a + bx) f (x)dx =
</p>
<p>&int; &infin;
</p>
<p>&minus;&infin;
(a f (x)dx+ bx f (x)dx)
</p>
<p>= a
&int; &infin;
</p>
<p>&minus;&infin;
f (x)dx + b
</p>
<p>&int; &infin;
</p>
<p>&minus;&infin;
x f (x)dx = a + bE(X).
</p>
<p>Proof of rule (7.33). Using Var(X) = E(X2)&minus; E(X)2, we can write the variance of
bX as
</p>
<p>Var(bX) = E([bX ]2)+ E(bX)2.
Using (7.29), we get E([bX ]2) = b2E(X2) and E(bX)2 = (bE(X))2. Therefore
</p>
<p>Var(bX) = b2(E(X2)&minus; E(X)2) = b2Var(X).
</p>
<p>Proof of ρ = 1 for a perfect linear relationship. If Y = aX + b with a �= 0, we get
Cov(X, Y ) = E[(X &minus; μX )(Y &minus; μY )]
</p>
<p>= aE[(X &minus; μX )(X &minus; μX )]
because Cov(aX + b, cY + d) = acCov(X, Y ), see p. 147. Then
</p>
<p>Cov(X, Y ) = aVar(X),
</p>
<p>Var(Y )
(7.33)= a2Var(X),
</p>
<p>and therefore
</p>
<p>ρ(X, Y ) = aVar(X)&radic;
a2Var(X)Var(X)
</p>
<p>= a|a| = 1
</p>
<p>if a &gt; 0. Similarly, if Y = aX + b with a &lt; 0 we get ρ(X, Y ) = &minus;1.
</p>
<p>More details on Chap. 8
</p>
<p>Theorem of Large Numbers. To explain the Theorem of Large Numbers, we first
</p>
<p>need to first define stochastic convergence.
</p>
<p>Definition C.1 A sequence of random variables, (Xn)n&isin;N, converges stochastically
to 0, if for any ǫ &gt; 0
</p>
<p>lim
n&rarr;&infin;
</p>
<p>P(|Xn| &gt; ǫ) = 0 (C.2)
</p>
<p>holds.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>426 Appendix C: Technical Appendix
</p>
<p>This is equivalent to limn&rarr;&infin; P(|Xn| &le; ǫ) = 1.
</p>
<p>Theorem C.1 (Theorem of large numbers) Consider n i.i.d. random variables
</p>
<p>X1, X2, . . . , Xn with E(X i ) = μ,Var(X i ) = σ2 and X̄n = 1n
&sum;n
</p>
<p>i=1 X i . It holds that
</p>
<p>lim
n&rarr;&infin;
</p>
<p>P(|X̄n &minus; μ| &lt; c) = 1, &forall; c &ge; 0. (C.3)
</p>
<p>This implies that X̄n converges stochastically to μ. As another motivation, recall
</p>
<p>Definition 7.6.1 where we define random variables X1, X2, . . . , Xn to be i.i.d. (inde-
</p>
<p>pendently identically distributed) if all X i follow the same distribution and are inde-
</p>
<p>pendent of each other. Under this assumption,we showed in (7.36) thatVar(X̄) = σ2
n
.
</p>
<p>It follows that the larger n, the smaller the variance. If we apply Tschebyschev&rsquo;s
</p>
<p>inequality (Theorem 7.4.1) to X̄ , we get the following equation for (X̄n &minus; μ)n&isin;N:
</p>
<p>P(|X̄n &minus; μ| &lt; c) &ge; 1&minus;
Var(X̄n)
</p>
<p>c2
= 1&minus; σ
</p>
<p>2
</p>
<p>nc2
. (C.4)
</p>
<p>This means that for each c &ge; 0, the right-hand side of the above equation tends to 1
as n &rarr; &infin; which gives a similar interpretation as the Theorem of Large Numbers.
</p>
<p>Central Limit Theorem. Let X i (i = 1, 2, . . . , n) be n i.i.d. random variables
with E(X i ) = μ and Var(X i ) = σ2. If we consider the sum
</p>
<p>&sum;n
i=1 X i , we obtain
</p>
<p>E(
&sum;n
</p>
<p>i=1 X i ) = nμ and Var(
&sum;n
</p>
<p>i=1 X i ) = nσ2. If we want to standardize
&sum;n
</p>
<p>i=1 X i
we can use Theorem 7.3.2 to obtain
</p>
<p>Yn =
&sum;n
</p>
<p>i=1 X i &minus; nμ&radic;
nσ2
</p>
<p>, (C.5)
</p>
<p>i.e. it holds that E(Yn) = 0 and Var(Yn) = 1.
</p>
<p>Theorem C.2 (Central Limit Theorem) Let X i (i = 1, 2, . . . , n) be n i.i.d. random
variables with E(X i ) = μ and Var(X i ) = σ2. Yn denotes the standardized sum of
X i , i = 1, 2, . . . , n. The CDF of Yn is
</p>
<p>lim
n&rarr;&infin;
</p>
<p>P(Yn &le; y) = Φ(y), &forall; y,
</p>
<p>where Φ(y) denotes the CDF of the standard normal distribution.
</p>
<p>This theorem tells us that Yn is approximately standard normal distributed if n is
</p>
<p>large, i.e.
</p>
<p>Yn &sim; N (0, 1) as n &rarr; &infin;.
This is equivalent to saying that
</p>
<p>&sum;n
i=1 X i is approximately N (nμ, nσ
</p>
<p>2) distributed
</p>
<p>if n is large, i.e.
n
</p>
<p>&sum;
</p>
<p>i=1
X i &sim; N (nμ, nσ2). (C.6)</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_7">http://dx.doi.org/10.1007/978-3-319-46162-5_7</a></div>
</div>
<div class="page"><p/>
<p>Appendix C: Technical Appendix 427
</p>
<p>As a consequence X̄n = 1n
&sum;n
</p>
<p>i=1 X i is N (μ,
σ2
</p>
<p>n
) distributed for large n, i.e.
</p>
<p>X̄n &sim; N
(
</p>
<p>μ,
σ2
</p>
<p>n
</p>
<p>)
</p>
<p>.
</p>
<p>In summary, the Theorem of Large Numbers tells us that X̄n converges stochas-
</p>
<p>tically to μ, whereas the Central Limit Theorem tells us that X̄n converges to a
</p>
<p>N (μ, σ
2
</p>
<p>n
)-distribution as n tends to infinity.
</p>
<p>PDF of the χ2-Distribution. The PDF of the χ2-distribution, with n degrees of
</p>
<p>freedom, is defined as
</p>
<p>f (x) =
{
</p>
<p>xn/2&minus;1 exp(&minus;x/2)
Γ (n/2)2n/2
</p>
<p>if x &gt; 0
</p>
<p>0 otherwise.
(C.7)
</p>
<p>Note that Γ (n) is the Gamma function, defined as Γ (n) = (n &minus; 1)! for positive inte-
gers and Γ (x) =
</p>
<p>&int;&infin;
0 t
</p>
<p>x&minus;1 exp(&minus;t)dt otherwise.
</p>
<p>PDF of the t-Distribution.The PDF of the t-distribution, with n degrees of freedom,
</p>
<p>is defined as
</p>
<p>f (x) =
Γ ( n+12 )
</p>
<p>Γ (n/2)
&radic;
</p>
<p>nπ
</p>
<p>(
</p>
<p>1+ x
2
</p>
<p>n
</p>
<p>)&minus;(n+1)/2
&minus;&infin; &lt; x &lt; &infin;. (C.8)
</p>
<p>Note that Γ (n) is the Gamma function, defined as Γ (n) = (n &minus; 1)! for positive inte-
gers and Γ (x) =
</p>
<p>&int;&infin;
0 t
</p>
<p>x&minus;1 exp(&minus;t)dt otherwise.
</p>
<p>PDF of the F-Distribution. The PDF of the F-distribution, with n and m degrees
</p>
<p>of freedom, respectively, is defined as
</p>
<p>f (x) =
Γ ( n+m2 )(
</p>
<p>n
m
)n/2xn/2&minus;1
</p>
<p>Γ ( n2 )Γ (
m
2 )(1+
</p>
<p>nx
m
)(n+m)/2
</p>
<p>, x &gt; 0. (C.9)
</p>
<p>The PDF of the F-distribution with m and n degrees of freedom can be derived by
</p>
<p>interchanging the roles of m and n.
</p>
<p>More details on Chap. 9
</p>
<p>Another Example of Sufficiency. Let X1, X2, . . . , Xn be a random sample from
</p>
<p>N (μ,σ2) where μ and σ2 are both unknown. We attempt to find a sufficient statistic
</p>
<p>for μ and σ2.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_9">http://dx.doi.org/10.1007/978-3-319-46162-5_9</a></div>
</div>
<div class="page"><p/>
<p>428 Appendix C: Technical Appendix
</p>
<p>f (x1, x2 . . . , xn;μ,σ2) =
(
</p>
<p>1&radic;
2π
</p>
<p>)n
</p>
<p>exp
</p>
<p>[
</p>
<p>&minus;1
2
</p>
<p>n
&sum;
</p>
<p>i=1
</p>
<p>(xi &minus; μ)2
σ2
</p>
<p>]
</p>
<p>=
(
</p>
<p>1&radic;
2πσ
</p>
<p>)n
</p>
<p>exp
</p>
<p>[
</p>
<p>&minus; 1
2σ2
</p>
<p>(
n
</p>
<p>&sum;
</p>
<p>i=1
x2i &minus; 2μ
</p>
<p>n
&sum;
</p>
<p>i=1
xi + nμ2
</p>
<p>)]
</p>
<p>.
</p>
<p>Here the joint density depends on x1, x2, . . . , xn through two statistics
</p>
<p>t1(x1, x2, . . . , xn) =
&sum;n
</p>
<p>i=1 xi and t2(x1, x2, . . . , xn) =
&sum;n
</p>
<p>i=1 x
2
i with h(x1, x2,
</p>
<p>. . . , xn) = 1. Thus T1 =
&sum;n
</p>
<p>i=1 X i and T2 =
&sum;n
</p>
<p>i=1 X
2
i are jointly sufficient for μ
</p>
<p>and σ2. Therefore, X̄ and S2 = 1
n&minus;1
</p>
<p>&sum;n
i=1(X i &minus; X̄)2 are jointly sufficient for μ and
</p>
<p>σ2 as they are a one-to-one function of T1 and T2. They are the maximum likelihood
</p>
<p>estimates for μ and σ2.
</p>
<p>More details on Chap. 10
</p>
<p>Exact Test of Fisher. Similar to the approximate two-sample binomial test in
</p>
<p>Sect. 10.4.2, we assume two samples following a binomial distribution with para-
</p>
<p>meters (n1, p1) and (n2, p2), respectively.
</p>
<p>X = (X1, X2, . . . , Xn1), X i &sim; B(1; p1)
Y = (Y1, Y2, . . . , Yn2), Yi &sim; B(1; p2).
</p>
<p>For the sums of these random variables, we get:
</p>
<p>X =
n1&sum;
</p>
<p>i=1
X i &sim; B(n1; p1), Y =
</p>
<p>n2&sum;
</p>
<p>i=1
Yi &sim; B(n2; p2).
</p>
<p>Let Z = X + Y . The Exact Test of Fisher uses the fact that the row marginal fre-
quencies n1 and n2 in the following table
</p>
<p>Success Failure Total
</p>
<p>Population A X n1 &minus; X n1
Population B Z &minus; X = Y n2 &minus; (Z &minus; X) n2
Total Z (n1 + n2 &minus; Z) n1 + n2
</p>
<p>are fixed by the sample sizes n1 and n2. Conditional on the total number of successes
</p>
<p>Z = z (i.e. the column margins are assumed to be fixed), the only remaining random
variable is X (since the other three entries of the table are then determined by the
</p>
<p>realization x of X and the margins). Under H0 : p1 = p2 = p, it can be shown that
X &sim; H(n, n1, z),</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>Appendix C: Technical Appendix 429
</p>
<p>i.e.
</p>
<p>P(X = x |Z = z) =
(
</p>
<p>n1
x
</p>
<p>)(
n&minus;n1
z&minus;x
</p>
<p>)
</p>
<p>(
n
z
</p>
<p>) .
</p>
<p>The proof is straightforward using the idea of conditioning on Z = z and the assump-
tion of independence of the two samples:
</p>
<p>P(X = x |Z = z) = P(X = x, Z = z)
P(Z = z) =
</p>
<p>P(X = x, Y = z &minus; x)
P(Z = z)
</p>
<p>= P(X = x)P(Y = z &minus; x)
P(Z = z)
</p>
<p>=
(n1
</p>
<p>x
</p>
<p>)
</p>
<p>px (1&minus; p)n1&minus;x
( n2
z&minus;x
</p>
<p>)
</p>
<p>pz&minus;x (1&minus; p)n2&minus;(z&minus;x)
(n
</p>
<p>z
</p>
<p>)
</p>
<p>pz(1&minus; p)n&minus;z
</p>
<p>=
(n1
</p>
<p>x
</p>
<p>)( n2
z&minus;x
</p>
<p>)
</p>
<p>(n
z
</p>
<p>) =
(n1
</p>
<p>x
</p>
<p>)(n&minus;n1
z&minus;x
</p>
<p>)
</p>
<p>(n
z
</p>
<p>) .
</p>
<p>Note that in the equation above we use the fact that under H0, Z = X + Y is B(n, p)
distributed; see the additivity theorem for the binomial distribution, i.e. Theorem
</p>
<p>8.1.1.
</p>
<p>Example C.1 Consider two competing lotteries A and B. Say we buy 10 tickets from
</p>
<p>each lottery and test the hypothesis of equal winning probabilities. The data can be
</p>
<p>summarized in a 2&times; 2 table:
</p>
<p>Winning Not winning Total
</p>
<p>Lottery A 1 24 25
</p>
<p>Lottery B 7 18 25
</p>
<p>Total 8 42 50
</p>
<p>In R, we can use the command fisher.test to perform the test. Using the exam-
</p>
<p>ple data and H1 : p1 �= p2, we get
</p>
<p>ft &lt;- matrix(nrow=2,ncol=2,data=cbind(c(1,7), c(24,18)))
</p>
<p>fisher.test(x=ft)
</p>
<p>with output
</p>
<p>Fisher&rsquo;s Exact Test for Count Data
</p>
<p>data: fisher.table
</p>
<p>p-value = 0.0488
</p>
<p>alternative hypothesis: true odds ratio is not equal to 1</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>430 Appendix C: Technical Appendix
</p>
<p>95 percent confidence interval:
</p>
<p>0.002289885 0.992114690
</p>
<p>sample estimates:
</p>
<p>odds ratio
</p>
<p>0.1114886
</p>
<p>For the example data and α = 0.05, the null hypothesis is rejected, since the p-value
is lower than α. For the calculation of the p-value, the one-sided and two-sided cases
</p>
<p>have to be distinguished. The idea is that while fixing the margins at the observed
</p>
<p>values (i.e. 25, 25, 8, 42), we have to calculate the sum of the probabilities of all
</p>
<p>tables which have lower probability than the observed table. In R, one can use the
</p>
<p>functions dhyper and phyper for calculating (cumulative) probabilities. For exam-
</p>
<p>ple, P(X = 1|Z = 8) can be calculated as
</p>
<p>dhyper(1,25,25,8)
</p>
<p>[1] 0.02238402
</p>
<p>A more extreme table than the observed one is
</p>
<p>0 25 25
</p>
<p>8 17 25
</p>
<p>8 42 50
</p>
<p>with probability P(X = 0) = dhyper(0,25,25,8) = 0.002, which is lower than
P(X = 1). The sum is 0.0224+ 0.002 = 0.0244 which is the (left) one-sided p-
value. In this case (not generally true!), the two-sided p-value is simply two times
</p>
<p>the one-sided value, i.e. 2 &middot; 0.0244 = 0.0488.
</p>
<p>Remark C.1 The two-sided version of the Exact Test of Fisher can also be used as
</p>
<p>a test of independence of two binary variables. It is equivalent to the test of equality
</p>
<p>of two proportions, see Example 10.8.2.
</p>
<p>One-Sample χ2-Test for Testing Hypothesis About the Variance. We assume a
</p>
<p>normal population, i.e. X &sim; N (μ,σ2) and an i.i.d. sample (X1, X2, . . . , Xn) distrib-
uted as X . We only introduce the test for two-sided hypotheses
</p>
<p>H0 : σ2 = σ20
versus
</p>
<p>H1 : σ2 �= σ20 .</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_10">http://dx.doi.org/10.1007/978-3-319-46162-5_10</a></div>
</div>
<div class="page"><p/>
<p>Appendix C: Technical Appendix 431
</p>
<p>The test statistic
</p>
<p>T (X) =
(n &minus; 1)S2X
</p>
<p>σ20
</p>
<p>follows a χ2n&minus;1-distribution under H0. The critical region is constructed by taking
the α/2- and (1&minus; α/2) quantile as critical values; i.e. H0 is rejected, if
</p>
<p>t (x) &lt; cn&minus;1;α/2
</p>
<p>or if
</p>
<p>t (x) &gt; cn&minus;1;1&minus;α/2,
</p>
<p>where cn&minus;1;α/2 and cn&minus;1;1&minus;α/2 are the desired quantiles of a χ2-distribution. In R,
the test can be called by the sigma.test function in the TeachingDemos library or
</p>
<p>the varTest function in library EnvStats. Both functions also return a confidence
</p>
<p>interval for the desired confidence level. Note that the test is biased. An unbiased
</p>
<p>level α test would not take α/2 at the tails but two different tail probabilities α1 and
</p>
<p>α2 with α1 + α2 = α.
</p>
<p>F-Test for Comparing Two Variances. Comparing variances can be of interest
</p>
<p>when comparing the variability, i.e. the &ldquo;precision&rdquo; of two industrial processes; or
</p>
<p>when comparing two medical treatments with respect to their reliability. Consider
</p>
<p>two populations characterized by two independent random variables X and Y which
</p>
<p>follow normal distributions:
</p>
<p>X &sim; N (μX ,σ2X ), Y &sim; N (μY ,σ2Y ).
</p>
<p>For now, we distinguish the following two hypotheses:
</p>
<p>H0 : σ2X = σ2Y versus H1 : σ2X �= σ2Y , two-sided
H0 : σ2X &le; σ2Y versus H1 : σ2X &gt; σ2Y , one-sided.
</p>
<p>The third hypothesis with H1 : σ2X &lt; σ2Y is similar to the second hypothesis where
X and Y are replaced with each other.
</p>
<p>Test Statistic
</p>
<p>Let (X1, X2, . . . , Xn1) and (Y1, Y2, . . . , Yn2) be two independent random samples
</p>
<p>of size n1 and n2. The test statistic is defined as the ratio of the two sample variances
</p>
<p>T (X,Y) =
S2X
</p>
<p>S2Y
, (C.10)
</p>
<p>which is, under the null hypothesis, F-distributed with n1 &minus; 1 and n2 &minus; 1 degrees
of freedom, see also Sect. 8.3.3.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_8">http://dx.doi.org/10.1007/978-3-319-46162-5_8</a></div>
</div>
<div class="page"><p/>
<p>432 Appendix C: Technical Appendix
</p>
<p>Critical Region
</p>
<p>Two-Sided Case. The motivation behind the construction of the critical region
</p>
<p>for the two-sided case, H0: σ
2
X = σ2Y vs. H1: σ2X �= σ2Y , is that if the null hypothesis
</p>
<p>is true (i.e. the two variances are equal) then the test statistic (C.10) would be 1;
</p>
<p>also, T (X,Y) &gt; 0. Therefore, very small (but positive) and very large values of
</p>
<p>T (X,Y) should lead to a rejection of H0. The critical region can then be written as
</p>
<p>K = [0, k1) &cup; (k2,&infin;), where k1 and k2 are critical values such that
P(T (X,Y) &lt; k1|H0) = α/2
</p>
<p>P(T (X,Y) &gt; k2|H0) = α/2.
Here k1 and k2 can be calculated from the quantile function of the F-distribution as
</p>
<p>k1 = fn1&minus;1,n2&minus;1,α/2, k2 = fn1&minus;1,n2&minus;1,1&minus;α/2.
</p>
<p>Example C.2 Let n1 = 50, n2 = 60 and α = 0.05. Using the qf command in R, we
can determine the critical values as:
</p>
<p>qf(q=0.025, df1=50-1, df2=60-1)
</p>
<p>qf(q=0.975, df1=50-1, df2=60-1)
</p>
<p>The results are k1 = 0.5778867 and k2 = 1.706867.
</p>
<p>Remark C.2 There is the following relationshipbetweenquantiles of the F-distribution:
</p>
<p>fn1&minus;1;n2&minus;1;α/2 =
1
</p>
<p>fn2&minus;1;n1&minus;1;1&minus;α/2
.
</p>
<p>One-Sided Case. In the one-sided case, the alternative hypothesis is always for-
</p>
<p>mulated in such a way that the variance in the numerator is greater than the vari-
</p>
<p>ance in the denominator. The hypotheses are H0: σ
2
X &le; σ2Y versus H1: σ2X &gt; σ2Y
</p>
<p>or H0: σ
2
X/σ
</p>
<p>2
Y &le; 1 versus H1: σ2X/σ2Y &gt; 1. This means it does not matter whether
</p>
<p>H1 : σ2X &gt; σ2Y or H1 : σ2X &lt; σ2Y ; by constructing the test statistic in the correct way,
we implicitly specify the hypothesis. The critical region K consists of the largest
</p>
<p>values of T (X,Y), i.e. K = (k,&infin;), where k has to fulfil the condition
P(T (X,Y) &gt; k|H0) = α.
</p>
<p>The resulting critical value is denoted by k = fn1&minus;1;n2&minus;1;1&minus;α.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix C: Technical Appendix 433
</p>
<p>Observed Test Statistic
</p>
<p>Using the sample variances, the realized test statistic t is calculated as:
</p>
<p>t (x, y) = s
2
x
</p>
<p>s2y
, s2x =
</p>
<p>1
</p>
<p>n1 &minus; 1
</p>
<p>n1&sum;
</p>
<p>i=1
(xi &minus; x̄)2, s2y =
</p>
<p>1
</p>
<p>n2 &minus; 1
</p>
<p>n2&sum;
</p>
<p>i=1
(yi &minus; ȳ)2.
</p>
<p>Test Decisions
</p>
<p>Case H0 H1 Reject H0, if
</p>
<p>(a) σX = σY σX �= σY t (x, y) &gt; fn1&minus;1;n2&minus;1;1&minus;α/2 or
t (x, y) &lt; fn1&minus;1;n2&minus;1;α/2
</p>
<p>(b) σX &le; σY σX &gt; σY t (x, y) &gt; fn1&minus;1;n2&minus;1;1&minus;α
</p>
<p>Remark C.3 We have tacitly assumed that the expected values μX and μy are
</p>
<p>unknown and have to be estimated. However, this happens rarely, if ever, in practice.
</p>
<p>When estimating the expected values by the arithmeticmeans, itwould be appropriate
</p>
<p>to increase the degrees of freedom from n1 &minus; 1 to n1 and n2 &minus; 1 to n2. Interestingly,
standard software will not handle this case correctly.
</p>
<p>Example C.3 Acompany is puttingbakedbeans into cans.Two independentmachines
</p>
<p>at two sites are used. The filling weights are assumed to be normally distributed with
</p>
<p>mean 1000 g. It is speculated that one machine is more precise than the other. Two
</p>
<p>samples of the two machines give the following results:
</p>
<p>Sample n x̄ s2
</p>
<p>X 20 1000.49 72.38
</p>
<p>Y 25 1000.26 45.42
</p>
<p>With α = 0.1 and the hypotheses
</p>
<p>H0 : σ2X = σ2Y versus H1 : σ2X �= σ2Y ,
we get the following quantiles</p>
<p/>
</div>
<div class="page"><p/>
<p>434 Appendix C: Technical Appendix
</p>
<p>qf(0.05, 20-1, 25-1)
</p>
<p>[1] 0.4730049
</p>
<p>qf(0.95, 20-1, 25-1)
</p>
<p>[1] 2.039858
</p>
<p>The observed test statistic is
</p>
<p>t = 72.38
45.42
</p>
<p>= 1.59.
</p>
<p>Therefore, H0 is not rejected, since k1 &le; t &le; k2. We cannot reject the hypothesis
of equal variability of the two machines. In R, the F-test can be used using the
</p>
<p>command var.test.
</p>
<p>Remark C.4 For the t-test, we remarked that the assumption of normality is not cru-
</p>
<p>cial because the test statistic is approximately normally distributed, even formoderate
</p>
<p>sample sizes. However, the F-test relies heavily on the assumption of normality. This
</p>
<p>is why alternative tests are often used, for example the Levene&rsquo;s test.
</p>
<p>More details on Chap. 11
</p>
<p>Obtaining the Least Squares Estimates in the Linear Model.The function S(a, b)
</p>
<p>describes our optimization problem of minimizing the residual sum of squares:
</p>
<p>S(a, b) =
n
&sum;
</p>
<p>i=1
e2i =
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; a &minus; bxi )2.
</p>
<p>Minimizing S(a, b) is achieved using the principle of maxima and minima which
</p>
<p>involves taking the partial derivatives of S(a, b) with respect to both a and b and
</p>
<p>setting them equal to 0. The partial derivatives are
</p>
<p>&part;
</p>
<p>&part;a
S(a, b) =
</p>
<p>n
&sum;
</p>
<p>i=1
</p>
<p>&part;
</p>
<p>&part;a
(yi &minus; a &minus; bxi )2 = &minus;2
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; a &minus; bxi ), (C.11)
</p>
<p>&part;
</p>
<p>&part;b
S(a, b) =
</p>
<p>n
&sum;
</p>
<p>i=1
</p>
<p>&part;
</p>
<p>&part;b
(yi &minus; a &minus; bxi )2 = &minus;2
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; a &minus; bxi )xi . (C.12)
</p>
<p>Now we set (C.11) and (C.12) as equal to zero, respectively:
</p>
<p>(I)
&sum;n
</p>
<p>i=1(yi &minus; â &minus; b̂xi ) = 0,
(II)
</p>
<p>&sum;n
i=1(yi &minus; â &minus; b̂xi )xi = 0.</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-46162-5_11">http://dx.doi.org/10.1007/978-3-319-46162-5_11</a></div>
</div>
<div class="page"><p/>
<p>Appendix C: Technical Appendix 435
</p>
<p>This equates to
</p>
<p>(I&prime;) nâ + b̂
&sum;n
</p>
<p>i=1 xi =
&sum;n
</p>
<p>i=1 yi ,
(II&prime;) â
</p>
<p>&sum;n
i=1 xi + b̂
</p>
<p>&sum;n
i=1 x
</p>
<p>2
i =
</p>
<p>&sum;n
i=1 xi yi .
</p>
<p>Multiplying (I&prime;) by 1
n
yields
</p>
<p>â + b̂x̄ = ȳ
which gives us the solution for a:
</p>
<p>â = ȳ &minus; b̂x̄ .
Putting this solution into (II&prime;) gives us
</p>
<p>(ȳ &minus; b̂x̄)
n
</p>
<p>&sum;
</p>
<p>i=1
xi + b̂
</p>
<p>n
&sum;
</p>
<p>i=1
x2i =
</p>
<p>n
&sum;
</p>
<p>i=1
xi yi .
</p>
<p>Using
&sum;n
</p>
<p>i=1 xi = nx̄ leads to
</p>
<p>b̂
</p>
<p>(
n
</p>
<p>&sum;
</p>
<p>i=1
x2i &minus; nx̄2
</p>
<p>)
</p>
<p>=
n
&sum;
</p>
<p>i=1
xi yi &minus; nx̄ ȳ.
</p>
<p>If we use
n
&sum;
</p>
<p>i=1
x2i &minus; nx̄2 =
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; x̄)2 = Sxx
</p>
<p>and
</p>
<p>n
&sum;
</p>
<p>i=1
xi yi &minus; nx̄ ȳ =
</p>
<p>n
&sum;
</p>
<p>i=1
(xi &minus; x̄)(yi &minus; ȳ) = Sxy,
</p>
<p>we eventually obtain the least squares estimate of b:
</p>
<p>b̂ Sxx = Sxy
</p>
<p>b̂ = Sxy
Sxx
</p>
<p>=
&sum;n
</p>
<p>i=1(xi &minus; x̄)(yi &minus; ȳ)
&sum;n
</p>
<p>i=1(xi &minus; x̄)2
.
</p>
<p>Remark C.5 To show that the above solutions really relate to a minimum, and not
</p>
<p>to a maximum, we would need to look at all the second-order partial derivatives of
</p>
<p>S(a, b) and prove that the bordered Hessian matrix containing these derivatives is
</p>
<p>always positive definite. We omit this proof however.</p>
<p/>
</div>
<div class="page"><p/>
<p>436 Appendix C: Technical Appendix
</p>
<p>Variance Decomposition.
</p>
<p>We start with the following equation:
</p>
<p>yi &minus; ŷi = (yi &minus; ȳ)&minus; (ŷi &minus; ȳ).
If we square both sides we obtain
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ŷi )2 =
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ȳ)2 +
</p>
<p>n
&sum;
</p>
<p>i=1
(ŷi &minus; ȳ)2 &minus; 2
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ȳ)(ŷi &minus; ȳ).
</p>
<p>The last term on the right-hand side is
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ȳ)(ŷi &minus; ȳ)
</p>
<p>(11.8)=
n
&sum;
</p>
<p>i=1
(yi &minus; ȳ)b̂(xi &minus; x̄)
</p>
<p>= b̂ Sxy
(11.6)= b̂2Sxx
</p>
<p>(11.8)=
n
</p>
<p>&sum;
</p>
<p>i=1
(ŷi &minus; ȳ)2.
</p>
<p>We therefore obtain
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ŷi )2 =
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ȳ)2 &minus;
</p>
<p>n
&sum;
</p>
<p>i=1
(ŷi &minus; ȳ)2,
</p>
<p>which equates to
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ȳ)2 =
</p>
<p>n
&sum;
</p>
<p>i=1
(ŷi &minus; ȳ)2 +
</p>
<p>n
&sum;
</p>
<p>i=1
(yi &minus; ŷi )2.
</p>
<p>The Relation between R2 and r .
</p>
<p>SQResidual =
n
&sum;
</p>
<p>i=1
(yi &minus; (â + b̂xi ))2
</p>
<p>(11.8)=
n
</p>
<p>&sum;
</p>
<p>i=1
[(yi &minus; ȳ)&minus; b̂(xi &minus; x̄)]2
</p>
<p>= Syy + b̂2Sxx &minus; 2b̂Sxy
</p>
<p>= Syy &minus; b̂2Sxx = Syy &minus;
(Sxy)
</p>
<p>2
</p>
<p>Sxx
</p>
<p>SQRegression = Syy &minus; SQResidual =
(Sxy)
</p>
<p>2
</p>
<p>Sxx
.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix C: Technical Appendix 437
</p>
<p>We therefore obtain
</p>
<p>R2 = SQRegression
Syy
</p>
<p>= (Sxy)
2
</p>
<p>Sxx Syy
= r2.
</p>
<p>The Least Squares Estimators are Unbiased.
</p>
<p>E(β̂) = E((X&prime;X)&minus;1X&prime;y)
</p>
<p>Given thatX in themodel is assumed to be fixed (i.e. non-stochastic and not following
</p>
<p>any distribution), we obtain
</p>
<p>E(β̂) = (X&prime;X)&minus;1X&prime;E(y).
</p>
<p>Since E(ǫ) = 0 it follows that Ey = Xβ and therefore
</p>
<p>E(β̂) = (X&prime;X)&minus;1X&prime;Xβ = β.
</p>
<p>How to Obtain the Variance of the Least Squares Estimator. With the same
</p>
<p>arguments as above (i.e X is fixed and non-stochastic) and applying the rule
</p>
<p>Var(bX) = b2Var(X) from the scalar case to matrices we obtain:
</p>
<p>Var(β̂) = Var((X&prime;X)&minus;1X&prime;y) = (X&prime;X)&minus;1X&prime;Var(y)X(X&prime;X)&minus;1 = σ2(X&prime;X)&minus;1.
</p>
<p>Maximum Likelihood Estimation in the Linear Model. The linear model follows
</p>
<p>a normal distribution:
</p>
<p>y = Xβ + ǫ &sim; N (Xβ,σ2I).
</p>
<p>Therefore, the likelihood function of y also follows a normal distribution:
</p>
<p>L(β,σ2) = (2πσ2)&minus;n/2 exp
{
</p>
<p>&minus; 1
2σ2
</p>
<p>(y &minus; Xβ)&prime;(y &minus; Xβ)
}
</p>
<p>.
</p>
<p>The log-likelihood function is given by
</p>
<p>l(β,σ2) = &minus;n
2
ln(2πσ2)&minus; 1
</p>
<p>2σ2
(y &minus; Xβ)&prime;(y &minus; Xβ).</p>
<p/>
</div>
<div class="page"><p/>
<p>438 Appendix C: Technical Appendix
</p>
<p>To obtain the maximum likelihood estimates of β and σ2, one needs to obtain the
</p>
<p>maximaof the above function using the principle ofmaxima andminima that involves
</p>
<p>setting the partial derivatives equal to zero and finding the solution:
</p>
<p>&part;l
</p>
<p>&part;β
= 1
</p>
<p>2σ2
2X&prime;(y &minus; Xβ) = 0,
</p>
<p>&part;l
</p>
<p>&part;σ2
= &minus; n
</p>
<p>2σ2
+ 1
</p>
<p>2(σ2)2
(y &minus; Xβ)&prime;(y &minus; Xβ) = 0.
</p>
<p>We therefore have
</p>
<p>X&prime;Xβ̂ = X&prime;y, or β̂ = (X&prime;X)&minus;1X&prime;y
</p>
<p>σ̂2 = 1
n
(y &minus; Xβ̂)&prime;(y &minus; Xβ̂)
</p>
<p>which give us the ML estimates of β and σ2 in the linear regression model. Here,
</p>
<p>we also need to check the Hessian matrix of second-order partial derivatives to show
</p>
<p>that we really found a minimum and not a maximum. We omit this proof however.
</p>
<p>Distribution Tables
</p>
<p>See Tables C.1, C.2 and C.3.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix C: Technical Appendix 439
</p>
<p>T
a
</p>
<p>b
le
</p>
<p>C
.1
</p>
<p>C
D
F
v
al
u
es
</p>
<p>fo
r
th
e
st
an
d
ar
d
n
o
rm
</p>
<p>al
d
is
tr
ib
u
ti
o
n
,
Φ
(z
).
T
h
es
e
v
al
u
es
</p>
<p>ca
n
al
so
</p>
<p>b
e
o
b
ta
in
ed
</p>
<p>in
R
b
y
u
si
n
g
th
e
p
n
o
r
m
(
p
)
co
m
m
an
d
</p>
<p>z
.0
0
</p>
<p>.0
1
</p>
<p>.0
2
</p>
<p>.0
3
</p>
<p>.0
4
</p>
<p>.0
5
</p>
<p>.0
6
</p>
<p>.0
7
</p>
<p>.0
8
</p>
<p>.0
9
</p>
<p>0
.0
</p>
<p>0
.5
0
0
0
0
0
</p>
<p>0
.5
0
3
9
8
9
</p>
<p>0
.5
0
7
9
7
8
</p>
<p>0
.5
1
1
9
6
6
</p>
<p>0
.5
1
5
9
5
3
</p>
<p>0
.5
1
9
9
3
9
</p>
<p>0
.5
2
3
9
2
2
</p>
<p>0
.5
2
7
9
0
3
</p>
<p>0
.5
3
1
8
8
1
</p>
<p>0
.5
3
5
8
5
6
</p>
<p>0
.1
</p>
<p>0
.5
3
9
8
2
8
</p>
<p>0
.5
4
3
7
9
5
</p>
<p>0
.5
4
7
7
5
8
</p>
<p>0
.5
5
1
7
1
7
</p>
<p>0
.5
5
5
6
7
0
</p>
<p>0
.5
5
9
6
1
8
</p>
<p>0
.5
6
3
5
5
9
</p>
<p>0
.5
6
7
4
9
5
</p>
<p>0
.5
7
1
4
2
4
</p>
<p>0
.5
7
5
3
4
5
</p>
<p>0
.2
</p>
<p>0
.5
7
9
2
6
0
</p>
<p>0
.5
8
3
1
6
6
</p>
<p>0
.5
8
7
0
6
4
</p>
<p>0
.5
9
0
9
5
4
</p>
<p>0
.5
9
4
8
3
5
</p>
<p>0
.5
9
8
7
0
6
</p>
<p>0
.6
0
2
5
6
8
</p>
<p>0
.6
0
6
4
2
0
</p>
<p>0
.6
1
0
2
6
1
</p>
<p>0
.6
1
4
0
9
2
</p>
<p>0
.3
</p>
<p>0
.6
1
7
9
1
1
</p>
<p>0
.6
2
1
7
2
0
</p>
<p>0
.6
2
5
5
1
6
</p>
<p>0
.6
2
9
3
0
0
</p>
<p>0
.6
3
3
0
7
2
</p>
<p>0
.6
3
6
8
3
1
</p>
<p>0
.6
4
0
5
7
6
</p>
<p>0
.6
4
4
3
0
9
</p>
<p>0
.6
4
8
0
2
7
</p>
<p>0
.6
5
1
7
3
2
</p>
<p>0
.4
</p>
<p>0
.6
5
5
4
2
2
</p>
<p>0
.6
5
9
0
9
7
</p>
<p>0
.6
6
2
7
5
7
</p>
<p>0
.6
6
6
4
0
2
</p>
<p>0
.6
7
0
0
3
1
</p>
<p>0
.6
7
3
6
4
5
</p>
<p>0
.6
7
7
2
4
2
</p>
<p>0
.6
8
0
8
2
2
</p>
<p>0
.6
8
4
3
8
6
</p>
<p>0
.6
8
7
9
3
3
</p>
<p>0
.5
</p>
<p>0
.6
9
1
4
6
2
</p>
<p>0
.6
9
4
9
7
4
</p>
<p>0
.6
9
8
4
6
8
</p>
<p>0
.7
0
1
9
4
4
</p>
<p>0
.7
0
5
4
0
1
</p>
<p>0
.7
0
8
8
4
0
</p>
<p>0
.7
1
2
2
6
0
</p>
<p>0
.7
1
5
6
6
1
</p>
<p>0
.7
1
9
0
4
3
</p>
<p>0
.7
2
2
4
0
5
</p>
<p>0
.6
</p>
<p>0
.7
2
5
7
4
7
</p>
<p>0
.7
2
9
0
6
9
</p>
<p>0
.7
3
2
3
7
1
</p>
<p>0
.7
3
5
6
5
3
</p>
<p>0
.7
3
8
9
1
4
</p>
<p>0
.7
4
2
1
5
4
</p>
<p>0
.7
4
5
3
7
3
</p>
<p>0
.7
4
8
5
7
1
</p>
<p>0
.7
5
1
7
4
8
</p>
<p>0
.7
5
4
9
0
3
</p>
<p>0
.7
</p>
<p>0
.7
5
8
0
3
6
</p>
<p>0
.7
6
1
1
4
8
</p>
<p>0
.7
6
4
2
3
8
</p>
<p>0
.7
6
7
3
0
5
</p>
<p>0
.7
7
0
3
5
0
</p>
<p>0
.7
7
3
3
7
3
</p>
<p>0
.7
7
6
3
7
3
</p>
<p>0
.7
7
9
3
5
0
</p>
<p>0
.7
8
2
3
0
5
</p>
<p>0
.7
8
5
2
3
6
</p>
<p>0
.8
</p>
<p>0
.7
8
8
1
4
5
</p>
<p>0
.7
9
1
0
3
0
</p>
<p>0
.7
9
3
8
9
2
</p>
<p>0
.7
9
6
7
3
1
</p>
<p>0
.7
9
9
5
4
6
</p>
<p>0
.8
0
2
3
3
7
</p>
<p>0
.8
0
5
1
0
5
</p>
<p>0
.8
0
7
8
5
0
</p>
<p>0
.8
1
0
5
7
0
</p>
<p>0
.8
1
3
2
6
7
</p>
<p>0
.9
</p>
<p>0
.8
1
5
9
4
0
</p>
<p>0
.8
1
8
5
8
9
</p>
<p>0
.8
2
1
2
1
4
</p>
<p>0
.8
2
3
8
1
4
</p>
<p>0
.8
2
6
3
9
1
</p>
<p>0
.8
2
8
9
4
4
</p>
<p>0
.8
3
1
4
7
2
</p>
<p>0
.8
3
3
9
7
7
</p>
<p>0
.8
3
6
4
5
7
</p>
<p>0
.8
3
8
9
1
3
</p>
<p>1
.0
</p>
<p>0
.8
4
1
3
4
5
</p>
<p>0
.8
4
3
7
5
2
</p>
<p>0
.8
4
6
1
3
6
</p>
<p>0
.8
4
8
4
9
5
</p>
<p>0
.8
5
0
8
3
0
</p>
<p>0
.8
5
3
1
4
1
</p>
<p>0
.8
5
5
4
2
8
</p>
<p>0
.8
5
7
6
9
0
</p>
<p>0
.8
5
9
9
2
9
</p>
<p>0
.8
6
2
1
4
3
</p>
<p>1
.1
</p>
<p>0
.8
6
4
3
3
4
</p>
<p>0
.8
6
6
5
0
0
</p>
<p>0
.8
6
8
6
4
3
</p>
<p>0
.8
7
0
7
6
2
</p>
<p>0
.8
7
2
8
5
7
</p>
<p>0
.8
7
4
9
2
8
</p>
<p>0
.8
7
6
9
7
6
</p>
<p>0
.8
7
9
0
0
0
</p>
<p>0
.8
8
1
0
0
0
</p>
<p>0
.8
8
2
9
7
7
</p>
<p>1
.2
</p>
<p>0
.8
8
4
9
3
0
</p>
<p>0
.8
8
6
8
6
1
</p>
<p>0
.8
8
8
7
6
8
</p>
<p>0
.8
9
0
6
5
1
</p>
<p>0
.8
9
2
5
1
2
</p>
<p>0
.8
9
4
3
5
0
</p>
<p>0
.8
9
6
1
6
5
</p>
<p>0
.8
9
7
9
5
8
</p>
<p>0
.8
9
9
7
2
7
</p>
<p>0
.9
0
1
4
7
5
</p>
<p>1
.3
</p>
<p>0
.9
0
3
2
0
0
</p>
<p>0
.9
0
4
9
0
2
</p>
<p>0
.9
0
6
5
8
2
</p>
<p>0
.9
0
8
2
4
1
</p>
<p>0
.9
0
9
8
7
7
</p>
<p>0
.9
1
1
4
9
2
</p>
<p>0
.9
1
3
0
8
5
</p>
<p>0
.9
1
4
6
5
7
</p>
<p>0
.9
1
6
2
0
7
</p>
<p>0
.9
1
7
7
3
6
</p>
<p>1
.4
</p>
<p>0
.9
1
9
2
4
3
</p>
<p>0
.9
2
0
7
3
0
</p>
<p>0
.9
2
2
1
9
6
</p>
<p>0
.9
2
3
6
4
1
</p>
<p>0
.9
2
5
0
6
6
</p>
<p>0
.9
2
6
4
7
1
</p>
<p>0
.9
2
7
8
5
5
</p>
<p>0
.9
2
9
2
1
9
</p>
<p>0
.9
3
0
5
6
3
</p>
<p>0
.9
3
1
8
8
8
</p>
<p>1
.5
</p>
<p>0
.9
3
3
1
9
3
</p>
<p>0
.9
3
4
4
7
8
</p>
<p>0
.9
3
5
7
4
5
</p>
<p>0
.9
3
6
9
9
2
</p>
<p>0
.9
3
8
2
2
0
</p>
<p>0
.9
3
9
4
2
9
</p>
<p>0
.9
4
0
6
2
0
</p>
<p>0
.9
4
1
7
9
2
</p>
<p>0
.9
4
2
9
4
7
</p>
<p>0
.9
4
4
0
8
3
</p>
<p>1
.6
</p>
<p>0
.9
4
5
2
0
1
</p>
<p>0
.9
4
6
3
0
1
</p>
<p>0
.9
4
7
3
8
4
</p>
<p>0
.9
4
8
4
4
9
</p>
<p>0
.9
4
9
4
9
7
</p>
<p>0
.9
5
0
5
2
9
</p>
<p>0
.9
5
1
5
4
3
</p>
<p>0
.9
5
2
5
4
0
</p>
<p>0
.9
5
3
5
2
1
</p>
<p>0
.9
5
4
4
8
6
</p>
<p>1
.7
</p>
<p>0
.9
5
5
4
3
5
</p>
<p>0
.9
5
6
3
6
7
</p>
<p>0
.9
5
7
2
8
4
</p>
<p>0
.9
5
8
1
8
5
</p>
<p>0
.9
5
9
0
7
0
</p>
<p>0
.9
5
9
9
4
1
</p>
<p>0
.9
6
0
7
9
6
</p>
<p>0
.9
6
1
6
3
6
</p>
<p>0
.9
6
2
4
6
2
</p>
<p>0
.9
6
3
2
7
3
</p>
<p>1
.8
</p>
<p>0
.9
6
4
0
7
0
</p>
<p>0
.9
6
4
8
5
2
</p>
<p>0
.9
6
5
6
2
0
</p>
<p>0
.9
6
6
3
7
5
</p>
<p>0
.9
6
7
1
1
6
</p>
<p>0
.9
6
7
8
4
3
</p>
<p>0
.9
6
8
5
5
7
</p>
<p>0
.9
6
9
2
5
8
</p>
<p>0
.9
6
9
9
4
6
</p>
<p>0
.9
7
0
6
2
1
</p>
<p>1
.9
</p>
<p>0
.9
7
1
2
8
3
</p>
<p>0
.9
7
1
9
3
3
</p>
<p>0
.9
7
2
5
7
1
</p>
<p>0
.9
7
3
1
9
7
</p>
<p>0
.9
7
3
8
1
0
</p>
<p>0
.9
7
4
4
1
2
</p>
<p>0
.9
7
5
0
0
2
</p>
<p>0
.9
7
5
5
8
1
</p>
<p>0
.9
7
6
1
4
8
</p>
<p>0
.9
7
6
7
0
5
</p>
<p>2
.0
</p>
<p>0
.9
7
7
2
5
0
</p>
<p>0
.9
7
7
7
8
4
</p>
<p>0
.9
7
8
3
0
8
</p>
<p>0
.9
7
8
8
2
2
</p>
<p>0
.9
7
9
3
2
5
</p>
<p>0
.9
7
9
8
1
8
</p>
<p>0
.9
8
0
3
0
1
</p>
<p>0
.9
8
0
7
7
4
</p>
<p>0
.9
8
1
2
3
7
</p>
<p>0
.9
8
1
6
9
1
</p>
<p>(c
o
n
ti
n
u
ed
)</p>
<p/>
</div>
<div class="page"><p/>
<p>440 Appendix C: Technical Appendix
</p>
<p>T
a
</p>
<p>b
le
</p>
<p>C
.1
</p>
<p>(c
o
n
ti
n
u
ed
)
</p>
<p>z
.0
0
</p>
<p>.0
1
</p>
<p>.0
2
</p>
<p>.0
3
</p>
<p>.0
4
</p>
<p>.0
5
</p>
<p>.0
6
</p>
<p>.0
7
</p>
<p>.0
8
</p>
<p>.0
9
</p>
<p>2
.1
</p>
<p>0
.9
8
2
1
3
6
</p>
<p>0
.9
8
2
5
7
1
</p>
<p>0
.9
8
2
9
9
7
</p>
<p>0
.9
8
3
4
1
4
</p>
<p>0
.9
8
3
8
2
3
</p>
<p>0
.9
8
4
2
2
2
</p>
<p>0
.9
8
4
6
1
4
</p>
<p>0
.9
8
4
9
9
7
</p>
<p>0
.9
8
5
3
7
1
</p>
<p>0
.9
8
5
7
3
8
</p>
<p>2
.2
</p>
<p>0
.9
8
6
0
9
7
</p>
<p>0
.9
8
6
4
4
7
</p>
<p>0
.9
8
6
7
9
1
</p>
<p>0
.9
8
7
1
2
6
</p>
<p>0
.9
8
7
4
5
5
</p>
<p>0
.9
8
7
7
7
6
</p>
<p>0
.9
8
8
0
8
9
</p>
<p>0
.9
8
8
3
9
6
</p>
<p>0
.9
8
8
6
9
6
</p>
<p>0
.9
8
8
9
8
9
</p>
<p>2
.3
</p>
<p>0
.9
8
9
2
7
6
</p>
<p>0
.9
8
9
5
5
6
</p>
<p>0
.9
8
9
8
3
0
</p>
<p>0
.9
9
0
0
9
7
</p>
<p>0
.9
9
0
3
5
8
</p>
<p>0
.9
9
0
6
1
3
</p>
<p>0
.9
9
0
8
6
3
</p>
<p>0
.9
9
1
1
0
6
</p>
<p>0
.9
9
1
3
4
4
</p>
<p>0
.9
9
1
5
7
6
</p>
<p>2
.4
</p>
<p>0
.9
9
1
8
0
2
</p>
<p>0
.9
9
2
0
2
4
</p>
<p>0
.9
9
2
2
4
0
</p>
<p>0
.9
9
2
4
5
1
</p>
<p>0
.9
9
2
6
5
6
</p>
<p>0
.9
9
2
8
5
7
</p>
<p>0
.9
9
3
0
5
3
</p>
<p>0
.9
9
3
2
4
4
</p>
<p>0
.9
9
3
4
3
1
</p>
<p>0
.9
9
3
6
1
3
</p>
<p>2
.5
</p>
<p>0
.9
9
3
7
9
0
</p>
<p>0
.9
9
3
9
6
3
</p>
<p>0
.9
9
4
1
3
2
</p>
<p>0
.9
9
4
2
9
7
</p>
<p>0
.9
9
4
4
5
7
</p>
<p>0
.9
9
4
6
1
4
</p>
<p>0
.9
9
4
7
6
6
</p>
<p>0
.9
9
4
9
1
5
</p>
<p>0
.9
9
5
0
6
0
</p>
<p>0
.9
9
5
2
0
1
</p>
<p>2
.6
</p>
<p>0
.9
9
5
3
3
9
</p>
<p>0
.9
9
5
4
7
3
</p>
<p>0
.9
9
5
6
0
4
</p>
<p>0
.9
9
5
7
3
1
</p>
<p>0
.9
9
5
8
5
5
</p>
<p>0
.9
9
5
9
7
5
</p>
<p>0
.9
9
6
0
9
3
</p>
<p>0
.9
9
6
2
0
7
</p>
<p>0
.9
9
6
3
1
9
</p>
<p>0
.9
9
6
4
2
7
</p>
<p>2
.7
</p>
<p>0
.9
9
6
5
3
3
</p>
<p>0
.9
9
6
6
3
6
</p>
<p>0
.9
9
6
7
3
6
</p>
<p>0
.9
9
6
8
3
3
</p>
<p>0
.9
9
6
9
2
8
</p>
<p>0
.9
9
7
0
2
0
</p>
<p>0
.9
9
7
1
1
0
</p>
<p>0
.9
9
7
1
9
7
</p>
<p>0
.9
9
7
2
8
2
</p>
<p>0
.9
9
7
3
6
5
</p>
<p>2
.8
</p>
<p>0
.9
9
7
4
4
5
</p>
<p>0
.9
9
7
5
2
3
</p>
<p>0
.9
9
7
5
9
9
</p>
<p>0
.9
9
7
6
7
3
</p>
<p>0
.9
9
7
7
4
4
</p>
<p>0
.9
9
7
8
1
4
</p>
<p>0
.9
9
7
8
8
2
</p>
<p>0
.9
9
7
9
4
8
</p>
<p>0
.9
9
8
0
1
2
</p>
<p>0
.9
9
8
0
7
4
</p>
<p>2
.9
</p>
<p>0
.9
9
8
1
3
4
</p>
<p>0
.9
9
8
1
9
3
</p>
<p>0
.9
9
8
2
5
0
</p>
<p>0
.9
9
8
3
0
5
</p>
<p>0
.9
9
8
3
5
9
</p>
<p>0
.9
9
8
4
1
1
</p>
<p>0
.9
9
8
4
6
2
</p>
<p>0
.9
9
8
5
1
1
</p>
<p>0
.9
9
8
5
5
9
</p>
<p>0
.9
9
8
6
0
5
</p>
<p>3
.0
</p>
<p>0
.9
9
8
6
5
0
</p>
<p>0
.9
9
8
6
9
4
</p>
<p>0
.9
9
8
7
3
6
</p>
<p>0
.9
9
8
7
7
7
</p>
<p>0
.9
9
8
8
1
7
</p>
<p>0
.9
9
8
8
5
6
</p>
<p>0
.9
9
8
8
9
3
</p>
<p>0
.9
9
8
9
3
0
</p>
<p>0
.9
9
8
9
6
5
</p>
<p>0
.9
9
8
9
9
9</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix C: Technical Appendix 441
</p>
<p>Table C.2 (1&minus; α) quantiles for the t-distribution. These values can also be obtained in R using
the qt(p,df) command.
</p>
<p>d f 1&minus; α
0.95 0.975 0.99 0.995
</p>
<p>1 6.3138 12.706 31.821 63.657
</p>
<p>2 2.9200 4.3027 6.9646 9.9248
</p>
<p>3 2.3534 3.1824 4.5407 5.8409
</p>
<p>4 2.1318 2.7764 3.7469 4.6041
</p>
<p>5 2.0150 2.5706 3.3649 4.0321
</p>
<p>6 1.9432 2.4469 3.1427 3.7074
</p>
<p>7 1.8946 2.3646 2.9980 3.4995
</p>
<p>8 1.8595 2.3060 2.8965 3.3554
</p>
<p>9 1.8331 2.2622 2.8214 3.2498
</p>
<p>10 1.8125 2.2281 2.7638 3.1693
</p>
<p>11 1.7959 2.2010 2.7181 3.1058
</p>
<p>12 1.7823 2.1788 2.6810 3.0545
</p>
<p>13 1.7709 2.1604 2.6503 3.0123
</p>
<p>14 1.7613 2.1448 2.6245 2.9768
</p>
<p>15 1.7531 2.1314 2.6025 2.9467
</p>
<p>16 1.7459 2.1199 2.5835 2.9208
</p>
<p>17 1.7396 2.1098 2.5669 2.8982
</p>
<p>18 1.7341 2.1009 2.5524 2.8784
</p>
<p>19 1.7291 2.0930 2.5395 2.8609
</p>
<p>20 1.7247 2.0860 2.5280 2.8453
</p>
<p>30 1.6973 2.0423 2.4573 2.7500
</p>
<p>40 1.6839 2.0211 2.4233 2.7045
</p>
<p>50 1.6759 2.0086 2.4033 2.6778
</p>
<p>60 1.6706 2.0003 2.3901 2.6603
</p>
<p>70 1.6669 1.9944 2.3808 2.6479
</p>
<p>80 1.6641 1.9901 2.3739 2.6387
</p>
<p>90 1.6620 1.9867 2.3685 2.6316
</p>
<p>100 1.6602 1.9840 2.3642 2.6259
</p>
<p>200 1.6525 1.9719 2.3451 2.6006
</p>
<p>300 1.6499 1.9679 2.3388 2.5923
</p>
<p>400 1.6487 1.9659 2.3357 2.5882
</p>
<p>500 1.6479 1.9647 2.3338 2.5857</p>
<p/>
</div>
<div class="page"><p/>
<p>442 Appendix C: Technical Appendix
</p>
<p>Table C.3 (1&minus; α) quantiles of the χ2-distribution. These values can also be obtained in R using
the qchisq(p,df) command
</p>
<p>d f 1&minus; α
0.01 0.025 0.05 0.95 0.975 0.99
</p>
<p>1 0.0001 0.001 0.004 3.84 5.02 6.62
</p>
<p>2 0.020 0.051 0.103 5.99 7.38 9.21
</p>
<p>3 0.115 0.216 0.352 7.81 9.35 11.3
</p>
<p>4 0.297 0.484 0.711 9.49 11.1 13.3
</p>
<p>5 0.554 0.831 1.15 11.1 12.8 15.1
</p>
<p>6 0.872 1.24 1.64 12.6 14.4 16.8
</p>
<p>7 1.24 1.69 2.17 14.1 16.0 18.5
</p>
<p>8 1.65 2.18 2.73 15.5 17.5 20.1
</p>
<p>9 2.09 2.70 3.33 16.9 19.0 21.7
</p>
<p>10 2.56 3.25 3.94 18.3 20.5 23.2
</p>
<p>11 3.05 3.82 4.57 19.7 21.9 24.7
</p>
<p>12 3.57 4.40 5.23 21.0 23.3 26.2
</p>
<p>13 4.11 5.01 5.89 22.4 24.7 27.7
</p>
<p>14 4.66 5.63 6.57 23.7 26.1 29.1
</p>
<p>15 5.23 6.26 7.26 25.0 27.5 30.6
</p>
<p>16 5.81 6.91 7.96 26.3 28.8 32.0
</p>
<p>17 6.41 7.56 8.67 27.6 30.2 33.4
</p>
<p>18 7.01 8.23 9.39 28.9 31.5 34.8
</p>
<p>19 7.63 8.91 10.1 30.1 32.9 36.2
</p>
<p>20 8.26 9.59 10.9 31.4 34.2 37.6
</p>
<p>25 11.5 13.1 14.6 37.7 40.6 44.3
</p>
<p>30 15.0 16.8 18.5 43.8 47.0 50.9
</p>
<p>40 22.2 24.4 26.5 55.8 59.3 63.7
</p>
<p>50 29.7 32.4 34.8 67.5 71.4 76.2
</p>
<p>60 37.5 40.5 43.2 79.1 83.3 88.4
</p>
<p>70 45.4 48.8 51.7 90.5 95.0 100.4
</p>
<p>80 53.5 57.2 60.4 101.9 106.6 112.3
</p>
<p>90 61.8 65.6 69.1 113.1 118.1 124.1
</p>
<p>100 70.1 74.2 77.9 124.3 129.6 135.8
</p>
<p>Quantiles of the F-Distribution. These quantiles can be obtained in R using the
</p>
<p>qf(p,df1,df2) command.</p>
<p/>
</div>
<div class="page"><p/>
<p>DAppendix:Visual Summaries
</p>
<p>Descriptive Data Analysis
</p>
<p>one variable
</p>
<p>nominal ordinal continuous
</p>
<p>bar chart
pie chart
freq. table
</p>
<p>mode
</p>
<p>bar chart
pie chart
freq. table
box plot
ECDF
</p>
<p>median, mode,
quartiles,
range, IQR
</p>
<p>box plot
histogram
kernel density plot
ECDF
</p>
<p>median, mean,
quartiles,
variance, absolute
median deviation,
range, IQR
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5
</p>
<p>443</p>
<p/>
</div>
<div class="page"><p/>
<p>444 Appendix D: Visual Summaries
</p>
<p>t
w
</p>
<p>o
v
a
r
ia
</p>
<p>b
le
</p>
<p>s
</p>
<p>o
r
d
in
</p>
<p>a
l
&ndash;
</p>
<p>o
r
d
in
</p>
<p>a
l
</p>
<p>c
o
n
ti
n
u
o
u
s
</p>
<p>&ndash;
c
o
n
ti
n
u
o
u
s
</p>
<p>o
r
d
in
</p>
<p>a
l
&ndash;
</p>
<p>c
o
n
ti
n
u
o
u
s
</p>
<p>n
o
m
</p>
<p>in
a
l
&ndash;
</p>
<p>c
o
n
ti
n
u
o
u
s
</p>
<p>n
o
m
</p>
<p>in
a
l
&ndash;
</p>
<p>o
r
d
in
</p>
<p>a
l
</p>
<p>d
iff
</p>
<p>e
r
e
n
t
</p>
<p>s
c
a
le
</p>
<p>s
</p>
<p>n
o
m
</p>
<p>in
a
l
&ndash;
</p>
<p>n
o
m
</p>
<p>in
a
l
</p>
<p>co
rr
el
at
io
n
:
r,
R
</p>
<p>sc
at
te
r
p
lo
t
</p>
<p>gr
ap
</p>
<p>h
s
d
ep
</p>
<p>en
d
in
g
on
</p>
<p>n
u
m
b
er
</p>
<p>of
ca
te
go
</p>
<p>ri
es
</p>
<p>as
so
ci
at
io
n
:
</p>
<p>γ
,
τ c
,
R
</p>
<p>as
so
ci
at
io
n
:
</p>
<p>C
ra
m
er
&rsquo;s
</p>
<p>V
,
C
</p>
<p>c
o
r
r
,
χ
</p>
<p>2
,
</p>
<p>re
la
ti
v
e
ri
sk
s,
</p>
<p>o
d
d
s
ra
ti
o
</p>
<p>st
ra
ti
fi
ed
</p>
<p>or
st
ac
k
ed
</p>
<p>b
ar
</p>
<p>ch
ar
ts
</p>
<p>st
ra
</p>
<p>ti
fi
ed
</p>
<p>b
ox
</p>
<p>p
lo
ts
,
E
C
D
F
s,
</p>
<p>h
is
to
gr
am
</p>
<p>s,
d
en
</p>
<p>si
ty
</p>
<p>p
lo
ts
,
</p>
<p>su
m
m
ar
y
st
at
is
ti
cs
</p>
<p>as
n
om
</p>
<p>in
al
</p>
<p>&ndash;
n
o
m
in
a
l
</p>
<p>+
st
</p>
<p>ra
ti
fi
ed
</p>
<p>q
u
ar
ti
le
s,
</p>
<p>γ
,
τ c
,
R
</p>
<p>as
or
d
in
al
</p>
<p>&ndash;
o
rd
in
a
l
o
r
</p>
<p>n
om
</p>
<p>in
al
</p>
<p>&ndash;
co
n
ti
n
u
o
u
s</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix D: Visual Summaries 445
</p>
<p>Summary of Tests for Continuous and Ordinal Variables
</p>
<p>co
n
ti
n
u
ou
</p>
<p>s
or
d
in
al
</p>
<p>p
a
ra
m
et
ri
c
</p>
<p>n
on
</p>
<p>p
ar
am
</p>
<p>et
ri
c
</p>
<p>1
sa
m
p
le
</p>
<p>2
sa
m
p
le
</p>
<p>k
sa
m
p
le
</p>
<p>&micro;
σ
</p>
<p>2
&micro;
</p>
<p>σ
2
</p>
<p>&micro;
</p>
<p>t-
te
st
</p>
<p>1
</p>
<p>t
.
t
e
s
t
(
)
</p>
<p>p
.
21
9
</p>
<p>χ
2
-t
es
t
</p>
<p>s
i
g
m
a
.
t
e
s
t
(
)
2
</p>
<p>p
.
43
0
</p>
<p>F
-t
es
t
</p>
<p>v
a
r
.
t
e
s
t
(
)
</p>
<p>p
.
43
0
</p>
<p>A
N
O
V
A
</p>
<p>a
n
o
v
a
(
)
</p>
<p>p
.
27
4
</p>
<p>in
d
ep
</p>
<p>en
d
en
t
</p>
<p>d
ep
</p>
<p>en
d
en
t
</p>
<p>t-
te
st
</p>
<p>1
,
3
,
</p>
<p>t
.
t
e
s
t
(
)
</p>
<p>p
.
2
21
</p>
<p>p
ai
re
d
t-
te
st
</p>
<p>t
.
t
e
s
t
(
)
</p>
<p>p
.
22
5
</p>
<p>s
e
e
</p>
<p>n
e
x
t
</p>
<p>p
a
g
e
</p>
<p>1
fo
r
k
n
ow
</p>
<p>n
va
ri
a
n
ce
</p>
<p>th
e
G
a
u
ss
</p>
<p>te
st
</p>
<p>ca
n
b
e
u
se
d
</p>
<p>2
fr
o
m
</p>
<p>p
a
ck
a
g
e
T
e
a
c
h
i
n
g
D
e
m
o
s
</p>
<p>3
=
W
el
ch
</p>
<p>te
st
</p>
<p>if
va
ri
a
n
ce
s
a
re
</p>
<p>u
n
k
n
ow
</p>
<p>n
a
n
d
u
n
eq
u
a
l</p>
<p/>
</div>
<div class="page"><p/>
<p>446 Appendix D: Visual Summaries
</p>
<p>co
n
ti
n
u
ou
</p>
<p>s
or
d
in
a
l
</p>
<p>p
ar
am
</p>
<p>et
ri
c
</p>
<p>n
on
</p>
<p>p
ar
am
</p>
<p>et
ri
c
</p>
<p>1
sa
m
p
le
</p>
<p>2
sa
m
p
le
</p>
<p>k
sa
m
p
le
</p>
<p>m
ed
</p>
<p>ia
n
/
</p>
<p>lo
ca
ti
on
</p>
<p>m
ed
</p>
<p>ia
n
/
</p>
<p>lo
ca
ti
on
</p>
<p>m
ed
</p>
<p>ia
n
/
</p>
<p>lo
ca
ti
o
n
</p>
<p>si
gn
</p>
<p>te
st
</p>
<p>1
,
</p>
<p>b
i
n
o
m
.
t
e
s
t
(
)
</p>
<p>U
-T
es
t
</p>
<p>w
i
l
c
o
x
.
t
e
s
t
(
)
2
</p>
<p>p
.
23
</p>
<p>2
</p>
<p>K
ru
sk
a
l-
W
a
ll
is
</p>
<p>te
st
</p>
<p>3
</p>
<p>k
r
u
s
k
a
l
.
t
e
s
t
(
)
</p>
<p>p
r
e
v
io
</p>
<p>u
s
</p>
<p>p
a
g
e
</p>
<p>1
n
o
t
ex
p
la
in
ed
</p>
<p>in
th
is
</p>
<p>b
o
o
k
;
a
lt
er
n
a
ti
v
e:
</p>
<p>M
o
o
d
&rsquo;s
</p>
<p>m
ed
</p>
<p>ia
n
te
st
</p>
<p>2
u
se
</p>
<p>o
p
ti
o
n
p
a
i
r
e
d
=
T
R
U
E
fo
r
d
ep
</p>
<p>en
d
en
</p>
<p>t
d
a
ta
</p>
<p>3
n
o
t
ex
p
la
in
ed
</p>
<p>in
th
is
</p>
<p>b
o
o
k
;
u
se
</p>
<p>F
ri
ed
</p>
<p>m
a
n
te
st
</p>
<p>fo
r
d
ep
</p>
<p>en
d
en
</p>
<p>t
d
a
ta</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix D: Visual Summaries 447
</p>
<p>Summary of Tests for Nominal Variables
</p>
<p>n
om
</p>
<p>in
al
</p>
<p>n
on
</p>
<p>-n
om
</p>
<p>in
al
</p>
<p>b
in
ar
y
</p>
<p>ca
te
go
ri
ca
l
</p>
<p>1
sa
m
p
le
</p>
<p>2
sa
m
p
le
</p>
<p>k
sa
m
p
le
</p>
<p>s
e
e
</p>
<p>A
p
p
e
n
d
ix
</p>
<p> D
.2
</p>
<p>s
e
e
</p>
<p>n
e
x
t
</p>
<p>p
a
g
e
</p>
<p>in
d
ep
</p>
<p>en
d
en
t
</p>
<p>d
ep
</p>
<p>en
d
en
t
</p>
<p>B
in
om
</p>
<p>ia
l
te
st
</p>
<p>b
i
n
o
m
.
t
e
s
t
(
)
</p>
<p>p
.
22
7
</p>
<p>F
is
h
er
</p>
<p>te
st
</p>
<p>1
</p>
<p>f
i
s
h
e
r
.
t
e
s
t
(
)
</p>
<p>p
.
42
8
</p>
<p>M
cN
</p>
<p>em
ar
</p>
<p>te
st
</p>
<p>2
</p>
<p>m
c
n
e
m
a
r
.
t
e
s
t
(
)
</p>
<p>χ
2
h
om
</p>
<p>og
en
ei
t y
</p>
<p>3
</p>
<p>p
r
o
p
.
t
e
s
t
(
)
</p>
<p>p
.
24
0
</p>
<p>1
a
lt
er
n
a
ti
v
e:
</p>
<p>χ
2
-i
n
d
ep
</p>
<p>en
d
en
</p>
<p>ce
te
st
</p>
<p>(c
h
i
s
q
.
t
e
s
t
(
)
)
</p>
<p>(t
es
t
d
ec
is
io
n
eq
u
iv
a
le
n
t
to
</p>
<p>χ
2
-h
o
m
o
g
en
</p>
<p>ei
ty
</p>
<p>te
st
)
</p>
<p>2
n
o
t
ex
p
la
in
ed
</p>
<p>in
th
is
</p>
<p>b
o
o
k
</p>
<p>3
te
st
</p>
<p>d
ec
is
io
n
eq
u
iv
a
le
n
t
to
</p>
<p>χ
2
-i
n
d
ep
</p>
<p>en
d
en
</p>
<p>ce
te
st</p>
<p/>
</div>
<div class="page"><p/>
<p>448 Appendix D: Visual Summaries
</p>
<p>n
om
</p>
<p>in
al
</p>
<p>n
o
n
-n
o
m
in
a
l
</p>
<p>ca
te
go
</p>
<p>ri
ca
l
</p>
<p>b
in
ar
y
</p>
<p>1
sa
m
p
le
</p>
<p>2
sa
m
p
le
</p>
<p>k
sa
m
p
le
</p>
<p>s
e
e
</p>
<p>A
p
p
e
n
d
ix
</p>
<p> D
.2
</p>
<p>s
e
e
</p>
<p>p
r
e
v
io
</p>
<p>u
s
</p>
<p>p
a
g
e
</p>
<p>χ
2
G
o
F
te
st
</p>
<p>c
h
i
s
q
.
t
e
s
t
(
)
</p>
<p>p
.
2
35
</p>
<p>χ
2
-i
n
d
ep
</p>
<p>en
d
en
</p>
<p>ce
1
</p>
<p>c
h
i
s
q
.
t
e
s
t
(
)
</p>
<p>p
.
23
</p>
<p>8
</p>
<p>χ
2
-i
n
d
ep
</p>
<p>en
d
en
</p>
<p>ce
1
</p>
<p>c
h
i
s
q
.
t
e
s
t
(
)
</p>
<p>p
.
23
</p>
<p>8
</p>
<p>1
te
st
</p>
<p>d
ec
is
io
n
eq
u
iv
al
en
t
to
</p>
<p>χ
2
-h
om
</p>
<p>og
en
</p>
<p>ei
ty
</p>
<p>te
st
</p>
<p>(p
r
o
p
.
t
e
s
t
)</p>
<p/>
</div>
<div class="page"><p/>
<p>References
</p>
<p>Adler, J. (2012). R in a Nutshell. Boston: O&rsquo;Reilly.
</p>
<p>Albert, J., &amp; Rizzo, M. (2012). R by Example. New York: Springer.
</p>
<p>Bock, J. (1997). Bestimmung des Stichprobenumfangs. Munich: Oldenbourg Verlag. (in German).
</p>
<p>Casella, G., &amp; Berger, R. (2002). Statistical inference. Boston, MA: Cengage Learning.
</p>
<p>Chow, S., Wang, H., &amp; Shao, J. (2007). Sample size calculations in clinical research. London:
</p>
<p>Chapman and Hall.
</p>
<p>Crawley, M. (2013). The R book. London: Wiley.
</p>
<p>Dalgaard, P. (2008). Introductory statistics with R. Berlin: Springer.
</p>
<p>Everitt, B., &amp; Hothorn, T. (2011). An introduction to applied multivariate analysis with R. New
</p>
<p>York: Springer.
</p>
<p>Groves, R., Fowler, F., Couper, M., Lepkowski, J., Singer, E., &amp; Tourangeau, R. (2009). Survey
</p>
<p>methodology. Wiley series in survey methodology. Hoboken, NJ: Wiley.
</p>
<p>Hernan, M., &amp; Robins, J. (2017). Causal inference. Boca Raton: Chapman and Hall/CRC.
</p>
<p>Hyndman, R. J., &amp; Fan, Y. (1996). Sample quantiles in statistical packages. American Statistician,
</p>
<p>50, 361&ndash;365.
</p>
<p>Kauermann, G., &amp; K&uuml;chenhoff, H. (2011). Stichproben - Methoden und praktische Umsetzung in
</p>
<p>R. Heidelberg: Springer. (in German).
</p>
<p>Ligges, U. (2008). Programmieren in R. Heidelberg: Springer. (in German).
</p>
<p>R Core Team (2016). R: A language and environment for statistical computing. Vienna, Austria: R
</p>
<p>Foundation for Statistical Computing. http://www.R-project.org/.
</p>
<p>Young,G.,&amp;Smith, R. (2005).Essentials of statistical inference. Cambridge:CambridgeUniversity
</p>
<p>Press.
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5
</p>
<p>449</p>
<p/>
<div class="annotation"><a href="http://www.R-project.org/">http://www.R-project.org/</a></div>
</div>
<div class="page"><p/>
<p>Index
</p>
<p>A
</p>
<p>Absolute
</p>
<p>deviation, 51
</p>
<p>mean deviation, 51
</p>
<p>median deviation, 51
</p>
<p>Additivity theorem, 116, 147
</p>
<p>Akaike&rsquo;s information criterion (AIC), 282
</p>
<p>Analysis of variance, 274
</p>
<p>ANOVA, 274
</p>
<p>Arithmetic mean, 38
</p>
<p>properties, 40
</p>
<p>weighted, 38
</p>
<p>Association, 67, 249
</p>
<p>B
</p>
<p>Backward selection, 282
</p>
<p>Bar chart, 24
</p>
<p>Behrens-Fisher problem, 222
</p>
<p>Bernoulli distribution, 156
</p>
<p>Bias, 184
</p>
<p>Binomial
</p>
<p>coefficient, 102
</p>
<p>distribution, 157
</p>
<p>Bivariate random variables, 140
</p>
<p>Box plot, 56
</p>
<p>C
</p>
<p>Calculation rules
</p>
<p>CDF, 133
</p>
<p>expectation, 144
</p>
<p>normal random variables, 168
</p>
<p>probabilities, 117
</p>
<p>variance, 144
</p>
<p>Causation, 288
</p>
<p>CDF, 129
</p>
<p>calculation rules, 133
</p>
<p>joint, 141
</p>
<p>quantile, 137
</p>
<p>quartile, 137
</p>
<p>Central limit theorem, 426
</p>
<p>Central tendency, 38
</p>
<p>Certain event, 110
</p>
<p>χ2
</p>
<p>distribution, 171, 427
</p>
<p>goodness-of-fit test, 235
</p>
<p>independence test, 238
</p>
<p>test of homogeneity, 240, 241
</p>
<p>variance test, 430
</p>
<p>Coding
</p>
<p>dummy, 266
</p>
<p>effect, 267
</p>
<p>Coefficient
</p>
<p>binomial, 102
</p>
<p>of variation, 55
</p>
<p>regression, 251
</p>
<p>Combinations, 102
</p>
<p>with order, 103, 104
</p>
<p>with replacement, 103, 104
</p>
<p>without order, 102, 103
</p>
<p>without replacement, 102, 103
</p>
<p>Combinatorics, 97
</p>
<p>Complementary event, 110
</p>
<p>Composite event, 110
</p>
<p>Conditional
</p>
<p>distribution, 141, 143
</p>
<p>frequency distribution, 70
</p>
<p>probability, 117
</p>
<p>relative frequency distribution, 70
</p>
<p>Confidence
</p>
<p>bound, 196
</p>
<p>interval, 196, 197
</p>
<p>interval for μ; σ2 known, 197
</p>
<p>interval for μ; σ2 unknown, 198
</p>
<p>&copy; Springer International Publishing Switzerland 2016
</p>
<p>C. Heumann et al., Introduction to Statistics and Data Analysis,
</p>
<p>DOI 10.1007/978-3-319-46162-5
</p>
<p>451</p>
<p/>
</div>
<div class="page"><p/>
<p>452 Index
</p>
<p>interval for p, 199
</p>
<p>interval for the odds ratio, 201
</p>
<p>level, 196
</p>
<p>Consistency, 189
</p>
<p>Contingency
</p>
<p>coefficient, 77
</p>
<p>table, 68, 140
</p>
<p>Continuous variable, 6
</p>
<p>Convergence
</p>
<p>stochastic, 425
</p>
<p>Correlation coefficient, 148
</p>
<p>of Bravais&ndash;Pearson, 82
</p>
<p>of Spearman, 84
</p>
<p>product moment, 82
</p>
<p>Covariance, 146, 147
</p>
<p>Covariate, 251
</p>
<p>Cramer&rsquo;s V, 77
</p>
<p>Cross tabulation, see contingency table
</p>
<p>Cumulative
</p>
<p>distribution function, 129
</p>
<p>frequency, see frequency, cumulative
</p>
<p>marginal distribution, 143
</p>
<p>D
</p>
<p>Data
</p>
<p>matrix, 3, 9
</p>
<p>observation, 3
</p>
<p>set, 3, 9
</p>
<p>transformation, 11
</p>
<p>unit, 3
</p>
<p>Decomposition
</p>
<p>complete, 113
</p>
<p>Degenerate distribution, 156
</p>
<p>Density, 129
</p>
<p>Design matrix, 263, 270
</p>
<p>Dispersion, 48
</p>
<p>absolute deviation, 51
</p>
<p>absolute mean deviation, 51
</p>
<p>absolute median deviation, 51
</p>
<p>mean squared error, 51
</p>
<p>measure, 49
</p>
<p>range, 49
</p>
<p>standard deviation, 51
</p>
<p>Distribution, 19
</p>
<p>Bernoulli, 156
</p>
<p>Binomial, 157
</p>
<p>χ2, 171, 427
</p>
<p>conditional, 141, 143
</p>
<p>conditional frequency, 70
</p>
<p>conditional relative frequency, 70
</p>
<p>continuous, 165
</p>
<p>cumulative marginal, 143
</p>
<p>degenerate, 156
</p>
<p>exponential, 170
</p>
<p>F, 427
</p>
<p>Gauss, 166
</p>
<p>geometric, 163
</p>
<p>hypergeometric, 163
</p>
<p>independent and identical, 145, 426
</p>
<p>joint relative frequency, 70
</p>
<p>marginal, 140, 142
</p>
<p>marginal frequency, 70
</p>
<p>marginal relative frequency, 70
</p>
<p>multinomial, 161
</p>
<p>normal, 166
</p>
<p>Poisson, 160
</p>
<p>standard, 154
</p>
<p>Student, 172
</p>
<p>t, 172, 427
</p>
<p>uniform discrete, 154
</p>
<p>Duality, 216
</p>
<p>Dummy variable, 266
</p>
<p>E
</p>
<p>Efficiency, 185
</p>
<p>Elementary event, 110
</p>
<p>Empirical cumulative distribution function
</p>
<p>(ECDF), 19
</p>
<p>Epitools, see R packages
</p>
<p>Error
</p>
<p>type I, 213
</p>
<p>type II, 213
</p>
<p>Estimation
</p>
<p>interval, 195
</p>
<p>least squares, 252, 253, 264
</p>
<p>maximum likelihood, 192
</p>
<p>method of moments, 195
</p>
<p>nonparametric, 182
</p>
<p>parametric, 182
</p>
<p>Event, 110
</p>
<p>additive theorem, 116
</p>
<p>certain, 110
</p>
<p>composite, 110
</p>
<p>disjoint, 112
</p>
<p>elementary, 110
</p>
<p>impossible, 110
</p>
<p>simple, 110
</p>
<p>sure, 110
</p>
<p>theorem of additivity, 115, 116
</p>
<p>Expectation, 134
</p>
<p>calculation rules, 144
</p>
<p>Expected frequencies, 74</p>
<p/>
</div>
<div class="page"><p/>
<p>Index 453
</p>
<p>Experiment
</p>
<p>Laplace, 114
</p>
<p>random, 109
</p>
<p>Exponential distribution, 170
</p>
<p>F
</p>
<p>Factorial function, see function, factorial
</p>
<p>F-distribution, 173, 427
</p>
<p>Fisher
</p>
<p>exact test, 230
</p>
<p>Foreign, see R packages
</p>
<p>Frequency
</p>
<p>absolute, 18, 69, 113
</p>
<p>cumulative, 19
</p>
<p>expected, 74
</p>
<p>relative, 18, 21, 113
</p>
<p>table, 19, 69
</p>
<p>F-Test, 272, 431
</p>
<p>Function
</p>
<p>cumulative distribution, see CDF
</p>
<p>empirical cumulative distribution, see
</p>
<p>ECDF
</p>
<p>factorial, 100
</p>
<p>joint cumulative distribution, 141
</p>
<p>joint probability distribution, 140, 141
</p>
<p>probability mass, see PMF
</p>
<p>step, 133
</p>
<p>G
</p>
<p>Gamma
</p>
<p>of Goodman and Kruskal, 87
</p>
<p>Gauss test
</p>
<p>one-sample, 216
</p>
<p>two-sample, 221
</p>
<p>Generalized method of moments, 195
</p>
<p>Geometric distribution, 163
</p>
<p>Ggplot2, see R packages
</p>
<p>Gini coefficient, 60
</p>
<p>standardized, 61
</p>
<p>Goodman and Kruskal&rsquo;s γ, 87
</p>
<p>Goodness of fit
</p>
<p>adjusted measure, 281
</p>
<p>measure, 258
</p>
<p>test, 235
</p>
<p>Graph
</p>
<p>bar chart, 24
</p>
<p>box plot, 56
</p>
<p>histogram, 27
</p>
<p>kernel density plot, 29
</p>
<p>Lorenz curve, 58
</p>
<p>pie chart, 26
</p>
<p>QQ-plot, 44
</p>
<p>random plot, 286
</p>
<p>scatter plot, 80
</p>
<p>Growth
</p>
<p>factor, 46
</p>
<p>rate, 46
</p>
<p>H
</p>
<p>Heteroscedasticity, 286
</p>
<p>Histogram, 27
</p>
<p>Homoscedasticity, 286
</p>
<p>Hypergeometric distribution, 163
</p>
<p>Hypothesis, 210
</p>
<p>alternative, 211
</p>
<p>linear, 280
</p>
<p>null, 211
</p>
<p>one-sided, 211
</p>
<p>two-sided, 211
</p>
<p>I
</p>
<p>i.i.d., 145, 153, 426
</p>
<p>Impossible event, 110
</p>
<p>Independence, 73, 121
</p>
<p>pairwise, 122
</p>
<p>random variables, 143
</p>
<p>stochastic, 121, 144
</p>
<p>Ineq, see R packages
</p>
<p>Inequality
</p>
<p>Tschebyschev, 139
</p>
<p>Inference, 181, 182
</p>
<p>least squares, 252, 264
</p>
<p>maximum likelihood, 192
</p>
<p>method of moments, 195
</p>
<p>Interaction, 276
</p>
<p>Intercept, 251
</p>
<p>Interquartile range, 49
</p>
<p>Interval estimation, 195
</p>
<p>J
</p>
<p>Joint
</p>
<p>cumulative distribution function, 141
</p>
<p>frequency distribution, 70
</p>
<p>probability distribution function, 140,
</p>
<p>141
</p>
<p>relative frequency distribution, 70
</p>
<p>K
</p>
<p>Kernel density plot, 29
</p>
<p>Kolmogorov&ndash;Smirnov test, 237</p>
<p/>
</div>
<div class="page"><p/>
<p>454 Index
</p>
<p>L
</p>
<p>Laplace
</p>
<p>experiment, 114
</p>
<p>probability, 114
</p>
<p>Lattice, see R packages
</p>
<p>Least squares, 252
</p>
<p>Life time, 170
</p>
<p>Likelihood, 192
</p>
<p>Line of equality, 59
</p>
<p>Linear
</p>
<p>hypotheses, 280
</p>
<p>Linear model, 251
</p>
<p>residuals, 270
</p>
<p>Linear regression, 249
</p>
<p>interaction, 276
</p>
<p>Location parameter, 38
</p>
<p>Log-linear model, 269
</p>
<p>Lorenz curve, 58
</p>
<p>M
</p>
<p>Mann-Whitney U-test, 232
</p>
<p>Marginal
</p>
<p>distribution, 140, 142
</p>
<p>frequency distribution, 70
</p>
<p>relative frequency distribution, 70
</p>
<p>MASS, see R packages
</p>
<p>Matrix
</p>
<p>covariance, 147
</p>
<p>design, 263
</p>
<p>Maximum likelihood estimation (MLE),
</p>
<p>192
</p>
<p>Mean
</p>
<p>arithmetic, 38
</p>
<p>properties, 40
</p>
<p>weighted arithmetic, 38
</p>
<p>Mean squared error (MSE), 51, 184
</p>
<p>Measure
</p>
<p>dispersion, 49
</p>
<p>symmetric, 76
</p>
<p>Measure of association
</p>
<p>χ2 coefficient, 76
</p>
<p>contingency coefficient C , 77
</p>
<p>correlation coefficient, 82
</p>
<p>Cramer&rsquo;s V , 77
</p>
<p>odds ratio, 78
</p>
<p>rank correlation coefficient, 84
</p>
<p>relative risk, 78
</p>
<p>Memorylessness, 170
</p>
<p>Method of moments, 195
</p>
<p>Model
</p>
<p>fitted regression model, 253
</p>
<p>fitted value, 253
</p>
<p>linear, 251
</p>
<p>log-linear, 269
</p>
<p>nonlinear, 251
</p>
<p>Multinomial distribution, 161
</p>
<p>Multiple linear regression, 262
</p>
<p>Multiplication theorem of probability, 119
</p>
<p>Multivariate, 249
</p>
<p>Mvtnorm, see R packages
</p>
<p>N
</p>
<p>Namibia, 206
</p>
<p>Newton&ndash;Raphson, 193
</p>
<p>Nominal variable, 6
</p>
<p>Normal distribution, 166
</p>
<p>O
</p>
<p>Observation, 3
</p>
<p>Odds ratio, 78
</p>
<p>One-sample problem, 209, 210
</p>
<p>Ordered
</p>
<p>set, 99
</p>
<p>values, 20
</p>
<p>Ordinal variable, 6
</p>
<p>Outcome, 251
</p>
<p>P
</p>
<p>Parameter
</p>
<p>location, 38
</p>
<p>regression, 251
</p>
<p>space, 184
</p>
<p>PDF, 129
</p>
<p>joint, 140, 141
</p>
<p>Percentile, 43
</p>
<p>Permutation, 101
</p>
<p>with replacement, 101
</p>
<p>without replacement, 101
</p>
<p>Pie chart, 26
</p>
<p>Plot
</p>
<p>kernel density, 29
</p>
<p>QQ, 44
</p>
<p>random, 286
</p>
<p>scatter, 79
</p>
<p>trumpet, 286, 288
</p>
<p>Poisson distribution, 160
</p>
<p>Polynomial regression, 267
</p>
<p>Population, 4
</p>
<p>Power, 213
</p>
<p>Probability
</p>
<p>calculation rules, 117
</p>
<p>conditional, 117, 119</p>
<p/>
</div>
<div class="page"><p/>
<p>Index 455
</p>
<p>density function, 129
</p>
<p>Laplace, 114
</p>
<p>mass function, 132
</p>
<p>posterior, 120
</p>
<p>prior, 120
</p>
<p>Probability theory
</p>
<p>axioms, 115
</p>
<p>p-value, 215
</p>
<p>Q
</p>
<p>QQ-plot, 44
</p>
<p>Quantile, 42, 137
</p>
<p>Quartile, 43, 137
</p>
<p>Quintile, 43
</p>
<p>R
</p>
<p>R2
</p>
<p>adjusted, 281
</p>
<p>Random variables, 127
</p>
<p>bivariate, 140
</p>
<p>continuous, 129
</p>
<p>discrete, 131
</p>
<p>i.i.d, 153
</p>
<p>independence, 144
</p>
<p>standardization, 138
</p>
<p>Range, 49
</p>
<p>Real stories, 63, 124, 176, 244, 245
</p>
<p>Realization, 128
</p>
<p>Reference category, 266
</p>
<p>Regression
</p>
<p>line, 251
</p>
<p>linear, 249
</p>
<p>multiple linear, 262
</p>
<p>polynomial, 267
</p>
<p>Regressor, 251
</p>
<p>Relationship, 249
</p>
<p>Relative risk, 78
</p>
<p>Residuals, 253, 270
</p>
<p>standardized, 285
</p>
<p>Response, 251
</p>
<p>R packages
</p>
<p>compositions, 219
</p>
<p>epitools, 202
</p>
<p>foreign, 12
</p>
<p>ggplot2, 35, 73, 199
</p>
<p>ineq, 59, 62
</p>
<p>lattice, 73
</p>
<p>MASS, 28, 283
</p>
<p>mvtnorm, 316
</p>
<p>ryouready, 87, 88
</p>
<p>TeachingDemos, 445
</p>
<p>vcd, 77
</p>
<p>S
</p>
<p>Sample
</p>
<p>estimate, 182
</p>
<p>pooled variance, 222
</p>
<p>space, 110
</p>
<p>variance, 51
</p>
<p>Sampling
</p>
<p>without replacement, 163
</p>
<p>Scale
</p>
<p>absolute, 7
</p>
<p>continuous, 6
</p>
<p>interval, 7
</p>
<p>nominal, 6
</p>
<p>ordinal, 6
</p>
<p>ratio, 7
</p>
<p>Scatter plot, 80
</p>
<p>Set
</p>
<p>ordered, 100
</p>
<p>unordered, 100
</p>
<p>Significance level, 213
</p>
<p>Simple event, 110
</p>
<p>Slope, 251
</p>
<p>Standard deviation, 51, 136
</p>
<p>Standard error, 189, 205
</p>
<p>Standardization, 54, 138
</p>
<p>Standard normal distribution, 166
</p>
<p>Statistic, 146, 183
</p>
<p>Step function, 20, 133
</p>
<p>Stochastic convergence, 425
</p>
<p>Stuart&rsquo;s τc, 87
</p>
<p>Sufficiency, 190
</p>
<p>Sure event, 110
</p>
<p>T
</p>
<p>Table
</p>
<p>contingency, 68, 69, 140
</p>
<p>frequency, 19, 69
</p>
<p>τc
of Stuart, 87
</p>
<p>T-distribution, 172, 427
</p>
<p>Test
</p>
<p>ANOVA, 274
</p>
<p>Binomial, 227
</p>
<p>χ2 for variance, 232, 430
</p>
<p>χ2 goodness of fit, 235
</p>
<p>χ2 independence, 238
</p>
<p>χ2 of homogeneity, 240
</p>
<p>duality, 216
</p>
<p>equivalence, 213</p>
<p/>
</div>
<div class="page"><p/>
<p>456 Index
</p>
<p>F, 272, 431
</p>
<p>Fisher, 230, 428
</p>
<p>Friedman, 446
</p>
<p>Kolmogorov&ndash;Smirnov, 237
</p>
<p>Kruskal&ndash;Wallis, 446
</p>
<p>Mann&ndash;Whitney U, 232
</p>
<p>McNemar, 447
</p>
<p>Mood, 446
</p>
<p>one-sample Gauss test, 216
</p>
<p>one-sample t-test, 219
</p>
<p>one-sided, 211
</p>
<p>overall F, 272
</p>
<p>paired t-test, 225
</p>
<p>sign, 446
</p>
<p>significance, 213
</p>
<p>two-sample binomial, 230
</p>
<p>two-sample Gauss test, 221
</p>
<p>two-sample t-test, 222
</p>
<p>two-sided, 211
</p>
<p>U, 232
</p>
<p>Welch, 222
</p>
<p>Wilcoxon rank sum, 232
</p>
<p>Wilcoxon&ndash;Mann&ndash;Whitney, 232
</p>
<p>Test distributions, 317
</p>
<p>Theorem
</p>
<p>additivity, 116, 147
</p>
<p>additivity of χ2 variables, 172
</p>
<p>additivity of disjoint events, 115
</p>
<p>Bayes, 120
</p>
<p>central limit, 426
</p>
<p>i.i.d., 185
</p>
<p>large numbers, 425, 426
</p>
<p>law of total probability, 119
</p>
<p>multiplication for probabilities, 119
</p>
<p>Neyman&ndash;Fisher Factorization, 191
</p>
<p>PDF, 129
</p>
<p>standardization, 138
</p>
<p>Student, 172
</p>
<p>Tschebyschev, 139
</p>
<p>variance decomposition, 136
</p>
<p>Tie, 85, 86
</p>
<p>Transformation, 11
</p>
<p>T-test
</p>
<p>one-sample, 219
</p>
<p>paired, 225
</p>
<p>two-sample, 222
</p>
<p>Two-sample problem, 210
</p>
<p>U
</p>
<p>Uniform distribution
</p>
<p>continuous, 165
</p>
<p>discrete, 154
</p>
<p>Unit, 3
</p>
<p>Unordered set, 100
</p>
<p>U test, 232
</p>
<p>V
</p>
<p>Variable, 4
</p>
<p>binary, 7
</p>
<p>bivariate random, 140
</p>
<p>categorical, 7
</p>
<p>continuous, 6
</p>
<p>dependent, 251
</p>
<p>discrete, 6
</p>
<p>dummy, 266
</p>
<p>grouped, 7
</p>
<p>independent, 251
</p>
<p>nominal, 6
</p>
<p>ordinal, 6
</p>
<p>random, 127
</p>
<p>response, 251
</p>
<p>standardized, 54
</p>
<p>Variance, 51, 135
</p>
<p>additivity theorem, 147
</p>
<p>between classes, 53
</p>
<p>calculation rules, 144
</p>
<p>decomposition, 257
</p>
<p>dispersion, 48
</p>
<p>pooled, 222
</p>
<p>within classes, 53
</p>
<p>Vcd, see R packages
</p>
<p>W
</p>
<p>Welch test, 222
</p>
<p>Whiskers, 56
</p>
<p>Wilcoxon&ndash;Mann&ndash;Whitney test, 232</p>
<p/>
</div>
<ul>	<li>Preface</li>
	<li>Contents</li>
	<li>About the Authors</li>
	<li>Part I   Descriptive Statistics</li>
	<li>1 Introduction and Framework</li>
<ul>	<li>1.1 Population, Sample, and Observations</li>
	<li>1.2 Variables</li>
<ul>	<li>1.2.1 Qualitative and Quantitative Variables</li>
	<li>1.2.2 Discrete and Continuous Variables</li>
	<li>1.2.3 Scales</li>
	<li>1.2.4 Grouped Data</li>
</ul>
	<li>1.3 Data Collection</li>
	<li>1.4 Creating a Data Set</li>
<ul>	<li>1.4.1 Statistical Software</li>
</ul>
	<li>1.5 Key Points and Further Issues</li>
	<li>1.6 Exercises</li>
</ul>
	<li>2 Frequency Measures and Graphical Representation of Data</li>
<ul>	<li>2.1 Absolute and Relative Frequencies</li>
	<li>2.2 Empirical Cumulative Distribution Function</li>
<ul>	<li>2.2.1 ECDF for Ordinal Variables</li>
	<li>2.2.2 ECDF for Continuous Variables</li>
</ul>
	<li>2.3 Graphical Representation of a Variable</li>
<ul>	<li>2.3.1 Bar Chart</li>
	<li>2.3.2 Pie Chart</li>
	<li>2.3.3 Histogram</li>
</ul>
	<li>2.4 Kernel Density Plots</li>
	<li>2.5 Key Points and Further Issues</li>
	<li>2.6 Exercises</li>
</ul>
	<li>3 Measures of Central Tendency and Dispersion</li>
<ul>	<li>3.1 Measures of Central Tendency</li>
<ul>	<li>3.1.1 Arithmetic Mean</li>
	<li>3.1.2 Median and Quantiles</li>
	<li>3.1.3 Quantile--Quantile Plots (QQ-Plots)</li>
	<li>3.1.4 Mode</li>
	<li>3.1.5 Geometric Mean</li>
	<li>3.1.6 Harmonic Mean</li>
</ul>
	<li>3.2 Measures of Dispersion</li>
<ul>	<li>3.2.1 Range and Interquartile Range</li>
	<li>3.2.2 Absolute Deviation, Variance, and Standard Deviation</li>
	<li>3.2.3 Coefficient of Variation</li>
</ul>
	<li>3.3 Box Plots</li>
	<li>3.4 Measures of Concentration</li>
<ul>	<li>3.4.1 Lorenz Curve</li>
	<li>3.4.2 Gini Coefficient</li>
</ul>
	<li>3.5 Key Points and Further Issues</li>
	<li>3.6 Exercises</li>
</ul>
	<li>4 Association of Two Variables</li>
<ul>	<li>4.1 Summarizing the Distribution of Two Discrete Variables</li>
<ul>	<li>4.1.1 Contingency Tables for Discrete Data</li>
	<li>4.1.2 Joint, Marginal, and Conditional Frequency Distributions</li>
	<li>4.1.3 Graphical Representation of Two Nominal  or Ordinal Variables</li>
</ul>
	<li>4.2 Measures of Association for Two Discrete Variables</li>
<ul>	<li>4.2.1 Pearson's χ2 Statistic</li>
	<li>4.2.2 Cramer's V Statistic</li>
	<li>4.2.3 Contingency Coefficient C</li>
	<li>4.2.4 Relative Risks and Odds Ratios</li>
</ul>
	<li>4.3 Association Between Ordinal and Continuous Variables</li>
<ul>	<li>4.3.1 Graphical Representation of Two Continuous Variables</li>
	<li>4.3.2 Correlation Coefficient</li>
	<li>4.3.3 Spearman's Rank Correlation Coefficient</li>
	<li>4.3.4 Measures Using Discordant and Concordant Pairs</li>
</ul>
	<li>4.4 Visualization of Variables from Different Scales</li>
	<li>4.5 Key Points and Further Issues</li>
	<li>4.6 Exercises</li>
</ul>
	<li>Part II   Probability Calculus</li>
	<li>5 Combinatorics</li>
<ul>	<li>5.1 Introduction</li>
	<li>5.2 Permutations</li>
<ul>	<li>5.2.1 Permutations without Replacement</li>
	<li>5.2.2 Permutations with Replacement</li>
</ul>
	<li>5.3 Combinations</li>
<ul>	<li>5.3.1 Combinations without Replacement and without Consideration of the Order</li>
	<li>5.3.2 Combinations without Replacement and with Consideration of the Order</li>
	<li>5.3.3 Combinations with Replacement and without Consideration of the Order</li>
	<li>5.3.4 Combinations with Replacement and with Consideration of the Order</li>
</ul>
	<li>5.4 Key Points and Further Issues</li>
	<li>5.5 Exercises</li>
</ul>
	<li>6 Elements of Probability Theory</li>
<ul>	<li>6.1 Basic Concepts and Set Theory</li>
	<li>6.2 Relative Frequency and Laplace Probability</li>
	<li>6.3 The Axiomatic Definition of Probability</li>
<ul>	<li>6.3.1 Corollaries Following from Kolomogorov's Axioms</li>
	<li>6.3.2 Calculation Rules for Probabilities</li>
</ul>
	<li>6.4 Conditional Probability</li>
<ul>	<li>6.4.1 Bayes' Theorem</li>
</ul>
	<li>6.5 Independence</li>
	<li>6.6 Key Points and Further Issues</li>
	<li>6.7 Exercises</li>
</ul>
	<li>7 Random Variables</li>
<ul>	<li>7.1 Random Variables</li>
	<li>7.2 Cumulative Distribution Function (CDF)</li>
<ul>	<li>7.2.1 CDF of Continuous Random Variables</li>
	<li>7.2.2 CDF of Discrete Random Variables</li>
</ul>
	<li>7.3 Expectation and Variance of a Random Variable</li>
<ul>	<li>7.3.1 Expectation</li>
	<li>7.3.2 Variance</li>
	<li>7.3.3 Quantiles of a Distribution</li>
	<li>7.3.4 Standardization</li>
</ul>
	<li>7.4 Tschebyschev's Inequality</li>
	<li>7.5 Bivariate Random Variables</li>
	<li>7.6 Calculation Rules for Expectation and Variance</li>
<ul>	<li>7.6.1 Expectation and Variance of the Arithmetic Mean</li>
</ul>
	<li>7.7 Covariance and Correlation</li>
<ul>	<li>7.7.1 Covariance</li>
	<li>7.7.2 Correlation Coefficient</li>
</ul>
	<li>7.8 Key Points and Further Issues</li>
	<li>7.9 Exercises</li>
</ul>
	<li>8 Probability Distributions</li>
<ul>	<li>8.1 Standard Discrete Distributions</li>
<ul>	<li>8.1.1 Discrete Uniform Distribution</li>
	<li>8.1.2 Degenerate Distribution</li>
	<li>8.1.3 Bernoulli Distribution</li>
	<li>8.1.4 Binomial Distribution</li>
	<li>8.1.5 Poisson Distribution</li>
	<li>8.1.6 Multinomial Distribution</li>
	<li>8.1.7 Geometric Distribution</li>
	<li>8.1.8 Hypergeometric Distribution</li>
</ul>
	<li>8.2 Standard Continuous Distributions</li>
<ul>	<li>8.2.1 Continuous Uniform Distribution</li>
	<li>8.2.2 Normal Distribution</li>
	<li>8.2.3 Exponential Distribution</li>
</ul>
	<li>8.3 Sampling Distributions</li>
<ul>	<li>8.3.1 χ2-Distribution</li>
	<li>8.3.2 t-Distribution</li>
	<li>8.3.3 F-Distribution</li>
</ul>
	<li>8.4 Key Points and Further Issues</li>
	<li>8.5 Exercises</li>
</ul>
	<li>Part III   Inductive Statistics</li>
	<li>9 Inference</li>
<ul>	<li>9.1 Introduction</li>
	<li>9.2 Properties of Point Estimators</li>
<ul>	<li>9.2.1 Unbiasedness and Efficiency</li>
	<li>9.2.2 Consistency of Estimators</li>
	<li>9.2.3 Sufficiency of Estimators</li>
</ul>
	<li>9.3 Point Estimation</li>
<ul>	<li>9.3.1 Maximum Likelihood Estimation</li>
	<li>9.3.2 Method of Moments</li>
</ul>
	<li>9.4 Interval Estimation</li>
<ul>	<li>9.4.1 Introduction</li>
	<li>9.4.2 Confidence Interval for the Mean of a Normal Distribution</li>
	<li>9.4.3 Confidence Interval for a Binomial Probability</li>
	<li>9.4.4 Confidence Interval for the Odds Ratio</li>
</ul>
	<li>9.5 Sample Size Determinations</li>
	<li>9.6 Key Points and Further Issues</li>
	<li>9.7 Exercises</li>
</ul>
	<li>10 Hypothesis Testing</li>
<ul>	<li>10.1 Introduction</li>
	<li>10.2 Basic Definitions</li>
<ul>	<li>10.2.1 One- and Two-Sample Problems</li>
	<li>10.2.2 Hypotheses</li>
	<li>10.2.3 One- and Two-Sided Tests</li>
	<li>10.2.4 Type I and Type II Error</li>
	<li>10.2.5 How to Conduct a Statistical Test</li>
	<li>10.2.6 Test Decisions Using the p-Value</li>
	<li>10.2.7 Test Decisions Using Confidence Intervals</li>
</ul>
	<li>10.3 Parametric Tests for Location Parameters</li>
<ul>	<li>10.3.1 Test for the Mean When the Variance is Known (One-Sample Gauss Test)</li>
	<li>10.3.2 Test for the Mean When the Variance is Unknown (One-Sample t-Test)</li>
	<li>10.3.3 Comparing the Means of Two Independent Samples</li>
	<li>10.3.4 Test for Comparing the Means of Two Dependent Samples (Paired t-Test)</li>
</ul>
	<li>10.4 Parametric Tests for Probabilities</li>
<ul>	<li>10.4.1 One-Sample Binomial Test for the Probability p</li>
	<li>10.4.2 Two-Sample Binomial Test</li>
</ul>
	<li>10.5 Tests for Scale Parameters</li>
	<li>10.6 Wilcoxon--Mann--Whitney (WMW) U-Test</li>
	<li>10.7 χ2-Goodness-of-Fit Test</li>
	<li>10.8 χ2-Independence Test and Other χ2-Tests</li>
	<li>10.9 Key Points and Further Issues</li>
	<li>10.10 Exercises</li>
</ul>
	<li>11 Linear Regression</li>
<ul>	<li>11.1 The Linear Model</li>
	<li>11.2 Method of Least Squares</li>
<ul>	<li>11.2.1 Properties of the Linear Regression Line</li>
</ul>
	<li>11.3 Goodness of Fit</li>
	<li>11.4 Linear Regression with a Binary Covariate</li>
	<li>11.5 Linear Regression with a Transformed Covariate</li>
	<li>11.6 Linear Regression with Multiple Covariates</li>
<ul>	<li>11.6.1 Matrix Notation</li>
	<li>11.6.2 Categorical Covariates</li>
	<li>11.6.3 Transformations</li>
</ul>
	<li>11.7 The Inductive View of Linear Regression</li>
<ul>	<li>11.7.1 Properties of Least Squares and Maximum Likelihood Estimators</li>
	<li>11.7.2 The ANOVA Table</li>
	<li>11.7.3 Interactions</li>
</ul>
	<li>11.8 Comparing Different Models</li>
	<li>11.9 Checking Model Assumptions</li>
	<li>11.10 Association Versus Causation</li>
	<li>11.11 Key Points and Further Issues</li>
	<li>11.12 Exercises</li>
</ul>
	<li>A Appendix:Introduction to R</li>
<ul>	<li>Background</li>
	<li>Installation and Basic Functionalities</li>
	<li>Statistical Functions</li>
	<li>Data Sets</li>
</ul>
	<li>B Appendix:Solutions to Exercises</li>
	<li>C Appendix: Technical Appendix</li>
<ul>	<li>More details on Chap. 3</li>
<ul>	<li>More details on Chap. 7</li>
	<li>More details on Chap. 8</li>
	<li>More details on Chap. 9</li>
	<li>More details on Chap. 10</li>
	<li>More details on Chap. 11</li>
	<li>Distribution Tables</li>
</ul>
</ul>
	<li>D Appendix: Visual Summaries</li>
<ul>	<li>Descriptive Data Analysis</li>
	<li>Summary of Tests for Continuous and Ordinal Variables</li>
	<li>Summary of Tests for Nominal Variables</li>
</ul>
	<li>References</li>
	<li>Index</li>
</ul>
</body></html>