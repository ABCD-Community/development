<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>978-0-387-95585-8_Book_PrintPDF.pdf</title>
</head>
<body><div class="page"><p/>
<p>Undergraduate Texts in Mathematics 
</p>
<p>Editors 
</p>
<p>s. Axler 
F.W. Gehring 
</p>
<p>K.A. Ribet </p>
<p/>
</div>
<div class="page"><p/>
<p>Undergraduate Texts in Mathematics 
</p>
<p>Abbott: Understanding Analysis. 
</p>
<p>Anglin: Mathematics: A Concise History 
</p>
<p>and Philosophy. 
</p>
<p>Readings in Mathematics. 
</p>
<p>Anglin/Lambek: The Heritage of 
</p>
<p>Thales. 
</p>
<p>Readings in Mathematics. 
</p>
<p>Apostol: Introduction to Analytic 
</p>
<p>Number Theory. Second edition. 
</p>
<p>Armstrong: Basic Topology. 
</p>
<p>Armstrong: Groups and Symmetry. 
</p>
<p>Axler: Linear Algebra Done Right. 
</p>
<p>Second edition. 
</p>
<p>Beardon: Limits: A New Approach to 
</p>
<p>Real Analysis. 
</p>
<p>BaklNewman: Complex Analysis. 
</p>
<p>Second edition. 
</p>
<p>BanchofflWermer: Linear Algebra 
</p>
<p>Through Geometry. Second edition. 
</p>
<p>Berberian: A First Course in Real 
</p>
<p>Analysis. 
</p>
<p>Bix: Conics and Cubics: A 
</p>
<p>Concrete Introduction to Algebraic 
</p>
<p>Curves. 
</p>
<p>Bremaud: An Introduction to 
</p>
<p>Probabilistic Modeling. 
</p>
<p>Bressoud: Factorization and Primality 
</p>
<p>Testing. 
</p>
<p>Bressoud: Second Year Calculus. 
</p>
<p>Readings in Mathematics. 
</p>
<p>Brickman: Mathematical Introduction 
</p>
<p>to Linear Programming and Game 
</p>
<p>Theory. 
</p>
<p>Browder: Mathematical Analysis: 
</p>
<p>An Introduction. 
</p>
<p>Buchmann: Introduction to 
</p>
<p>Cryptography. 
</p>
<p>Buskes/van Rooij: Topological Spaces: 
</p>
<p>From Distance to Neighborhood. 
</p>
<p>Callahan: The Geometry of Spacetime: 
</p>
<p>An Introduction to Special and General 
Relavitity. 
</p>
<p>Carter/van Brunt: The Lebesgue-
</p>
<p>Stieltjes Integral: A Practical 
</p>
<p>Introduction. 
</p>
<p>Cederberg: A Course in Modern 
</p>
<p>Geometries. Second edition. 
</p>
<p>Childs: A Concrete Introduction to 
</p>
<p>Higher Algebra. Second edition. 
</p>
<p>Chung: Elementary Probability Theory 
</p>
<p>with Stochastic Processes. Third 
</p>
<p>edition. 
</p>
<p>Cox/Little/O'Shea: Ideals, Varieties, 
</p>
<p>and Algorithms. Second edition. 
</p>
<p>Croom: Basic Concepts of Algebraic 
</p>
<p>Topology. 
</p>
<p>Curtis: Linear Algebra: An Introductory 
</p>
<p>Approach. Fourth edition. 
</p>
<p>Devlin: The Joy of Sets: Fundamentals 
</p>
<p>of Contemporary Set Theory. 
</p>
<p>Second edition. 
</p>
<p>Dixmier: General Topology. 
</p>
<p>Driver: Why Math? 
</p>
<p>EbbinghauslFlumlThomas: 
</p>
<p>Mathematical Logic. Second edition. 
</p>
<p>Edgar: Measure, Topology, and Fractal 
</p>
<p>Geometry. 
</p>
<p>Elaydi: An Introduction to Difference 
</p>
<p>Equations. Second edition. 
</p>
<p>Erdos/Suninyi: Topics in the Theory of 
</p>
<p>Numbers. 
</p>
<p>Estep: Practical Analysis in One Variable. 
</p>
<p>Exner: An Accompaniment to Higher 
</p>
<p>Mathematics. 
</p>
<p>Exner: Inside Calculus. 
</p>
<p>FinelRosenberger: The Fundamental 
</p>
<p>Theory of Algebra. 
</p>
<p>Fischer: Intermediate Real Analysis. 
</p>
<p>Flanigan/Kazdan: Calculus Two: Linear 
</p>
<p>and Nonlinear Functions. Second 
</p>
<p>edition. 
</p>
<p>Fleming: Functions of Several Variables. 
</p>
<p>Second edition. 
</p>
<p>Foulds: Combinatorial Optimization for 
</p>
<p>Undergraduates. 
</p>
<p>Foulds: Optimization Techniques: An 
</p>
<p>Introduction. 
</p>
<p>Franklin: Methods of Mathematical 
</p>
<p>Economics. 
</p>
<p>Frazier: An Introduction to Wavelets 
</p>
<p>Through Linear Algebra. 
</p>
<p>(continued after index) </p>
<p/>
</div>
<div class="page"><p/>
<p>L. Lovasz 
J. Pelikan 
K. vesztergombi 
</p>
<p>Discrete Mathenlatics 
</p>
<p>Elementary and Beyond 
</p>
<p>With 95 Illustrations 
</p>
<p>~ Springer </p>
<p/>
</div>
<div class="page"><p/>
<p>L. Lovasz J. Pelikan 
Microsoft Corporation 
Microsoft Research 
</p>
<p>Department of Algebra 
</p>
<p>One Microsoft Way 
Redmond, WA 98052-6399 
USA 
lovasz@microsoft.com 
</p>
<p>and Number Theory 
Eotvos Lorand University 
Pazmany Peter Setany lIC 
Budapest H-l117 
Hungary 
pelikan@cs.eltc.hu 
</p>
<p>K. Vesztergombi 
Department of Mathematics 
University of Washington 
Box 354-350 
Seattle, WA 98195-4350 
USA 
veszter@math.washington.edu 
</p>
<p>Editorial Board 
</p>
<p>S. Axler 
Mathematics Department 
San Francisco State 
</p>
<p>University 
San Francisco, CA 94132 
USA 
axler@sfsu.edu 
</p>
<p>F. W. Gehring 
Mathematics Department 
East Hall 
University of Michigan 
Ann Arbor, MI 48109 
USA 
fgehring@math.lsa.umich.edu 
</p>
<p>Mathematics Subject Classification (2000): 28-01, 30-01 
</p>
<p>Library of Congress Cataloging-in-Publication Data 
Lovasz, LaszI6,1948-
</p>
<p>K. A. Ribet 
Mathematics Department 
University of California, 
</p>
<p>Berkeley 
Berkeley, CA 94720-3840 
USA 
ribet@math.berkeley.edu 
</p>
<p>Discrete mathematics I Laszl6 Lovasz, 16zsef Pelikan, Katalin L. Vesztergombi. 
p. cm. - (Undergraduate texts in mathematics) 
</p>
<p>Includes bibliographical references and index. 
</p>
<p>ISBN 978-0-387-95585-8 ISBN 978-0-387-21777-2 (eBook) 
</p>
<p>DOl 10.1007/978-0-387-21777-2 
</p>
<p>1. Mathematics. 2. Computer science-Mathematics. I. Pelikan, 16zsef 
II. Vesztergombi, Katalin L. III. Title. III. Series. 
QA39.3.L682003 
51O-dc21 2002030585 
</p>
<p>Printed on acid-free paper. 
</p>
<p>&copy; 2003 Springer Science+Business Media, LLC 
All rights reserved. This work may not be translated or copied in whole or in part without the 
written permission of the publisher (Springer Science+Business Media, LLC, 233 Spring 
Street, New York, NY 10013, USA), except for brief excerpts in connection with reviews or 
scholarly analysis. Use in connection with any form of information storage and retrieval, 
electronic adaptation, computer software, or by similar or dissimilar methodology now known 
or hereafter developed is forbidden. 
The use in this publication of trade names, trademarks, service marks, and similar terms, even 
if they are not identified as such, is not to be taken as an expression of opinion as to whether 
or not they are subject to proprietary rights. 
</p>
<p>9 8 7 6 
</p>
<p>springer.com </p>
<p/>
</div>
<div class="page"><p/>
<p>Preface 
</p>
<p>For most students, the first and often only course in college mathematics 
</p>
<p>is calculus. It is true that calculus is the single most important field of 
</p>
<p>mathematics, whose emergence in the seventeenth century signaled the 
</p>
<p>birth of modern mathematics and was the key to the successful applications 
</p>
<p>of mathematics in the sciences and engineering. 
</p>
<p>But calculus (or analysis) is also very technical. It takes a lot of work 
</p>
<p>even to introduce its fundamental notions like continuity and the derivative 
</p>
<p>(after all, it took two centuries just to develop the proper definition of these 
</p>
<p>notions). To get a feeling for the power of its methods, say by describing 
</p>
<p>one of its important applications in detail, takes years of study. 
</p>
<p>If you want to become a mathematician, computer scientist, or engineer, 
</p>
<p>this investment is necessary. But if your goal is to develop a feeling for what 
</p>
<p>mathematics is all about, where mathematical methods can be helpful, and 
</p>
<p>what kinds of questions do mathematicians work on, you may want to look 
</p>
<p>for the answer in some other fields of mathematics. 
</p>
<p>There are many success stories of applied mathematics outside calculus. 
</p>
<p>A recent hot topic is mathematical cryptography, which is based on number 
</p>
<p>theory (the study of the positive integers 1,2,3, ... ), and is widely applied, 
</p>
<p>for example, in computer security and electronic banking. Other important 
</p>
<p>areas in applied mathematics are linear programming, coding theory, and 
</p>
<p>the theory of computing. The mathematical content in these applications 
</p>
<p>is collectively called discrete mathematics. (The word "discrete" is used in 
</p>
<p>the sense of "separated from each other," the opposite of "continuous;" it is 
</p>
<p>also often used in the more restrictive sense of "finite." The more everyday 
</p>
<p>version of this word, meaning "circumspect," is spelled "discreet.") </p>
<p/>
</div>
<div class="page"><p/>
<p>vi Preface 
</p>
<p>The aim of this book is not to cover "discrete mathematics" in depth 
</p>
<p>(it should be clear from the description above that such a task would be 
</p>
<p>ill-defined and impossible anyway). Rather, we discuss a number of selected 
</p>
<p>results and methods, mostly from the areas of combinatorics and graph the-
</p>
<p>ory, with a little elementary number theory, probability, and combinatorial 
</p>
<p>geometry. 
</p>
<p>It is important to realize that there is no mathematics without proofs. 
</p>
<p>Merely stating the facts, without saying something about why these facts 
</p>
<p>are valid, would be terribly far from the spirit of mathematics and would 
</p>
<p>make it impossible to give any idea about how it works. Thus, wherever 
</p>
<p>possible, we will give the proofs of the theorems we state. Sometimes this 
</p>
<p>is not possible; quite simple, elementary facts can be extremely difficult to 
</p>
<p>prove, and some such proofs may take advanced courses to go through. In 
</p>
<p>these cases, we will at least state that the proof is highly technical and goes 
</p>
<p>beyond the scope of this book. 
</p>
<p>Another important ingredient of mathematics is problem solving. You 
</p>
<p>won't be able to learn any mathematics without dirtying your hands and 
</p>
<p>trying out the ideas you learn about in the solution of problems. To some, 
</p>
<p>this may sound frightening, but in fact, most people pursue this type of 
</p>
<p>activity almost every day: Everybody who plays a game of chess or solves 
</p>
<p>a puzzle is solving discrete mathematical problems. The reader is strongly 
</p>
<p>advised to answer the questions posed in the text and to go through the 
</p>
<p>problems at the end of each chapter of this book. Treat it as puzzle solving, 
</p>
<p>and if you find that some idea that you came up with in the solution plays 
</p>
<p>some role later, be satisfied that you are beginning to get the essence of 
</p>
<p>how mathematics develops. 
</p>
<p>We hope that we can illustrate that mathematics is a building, where 
</p>
<p>results are built on earlier results, often going back to the great Greek 
</p>
<p>mathematicians; that mathematics is alive, with more new ideas and more 
</p>
<p>pressing unsolved problems than ever; and that mathematics is also an art, 
</p>
<p>where the beauty of ideas and methods is as important as their difficulty 
</p>
<p>or applicability. 
</p>
<p>Lasz16 Lovasz J6zsef Pelikan Katalin Vesztergombi </p>
<p/>
</div>
<div class="page"><p/>
<p>Contents 
</p>
<p>Preface v 
</p>
<p>1 Let's Count! 1 
</p>
<p>1.1 A Party 1 
1.2 Sets and the Like . 4 
1.3 The Number of Subsets 9 
1.4 The Approximate Number of Subsets. 14 
1.5 Sequences 15 
1.6 Permutations 17 
1.7 The Number of Ordered Subsets 19 
1.8 The Number of Subsets of a Given Size 20 
</p>
<p>2 Combinatorial Tools 25 
</p>
<p>2.1 Induction 25 
2.2 Comparing and Estimating Numbers 30 
2.3 Inclusion-Exclusion. 32 
2.4 Pigeonholes 34 
2.5 The Twin Paradox and the Good Old Logarithm 37 
</p>
<p>3 Binomial Coefficients and Pascal's Triangle 43 
</p>
<p>3.1 The Binomial Theorem 43 
3.2 Distributing Presents. 45 
3.3 Anagrams 46 
3.4 Distributing Money. 48 </p>
<p/>
</div>
<div class="page"><p/>
<p>viii Contents 
</p>
<p>3.5 Pascal's Triangle . . . . . . . . . . .. 
</p>
<p>3.6 Identities in Pascal's Triangle . . . .. 
</p>
<p>3.7 A Bird's-Eye View of Pascal's Triangle 
</p>
<p>3.8 An Eagle's-Eye View: Fine Details 
</p>
<p>4 Fibonacci Numbers 
</p>
<p>4.1 Fibonacci's Exercise ......... . 
</p>
<p>4.2 Lots ofIdentities . . . . . . . . . . . . 
</p>
<p>4.3 A Formula for the Fibonacci Numbers 
</p>
<p>5 Combinatorial Probability 
</p>
<p>5.1 Events and Probabilities . 
</p>
<p>49 
</p>
<p>50 
</p>
<p>54 
</p>
<p>57 
</p>
<p>65 
</p>
<p>65 
</p>
<p>68 
</p>
<p>71 
</p>
<p>77 
</p>
<p>77 
</p>
<p>5.2 Independent Repetition of an Experiment 79 
</p>
<p>5.3 The Law of Large Numbers . . . . . . . . 80 
</p>
<p>5.4 The Law of Small Numbers and the Law of Very Large Num-
</p>
<p>bers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .. 83 
</p>
<p>6 Integers, Divisors, and Primes 
</p>
<p>6.1 Divisibility of Integers .. 
</p>
<p>6.2 Primes and Their History 
</p>
<p>6.3 Factorization into Primes 
</p>
<p>6.4 On the Set of Primes . . . 
</p>
<p>6.5 Fermat's "Little" Theorem 
</p>
<p>6.6 The Euclidean Algorithm 
</p>
<p>6.7 Congruences......... 
</p>
<p>6.8 Strange Numbers ..... . 
</p>
<p>6.9 Number Theory and Combinatorics . 
</p>
<p>6.10 How to Test Whether a Number is a Prime? . 
</p>
<p>7 Graphs 
</p>
<p>7.1 Even and Odd Degrees ......... . 
</p>
<p>7.2 Paths, Cycles, and Connectivity .... . 
</p>
<p>7.3 Eulerian Walks and Hamiltonian Cycles 
</p>
<p>8 Trees 
</p>
<p>8.1 How to Define Trees 
</p>
<p>8.2 How to Grow Trees . 
</p>
<p>8.3 How to Count Trees? . 
</p>
<p>8.4 How to Store Trees . . 
</p>
<p>8.5 The Number of Unlabeled Trees 
</p>
<p>9 Finding the Optimum 
</p>
<p>9.1 Finding the Best Tree ..... . 
</p>
<p>9.2 The Traveling Salesman Problem 
</p>
<p>10 Matchings in Graphs 
</p>
<p>87 
</p>
<p>87 
</p>
<p>88 
</p>
<p>90 
93 
</p>
<p>97 
</p>
<p>99 
</p>
<p>105 
</p>
<p>107 
</p>
<p>114 
</p>
<p>117 
</p>
<p>125 
</p>
<p>125 
</p>
<p>130 
</p>
<p>135 
</p>
<p>141 
</p>
<p>141 
</p>
<p>143 
</p>
<p>146 
</p>
<p>148 
</p>
<p>153 
</p>
<p>157 
</p>
<p>157 
</p>
<p>161 
</p>
<p>165 </p>
<p/>
</div>
<div class="page"><p/>
<p>10.1 A Dancing Problem .... 
</p>
<p>10.2 Another matching problem 
</p>
<p>10.3 The Main Theorem ..... 
</p>
<p>10.4 How to Find a Perfect Matching 
</p>
<p>11 Combinatorics in Geometry 
</p>
<p>11.1 Intersections of Diagonals 
</p>
<p>11.2 Counting regions 
</p>
<p>11.3 Convex Polygons 
</p>
<p>12 Euler's Formula 
</p>
<p>12.1 A Planet Under Attack 
</p>
<p>12.2 Planar Graphs ..... 
</p>
<p>12.3 Euler's Formula for Polyhedra. 
</p>
<p>13 Coloring Maps and Graphs 
</p>
<p>13.1 Coloring Regions with Two Colors 
</p>
<p>13.2 Coloring Graphs with Two Colors 
</p>
<p>13.3 Coloring graphs with many colors. 
</p>
<p>13.4 Map Coloring and the Four Color Theorem 
</p>
<p>14 Finite Geometries, Codes, 
</p>
<p>Latin Squares, 
</p>
<p>and Other Pretty Creatures 
</p>
<p>14.1 Small Exotic Worlds .... 
</p>
<p>14.2 Finite Affine and Projective Planes 
</p>
<p>14.3 Block Designs .. 
</p>
<p>14.4 Steiner Systems. 
</p>
<p>14.5 Latin Squares 
</p>
<p>14.6 Codes ..... . 
</p>
<p>15 A Glimpse of Complexity and Cryptography 
</p>
<p>15.1 A Connecticut Class in King Arthur's Court. 
</p>
<p>15.2 Classical Cryptography ........... . 
</p>
<p>15.3 How to Save the Last Move in Chess .... . 
</p>
<p>15.4 How to Verify a Password-Without Learning it 
</p>
<p>15.5 How to Find These Primes 
</p>
<p>15.6 Public Key Cryptography 
</p>
<p>16 Answers to Exercises 
</p>
<p>Index 
</p>
<p>Contents ix 
</p>
<p>165 
</p>
<p>167 
</p>
<p>169 
</p>
<p>171 
</p>
<p>179 
</p>
<p>179 
</p>
<p>181 
</p>
<p>184 
</p>
<p>189 
</p>
<p>189 
</p>
<p>192 
</p>
<p>194 
</p>
<p>197 
</p>
<p>197 
</p>
<p>199 
</p>
<p>202 
</p>
<p>204 
</p>
<p>211 
</p>
<p>211 
</p>
<p>217 
</p>
<p>220 
</p>
<p>224 
</p>
<p>229 
</p>
<p>232 
</p>
<p>239 
</p>
<p>239 
</p>
<p>242 
</p>
<p>244 
</p>
<p>246 
</p>
<p>246 
</p>
<p>247 
</p>
<p>251 
</p>
<p>287 </p>
<p/>
</div>
<div class="page"><p/>
<p>1 
</p>
<p>Let's Count! 
</p>
<p>1.1 A Party 
</p>
<p>Alice invites six guests to her birthday party: Bob, Carl, Diane, Eve, Frank, 
</p>
<p>and George. When they arrive, they shake hands with each other (strange 
</p>
<p>European custom). This group is strange anyway, because one of them asks, 
</p>
<p>"How many handshakes does this mean?" 
</p>
<p>"I shook 6 hands altogether," says Bob, "and 1 guess, so did everybody 
</p>
<p>else." 
</p>
<p>"Since there are seven of us, this should mean 7 . 6 = 42 handshakes," 
ventures Carl. 
</p>
<p>"This seems too many" says Diane. "The same logic gives 2 handshakes 
</p>
<p>if two persons meet, which is clearly wrong." 
</p>
<p>"This is exactly the point: Every handshake was counted twice. We have 
</p>
<p>to divide 42 by 2 to get the right number: 21," with which Eve settles the 
</p>
<p>issue. 
</p>
<p>When they go to the table, they have a difference of opinion about who 
</p>
<p>should sit where. To resolve this issue, Alice suggests, "Let's change the 
</p>
<p>seating every half hour, until we get every seating." 
</p>
<p>"But you stay at the head of the table," says George, "since it is your 
</p>
<p>birthday." 
</p>
<p>How long is this party going to last? How many different seatings are 
</p>
<p>there (with Alice's place fixed)? 
</p>
<p>Let us fill the seats one by one, starting with the chair on Alice's right. 
</p>
<p>Here we can put any of the 6 guests. Now look at the second chair. If Bob </p>
<p/>
</div>
<div class="page"><p/>
<p>2 1. Let's Count! 
</p>
<p>sits in the first chair, we can put any of the remaining 5 guests in the second 
</p>
<p>chair; if Carl sits in the first chair, we again have 5 choices for the second 
</p>
<p>chair, etc. Each of the six choices for the first chair gives us five choices 
</p>
<p>for the second chair, so the number of ways to fill the first two chairs is 
</p>
<p>5 + 5 + 5 + 5 + 5 + 5 = 6&middot;5 = 30. Similarly, no matter how we fill the first 
two chairs, we have 4 choices for the third chair, which gives 6&middot;5&middot;4 ways 
</p>
<p>to fill the first three chairs. Proceeding similarly, we find that the number 
</p>
<p>of ways to seat the guests is 6 . 5 . 4 . 3 . 2 . 1 = 720. 
If they change seats every half hour, it will take 360 hours, that is, 15 
</p>
<p>days, to go through all the seating arrangements. Quite a party, at least as 
</p>
<p>far as the duration goes! 
</p>
<p>1.1.1 How many ways can these people be seated at the table if Alice, too, can 
</p>
<p>sit anywhere? 
</p>
<p>After the cake, the crowd wants to dance (boys with girls, remember, 
</p>
<p>this is a conservative European party). How many possible pairs can be 
</p>
<p>formed? 
</p>
<p>OK, this is easy: there are 3 girls, and each can choose one of 4 boys, 
</p>
<p>this makes 3 . 4 = 12 possible pairs. 
</p>
<p>After ten days have passed, our friends really need some new ideas to 
</p>
<p>keep the party going. Frank has one: "Let's pool our resources and win the 
</p>
<p>lottery! All we have to do is to buy enough tickets so that no matter what 
</p>
<p>they draw, we will have a ticket with the winning numbers. How many 
</p>
<p>tickets do we need for this?" 
</p>
<p>(In the lottery they are talking about, 5 numbers are selected out of 90.) 
</p>
<p>"This is like the seating," says George. "Suppose we fill out the tickets so 
</p>
<p>that Alice marks a number, then she passes the ticket to Bob, who marks 
</p>
<p>a number and passes it to Carl, and so on. Alice has 90 choices, and no 
</p>
<p>matter what she chooses, Bob has 89 choices, so there are 90 . 89 choices 
</p>
<p>for the first two numbers, and going on similarly, we get 90 . 89 . 88 . 87 . 86 
</p>
<p>possible choices for the five numbers." 
</p>
<p>"Actually, I think this is more like the handshake question," says Alice. 
</p>
<p>"If we fill out the tickets the way you suggested, we get the same ticket 
</p>
<p>more then once. For example, there will be a ticket where I mark 7 and 
</p>
<p>Bob marks 23, and another one where I mark 23 and Bob marks 7." 
</p>
<p>Carl jumps up: "Well, let's imagine a ticket, say, with numbers 
</p>
<p>7,23,31,34, and 55. How many ways do we get it? Alice could have marked 
</p>
<p>any of them; no matter which one it was that she marked, Bob could have 
</p>
<p>marked any of the remaining four. Now this is really like the seating prob-
</p>
<p>lem. We get every ticket 5&middot;4&middot;3&middot;2&middot; 1 times." 
</p>
<p>"So," concludes Diane, "if we fill out the tickets the way George proposed, 
</p>
<p>then among the 90&middot;89&middot;88&middot;87&middot;86 tickets we get, every 5-tuple occurs not </p>
<p/>
</div>
<div class="page"><p/>
<p>1.1 A Party 3 
</p>
<p>only once, but 5 &middot;4&middot; 3 . 2 . 1 times. So the number of different tickets is only 
</p>
<p>90 . 89 . 88 . 87 . 86 
</p>
<p>5&middot;4&middot;3&middot;2&middot;1 
</p>
<p>We only need to buy this number of tickets." 
</p>
<p>Somebody with a good pocket calculator computed this value in a twin-
</p>
<p>kling; it was 43,949,268. So they had to decide (remember, this happens in 
</p>
<p>a poor European country) that they didn't have enough money to buy so 
</p>
<p>many tickets. (Besides, they would win much less. And to fill out so many 
</p>
<p>tickets would spoil the party!) 
</p>
<p>So they decide to play cards instead. Alice, Bob, Carl and Diane play 
</p>
<p>bridge. Looking at his cards, Carl says, "I think I had the same hand last 
</p>
<p>time." 
</p>
<p>"That is very unlikely" says Diane. 
</p>
<p>How unlikely is it? In other words, how many different hands can you 
</p>
<p>have in bridge? (The deck has 52 cards, each player gets 13.) We hope 
</p>
<p>you have noticed that this is essentially the same question as the lottery 
</p>
<p>problem. Imagine that Carl picks up his cards one by one. The first card 
</p>
<p>can be anyone of the 52 cards; whatever he picked up first, there are 51 
</p>
<p>possibilities for the second card, so there are 52 . 51 possibilities for the 
</p>
<p>first two cards. Arguing similarly, we see that there are 52 . 51 . 50&middot; . &middot;40 
</p>
<p>possibilities for the 13 cards. 
</p>
<p>But now every hand has been counted many times. In fact, if Eve comes 
</p>
<p>to kibitz and looks into Carl's cards after he has arranged them and tries 
</p>
<p>to guess (we don't know why) the order in which he picked them up, she 
</p>
<p>could think, "He could have picked up any of the 13 cards first; he could 
</p>
<p>have picked up any of the remaining 12 cards second; any of the remaining 
</p>
<p>11 cards third .... Aha, this is again like the seating: There are 13 &middot;12&middot; . &middot;2&middot;1 
</p>
<p>orders in which he could have picked up his cards." 
</p>
<p>But this means that the number of different hands in bridge is 
</p>
<p>52 . 51 . 50&middot; . &middot;40 = 635,013,559,600. 
13&middot;12&middot;&middot;&middot;2&middot;1 
</p>
<p>So the chance that Carl had the same hand twice in a row is one in 
</p>
<p>635,013,559,600, which is very small indeed. 
</p>
<p>Finally, the six guests decide to play chess. Alice, who just wants to 
</p>
<p>watch, sets up three boards. 
</p>
<p>"How many ways can you guys be matched with each other?" she won-
</p>
<p>ders. "This is clearly the same problem as seating you on six chairs; it does 
</p>
<p>not matter whether the chairs are around the dinner table or at the three 
</p>
<p>boards. So the answer is 720 as before." 
</p>
<p>"I think you should not count it as a different pairing if two people at 
</p>
<p>the same board switch places," says Bob, "and it shouldn't matter which 
</p>
<p>pair sits at which board." </p>
<p/>
</div>
<div class="page"><p/>
<p>4 1. Let's Count! 
</p>
<p>"Yes, I think we have to agree on what the question really means," adds 
</p>
<p>Carl. "If we include in it who plays white on each board, then if a pair 
</p>
<p>switches places we do get a different matching. But Bob is right that it 
</p>
<p>doesn't matter which pair uses which board." 
</p>
<p>"What do you mean it does not matter? You sit at the first board, which 
</p>
<p>is closest to the peanuts, and I sit at the last, which is farthest," says Diane. 
</p>
<p>"Let's just stick to Bob's version of the question" suggests Eve. "It is 
</p>
<p>not hard, actually. It is like with handshakes: Alice's figure of 720 counts 
</p>
<p>every pairing several times. We could rearrange the 3 boards in 6 different 
</p>
<p>ways, without changing the pairing." 
</p>
<p>"And each pair mayor may not switch sides" adds Frank. "This means 
</p>
<p>2 . 2 . 2 = 8 ways to rearrange people without changing the pairing. So 
in fact, there are 6 . 8 = 48 ways to sit that all mean the same pairing. 
The 720 seatings come in groups of 48, and so the number of matchings is 
</p>
<p>720/48 = 15." 
"I think there is another way to get this," says Alice after a little time. 
</p>
<p>"Bob is youngest, so let him choose a partner first. He can choose his 
</p>
<p>partner in 5 ways. Whoever is youngest among the rest can choose his 
</p>
<p>or her partner in 3 ways, and this settles the pairing. So the number of 
</p>
<p>pairings is 5 . 3 = 15." 
"Well, it is nice to see that we arrived at the same figure by two really 
</p>
<p>different arguments. At the least, it is reassuring" says Bob, and on this 
</p>
<p>happy note we leave the party. 
</p>
<p>1.1.2 What is the number of pairings in Carl's sense (when it matters who sits 
</p>
<p>on which side of the board, but the boards are all alike), and in Diane's sense 
</p>
<p>(when it is the other way around)? 
</p>
<p>1.1.3 What is the number of pairings (in all the various senses as above) in a 
</p>
<p>party of 10? 
</p>
<p>1.2 Sets and the Like 
</p>
<p>We want to formalize assertions like "the problem of counting the number 
</p>
<p>of hands in bridge is essentially the same as the problem of counting tickets 
</p>
<p>in the lottery." The most basic tool in mathematics that helps here is the 
</p>
<p>notion of a set. Any collection of distinct objects, called elements, is a set. 
</p>
<p>The deck of cards is a set, whose elements are the cards. The participants 
</p>
<p>in the party form a set, whose elements are Alice, Bob, Carl, Diane, Eve, 
</p>
<p>Frank, and George (let us denote this set by P). Every lottery ticket of the 
</p>
<p>type mentioned above contains a set of 5 numbers. 
</p>
<p>For mathematics, various sets of numbers are especially important: the 
</p>
<p>set of real numbers, denoted by lR; the set of rational numbers, denoted by 
</p>
<p>Q; the set of integers, denote by Z; the set of non-negative integers, denoted </p>
<p/>
</div>
<div class="page"><p/>
<p>1. 2 Sets and the Like 5 
</p>
<p>by Z+; the set of positive integers, denoted by N. The empty set, the set 
</p>
<p>with no elements, is another important (although not very interesting) set; 
</p>
<p>it is denoted by 0. 
If A is a set and b is an element of A, we write b E A. The number of 
</p>
<p>elements of a set A (also called the cardinality of A) is denoted by IAI. Thus 
IFI = 7, 101 = 0, and IZI = 00 (infinity).l 
</p>
<p>We may specify a set by listing its elements between braces; so 
</p>
<p>p = {Alice, Bob, Carl, Diane, Eve, Frank, George} 
</p>
<p>is the set of participants in Alice's birthday party, and 
</p>
<p>{12,23,27,33,67} 
</p>
<p>is the set of numbers on my uncle's lottery ticket. Sometimes, we replace 
</p>
<p>the list by a verbal description, like 
</p>
<p>{Alice and her guests}. 
</p>
<p>Often, we specify a set by a property that singles out the elements from a 
</p>
<p>large "universe" like that of all real numbers. We then write this property 
</p>
<p>inside the braces, but after a colon. Thus 
</p>
<p>{x E Z: x;:: O} 
</p>
<p>is the set of non-negative integers (which we have called Z+ before), and 
</p>
<p>{x E P: x is a girl} = {Alice, Diane, Eve} 
</p>
<p>(we will denote this set by G). Let us also tell you that 
</p>
<p>{x E P: x is over 21 years old} = {Alice, Carl, Frank} 
</p>
<p>(we will denote this set by D). 
</p>
<p>A set A is called a subset of a set B if every element of A is also an 
</p>
<p>element of B. In other words, A consists of certain elements of B. We can 
</p>
<p>allow A to consist of all elements of B (in which case A = B) or none of 
</p>
<p>them (in which case A = 0), and still consider it a subset. So the empty set 
is a subset of every set. The relation that A is a subset of B is denoted by 
</p>
<p>A ~ B. For example, among the various sets of people considered above, 
</p>
<p>G ~ P and D ~ P. Among the sets of numbers, we have a long chain: 
</p>
<p>1 In mathematics one can distinguish various levels of "infinity"; for example, one can 
</p>
<p>distinguish between the cardinalities of Z and R This is the subject matter of set theory 
</p>
<p>and does not concern us here. </p>
<p/>
</div>
<div class="page"><p/>
<p>6 1. Let's Count! 
</p>
<p>The notation A c B means that A is a subset of B but not all of B. In the 
chain above, we could replace the ~ signs by c. 
</p>
<p>If we have two sets, we can define various other sets with their help. 
</p>
<p>The intersection of two sets is the set consisting of those elements that are 
</p>
<p>elements of both sets. The intersection of two sets A and B is denoted by 
</p>
<p>AnB. For example, we have GnD = {Alice}. Two sets whose intersection 
is the empty set (in other words, they have no element in common) are 
</p>
<p>called disjoint. 
</p>
<p>The union of two sets is the set consisting of those elements that are 
</p>
<p>elements of at least one of the sets. The union of two sets A and B is denoted 
</p>
<p>by AUB. For example, we have GuD = {Alice, Carl, Diane, Eve, Frank}. 
The difference of two sets A and B is the set of elements that belong to 
</p>
<p>A but not to B. The difference of two sets A and B is denoted by A \ B. 
</p>
<p>For example, we have G \ D = {Diane, Eve}. 
The symmetric difference of two sets A and B is the set of elements 
</p>
<p>that belong to exactly one of A and B. The symmetric difference of 
</p>
<p>two sets A and B is denoted by ADB. For example, we have GDD = 
{Carl, Diane, Eve, Frank}. 
</p>
<p>Intersection, union, and the two kinds of differences are similar to addi-
</p>
<p>tion, multiplication, and subtraction. However, they are operations on sets, 
</p>
<p>rather than operations on numbers. Just like operations on numbers, set 
</p>
<p>operations obey many useful rules (identities). For example, for any three 
</p>
<p>sets A, B, and C, 
</p>
<p>A n (B U C) = (A n B) U (A n C). (1.1) 
</p>
<p>To see that this is so, think of an element x that belongs to the set on 
</p>
<p>the left-hand side. Then we have x E A and also x E B U C. This latter 
</p>
<p>assertion is the same as saying that either x E B or x E C. If x E B, then 
</p>
<p>(since we also have x E C) we have x E An B. If x E C, then similarly we 
get x E AnC. So we know that x E AnB or x E AnC. By the definition of 
</p>
<p>the union of two sets, this is the same as saying that x E (A n B) U (A n C). 
Conversely, consider an element that belongs to the right-hand side. By 
</p>
<p>the definition of union, this means that x E An B or x E An C. In the 
first case, we have x E A and also x E B. In the second, we get x E A and 
</p>
<p>also x E C. So in either case x E A, and we either have x E B or x E C, 
which implies that x E B U C. But this means that An (B U C). 
</p>
<p>This kind of argument gets a bit boring, even though there is really 
</p>
<p>nothing to it other than simple logic. One trouble with it is that it is so 
</p>
<p>lengthy that it is easy to make an error in it. There is a nice graphic way 
</p>
<p>to support such arguments. We represent the sets A, B, and C by three 
</p>
<p>overlapping circles (Figure 1.1). We imagine that the common elements of 
</p>
<p>A, B, and C are put in the common part of the three circles; those elements 
</p>
<p>of A that are also in B but not in C are put in the common part of circles 
</p>
<p>A and B outside C, etc. This drawing is called the Venn diagram of the 
</p>
<p>three sets. </p>
<p/>
</div>
<div class="page"><p/>
<p>1.2 Sets and the Like 7 
</p>
<p>FIGURE 1.1. The Venn diagram ofthree sets, and the sets on both sides of (1.1). 
</p>
<p>Now, where are those elements in the Venn diagram that belong to the 
</p>
<p>left-hand side of (1.1)? We have to form the union of Band C, which is 
</p>
<p>the gray set in Figure 1.1(a), and then intersect it with A, to get the dark 
</p>
<p>gray part. To get the set on the right-hand side, we have to form the sets 
</p>
<p>An B and An C (marked by vertical and horizontal lines, respectively in 
</p>
<p>Figure 1.1 (b)), and then form their union. It is clear from the picture that 
</p>
<p>we get the same set. This illustrates that Venn diagrams provide a safe and 
</p>
<p>easy way to prove such identities involving set operations. 
</p>
<p>The identity (1.1) is nice and quite easy to remember: If we think of 
</p>
<p>"union" as a sort of addition (this is quite natural), and "intersection" 
</p>
<p>as a sort of multiplication (hmm... not so clear why; perhaps after we 
</p>
<p>learn about probability in Chapter 5 you'll see it), then we see that (1.1) 
</p>
<p>is completely analogous to the familiar distributive rule for numbers: 
</p>
<p>a(b + c) = ab + ac. 
</p>
<p>Does this analogy go any further? Let's think of other properties of addi-
</p>
<p>tion and multiplication. Two important properties are that they are com-
</p>
<p>mutative, 
</p>
<p>a+b = b+a, ab = ba, 
</p>
<p>and associative, 
</p>
<p>(a + b) + c = a + (b + c), (ab)c = a(bc). 
</p>
<p>It turns out that these are also properties of the union and intersection 
</p>
<p>operations: 
</p>
<p>AUB=BUA, AnB=BnA, (1.2) 
</p>
<p>and 
</p>
<p>(A U B) U C = Au (B U C), (A n B) n C = An (B n C). (1.3) 
</p>
<p>The proof of these identities is left to the reader as an exercise. 
</p>
<p>Warning! Before going too far with this analogy, let us point out that 
</p>
<p>there is another distributive law for sets: 
</p>
<p>Au (B n C) = (A U B) n (A U C). (1.4) </p>
<p/>
</div>
<div class="page"><p/>
<p>8 1. Let's Count! 
</p>
<p>We get this simply by interchanging "union" and "intersection" in (1.1). 
</p>
<p>(This identity can be proved just like (1.1); see Exercise 1.2.16.) This second 
</p>
<p>distributivity is something that has no analogue for numbers: In general, 
</p>
<p>a + be 7'= (a + b)(a + e) 
</p>
<p>for three numbers a, b, e. 
</p>
<p>There are other remarkable identities involving union, intersection, and 
</p>
<p>also the two kinds of differences. These are useful, but not very deep: They 
</p>
<p>reflect simple logic. So we don't list them here, but state several of these 
</p>
<p>below in the exercises. 
</p>
<p>1.2.1 Name sets whose elements are (a) buildings, (b) people, (c) students, (d) 
</p>
<p>trees, (e) numbers, (f) points. 
</p>
<p>1.2.2 What are the elements of the following sets: (a) army, (b) mankind, (c) 
</p>
<p>library, (d) the animal kingdom? 
</p>
<p>1.2.3 Name sets having cardinality (a) 52, (b) 13, (c) 32, (d) 100, (e) 90, (f) 
</p>
<p>2,000,000. 
</p>
<p>1.2.4 What are the elements of the following (admittedly peculiar) set: 
</p>
<p>{Alice, {I}}? 
</p>
<p>1.2.5 Is an "element of a set" a special case of a "subset of a set"? 
</p>
<p>1.2.6 List all subsets of {O, 1, 3}. How many do you get? 
</p>
<p>1.2.7 Define at least three sets of which {Alice, Diane, Eve} is a subset. 
</p>
<p>1.2.8 List all subsets of {a, b, c, d, e}, containing a but not containing b. 
</p>
<p>1.2.9 Define a set of which both {I, 3, 4} and {O, 3, 5} are subsets. Find such a 
</p>
<p>set with the smallest possible number of elements. 
</p>
<p>1.2.10 (a) Which set would you call the union of {a,b,c}, {a,b,d} and 
</p>
<p>{b, c, d, e}? 
</p>
<p>(b) Find the union of the first two sets, and then the union of this with the 
</p>
<p>third. Also, find the union of the last two sets, and then the union of this 
</p>
<p>with the first set. Try to formulate what you have observed. 
</p>
<p>(c) Give a definition of the union of more than two sets. 
</p>
<p>1.2.11 Explain the connection between the notion of the union of sets and 
</p>
<p>Exercise 1.2.9. 
</p>
<p>1.2.12 We form the union of a set with 5 elements and a set with 9 elements. 
</p>
<p>Which of the following numbers can we get as the cardinality of the union: 4, 6, 
</p>
<p>9, 10, 14, 20? </p>
<p/>
</div>
<div class="page"><p/>
<p>1.3 The Number of Subsets 9 
</p>
<p>1.2.13 We form the union of two sets. We know that one ofthem has n elements 
</p>
<p>and the other has m elements. What can we infer about the cardinality of their 
</p>
<p>union? 
</p>
<p>1.2.14 What is the intersection of 
</p>
<p>(a) the sets {O, 1, 3} and {I, 2, 3}; 
</p>
<p>(b) the set of girls in this class and the set of boys in this class; 
</p>
<p>(c) the set of prime numbers and the set of even numbers? 
</p>
<p>1.2.15 We form the intersection of two sets. We know that one of them has n 
</p>
<p>elements and the other has m elements. What can we infer about the cardinality 
</p>
<p>of their intersection? 
</p>
<p>1.2.16 Prove (1.2), (1.3), and (1.4). 
</p>
<p>1.2.17 Prove that IA U BI + IA n BI = IAI + IBI&middot; 
</p>
<p>1.2.18 (a) What is the symmetric difference of the set Z+ of nonnegative in-
</p>
<p>tegers and the set E of even integers (E = { ... , -4, -2,0,2,4, ... } contains 
</p>
<p>both negative and positive even integers). 
</p>
<p>(b) Form the symmetric difference of A and B to get a set C. Form the sym-
</p>
<p>metric difference of A and C. What did you get? Give a proof of the answer. 
</p>
<p>1.3 The Number of Subsets 
</p>
<p>Now that we have introduced the notion of subsets, we can formulate our 
</p>
<p>first general combinatorial problem: What is the number of all subsets of 
</p>
<p>a set with n elements? 
</p>
<p>We start with trying out small numbers. It makes no difference what the 
</p>
<p>elements of the set are; we call them a, b, c etc. The empty set has only 
</p>
<p>one subset (namely, itself). A set with a single element, say {a}, has two 
subsets: the set {a} itself and the empty set O. A set with two elements, say 
{a, b}, has four subsets: 0, {a}, {b}, and {a, b}. It takes a little more effort 
to list all the subsets of a set {a, b, c} with 3 elements: 
</p>
<p>0,{a},{b},{c},{a,b},{b,c},{a,c},{a,b,c}. (1.5) 
</p>
<p>We can make a little table from these data: 
</p>
<p>Number of elements 
</p>
<p>Number of subsets 
</p>
<p>Looking at these values, we observe that the number of subsets is a power 
</p>
<p>of 2: If the set has n elements, the result is 2n, at least on these small 
</p>
<p>examples. </p>
<p/>
</div>
<div class="page"><p/>
<p>10 1. Let's Count! 
</p>
<p>It is not difficult to see that this is always the answer. Suppose you have 
</p>
<p>to select a subset of a set A with n elements; let us call these elements 
</p>
<p>aI, a2, ... , an. Then we mayor may not want to include aI, in other words, 
</p>
<p>we can make two possible decisions at this point. No matter how we decided 
</p>
<p>about aI, we mayor may not want to include a2 in the subset; this means 
</p>
<p>two possible decisions, and so the number of ways we can decide about al 
</p>
<p>and a2 is 2&middot;2 = 4. Now no matter how we decide about al and a2, we have 
to decide about a3, and we can again decide in two ways. Each of these 
</p>
<p>ways can be combined with each of the 4 decisions we could have made 
</p>
<p>about al and a2, which makes 4&middot;2 = 8 possibilities to decide about aI, a2 
and a3. 
</p>
<p>We can go on similarly: No matter how we decide about the first k 
</p>
<p>elements, we have two possible decisions about the next, and so the number 
</p>
<p>of possibilities doubles whenever we take a new element. For deciding about 
</p>
<p>all the n elements of the set, we have 2n possibilities. 
</p>
<p>Thus we have derived the following theorem. 
</p>
<p>Theorem 1.3.1 A set with n elements has 2n subsets. 
</p>
<p>y 
</p>
<p>FIGURE 1.2. A decision tree for selecting a subset of {a, b, c}. 
</p>
<p>We can illustrate the argument in the proof by the picture in Figure 1.2. 
</p>
<p>We read this figure as follows. We want to select a subset called S. We start 
</p>
<p>from the circle on the top (called anode). The node contains a question: 
</p>
<p>Is a an element of S? The two arrows going out of this node are labeled 
</p>
<p>with the two possible answers to this question (Yes and No). We make a 
</p>
<p>decision and follow the appropriate arrow (also called an edge) to the node 
</p>
<p>at the other end. This node contains the next question: Is b an element of 
</p>
<p>S? Follow the arrow corresponding to your answer to the next node, which </p>
<p/>
</div>
<div class="page"><p/>
<p>1.3 The Number of Subsets 11 
</p>
<p>contains the third (and in this case last) question you have to answer to 
</p>
<p>determine the subset: Is c an element of 5? Giving an answer and following 
</p>
<p>the appropriate arrow we finally get to a node that does not represent a 
</p>
<p>question, but contains a listing of the elements of 5. 
</p>
<p>Thus to select a subset corresponds to walking down this diagram from 
</p>
<p>the top to the bottom. There are just as many subsets of our set as there 
</p>
<p>are nodes on the last level. Since the number of nodes doubles from level 
</p>
<p>to level as we go down, the last level contains 23 = 8 nodes (and if we had 
an n-element set, it would contain 2n nodes). 
</p>
<p>Remark. A picture like this is called a tree. (This is not a formal definition; 
</p>
<p>that will follow later.) If you want to know why the tree is growing upside 
</p>
<p>down, ask the computer scientists who introduced this convention. (The 
</p>
<p>conventional wisdom is that they never went out of the room, and so they 
</p>
<p>never saw a real tree.) 
</p>
<p>We can give another proof of Theorem 1.3.1. Again, the answer will be 
</p>
<p>made clear by asking a question about subsets. But now we don't want to 
</p>
<p>select a subset; what we want is to enumerate subsets, which means that 
</p>
<p>we want to label them with numbers 0,1,2, ... so that we can speak, say, 
</p>
<p>about subset number 23 of the set. In other words, we want to arrange the 
</p>
<p>subsets of the set in a list and then speak about the 23rd subset on the list. 
</p>
<p>(We actually want to call the first subset of the list number 0, the second 
</p>
<p>subset on the list number 1 etc. This is a little strange, but this time it is 
</p>
<p>the logicians who are to blame. In fact, you will find this quite natural and 
</p>
<p>handy after a while.) 
</p>
<p>There are many ways to order the subsets of a set to form a list. A fairly 
</p>
<p>natural thing to do is to start with 0, then list all subsets with 1 element, 
then list all subsets with 2 elements, etc. This is the way the list (1.5) is 
</p>
<p>put together. 
</p>
<p>Another possibility is to order the subsets as in a phone book. This 
</p>
<p>method will be more transparent if we write the subsets without braces 
</p>
<p>and commas. For the subsets of {a, b, c}, we get the list 
</p>
<p>0, a, ab, abc, ac, b, bc, c. 
</p>
<p>These are indeed useful and natural ways of listing all subsets. They have 
</p>
<p>one shortcoming, though. Imagine the list of the subsets of 10 elements, 
</p>
<p>and ask yourself to name the 233rd subset on the list, without actually 
</p>
<p>writing down the whole list. This would be difficult! Is there a way to make 
</p>
<p>it easier? 
</p>
<p>Let us start with another way of denoting subsets (another encoding in 
</p>
<p>the mathematical jargon). We illustrate it on the subsets of {a, b, c}. We 
look at the elements one by one, and write down a 1 if the element occurs in 
</p>
<p>the subset and a 0 if it does not. Thus for the subset {a, c}, we write down 
</p>
<p>101, since a is in the subset, b is not, and c is in it again. This way every </p>
<p/>
</div>
<div class="page"><p/>
<p>12 1. Let's Count! 
</p>
<p>subset is "encoded" by a string of length 3, consisting of O's and l's. If we 
</p>
<p>specify any such string, we can easily read off the subset it corresponds to. 
</p>
<p>For example, the string 010 corresponds to the subset {b}, since the first 
o tells us that a is not in the subset, the 1 that follows tells us that b is in 
there, and the last 0 tells us that e is not there. 
</p>
<p>Now, such strings consisting of O's and l's remind us of the binary rep-
</p>
<p>resentation of integers (in other words, representations in base 2). Let us 
</p>
<p>recall the binary form of nonnegative integers up to 10: 
</p>
<p>0=02 
</p>
<p>1 = b 
2 = 102 
</p>
<p>3 = 2 + 1 = 112 
4 = 1002 
</p>
<p>5 = 4 + 1 = lOb 
6 = 4 + 2 = 1102 
7 = 4 + 2 + 1 = 1112 
8 = 10002 
</p>
<p>9 = 8 + 1 = 10012 
10 = 8 + 2 = 10102 
</p>
<p>(We put the subscript 2 there to remind ourselves that we are working in 
</p>
<p>base 2, not 10.) 
</p>
<p>Now, the binary forms of integers 0, 1, ... , 7 look almost like the "codes" 
</p>
<p>of subsets; the difference is that the binary form of an integer (except for 
</p>
<p>0) always starts with a 1, and the first 4 of these integers have binary 
</p>
<p>forms shorter than 3, while all codes of subsets of a 3-element set consist 
</p>
<p>of exactly 3 digits. We can make this difference disappear if we append O's 
</p>
<p>to the binary forms at their beginning, to make them all have the same 
</p>
<p>length. This way we get the following correspondence: 
</p>
<p>0 {o} O2 {o} 000 {o} 0 
1 {o} 12 {o} 001 {o} {e} 
</p>
<p>2 {o} 102 {o} 010 {o} {b} 
</p>
<p>3 {o} 112 {o} 011 {o} {b,e} 
</p>
<p>4 {o} 1002 {o} 100 {o} {a} 
</p>
<p>5 {o} 1012 {o} 101 {o} {a,e} 
</p>
<p>6 {o} 1102 {o} 110 {o} {a, b} 
</p>
<p>7 {o} 11b {o} 111 {o} {a, b, e} 
</p>
<p>So we see that the subsets of {a, b, e} correspond to the numbers 0, 1, ... ,7. 
What happens if we consider, more generally, subsets of a set with n 
</p>
<p>elements? We can argue just as we did above, to get that the subsets of </p>
<p/>
</div>
<div class="page"><p/>
<p>1.3 The Number of Subsets 13 
</p>
<p>an n-element set correspond to integers, starting with 0 and ending with 
</p>
<p>the largest integer that has n digits in its binary representation (digits in 
</p>
<p>the binary representation are usually called bits). Now, the smallest number 
</p>
<p>with n+ 1 bits is 2n , so the subsets correspond to numbers 0, 1, 2, ... ,2n-1. 
It is clear that the number of these numbers in 2n , and hence the number 
of subsets is 2n. 
</p>
<p>Now we can answer our question about the 233rd subset of a lO-element 
</p>
<p>set. We have to convert 233 to binary notation. Since 233 is odd, its last 
</p>
<p>binary digit (bit) will be 1. Let us cut off this last bit. This is the same as 
</p>
<p>subtracting 1 from 233 and then dividing it by 2: We get (233 -1) /2 = 116. 
This number is even, so its last bit will be O. Let us cut this off again; we 
</p>
<p>get (116 - 0)/2 = 58. Again, the last bit is 0, and cutting it off we get 
(58 - 0)/2 = 29. This is odd, so its last bit is 1, and cutting it off we get 
(29 - 1)/2 = 14. Cutting off a 0, we get (14 - 0)/2 = 7; cutting off a 1, we 
get (7 - 1)/2 = 3; cutting off a 1, we get (3 - 1)/2 = 1; cutting off a 1, 
we get O. So the binary form of 233 is 11101001, which corresponds to the 
</p>
<p>code 0011101001. 
</p>
<p>It follows that if al, ... , alO are the elements of our set, then the 233rd 
</p>
<p>subset of a 10-element set consists of the elements {a3, a4, a5, a7, alO}. 
</p>
<p>Comments. We have given two proofs of Theorem 1.3.1. You may wonder 
</p>
<p>why we needed two proofs. Certainly not because a single proof would not 
</p>
<p>have given enough confidence in the truth of the statement! Unlike in a legal 
</p>
<p>procedure, a mathematical proof either gives absolute certainty or else it 
</p>
<p>is useless. No matter how many incomplete proofs we give, they don't add 
</p>
<p>up to a single complete proof. 
</p>
<p>For that matter, we could ask you to take our word for it, and not give 
</p>
<p>any proof. Later, in some cases this will be necessary, when we will state 
</p>
<p>theorems whose proofs are too long or too involved to be included in this 
</p>
<p>introductory book. 
</p>
<p>So why did we bother to give any proof, let alone two proofs of the same 
</p>
<p>statement? The answer is that every proof reveals much more than just the 
</p>
<p>bare fact stated in the theorem, and this revelation may be more valuable 
</p>
<p>than the theorem itself. For example, the first proof given above introduced 
</p>
<p>the idea of breaking down the selection of a subset into independent deci-
</p>
<p>sions and the representation of this idea by a "decision tree"; we will use 
</p>
<p>this idea repeatedly. 
</p>
<p>The second proof introduced the idea of enumerating these subsets (la-
</p>
<p>beling them with integers 0, 1,2, ... ). We also saw an important method of 
</p>
<p>counting: We established a correspondence between the objects we wanted 
</p>
<p>to count (the subsets) and some other kinds of objects that we can count 
</p>
<p>easily (the numbers 0,1, ... , 2n - 1). In this correspondence: 
</p>
<p>- for every subset, we had exactly one corresponding number, and 
</p>
<p>- for every number, we had exactly one corresponding subset. </p>
<p/>
</div>
<div class="page"><p/>
<p>14 1. Let's Count! 
</p>
<p>A correspondence with these properties is called a one-to-one correspon-
</p>
<p>dence (or bijection). If we can make a one-to-one correspondence between 
</p>
<p>the elements of two sets, then they have the same number of elements. 
</p>
<p>1.3.1 Under the correspondence between numbers and subsets described above, 
which numbers correspond to (a) subsets with 1 element, (b) the whole set? (c) 
Which sets correspond to even numbers? 
</p>
<p>1.3.2 What is the number of subsets of a set with n elements, containing a 
given element? 
</p>
<p>1.3.3 Show that a nonempty set has the same number of odd subsets (i.e., 
subsets with an odd number of elements) as even subsets. 
</p>
<p>1.3.4 What is the number of integers with (a) at most n (decimal) digits; (b) 
exactly n digits (don't forget that there are positive and negative numbers!)? 
</p>
<p>1.4 The Approximate Number of Subsets 
</p>
<p>So, we know that the number of subsets of a 100-element set is 2100. This 
</p>
<p>is a large number, but how large? It would be good to know, at least, how 
</p>
<p>many digits it will have in the usual decimal form. Using computers, it 
</p>
<p>would not be too hard to find the decimal form of this number (2100 = 
1267650600228229401496703205376), but suppose we have no computers 
</p>
<p>at hand. Can we at least estimate the order of magnitude of it? 
</p>
<p>We know that 23 = 8 &lt; 10, and hence (raising both sides of this inequal-
ity to the 33rd power) 299 &lt; 1033 . Therefore, 2100 &lt; 2.1033 . Now 2.1033 
</p>
<p>is a 2 followed by 33 zeros; it has 34 digits, and therefore 2100 has at most 
</p>
<p>34 digits. 
</p>
<p>We also know that 210 = 1024 &gt; 1000 = 103; these two numbers are 
quite close to each other2. Hence 2100 &gt; 1030 , which means that 2100 has 
at least 31 digits. 
</p>
<p>This gives us a reasonably good idea of the size of 2100. With a little more 
</p>
<p>high-school math, we can get the number of digits exactly. What does it 
</p>
<p>mean that a number has exactly k digits? It means that it is between lOk-1 
</p>
<p>and 10k (the lower bound is allowed, the upper is not). We want to find 
</p>
<p>the value of k for which 
</p>
<p>2The fact that 210 is so close to 103 is used-or rather misused-in the name "kilo-
</p>
<p>byte," which means 1024 bytes, although it should mean 1000 bytes, just as a "kilogram" 
</p>
<p>means 1000 grams. Similarly, "megabyte" means 220 bytes, which is close to 1 million 
</p>
<p>bytes, but not exactly equal. </p>
<p/>
</div>
<div class="page"><p/>
<p>1.5 Sequences 15 
</p>
<p>Now we can write 2100 in the form lOx, only x will not be an integer: 
</p>
<p>the appropriate value of x is x = 192100 = 100 19 2 (we use 19 to denote 
logarithm with base 10). We have then 
</p>
<p>k - 1 :s; x &lt; k, 
</p>
<p>which means that k - 1 is the largest integer not exceeding x. Mathemati-
</p>
<p>cians have a name for this: It is the integer part, or floor, of x, and it is 
</p>
<p>denoted by l x J. We can also say that we obtain k by rounding x down to 
the next integer. There is also a name for the number obtained by rounding 
</p>
<p>x up to the next integer: It is called the ceiling of x, and denoted by I x l. 
U sing any scientific calculator (or table oflogarithms), we see that 192 R:; 
</p>
<p>0.30103, thus 100 19 2 R:; 30.103, and rounding this down we get that k -1 = 
30. Thus 2100 has 31 digits. 
</p>
<p>1.4.1 How many bits (binary digits) does 2100 have if written in base 27 
</p>
<p>1.4.2 Find a formula for the number of digits of 2n. 
</p>
<p>l.5 Sequences 
</p>
<p>Motivated by the "encoding" of subsets as strings of O's and l's, we may 
</p>
<p>want to determine the number of strings of length n composed of some other 
</p>
<p>set of symbols, for example, a, band c. The argument we gave for the case 
</p>
<p>of O's and 1 's can be carried over to this case without any essential change. 
</p>
<p>We can observe that for the first element of the string, we can choose any 
</p>
<p>of a, band c, that is, we have 3 choices. No matter what we choose, there 
</p>
<p>are 3 choices for the second element of the string, so the number of ways 
</p>
<p>to choose the first two elements is 32 = 9. Proceeding in a similar manner, 
we get that the number of ways to choose the whole string is 3n . 
</p>
<p>In fact, the number 3 has no special role here; the same argument proves 
</p>
<p>the following theorem: 
</p>
<p>Theorem 1.5.1 The number of strings of length n composed of k given 
</p>
<p>elements is kn. 
</p>
<p>The following problem leads to a generalization of this question. Suppose 
</p>
<p>that a database has 4 fields: the first, containing an 8-character abbreviation 
</p>
<p>of an employee's name; the second, M or F for sex; the third, the birthday 
</p>
<p>of the employee, in the format mm-dd-yy (disregarding the problem of not 
</p>
<p>being able to distinguish employees born in 1880 from employees born in 
</p>
<p>1980); and the fourth, a job code that can be one of 13 possibilities. How 
</p>
<p>many different records are possible? 
</p>
<p>The number will certainly be large. We already know from theorem 1.5.1 
</p>
<p>that the first field may contain 268 &gt; 200,000,000,000 names (most of </p>
<p/>
</div>
<div class="page"><p/>
<p>16 1. Let's Count! 
</p>
<p>these will be very difficult to pronounce, and are not likely to occur, but 
</p>
<p>let's count all of them as possibilities). The second field has 2 possible 
</p>
<p>entries. The third field can be thought of as three separate fields, having 
</p>
<p>12, 31, and 100 possible entries, respectively (some combinations of these 
</p>
<p>will never occur, for example, 04-31-76 or 02-29-13, but let's ignore this). 
</p>
<p>The last field has 13 possible entries. 
</p>
<p>Now how do we determine the number of ways these can be combined? 
</p>
<p>The argument we described above can be repeated, just "3 choices" has 
</p>
<p>to be replaced, in order, by "268 choices," "2 choices," "12 choices," "31 
</p>
<p>choices," "100 choices," and "13 choices." We get that the answer is 268 . 
</p>
<p>2&middot; 12 . 31 . 100&middot; 13 = 201,977,536,857,907,200. 
We can formulate the following generalization of Theorem 1.5.1 (the 
</p>
<p>proof consists of repeating the argument above). 
</p>
<p>Theorem 1.5.2 Suppose that we want to form strings of length n by using 
</p>
<p>any of a given set of kl symbols as the first element of the string, any of 
</p>
<p>a given set of k2 symbols as the second element of the string, etc., any of 
</p>
<p>a given set of kn symbols as the last element of the string. Then the total 
</p>
<p>number of strings we can form is kl . k2 ... k n . 
</p>
<p>As another special case, consider the following problem: how many non-
</p>
<p>negative integers have exactly n digits (in decimal)? It is clear that the first 
</p>
<p>digit can be any of 9 numbers (1,2, ... ,9), while the second, third, etc., 
</p>
<p>digits can be any of the 10 digits. Thus we get a special case of the previous 
</p>
<p>question with kl = 9 and k2 = k3 = ... = k n = 10. Thus the answer is 
9&middot; lOn - 1 (cf. Exercise 1.3.4). 
</p>
<p>1.5.1 Draw a tree illustrating the way we counted the number of strings of 
</p>
<p>length 2 formed from the characters a, b, and c, and explain how it gives the 
</p>
<p>answer. Do the same for the more general problem when n = 3, kl = 2, k2 = 3, 
k3 = 2. 
</p>
<p>1.5.2 In a sports shop there are T-shirts of 5 different colors, shorts of 4 different 
</p>
<p>colors, and socks of 3 different colors. How many different uniforms can you 
</p>
<p>compose from these items? 
</p>
<p>1.5.3 On a Toto (soccer poll) ticket, you have to bet 1, 2, or X for each of 13 
</p>
<p>games. In how many different ways can you fill out the ticket? 
</p>
<p>1.5.4 We roll a die twice; how many different outcomes can we have? (A 1 
</p>
<p>followed by a 4 is different from a 4 followed by a 1.) 
</p>
<p>1.5.5 We have 20 different presents that we want to distribute to 12 children. 
</p>
<p>It is not required that every child get something; it could even happen that we 
</p>
<p>give all the presents to the same child. In how many ways can we distribute the 
</p>
<p>presents? </p>
<p/>
</div>
<div class="page"><p/>
<p>1.6 Permutations 17 
</p>
<p>1.5.6 We have 20 kinds of presents; this time, we have a large supply of each 
kind. We want to give presents to 12 children. Again, it is not required that every 
child gets something; but no child can get two copies of the same present. In how 
many ways can we give presents? 
</p>
<p>1.6 Permutations 
</p>
<p>During Alice's birthday party, we encountered the problem of how many 
</p>
<p>ways ean we seat n people on n chairs (well, we have encountered it for 
</p>
<p>n = 6 and n = 7, but the question is natural enough for any n). If we 
imagine that the seats are numbered, then finding a seating for these people 
</p>
<p>is the same as assigning them to the numbers 1,2, ... , n (or 0, 1, ... , n-1 if 
</p>
<p>we want to please the logicians). Yet another way of saying this is to order 
</p>
<p>the people in a single line, or write down an (ordered) list of their names. 
</p>
<p>If we have a list of n objects (an ordered set, where it is specified which 
</p>
<p>element is the first, second, etc.), and we rearrange them so that they are 
</p>
<p>in another order, this is called permuting them; the new order is called a 
</p>
<p>permutation of the objects. We also call the rearrangement that does not 
</p>
<p>change anything a permutation (somewhat in the spirit of calling the empty 
</p>
<p>set a set). 
</p>
<p>For example, the set {a, b, c} has the following 6 permutations: 
</p>
<p>abc,acb,bac,bca,cab,cba. 
</p>
<p>So the question is to determine the number of ways n objects ean be 
</p>
<p>ordered, i.e., the number of permutations of n objects. The solution found 
</p>
<p>by the people at the party works in general: We can put any of the n people 
</p>
<p>in the first place; no matter whom we choose, we have n - 1 choices for the 
</p>
<p>second. So the number of ways to fill the first two positions is n(n -1). No 
</p>
<p>matter how we have filled the first and second positions, there are n - 2 
</p>
<p>choices for the third position, so the number of ways to fill the first three 
</p>
<p>positions is n(n - l)(n - 2). 
</p>
<p>It is clear that this argument goes on like this until all positions are 
</p>
<p>filled. The second to last position can be filled in two ways; the person 
</p>
<p>put in the last position is determined, once the other positions are filled. 
</p>
<p>Thus the number of ways to fill all positions is n&middot; (n -1) . (n - 2)&middot;&middot;&middot;2&middot; l. 
</p>
<p>This product is so important that we have a notation for it: n! (read n 
</p>
<p>factorial). In other words, n! is the number of ways to order n objects. 
</p>
<p>With this notation, we can state our second theorem. 
</p>
<p>Theorem 1.6.1 The number of permutations of n objects is n!. 
</p>
<p>Again, we can illustrate the argument above graphically (Figure 1.3). We 
</p>
<p>start with the node on the top, which poses our first decision: Whom do 
</p>
<p>we seat in the first chair? The 3 arrows going out correspond to the three </p>
<p/>
</div>
<div class="page"><p/>
<p>18 1. Let's Count! 
</p>
<p>a c 
</p>
<p>FIGURE 1.3. A decision tree for selecting a permutation of {a, b, c}. 
</p>
<p>possible answers to the question. Making a decision, we can follow one of 
</p>
<p>the arrows down to the next node. This carries the next decision problem: 
</p>
<p>whom do we put in the second chair? The two arrows out of the node 
</p>
<p>represent the two possible choices. (Note that these choices are different 
</p>
<p>for different nodes on this level; what is important is that there are two 
</p>
<p>arrows going out from each node.) If we make a decision and follow the 
</p>
<p>corresponding arrow to the next node, we know who sits in the third chair. 
</p>
<p>The node carries the whole seating order. 
</p>
<p>It is clear that for a set with n elements, n arrows leave the top node, 
</p>
<p>and hence there are n nodes on the next level. Then n - 1 arrows leave 
each of these, hence there are n(n -1) nodes on the third level. Then n - 2 
arrows leave each of these, etc. The bottom level has n! nodes. This shows 
</p>
<p>that there are exactly n! permutations. 
</p>
<p>1.6.1 n boys and n girls go out to dance. In how many ways can they all dance 
</p>
<p>simultaneously? (We assume that only couples of mixed gender dance with each 
</p>
<p>other.) 
</p>
<p>1.6.2 (a) In how many ways can 8 people play chess in Alice's interpretation 
</p>
<p>of the question? 
</p>
<p>(b) Can you give a general formula for 2n people? </p>
<p/>
</div>
<div class="page"><p/>
<p>1.7 The Number of Ordered Subsets 19 
</p>
<p>1.7 The Number of Ordered Subsets 
</p>
<p>At a competition of 100 athletes, only the order of the first 10 is recorded. 
</p>
<p>How many different outcomes does the competition have? 
</p>
<p>This question can be answered along the lines of the arguments we have 
</p>
<p>seen. The first place can be won by any of the athletes; no matter who 
</p>
<p>wins, there are 99 possible second place winners, so the first two prizes can 
</p>
<p>go 100&middot;99 ways. Given the first two, there are 98 athletes who can be third, 
</p>
<p>etc. So the answer is 100&middot;99&middot; . &middot;91. 
</p>
<p>1. 7.1 Illustrate this argument by a tree. 
</p>
<p>1. 7.2 Suppose that we record the order of all 100 athletes. 
</p>
<p>(a) How many different outcomes can we have then? 
</p>
<p>(b) How many of these give the same result for the first 10 places? 
</p>
<p>(c) Show that the result above for the number of possible outcomes for the 
</p>
<p>first 10 places can be also obtained using (a) and (b). 
</p>
<p>There is nothing special about the numbers 100 and 10 in the problem 
</p>
<p>above; we could carry out the same for n athletes with the first k places 
</p>
<p>recorded. 
</p>
<p>To give a more mathematical form to the result, we can replace the 
</p>
<p>athletes by any set of size n. The list of the first k places is given by 
</p>
<p>a sequence of k elements chosen from among n elements, which all have 
</p>
<p>to be different. We may also view this as selecting a subset of the athletes 
</p>
<p>containing k elements, and then ordering them. Thus we have the following 
</p>
<p>theorem. 
</p>
<p>Theorem 1.7.1 The number of ordered k-element subsets of a set with n 
</p>
<p>elements is n(n - 1)&middot;&middot;&middot; (n - k + 1). 
</p>
<p>(N ote that if we start with n and count down k numbers, the last one will 
be n - k + 1.) 
</p>
<p>It is lengthy to talk about "sets with n elements" and "subsets with 
</p>
<p>k elements"; it is convenient to abbreviate these expressions to "n-sets" 
</p>
<p>and k-subsets." So the number of ordered k-subsets of an n-set is n(n -
</p>
<p>1)&middot;&middot;&middot;(n-k+1). 
</p>
<p>1. 7.3 If you generalize the solution of Exercise 1. 7.2, you get the answer in the 
</p>
<p>form 
n! 
</p>
<p>(n - k)! 
</p>
<p>Check that this is the same number as given in Theorem 1.7.1. 
</p>
<p>1. 7.4 Explain the similarity and the difference between the counting questions 
</p>
<p>answered by Theorem 1.7.1 and Theorem 1.5.1. </p>
<p/>
</div>
<div class="page"><p/>
<p>20 1. Let's Count! 
</p>
<p>1.8 The Number of Subsets of a Given Size 
</p>
<p>From here, we can easily derive one of the most important counting results. 
</p>
<p>Theorem 1.8.1 The number of k-subsets of an n-set is 
</p>
<p>n(n-1) .. &middot;(n-k+1) 
</p>
<p>k! 
</p>
<p>n! 
</p>
<p>k!(n - k)!' 
</p>
<p>Proof. Recall that if we count ordered subsets, we get n(n - 1) ... (n -
</p>
<p>k + 1) = n!/(n - k)!, by Theorem 1.7.1. Of course, if we want to know the 
number of unordered subsets, then we have overcounted; every subset was 
</p>
<p>counted exactly k! times (with every possible ordering of its elements). So 
</p>
<p>we have to divide this number by k! to get the number of subsets with k 
</p>
<p>elements (without ordering). 0 
</p>
<p>The number of k-subsets of an n-set is such an important quantity that 
</p>
<p>there is a special notation for it: (~) (read "n choose k"). Thus 
</p>
<p>( n) n! 
k - k!(n-k)!' 
</p>
<p>(1.6) 
</p>
<p>The number of different lottery tickets is (95&deg;), the number of handshakes 
at the start of Alice's birthday party is G), etc. The numbers (~) are also 
called binomial coefficients (in Section 3.1 we will see why). 
</p>
<p>The value of (~) is 1, since an n-element set has exactly one n-element 
</p>
<p>subset, namely itself. It may look a bit more tricky to find that (~) = 1, 
but it is just as easy to explain: Every set has a single O-element subset, 
</p>
<p>namely the empty set. This is true even for the empty set, so that (~) = 1. 
</p>
<p>1.8.1 Which problems discussed during the party were special cases of theorem 
</p>
<p>1.8.1 ? 
</p>
<p>1.8.2 Tabulate the values of G) for 0 :::; k :::; n :::; 5. 
</p>
<p>1.8.3 Find the values of G) for k = 0,1, n - 1, n using (1.6), and explain the 
results in terms of the combinatorial meaning of (~). 
</p>
<p>Binomial coefficients satisfy many important identities. In the next theo-
</p>
<p>rem we collect some of these; some other identities will occur in the exercises 
</p>
<p>and in the next chapter. 
</p>
<p>Theorem 1.8.2 Binomial coefficients satisfy the following identities: 
</p>
<p>(1. 7) </p>
<p/>
</div>
<div class="page"><p/>
<p>1.8 The Number of Subsets of a Given Size 21 
</p>
<p>Ijn,k &gt; 0, then 
</p>
<p>(~= ~) + (n ~ 1) (~} (1.8) 
(Z) + (~) + G) + ... + (n: 1) + (~) = 2n. (1.9) 
</p>
<p>Proof. We prove (1.7) by appealing to the combinatorial meaning of both 
</p>
<p>sides. We have an n-element set, say S. The left hand side counts k-element 
</p>
<p>subsets of S, while the right hand side counts (n - k)-element subsets of 
</p>
<p>S. To see that these numbers are the same, we only need to notice that for 
</p>
<p>every k-element subset there is a corresponding (n - k)-element subset: its 
</p>
<p>complement in S , which contains exactly those elements of S that are not 
</p>
<p>contained in the k-element set. This pairs up the k-element subsets with 
</p>
<p>the (n - k )-element subsets, showing that there is the same number of each. 
Let's prove (1.8) using the algebraic formula (1.6). After substitution, 
</p>
<p>the identity becomes 
</p>
<p>n! (n-l)! (n-l)! 
</p>
<p>(k - l)!(n - k)! + k!(n - k - I)!&middot; k!(n - k)! 
</p>
<p>We can divide both sides by (n - I)! and multiply by (k - l)!(n - k - I)!; 
</p>
<p>then the identity becomes 
</p>
<p>nIl 
</p>
<p>k(n-k)=n-k+k' 
</p>
<p>which can be verified by an easy algebraic computation. 
</p>
<p>Finally, we prove (1.9) through the combinatorial interpretation again. 
</p>
<p>Again, let S be an n-element set. The first term on the left-hand side counts 
</p>
<p>the O-element subsets of S (there is only one, the empty set); the second 
</p>
<p>term counts I-element subsets; the next term, 2-element subsets, etc. In 
</p>
<p>the whole sum, every subset of S is counted exactly once. We know that 2n 
</p>
<p>(the right-hand side) is the number of all subsets of S. This proves (1.9), 
</p>
<p>and completes the proof of Theorem 1.8.2. D 
</p>
<p>1.8.4 Find a proof of (1. 7) using the algebraic formula for G) and a proof of 
(1.8), using the combinatorial meaning of both sides. 
</p>
<p>1.8.5 Prove that G) + (ntl) = n 2 ; give two proofs, one using the combina-
torial interpretation, and the other using the algebraic formula for the binomial 
</p>
<p>coefficients. 
</p>
<p>1.8.6 Prove (again in two ways) that (~) = :;Z(~=i). 
</p>
<p>1.8.7 Prove (in two ways) that for 0:::; c:::; b:::; a, </p>
<p/>
</div>
<div class="page"><p/>
<p>22 1. Let's Count! 
</p>
<p>Review Exercises 
</p>
<p>1.8.8 In how many ways can you seat 12 people at two round tables with 6 
</p>
<p>places each? Think of possible ways of defining when two seatings are different, 
</p>
<p>and find the answer for each. 
</p>
<p>1.8.9 Name sets with cardinality (a) 365, (b) 12, (c) 7, (d) 11.5, (e) 0, (f) 1024. 
</p>
<p>1.8.10 List all subsets of {a, b, c, d, e} containing {a, e} but not containing c. 
</p>
<p>1.8.11 We have not written up all subset relations between various sets of num-
</p>
<p>bers; for example, :2: &lt;;;; IR is also true. How many such relations can you find 
</p>
<p>between the sets 0, N, :2:+,:2:, Q, 1R? 
</p>
<p>1.8.12 What is the intersection of 
</p>
<p>(a) the set of positive integers whose last digit is 3, and the set of even numbers; 
</p>
<p>(b) the set of integers divisible by 5 and the set of even integers? 
</p>
<p>1.8.13 Let A = {a, b, c, d, e} and B = {c, d, e}. List all subsets of A whose 
intersection with B has 1 element. 
</p>
<p>1.8.14 Three sets have 5, 10, and 15 elements, respectively. How many elements 
</p>
<p>can their union and their intersection have? 
</p>
<p>1.8.15 What is the symmetric difference of A and A? 
</p>
<p>1.8.16 Form the symmetric difference of A and B to get a set e. Form the 
symmetric difference of A and e. What set do you get? 
</p>
<p>1.8.17 Let A, B, e be three sets and assume that A is a subset of e. Prove that 
</p>
<p>AU (B n e) = (A U B) n e. 
</p>
<p>Show by an example that the condition that A is a subset of e cannot be omitted. 
</p>
<p>1.8.18 What is the difference A \ B if 
</p>
<p>(a) A is the set of primes and B is the set of odd integers? 
</p>
<p>(b) A is the set of nonnegative real numbers and B is the set of nonpositive 
</p>
<p>real numbers? 
</p>
<p>1.8.19 Prove that for any three sets A, B, e, 
</p>
<p>((A \ B) U (B \ A)) n e = ((A n e) U (B n e)) \ (A n B n e). </p>
<p/>
</div>
<div class="page"><p/>
<p>1.8 The Number of Subsets of a Given Size 23 
</p>
<p>1.8.20 Let A be a set and let (~) denote the set of all 2-element subsets of A. 
</p>
<p>Which of the following statements is true? 
</p>
<p>(A~B) (~)u(~} (A~B)2(~)U(~} 
</p>
<p>(A~B) (~) n (~} (A~B) c (~) n (~). 
</p>
<p>1.8.21 Let B be a subset of A, IAI = n, IBI = k. What is the number of all 
subsets of A whose intersection with B has 1 element? 
</p>
<p>1.8.22 Compute the binary form of 25 and 35, and compute their sum in the 
</p>
<p>binary notation. Check the results against adding 25 and 35 in the usual decimal 
</p>
<p>notation and then converting it to binary. 
</p>
<p>1.8.23 Prove that every positive integer can be written as the sum of different 
</p>
<p>powers of 2. Also prove that for a given number, there is only one way to do so. 
</p>
<p>1.8.24 How many bits does 10100 have if written in base 2? 
</p>
<p>1.8.25 Starting from Washington, DC, how many ways can you visit 5 of the 
</p>
<p>50 state capitals and return to Washington? 
</p>
<p>1.8.26 Find the number of all 20-digit integers in which no two consecutive 
</p>
<p>digits are the same. 
</p>
<p>1.8.27 Alice has 10 balls (all different). First, she splits them into two piles; 
</p>
<p>then she picks one of the piles with at least two elements, and splits it into two; 
</p>
<p>she repeats this until each pile has only one element. 
</p>
<p>(a) How many steps does this take? 
</p>
<p>(b) Show that the number of different ways in which she can carry out this 
</p>
<p>procedure is 
</p>
<p>[Hint: Imagine the procedure backward.] 
</p>
<p>1.8.28 You want to send postcards to 12 friends. In the shop there are only 3 
</p>
<p>kinds of postcards. In how many ways can you send the postcards, if 
</p>
<p>(a) there is a large number of each kind of postcard, and you want to send one 
</p>
<p>card to each friend; 
</p>
<p>(b) there is a large number of each kind of postcard, and you are willing to send 
</p>
<p>one or more postcards to each friend (but no one should get two identical 
</p>
<p>cards); 
</p>
<p>(c) the shop has only 4 of each kind of postcard, and you want to send one 
</p>
<p>card to each friend? </p>
<p/>
</div>
<div class="page"><p/>
<p>24 1. Let's Count! 
</p>
<p>1.8.29 What is the number of ways to color n objects with 3 colors if every 
</p>
<p>color must be used at least once? 
</p>
<p>1.8.30 Draw a tree for Alice's solution of enumerating the number of ways 6 
</p>
<p>people can play chess, and explain Alice's argument using the tree. 
</p>
<p>1.8.31 How many different "words" can you get by rearranging the letters in 
</p>
<p>the word MATHEMATICS? 
</p>
<p>1.8.32 Find all positive integers a, b, and c for which 
</p>
<p>1.8.33 Prove that 
</p>
<p>1.8.34 20 persons are sitting around a table. How many ways can we choose 3 
</p>
<p>persons, no two of whom are neighbors? </p>
<p/>
</div>
<div class="page"><p/>
<p>2 
</p>
<p>Combinatorial Tools 
</p>
<p>2.1 Induction 
</p>
<p>It is time to learn one of the most important tools in discrete mathematics. 
</p>
<p>We start with a question: 
</p>
<p>We add up the first n odd numbers. What do we get'? 
</p>
<p>Perhaps the best way to try to find the answer is to experiment. If we 
</p>
<p>try small values of n, this is what we find: 
</p>
<p>1 = 1 
</p>
<p>1+3=4 
</p>
<p>1+3+5=9 
</p>
<p>1 + 3 + 5 + 7 = 16 
</p>
<p>1 + 3 + 5 + 7 + 9 = 25 
</p>
<p>1 + 3 + 5 + 7 + 9 + 11 = 36 
</p>
<p>1 + 3 + 5 + 7 + 9 + 11 + 13 = 49 
</p>
<p>1 + 3 + 5 + 7 + 9 + 11 + 13 + 15 = 64 
</p>
<p>1 + 3 + 5 + 7 + 9 + 11 + 13 + 15 + 17 = 81 
</p>
<p>1 + 3 + 5 + 7 + 9 + 11 + 13 + 15 + 17 + 19 = 100 
</p>
<p>It is easy to observe that we get squares; in fact, it seems from these 
</p>
<p>examples that the sum of the first n odd numbers is n 2 . We have observed </p>
<p/>
</div>
<div class="page"><p/>
<p>26 2. Combinatorial Tools 
</p>
<p>this for the first 10 values of n; can we be sure that it is valid for all? Well, 
</p>
<p>I'd say we can be reasonably sure, but not with mathematical certainty. 
</p>
<p>How can we prove the assertion? 
</p>
<p>Consider the sum for a general n. The nth odd number is 2n -1 (check!), 
</p>
<p>so we want to prove that 
</p>
<p>1 + 3 + ... + (2n - 3) + (2n - 1) = n 2 . (2.1) 
</p>
<p>If we separate the last term in this sum, we are left with the sum of the 
</p>
<p>first (n - 1) odd numbers: 
</p>
<p>1 + 3 + ... + (2n - 3) + (2n - 1) = (1 + 3 + ... + (2n - 3)) + (2n - 1). 
</p>
<p>Now, here the sum in the large parenthesis is (n - 1) 2, since it is the sum 
</p>
<p>of the first n - 1 odd numbers. So the total is 
</p>
<p>(n _1)2 + (2n - 1) = (n 2 - 2n + 1) + (2n - 1) = n 2 , (2.2) 
</p>
<p>just as we wanted to prove. 
</p>
<p>Wait a minute! Aren't we using in the proof the statement that we are 
</p>
<p>trying to prove? Surely this is unfair! One could prove everything if this 
</p>
<p>were allowed! 
</p>
<p>In fact, we are not quite using the assertion we are trying to prove. 
</p>
<p>What we were using, was the assertion about the sum of the first n - 1 
</p>
<p>odd numbers; and we argued (in (2.2)) that this proves the assertion about 
</p>
<p>the sum of the first n odd numbers. In other words, what we have actually 
</p>
<p>shown is that if the assertion is true for a certain value (n - 1), then it is 
</p>
<p>also true for the next value (n). 
This is enough to conclude that the assertion is true for every n. We 
</p>
<p>have seen that it is true for n = 1; hence by the above, it is also true for 
n = 2 (we have seen this anyway by direct computation, but this shows 
that this was not even necessary: It follows from the case n = 1). In a 
similar way, the truth of the assertion for n = 2 implies that it is also true 
for n = 3, which in turn implies that it is true for n = 4, etc. If we repeat 
</p>
<p>this sufficiently many times, we get the truth for any value of n. So the 
</p>
<p>assertion is true for every value of n. 
</p>
<p>This proof technique is called induction (or sometimes mathematical in-
</p>
<p>duction, to distinguish it from a notion in philosophy). It can be summa-
</p>
<p>rized as follows. 
</p>
<p>Suppose that we want to prove a property of positive integers. Also 
</p>
<p>suppose that we can prove two facts: 
</p>
<p>(a) 1 has the property, and 
</p>
<p>(b) whenever n -1 has the property, then n also has the property (n &gt; 1). </p>
<p/>
</div>
<div class="page"><p/>
<p>2.1 Induction 27 
</p>
<p>The Principle of Induction says that if (a) and (b) are true, then every 
</p>
<p>natural number has the property. 
</p>
<p>This is precisely what we did above. We showed that the "sum" of the 
</p>
<p>first 1 odd numbers is 12 , and then we showed that if the sum of the first 
</p>
<p>n - 1 odd numbers is (n - 1) 2, then the sum of the first n odd numbers is 
</p>
<p>n 2 , for whichever integer n &gt; 1 we consider. Therefore, by the Principle of 
Induction we can conclude that for every positive integer n, the sum of the 
</p>
<p>first n odd numbers is n 2 . 
</p>
<p>Often, the best way to try to carry out an induction proof is the following. 
</p>
<p>First we prove the statement for n = 1. (This is sometimes called the base 
case.) We then try to prove the statement for a general value of n, and we 
</p>
<p>are allowed to assume that the statement is true if n is replaced by n - 1. 
(This is called the induction hypothesis.) If it helps, one may also use the 
</p>
<p>validity of the statement for n - 2, n - 3, etc., and in general, for every k 
such that k &lt; n. 
</p>
<p>Sometimes we say that if 1 has the property, and every integer n inherits 
</p>
<p>the property from n-1, then every positive integer has the property. (Just 
</p>
<p>as if the founding father of a family has a certain piece of property, and 
</p>
<p>every new generation inherits this property from the previous generation, 
</p>
<p>then the family will always have this property.) 
</p>
<p>Sometimes we start not with n = 1 but with n = 0 (if this makes sense) 
or perhaps with a larger value of n (if, say, n = 1 makes no sense for 
some reason, or the statement is not for n = 1). For example, we want 
to prove that n! is an even number if 2&gt; 1. We check that this is true for 
n = 2 (indeed, 2! = 2 is even), and also that it is inherited from n - 1 to n 
(indeed, if (n - I)! is even, then so is n! = n&middot; (n - I)!, since every multiple 
of an even number is even). This proves that n! is even for all values of n 
</p>
<p>from the base case n = 2 on. The assertion is false for n = 1, of course. 
</p>
<p>2.1.1 Prove, using induction but also without it, that n(n+1) is an even number 
</p>
<p>for every nonnegative integer n. 
</p>
<p>2.1.2 Prove by induction that the sum of the first n positive integers is n(n + 
1)/2. 
</p>
<p>2.1.3 Observe that the number n(n + 1)/2 is the number of handshakes among 
n + 1 people. Suppose that everyone counts only handshakes with people older 
than him/her (pretty snobbish, isn't it?). Who will count the largest number of 
</p>
<p>handshakes? How many people count 6 handshakes? (We assume that no two 
</p>
<p>people have exactly the same age.) 
</p>
<p>Give a proof of the result of Exercise 2.1.2, based on your answer to these 
</p>
<p>questions. 
</p>
<p>2.1.4 Give a proof of Exercise 2.1.2, based on Figure 2.1. </p>
<p/>
</div>
<div class="page"><p/>
<p>28 2. Combinatorial Tools 
</p>
<p>&bull; &bull; 0 0 0 0 0 
</p>
<p>&bull; &bull; &bull; &bull; 0 0 0 0 
</p>
<p>&bull; &bull; &bull; &bull; &bull; &bull; 0 0 0 
&bull; &bull; &bull; &bull; &bull; &bull; &bull; &bull; 0 0 
&bull; &bull; &bull; &bull; &bull; &bull; &bull; &bull; &bull; &bull; 0 
</p>
<p>1+2+3+4+5 =? 2(1+2+3+4+5) = 5&middot;6 = 30 
</p>
<p>FIGURE 2.l. The sum of the first n integers 
</p>
<p>2.1.5 Prove the following identity: 
</p>
<p>. (n - 1) . n . (n + 1) 
1&middot;2 + 2&middot;3 + 3&middot;4 + ... + (n - 1) . n = 3 . 
</p>
<p>Exercise 2.1.2 relates to a well-known anecdote from the history of math-
</p>
<p>ematics. Carl Friedrich Gauss (1777-1855), one of the greatest mathemati-
</p>
<p>cians of all times, was in elementary school when his teacher gave the class 
</p>
<p>the task to add up the integers from 1 to 1000. He was hoping that he 
</p>
<p>would get an hour or so to relax while his students were working. (The 
</p>
<p>story is apocryphal, and it appears with various numbers to add: from 1 
</p>
<p>to 100, or 1900 to 2000.) To the teacher's great surprise, Gauss came up 
</p>
<p>with the correct answer almost immediately. His solution was extremely 
</p>
<p>simple: Combining the first term with the last, you get 1 + 1000 :::; 1001; 
combining the second term with the last but one, you get 2 + 999 = 1001; 
proceeding in a similar way, combining the first remaining term with the 
</p>
<p>last one (and then discarding them) you get 1001. The last pair added this 
</p>
<p>way is 500 + 501 = 1001. So we obtained 500 times 1001, which makes 
500500. We can check this answer against the formula given in exercise 
</p>
<p>2.1.2: 1000&middot; 1001/2 = 500500. 
</p>
<p>2.1.6 Use the method of the young Gauss to give a third proof of the formula 
</p>
<p>in exercise 2.l.2 
</p>
<p>2.1. 7 How would the young Gauss prove the formula (2.1) for the sum of the 
</p>
<p>first n odd numbers? 
</p>
<p>2.1.8 Prove that the sum of the first n squares (1 + 4 + 9 + ... + n2 ) is n(n + 
1)(2n + 1)/6. 
</p>
<p>2.1.9 Prove that the sum of the first n powers of 2 (starting with 1 = 2&deg;) is 
</p>
<p>2n - l. 
</p>
<p>In Chapter 1 we often relied on the convenience of saying "etc.": we 
</p>
<p>described some argument that had to be repeated n times to give the </p>
<p/>
</div>
<div class="page"><p/>
<p>2.1 Induction 29 
</p>
<p>result we wanted to get, but after giving the argument once or twice, we 
</p>
<p>said "etc." instead of further repetition. There is nothing wrong with this, 
</p>
<p>if the argument is sufficiently simple so that we can intuitively see where 
</p>
<p>the repetition leads. But it would be nice to have some tool at hand that 
</p>
<p>could be used instead of "etc." in cases where the outcome of the repetition 
</p>
<p>is not so transparent. 
</p>
<p>The precise way of doing this is using induction, as we are going to 
</p>
<p>illustrate by revisiting some of our results. First, let us give a proof of the 
</p>
<p>formula for the number of subsets of an n-element set, given in Theorem 
</p>
<p>1.3.1 (recall that the answer is 2n). 
</p>
<p>As the Principle of Induction tells us, we have to check that the assertion 
</p>
<p>is true for n = O. This is trivial, and we already did it. Next, we assume that 
n &gt; 0, and that the assertion is true for sets with n - 1 elements. Consider 
a set S with n elements, and fix any element a E S. We want to count the 
</p>
<p>subsets of S. Let us divide them into two classes: those containing a and 
</p>
<p>those not containing a. We count them separately. 
</p>
<p>First, we deal with those subsets that don't contain a. If we delete a from 
</p>
<p>S, we are left with a set S' with n - 1 elements, and the subsets we are 
</p>
<p>interested in are exactly the subsets of S'. By the induction hypothesis, the 
</p>
<p>number of such subsets is 2n-l. 
</p>
<p>Second, we consider subsets containing a. The key observation is that 
</p>
<p>every such subset consists of a and a subset of S'. Conversely, if we take 
</p>
<p>any subset of S', we can add a to it to get a subset of S containing a. 
</p>
<p>Hence the number of subsets of S containing a is the same as the number of 
</p>
<p>subsets of S', which is, by the induction hypothesis, 2n-l. (We can exercise 
</p>
<p>another bit of mathematical jargon introduced before: The last piece of the 
</p>
<p>argument establishes a one-to-one correspondence between those subsets of 
</p>
<p>S containing a and those not containing a.) 
To conclude: The total number of subsets of S is 2n- 1 + 2n- 1 = 2&middot; 2n- 1 = 
</p>
<p>2n. This proves Theorem 1. 3.1 (again). 
</p>
<p>2.1.10 Use induction to prove Theorem 1.5.1 (the number of strings of length 
</p>
<p>n composed of k given elements is kn) and Theorem 1.6.1 (the number of per-
</p>
<p>mutations of a set with n elements is n!). 
</p>
<p>2.1.11 Use induction on n to prove the "handshake theorem" (the number of 
</p>
<p>handshakes between n people is n(n - 1)/2). 
</p>
<p>2.1.12 Read carefully the following induction proof: 
</p>
<p>ASSERTION: n(n + 1) is an odd number for every n. 
</p>
<p>PROOF: Suppose that this is true for n - 1 in place of n; we prove it 
</p>
<p>for n, using the induction hypothesis. We have 
</p>
<p>n(n + 1) = (n - l)n + 2n. </p>
<p/>
</div>
<div class="page"><p/>
<p>30 2. Combinatorial Tools 
</p>
<p>Now here (n-1)n is odd by the induction hypothesis, and 2n is even. 
</p>
<p>Hence n(n + 1) is the sum of an odd number and an even number, 
which is odd. 
</p>
<p>The assertion that we proved is obviously wrong for n = 10: 10&middot; 11 = 110 is 
even. What is wrong with the proof? 
</p>
<p>2.1.13 Read carefully the following induction proof: 
</p>
<p>ASSERTION: If we have n lines in the plane, no two of which are 
</p>
<p>parallel, then they all go through one point. 
</p>
<p>PROOF: The assertion is true for one line (and also for 2, since we 
</p>
<p>have assumed that no two lines are parallel). Suppose that it is true 
</p>
<p>for any set of n - 1 lines. We are going to prove that it is also true 
</p>
<p>for n lines, using this induction hypothesis. 
</p>
<p>So consider a set S = {a, b, c, d, ... } of n lines in the plane, no two 
</p>
<p>of which are parallel. Delete the line c; then we are left with a set S' 
</p>
<p>of n - 1 lines, and obviously, no two of these are parallel. So we can 
</p>
<p>apply the induction hypothesis and conclude that there is a point P 
</p>
<p>such that all the lines in S' go through P. In particular, a and b go 
</p>
<p>through P, and so P must be the point of intersection of a and b. 
</p>
<p>Now put c back and delete d, to get a set S" of n - 1 lines. Just as 
</p>
<p>above, we can use the induction hypothesis to conclude that these 
</p>
<p>lines go through the same point pI; but just as above, p' must be 
</p>
<p>the point of intersection of a and b. Thus pI = P. But then we see 
</p>
<p>that c goes through P. The other lines also go through P (by the 
</p>
<p>choice of P), and so all the n lines go through P. 
</p>
<p>But the assertion we proved is clearly wrong; where is the error? 
</p>
<p>2.2 Comparing and Estimating Numbers 
</p>
<p>It is nice to have formulas for certain numbers (for example, for the number 
</p>
<p>n! of permutations of n elements), but it is often more important to have 
</p>
<p>a rough idea about how large these numbers are. For example, how many 
</p>
<p>digits does 100! have? 
</p>
<p>Let us start with simpler questions. Which is larger, n or G)? For n = 
2,3,4 the value of G) is 1,3,6, so it is less than n for n = 2, equal for 
n = 3, but larger for n = 4. In fact, n = (?) &lt; (;) if n ~ 4. 
</p>
<p>More can be said: The quotient 
</p>
<p>G) n-l 
n 2 
</p>
<p>becomes arbitrarily large as n becomes large; for example, if we want this 
</p>
<p>quotient to be larger than 1000, it suffices to choose n &gt; 2001. In the </p>
<p/>
</div>
<div class="page"><p/>
<p>2.2 Comparing and Estimating Numbers 31 
</p>
<p>language of calculus, we have 
</p>
<p>G) ~oo 
n 
</p>
<p>(n~oo). 
</p>
<p>Here is another simple question: Which is larger, n 2 or 2n ? For small 
</p>
<p>values of n, this can go either way: 12 &lt; 21, 22 = 22, 32 &gt; 23 , 42 = 24, 
52 &lt; 25 . But from here on, 2n takes off and grows much faster than n 2 . For 
example, 210 = 1024 is much larger than 102 = 100. In fact, 2n /n2 becomes 
arbitrarily large, as n becomes large. 
</p>
<p>2.2.1 (a) Prove that 2n &gt; G) if n 2 3. 
</p>
<p>(b) Use (a) to prove that 2n /n 2 becomes arbitrarily large as n becomes large. 
</p>
<p>Now we tackle the problem of estimating lOa! or, more generally, n! = 
1 . 2 ... n. The first factor 1 does not matter, but all the others are at least 
</p>
<p>2, so n! 2 2n-1. Similarly, n! :::; nn-\ since (ignoring the factor 1 again) n! 
is the product of n - 1 factors, each of which is at most n. (Since all but 
</p>
<p>one of them are smaller than n, the product is in fact much smaller.) Thus 
</p>
<p>we know that 
</p>
<p>(2.3) 
</p>
<p>These bounds are very far apart; for n = 10, the lower bound is 29 = 512, 
while the upper bound is 109 (one billion). 
</p>
<p>Here is a question that is not answered by the simple bounds in (2.3). 
</p>
<p>Which is larger, n! or 2n? In other words, does a set with n elements have 
</p>
<p>more permutations or more subsets? For small values of n, subsets are 
</p>
<p>winning: 21 = 2 &gt; I! = 1, 22 = 4&gt; 2! = 2, 23 = 8 &gt; 3! = 6. But then the 
picture changes: 24 = 16 &lt; 4! = 24, 25 = 32 &lt; 5! = 120. It is easy to see 
that as n increases, n! grows much faster than 2n: If we go from n to n + 1, 
then 2n grows by a factor of 2, while n! grows by a factor of n + 1. 
</p>
<p>2.2.2 Use induction to make the previous argument precise, and prove that 
n! &gt; 2n if n 2 4. 
</p>
<p>There is a formula that gives a very good approximation of nL We state 
</p>
<p>it without proof, since the proof (although not terribly difficult) needs 
</p>
<p>calculus. 
</p>
<p>Theorem 2.2.1 [Stirling's formula] 
</p>
<p>( n)n . n! '" -;;- V27rn. 
</p>
<p>Here 7r = 3.14 ... is the area of the circle with unit radius, e = 2.718 ... 
is the base of the natural logarithm, and '" means approximate equality in 
</p>
<p>the precise sense that 
</p>
<p>n! 
n M=::~1 
</p>
<p>(~) v 27rn 
(n ~ 00). </p>
<p/>
</div>
<div class="page"><p/>
<p>32 2. Combinatorial Tools 
</p>
<p>Both of the funny irrational numbers e and 'if occur in the same formula! 
</p>
<p>Let us return to the question: How many digits does 100! have? We know 
</p>
<p>by Stirling's formula that 
</p>
<p>100! ~ (lOOje)lDO . V200'if. 
</p>
<p>The number of digits of this number is its logarithm, in base 10, rounded 
</p>
<p>up. Thus we get 
</p>
<p>Ig(lOO!) ~ 100 Ig(100j e) + 1 + 19 y'2;= = 157.969 .... 
</p>
<p>So the number of digits in 100! is about 158 (this is, in fact, the right value). 
</p>
<p>2.3 Inclusion-Exclusion 
</p>
<p>In a class of 40, many students are collecting the pictures of their favorite 
</p>
<p>rock stars. Eighteen students have a picture of the Beatles, 16 students 
</p>
<p>have a picture of the Rolling Stones and 12 students have a picture of Elvis 
</p>
<p>Presley (this happened a long time ago, when we were young). There are 
</p>
<p>7 students who have pictures of both the Beatles and the Rolling Stones, 
</p>
<p>5 students who have pictures of both the Beatles and Elvis Presley, and 3 
</p>
<p>students who have pictures of both the Rolling Stones and Elvis Presley. 
</p>
<p>Finally, there are 2 students who possess pictures of all three groups. Ques-
</p>
<p>tion: How many students in the class have no picture of any of the rock 
</p>
<p>groups? 
</p>
<p>First, we may try to argue like this: There are 40 students altogether in 
</p>
<p>the class; take away from this the number of those having Beatles pictures 
</p>
<p>(18), those having Rolling Stones picture (16), and those having Elvis pic-
</p>
<p>tures (12); so we take away 18 + 16 + 12. We get -6; this negative number 
warns us that there must be some error in our calculation; but what was 
</p>
<p>not correct? We made a mistake when we subtracted the number of those 
</p>
<p>students who collected the pictures of two groups twice! For example, a 
</p>
<p>student having the Beatles and Elvis Presley was subtracted with the Bea-
</p>
<p>tIes collectors as well as with the Elvis Presley collectors. To correct our 
</p>
<p>calculations, we have to add back the number of those students who have 
</p>
<p>pictures of two groups. This way we get 40 - (18 + 16 + 12) + (7 + 5 + 3). 
But we must be careful; we shouldn't make the same mistake again! What 
</p>
<p>happened to the 2 students who have the pictures of all three groups? We 
</p>
<p>subtracted these 3 times at the beginning, and then we added them back 3 
</p>
<p>times, so we must subtract them once more! With this correction, our final 
</p>
<p>result is: 
</p>
<p>40 - (18 + 16 + 12) + (7 + 5 + 3) - 2 = 7. (2.4) 
We can not find any error in this formula, looking at it from any direction. 
</p>
<p>But learning from our previous experience, we must be much more careful: 
</p>
<p>We have to give an exact proof! </p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Inclusion-Exclusion 33 
</p>
<p>So suppose that somebody records picture collecting data of the class in 
</p>
<p>a table like Table 2.1 below. Each row corresponds to a student; we did not 
</p>
<p>put down all the 40 rows, just a few typical ones. 
</p>
<p>Name Bonus Beatles Stones Elvis BS BE SE BSE 
</p>
<p>Al 1 0 0 0 0 0 0 0 
</p>
<p>Bel 1 -1 0 0 0 0 0 0 
</p>
<p>Cy 1 -1 -1 0 1 0 0 0 
</p>
<p>Di 1 -1 0 -1 0 1 0 0 
</p>
<p>Ed 1 -1 -1 -1 1 1 1 -1 
</p>
<p>TABLE 2.1. Strange record of who's collecting whose pictures. 
</p>
<p>The table is a bit silly (but with reason). First, we give a bonus of 1 to 
</p>
<p>every student. Second, we record in a separate column whether the student 
</p>
<p>is collecting (say) both the Beatles and Elvis Presley (the column labeled 
</p>
<p>BE), even though this could be read off from the previous columns. Third, 
</p>
<p>we put a -1 in columns recording the collecting of an odd number of 
</p>
<p>pictures, and a 1 in columns recording the collecting of an even number of 
</p>
<p>pictures. 
</p>
<p>We compute the total sum of entries in this table in two different ways. 
</p>
<p>First, what are the row sums? We get 1 for Al and 0 for everybody else. 
</p>
<p>This is not a coincidence. If we consider a student like AI, who does not 
</p>
<p>have any picture, then this student contributes to the bonus column, but 
</p>
<p>nowhere else, which means that the sum in the row of this student is 1. 
</p>
<p>Next, consider Ed, who has all 3 pictures. He has a 1 in the bonus column; 
</p>
<p>in the next 3 columns he has 3 terms that are -1. In each of the next 3 
</p>
<p>columns he has a 1, one for each pair of pictures; it is better to think of 
</p>
<p>this 3 as @. His row ends with m -1 's ((~) equals 1, but in writing it 
this way the general idea can be seen better). So the sum of the row is 
</p>
<p>1 - G) + G) -G) = o. 
Looking at the rows of Bel, Cy, and Di, we see that their sums are 
</p>
<p>1- G) = 0 
1- G) + G) = 0 
</p>
<p>for Bel (1 picture), 
</p>
<p>for Cy and Di (2 pictures). 
</p>
<p>If we move the negative terms to the other side of these equations, we get 
</p>
<p>an equation with a combinatorial meaning: The number of subsets of an </p>
<p/>
</div>
<div class="page"><p/>
<p>34 2. Combinatorial Tools 
</p>
<p>n-set with an even number of elements is the same as the number of subsets 
</p>
<p>with an odd number of elements. For example, 
</p>
<p>(~) + (~) (~) + (~). 
Recall that Exercise 1.3.3 asserts that this is indeed so for every n 2': 1. 
</p>
<p>Since the row sum is 0 for all those students who have any picture of any 
</p>
<p>music group, and it is 1 for those having no picture at all, the sum of all 
</p>
<p>40 row sums gives exactly the number of those students having no picture 
</p>
<p>at all. 
</p>
<p>On the other hand, what are the column sums? In the "bonus" column, 
</p>
<p>we have 40 times +1; in the "Beatles" column, we have 18 times -1; then 
</p>
<p>we have 16 and 12 times -1. Furthermore, we get 7 times +1 in the BS 
</p>
<p>column, then 5- and 3 times + 1 in the BE and SE columns, respectively. 
Finally, we get 2 -1 's in the last column. So this is indeed the expression 
</p>
<p>in (2.4). 
</p>
<p>This formula is called the Inclusion-Exclusion Formula or Sieve Formula. 
</p>
<p>The origin of the first name is obvious; the second refers to the image that 
</p>
<p>we start with a large set of objects and then "sieve out" those objects we 
</p>
<p>don't want to count. 
</p>
<p>We could extend this method if students were collecting pictures of 4, 
</p>
<p>or 5, or any number of rock groups instead of 3. Rather than stating a 
</p>
<p>general theorem (which would be lengthy), we give a number of exercises 
</p>
<p>and examples. 
</p>
<p>2.3.1 In a class of all boys, 18 boys like to play chess, 23 like to play soccer, 
</p>
<p>21 like biking and 17 like hiking. The number of those who like to play both 
</p>
<p>chess and soccer is 9. We also know that 7 boys like chess and biking, 6 boys like 
</p>
<p>chess and hiking, 12 like soccer and biking, 9 boys like soccer and hiking, and 
</p>
<p>finally 12 boys like biking and hiking. There are 4 boys who like chess, soccer, 
</p>
<p>and biking, 3 who like chess, soccer, and hiking, 5 who like chess, biking, and 
</p>
<p>hiking, and 7 who like soccer, biking, and hiking. Finally there are 3 boys who 
</p>
<p>like all four activities. In addition we know that everybody likes at least one of 
</p>
<p>these activities. How many boys are there in the class? 
</p>
<p>2.4 Pigeonholes 
</p>
<p>Can we find in New York two persons having the same number of strands 
</p>
<p>of hair? One would think that it is impossible to answer this question, since 
</p>
<p>one does not even know how many strands of hair there are on one's own 
</p>
<p>head, let alone about the number of strands of hair on every person living in 
</p>
<p>New York (whose exact number is in itself quite difficult to determine). But 
</p>
<p>there are some facts that we know for sure: Nobody has more than 500,000 
</p>
<p>strands of hair (a scientific observation), and there are more than 10 million </p>
<p/>
</div>
<div class="page"><p/>
<p>2.4 Pigeonholes 35 
</p>
<p>inhabitants of New York. Can we now answer our original question? Yes. 
</p>
<p>If there were no two people with the same number of strands of hair, then 
</p>
<p>there would be at most one person having &deg; strands, at most one person 
having exactly 1 strand, and so on. Finally, there would be at most one 
</p>
<p>person having exactly 500,000 strands. But then this means that there are 
</p>
<p>no more than 500,001 inhabitants of New York. Since this contradicts what 
</p>
<p>we know about New York, it follows that there must be two people having 
</p>
<p>the same number of strands of hair. 1 
</p>
<p>We can formulate our solution as follows. Imagine 500,001 enormous 
</p>
<p>boxes (or pigeon holes). The first one is labeled "New Yorkers having &deg; 
strands of hair," the next is labeled "New Yorkers having 1 strand of hair," 
</p>
<p>and so on. The last box is labeled "New Yorkers having 500,000 strands 
</p>
<p>of hair". Now if everybody goes to the proper box, then about 10 million 
</p>
<p>New Yorkers are properly assigned to some box (or hole). Since we have 
</p>
<p>only 500,001 boxes, there certainly will be a box containing more than one 
</p>
<p>New Yorker. This statement is obvious, but it is very often a powerful tool, 
</p>
<p>so we formulate it in full generality: 
</p>
<p>If we have n boxes and we place more than n objects into them, 
</p>
<p>then there will be at least one box that contains more than one 
</p>
<p>object. 
</p>
<p>Very often, the above statement is formulated using pigeons and their 
</p>
<p>holes, and is referred to as the Pigeonhole Principle. The Pigeonhole Princi-
</p>
<p>ple is simple indeed: Everybody understands it immediately. Nevertheless, 
</p>
<p>it deserves a name, since we use it very often as the basic tool of many 
</p>
<p>proofs. We will see many examples for the use of the Pigeonhole Principle, 
</p>
<p>but to show you its power, we discuss one of them right away. This is not 
</p>
<p>a theorem of any significance; rather, and exercise whose solution is given 
</p>
<p>in detail. 
</p>
<p>Exercise. We shoot 50 shots at a square target, the side of which is 70 
</p>
<p>cm long. We are quite a good shot, because all of our shots hit the target. 
</p>
<p>Prove that there are two bulletholes that are closer than 15 cm. 
</p>
<p>Solution: Imagine that our target is an old chessboard. One row and one 
</p>
<p>column of it has fallen off, so it has 49 squares. The board received 50 
</p>
<p>shots, so there must be a square that received at least two shots (putting 
</p>
<p>bulletholes in pigeonholes). We claim that these two shots are closer to each 
</p>
<p>other than 15 cm. 
</p>
<p>IThere is an interesting feature of this argument: we end up knowing that two such 
</p>
<p>persons exist, without having the slightest hint about how to find these people. (Even 
</p>
<p>if we suspect that two people have the same number of strands of hair, it is essentially 
</p>
<p>impossible to verify that this is indeed so!) Such proofs in mathematics are called pure 
</p>
<p>existence proofs. </p>
<p/>
</div>
<div class="page"><p/>
<p>36 2. Combinatorial Tools 
</p>
<p>The side of the square is obviously 10 cm, the diagonals of it are equal, 
</p>
<p>and (from the Pythagorean Theorem) their length is V200 :::::&gt; 14.1 cm. We 
</p>
<p>show that 
</p>
<p>( *) the two shots cannot be at a larger distance than the diagonal. 
</p>
<p>It is intuitively clear that two points in the square at largest distance are 
</p>
<p>the endpoints of one of the diagonals, but intuition can be misleading; let 
</p>
<p>us prove this. Suppose that two points P and Q are farther away then the 
</p>
<p>length of the diagonal. Let A, E, C, and D be the vertices of the square. 
Connect P and Q by a line, and let P' and Q' be the two points where this 
</p>
<p>line intersects the boundary of the square (Figure 2.2). Then the distance 
</p>
<p>of P' and Q' is even larger, so it is also larger than the diagonal. 
</p>
<p>C .-------------~ B 
</p>
<p>p' 
</p>
<p>D ..... ------.. A 
</p>
<p>FIGURE 2.2. Two shots in the same square 
</p>
<p>We may assume without loss of generality that P' lies on the side AE (if 
</p>
<p>this is not the case, we change the names of the vertices). One of the angles 
</p>
<p>Q' P' A and Q' P' E is at least 90&deg;; we may assume (again without loss of 
</p>
<p>generality) that Q' P' A is this angle. Then the segment AQ' is the edge of 
</p>
<p>the triangle Q' P' A opposite the largest angle, and so it is even longer than 
</p>
<p>P' Q', and so it is longer than the diagonal. 
We repeat this argument to show that if we replace Q' by one of the 
</p>
<p>endpoints of the side it lies on, we get a segment that is longer than the 
</p>
<p>diagonal. But now we have a segment both of whose endpoints are vertices 
</p>
<p>of the square. So this segment is either a side or a diagonal of the square, 
</p>
<p>and in neither case is it longer than the diagonal! This contradiction shows 
</p>
<p>that the assertion (*) above must be true. 
So we got not only that there will be two shots that are closer than 
</p>
<p>15 cm, but even closer than 14.2 cm. This concludes the solution of the 
</p>
<p>exercise. 
</p>
<p>If this is the first time you have seen this type of proof, you may be 
</p>
<p>surprised: we did not argue directly to prove what we wanted, but instead 
</p>
<p>assumed that the assertion was not true, and then using this additional </p>
<p/>
</div>
<div class="page"><p/>
<p>2.5 The Twin Paradox and the Good Old Logarithm 37 
</p>
<p>assumptions, we argued until we got a contradiction. This form of proof is 
</p>
<p>called indirect, and it is quite often used in mathematical reasoning, as we 
</p>
<p>will see throughout this book. (Mathematicians are strange creatures, one 
</p>
<p>may observe: They go into long arguments based on assumptions they know 
</p>
<p>are false, and their happiest moments are when they find a contradiction 
</p>
<p>between statements they have proved.) 
</p>
<p>2.4.1 Prove that we can select 20 New Yorkers who all have the same number 
</p>
<p>of strands of hair. 
</p>
<p>2.5 The Twin Paradox and the Good Old 
Logarithm 
</p>
<p>Having taught the Pigeonhole Principle to his class, the professor decides 
</p>
<p>to playa little game: "I bet that there are two of you who have the same 
</p>
<p>birthday! What do you think?" Several students reply immediately: "There 
</p>
<p>are 366 possible birthdays, so you could only conclude this if there were at 
</p>
<p>least 367 of us in the class! But there are only 50 of us, and so you'd lose 
</p>
<p>the bet." Nevertheless, the professor insists on betting, and he wins. 
</p>
<p>How can we explain this? The first thing to realize is that the Pigeonhole 
</p>
<p>Principle tells us that with 367 students in the class, the professor always 
</p>
<p>wins the bet. But this is uninteresting as bets go; it is enough for him that 
</p>
<p>he has a good chance of winning. With 366 students, he may already lose; 
</p>
<p>could it be that with only 50 students he still has a good chance of winning? 
</p>
<p>The surprising answer is that even with as few as 23 students, his chance 
</p>
<p>of winning is slightly larger than 50%. We can view this fact as a "Proba-
</p>
<p>bilistic Pigeonhole Principle", but the usual name for it is the Twin Para-
</p>
<p>dox. 
</p>
<p>Let us try to determine the professor's chances. Suppose that on the class 
</p>
<p>list, he writes down everybody's birthday. So he has a list of 50 birthdays. 
</p>
<p>We know from Section 1.5 that there are 36650 different lists of this type. 
</p>
<p>For how many of these does he lose? Again, we already know the answer 
</p>
<p>from Section 1.7: 366 . 365 .. &middot;317. So the probability that he loses the bet 
</p>
<p>is2 
366 . 365 ... 317 
</p>
<p>36650 . 
</p>
<p>With some effort, we could calculate this value "by brute force", using 
</p>
<p>a computer (or just a programmable calculator), but it will be much more 
</p>
<p>2Here we made the implicit assumption that all the 36650 birthday lists are equally 
</p>
<p>likely. This is certainly not true; for example, lists containing February 29 are clearly 
</p>
<p>much less likely. There are also (much smaller) variations between the other days of the 
</p>
<p>year. It can be shown, however, that these variations only help the professor, making 
</p>
<p>collisions of birthdays more likely. </p>
<p/>
</div>
<div class="page"><p/>
<p>38 2. Combinatorial Tools 
</p>
<p>useful to get upper and lower bounds by a method that will work in a more 
</p>
<p>general case, when we have n possible birthdays and k students. In other 
</p>
<p>words, how large is the quotient 
</p>
<p>n(n-1)&middot;&middot;&middot;(n-k+1) ? 
</p>
<p>n k 
</p>
<p>It will be more convenient to take the reciprocal (which is then larger than 
</p>
<p>1 ): 
</p>
<p>n(n-1) .. &middot;(n-k+1)" 
(2.5) 
</p>
<p>We can simplify this fraction by cancelling an n, but then there is no 
</p>
<p>obvious way to continue. A little clue may be that the number of factors 
</p>
<p>is the same in the numerator and denominator, so let us try to write this 
</p>
<p>fraction as a product: 
</p>
<p>n n n 
-_.-- ... ----
</p>
<p>n(n-1) ... (n-k+1) n-1 n-2 n-k+1&middot; 
</p>
<p>These factors are quite simple, but it is still difficult to see how large their 
</p>
<p>product is. The individual factors are larger than 1, but (at least at the 
</p>
<p>beginning) quite close to 1. But there are many of them, and their product 
</p>
<p>may be large. 
</p>
<p>The following idea helps: Take the logarithmf3 We get 
</p>
<p>In ( n
k 
</p>
<p>) = In (_n ) + In (_n ) + ... 
n(n-1)&middot;&middot;&middot;(n-k+1) n-1 n-2 
</p>
<p>+ In ( ~ ) . (2.6) 
n- +1 
</p>
<p>(Naturally, we took the natural logarithm, base e = 2.71828 .... ) This way 
we can deal with addition instead of multiplication, which is nice; but the 
</p>
<p>terms we have to add up became much uglier! What do we know about 
</p>
<p>these logarithms? 
</p>
<p>Let's look at the graph of the logarithm function (Figure 2.3). We have 
</p>
<p>also drawn the line y = x - 1. We see that the function is below the line, 
and touches it at the point x = 1 (these facts can be proved by really 
elementary calculus). So we have 
</p>
<p>Inx:S:x-1. (2.7) 
</p>
<p>Can we say something about how good this upper bound is? From the 
</p>
<p>figure we see that at least for values of x close to 1, the two graphs are 
</p>
<p>3 After ali, the logarithm was invented in the seventeenth century by Buergi and 
</p>
<p>Napier to make multiplication easier, by turning it into addition. </p>
<p/>
</div>
<div class="page"><p/>
<p>2.5 The Twin Paradox and the Good Old Logarithm 39 
</p>
<p>2 3 
</p>
<p>o 
</p>
<p>-1 
</p>
<p>-2 
</p>
<p>FIGURE 2.3. The graph of the natural logarithm function. Note that near 1, it 
</p>
<p>is very close to the line x - 1. 
</p>
<p>quite close. Indeed, we can do the following little computation: 
</p>
<p>1 (1 ) x-I lnx=-ln-2- --1 =--. 
x x x 
</p>
<p>(2.8) 
</p>
<p>If x is a little larger than 1 (as are the values we have in (2.6)), then X;;l is 
only a little smaller than x -1, and so the upper bound in (2.7) and lower 
bound in (2.8) are quite close. 
</p>
<p>These bounds on the logarithm function are very useful in many applica-
</p>
<p>tions in which we have to do approximate computations with logarithms, 
</p>
<p>and it is worthwhile to state them in a separate lemma. (A lemma is a 
</p>
<p>precise mathematical statement, just like a theorem, except that it is not 
</p>
<p>the goal itself, but some auxiliary result used along the way to the proof of 
</p>
<p>a theorem. Of course, some lemmas are more interesting than some theo-
</p>
<p>rems!) 
</p>
<p>Lemma 2.5.1 For every x &gt; 0, 
</p>
<p>x-I 
-- &lt; lnx &lt; x-l. x - -
</p>
<p>First we use the lower bound in this lemma to estimate (2.6) from below. 
For a typical term in the sum in (2.6) we get 
</p>
<p>j 
</p>
<p>n' </p>
<p/>
</div>
<div class="page"><p/>
<p>40 2. Combinatorial Tools 
</p>
<p>and hence 
</p>
<p>In &gt; - + - + ... + --( nk ) 12k - 1 
n(n-1) .. &middot;(n-k+1) -n n n 
</p>
<p>= ~(1 + 2 + ... + (k _ 1)) = k(k - 1) 
n 2n 
</p>
<p>(remember the young Gauss's problem!). Thus we have a simple lower 
</p>
<p>bound on (2.6). To get an upper bound, we can use the other inequality in 
</p>
<p>Lemma 2.5.1; for a typical term, we get 
</p>
<p>In -- &lt;---1=--. ( n) n j 
n-j - n-j n-j 
</p>
<p>We have to sum these for j = 1, ... , k - 1 to get an upper bound on 
(2.6). This is not as easy as in young Gauss's case, since the denominator 
</p>
<p>is changing. But we only want an upper bound, so we could replace the 
</p>
<p>denominator by the smallest value it can have for various values of j, namely 
</p>
<p>n - k + 1. We have j/(n - j) :s: j/(n - k + 1), and hence 
</p>
<p>In ( n k ) &lt; 1 + 2 + ... + _k_-_1_ 
n(n-1) .. &middot;(n-k+1) -n-k+1 n-k+1 n-k+1 
</p>
<p>1 
n _ k + 1 (1 + 2 + ... + (k - 1)) 
</p>
<p>k(k - 1) 
</p>
<p>2(n-k+1)' 
</p>
<p>Thus we have these similar upper and lower bounds on the logarithm of 
</p>
<p>the ratio (2.5), and applying the exponential function to both sides, we get 
</p>
<p>the following: 
</p>
<p>k(k-l) n k k(k-l) 
e~ &lt; _&lt; e 2 (n k+l). (29) 
</p>
<p>-n(n-1) .. &middot;(n-k+1) . 
</p>
<p>Does this help to understand the professor's trick in the classroom? Let's 
</p>
<p>apply (2.9) with n = 366 and k = 50; using our calculators, we get that 
</p>
<p>36650 
28.4 &lt; &lt; 47.7. 
</p>
<p>- 366&middot; 364 ... 317 -
</p>
<p>(Using more computation, we can determine that the exact value is 
</p>
<p>33.414. " .) So the probability that all students in the class have differ-
</p>
<p>ent birthdays (which is the reciprocal of this number) is less than 1/28. 
</p>
<p>This means that if the professor performs this trick every year, he will 
</p>
<p>likely fail only once or twice in his career! </p>
<p/>
</div>
<div class="page"><p/>
<p>2.5 The Twin Paradox and the Good Old Logarithm 41 
</p>
<p>Review Exercises 
</p>
<p>2.5.1 What is the following sum? 
</p>
<p>1 1 1 1 
-+-+-+ ... + . 
1&middot;2 2&middot;3 3&middot;4 (n - 1) . n 
</p>
<p>Experiment, conjecture the value, and then prove it by induction. 
</p>
<p>2.5.2 What is the following sum? 
</p>
<p>Experiment, conjecture the value, and then prove it. (Try to prove the result by 
</p>
<p>induction and also by combinatorial arguments.) 
</p>
<p>2.5.3 Prove the following identities: 
</p>
<p>1.2&deg; + 2 . 21 + 3.22 + ... + n . 2n- 1 = (n - 1)2n + 1. 
</p>
<p>n 2 (n + 1)2 
13 + 23 + 33 + ... + n 3 = --'----.,----"-
</p>
<p>4 
</p>
<p>n-1 3n - 1 
1+3+9+27+&middot;&middot;&middot;+3 =-2-' 
</p>
<p>2.5.4 Prove by induction on n that 
</p>
<p>(a) n 2 - 1 is a multiple of 4 if n is odd, 
</p>
<p>(b) n 3 - n is a multiple of 6 for every n. 
</p>
<p>2.5.5 There is a class of 40 girls. There are 18 girls who like to play chess, and 
</p>
<p>23 who like to play soccer. Several of them like biking. The number of those who 
</p>
<p>like to play both chess and soccer is 9. There are 7 girls who like chess and biking, 
</p>
<p>and 12 who like soccer and biking. There are 4 girls who like all three activities. 
</p>
<p>In addition we know that everybody likes at least one of these activities. How 
</p>
<p>many girls like biking? 
</p>
<p>2.5.6 There is a class of all boys. We know that there are a boys who like to 
</p>
<p>play chess, b who like to play soccer, c who like biking and d who like hiking. The 
</p>
<p>number of those who like to play both chess and soccer is x. There are y boys 
</p>
<p>who like chess and biking, z boys who like chess and hiking, U who like soccer 
</p>
<p>and biking, v boys who like soccer and hiking, and finally w boys who like biking 
</p>
<p>and hiking. We don't know how many boys like, e.g.,chess, soccer and hiking, but 
</p>
<p>we know that everybody likes at least one of these activities. We would like to 
</p>
<p>know how many boys are in the class. 
</p>
<p>(a) Show by an example that this is not determined by what we know. 
</p>
<p>(b) Prove that we can at least conclude that the number of boys in the class 
</p>
<p>is at most a + b + c + d, and at least a + b + c + d - x - y - z - U - v - w. </p>
<p/>
</div>
<div class="page"><p/>
<p>42 2. Combinatorial Tools 
</p>
<p>2.5.7 We select 38 even positive integers, all less than 1000. Prove that there 
</p>
<p>will be two of them whose difference is at most 26. 
</p>
<p>2.5.8 A drawer contains 6 pairs of black, 5 pairs of white, 5 pairs of red, and 4 
</p>
<p>pairs of green socks. 
</p>
<p>(a) How many single socks do we have to take out to make sure that we take 
</p>
<p>out two socks with the same color? 
</p>
<p>(b) How many single socks do we have to take out to make sure that we take 
</p>
<p>out two socks with different colors? </p>
<p/>
</div>
<div class="page"><p/>
<p>3 
</p>
<p>Binomial Coefficients and Pascal's 
Triangle 
</p>
<p>3.1 The Binomial Theorem 
</p>
<p>In Chapter 1 we introduced the numbers (~) and called them binomial 
</p>
<p>coefficients. It is time to explain this strange name: it comes from a very 
</p>
<p>important formula in algebra involving them, which we discuss next. 
</p>
<p>The issue is to compute powers of the simple algebraic expression (x+y). 
</p>
<p>We start with small examples: 
</p>
<p>(x + y) 2 = x2 + 2xy + y2, 
(x + y) 3 = (x + y) . (x + y) 2 = (x + y) . (x2 + 2xy + y2) 
</p>
<p>= x3 + 3x2y + 3xy2 + y3, 
</p>
<p>and continuing like this, 
</p>
<p>These coefficients are familiar! We have seen them, e.g., in exercise 1.8.2, 
</p>
<p>as the numbers G). Let us make this observation precise. We illustrate the 
argument for the next value of n, namely n = 5, but it works in general. 
</p>
<p>Think of expanding 
</p>
<p>(X+y)5 = (x+y)(x+y)(x+y)(x+y)(x+y) 
</p>
<p>so that we get rid of all parentheses. We get each term in the expansion by 
</p>
<p>selecting one of the two terms in each factor, and multiplying them. If we </p>
<p/>
</div>
<div class="page"><p/>
<p>44 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>choose x, say, 2 times, then we must choose y 3 times, and so we get x 2 y 3. 
</p>
<p>How many times do we get this same term7 Clearly, as many times as the 
</p>
<p>number of ways to select the three factors that supply y (the remaining 
</p>
<p>factors supply x). Thus we have to choose three factors out of 5, which can 
</p>
<p>be done in m ways. 
Hence the expansion of (x + y)5 looks like this: 
</p>
<p>We can apply this argument in general to obtain the Binomial Theorem: 
</p>
<p>Theorem 3.1.1 (The Binomial Theorem) The coefficient of xn-kyk 
</p>
<p>in the expansion of (x + y)n is (~). In other words, we have the identity 
</p>
<p>This important identity was discovered by the famous Persian poet and 
</p>
<p>mathematician Omar Khayyam (10447-11237). Its name comes from the 
</p>
<p>Greek word binome for an expression consisting of two terms, in this case, 
</p>
<p>x + y. The appearance of the numbers (~) in this theorem is the source of 
their name: binomial coefficients. 
</p>
<p>The Binomial Theorem can be applied in many ways to get identities 
</p>
<p>concerning binomial coefficients. For example, let us substitute x = y = 1. 
Then we get identity (1.9): 
</p>
<p>Later on, we are going to see trickier applications of this idea. For the time 
</p>
<p>being, another twist on it is contained in exercise (3.1.2). 
</p>
<p>3.1.1 Give a proof of the Binomial Theorem by induction, based on (1.8). 
</p>
<p>3.1.2 (a) Prove the identity 
</p>
<p>( ~) -(7) + (~) - (~) + ... = o. 
(The sum ends with (~) = 1, with the sign of the last term depending on 
</p>
<p>the parity of n.) 
</p>
<p>(b) This identity is obvious if n is odd. Why? 
</p>
<p>3.1.3 Prove the identity in Exercise 3.1.2, using a combinatorial interpretation 
</p>
<p>of the positive and negative terms. </p>
<p/>
</div>
<div class="page"><p/>
<p>3.2 Distributing Presents 45 
</p>
<p>3.2 Distributing Presents 
</p>
<p>Suppose we have n different presents, which we want to distribute to k 
</p>
<p>children, where for some reason, we are told how many presents each child 
</p>
<p>should get. So Adam should get nAdam presents, Barbara, nBarbara presents, 
</p>
<p>etc. In a mathematically convenient (though not very friendly) way, we 
</p>
<p>call the children 1,2, ... , k; thus we are given the numbers (nonnegative 
</p>
<p>integers) nI, n2, ... , nk. We assume that nI + n2 + ... + nk = n, else there 
is no way to distribute all the presents and give each child the right number 
</p>
<p>of them. 
</p>
<p>The question is, of course, how many ways can these presents be dis-
</p>
<p>tributed? 
</p>
<p>We can organize the distribution of presents as follows. We layout the 
</p>
<p>presents in a single row of length n. The first child comes and takes the 
</p>
<p>first nI presents, starting from the left. Then the second comes and takes 
</p>
<p>the next n2; then the third takes the next n3 presents etc. Child k gets the 
</p>
<p>last nk presents. 
</p>
<p>It is clear that we can determine who gets what by choosing the order 
</p>
<p>in which the presents are laid out. There are n! ways to order the presents. 
</p>
<p>But of course, the number n! overcounts the number of ways to distribute 
</p>
<p>the presents, since many of these orderings lead to the same results (that 
</p>
<p>is, every child gets the same set of presents). The question is, how many? 
</p>
<p>So let us start with a given distribution of presents, and let's ask the 
</p>
<p>children to layout the presents for us, nicely in a row, starting with the 
</p>
<p>first child, then continuing with the second, third, etc. This way we get back 
</p>
<p>one possible ordering that leads to the current distribution. The first child 
</p>
<p>can layout his presents in nI! possible orders; no matter which order he 
</p>
<p>chooses, the second child can layout her presents in n2! possible ways, etc. 
</p>
<p>So the number of ways the presents can be laid out (given the distribution 
</p>
<p>of the presents to the children) is a product of factorials: 
</p>
<p>Thus the number of ways of distributing the presents is 
</p>
<p>n! 
</p>
<p>3.2.1 We can describe the procedure of distributing the presents as follows. 
First, we select nl presents and give them to the first child. This can be done in 
(:J ways. Then we select n2 presents from the remaining n - nl and give them 
to the second child, etc. 
</p>
<p>Complete this argument and show that it leads to the same result as the 
previous one. 
</p>
<p>3.2.2 The following special cases should be familiar from previous problems and 
theorems. Explain why. </p>
<p/>
</div>
<div class="page"><p/>
<p>46 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>(a) n = k, nl = n2 = ... = nk = 1; 
</p>
<p>(b) nl = n2 = ... = nk-l = 1, nk = n - k + 1; 
(c) k=2; 
</p>
<p>(d) k = 3, n = 6, nl = n2 = n3 = 2. 
</p>
<p>I 1t1 
. ~ 
</p>
<p>l~ 
t1 
</p>
<p>.~ 
tj 
</p>
<p>I~ 
I~ 
</p>
<p>FIGURE 3.1. Placing 8 nonattacking rooks on a chessboard. 
</p>
<p>3.2.3 (a) How many ways can you place n rooks on a chessboard so that no 
</p>
<p>two attack each other (Figure 3.1)? We assume that the rooks are identical, 
</p>
<p>so interchanging two rooks does not count as a separate placement. 
</p>
<p>(b) How many ways can you do this if you have 4 wooden and 4 marble rooks? 
</p>
<p>(c) How many ways can you do this if all the 8 rooks are different? 
</p>
<p>3.3 Anagrams 
</p>
<p>Have you played with anagrams? One selects a word (say, COMBINA-
</p>
<p>TORICS) and tries to compose from its letters meaningful or, even better, 
</p>
<p>funny words or expressions. 
</p>
<p>How many anagrams can you build from a given word? If you try to an-
</p>
<p>swer this question by playing around with the letters, you will realize that 
</p>
<p>the question is badly posed; it is difficult to draw the line between meaning-
</p>
<p>ful and nonmeaningful anagrams. For example, it could easily happen that 
</p>
<p>A CROC BIT SIMON. And it may be true that Napoleon always wanted 
</p>
<p>a TOMB IN CORSICA. It is questionable, but certainly grammatically 
</p>
<p>correct, to assert that COB IS ROMANTIC. Some universities may have 
</p>
<p>a course on MAC IN ROBOTICS. </p>
<p/>
</div>
<div class="page"><p/>
<p>3.3 Anagrams 47 
</p>
<p>But one would have to write a book to introduce an exciting character, 
</p>
<p>ROBIN COSMICAT, who enforces a COSMIC RIOT BAN, while appealing 
</p>
<p>TO COSMIC BRAIN. 
</p>
<p>And it would be terribly difficult to explain an anagram like MTBIRAS-
</p>
<p>CIONOC. 
</p>
<p>To avoid this controversy, let's accept everything; i.e., we don't require 
</p>
<p>the anagram to be meaningful (or even pronounceable). Of course, the 
</p>
<p>production of anagrams then becomes uninteresting; but at least we can 
</p>
<p>tell how many of them there are! 
</p>
<p>3.3.1 How many anagrams can you make from the word COMBINATORICS? 
</p>
<p>3.3.2 Which word gives rise to more anagrams: COMBINATORICS or COM-
</p>
<p>BINATORICA? (The latter is the Latin name of the subject.) 
</p>
<p>3.3.3 Which word with 13 letters gives rise to the most anagrams? Which word 
</p>
<p>gives rise to the least? 
</p>
<p>So let's see the general answer to the question of counting anagrams. If 
</p>
<p>you have solved the problems above, it should be clear that the number of 
</p>
<p>anagrams of an n-Ietter word depends on how many times letters of the 
</p>
<p>word are repeated. So suppose that there are k letters A, B, C, ... Z in the 
</p>
<p>alphabet, and the word contains letter A nl times (this could be 0), letter 
</p>
<p>B, n2 times, etc., letter Z, nk times. Clearly, nl + n2 + ... + nk = n. 
Now, to form an anagram, we have to select nl positions for letter A, n2 
</p>
<p>positions for letter B, etc., nk positions for letter Z. Having formulated it 
</p>
<p>this way, we can see that this is nothing but the question of distributing n 
</p>
<p>presents to k children when it is prescribed how many presents each child 
</p>
<p>gets. Thus we know from the previous section that the answer is 
</p>
<p>n! 
</p>
<p>3.3.4 It is clear that STATUS and LETTER have the same number of anagrams 
</p>
<p>(in fact, 6!/(2!2!) = 180). We say that these words are "essentially the same" (at 
</p>
<p>least as far as counting anagrams goes): They have two letters repeated twice 
</p>
<p>and two letters occurring only once. We call two words "essentially different" , if 
</p>
<p>they are not "essentially the same." 
</p>
<p>(a) How many 6-letter words are there, if, to begin with, we consider any two 
</p>
<p>words different if they are not completely identical? (As before, the words 
</p>
<p>don't have to be meaningful. The alphabet has 26 letters.) 
</p>
<p>(b) How many words with 6 letters are "essentially the same" as the word 
</p>
<p>LETTER? 
</p>
<p>(c) How many "essentially different" 6-letter words are there? 
</p>
<p>(d) Try to find a general answer to question (c) (that is, how many "essentially 
</p>
<p>different" words are there with n letters?). If you can't find the answer, 
</p>
<p>read the following section and return to this exercise afterwards. </p>
<p/>
</div>
<div class="page"><p/>
<p>48 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>000000000000 
, ... ~ ~'---------v~--------~~ 
</p>
<p>Alice Bob Carl Diane 
</p>
<p>FIGURE 3.2. How to distribute n pennies to k children? 
</p>
<p>3.4 Distributing Money 
</p>
<p>Instead of distributing presents, let's distribute money. Let us formulate the 
</p>
<p>question in general: We have n pennies that we want to distribute among 
</p>
<p>k kids. Each child must get at least one penny (and, of course, an integer 
</p>
<p>number of pennies). How many ways can we distribute the money? 
</p>
<p>Before answering this question, we must clarify the difference between 
</p>
<p>distributing money and distributing presents. If you are distributing 
</p>
<p>presents, you have to decide not only how many presents each child gets, 
</p>
<p>but also which of the different presents the child gets. If you are distributing 
</p>
<p>money, only the quantity matters. In other words, presents are distinguish-
</p>
<p>able while pennies are not. (A question like that in section 3.2 where we 
</p>
<p>specify in advance how many presents a given child gets would be trivial 
</p>
<p>for money: There is only one way to distribute n pennies so that the first 
</p>
<p>child gets nl, the second child gets n2, etc.) 
</p>
<p>Even though the problem is quite different from the distribution of 
</p>
<p>presents, we can solve it by imagining a similar distribution method. We 
</p>
<p>line up the pennies (it does not matter in which order; they are all alike), 
</p>
<p>and then let the first child begin to pick them up from left to right. After 
</p>
<p>a while we stop him and let the second child pick up pennies, etc. (Figure 
</p>
<p>3.2). The distribution of the money is determined by specifying where to 
</p>
<p>start with a new child. 
</p>
<p>Now, there are n -1 points (between consecutive pennies) where we can 
</p>
<p>let a new child in, and we have to select k - 1 of them (since the first child 
</p>
<p>always starts at the beginning, we have no choice there). Thus we have to 
</p>
<p>select a (k -I)-element subset from an (n -I)-element set. The number of 
</p>
<p>ways of doing so is (~=~). 
To sum up, we have the following theorem: 
</p>
<p>Theorem 3.4.1 The number of ways to distribute n identical pennies to 
</p>
<p>k children so that each child gets at least one is (~=i). 
</p>
<p>It is quite surprising that the binomial coefficients give the answer here, 
</p>
<p>in a quite nontrivial and unexpected way! 
</p>
<p>Let's also discuss the natural (though unfair) modification of this ques-
</p>
<p>tion, where we also allow distributions in which some children get no money 
</p>
<p>at all; we consider even giving all the money to one child. With the follow-</p>
<p/>
</div>
<div class="page"><p/>
<p>3.5 Pascal's Triangle 49 
</p>
<p>ing trick, we can reduce the problem of counting such distributions to the 
</p>
<p>problem we just solved: We borrow 1 penny from each child, and then dis-
</p>
<p>tribute the whole amount (i.e., n + k pennies) to the children so that each 
child gets at least one penny. This way every child gets back the money we 
</p>
<p>borrowed from him or her, and the lucky ones get some more. The "more" 
</p>
<p>is exactly n pennies distributed to k children. We already know that the 
</p>
<p>number of ways to distribute n + k pennies to k children so that each child 
gets at least one penny is (nt~~l). So we have the next result: 
</p>
<p>Theorem 3.4.2 The number of ways to distribute n identical pennies to 
</p>
<p>k children is (nt~~ 1) . 
</p>
<p>3.4.1 In how many ways can you distribute n pennies to k children if each child 
</p>
<p>is supposed to get at least 2? 
</p>
<p>3.4.2 We distribute n pennies to k boys and &pound; girls in such a way that (to be 
</p>
<p>really unfair) we require that each of the girls gets at least one penny (but we do 
</p>
<p>not insist on the same thing for the boys). In how many ways can we do this? 
</p>
<p>3.4.3 A group of k earls are playing cards. Originally, they each have p pennies. 
</p>
<p>At the end of the game, they count how much money they have. They do not 
</p>
<p>borrow from each other, so that each cannot loose more than his p pennies. How 
</p>
<p>many possible results are there? 
</p>
<p>3.5 Pascal's Triangle 
</p>
<p>To study various properties of binomial coefficients, the following picture is 
</p>
<p>very useful. We arrange all binomial coefficients into a triangular scheme: 
</p>
<p>in the "zeroth" row we put (~); in the first row, we put (6) and (i); in the 
second row, @, G), and m; etc. In general, the nth row contains the num-
bers (~), (~), ... , (~). We shift these rows so that their midpoints match; 
</p>
<p>this way we get a pyramidlike scheme, called Pascal's Triangle (named af-
</p>
<p>ter the French mathematician and philosopher Blaise Pascal, 1623-1662). 
</p>
<p>The figure below shows only a finite piece of Pascal's Triangle. 
</p>
<p>@ 
@ (i) 
</p>
<p>@ (i) m 
@ n (3) (3) 
</p>
<p>@ (4) 
1 4 24 3 (4) 5 (2) 5 U 
</p>
<p>(~) 
5 1 m 4 5 (1) 6 (2) 6 (3) 6 6 (5) 
</p>
<p>(~) m (2) C) (4) (5) (~) </p>
<p/>
</div>
<div class="page"><p/>
<p>50 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>We can replace each binomial coefficient by its numerical value to get 
</p>
<p>another version of Pascal's Triangle (going a little further down, to the 
</p>
<p>eighth row): 
</p>
<p>1 
</p>
<p>1 1 
</p>
<p>1 2 1 
</p>
<p>1 3 3 1 
</p>
<p>1 4 6 4 1 
</p>
<p>1 5 10 10 5 1 
</p>
<p>1 6 15 20 15 6 1 
</p>
<p>1 7 21 35 35 21 7 1 
</p>
<p>1 8 28 56 70 56 28 8 1 
</p>
<p>3.5.1 Prove that Pascal's Triangle is symmetric with respect to the vertical line 
</p>
<p>through its apex. 
</p>
<p>3.5.2 Prove that each row of Pascal's Triangle starts and ends with 1. 
</p>
<p>3.6 Identities in Pascal's Triangle 
</p>
<p>Looking at Pascal's Triangle, it is not hard to notice its most important 
</p>
<p>property: Every number in it (other than the 1 's on the boundary) is the 
</p>
<p>sum of the two numbers immediately above it. This, in fact, is a property of 
</p>
<p>the binomial coefficients we already met, namely, equation (1.8) in Section 
</p>
<p>1.8: 
</p>
<p>(3.2) 
</p>
<p>This property of Pascal's Triangle enables us to generate the triangle 
</p>
<p>very fast, building it up row by row, using (3.2). It also gives us a tool to 
</p>
<p>prove many properties of the binomial coefficients, as we shall see. 
</p>
<p>As a first application, let us give a new solution to exercise 3.1.2. There 
</p>
<p>the task was to prove the identity 
</p>
<p>(~) - (~) + (~) - (~) + ... + (_I)n(~) = 0, (3.3) 
</p>
<p>using the Binomial Theorem. Now we give a proof based on (3.2): We 
</p>
<p>can replace (~) by (n~l) (both are just 1), G) by (n~l) + (n~l), G) by 
(n~ 1) + (n~ 1 ), etc. Thus we get the sum </p>
<p/>
</div>
<div class="page"><p/>
<p>3.6 Identities in Pascal's Triangle 51 
</p>
<p>+ ... +(_l)n-l [(n-1) + (n-1)] +(_1)n(n-1), n-2 n-1 n-1 
which is clearly 0, since the second term in each pair of brackets cancels 
</p>
<p>with the first term in the next pair of brackets. 
</p>
<p>This method gives more than just a new proof of an identity we already 
</p>
<p>know. What do we get if we start the same way, adding and subtracting bi-
</p>
<p>nomial coefficients alternatingly, but stop earlier? Writing this as a formula, 
</p>
<p>we take 
</p>
<p>If we do the same trick as above, we get 
</p>
<p>(n~l) _ [(n~l) + (n~l)] + [(n~l) + (n;l)] _ ... 
</p>
<p>+(_l)k [(~=~) + (n~l)]. 
Here again every term cancels except the last one; so the result is (_l)k(nkl). 
</p>
<p>There are many other surprising relations satisfied by the numbers in 
</p>
<p>Pascal's Triangle. For example, let's ask, what is the sum of the squares of 
</p>
<p>elements in each row? 
</p>
<p>Let's experiment by computing the sum of the squares of elements in the 
</p>
<p>first few rows: 
</p>
<p>12 = 1, 
</p>
<p>12+12=2, 
</p>
<p>12 + 22 + 12 = 6, 
</p>
<p>12 + 32 + 32 + 12 = 20, 
</p>
<p>12 + 42 + 62 + 42 + 12 = 70. 
</p>
<p>We may recognize these numbers as the numbers in the middle column of 
</p>
<p>Pascal's Triangle. Of course, only every second row contains an entry in the 
</p>
<p>middle column, so the last value above, the sum of squares in the fourth 
</p>
<p>row is the middle element in the eighth row. So the examples above suggest 
</p>
<p>the following identity: 
</p>
<p>Of course, the few experiments above do not prove that this identity always 
</p>
<p>holds, so we need a proof. </p>
<p/>
</div>
<div class="page"><p/>
<p>52 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>We will give an interpretation of both sides of the identity as the result 
</p>
<p>of a counting problem; it will turn out that they count the same things, so 
</p>
<p>they are equal. It is obvious what the right-hand side counts: the number 
</p>
<p>of subsets of size n of a set of size 2n. It will be convenient to choose the 
</p>
<p>set S = {I, 2, ... , 2n} as our 2n-element set. 
The combinatorial interpretation of the left-hand side is not so easy. 
</p>
<p>Consider a typical term, say G) 2. We claim that this is the number of 
n-element subsets of {I, 2, ... ,2n} that contain exactly k elements from 
</p>
<p>{I, 2, ... ,n} (the first half of our set S). In fact, how do we choose such 
an n-element subset of S? We choose k elements from {I, 2, ... , n} and 
</p>
<p>then n - k elements from {n + 1, n + 2, ... ,2n}. The first can be done in 
(~) ways; no matter which k-element subset of {I, 2, ... ,n} we selected, 
</p>
<p>we have (n~k) ways to choose the other part. Thus the number of ways to 
</p>
<p>choose an n-element subset of Shaving k elements from {I, 2, ... ,n} is 
</p>
<p>(by the symmetry of Pascal's Triangle). 
</p>
<p>Now, to get the total number of n-element subsets of S, we have to sum 
</p>
<p>these numbers for all values of k = 0,1, ... , n. This proves identity (3.4). 
</p>
<p>3.6.1 Give a proof of the formula (1.9), 
</p>
<p>along the lines of the proof of (3.3). (One could expect that, as with the "al-
</p>
<p>ternating" sum, we could get a nice formula for the sum obtained by stopping 
</p>
<p>earlier, like (~) + G) + ... + G). But this is not the case: No simpler expression 
is known for this sum in general.) 
</p>
<p>3.6.2 By the Binomial Theorem, the right-hand side in identity (3.4) is the 
</p>
<p>coefficient of xnyn in the expansion of (x + y)2n. Write (x + y?n in the form 
(x + y) n (x + y) n, expand both factors (x + y) n using the Binomial Theorem, and 
then try to figure out the coefficient of xnyn in the product. Show that this gives 
</p>
<p>another proof of identity (3.4). 
</p>
<p>3.6.3 Prove the following identity: 
</p>
<p>( ~ ) ( ~ ) + (7) (k : 1) + ... + (k: 1) (7) + (~) ( ;) = (n: m) . 
You can use a combinatorial interpretation of both sides, as in the proof of (3.4) 
</p>
<p>above, or the Binomial Theorem as in the previous exercise. </p>
<p/>
</div>
<div class="page"><p/>
<p>3.6 Identities in Pascal's Triangle 53 
</p>
<p>Here is another relation between the numbers in Pascal's Triangle. Let us 
</p>
<p>start with the first element in the nth row, and sum the elements moving 
</p>
<p>down diagonally to the right (Figure 3.3). For example, starting with the 
</p>
<p>first element in the second row, we get 
</p>
<p>1 = 1, 
1 + 3 = 4, 
</p>
<p>1 + 3 + 6 = 10, 
1 + 3 + 6 + 10 = 20, 
</p>
<p>1 + 3 + 6 + 10 + 15 = 35. 
</p>
<p>These numbers are just the numbers in the next skew line of the table! 
</p>
<p>1 
</p>
<p>1 1 
</p>
<p>1 2 1 
</p>
<p>1 3 3 1 
</p>
<p>1 4 6 4 1 
</p>
<p>1 5 10 10 5 1 
</p>
<p>1 6 15 20 15 6 1 
</p>
<p>1 7 21 35 35 21 7 1 
</p>
<p>1 8 28 56 70 1561 28 8 1 
</p>
<p>FIGURE 3.3. Adding up entries in Pascal's Triangle diagonally. 
</p>
<p>If we want to put this in a formula, we get 
</p>
<p>(~) + (n;l) + (n;2) + ... + (n;k) = (n+~+l). (3.5) 
To prove this identity, we use induction on k. If k = 0, the identity just 
</p>
<p>says that 1 = 1, so it is trivially true. (We can check it also for k = 1, even 
though this is not necessary. Anyway, it says that 1 + (n + 1) = n + 2.) 
</p>
<p>So suppose that the identity (3.5) is true for a given value of k, and we 
</p>
<p>want to prove that it also holds for k + 1 in place of k. In other words, we 
want to prove that 
</p>
<p>(~)+(n;1)+(n;2)+ ... +(n;k)+(n;~;1) = (n;~;2). 
Here the sum of the first k terms on the left-hand side is (n+z+ 1) by the 
induction hypothesis, and so the left-hand side is equal to 
</p>
<p>(n+~+l) + (n;~;l). 
</p>
<p>But this is indeed equal to (nt!t2) by the fundamental property (3.2) of 
Pascal's Triangle. This completes the proof by induction. </p>
<p/>
</div>
<div class="page"><p/>
<p>54 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>3.6.4 Suppose that you want to choose a (k+l)-element subset of the (n+k+l)-
</p>
<p>element set {I, 2, ... , n + k + I}. You decide to do this by choosing first the largest 
</p>
<p>element, then the rest. Show that counting the number of ways to choose the 
</p>
<p>subset this way, you get a combinatorial proof of identity (3.5). 
</p>
<p>3.7 A Bird's-Eye View of Pascal's Triangle 
</p>
<p>Let's imagine that we are looking at Pascal's Triangle from a distance. Or 
</p>
<p>to put it differently, we are not interested in the exact numerical values 
</p>
<p>of the entries, but rather in their order of magnitude, rise and fall, and 
</p>
<p>other global properties. The first such property of Pascal's Triangle is its 
</p>
<p>symmetry (with respect to the vertical line through its apex), which we 
</p>
<p>already know. 
</p>
<p>Another property one observes is that along any row, the entries increase 
</p>
<p>until the middle, and then decrease. If n is even, there is a unique middle 
</p>
<p>element in the nth row, and this is the largest; if n is odd, then there are 
</p>
<p>two equal middle elements, which are largest. 
</p>
<p>So let us prove that the entries increase until the middle (then they 
</p>
<p>begin to decrease by the symmetry of the table). We want to compare two 
</p>
<p>consecutive entries: 
</p>
<p>If we use the formula in Theorem 1.8.1, we can write this as 
</p>
<p>n(n-1).&middot;.(n-k+1)? n(n-1)&middot; .. (n-k) 
</p>
<p>k(k-1)&middot;&middot;&middot;1 . (k+1)k&middot;&middot;&middot;1 
</p>
<p>There are many common factors on both sides that are positive, and so we 
</p>
<p>can simplify. We get the really simple comparison 
</p>
<p>Rearranging, we get 
</p>
<p>n-k 
1 ?--
</p>
<p>. k+ l' 
</p>
<p>k?n-1. 
2 
</p>
<p>So if k &lt; (n-1) /2, then (~) &lt; (k~l); if k = (n-1) /2, then G) = (k~l) (this 
is the case ofthe two entries in the middle if n is odd); and if k &gt; (n -1) /2, 
then (~) &gt; (k~l)' 
</p>
<p>It will be useful later that this computation also describes by how much 
</p>
<p>consecutive elements increase or decrease. If we start from the left, the 
</p>
<p>second entry (namely, n) is larger by a factor of n than the first; the third 
</p>
<p>(namely, n(n - 1)/2) is larger by a factor of (n - 1)/2 than the second. In 
general, 
</p>
<p>n-k 
</p>
<p>k+1 
(3.6) </p>
<p/>
</div>
<div class="page"><p/>
<p>3.7 A Bird's-Eye View of Pascal's Triangle 55 
</p>
<p>3.7.1 For which values of nand k is (k~l) twice the previous entry in Pascal's 
</p>
<p>Triangle? 
</p>
<p>3.7.2 Instead of the ratio, look at the difference of two consecutive entries in 
</p>
<p>Pascal's Triangle: 
</p>
<p>For which value of k is this difference largest? 
</p>
<p>We know that each row of Pascal's Triangle is symmetric. We also know 
</p>
<p>that the entries start with 1, rise to the middle, and then fall back to 1. 
</p>
<p>Can we say more about their shape? 
</p>
<p>250 -
</p>
<p>- -
200 
</p>
<p>150 
</p>
<p>-
100 
</p>
<p>50 
</p>
<p>Ir-I 
0 2 4 6 8 10 
</p>
<p>o 20 40 60 80 100 
</p>
<p>FIGURE 3.4. Bar chart of the nth row of Pascal's Triangle, for n = 10 and 
</p>
<p>n = 100. 
</p>
<p>Figure 3.4 shows the graph of the numbers (~) (k = 0,1, ... , n) for the 
values n = 10 and n = 100. We can make several further observations. 
</p>
<p>First, the largest number gets very large. 
</p>
<p>Second, not only do these numbers increase to the middle and then 
</p>
<p>decrease, but the middle ones are substantially larger than those at 
</p>
<p>the beginning and end. For n = 100, we see bars only in the range 
C20S0), C2060), ... , C~SO); the numbers outside this range are so small 
compared to the largest that they do not show in the figure. 
</p>
<p>Third, we can observe that the shape of the graph is quite similar for 
</p>
<p>different values of n. 
</p>
<p>Let's look more carefully at these observations. For the discussions that 
</p>
<p>follow, we shall assume that n is even (for odd values of n, the results would 
</p>
<p>be quite similar, except that one would have to word them differently). If </p>
<p/>
</div>
<div class="page"><p/>
<p>56 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>n is even, then we already know that the largest entry in the nth row is 
</p>
<p>the middle number (n/2)' and all other entries are smaller. 
How large is the largest number in the nth row of Pascal's Triangle? We 
</p>
<p>know immediately an upper bound on this number: 
</p>
<p>since 2n is the sum of all entries in the row. It only takes a little more 
</p>
<p>sophistication to get a lower bound: 
</p>
<p>( n ) 2
n 
</p>
<p>n/2 &gt; n + l' 
</p>
<p>since 2n /(n + 1) is the average of the numbers in the row, and the largest 
number is certainly at least as large as the average. 
</p>
<p>These bounds already give a pretty good idea about the size of (n/2); in 
particular, they show that this number gets very large. Take, say, n = 500. 
Then we get 
</p>
<p>__ &lt; &lt; 2500 2500 (500) 
501 250 . 
</p>
<p>If we want to know the number of digits of (~~~), we just have to take the 
</p>
<p>logarithm (in base 10) of it. From the bounds above, we get 
</p>
<p>( 500) 500 19 2-lg 501 = 147.8151601 ... &lt; 19 250 &lt; 500 19 2 = 150.5149978 .... 
</p>
<p>This inequality gives the number of digits with a small error: If we guess 
</p>
<p>that it is 150, then we are off by at most 2 (actually, 150 is the true value). 
</p>
<p>Using Stirling's formula (Theorem 2.2.1), one can get an even better 
</p>
<p>approximation of this largest entry. We know that 
</p>
<p>Here, by the Stirling's formula, 
</p>
<p>( n ) n/2 (n/2)! ",,;;n 2e ' 
</p>
<p>and so 
</p>
<p>( n ) '" ~(;)n = [2:2n 
n/2 7rn (;~r V;;;&middot; (3.7) 
</p>
<p>SO we know that the largest entry in the nth row of Pascal's Triangle is 
</p>
<p>in the middle, and we know approximately how large this element is. We 
</p>
<p>also know that going either left or right, the elements begin to drop. How </p>
<p/>
</div>
<div class="page"><p/>
<p>3.8 An Eagle's-Eye View: Fine Details 57 
</p>
<p>fast do they drop? Figure 3.4 suggests that starting from the middle, the 
</p>
<p>binomial coefficients drop just by a little at the beginning, but pretty soon 
</p>
<p>this accelerates. 
</p>
<p>Looking from the other end, we see this even more clearly. Let us consider, 
</p>
<p>say, row 57 (just to take a non-round number for a change). The first few 
</p>
<p>elements are 
</p>
<p>1, 57, 1596, 29260, 395010, 4187106, 36288252, 264385836, 1652411475, 
</p>
<p>8996462475, 43183019880, 184509266760, 707285522580, ... 
</p>
<p>and the ratios between consecutive entries are: 
</p>
<p>57, 28, 18.33, 13.5, 10.6, 8.67, 7.29, 6.25, 5.44, 4.8, 4.27, 3.83, ... 
</p>
<p>While the entries are growing fast, these ratios get smaller and smaller, 
</p>
<p>and we know that when we reach the middle, they have to turn less than 1 
</p>
<p>(since the entries themselves begin to decrease). But what are these ratios? 
</p>
<p>We computed them above, and found that 
</p>
<p>If we write this as 
</p>
<p>n-k 
</p>
<p>k+1 
</p>
<p>n-k_n+11 
k+1 - k+1 - , 
</p>
<p>then we see immediately that the ratio of two consecutive binomial coeffi-
</p>
<p>cients decreases as k increases. 
</p>
<p>3.8 An Eagle's-Eye View: Fine Details 
</p>
<p>Let us ask a more quantitative question about the shape of a row in Pascal's 
</p>
<p>Triangle: Which binomial coefficient in this row is (for example) half of the 
</p>
<p>largest? 
</p>
<p>We consider the case where n is even; then we can write n = 2m, where 
m is a positive integer. The largest, middle entry in the nth row is (2:). 
Consider the binomial coefficient that is t steps from the middle. It does 
</p>
<p>not matter whether we go left or right, so take, say, (~:t). We want to 
</p>
<p>compare it with the largest coefficient. 
</p>
<p>The following formula describes the rate at which the binomial coeffi-
</p>
<p>cients drop: 
</p>
<p>(3.8) 
</p>
<p>The graph ofright-hand side of (3.8) (as a function oft) is shown in Figure 
</p>
<p>3.5 for m = 50. This is the famous Gauss curve (sometimes also called the </p>
<p/>
</div>
<div class="page"><p/>
<p>58 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>o 20 40 60 80 100 0 20 80 100 
</p>
<p>FIGURE 3.5. The Gauss curve e- t2/m for m = 50, and the chart of binomial 
</p>
<p>coefficients in the 100th row of Pascal's Triangle. 
</p>
<p>"bell curve"). Plotting many types of statistics gives a similar picture. In 
</p>
<p>Figure 3.5 we show the curve alone and also overlaid with the binomial 
</p>
<p>coefficients, to show the excellent fit. 
</p>
<p>Equation (3.8) is not an exact equation, and to make it a precise math-
</p>
<p>ematical statement, we need to tell how large the error can be. Below, we 
</p>
<p>shall derive the following inequalities: 
</p>
<p>The upper and lower bounds in this formula are quite similar to the 
</p>
<p>(imprecise) approximation e- t2/m given in (3.8), and it is easy to see that 
</p>
<p>the latter value is between them. The right hand side of (3.8) in fact gives 
</p>
<p>a better approximation than either the upper or the lower bound. For 
</p>
<p>example, suppose that we want to estimate the ratio C4000) / C5000) , which is 
0.1362 .... From (3.9) we get 
</p>
<p>0.08724:::: C~OO) / C5000) :::: 0.1889, 
while the approximation given in (3.8) is 0.1353 ... , much closer to the 
</p>
<p>truth. Using heavier calculus (analysis) would give tighter bounds; we give 
</p>
<p>here only as much as we can without appealing to calculus. 
</p>
<p>To derive (3.9), we start with transforming the ratio in the middle; or 
</p>
<p>rather, we take its reciprocal, which is larger than 1 and therefore a bit 
</p>
<p>easier to work with: 
</p>
<p>( 2m) / ( 2m ) = (2m)! / (2m)! = (m - t)!(m + t)! 
m m - t mimi (m - t)!(m + t)! mimi 
</p>
<p>(m + t)(m + t - 1) ... (m + 1) 
m(m-l)&middot;&middot;&middot;(m-t+l) </p>
<p/>
</div>
<div class="page"><p/>
<p>3.8 An Eagle's-Eye View: Fine Details 59 
</p>
<p>So we have some sort of a formula for this ratio, but how useful is it? How 
</p>
<p>do we tell, for example, for which value of t this ratio becomes larger than 
</p>
<p>2? We can certainly write this as a formula: 
</p>
<p>(m + t)(m + t - 1) .. &middot; (m + 1) 
m(m-1) ... (m-t+1) &gt;2. 
</p>
<p>(3.10) 
</p>
<p>We could try to solve this inequality for t (similar to the proof that the 
</p>
<p>entries are increasing to the middle), but it would be too complicated to 
</p>
<p>solve. So even to answer such a simple question about binomial coefficients 
</p>
<p>like, how far from the middle do they drop to half of the maximum? needs 
</p>
<p>more work, and we have to do some arithmetic trickery. We divide the first 
</p>
<p>factor of the numerator by the first factor of the denominator, the second 
</p>
<p>factor by the second factor etc., to get 
</p>
<p>m+t m+t-1 
</p>
<p>m m-1 
</p>
<p>m+1 
</p>
<p>m-t+ 1 
</p>
<p>This product is still not easy to handle, but we have met similar ones in 
</p>
<p>Section 2.5! There the trick was to take the logarithm, and this works here 
</p>
<p>just as well. We get 
</p>
<p>In -- +In + .. &middot;+In . ( m+t) (m+t-1) ( m+1 ) 
m m-1 m-t+1 
</p>
<p>Just as in Section 2.5, we can estimate the logarithms on the left-hand side 
</p>
<p>using the inequalities in Lemma 2.5.1. Let's start with deriving an upper 
</p>
<p>bound. For a typical term in the sum we have 
</p>
<p>and so 
</p>
<p>n &lt; -1=--I (
m+t-k) m+t-k t 
m-k - m-k m-k' 
</p>
<p>In (_m+_t) +In(m+t-1) + ... +In( m+1 ) 
m m-1 m-t+1 
</p>
<p>t t t 
&lt;-+--+ ... +-----,-
-m m-1 m-t+1 
</p>
<p>Can we bring this sum into a closed form? No, but we can use another trick 
</p>
<p>from section 2.5. We replace each denominator by m - t + 1, since this is 
</p>
<p>the smallest; then we increase all the fractions (except the last one, which 
</p>
<p>we don't change) and get an upper bound: 
</p>
<p>t t t t t t 
-+--+ ... + &lt; + + ... +---
m m-1 m-t+l- m-t+l m-t+l m-t+l 
</p>
<p>t 2 
</p>
<p>m-t+ 1 </p>
<p/>
</div>
<div class="page"><p/>
<p>60 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>Remember, this is an upper bound on the logarithm of the ratio 
</p>
<p>(;;:) / (~11lt) ; to get an upper bound on the ratio itself, we have to ap-
ply the exponential function. Then we have another step to undo: we have 
</p>
<p>to take the reciprocal, to get the lower bound in (3.9). 
</p>
<p>The upper bound in (3.9) can be derived using similar steps; the details 
</p>
<p>are left to the reader as an exercise 3.8.2. 
</p>
<p>Let us return to our earlier question: We want to know when (for which 
</p>
<p>value of t) the quotient in (3.9) will be larger than 2. We might need 
similar information for other numbers instead of 2, so let's try to answer 
</p>
<p>the question for a general number C &gt; 1. Thus we want to know for which 
value of t we get 
</p>
<p>(3.11) 
</p>
<p>From (3.8) we know that the left-hand side is about et2 1m , so we start with 
</p>
<p>solving the equation 
</p>
<p>The exponential function on the left looks nasty, but the good old logarithm 
</p>
<p>helps again: We get 
</p>
<p>which is now easy to solve: 
</p>
<p>t 2 
- = InC, 
m 
</p>
<p>t = VmlnC. 
</p>
<p>So we expect that if t is larger than this, than (3.11) holds. But of course 
</p>
<p>we have to be aware of the fact that this is only an approximation, not a 
</p>
<p>precise result! Instead of (3.8), we can use the exact inequalities (3.9) to 
</p>
<p>get the following lemma: 
</p>
<p>Lemma 3.8.1 1ft ~ vmlnC + InC, then (3.11) holds; ift ~ vmlnC-
InC, then (3.11) does not hold. 
</p>
<p>The derivation of these conditions from (3.9) is similar to the derivation 
</p>
<p>of the approximate result from (3.8) and is left to the reader as exercise 
</p>
<p>3.8.3 (difficult!). 
</p>
<p>In important applications of binomial coefficients (one of which, the law 
</p>
<p>of large numbers, will be discussed in Chapter 5) we also need to know 
</p>
<p>a good bound on the sum of the smallest binomial coefficients, compared 
</p>
<p>with the sum of all of them. Luckily, our previous observations and lemmas 
</p>
<p>enable us to get an answer with some computation but without substantial 
</p>
<p>new ideas. </p>
<p/>
</div>
<div class="page"><p/>
<p>3.8 An Eagle's-Eye View: Fine Details 61 
</p>
<p>Lemma 3.8.2 Let 0 :::; k :::; m and c = (2;;) / (2:). Then 
</p>
<p>(2m) (2m) ( 2m) c 2m o + 1 + ... + k-1 &lt;"2. 2 . (3.12) 
To digest the meaning of this, choose m = 500, and let's try to see how 
</p>
<p>many binomial coefficients in the 1000th row we have to add up (starting 
</p>
<p>with eogO)) to reach 0.5% of the total. Lemma 3.8.2 tells us that if we 
choose 0 :::; k :::; 500 so that eO~O) / e500000) &lt; 1/100, then adding up the 
first k binomial coefficients gives a sum less than 0.5% of the total. In 
turn, Lemma 3.8.1 tells us a k that will be certainly good: any k :::; 500-
</p>
<p>J500 In 100 - In 100 = 447.4. So the first 447 entries in the 1000th row of 
Pascal's Triangle make up less than 0.5% of the total sum. By the symmetry 
</p>
<p>of Pascal's Triangle, the last 447 add up to another less than 0.5%. The 
</p>
<p>middle 107 terms account for 99% of the total. 
</p>
<p>Proof. To prove this lemma, let us write k = m - t, and compare the sum 
on the left-hand side of (3.12) with the sum 
</p>
<p>(3.13) 
</p>
<p>Let us denote the sum e;;) + (2~) + ... + (m~7-1) by A, and the sum 
(~~t) + (m~7+1) + ... + (~~l) by B. 
</p>
<p>We have 
</p>
<p>by the definition of c. This implies that 
</p>
<p>since we know that binomial coefficients drop by a larger factor from (~~t) 
</p>
<p>to (m~7-1) than they do from e:) to (~~l)' Repeating the same argu-
ment, l we get that 
</p>
<p>for every i 2': O. 
Hence it follows that the sum of any t consecutive binomial coefficients 
</p>
<p>is less than c times the sum of the next t (as long as these are all on the left 
</p>
<p>hand side of Pascal's Triangle). Going back from (~~l)' the first block of t 
binomial coefficients adds up to A (by the definition of A); the next block 
</p>
<p>1 In other words, using induction. </p>
<p/>
</div>
<div class="page"><p/>
<p>62 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>of t adds up to less than cA, the next block to less than c2 A, etc. Adding 
</p>
<p>up, we get that 
</p>
<p>B &lt; cA + c2 A + c3 A ... 
</p>
<p>On the right-hand side we only have to sum i(m - t)/tl terms, but we are 
generous and let the summation run to infinity! The geometric series on 
</p>
<p>the right-hand side adds up to l':'cA, so we get that 
</p>
<p>c 
B&lt; --A. 
</p>
<p>l-c 
</p>
<p>We need another inequality involving A and B, but this is easy: 
</p>
<p>1 
B +A &lt; _22m 
</p>
<p>2 
</p>
<p>(since the sum on the left-hand side includes only the left-hand side of 
</p>
<p>Pascal's Triangle, and the middle element is not even counted). From these 
</p>
<p>two inequalities we get 
</p>
<p>B&lt; --A &lt; -- -2 -B c c (12m ) 
l-c l-c 2 ' 
</p>
<p>and hence 
</p>
<p>1 + -- B &lt; ---2 . ( c) c 1 2m 
l-c l-c2 
</p>
<p>Multiplying by 1 - c gives that B &lt; c~22m, which proves the lemma. D 
</p>
<p>3.8.1 (a) Check that the approximation in (3.8) is always between the lower 
</p>
<p>and upper bounds given in (3.9). 
</p>
<p>(b) Let 2m = 100 and t = 10. By what percentage is the upper bound in (3.9) 
larger than the lower bound? 
</p>
<p>3.8.2 Prove the upper bound in (3.9). 
</p>
<p>3.8.3 Complete the proof of Lemma 3.8.1. 
</p>
<p>Review Exercises 
</p>
<p>3.8.4 FiYlQ all values of nand k for which C~l) = 3(~). 
</p>
<p>3.8.5 Find the value of k for which k (9;) is largest. </p>
<p/>
</div>
<div class="page"><p/>
<p>3.8 An Eagle's-Eye View: Fine Details 63 
</p>
<p>3.8.6 In city with a regular "chessboard" street plan, the North-South streets 
</p>
<p>are called 1st Street, 2nd Street, ... ,20th Street, and the East-West streets are 
</p>
<p>called 1st Avenue, 2nd Avenue, ... , 10th Avenue. What is the minimum number 
</p>
<p>of blocks you have to walk to get from the corner of 1st Street and 1st Avenue 
</p>
<p>to the corner of 20th Street and 10th Avenue? In how many ways can you get 
</p>
<p>there walking this minimum number of blocks? 
</p>
<p>3.8.7 In how many ways can you read off the word MATHEMATICS from the 
</p>
<p>following tables: 
</p>
<p>M A T H E M M A T H 
</p>
<p>A T H E M A A T H E 
</p>
<p>T H E M A T T H M A 
</p>
<p>H E M A T I H E A T I 
</p>
<p>E M A T I C M A T I C 
M A T I C S I C S 
</p>
<p>3.8.8 Prove the following identities: 
</p>
<p>~(_I)k(~) = (_I)m(n:I} 
</p>
<p>~(~)(~) (:)2n~m. 
</p>
<p>3.8.9 Prove the following inequalities: 
</p>
<p>nk (n) 
kk ~ k 
</p>
<p>k 
&lt;~. 
- k! 
</p>
<p>3.8.10 In how many ways can you distribute n pennies to k children if each 
</p>
<p>child is supposed to get at least 5? 
</p>
<p>3.8.11 Prove that if we move straight down in Pascal's Triangle (visiting every 
</p>
<p>other row), then the numbers we see are increasing. 
</p>
<p>3.8.12 Prove that 
</p>
<p>1 + (7) 2 + (;) 4 + ... + (n: 1) 2n~1 + (~) 2n = 3n. 
Try to find a combinatorial proof. 
</p>
<p>3.8.13 Suppose that you want to choose a (2k + I)-element subset of the n-
element set {I, 2, ... , n}. You decide to do this by choosing first the middle ele-
ment, then the k elements to its left, then the k elements to its right. Formulate 
</p>
<p>the combinatorial identity you get from this. </p>
<p/>
</div>
<div class="page"><p/>
<p>64 3. Binomial Coefficients and Pascal's Triangle 
</p>
<p>3.8.14 Let n be a positive integer divisible by 3. Use Stirling's formula to find 
</p>
<p>the approximate value of (n/3)' 
</p>
<p>3.8.15 Prove that (~) cv ~~~ &bull; </p>
<p/>
</div>
<div class="page"><p/>
<p>4 
</p>
<p>Fibonacci Numbers 
</p>
<p>4.1 Fibonacci's Exercise 
</p>
<p>In the thirteenth century, the Italian mathematician Leonardo Fibonacci 
</p>
<p>studied the following (not too realistic) question: 
</p>
<p>Leonardo Fibonacci 
</p>
<p>A farmer raises rabbits. Each rab-
</p>
<p>bit gives birth to one rabbit when 
</p>
<p>it turns 2 months old, and then to 
</p>
<p>one rabbit each month thereafter. 
</p>
<p>Rabbits never die, and we ignore 
</p>
<p>male rabbits. How many rabbits 
</p>
<p>will the farmer have in the nth 
</p>
<p>month if he starts with one new-
</p>
<p>born rabbit? 
</p>
<p>It is easy to figure out the answer for small values of n. The farmer 
</p>
<p>has 1 rabbit in the first month and 1 rabbit in the second month, since 
</p>
<p>the rabbit has to be 2 months old before starting to reproduce. He has 2 
</p>
<p>rabbits during the third month, and 3 rabbits during the fourth, since his 
</p>
<p>first rabbit delivered a new one after the second and one after the third. 
</p>
<p>After 4 months, the second rabbit also delivers a new rabbit, so two new </p>
<p/>
</div>
<div class="page"><p/>
<p>66 4. Fibonacci Numbers 
</p>
<p>rabbits are added. This means that the farmer will have 5 rabbits during 
</p>
<p>the fifth month. 
</p>
<p>It is easy to follow the multiplication of rabbits for any number of months 
</p>
<p>if we notice that the number of new rabbits added each months is just the 
</p>
<p>same as the number ofrabbits who are at least 2 months old, i.e., who were 
</p>
<p>already there in the previous month. In other words, to get the number of 
</p>
<p>rabbits in the next month, we have to add the number of rabbits in the 
</p>
<p>previous month to the number of rabbits in the current month. This makes 
</p>
<p>it easy to compute the numbers one by one: 
</p>
<p>1, 1, 1 + 1 = 2, 2 + 1 = 3, 3 + 2 = 5, 5 + 3 = 8, 8 + 5 = 13, ... 
</p>
<p>(It is quite likely that Fibonacci did not get his question as a real ap-
plied math problem; he played with numbers, noticed that this procedure 
</p>
<p>gives numbers that were new to him but nevertheless had very interesting 
</p>
<p>properties~as we'll see ourselves~and then tried to think of an "applica-
</p>
<p>tion." ) 
</p>
<p>To write this as a formula, let us denote by Fn the number of rabbits 
</p>
<p>during the nth month. Then we have, for n = 2,3,4, ... , 
</p>
<p>(4.1) 
</p>
<p>We also know that Fl = 1, F2 = 1, F3 = 2, F4 = 3, F5 = 5. It is convenient 
to define Fa = 0; then equation (4.1) will remain valid for n = 1 as well. 
Using equation (4.1), we can easily determine any number of terms in this 
</p>
<p>sequence of numbers: 
</p>
<p>0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89, 144, 233, 377, 610, 987, 1597, ... 
</p>
<p>The numbers in this sequence are called Fibonacci numbers. 
</p>
<p>We see that equation (4.1), together with the special values Fa = 0 and 
Fl = 1, uniquely determines the Fibonacci numbers. Thus we can consider 
(4.1), together with Fa = 0 and Fl = 1, as the definition of these numbers. 
This may seem a somewhat unusual definition: Instead of telling what Fn 
</p>
<p>is (say, by a formula), we just give a rule that computes each Fibonacci 
</p>
<p>number from the two previous numbers, and specify the first two values. 
</p>
<p>Such a definition is called a recurrence. It is quite similar to induction in 
</p>
<p>spirit (except that it is not a proof technique, but a definition method), 
</p>
<p>and is sometimes also called definition by induction. 
</p>
<p>4.1.1 Why do we have to specify exactly two of the elements to begin with? 
</p>
<p>Why not one or three? 
</p>
<p>Before trying to say more about these numbers, let us consider another 
</p>
<p>counting problem: 
</p>
<p>A staircase has n steps. You walk up taking one or two at a 
</p>
<p>time. How many ways can you go up? </p>
<p/>
</div>
<div class="page"><p/>
<p>4.1 Fibonacci's Exercise 67 
</p>
<p>For n = 1, there is only 1 way. For n = 2, you have 2 choices: take one 
step twice or two once. For n = 3, you have 3 choices: three single steps, 
or one single followed by one double, or one double followed by one single. 
</p>
<p>Now stop and try to guess what the answer is in general! If you guessed 
</p>
<p>that the number of ways to go up on a stair with n steps is n, you are 
</p>
<p>wrong. The next case, n = 4, gives 5 possibilities (1 + 1 + 1 + 1, 2 + 1 + 1, 
1 + 2 + 1, 1 + 1 + 2, 2 + 2). 
</p>
<p>So instead of guessing, let's try the following strategy. Let's denote by 
</p>
<p>I n the answer. We try to figure out what I n +1 is, assuming we know the 
value of Jk for 1 ::; k ::; n. If we start with a single step, we have I n ways to 
</p>
<p>go up the remaining n steps. If we start with a double step, we have I n - 1 
ways to go up the remaining n - 1 steps. These are all the possibilities, and 
so 
</p>
<p>I n+1 = I n + I n- 1 . 
</p>
<p>This equation is the same as the equation we have used to compute the 
</p>
<p>Fibonacci numbers Fn. Does this means that Fn = I n? Of course not, as 
we see by looking at the beginning values: for example, F3 = 2 but J3 = 3. 
However, it is easy to observe that all that happens is that the I n are 
</p>
<p>shifted by one: 
</p>
<p>I n = Fn +1 . 
</p>
<p>This is valid for n = 1,2, and then of course it is valid for every n, since 
the sequences F2 , F3 , F4 , . .. and J1 , J2 , h, . .. are computed by the same 
rule from their first two elements. 
</p>
<p>4.1.2 We have n dollars to spend. Every day we buy either a candy for 1 dollar 
</p>
<p>or an ice cream for 2 dollars. In how many ways can we spend the money? 
</p>
<p>4.1.3 How many subsets does the set {I, 2, ... ,n} have that contain no two 
consecutive integers? </p>
<p/>
</div>
<div class="page"><p/>
<p>68 4. Fibonacci Numbers 
</p>
<p>4.2 Lots of Identities 
</p>
<p>There are many interesting relations valid for the Fibonacci numbers. For 
</p>
<p>example, what is the sum of the first n Fibonacci numbers? We have 
</p>
<p>0=0, 
</p>
<p>0+1 = 1, 
</p>
<p>0+ 1 + 1 = 2, 
</p>
<p>0+ 1 + 1 + 2 = 4, 
</p>
<p>0+ 1 + 1 + 2 + 3 = 7, 
</p>
<p>o + 1 + 1 + 2 + 3 + 5 = 12, 
o + 1 + 1 + 2 + 3 + 5 + 8 = 20, 
</p>
<p>o + 1 + 1 + 2 + 3 + 5 + 8 + 13 = 33. 
</p>
<p>Staring at these numbers for a while, it is not hard to recognize that by 
</p>
<p>adding 1 to the right-hand sides we get Fibonacci numbers; in fact, we get 
</p>
<p>Fibonacci numbers two steps after the last summand. As a formula, we 
</p>
<p>have 
</p>
<p>Of course, at this point this is only a conjecture, an unproven mathematical 
</p>
<p>statement we believe to be true. To prove it, we use induction on n (since 
</p>
<p>the Fibonacci numbers are defined by recurrence, induction is the natural 
</p>
<p>and often only proof method at hand). 
</p>
<p>We have already checked the validity of the statement for n = 0 and 1. 
Suppose that we know that the identity holds for the sum of the first n - 1 
Fibonacci numbers. Consider the sum of the first n Fibonacci numbers: 
</p>
<p>Fo + Fl + ... + Fn = (Fo + Fl + ... + Fn-d + Fn = (Fn+l - 1) + Fn , 
</p>
<p>by the induction hypothesis. But now we can use the recurrence equation 
</p>
<p>for the Fibonacci numbers to get 
</p>
<p>(Fn+l - 1) + Fn = Fn+2 - 1. 
</p>
<p>This completes the induction proof. 
</p>
<p>4.2.1 Prove that F3n is even. 
</p>
<p>4.2.2 Prove that F5n is divisible by 5. 
</p>
<p>4.2.3 Prove the following identities. 
</p>
<p>(a) H + F3 + F5 + ... + F2n - 1 = F2n . 
</p>
<p>(b) Fo - FI + F2 - F3 + ... - F2n- 1 + F2n = F2n- 1 - 1. </p>
<p/>
</div>
<div class="page"><p/>
<p>4.2 Lots of Identities 69 
</p>
<p>(c) Fg + Ft + Fi + ... + F~ = Fn&middot; Fn+1. 
(d) Fn- 1Fn+1 - F~ = (_l)n. 
</p>
<p>4.2.4 We want to extend the Fibonacci numbers in the other direction; i.e., we 
</p>
<p>want to define Fn for negative values of n. We want to do this so that the basic 
</p>
<p>recurrence (4.1) remain valid. So from F-1 + Fo = F1 we get F-1 = 1; then 
from F -2 + F -1 = Fo we get F -2 = -1, etc. How are these "Fibonacci numbers 
with negative indices" related to those with positive indices? Find several values, 
</p>
<p>conjecture, and then prove the answer. 
</p>
<p>Now we state a little more difficult identity: 
</p>
<p>( 4.2) 
</p>
<p>It is easy to check this for many values of n, and we can be convinced that 
</p>
<p>it is true, but to prove it is a bit more difficult. Why is this more difficult 
</p>
<p>than previous identities? Because if we want to prove it by induction (we 
</p>
<p>don't really have other means at this point), then on the right-hand side 
</p>
<p>we have only every other Fibonacci number, and so we don't know how to 
</p>
<p>apply the recursion there. 
</p>
<p>One way to fix this is to find a similar formula for F2n , and prove both of 
</p>
<p>them by induction. With some luck (or deep intuition?) you can conjecture 
</p>
<p>the following: 
</p>
<p>(4.3) 
</p>
<p>Again, it is easy to check that this holds for many small values of n. To 
</p>
<p>prove (4.3), let us use the basic recurrence (4.1) twice: 
</p>
<p>Fn+1 Fn + FnFn-l = (Fn + Fn-dFn + (Fn- 1 + Fn- 2)Fn- 1 
</p>
<p>= (F~ + F~_l) + (FnFn- 1 + Fn- 1Fn- 2) 
</p>
<p>(apply (4.2) to the first term and induction to the second term) 
</p>
<p>The proof of (4.2) is similar: 
</p>
<p>F~ + FLI = (Fn- 1 + Fn_2)2 + FLI 
</p>
<p>= (FLI + FL2) + 2Fn- 1 Fn- 2 + F~_l 
</p>
<p>= (F~_l + F~_2) + Fn- 1 (Fn-2 + Fn-d + Fn- 1Fn- 2 
</p>
<p>= (FLI + F~_2) + FnFn-l + Fn- 1Fn- 2 
</p>
<p>(apply induction to the first term and (4.3) to the second term) 
</p>
<p>= F2n- 3 + F2n- 2 = F2n- 1 . </p>
<p/>
</div>
<div class="page"><p/>
<p>70 4. Fibonacci Numbers 
</p>
<p>Wait a minute! What kind of trickery is this? We use (4.3) in the proof 
</p>
<p>of (4.2), and then (4.2) in the proof of (4.3)? Relax, the argument is OK: It 
</p>
<p>is just that the two induction proofs have to go simultaneously. If we know 
</p>
<p>that both (4.3) and (4.2) are true for a certain value of n, then we prove 
</p>
<p>(4.2) for the next value (if you look at the proof, you can see that it uses 
</p>
<p>smaller values of n only), and then use this and the induction hypothesis 
</p>
<p>again to prove (4.3). 
</p>
<p>This trick is called simultaneous induction, and it is a useful method to 
</p>
<p>make induction more powerful. 
</p>
<p>4.2.5 Prove that the following recurrence can be used to compute Fibonacci 
</p>
<p>numbers of odd index, without computing those with even index: 
</p>
<p>F2n+1 = 3F2n - 1 - F2n - 3 . 
</p>
<p>Use this identity to prove (4.2) without the trick of simultaneous induction. Give 
</p>
<p>a similar proof of (4.3). 
</p>
<p>4.2.6 Mark the first entry of any row of Pascal's triangle (this is a 1). Move one 
</p>
<p>step east and one step northeast, and mark the entry there. Repeat this until you 
</p>
<p>get out of the triangle. Compute the sum of the entries you marked. 
</p>
<p>(a) What numbers do you get if you start from different rows? First conjecture, 
</p>
<p>than prove your answer. 
</p>
<p>(b) Formulate this fact as an identity involving binomial coefficients. 
</p>
<p>Suppose that Fibonacci's farmer starts with A newborn rabbits. At the 
</p>
<p>end of the first month (when there is no natural population increase yet), 
</p>
<p>he buys B - A newborn rabbits so that he has B rabbits. From here on, rab-
</p>
<p>bits begin to multiply, and so he has A + B rabbits after the second month, 
A + 2B rabbits after the third month, etc. How many rabbits will he have 
after the nth month? Mathematically, we define a sequence Eo, E 1 , E 2 , ... 
</p>
<p>by Eo = A, El = B, and from then on, En+1 = En + En- 1 (the rab-
bits multiply by the same rule of biology; just the starting numbers are 
</p>
<p>different) . 
</p>
<p>For every two numbers A and B, we have this "modified Fibonacci se-
</p>
<p>quence." How different are they from the real Fibonacci sequence? Do we 
</p>
<p>have to study them separately for every choice of A and B? 
</p>
<p>It turns out that the numbers En can be expressed quite easily in terms 
</p>
<p>of the Fibonacci numbers Fn. To see this, let us compute a few beginning 
</p>
<p>values of the sequence En (of course, the result will contain the starting </p>
<p/>
</div>
<div class="page"><p/>
<p>4.3 A Formula for the Fibonacci Numbers 71 
</p>
<p>values A and B as parameters). 
</p>
<p>Eo=A, E 1 =B, E2=A+B, E3 =B+(A+B)=A+2B, 
</p>
<p>E4 = (A + B) + (A + 2B) = 2A + 3B, 
E5 = (A + 2B) + (2A + 3B) = 3A + 5B, 
E6 = (2A+3B) + (3A+5B) = 5A+SB, 
E7 = (3A + 5B) + (5A + SB) = SA + 13B, .... 
</p>
<p>It is easy to recognize what is going on: Each En is the sum of a multiple of 
</p>
<p>A and a multiple of B, and the coefficients are ordinary Fibonacci numbers! 
</p>
<p>For a formula, we can conjecture 
</p>
<p>( 4.4) 
</p>
<p>Of course, we have not proved this formula; but once we write it up, its 
</p>
<p>proof is so easy (by induction on n, of course) that it is left to the reader 
</p>
<p>as Exercise 4.3.10. 
</p>
<p>There is an important special case of this identity: We can start with two 
</p>
<p>consecutive Fibonacci numbers A = Fa and B = Fa+1 . Then the sequence 
En is just the Fibonacci sequence, but shifted to the left. Hence we get the 
</p>
<p>following identity: 
</p>
<p>(4.5) 
</p>
<p>This is a powerful identity for the Fibonacci numbers, which can be used 
</p>
<p>to derive many others; some applications follow as exercises. 
</p>
<p>4.2.7 Give a proof of (4.2) and (4.3), based on (4.5). 
</p>
<p>4.2.8 Use (4.5) to prove the following generalization of Exercises 4.2.1 and 4.2.2: 
If n is a multiple of k, then Fn is a multiple of Fk. 
</p>
<p>4.2.9 Cut a chessboard into 4 pieces as shown in Figure 4.1 and assemble a 
5 x 13 rectangle from them. Does this prove that 5 . 13 = 82 ? Where are we 
cheating? What does this have to do with Fibonacci numbers? 
</p>
<p>4.3 A Formula for the Fibonacci Numbers 
</p>
<p>How large are the Fibonacci numbers? Is there a simple formula that ex-
</p>
<p>presses Fn as a function of n? 
</p>
<p>An easy way out, at least for the author of a book, is to state the answer 
</p>
<p>right away: 
</p>
<p>Theorem 4.3.1 The Fibonacci numbers are given by the formula 
</p>
<p>F" ~ ~ (( 1+2v5)" -(' -2v5) ") </p>
<p/>
</div>
<div class="page"><p/>
<p>72 4. Fibonacci Numbers 
</p>
<p>- -c!&gt; 
y 
</p>
<p>...... V -&reg;-......-r r--...-
- ~ 
</p>
<p>II 
</p>
<p>~ r-I 
II IIIII 
</p>
<p>8&middot;8 = 64 5&middot;13 = 65 
</p>
<p>FIGURE 4.1. Proof of 64 = 65. 
</p>
<p>Proof. It is straightforward to check that this formula gives the right value 
</p>
<p>for n = 0,1, and then one can prove its validity for all n by induction. 0 
</p>
<p>4.3.1 Prove Theorem 4.3.1 by induction on n. 
</p>
<p>Do you feel cheated by this proof? You should; while it is, of course, 
</p>
<p>logically correct what we did, one would like to see more: How can one 
</p>
<p>arrive at such a formula? What should we try to get a similar formula if 
</p>
<p>we face a similar, but different, recurrence? 
</p>
<p>So let us forget Theorem 4.3.1 for a while and let us try to find a formula 
</p>
<p>for Fn "from scratch." 
</p>
<p>One thing we can try is to experiment. The Fibonacci numbers grow 
</p>
<p>quite fast; how fast? Let's grab our calculator and compute the ratio of 
</p>
<p>consecutive Fibonacci numbers: 
</p>
<p>1 2 
-=1 -=2 
1 ' 1 ' 
</p>
<p>~ = 1.600000000, 
</p>
<p>~~ = 1.619047619, 
</p>
<p>18~4 = 1.617977528, 
</p>
<p>~ = 1.5, ~ = 1.666666667, 
</p>
<p>183 = 1.625000000, ~~ = 1.615384615, 
</p>
<p>~~ = 1.617647059, ~: = 1.618181818, 
</p>
<p>~!! = 1.618055556, ~~~ = 1.618025751. 
</p>
<p>It seems that the ratio of consecutive Fibonacci numbers is very close to 
</p>
<p>1.618, at least if we ignore the first few values. This suggests that the 
</p>
<p>Fibonacci numbers behave like a geometric progression (for a geometric 
</p>
<p>progression, the ratio of any two consecutive elements would be exactly 
</p>
<p>the same). So let's see whether there is any geometric progression that 
</p>
<p>satisfies the same recurrence as the Fibonacci numbers. Let Gn = c . qn be 
a geometric progression (c, q #- 0). Then 
</p>
<p>Gn +1 = Gn + Gn - 1 </p>
<p/>
</div>
<div class="page"><p/>
<p>4.3 A Formula for the Fibonacci Numbers 73 
</p>
<p>translates into 
c. qn+l = c. qn + c . qn-l, 
</p>
<p>which after simplification becomes 
</p>
<p>q2 = q + 1. 
</p>
<p>So both numbers c and n disappear. 1 
</p>
<p>So we have a quadratic equation for q, which we can solve and get 
</p>
<p>1+V5 
ql = -2- :::::; 1.618034, 
</p>
<p>1- V5 
q2 = -2- :::::; -0.618034. 
</p>
<p>This gives us two kinds of geometric progressions that satisfy the same 
</p>
<p>recurrence as the Fibonacci numbers: 
</p>
<p>(where c is an arbitrary constant). Unfortunately, neither Gn nor G~ gives 
</p>
<p>the Fibonacci sequence: for one, Go = G~ = c, while Fa = O. But notice 
that the sequence Gn - G~ also satisfies the recurrence: 
</p>
<p>Gn+l-G~+l = (Gn+Gn-d-(G~ +G~_l) = (Gn-G~)+(Gn-l-G~_l) 
</p>
<p>(using that Gn and G~ satisfy the recurrence). So we have matched the 
</p>
<p>first value Fa, since Go - G~ = O. What about the next one? We have 
G1 - G~ = cV5. We can match this with Fl = 1 if we choose c = 1/V5. 
</p>
<p>Thus we have two sequences, Fn and Gn - G~, that both begin with the 
</p>
<p>same two numbers and satisfy the same recurrence. So we can use the same 
</p>
<p>rule to compute the numbers Fn as the numbers Gn - G~, and it follows 
</p>
<p>that they must be the same: Fn = Gn - G~. 
Now you can substitute for the values of Gn and G~ and see that we got 
</p>
<p>the formula in the theorem! 
</p>
<p>The formula we just derived gives new kind of information about the 
</p>
<p>Fibonacci numbers. The first base in the exponential expression is ql = 
(1 + V5)/2 :::::; 1.618034 &gt; 1, while the second base q2 is between -1 and o. 
Hence if n increases, then Gn will become very large, while IG~I &lt; ~ once 
n ~ 2, and in fact, G~ becomes very small. This means that 
</p>
<p>Fn :::::; Gn = Jg ( 1 +2 V5) n , 
</p>
<p>IThis disappearance of c and n from the equation could be expected. The reason 
</p>
<p>behind it is that if we find a sequence that satisfies Fibonacci's recurrence, then we 
</p>
<p>can multiply its elements by any other real number and get another sequence that 
</p>
<p>satisfies the recurrence. This means that we should not get any condition on c. Further, 
</p>
<p>if we have a sequence that satisfies Fibonacci's recurrence, then starting the sequence 
</p>
<p>anywhere later, it will also satisfy the recurrence. This suggests that we should not get 
</p>
<p>any condition on n. </p>
<p/>
</div>
<div class="page"><p/>
<p>74 4. Fibonacci Numbers 
</p>
<p>where the term we ignore is less than ~ if n ~ 2 (and tends to 0 if n tends 
</p>
<p>to infinity); this implies that Fn is the integer nearest to Gn. 
</p>
<p>The base T = (1 + v'5) /2 is a famous number: It is called the golden ratio, 
and it comes up all over mathematics; for example, it is the ratio between 
</p>
<p>the diagonal and side of a regular pentagon. Another way to characterize 
</p>
<p>it is the following: If b / a = T, then (a + b) /b = T. SO if the ratio between 
the longer and shorter sides of a rectangle is T, then cutting off a square, 
</p>
<p>we are left with a rectangle that is similar to the original. 
</p>
<p>4.3.2 Define a sequence of integers Ln by Ll = 1, L2 = 3, and Ln+ l = Ln + 
Ln- l . (These numbers are called Lucas numbers.) Show that Ln can be expressed 
</p>
<p>in the form a&middot; ql + b&middot; q2 (where ql and q2 are the same numbers as in the proof 
above), and find the values of a and b. 
</p>
<p>4.3.3 Define a sequence of integers In by 10 = 0, Ir = 1, and I n+l = 4In + In-I. 
(a) Find a combinatorial counting problem to which the answer is In. (b) Find a 
</p>
<p>formula for In. 
</p>
<p>4.3.4 Alice claims that she knows another formula for the Fibonacci numbers: 
</p>
<p>Fn = r enj2 - ll for n = 1,2, ... (where e = 2.718281828 ... is, naturally, the base 
of the natural logarithm). Is she right? 
</p>
<p>Review Exercises 
</p>
<p>4.3.5 In how many ways can you cover a 2 x n chessboard by dominoes? 
</p>
<p>4.3.6 How many subsets does the set {I, 2, ... ,n} have that contain no two 
consecutive integers if 0 and n also count as consecutive? 
</p>
<p>4.3.7 How many subsets does the set {I, 2, ... ,n} have that contain no three 
consecutive integers? Find a recurrence. 
</p>
<p>4.3.8 Which number is larger, 2100 or FlOO? 
</p>
<p>4.3.9 Prove the following identities: 
</p>
<p>(a) F2 + F4 + F6 + ... + F2n = F2n+l - 1; 
</p>
<p>(b) F~+l - F~ = Fn- l Fn +2; 
</p>
<p>(c) (~)Fo + (7)Fr + G)F2 + ... + (~)Fn = F2n; 
</p>
<p>(d) (~)Fl + (7)F2 + G)F3 + ... + (~)Fn+l = F2n+l . 
</p>
<p>4.3.10 Prove (4.4). 
</p>
<p>4.3.11 Is it true that if Fn is a prime, then n is a prime? </p>
<p/>
</div>
<div class="page"><p/>
<p>4.3 A Formula for the Fibonacci Numbers 75 
</p>
<p>4.3.12 Consider a sequence of numbers bo,b1 ,b2 , ... such that bo = 0, b1 = 1, 
</p>
<p>and b2 , b3, . .. are defined by the recurrence 
</p>
<p>Find the value of bk . 
</p>
<p>4.3.13 Assume that the sequence (ao, al, a2, ... ) satisfies the recurrence 
</p>
<p>We know that ao = 4 and a2 = 13. What is a5? 
</p>
<p>4.3.14 Recalling the Lucas numbers Ln introduced in Exercise 4.3.2, prove the 
</p>
<p>following identities: 
</p>
<p>(a) F2n = FnLn; 
</p>
<p>(b) 2Fk+n = FkLn + FnLk; 
</p>
<p>(c) 2Lk+n = 5FkFn + LkLn; 
</p>
<p>(d) L4k = L~k - 2; 
</p>
<p>(e) L 4k+2 = L~k+l + 2. 
</p>
<p>4.3.15 Prove that if n is a multiple of 4, then Fn is a multiple of 3. 
</p>
<p>4.3.16 (a) Prove that every positive integer can be written as the sum of 
</p>
<p>different Fibonacci numbers. 
</p>
<p>(b) Prove even more: every positive integer can be written as the sum of dif-
</p>
<p>ferent Fibonacci numbers, so that no two consecutive Fibonacci numbers 
</p>
<p>are used. 
</p>
<p>(c) Show by an example that the representation in (a) is not unique, but also 
</p>
<p>prove that the more restrictive representation in (b) is. </p>
<p/>
</div>
<div class="page"><p/>
<p>5 
</p>
<p>Combinatorial Probability 
</p>
<p>5.1 Events and Probabilities 
</p>
<p>Probability theory is one of the most important areas of mathematics from 
</p>
<p>the point of view of applications. In this book we do not attempt to intro-
</p>
<p>duce even the most basic notions of probability theory; our only goal is to 
</p>
<p>illustrate the importance of combinatorial results about Pascal's Triangle 
</p>
<p>by explaining a key result in probability theory, the Law of Large Numbers. 
</p>
<p>To do so, we have to talk a little about what probability is. 
</p>
<p>If we make an observation about our world, or carry out an experiment, 
</p>
<p>the outcome will always depend on chance (to a varying degree). Think of 
</p>
<p>the weather, the stock market, or a medical experiment. Probability theory 
</p>
<p>is a way of modeling this dependence on chance. 
</p>
<p>We start with making a mental list of all possible outcomes of the exper-
</p>
<p>iment (or observation, which we don't need to distinguish). These pos-
</p>
<p>sible outcomes form a set S. Perhaps the simplest experiment is toss-
</p>
<p>ing a coin. This has two outcomes: H (heads) and T (tails). So in this 
</p>
<p>case S = {H, T}. As another example, the outcomes of throwing a die 
form the set S = {I, 2, 3, 4, 5, 6}. In this book we assume that the set 
S = {81' 82, ... ,8d of possible outcomes of our experiment is finite. The 
set S is often called a sample space. 
</p>
<p>Every subset of S is called an event (the event that the observed outcome 
</p>
<p>falls in this subset). So if we are throwing a die, the subset E = {2, 4, 6} S;;; S 
can be thought of as the event that we throw an even number. Similarly, </p>
<p/>
</div>
<div class="page"><p/>
<p>78 5. Combinatorial Probability 
</p>
<p>the subset L = {4, 5, 6} ~ 8 corresponds to the event that we throw a 
</p>
<p>number larger than 3. 
</p>
<p>The intersection of two subsets corresponds to the event that both events 
</p>
<p>occur; for example, the subset L n E = {4, 6} corresponds to the event that 
we throw a better-than-average number that is also even. Two events A 
</p>
<p>and B (i.e., two subsets of 8) are called exclusive if they never occur at 
</p>
<p>the same time, i.e., An B = 0. For example, the event 0 = {I, 3, 5} that 
the outcome of tossing a die is odd and the event E that it is even are 
</p>
<p>exclusive, since E n 0 = 0. 
</p>
<p>5.1.1 What event does the union of two subsets corresponds to? 
</p>
<p>So let 8 = {Sl' S2, ... ,sd be the set of possible outcomes of an experi-
ment. To get a probability space we assume that each outcome Si E 8 has 
</p>
<p>a "probability" P(Si) such that 
</p>
<p>(a) P(Si) 2: 0 for all Si E 8, 
</p>
<p>and 
</p>
<p>(b) P(sr) + P(S2) + ... + P(Sk) = l. 
Then we call 8, together with these probabilities, a probability space. For 
</p>
<p>example, if we toss a "fair" coin, then P(H) = P(T) = ~. If the dice in our 
example is of good quality, then we will have P(i) = t for every outcome i. 
</p>
<p>A probability space in which every outcome has the same probability 
</p>
<p>is called a uniform probability space. We shall only discuss uniform spaces 
</p>
<p>here, since they are the easiest to imagine and they are the best for the 
</p>
<p>illustration of combinatorial methods. But you should be warned that in 
</p>
<p>more complicated modeling, nonuniform probability spaces are very often 
</p>
<p>needed. For example, if we are observing whether a day is rainy or not, we 
</p>
<p>will have a 2-element sample space 8 = {RAINY, NONRAINY}, but these 
two will typically not have the same probability. 
</p>
<p>The probability of an event A ~ 8 is defined as the sum of probabilities of 
</p>
<p>outcomes in A, and is denoted by P(A). If the probability space is uniform, 
then the probability of A is 
</p>
<p>P(A) = ~ = ~ 
181 k' 
</p>
<p>5.1.2 Prove that the probability of any event is at most 1. 
</p>
<p>5.1.3 What is the probability of the event E that we throw an even number 
</p>
<p>with the die? What is the probability of the event T = {3,6} that we toss a 
</p>
<p>number that is divisible by 3? 
</p>
<p>5.1.4 Prove that if A and B are exclusive, then peA) + PCB) = peA U B). 
</p>
<p>5.1.5 Prove that for any two events A and B, 
</p>
<p>peA n B) + peA U B) = peA) + PCB). </p>
<p/>
</div>
<div class="page"><p/>
<p>5.2 Independent Repetition of an Experiment 79 
</p>
<p>5.2 Independent Repetition of an Experiment 
</p>
<p>Let us repeat our experiment n times. We can consider this as a single 
</p>
<p>big experiment, and a possible outcome of this repeated experiment is a 
</p>
<p>sequence of length n, consisting of elements of S. Thus the sample space 
</p>
<p>corresponding to this repeated experiment is the set sn of such sequences. 
Consequently, the number of outcomes of this "big" experiment is kn. We 
</p>
<p>consider every sequence equally likely, which means that we consider it 
</p>
<p>a uniform probability space. Thus if (al,a2,'" ,an) is an outcome of the 
</p>
<p>"big" experiment, then we have 
</p>
<p>As an example, consider the experiment of tossing a coin twice. Then 
</p>
<p>S = {H, T} (heads, tails) for a single coin toss, and so the sample space 
for the two coin tosses is {H H, HT, T H, TT}. The probability of each of 
</p>
<p>these outcomes is ~. 
</p>
<p>This definition intends to model the situation where the outcome of each 
</p>
<p>repeated experiment is independent of the previous outcomes, in the ev-
</p>
<p>eryday sense that "there cannot possibly be any measurable influence of 
</p>
<p>one experiment on the other." We cannot go here into the philosophical 
</p>
<p>questions that this notion raises; all we can do is to give a mathematical 
</p>
<p>definition that we can check, using examples, that it correctly expresses the 
</p>
<p>informal notion above. 
</p>
<p>A key notion in probability is independence of events. Informally, this 
</p>
<p>means that information about one event (whether or not it occurred) does 
</p>
<p>not influence the probability of the other. Formally, two events A and B 
</p>
<p>are independent if P(A n B) = P(A)P(B). 
Consider again the experiment of tossing a coin twice. Let A be the event 
</p>
<p>that the first toss is heads; let B be the event that the second toss is heads. 
</p>
<p>Then we have P(A) = P(HH) + P(HT) = ~ + ~ = ~, similarly P(B) = ~, 
and p(AnB) = P(HH) = ~ = ~.~. Thus A and B are independent events 
(as they should be). 
</p>
<p>As another example, suppose that we toss a coin and simultaneously 
</p>
<p>throw a die. The event H that we toss heads has probability ~. The event 
</p>
<p>K that we see 5 or 6 on the die has probability -!. The event H n K that 
we see heads on the coin and 5 or 6 on the die has probability i, since out 
of the 12 possible outcomes (HI, H2, H3, H4, H5, H6, Tl, T2, T3, T4, T5, 
</p>
<p>T6) two will have this property. So 
</p>
<p>1 1 1 
P(H n K) = "6 = "2 . :3 = P(H) . P(E), 
</p>
<p>and thus the events Hand K are independent. 
</p>
<p>Independence of events is a mathematical notion and it does not nec-
</p>
<p>essarily mean that they have physically nothing to do with each other. If </p>
<p/>
</div>
<div class="page"><p/>
<p>80 5. Combinatorial Probability 
</p>
<p>E = {2, 4, 6} is the event that the result of throwing a dice is even, and 
T = {3,6} is the event that it is a multiple of 3, then the event E and 
the event T are independent: we have En T = {6} (the only possibility to 
throw a number that is even and divisible by 3 is to throw 6), and hence 
</p>
<p>1 1 1 
p(EnT) = 6 ="2'"3 = P(E)P(T). 
</p>
<p>5.2.1 Which pairs of the events E, 0, T, L are independent? Which pairs are 
</p>
<p>exclusive? 
</p>
<p>5.2.2 Show that 0 is independent of every event. Is there any other event with 
this property? 
</p>
<p>5.2.3 Consider an experiment with sample space S repeated n times (n ;::: 2). 
Let s E S. Let A be the event that the first outcome is s, and let B be the event 
</p>
<p>that the last outcome is s. Prove that A and B are independent. 
</p>
<p>5.2.4 How many people do you think there are in the world who have the same 
</p>
<p>birthday as their mother? How many people have the same birthday as their 
</p>
<p>mother, father, and spouse? 
</p>
<p>5.3 The Law of Large Numbers 
</p>
<p>In this section we study an experiment that consists of n independent coin 
</p>
<p>tosses. For simplicity, assume that n is even, so that n = 2m for some 
integer m. Every outcome is a sequence of length n, in which each element 
</p>
<p>is either H or T. A typical outcome would look like this: 
</p>
<p>HHTTTHTHTTHTHHHHTHTT 
</p>
<p>(for n = 20). 
The Law of Large Numbers says that if we toss a coin many times, the 
</p>
<p>number of "heads" will be about the same as the number of "tails". How 
</p>
<p>can we make this statement precise? Certainly, this will not always be true; 
</p>
<p>one can be extremely lucky or unlucky, and have a winning or loosing streak 
</p>
<p>of arbitrary length. Also, we can't claim that the number of heads is equal 
</p>
<p>to the number of tails; only that they are very likely to be close: 
</p>
<p>Flipping a coin n times, the probability that the percentage of 
</p>
<p>heads is between 49% and 51 % tends to 1 as n tends to 00. 
</p>
<p>The statement remains true if we replace 49% by 49.9% and 51% by 
</p>
<p>50.1 %, or indeed by any two numbers strictly less 50% and larger than 
</p>
<p>50%, respectively. We can state this as a theorem, which is the simplest 
</p>
<p>form of the Law of Large Numbers: </p>
<p/>
</div>
<div class="page"><p/>
<p>5.3 The Law of Large Numbers 81 
</p>
<p>Theorem 5.3.1 Fix an arbitrarily small positive number E. If we flip a 
</p>
<p>coin n times, the probability that the fraction of heads is between 0.5 - E 
</p>
<p>and 0.5 + E tends to 1 as n tends to 00. 
</p>
<p>This theorem says, for example, that flipping a coin n times, the proba-
</p>
<p>bility that the number of heads is between 49% and 51% is at least 0.99, 
</p>
<p>if n is large enough. But how large must n be for this to hold? If n = 49 
(which may sound pretty large) the number of heads can never be in this 
</p>
<p>range; there are simply no integers between 49% of 49 (24.01) and 51% of 
</p>
<p>49 (24.99). How much larger does n have to be to assure that the number 
</p>
<p>of heads is in this range for the majority of outcomes? This is an extremely 
</p>
<p>important question in the statistical analysis of data: we want to know 
</p>
<p>whether a deviation from the expected value is statistically significant. 
</p>
<p>Fortunately, much more precise formulations of the Law of Large Num-
</p>
<p>bers can be made; one of these we can prove relatively easily, based on what 
</p>
<p>we already know about Pascal's triangle. This proof will show that the Law 
</p>
<p>of Large Numbers is not a mysterious force, but a simple consequence of 
</p>
<p>the properties of binomial coefficients. 
</p>
<p>Theorem 5.3.2 Let 0 ::; t ::; m. Then the probability that out of 2m coin 
</p>
<p>tosses, the number of heads is less than m - t or larger than m + t, is at 
most e- t2 /(m+t). 
</p>
<p>To illustrate the power of this theorem, let's go back to our earlier ques-
</p>
<p>tion: How large should n be in order that the probability that the number of 
</p>
<p>heads is between 49% and 51% is at least O.99? We want m - t to be 49% 
</p>
<p>of n = 2m, which means that t = m/50. The theorem says that the proba-
bility that the number of heads is not in this interval is at most e- t2 /(m+t). 
</p>
<p>The exponent here is 
</p>
<p>t 2 m 
---
</p>
<p>m+t 2550 
</p>
<p>We want e-m/2550 &lt; 0.01; taking the logarithm and solving for m, we get 
m 2:: 11744 suffices. (This is pretty large, but, after all, we are talking about 
the "Law of Large Numbers.") 
</p>
<p>Observe that m is in the exponent, so that if m increases, the probability 
</p>
<p>that the number of heads is outside the given interval drops very fast. For 
</p>
<p>example, if m = 1,000,000, then this probability is less than 10-170 . Most 
likely, over the lifetime of the universe it never happens that out of a million 
</p>
<p>coin tosses less than 49% or more than 51 % are heads. 
</p>
<p>Normally, we don't need such a degree of certainty. Suppose that we 
</p>
<p>want to make a claim about the number of heads with 95% certainty, 
</p>
<p>but we would like to narrow the interval into which it falls as much as 
</p>
<p>possible. In other words, we want to choose the smallest possible t so that </p>
<p/>
</div>
<div class="page"><p/>
<p>82 5. Combinatorial Probability 
</p>
<p>the probability that the number of heads is less than m - t or larger than 
</p>
<p>m + t less than 0.05. By Theorem 5.3.2, this will be the case if 
</p>
<p>e- t2 j(mH) &lt; 0.05. 
</p>
<p>(This is only a sufficient condition; if this holds, then the number of heads 
</p>
<p>will be between m - t and m + t with probability at least 0.95. Using more 
refined formulas, we would find a slightly smaller t that works.) Taking the 
</p>
<p>logarithm, we get 
t2 
</p>
<p>--- &lt; -2.996. 
m+t 
</p>
<p>This leads to a quadratic inequality, which we could solve for t; but it 
</p>
<p>should suffice for this discussion that t = 2vm + 2 satisfies it (which is 
easy to check). So we get an interesting special case: 
</p>
<p>With probability at least 0.95, the number of heads among 2m 
</p>
<p>coin tosses is between m - 2vm - 2 and m + 2vm + 2. 
</p>
<p>If m is very large, then 2vm + 2 is much smaller than m, so we get that 
the number of heads is very close to m. For example, if m = 1,000,000 then 
2vm = 2,002 ~ 0.002m, and so it follows that with probability at least 
0.95, the number of heads is within i of a percent of m = n/2. 
</p>
<p>It is time now to turn to the proof of Theorem 5.3.2. 
</p>
<p>Proof. Let Ak denote the event that we toss exactly k heads. It is clear 
</p>
<p>that the events Ak are mutually exclusive. It is also clear that for every 
</p>
<p>outcome of the experiment, exactly one of the Ak occurs. 
</p>
<p>The number of outcomes for which Ak occurs is the number of sequences 
</p>
<p>of length n consisting of k heads and n - k tails. If we specifY which of the 
n positions are heads, we are done. This can be done in (~) ways, so the 
</p>
<p>set Ak has (~) elements. Since the total number of outcomes is 2n , we get 
</p>
<p>the following: 
</p>
<p>P(A ) = (~). 
k 2n 
</p>
<p>What is the probability that the number of heads is far from the expected, 
</p>
<p>which is m = n/2; say, it is less than m - t or larger than m + t, where t is 
any positive integer not larger than m? Using Exercise 5.1.4, we see that 
</p>
<p>the probability that this happens is 
</p>
<p>2;m ( C;) + C~) + ... + (m ~7 -1) + (m ~7 + 1) + ... 
</p>
<p>+(2~r: 1) + G:)) . 
Now we can use Lemma 3.8.2, with k = m - t, and get that </p>
<p/>
</div>
<div class="page"><p/>
<p>5.4 The Law of Small Numbers and the Law of Very Large Numbers 83 
</p>
<p>By (3.9), this can be bounded from above by 
</p>
<p>By the symmetry of Pascal's triangle, we also have 
</p>
<p>( 2m) ( 2m) (2m) 22m -t2 /(mH) + ... + + &lt; e . 
m + t + 1 2m - 1 2m 
</p>
<p>Hence we get that the probability that we toss either fewer than m - t or 
</p>
<p>more than m + t heads is less than e- t2 /(m+t). This proves the theorem. 0 
</p>
<p>5.4 The Law of Small Numbers and the Law of 
Very Large Numbers 
</p>
<p>There are two further statistical "laws" (half serious): the Law of Small 
</p>
<p>Numbers and the Law of Very Large Numbers. 
</p>
<p>The first one says that if you look at small examples, you can find many 
</p>
<p>strange or interesting patterns that do not generalize to larger numbers. 
</p>
<p>Small numbers exhibit only a small number of patterns, and looking at 
</p>
<p>various properties of small numbers, we are bound to see coincidences. For 
</p>
<p>example, "every odd number is a prime" is true for 3, 5 and 7 (and one 
</p>
<p>may be tempted to say that it is also true for 1, which is even "simpler" 
</p>
<p>than primes: instead of two divisors, it has only one). Of course, this fails 
</p>
<p>for 9. 
</p>
<p>Primes are strange (as we'll see) and in their irregular sequence, many 
</p>
<p>strange patterns can be observed, which than fail if we move on to larger 
</p>
<p>numbers. A dramatic example is the formula n 2 - n + 41. This gives a prime 
for n = 0,1, ... ,40, but for n = 41 we get 412 - 41 + 41 = 412, which is 
not a prime. 
</p>
<p>Fibonacci numbers are not as strange as primes: We have seen many 
</p>
<p>interesting properties of them, and derived an explicit formula in Chapter 
</p>
<p>4. Still, one can make observations for the beginning of the sequence that do 
</p>
<p>not remain valid if we check them far enough. For example, Exercise 4.3.4 
</p>
<p>gave a (false) formula for the Fibonacci numbers, namely len / 2- 1l, which 
was correct for the first 10 positive integers n. There are many formulas 
</p>
<p>that give integer sequences, but these sequences can start only so many 
</p>
<p>ways: we are bound to find different sequences that start out the same way. 
</p>
<p>So the moral of the "Law of Small Numbers" is that to make a mathe-
</p>
<p>matical statement, or even to set up a mathematical conjecture, it is not 
</p>
<p>enough to observe some pattern or rule, because you can only observe small 
</p>
<p>instances and there are many coincidences for these. There is nothing wrong 
</p>
<p>with making conjectures in mathematics, generalizing facts observed in spe-
</p>
<p>cial cases, but even a conjecture needs some other justification (an imprecise </p>
<p/>
</div>
<div class="page"><p/>
<p>84 5. Combinatorial Probability 
</p>
<p>argument, or a provable special case). A theorem, of course, needs much 
</p>
<p>more: an exact proof. 
</p>
<p>The Law of Very Large Numbers says that strange coincidences can also 
</p>
<p>be observed if we look at large sets of data. A friend of ours says, "I know 
</p>
<p>two people who were both born on Christmas day. They complain that 
</p>
<p>they get only one set of presents .... That's really strange. Are there many 
</p>
<p>more people born on Christmas day than on other days?" No, this is not 
</p>
<p>the explanation. The probability that a person is born on Christmas day 
</p>
<p>is 1/365 (let's ignore leap years), so if you know, say, 400 people, then you 
</p>
<p>can expect 1 or 2 of them to have a birthday on Christmas. Of course, 
</p>
<p>you probably don't remember the birthdays of most people you know; but 
</p>
<p>you are likely to remember those who complain about not getting enough 
</p>
<p>presents! 
</p>
<p>Would you find it strange, even spooky, if somebody had the same birth-
</p>
<p>day as his/her mother, father, and spouse? But if you have solved Exercise 
</p>
<p>5.2.4, you know that we have probably about 40 or so such people in the 
</p>
<p>world, and probably a couple of them in the United States. 
</p>
<p>This is a fertile area for the tabloids and also for believers in the para-
</p>
<p>normal. We had better leave it at that. 
</p>
<p>Review Exercises 
</p>
<p>5.4.1 We throw a die twice. What is the probability that the sum of the points 
</p>
<p>is 8? 
</p>
<p>5.4.2 Choose an integer uniformly from the set {I, 2, 3, ... ,30}. Let A be the 
event that it is divisible by 2; let B be the event that it is divisible by 3; let C 
be the event that it is divisible by 7. 
</p>
<p>(a) Determine the probabilities of A, B, and C. 
</p>
<p>(b) Which of the pairs (A,B), (B,C), and (A,C) are independent? 
</p>
<p>5.4.3 Let A and B be independent events. Express the probability peA U B) in 
</p>
<p>terms of the probabilities of A and B. 
</p>
<p>5.4.4 We select a subset X of the set S = {I, 2, ... , 100} randomly and uni-
</p>
<p>formly (so that every subset has the same probability of being selected). What 
</p>
<p>is the probability that 
</p>
<p>(a) X has an even number of elements; 
</p>
<p>(b) both 1 and 100 belong to X; 
</p>
<p>(c) the largest element of S is 50; 
</p>
<p>(d) S has at most 2 elements. </p>
<p/>
</div>
<div class="page"><p/>
<p>5.4 The Law of Small Numbers and the Law of Very Large Numbers 85 
</p>
<p>5.4.5 We flip a coin n times (n 2: 1). For which values of n are the following 
pairs of events independent? 
</p>
<p>(a) The first coin flip was heads; the number of all heads was even. 
</p>
<p>(b) The first coin flip was head; the number of all heads was more than the 
</p>
<p>number of tails. 
</p>
<p>(c) The number of heads was even; the number of heads was more than the 
</p>
<p>number of tails. </p>
<p/>
</div>
<div class="page"><p/>
<p>6 
</p>
<p>Integers, Divisors, and Primes 
</p>
<p>In this chapter we discuss properties of integers. This area of mathematics 
</p>
<p>is called number theory, and it is a truly venerable field: Its roots go back 
</p>
<p>about 2500 years, to the very beginning of Greek mathematics. One might 
</p>
<p>think that after 2500 years of research, one would know essentially every-
</p>
<p>thing about the subject. But we shall see that this is not the case: There 
are very simple, natural questions that we cannot answer; and there are 
</p>
<p>other simple, natural questions to which an answer has been found only in 
</p>
<p>the last few years! 
</p>
<p>6.1 Divisibility of Integers 
</p>
<p>We start with some very basic notions concerning integers. Let a and b be 
</p>
<p>two integers. We say that a divides b, or a is a divisor of b, or b is a multiple 
</p>
<p>of a (these phrases mean the same thing), if there exists an integer m such 
</p>
<p>that b = am. In notation: a I b. If a is not a divisor of b, then we write a f b. 
If a =I 0, then a I b means that the ratio b/a is an integer. 
</p>
<p>If a f b and a &gt; 0, then we can still divide b by a with remainder. The 
remainder r of the division b -7- a is an integer that satisfies 0 ::; r &lt; a. If 
the quotient of the division with remainder is q, then we have 
</p>
<p>b = aq+r. 
</p>
<p>This is a very useful way of thinking about a division with remainder. 
</p>
<p>You have probably seen these notions before; the following exercises 
</p>
<p>should help you check whether you remember enough. </p>
<p/>
</div>
<div class="page"><p/>
<p>88 6. Integers, Divisors, and Primes 
</p>
<p>6.1.1 Check (using the definition) that 1 I a, -1 I a, a I a and -a I a for every 
integer a. 
</p>
<p>6.1.2 What does it mean for a, in more everyday terms, if (a) 2 I a; (b) 2 f a; 
(c) 0 I a. 
</p>
<p>6.1.3 Prove that 
</p>
<p>( a) if a I band b I c then a I c; 
</p>
<p>(b) if a I b and a I c then a I b + c and a I b - c; 
(c) if a, b &gt; 0 and a I b then a ::; b; 
</p>
<p>(d) if a I band b I a then either a = b or a = -b. 
</p>
<p>6.1.4 Let r be the remainder of the division b -;- a. Assume that c I a and c I b. 
Prove that c I r. 
</p>
<p>6.1.5 Assume that a I b, and a, b &gt; O. Let r be the remainder of the division 
c -;- a, and let s be the remainder of the division c -;- b. '''''hat is the remainder of 
</p>
<p>the division s -;- a? 
</p>
<p>6.1.6 (a) Prove that for every integer a, a-I I a2 - l. 
</p>
<p>(b) More generally, for every integer a and positive integer n, 
</p>
<p>a-I I an - 1. 
</p>
<p>6.2 Primes and Their History 
</p>
<p>An integer p &gt; 1 is called a prime if it is not divisible by any integer other 
than 1, -1, p, and -po Another way of saying this is that an integer p &gt; 1 
is a prime if it cannot be written as the product of two smaller positive 
</p>
<p>integers. An integer n &gt; 1 that is not a prime is called composite (the 
number 1 is considered neither prime nor composite). Thus 2,3,5,7,11 are 
</p>
<p>primes, but 4 = 2&middot;2, 6 = 2&middot;3, 8 = 2&middot;4, 9 = 3&middot;3, 10 = 2&middot;5 are not primes. 
Table 6.1 shows the primes up to 500. 
</p>
<p>Primes have fascinated people ever since ancient times. Their sequence 
</p>
<p>seems very irregular, yet on closer inspection it seems to carry a lot of 
</p>
<p>hidden structure. The ancient Greeks already knew that there are infinitely 
</p>
<p>many such numbers. (Not only did they know this; they proved it!) 
</p>
<p>It was not easy to prove any further facts about primes. Their sequence 
</p>
<p>is reasonably smooth, but it has holes and dense spots (see Figure 6.1). 
</p>
<p>How large are these holes? For example, is there a prime number with any 
</p>
<p>given number of digits? The answer to this question will be important for 
</p>
<p>us when we discuss cryptography. The answer is in the affirmative, but this 
</p>
<p>fact was not proved until the mid-nineteenth century, and many similar 
</p>
<p>questions are open even today. </p>
<p/>
</div>
<div class="page"><p/>
<p>6.2 Primes and Their History 89 
</p>
<p>1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 
</p>
<p>27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 3~ 38, 39, 40, 41, 42, 43, 44, 45, 46, 4~ 48, 49, 50, 
</p>
<p>51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 
</p>
<p>75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 
</p>
<p>99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 
</p>
<p>117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 
</p>
<p>135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 
</p>
<p>153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 
</p>
<p>171,172,173,174,175,176,177,178,179,180,181,182, 183, 184, 185, 186, 187, 188, 
</p>
<p>189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 
</p>
<p>207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 
</p>
<p>225, 226, 22~ 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 
</p>
<p>243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 
</p>
<p>261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 27~ 278, 
</p>
<p>279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 
</p>
<p>297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 30~ 308, 309, 310, 311, 312, 31~ 314, 
</p>
<p>315, 316, 31~ 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 
</p>
<p>333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 
</p>
<p>351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 
</p>
<p>369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 
</p>
<p>387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 39~ 398, 399, 400, 401, 402, 403, 404, 
</p>
<p>405, 406, 407, 408, 40~ 410, 411, 412, 413, 414, 415, 416, 41~ 418, 41~ 420, 421, 422, 
</p>
<p>423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 
</p>
<p>441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 45~ 458, 
</p>
<p>459, 460, 461, 462, 463, 464, 465, 466, 46~ 468, 469, 470, 471, 472, 473, 474, 475, 476, 
</p>
<p>477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 48~ 488, 489, 490, 491, 492, 493, 494, 
</p>
<p>495, 496, 497, 498, 499, 500 
</p>
<p>TABLE 6.1. The primes up to 500. 
</p>
<p>A new wave of developments in the theory of prime numbers came with 
</p>
<p>the spread of computers. How do you decide about a positive integer n 
</p>
<p>whether it is a prime? Surely, this is a finite problem (you can tryout all 
</p>
<p>smaller positive integers to see whether any of them is a proper divisor), 
</p>
<p>but such simple methods become impractical as soon as the number of 
</p>
<p>digits is more than 20 or so. 
</p>
<p>lt is only 25 years since much more efficient algorithms (computer pro-
</p>
<p>grams) have existed to test whether a given integer is a prime. We will get 
</p>
<p>a glimpse of these methods later. Using these methods, one can now rather 
</p>
<p>easily determine about a number with 1000 digits whether it is a prime or 
</p>
<p>not. 
</p>
<p>If an integer larger than 1 is not itself a prime, then it can be written as 
</p>
<p>a product of primes: We can write it as a product of two smaller positive 
</p>
<p>integers; if one of these is not a prime, we write it as the product of two 
</p>
<p>smaller integers, etc; sooner or later we must end up with only primes. The 
</p>
<p>ancient Greeks also knew (and proved!) a subtler fact about this represen-</p>
<p/>
</div>
<div class="page"><p/>
<p>90 6. Integers, Divisors, and Primes 
</p>
<p>~IIIIIIIIIIIIIIIIIIIIIII i IIIIIIII~ 1111111111111111111111111111111111111111111111111111111111I111111 ~IIIIIIII, I1111 
o 200 400 600 800 1000 
</p>
<p>FIGURE 6.1. A bar chart of primes up to 1000. 
</p>
<p>tation, that it is unique. What this means is that there is no other way of 
</p>
<p>writing n as a product of primes (except, of course, we can multiply the 
</p>
<p>same primes in a different order). To prove this takes some sophistication 
</p>
<p>(as we'll see in the next section), and to recognize the necessity of such a 
</p>
<p>result was quite an accomplishment; but this is all more than 2000 years 
</p>
<p>old! 
</p>
<p>It is really surprising that, even today, no efficient way is known to find 
</p>
<p>such a decomposition. Of course, powerful supercomputers and massively 
</p>
<p>parallel systems can be used to find decompositions by brute force for fairly 
</p>
<p>large numbers; the current record is around 140 digits, and the difficulty 
</p>
<p>grows very fast (exponentially) with the number of digits. To find the prime 
</p>
<p>decomposition of a given number with 400 digits, by any of the known 
</p>
<p>methods, is way beyond the possibilities of computers in the foreseeable 
</p>
<p>future. 
</p>
<p>6.3 Factorization into Primes 
</p>
<p>We have seen that every integer larger than 1 that is not a prime itself 
</p>
<p>can be written as a product of primes. We can even say that every positive 
</p>
<p>integer can be written as a product of primes: Primes can be considered as 
</p>
<p>"products with one factor," and if you wish, the integer 1 can be thought 
</p>
<p>of as the "empty product." With this in mind, we can state and prove the 
</p>
<p>following theorem, announced above, sometimes called the "Fundamental 
</p>
<p>Theorem of Arithmetic" . 
</p>
<p>Theorem 6.3.1 Every positive integer can be written as the product of 
</p>
<p>primes, and this factorization is unique up to the order of the prime factors. 
</p>
<p>Proof. We prove this theorem by a version of induction, which is some-
</p>
<p>times called the "minimal criminal" argument. The proof is indirect: we 
</p>
<p>suppose that the assertion is false, and using this assumption, we derive a 
</p>
<p>logical contradiction. </p>
<p/>
</div>
<div class="page"><p/>
<p>6.3 Factorization into Primes 91 
</p>
<p>So assume that there exists an integer with two different factorizations; 
</p>
<p>call such an integer a "criminal." There may be many criminals, but we 
</p>
<p>consider the smallest one. Being a criminal, this has at least two different 
</p>
<p>factorizations: 
</p>
<p>n = PI . P2 ... Pm = ql . q2 ... qk . 
</p>
<p>We may assume that PI is the smallest prime occurring in these factoriza-
</p>
<p>tions. (Indeed, if necessary, we can interchange the left-hand side and the 
</p>
<p>right-hand side so that the smallest prime in any of the two factorizations 
</p>
<p>occurs on the left-hand side; and then change the order of the factors on 
</p>
<p>the left-hand side so that the smallest factor comes first. In the usual slang 
</p>
<p>of mathematics, we say that we may assume that PI is the smallest prime 
</p>
<p>without loss of generality.) We are going to produce a smaller criminal; this 
</p>
<p>will be a contradiction, since we assumed that n was the smallest one. 
</p>
<p>The number PI cannot occur among the factors qi; otherwise, we can 
</p>
<p>divide both sides by PI and get a smaller criminal. 
</p>
<p>Divide each qi by PI with residue: qi = Plai + ri, where 0 :s: ri &lt; Pl. We 
know that ri =I- 0, since a prime cannot be a divisor of another prime. 
</p>
<p>Let n' = rl r2 ... rk. We show that n' is a smaller criminal. Trivially 
ri &lt; PI &lt; qi, and so n' = rlr2'" rk &lt; qlq2'" qk = n. We show that 
n', too, has two different factorizations into primes. One of these can be 
obtained from the definition n' = rlr2 ... rk. Here the factors may not be 
primes, but we can break them down into products of primes, so that we 
</p>
<p>end up with a decomposition of n'. 
To get another decomposition, we observe that PI I n'. Indeed, we can 
</p>
<p>write the definition of n' in the form 
</p>
<p>and if we expand, then every term will be divisible by Pl. (One of the terms 
</p>
<p>is qlq2 ... qk, which is equal to n and so divisible by Pl. All the other terms 
</p>
<p>contain PI as a factor.) Now we divide n' by PI and then continue to factor 
</p>
<p>n' / PI, to get a factorization of n'. 
But are these two factorizations different? Yes! The prime PI occurs in 
</p>
<p>the second, but it cannot occur in the first, where every prime factor is 
</p>
<p>smaller than Pl' 
</p>
<p>Thus we have found a smaller criminal. Since n was supposed to be 
</p>
<p>the smallest among all criminals, this is a contradiction. The only way 
</p>
<p>to resolve this contradiction is to conclude that there are no criminals; 
</p>
<p>our "indirect assumption" was false, and no integer can have two different 
</p>
<p>prime factorizations. D 
</p>
<p>6.3.1 Read carefully the following "minimal criminal" argument: 
</p>
<p>ASSERTION. Every negative integer is odd. </p>
<p/>
</div>
<div class="page"><p/>
<p>92 6. Integers, Divisors, and Primes 
</p>
<p>PROOF. Suppose, by way of contradiction, that there are negative 
</p>
<p>integers that are even. Call these integers criminals, and let n be a 
</p>
<p>minimal criminal. Consider the number 2n. This is smaller than n 
</p>
<p>(recall that n is negative!), so it is a smaller criminal. But we assumed 
</p>
<p>that n was the smallest criminal, so this is a contradiction. 
</p>
<p>This assertion is obviously wrong. Where is the error in the proof? 
</p>
<p>As an application of Theorem 6.3.1, we prove a fact that was known to the 
</p>
<p>Pythagoreans (students of the great Greek mathematician and philosopher 
</p>
<p>Pythagoras) in the sixth century B.C. 
</p>
<p>Theorem 6.3.2 The number V2 is irrational. 
</p>
<p>(A real number is irrational if it cannot be written as the ratio of two 
</p>
<p>integers. For the Pythagoreans, the question arose from geometry: They 
</p>
<p>wanted to know whether the diagonal of a square is "commeasurable" with 
</p>
<p>its side, that is, whether there is any segment that is contained in both 
</p>
<p>of them an integer number of times. The above theorem answered this 
</p>
<p>question in the negative, causing a substantial turmoil in their ranks.) 
</p>
<p>Proof. We give an indirect proof again: We suppose that V2 is rational, 
and derive a contradiction. What the indirect assumption means is that V2 
can be written as the quotient of two positive integers: V2 = a/b. Squaring 
both sides and rearranging, we get 2b2 = a 2 . 
</p>
<p>Now consider the prime factorization of both sides, and in particular, the 
</p>
<p>prime number 2 on both sides. Suppose that 2 occurs m times in the prime 
</p>
<p>factorization of a and n times in the prime factorization of b. Then it occurs 
</p>
<p>2m times in the prime factorization of a2 . On the other hand, it occurs 2n 
</p>
<p>times in the prime factorization of b2 , and thus it occurs 2n + 1 times in 
the prime factorization of 2b2 . Since 2b2 = a2 , and the prime factorization 
is unique, we must have 2n + 1 = 2m. But this is impossible, since 2n + 1 is 
odd but 2m is even. This contradiction proves that V2 must be irrational. 
o 
</p>
<p>6.3.2 Are there any even primes? 
</p>
<p>6.3.3 (a) Prove that if p is a prime, a and b are integers, and p I ab, then 
either p I a or p I b (or both). 
</p>
<p>(b) Suppose that a and b are integers and a I b. Also suppose that p is a prime 
and p I b but p f a. Prove that p is a divisor of the ratio bl a. 
</p>
<p>6.3.4 Prove that the prime factorization of a number n contains at most log2 n 
</p>
<p>factors. 
</p>
<p>6.3.5 Let p be a prime and 1 .s a .s p - 1. Consider the numbers 
a, 2a, 3a, ... , (p - 1 )a. Divide each of them by p, to get residues 1'1,1'2, ... ,1'p -1. 
</p>
<p>Prove that every integer from 1 to p-l occurs exactly once among these residues. 
</p>
<p>[Hint: First prove that no residue can occur twice.] </p>
<p/>
</div>
<div class="page"><p/>
<p>6.4 On the Set of Primes 93 
</p>
<p>6.3.6 Prove that if p is a prime, then vP is irrational. More generally, prove 
that if n is an integer that is not a square, then fo is irrational. 
</p>
<p>6.3.7 Try to formulate and prove an even more general theorem about the 
</p>
<p>irrationality of the numbers ~. 
</p>
<p>6.4 On the Set of Primes 
</p>
<p>The following theorem was known to Euclid in the third century B. C. 
</p>
<p>Theorem 6.4.1 There are infinitely many primes. 
</p>
<p>Proof. What we need to do is to show that for every positive integer n, 
</p>
<p>there is a prime number larger than n. To this end, consider the number 
</p>
<p>n! + 1, and any prime divisor p of it. We show that p &gt; n. Again, we use an 
indirect proof, supposing that p ::; n and deriving a contradiction. If p ::; n 
</p>
<p>then pin!, since it is one of the integers whose product is n!. We also know 
</p>
<p>that pin! + 1, and so p is a divisor of the difference (n! + 1) - n! = 1. But 
this is impossible, and thus p must be larger than n. 0 
</p>
<p>If we look at various charts or tables of primes, our main impression is 
</p>
<p>that there is a lot of irregularity in them. For example, Figure 6.1 represents 
</p>
<p>each prime up to 1000 by a bar. We see large "gaps", and then we also see 
</p>
<p>primes that are very close. We can prove that these gaps get larger and 
</p>
<p>larger as we consider larger and larger numbers; somewhere out there is 
</p>
<p>a string of 100 consecutive composite numbers; somewhere (much farther 
</p>
<p>away) there is a string of 1000 consecutive composite numbers, etc. To state 
</p>
<p>this in a mathematical form: 
</p>
<p>Theorem 6.4.2 For every positive integer k, there exist k consecutive 
</p>
<p>composite integers. 
</p>
<p>Proof. We can prove this theorem by an argument quite similar to the 
</p>
<p>proof of Theorem 6.4.1. Let n = k + 1 and consider the numbers 
</p>
<p>n! + 2, n! + 3, ... , n! + n. 
</p>
<p>Can any of these be a prime? The answer is no: The first number is even, 
</p>
<p>since n! and 2 are both even. The second number is divisible by 3, since 
</p>
<p>n! and 3 are both divisible by 3 (assuming that n &gt; 2). In general n! + i 
is divisible by i, for every i = 2,3, ... ,n. Hence these numbers cannot be 
primes, and so we have found n - 1 = k consecutive composite numbers. 0 
</p>
<p>What about the opposite question, finding primes very close to each 
</p>
<p>other? Since all primes except 2 are odd, the difference between two primes </p>
<p/>
</div>
<div class="page"><p/>
<p>94 6. Integers, Divisors, and Primes 
</p>
<p>must be at least two, except for 2 and 3. Two primes whose difference is 2 
</p>
<p>are called twin primes. Thus (3,5), (5,7), (11,13), (17,19) are twin primes. 
</p>
<p>Looking at the table of the primes up to 500, we find many twin primes; 
</p>
<p>extensive computation shows that there are twin primes with hundreds of 
</p>
<p>digits. However, it is not known whether there are infinitely many twin 
</p>
<p>primes! (Almost certainly there are, but no proof of this fact has been 
</p>
<p>found, in spite of the efforts of many mathematicians for over 2000 years!) 
</p>
<p>Another way of turning Theorem 6.4.2 around is to ask, how large can 
</p>
<p>these gaps be, relative to where they are on the number line? Could it 
</p>
<p>happen that there is no prime at all with, say, 100 digits? This is again a 
</p>
<p>very difficult question, but here we do know the answer. (No, this does not 
</p>
<p>happen.) 
</p>
<p>25 
</p>
<p>20 
</p>
<p>15 
</p>
<p>10 
</p>
<p>5 
</p>
<p>o 20 40 60 80 100 
</p>
<p>FIGURE 6.2. The graph of 7f(n) from 1 to 100. 
</p>
<p>One of the most important questions about primes is, how many primes 
</p>
<p>are there up to a given number n? We denote the number of primes up to 
</p>
<p>n by 7f(n). Figure 6.2 illustrates the graph of this function in the range 1 to 
</p>
<p>100, and Figure 6.3 shows the range 1 to 2000. We can see that the function 
</p>
<p>grows reasonably smoothly, and that its slope decreases slowly. An exact 
</p>
<p>formula for 7f(n) is certainly impossible to obtain. Around 1900, a powerful 
</p>
<p>result called the Prime Number Theorem was proved by Hadamard and de 
</p>
<p>la Vallee Poussin. </p>
<p/>
</div>
<div class="page"><p/>
<p>6.4 On the Set of Primes 95 
</p>
<p>300 
</p>
<p>250 
</p>
<p>200 
</p>
<p>150 
</p>
<p>100 
</p>
<p>50 
</p>
<p>o 
</p>
<p>FIGURE 6.3. The graph of 1l'(n) from 1 to 2000. 
</p>
<p>Theorem 6.4.3 (The Prime Number Theorem) Let 1l'(n) denote the 
</p>
<p>number of primes among 1,2, ... , n. Then 
</p>
<p>n 
?T(n) rv -1 -. 
</p>
<p>nn 
</p>
<p>(Here ln n means the "natural logarithm," i.e., to logarithm to the base 
</p>
<p>e = 2.718281 .... Also recall that the notation means that the quotient 
</p>
<p>1l'(n) / l:n 
</p>
<p>will be arbitrarily close to 1 as n gets large.) 
</p>
<p>The proof of the Prime Number Theorem is very difficult; the fact that 
</p>
<p>the number of primes up to n is about n/ ln n was observed empirically in 
</p>
<p>the eighteenth century, but it took more than 100 years until Hadamard 
</p>
<p>and de la Vallee Poussin proved it in 1896. 
</p>
<p>As an illustration of the use of this theorem, let us find the answer to a 
</p>
<p>question that we have posed in the introduction: How many primes with 
</p>
<p>(say) 200 digits are there? We get the answer by subtracting the number of 
</p>
<p>primes up to 10199 from the number of primes up to 10200 . By the Prime 
</p>
<p>N umber Theorem, this number is about 
</p>
<p>10200 
</p>
<p>200 ln 10 
</p>
<p>10199 
--- ~ 1.95.10197 . 
199 ln 10 </p>
<p/>
</div>
<div class="page"><p/>
<p>96 6. Integers, Divisors, and Primes 
</p>
<p>This is a lot of primes! Comparing this with the total number of positive 
</p>
<p>integers with 200 digits, which we know is 10200 - 10199 = 9.10199 , we get 
</p>
<p>9.10199 
</p>
<p>1.95 . 10197 R;j 460. 
</p>
<p>Thus among the integers with 200 digits, about one in every 460 is a prime. 
</p>
<p>(Warning: This argument is not precise; the main source of concern is 
</p>
<p>that in the Prime Number Theorem we stated only that 7f(n) is close to 
nj ln n if n is sufficiently large. One can say more about how large n has 
</p>
<p>to be to have, say, an error less than 1 percent, but this leads to even more 
</p>
<p>difficult questions, which are even today not completely resolved.) 
</p>
<p>There are many other simple observations one can make by looking at 
</p>
<p>tables of primes, but they tend to be very difficult, and most of them are not 
</p>
<p>resolved even today, in some cases after 2,500 years of attempts. We have 
</p>
<p>already mentioned the problem of twin primes. Another famous unsolved 
</p>
<p>problem is Goldbach's conjecture. This states that every even integer larger 
</p>
<p>than 2 can be written as the sum of two primes. Goldbach also formulated 
</p>
<p>a conjecture about odd numbers: Every odd integer larger than 5 can be 
</p>
<p>written as the sum of three primes. This second conjecture was essentially 
</p>
<p>proved, using very deep methods, by Vinogradov in the 1930s. We said 
</p>
<p>"essentially" since the proof works only for numbers that are very large, 
</p>
<p>and the possibility of a finite number of exceptions remains open. 
</p>
<p>Suppose that we have an integer n and want to know how soon after n 
</p>
<p>we can be sure of finding a prime. For example, how small, or large, is the 
</p>
<p>first prime with at least 100 digits? Our proof of the infinitude of primes 
</p>
<p>gives that for every n there is a prime between nand n! + 1. This is a very 
</p>
<p>week statement; it says, for example, that there is a prime between 10 and 
</p>
<p>1O!+1 = 3,628,801, while of course the next prime is 11. The Russian math-
ematician P.L. Chebyshev proved in the mid-nineteenth century that there 
</p>
<p>is always a prime between nand 2n. It has now been proved that there is 
</p>
<p>always a prime between two consecutive cubes (say, between 103 = 1000 
</p>
<p>and 113 = 1331). But it is another old, famous, and still unsolved prob-
lem whether there is always a prime between two consecutive squares. (Try 
</p>
<p>this out: you'll in fact find many primes. For example, between 100 = 102 
and 121 = 112 we find 101, 103, 107, 109, 113. Between 1002 = 10,000 
and 1012 = 10,201 we find 10,007, 10,009, 10,037, 10,039, 10,061, 10,067, 
10,069, 10,079, 10,091, 10,093, 10,099, 10,103, 10,111, 10,133, 10,139, 
</p>
<p>10,141, 10,151, 10,159, 10,163, 10,169, 10,177, 10,181, 10,193.) 
</p>
<p>6.4.1 Show that among k-digit numbers, one in about every 2.3k is a prime. </p>
<p/>
</div>
<div class="page"><p/>
<p>6.5 Fermat's "Little" Theorem 97 
</p>
<p>Pierre de Fermat 
</p>
<p>6.5 Fermat's "Little" Theorem 
</p>
<p>Primes are important because we can compose every integer from them; but 
</p>
<p>it turns out that they also have many other, often surprising, properties. 
</p>
<p>One of these was discovered by the French mathematician Pierre de Fermat 
</p>
<p>(1601-1655), now called the "Little" Theorem of Fermat. 
</p>
<p>Theorem 6.5.1 (Fermat's Theorem) If p is a prime and a is an inte-
</p>
<p>ger, then p I aP - a. 
</p>
<p>Before proving this theorem, we remark that it is often stated in the 
</p>
<p>following form: If p is a prime and a is an integer not divisible by p, then 
</p>
<p>(6.1) 
</p>
<p>The fact that these two assertions are equivalent (in the sense that if we 
</p>
<p>know the truth of one, it is easy to prove the other) is left to the reader as 
</p>
<p>Exercise 6.10.20. 
</p>
<p>To prove Fermat's Theorem, we need a lemma, which states another 
</p>
<p>divisibility property of primes (but is easier to prove): 
</p>
<p>Lemma 6.5.2 If p is a prime and 0 &lt; k &lt; p, then p 1m. 
</p>
<p>Proof. We know by Theorem 1.8.1 that 
</p>
<p>(
p) = pep - 1) ... (p - k + 1). 
k k(k - 1) ... 1 </p>
<p/>
</div>
<div class="page"><p/>
<p>98 6. Integers, Divisors, and Primes 
</p>
<p>Here p divides the numerator, but not the denominator, since all factors in 
</p>
<p>the denominator are smaller than p, and we know by Exercise 6.3.3(a) that 
</p>
<p>if a prime p does not divide any of these factors, then it does not divide 
</p>
<p>the product. Hence it follows (see Exercise 6.3.3(b)) that p is a divisor of 
</p>
<p>(~). [] 
</p>
<p>Proof [of Theorem 6.5.1]. Now we can prove Fermat's Theorem by induc-
</p>
<p>tion on a. The assertion is trivially true if a = O. Let a &gt; 0, and write 
a = b + 1. Then 
</p>
<p>aP - a = (b + 1)P - (b + 1) 
</p>
<p>=bP+ (~)bP-l+ ... + (P~I)b+l-b-l 
= (bP - b) + (n bP- 1 + ... + C ~ 1) b. 
</p>
<p>Here the expression bP - b in parenthesis is divisible by p by the induction 
</p>
<p>hypothesis, while the other terms are divisible by p by lemma 6.5.2. It 
</p>
<p>follows that aP - a is also divisible by p, which completes the induction. [] 
</p>
<p>Let us make a remark about the history of mathematics here. Fermat is 
</p>
<p>most famous for his "last" Theorem, which is the following assertion: 
</p>
<p>If n &gt; 2, then the sum of the nth powers of two positive integers 
is never the nth power of a positive integer. 
</p>
<p>(The assumption that n &gt; 2 is essential: There are examples of two squares 
whose sum is a third square. For example, 32 + 42 = 52, or 52 + 122 = 132. 
In fact, there are infinitely many such triples of squares, see Exercise 6.6.7.) 
</p>
<p>Fermat claimed in a note that he had proved this, but never wrote down 
</p>
<p>the proof. This statement remained perhaps the most famous unsolved 
</p>
<p>problem in mathematics until 1995, when Andrew Wiles (in one part with 
</p>
<p>the help of Robert Taylor) finally proved it. 
</p>
<p>6.5.1 Show by examples that neither the assertion in lemma 6.5.2 nor Fermat's 
</p>
<p>"Little" Theorem remains valid if we drop the assumption that p is a prime. 
</p>
<p>6.5.2 Consider a regular p-gon, and for a fixed k (1 ::; k ::; p - 1), consider all 
</p>
<p>k-subsets of the set of its vertices. Put all these k-subsets into a number of boxes: 
</p>
<p>We put two k-subsets into the same box if they can be rotated into each other. 
</p>
<p>For example, all k-subsets consisting of k consecutive vertices will belong to one 
</p>
<p>and the same box. 
</p>
<p>(a) Prove that if p is a prime, then each box will contain exactly p of these 
</p>
<p>rotated copies. 
</p>
<p>(b) Show by an example that (a) does not remain true if we drop the assump-
</p>
<p>tion that p is a prime. </p>
<p/>
</div>
<div class="page"><p/>
<p>6.6 The Euclidean Algorithm 99 
</p>
<p>(c) Use (a) to give a new proof of Lemma 6.5.2. 
</p>
<p>6.5.3 Imagine numbers written in base a, with at most p digits. Put two num-
bers in the same box if they arise by a cyclic shift from each other. How many 
will be in each class? Give a new proof of Fermat's Theorem this way. 
</p>
<p>6.5.4 Give a third proof of Fermat's "Little" Theorem based on Exercise 6.3.5. 
[Hint: Consider the product a(2a) (3a) '" ((p - l)a).] 
</p>
<p>6.6 The Euclidean Algorithm 
</p>
<p>So far, we have discussed several notions and results concerning integers. 
</p>
<p>Now we turn our attention to the question of how to do computations in 
</p>
<p>connection with these results. How do we decide whether or not a given 
</p>
<p>number is a prime? How do we find the prime factorization of a number? 
</p>
<p>We can do basic arithmetic--addition, subtraction, multiplication, divi-
</p>
<p>sion with remainder-efficiently, and we will not discuss this here. 
</p>
<p>The key to a more advanced algorithmic number theory is an algorithm 
</p>
<p>that computes the greatest common divisor of two positive integers a and 
</p>
<p>b. This is defined as the largest positive integer that is a divisor of both 
</p>
<p>a and b. (Since 1 is always a common divisor, and no common divisor is 
</p>
<p>larger than either integer, this definition makes sense: There is always at 
</p>
<p>least one common divisor, and in the set of common divisors there must be 
</p>
<p>a greatest element.) The greatest common divisor of a and b is denoted by 
</p>
<p>gcd(a, b). Thus 
</p>
<p>gcd(I,6) = 1, 
</p>
<p>gcd( 4,6) = 2, 
</p>
<p>gcd(2,6) = 2, 
</p>
<p>gcd(5,6) = 1, 
</p>
<p>gcd(3, 6) = 3, 
</p>
<p>gcd(6,6) = 6. 
</p>
<p>We say that two integers are relatively prime if their greatest common 
</p>
<p>divisor is 1. It will be convenient to define gcd(a, 0) = a for every a;:::: O. 
</p>
<p>A somewhat similar notion is the least common multiple of two integers, 
</p>
<p>which is the least positive integer that is a multiple of both integers. It is 
</p>
<p>denoted by lcm( a, b). For example, 
</p>
<p>lcm(I, 6) = 6, 
</p>
<p>lcm( 4, 6) = 12, 
</p>
<p>lcm(2,6) = 6, 
</p>
<p>lcm(5,6) = 30, 
</p>
<p>lcm(3,6) = 6, 
</p>
<p>lcm( 6,6) = 6. 
</p>
<p>The greatest common divisor of two positive integers can be found quite 
</p>
<p>simply by using their prime factorizations: Look at the common prime 
</p>
<p>factors, raise each to the smaller of the two exponents, and take the product 
</p>
<p>of these prime powers. For example, 900 = 22 . 32 . 52 and 54 = 2 . 33 , and 
</p>
<p>hence gcd(900, 54) = 2.32 = 18. </p>
<p/>
</div>
<div class="page"><p/>
<p>100 6. Integers, Divisors, and Primes 
</p>
<p>The trouble with this method is that it is very difficult to find the prime 
</p>
<p>factorization of large integers. The algorithm to be discussed in this sec-
</p>
<p>tion will compute the greatest common divisor of two integers in a much 
</p>
<p>faster way, without finding their prime factorizations. This algorithm is an 
</p>
<p>important ingredient of almost all other algorithms involving computation 
</p>
<p>with integers. (And, as we see it from its name, it goes back to the great 
</p>
<p>Greek mathematician Euclid!) 
</p>
<p>6.6.1 Show that if a and b are positive integers with a I b, then gcd(a, b) = a. 
</p>
<p>6.6.2 (a) Prove that gcd(a, b) = gcd(a, b - a). 
</p>
<p>(b) Let r be the remainder if we divide b by a. Then gcd(a, b) = gcd(a, r). 
</p>
<p>6.6.3 (a) If a is even and b is odd, then gcd(a, b) = gcd(a/2, b). 
</p>
<p>(b) If both a and b are even, then gcd(a, b) = 2gcd(a/2, b/2). 
</p>
<p>6.6.4 How can you express the least common multiple of two integers if you 
</p>
<p>know the prime factorization of each? 
</p>
<p>6.6.5 Suppose that you are given two integers, and you know the prime factor-
</p>
<p>ization of one of them. Describe a way of computing the greatest common divisor 
</p>
<p>of these numbers. 
</p>
<p>6.6.6 Prove that for any two integers a and b, 
</p>
<p>gcd(a, b)lcm(a, b) = abo 
</p>
<p>6.6.7 Three integers a, b, and c form a Pythagorean triple if a2 + b2 = c2 &bull; 
</p>
<p>(a) Choose any three integers x, y, and z, and let a = 2xyz, b = (x 2 - y2)Z, 
</p>
<p>C = (x2 + y2)Z. Check that (a, b, c) is a Pythagorean triple. 
</p>
<p>(b) Prove that all Pythagorean triples arise this way: If a, b, c are integers such 
</p>
<p>that a2 + b2 = c2 , then there are other integers x, y, and Z such that a, b, 
and c can be expressed by the formulas above. 
</p>
<p>[Hint: First, show that the problem can be reduced to the case where 
</p>
<p>gcd(a, b, c) = 1, a is even, and b, c are odd. Second, write a2 = (b - c) (b+ c) 
</p>
<p>and use this to argue that (b + c) /2 and b - c) /2 are squares.] 
</p>
<p>Now we turn to the Euclidean Algorithm. It is based on two simple facts, 
</p>
<p>already familiar as Exercises 6.6.1 and 6.6.2. 
</p>
<p>Suppose that we are given two positive integers a and b, and we want to 
</p>
<p>find their greatest common divisor. Here is what we do: 
</p>
<p>1. If a &gt; b then we interchange a and b. 
</p>
<p>2. If a &gt; 0, divide b by a, to get a remainder r. Replace b by rand 
return to 1. </p>
<p/>
</div>
<div class="page"><p/>
<p>6.6 The Euclidean Algorithm 101 
</p>
<p>3. Else (if a = 0), return b as the g.c.d. and halt. 
</p>
<p>When you carry out the algorithm, especially by hand, there is no reason 
</p>
<p>to interchange a and b if a &lt; b: we can simply divide the larger number 
by the smaller (with remainder), and replace the larger number by the 
</p>
<p>remainder if the remainder is not O. Let us do some examples. 
</p>
<p>gcd(300, 18) = gcd(12, 18) = gcd(12, 6) = 6. 
</p>
<p>gcd(101, 100) = gcd(l, 100) = 1. 
</p>
<p>gcd(89, 55) = gcd(34, 55) = gcd(34, 21) = gcd(13, 21) = gcd(13, 8) 
</p>
<p>= gcd(5, 8) = gcd(5, 3) = gcd(2, 3) = gcd(2, 1) = 1. 
</p>
<p>You can check in each case (using the prime factorization of the numbers) 
</p>
<p>that the result is indeed the g.c.d. 
</p>
<p>If we describe an algorithm, the first thing to worry about is whether it 
</p>
<p>terminates at all. So why is the Euclidean Algorithm finite? This is easy: 
</p>
<p>The numbers never increase, one of them decreases whenever step 2 is 
</p>
<p>executed, and the remain nonnegative; so the whole procedure cannot last 
</p>
<p>infinitely long. 
</p>
<p>Then, of course, we have to make sure that our algorithm yields what we 
</p>
<p>need. This is clear: Step 1 (interchanging the numbers) trivially does not 
</p>
<p>change the greatest common divisor; step 3 (replacing the larger number by 
</p>
<p>the remainder of a division) does not change the greatest common divisor 
</p>
<p>by Exercise 6.6.2(b). And when we halt at step 2, the number returned is 
</p>
<p>indeed the greatest common divisor of the two current numbers by Exercise 
</p>
<p>6.6.1. 
</p>
<p>A third, and more subtle, question you should ask when designing an 
</p>
<p>algorithm: How long does it take? How many steps will it make before 
</p>
<p>it terminates? We can get a bound from the argument that proves finite 
</p>
<p>termination: Since one or the other number decreases any time the loop 
</p>
<p>of steps 1 and 2 is executed, it will certainly halt in fewer than a + b 
iterations. This is really not a great time bound: If we apply the Euclidean 
</p>
<p>Algorithm to two numbers with 100 digits, then this bound of a + b says 
that it will not last longer than 2 . 10100 steps, which is an astronomical 
</p>
<p>number, and therefore useless. But luckily this is only an upper bound, and 
</p>
<p>a most pessimistic one at that; the examples we considered seem to show 
</p>
<p>that the algorithm terminates much faster than this. 
</p>
<p>But the examples also suggest that this question is quite delicate. We see 
</p>
<p>that the Euclidean Algorithm may be quite different in length, depending 
</p>
<p>on the numbers in question. Some of the possible observations made from 
</p>
<p>these examples are contained in the following exercises. 
</p>
<p>6.6.8 Show that the Euclidean Algorithm can terminate in two steps for arbi-
</p>
<p>trarily large positive integers, even if their g.c.d. is l. </p>
<p/>
</div>
<div class="page"><p/>
<p>102 6. Integers, Divisors, and Primes 
</p>
<p>6.6.9 Describe the Euclidean Algorithm applied to two consecutive Fibonacci 
</p>
<p>numbers. Use your description to show that the Euclidean Algorithm can take 
</p>
<p>arbitrarily many steps. 
</p>
<p>So what can we say about how long the Euclidean Algorithm lasts? The 
</p>
<p>key to the answer is the following lemma: 
</p>
<p>Lemma 6.6.1 During the execution of the Euclidean Algorithm, the prod-
</p>
<p>uct of the two current numbers drops by a factor of at least 2 in each 
</p>
<p>iteration. 
</p>
<p>Proof. To see that this is so, consider the step where the pair (a, b) (a &lt; b) 
is replaced by the pair (r, a) (recall that r is the remainder of b when divided 
</p>
<p>by a). Then we have r &lt; a and a + r ::; b. Hence b 2: a + r &gt; 2r, and so 
ar &lt; ~ab as claimed. 0 
</p>
<p>Suppose that we apply the Euclidean Algorithm to two numbers a and 
</p>
<p>b and we make k steps. It follows by Lemma 6.6.1 that after the k steps, 
</p>
<p>the product of the two current numbers will be at most ab 12k. Since this 
</p>
<p>is a positive integer and so at least 1, we get that 
</p>
<p>and hence 
</p>
<p>k ::; 10g2 (ab) = 10g2 a + 10g2 b. 
</p>
<p>Thus we have proved the following. 
</p>
<p>Theorem 6.6.2 The number of steps of the Euclidean Algorithm applied 
</p>
<p>to two positive integers a and b is at most 10g2 a + 10g2 b. 
</p>
<p>We have replaced the sum of the numbers by the sum of the logarithms of 
</p>
<p>the numbers in the bound on the number of steps, which is a really substan-
</p>
<p>tial improvement. For example, the number of iterations in computing the 
</p>
<p>g.c.d. of two 300-digit integers is less than 210g2 10300 = 60010g2 10 &lt; 2000. 
Quite a bit less than 2&middot; 10300 , which was our first naive estimate! Note that 
</p>
<p>10g2 a is less than the number of bits of a (when written in base 2), so we 
</p>
<p>can say that the Euclidean Algorithm does not take more iterations than 
</p>
<p>the number of bits needed to write down the numbers in base 2. 
</p>
<p>The theorem above gives only an upper bound on the number of steps 
</p>
<p>the Euclidean Algorithm takes; we can be much luckier. For example, when 
</p>
<p>we apply the Euclidean Algorithm to two consecutive integers, it takes only 
</p>
<p>one step. But sometimes, one cannot do much better. If you did exercise 
</p>
<p>6.6.9, you saw that when applied to two consecutive Fibonacci numbers Fk 
</p>
<p>and FkH, the Euclidean Algorithm takes k - 1 steps. On the other hand, </p>
<p/>
</div>
<div class="page"><p/>
<p>6.6 The Euclidean Algorithm 103 
</p>
<p>the lemma above gives the bound 
</p>
<p>( 1 + vis) = -10g2 5 + (2k + 1) 10g2 -2- R::i 1.388k - 1.628, 
so we have overestimated the number of steps only by a factor of about 
</p>
<p>1.388, or less than 40%. 
</p>
<p>Fibonacci numbers are not only good for giving examples of large num-
</p>
<p>bers for which we can see how the Euclidean Algorithm works; they are 
</p>
<p>also useful in obtaining an even better bound on the number of steps. We 
</p>
<p>state the result as an exercise. Its content is that, in a sense, the Euclidean 
</p>
<p>Algorithm is longest on two consecutive Fibonacci numbers. 
</p>
<p>6.6.10 Suppose that a &lt; b and the Euclidean Algorithm applied to a and b 
takes k steps. Prove that a :2: Fk and b :2: Fk+l. 
</p>
<p>6.6.11 Consider the following version of the Euclidean Algorithm to compute 
</p>
<p>gcd(a, b): (1) Swap the numbers if necessary to have a ::; b; (2) if a = 0, then 
</p>
<p>return b; (3) if a "# 0, then replace b by b - a and go to (1). 
</p>
<p>(a) Carry out this algorithm to compute gcd(19, 2). 
</p>
<p>(b) Show that the modified Euclidean Algorithm always terminates with the 
</p>
<p>right answer. 
</p>
<p>(c) How long does this algorithm take, in the worst case, when applied to two 
</p>
<p>100-digit integers? 
</p>
<p>6.6.12 Consider the following version of the Euclidean Algorithm to compute 
</p>
<p>gcd(a, b). Start with computing the largest power of 2 dividing both a and b. If 
</p>
<p>this is 2T, then divide a and b by 2T. After this "preprocessing," do the following: 
</p>
<p>(1) Swap the numbers if necessary to have a ::; b. 
</p>
<p>(2) If a "# 0, then check the parities of a and b; if a is even, and b is odd, then 
replace a by a/2; if both a and b are odd, then replace b by b - a; in each 
</p>
<p>case, go to (1). 
</p>
<p>(3) if a = 0, then return 2T b as the g.c.d. 
</p>
<p>Now come the exercises: 
</p>
<p>(a) Carry out this algorithm to compute gcd(19, 2). 
</p>
<p>(b) It seems that in step (2), we ignored the case where both a and b are even. 
</p>
<p>Show that this never occurs. 
</p>
<p>(c) Show that the modified Euclidean Algorithm always terminates with the 
</p>
<p>right answer. </p>
<p/>
</div>
<div class="page"><p/>
<p>104 6. Integers, Divisors, and Primes 
</p>
<p>(d) Show that this algorithm, when applied to two 100-digit integers, does not 
</p>
<p>take more than 1500 iterations. 
</p>
<p>The Euclidean Algorithm gives much more than just the greatest com-
</p>
<p>mon divisor of the two numbers. The main observation is that if we carry 
</p>
<p>out the Euclidean Algorithm to compute the greatest common divisor of 
</p>
<p>two positive integers a and b, all the numbers we produce during the com-
</p>
<p>putation can be written as the sum of an integer multiple of a and an 
</p>
<p>integer multiple of b. 
</p>
<p>As an example, let's recall the computation of gcd(300, 18): 
</p>
<p>gcd(300, 18) = gcd(12, 18) = gcd(12, 6) = 6. 
</p>
<p>Here the number 12 was obtained as the remainder of the division 300 --;-
</p>
<p>18; this means that it was obtained by subtracting from 300 the highest 
</p>
<p>multiple of 18 that is smaller that 300: 12 = 300 - 16&middot; 18. Let's record it 
in this form: 
</p>
<p>gcd(300, 18) = gcd(300 - 16&middot;18,18). 
</p>
<p>Next, we obtained 6 by subtracting 12 from 18, which we can do so that 
</p>
<p>we maintain the form of (multiple of 300)+(multiple of 18): 
</p>
<p>gcd(300 - 16 . 18,18) = gcd(300 - 16&middot; 18,17&middot; 18 - 300). 
</p>
<p>So it follows that the g.c.d. itself, namely 6, is of this form: 
</p>
<p>6 = 17 . 18 - 300. 
</p>
<p>Let us prove formally that all the numbers produced by the Euclidean 
</p>
<p>Algorithm for gcd( a, b) can be written as the sum of an integer multiple of 
a and an integer multiple of b. Suppose that this holds for two consecutive 
</p>
<p>numbers we computed, so that one is a' = am + bn, and the other is 
b' = ak + bZ, where m, n, k, Z are integers (not necessarily positive). Then 
in the next step we compute (say) the remainder of b' modulo ai, which is 
</p>
<p>a' - qb' = (am + bn) - q(ak + bZ) = a(m - qk) + b(n - ql), 
</p>
<p>which is of the right form again. 
</p>
<p>In particular, we get the following: 
</p>
<p>Theorem 6.6.3 Let d = gcd(a, b). Then d can be written in the form 
</p>
<p>d = am+bn, 
</p>
<p>where m and n are integers. 
</p>
<p>As in the example worked out above, we can maintain the representation 
</p>
<p>of integers in the form am+bn during the computation. This shows that the 
</p>
<p>expression for d in the theorem not only exists, but is easily computable. </p>
<p/>
</div>
<div class="page"><p/>
<p>6.7 Congruences 105 
</p>
<p>6.7 Congruences 
</p>
<p>Notation is not part of the bare logical structure of mathematics: we could 
</p>
<p>denote the set of real numbers by V, or addition by #, and the meaning 
of mathematical results would be the same. But a good notation may be 
</p>
<p>wonderfully suggestive, leading to a real conceptual breakthrough. One 
</p>
<p>such important step was taken when Carl Friedrich Gauss noticed that 
</p>
<p>we use the phrase "a gives the same remainder as b when divided by m" 
</p>
<p>very often, and that this relation behaves quite similarly to equality. He 
</p>
<p>introduced a notation for this, called congruence. 
</p>
<p>FIGURE 6.4. Carl Friedrich Gauss (1777- 1855). 
</p>
<p>If a and b give the same remainder when divided by m (where a, b, mare 
</p>
<p>integers and m &gt; 0), then we write 
</p>
<p>a == b (mod m) 
</p>
<p>(read: a is congruent to b modulo m). An equivalent way of saying this is 
</p>
<p>that m is a divisor of b - a. The number m is called the modulus of the 
</p>
<p>congruence relation. 
</p>
<p>This notation suggests that we want to consider this relation as an ana-
</p>
<p>logue of equality. And indeed, many of the properties of equality are valid 
</p>
<p>for congruences, at least if we keep the modulus m fixed. We have reflexiv-
</p>
<p>ity, 
</p>
<p>a == a (mod m), 
</p>
<p>symmetry, 
</p>
<p>a == b (mod m) b == a (mod m), </p>
<p/>
</div>
<div class="page"><p/>
<p>106 6. Integers, Divisors, and Primes 
</p>
<p>and transitivity, 
</p>
<p>a == b (mod m), b==c (modm) a == c (mod m). 
</p>
<p>These are trivial if we think of the congruence relation as claiming equality: 
</p>
<p>namely, equality of the remainders when divided by m. 
</p>
<p>We can compute with congruences just as we can with equations. If we 
</p>
<p>have two congruences with the same modulus, 
</p>
<p>a == b (mod m) and c == d (mod m), 
</p>
<p>then we can add them, subtract them, and multiply them to get 
</p>
<p>a + c == b + d (mod m), a - c == b - d (mod m), ac == bd (mod m) 
</p>
<p>(we'll return to division later). A useful special case of the multiplication 
</p>
<p>rule is that we can multiply both sides of a congruence by the same number: 
</p>
<p>if a == b (mod m), then ka == kb (mod m) for every integer k. 
These properties need to be proved, however. By hypothesis, a - band 
</p>
<p>c - d are divisible by m. To see that congruences can be added, we must 
</p>
<p>verify that (a + c) - (b + d) is divisible by m. To this end, we write it in 
the form (a - b) + (c - d), which shows that it is the sum of two integers 
divisible by m and so it is also divisible by m. 
</p>
<p>The proof that congruences can be subtracted is very similar, but mul-
</p>
<p>tiplication is a bit trickier. We have to show that ac - bd is divisible by m. 
</p>
<p>To this end, we write it in the form 
</p>
<p>ac-bd= (a-b)c+b(c-d). 
</p>
<p>Here a - band c - d are divisible by m, and hence so are (a - b)c and 
b(c - d), and hence so is their sum. 
</p>
<p>The congruence notation is very convenient in formulating various state-
</p>
<p>ments and arguments about divisibility. For example, Fermat's Theorem 
</p>
<p>(Theorem 6.5.1) can be stated as follows: If p is a prime then 
</p>
<p>aP == a (mod p). 
</p>
<p>6.7.1 What is the largest integer m for which 12345 == 54321 (mod m)? 
</p>
<p>6.7.2 Which of the following "rules" are true? 
</p>
<p>(a) a==b (mode) =} a+xo:=b+x (mode+x); 
</p>
<p>(b) a == b (mod e) =} ax 0:= bx (mod ex). 
</p>
<p>a 0:= b (mod e) } 
(c) =} a + x == b + y (mod e + z); 
</p>
<p>x == y (mod z) 
</p>
<p>(d) =} ax 0:= by (mod ez). 
a == b (mod e) } 
x 0:= y (mod z) </p>
<p/>
</div>
<div class="page"><p/>
<p>6.8 Strange Numbers 107 
</p>
<p>6.7.3 How would you define a == b (mod O)? 
</p>
<p>6.7.4 (a) Find two integers a and b such that 2a == 2b (mod 6), but a =f:-
b (mod 6). (b) Show that if e -# 0 and ae == be (mod me), then a == b (mod m). 
</p>
<p>6.7.5 Let p be a prime. Show that if X,y,U,v are integers such that x == 
y (mod p), u, v&gt; 0, and u == y (mod p - 1), then XU == yV (mod p). 
</p>
<p>6.8 Strange Numbers 
</p>
<p>What is Thursday + Friday? 
</p>
<p>If you don't understand the question, ask a child. He/she will tell you 
</p>
<p>that it is Tuesday. (There may be some discussion as to whether the week 
</p>
<p>starts with Monday or Sunday; but even if we feel it starts with Sunday, 
</p>
<p>we can still say that Sunday is day 0.) 
</p>
<p>Now we should not have difficulty figuring out that Wednesday . 
</p>
<p>Tuesday = Saturday, Thursday2 = Tuesday, Monday - Saturday = 
</p>
<p>Tuesday, etc. 
</p>
<p>This way we can do arithmetic operations with the days of the week: 
</p>
<p>We have introduced a new number system! In this system there are only 7 
</p>
<p>numbers, which we call Su, Mo, Tu, We, Th, Fr, Sa, and we can carry out 
</p>
<p>addition, subtraction, and multiplication just as with numbers (we could 
</p>
<p>call them Sleepy, Dopey, Happy, Sneezy, Grumpy, Doc, and Bashful; what 
</p>
<p>is important is how the arithmetic operations work). 
</p>
<p>Not only can we define these operations; they work pretty much like 
</p>
<p>operations with integers. Addition and multiplication are commutative, 
</p>
<p>Tu + Fr = Fr + Tu, Tu . Fr = Fr . Tu, 
</p>
<p>and associative, 
</p>
<p>(Mo + We) + Fr = Mo + (We + Fr), (Mo&middot; We) . Fr = Mo&middot; (We&middot; Fr), 
</p>
<p>and distributive, 
</p>
<p>(Mo + We) . Fr = (Mo&middot; Fr) + (We&middot; Fr). 
</p>
<p>Subtraction is the inverse of addition: 
</p>
<p>(Mo + We) - We = Mo. 
</p>
<p>Sunday acts like 0: 
</p>
<p>We+Su=We, We&middot; Su = Su, 
</p>
<p>and Monday acts like 1: 
</p>
<p>We&middot;Mo=We. </p>
<p/>
</div>
<div class="page"><p/>
<p>108 6. Integers, Divisors, and Primes 
</p>
<p>All this is nothing new if we think of "Monday" as 1, "Tuesday" as 2, 
</p>
<p>etc., and realize that since day 8 is Monday again, we have to replace the 
</p>
<p>result of any arithmetic operation by its remainder modulo 7. All the above 
</p>
<p>identities express congruence relations, and are immediate from the basic 
</p>
<p>properties of congruences. 
</p>
<p>What about division? In some cases, this is obvious. For example, what 
</p>
<p>is Sa/We? Translating to integers, this is 6/3, which is 2, i.e., Tu. Check: 
</p>
<p>Tu&middot; We = Sa. 
But what is Tu/We? In our more familiar number systems, this would 
</p>
<p>be 2/3, which is not an integer; in fact, rational numbers were introduced 
</p>
<p>precisely so that we could talk about the result of all divisions (except 
</p>
<p>divisions by 0). Do we have to introduce "fractional days of the week"? 
It turns out that this new number system (with only 7 "numbers") is 
</p>
<p>nicer! What does Tu/We mean? It is a "number" X such that X&middot; We = Tu. 
But it is easy to check that We . We = Tu; so we have (or at least it seems 
to make sense to say that we have) that Tu/We = We. 
</p>
<p>This gives an example showing that we may be able to carry out division 
</p>
<p>without introducing new "numbers" (or new days of the week), but can 
</p>
<p>we always carry out the division? To see how this works, let's take another 
</p>
<p>division: We/Fr, and let's try not to guess the result; instead, call it X and 
show that one of the days of the week must be appropriate for X. 
</p>
<p>So let X = We/Fr. This means that X . Fr = We. For each day X of the 
week, the product X . Fr is some day of the week. 
</p>
<p>The main claim is that for different days X, the products X . Fr are all 
different. Indeed, suppose that 
</p>
<p>X&middot; Fr = y. Fr. 
</p>
<p>Then 
</p>
<p>(X - Y) . Fr = Su (6.2) 
</p>
<p>(we used here the distributive law and the fact that Sunday acts like 0). 
</p>
<p>Now, Sunday is analogous to 0 also in the sense that just as the product 
</p>
<p>of two nonzero numbers is nonzero, the product of two non-Sunday days is 
</p>
<p>non-Sunday. (Check!) So we must have X - Y = Su, or X = Y + Su = Y. 
So the days X . Fr are all different, and there are seven of them, so every 
</p>
<p>day of the week must occur in this form. In particular, "We" will occur. 
</p>
<p>This argument works for any division, except when we try to divide by 
</p>
<p>Sunday; we already know that Sunday acts like 0, and so Sunday multiplied 
</p>
<p>by any day is Sunday, so we cannot divide any other day by Sunday (and 
</p>
<p>the result of Su/Su is not well defined; it could be any day). 
</p>
<p>Congruences introduced in Section 6.7 provide an often very convenient 
</p>
<p>way to handle these strange numbers. For example, we can write (6.2) in 
the form 
</p>
<p>(x-y)&middot;5=0 (mod 7) </p>
<p/>
</div>
<div class="page"><p/>
<p>6.8 Strange Numbers 109 
</p>
<p>(where x and yare the numbers corresponding to the days X and Y), and 
</p>
<p>so 7 is a divisor of (x - y)5. But 5 is not divisible by 7 and neither is 
x - y (since these are two different nonnegative integers smaller than 7). 
</p>
<p>Since 7 is a prime, this is a contradiction. This way can talk about ordinary 
</p>
<p>numbers instead of the days of the week; the price we pay is that we have 
</p>
<p>to use congruences instead of equality. 
</p>
<p>6.8.1 Find We/Fr; Tu/Fr; Mo/Tu; Sa/Tu. 
</p>
<p>Is there anything special about the number 7 here? In a society where the 
</p>
<p>week consists of 10 or 13 or 365 days, we could define addition, subtraction, 
</p>
<p>and multiplication of the days of the week similarly. 
</p>
<p>Let m be the number of days of the week, which in mathematical lan-
</p>
<p>guage we call the modulus. It would be impractical to introduce new names 
</p>
<p>for the days of the week,l so let's just call them 0, I, ... ,m - 1. The over-
lining indicates that, for example, "2 refers not only to day 2, but also to 
day m + 2, day 2m + 2, etc. 
</p>
<p>Addition is defined by a+b = c, where c is the remainder of a+b modulo 
m. Multiplication and subtraction are defined in a similar way. This way 
</p>
<p>we have a new number system: It consists of only m numbers, and the basic 
</p>
<p>arithmetic operations can be carried out. These operations will obey the 
</p>
<p>basic laws of computation, which follows just as in the case m = 7 above. 
This version of arithmetic is called modular arithmetic. 
</p>
<p>What about division? If you carefully read the proof that we can do 
</p>
<p>division when m = 7, you see that it uses one special property of 7: that 
it is a prime! There is indeed a substantial difference between modular 
</p>
<p>arithmetic with prime and nonprime moduli. 2 In what follows, we shall 
</p>
<p>restrict our attention to the case where the modulus is a prime, and to 
</p>
<p>emphasize this, we will denote it by p. This number system consisting of 
</p>
<p>0, I, ... ,p - 1, with the four operations defined as above, is called a prime 
field. 
</p>
<p>The 2-element field. The smallest prime number is 2, and the simplest 
</p>
<p>prime field has only 2 elements, 0 and I. It is easy to give the addition and 
multiplication tables: 
</p>
<p>+ 0 1 
</p>
<p>0 0 1 
</p>
<p>1 1 0 
</p>
<p>(There is really only one operation here that does not follow from the 
</p>
<p>general properties of 0 and 1, namely, 1+1 = O. There is no need to specify 
</p>
<p>1 In many languages, the names of some days are derived from numbers. 
</p>
<p>2Plural of "modulus." </p>
<p/>
</div>
<div class="page"><p/>
<p>110 6. Integers, Divisors, and Primes 
</p>
<p>the subtraction table, since in this field a + b = a - b for every a and b 
(check!), nor the division table, since this is obvious: We cannot divide by 
</p>
<p>0, and dividing by 1 does not change the dividend.) 
</p>
<p>It is inconvenient to write all these bars over the numbers, so we most 
</p>
<p>often omit them. But then we have to be careful, because we must know 
</p>
<p>whether 1 + 1 means 2 or 0; therefore, we change the sign of addition, and 
use EEl for the addition in the 2-element field. In this notation, the addition 
</p>
<p>and multiplication tables look like this: 
</p>
<p>EEl 0 
</p>
<p>0 0 
</p>
<p>1 1 
</p>
<p>1 
</p>
<p>1 
</p>
<p>0 
</p>
<p>~
01 
</p>
<p>o 0 0 
1 0 1 
</p>
<p>(we did not have to introduce a new multiplication symbol, because the 
</p>
<p>multiplication table for 0 and 1 is the same in the 2-element field as for 
</p>
<p>ordinary numbers). 
</p>
<p>This field is very small but very important, because a lot of computer 
</p>
<p>science, information theory, and mathematical logic uses it: Its two ele-
</p>
<p>ments can be interpreted as "YES-NO," "TRUE-FALSE," "SIGNAL-NO 
</p>
<p>SIGNAL," etc. 
</p>
<p>6.8.2 Let 0 mean "FALSE" and 1 mean "TRUE." Let A and B be two state-
ments (which are either true or false). Express, using the operations EB and " the 
truth of "not A," "A or B," "A and B." 
</p>
<p>6.8.3 Let the modulus be 6; show by an example that division by a nonzero 
"number" cannot always be carried out. Generalize the example to every com-
posite modulus. 
</p>
<p>Division in modular arithmetic. Our argument that division in modu-
</p>
<p>lar arithmetic can be carried out if the modulus is a prime was reasonably 
</p>
<p>simple but it did not tell us how to carry out the division. To find the quo-
</p>
<p>tient by this method would involve looking at all numbers between 0 and 
</p>
<p>p -1, which was OK for p = 7, but would be quite tedious for a prime like 
</p>
<p>p = 234,527 (not to mention the really huge primes used in cryptography 
and computer security, as we'll see). 
</p>
<p>So how do we divide, say, 53 by 2 modulo 234,5277 
</p>
<p>We can simplify the problem, and just ask about dividing 1 by 2 modulo 
</p>
<p>234,527. If we have that 1/2 = a, then we can get 53/2 = 53&middot; a, which we 
know how to compute. 
</p>
<p>At this point the proof can be explained better in the general case. We 
</p>
<p>are given a prime modulus p and an integer a (1 ~ a ~ p -1), and want to 
find an integer x (0 ~ x ~ p - 1) such that ax = 1. Using the congruence 
notation from Section 6.7, we can write this as 
</p>
<p>ax == 1 (mod p). </p>
<p/>
</div>
<div class="page"><p/>
<p>6.S Strange Numbers 111 
</p>
<p>The key to solving this problem is the Euclidean Algorithm. Let us com-
</p>
<p>pute the greatest common divisor of a and p. This sounds silly, since we 
</p>
<p>know the answer right away: p is a prime and 1 ::; a &lt; p, so they cannot 
have any common divisor greater than 1, and so gcd(p, a) = 1. But re-
call that the Euclidean Algorithm gives more: it will provide the greatest 
</p>
<p>common divisor in the form au + pv, where u ad v are integers. Thus we 
get 
</p>
<p>au+ pv = 1, 
</p>
<p>which implies that 
</p>
<p>au == 1 (mod p). 
</p>
<p>We are almost done; the only problem is that the integer u may not be 
</p>
<p>between 1 and p - 1. But if x is the remainder of u modulo p, then mul-
</p>
<p>tiplying the congruence x == u (mod p) by a (recall from Section 6.7 that 
this is a legal operation on congruences), we get 
</p>
<p>ax==au==l (modp), 
</p>
<p>and since 0 ::; x ::; p - 1, this solves our problem. 
</p>
<p>Let us follow this algorithm on our example above, with a = 2 and 
</p>
<p>p = 234,527. The Euclidean Algorithm works really simply in this case: 
</p>
<p>Divide 234,527 by 2 with remainder, and the remainder is already down to 
</p>
<p>1. This gives 
</p>
<p>2 . (-117,263) + 234,527 . 1 = 1. 
</p>
<p>The remainder of -117,263 modulo 234,527 is 117,264, so we get that 
</p>
<p>1/2 = 117,264. 
</p>
<p>6.8.4 Compute 1/53 modulo 234527. 
</p>
<p>Once we know how to do basic arithmetic, more involved tasks like solv-
</p>
<p>ing linear equations can be done by recalling what we would do with or-
</p>
<p>dinary numbers. We illustrate this by some examples, where we use the 
</p>
<p>congruence notation along with its basic properties from Section 6.7. 
</p>
<p>Example 1. Consider a linear equation, say 
</p>
<p>where the modulus is 47 (check in the table that this is a prime!). We can 
</p>
<p>rewrite this as a congruence: 
</p>
<p>7 x + 3 == 0 (mod 47). 
</p>
<p>This second form is the more usual, so let's work with this. 
</p>
<p>Just as we would do with an equation, we transform this as 
</p>
<p>7x == -3 (mod 47) (6.3) </p>
<p/>
</div>
<div class="page"><p/>
<p>112 6. Integers, Divisors, and Primes 
</p>
<p>(we could replace -3 by its remainder 44 modulo 47 if we wanted to keep 
</p>
<p>numbers positive, but this is optional). 
</p>
<p>Next we have to find the reciprocal of 7 modulo 47. The Euclidean Al-
</p>
<p>gorithm gives 
</p>
<p>gcd(7,47) = gcd(7, 5) = gcd(2, 5) = gcd(2, 1) = 1, 
</p>
<p>and following the extended version we get 
</p>
<p>5=47-6&middot;7, 2 = 7 - 5 = 7 - (47 - 6&middot;7) = 7&middot;7 - 47, 
</p>
<p>1 = 5 - 2&middot;2 = (47 - 6&middot;7) - 2&middot; (7&middot;7 - 47) = 3&middot;47 - 20&middot;7, 
</p>
<p>which shows that (-20) &middot;7== 1 (mod 47). So the reciprocal of 7 modulo 47 
</p>
<p>is - 20 (which again we could write as 27). 
</p>
<p>Now dividing both sides of (6.3) by 7, which is the same as multiplying 
</p>
<p>both sides by 27, we get 
</p>
<p>x == 13 (mod 47). 
</p>
<p>(Here we get 13 either as the remainder of (-3)( -20), or as the remainder 
</p>
<p>of 44&middot;27 modulo 47; the result is the same.) 
</p>
<p>Example 2. Next, let us solve a system of two linear equations, with two 
</p>
<p>variables. We'll make the numbers a little bigger, to see that we can cope 
</p>
<p>with larger numbers too. Let the modulus be p = 127, and consider the 
equations 
</p>
<p>12X + 31Y = 2, 
</p>
<p>2X + S9Y = 23. 
</p>
<p>We can rewrite these as congruences: 
</p>
<p>12x + 31y == 
2x + S9y == 
</p>
<p>2 (mod 127), 
</p>
<p>23 (mod 127). 
</p>
<p>(6.4) 
</p>
<p>a. Eliminate a variable. How would we solve this system if these were 
</p>
<p>ordinary equations? We could multiply the second equation by 6 and sub-
</p>
<p>tract it from the first, to eliminate the x terms. We can do this in this 
</p>
<p>prime field as well, and get 
</p>
<p>(31 - 6 . S9)y == 2 - 6 . 23 (mod 127), 
</p>
<p>or 
</p>
<p>(-503)y == -136 (mod 127). 
</p>
<p>We can replace these negative numbers by their remainders modulo 127 to 
</p>
<p>get 
</p>
<p>5y == lIS (mod 127). (6.5) </p>
<p/>
</div>
<div class="page"><p/>
<p>6.S Strange Numbers 113 
</p>
<p>Division. Next, we want to divide the equation by 5. This is what we 
</p>
<p>discussed above: We have to use the Euclidean Algorithm. The computation 
</p>
<p>of the greatest common divisor is easy: 
</p>
<p>gcd(127,5) = gcd(2, 5) = gcd(2, 1) = 1. 
</p>
<p>This does not give anything new: We knew in advance that this greatest 
</p>
<p>common divisor will be 1. To get more, we have to follow this computation 
</p>
<p>by another one, where each number is written as an integer multiple of 127 
</p>
<p>plus an integer multiple of 5: 
</p>
<p>gcd(127,5) = gcd(127 - 25&middot;5,5) = gcd(127 - 25 . 5, (-2) . 127 + 51&middot;5) = 1. 
</p>
<p>This gives that 
</p>
<p>(-2) . 127 + 51&middot;5 = 1. 
</p>
<p>Thus 5&middot;51 =: 1 (mod 127), and so we have found the "reciprocal" of 5 
</p>
<p>modulo 127. 
</p>
<p>Instead of dividing equation (6.4) by five, we multiply by its "reciprocal," 
</p>
<p>51, to get 
</p>
<p>y =: 51 . 118 (mod 127). (6.6) 
</p>
<p>Conclusion. If we evaluate the right-hand side of (6.6) and then compute 
</p>
<p>its remainder modulo 127, we get that y =: 49 (mod 127), or in other words, 
</p>
<p>y = 49 is the solution. To get x, we have to substitute this value back into 
one of the original equations: 
</p>
<p>2x + 89&middot;49 =: 23 (mod 127), 
</p>
<p>whence 
</p>
<p>2x =: 23 - 89&middot;49 =: 107 (mod 127). 
</p>
<p>So we have to do one more division. In analogy with what we did above, 
</p>
<p>we get 
</p>
<p>(-63) &middot;2+ 127 = 1, 
</p>
<p>and hence 
</p>
<p>64&middot;2 =: 1 (mod 127). 
</p>
<p>So instead of dividing by 2, we can multiply by 64, to get 
</p>
<p>x=: 64&middot;107 (mod 127). 
</p>
<p>Computing the right-hand side and its remainder modulo 127, we get that 
</p>
<p>x=: 117 (mod 127), or in other words, X = 117. Thus we have solved (6.4). 
</p>
<p>Example 3. We can even solve some quadratic equations; for example, 
</p>
<p>x2-3x+2=:0 (mod 53). </p>
<p/>
</div>
<div class="page"><p/>
<p>114 6. Integers, Divisors, and Primes 
</p>
<p>We can write this as 
</p>
<p>(x - l)(x - 2) == 0 (mod 53). 
</p>
<p>One of the factors on the left-hand side must be congruent to 0 modulo 53, 
</p>
<p>whence either x == 1 (mod 53) or x == 2 (mod 53). 
Here we found a way to write the left-hand side as a product just by 
</p>
<p>looking at it. What happens if we have an equation with larger numbers, 
</p>
<p>say x 2 + 134517x + 105536 == 0 (mod 234527)7 We doubt that anybody can 
guess a decomposition. In this case, we can try to follow the high-school 
</p>
<p>procedure for solving quadratic equations. This works, but one step of it 
</p>
<p>is quite difficult: taking square roots. This can be done efficiently, but the 
</p>
<p>algorithm is too complicated to be included here. 
</p>
<p>6.8.5 Solve the congruence system 
</p>
<p>2x + 3y:= 
x+4y:= 
</p>
<p>6.8.6 Solve the "congruence equations" 
</p>
<p>(a) x 2 - 2x := 0 (mod 11), 
</p>
<p>1 (mod 11), 
</p>
<p>4 (mod 11). 
</p>
<p>(b) x 2 := 4 (mod 23). 
</p>
<p>6.9 Number Theory and Combinatorics 
</p>
<p>Many of the combinatorial tools that we have introduced are very useful in 
</p>
<p>number theory as well. Induction is used all over the place. We show some 
</p>
<p>elegant arguments based on the Pigeonhole Principle and on inclusion-
</p>
<p>exclusion. 
</p>
<p>We are given n natural numbers: aI, az, ... , an- Show that we 
</p>
<p>can choose a (nonempty) subset of these numbers whose sum is 
</p>
<p>divisible by n. 
</p>
<p>(It is possible that this subset contains all n numbers.) 
</p>
<p>Solution. Consider the following n numbers: 
</p>
<p>bl = aI, 
</p>
<p>b2 = al + a2, 
b3 = al + a2 + a3, </p>
<p/>
</div>
<div class="page"><p/>
<p>6.9 Number Theory and Combinatorics 115 
</p>
<p>If there is a number among these n numbers that is divisible by n, then we 
</p>
<p>have found what we want. If there is none, then let us divide all the numbers 
</p>
<p>b1 , b2 , ... ,bn by n with residue. Write down these residues. What are the 
</p>
<p>numbers we were getting? It could be 1,2, ... , or n -1. But we have a total 
</p>
<p>of n numbers! So by the pigeonhole principle, there will be two numbers 
</p>
<p>among b1 , b2 , ... ,bn that give the same residue when we divide them by n. 
</p>
<p>Say these two numbers are bi and bj (i &lt; j). Then their difference bj - bi 
is divisible by n. But 
</p>
<p>So we have found a special subset of the numbers aI, a2, ... , an, namely 
ai+l,ai+2, ... ,aj, whose sum is divisible by n. And this is what we wanted 
</p>
<p>to prove. 
</p>
<p>6.9.1 We are given n numbers from the set {I, 2, ... ,2n - I}. Prove that we 
</p>
<p>can always find two numbers among these n numbers that are relatively prime 
</p>
<p>to each other. 
</p>
<p>As a very important application of inclusion-exclusion, let's answer the 
</p>
<p>following question about numbers: How many numbers are there up to 1200 
</p>
<p>that are relatively prime to 1200? 
</p>
<p>Since we know the prime factorization of 1200,namely, 1200 = 24 &middot;3&middot; 52, 
we know that the numbers divisible by any of 2, 3, or 5 are precisely those 
</p>
<p>that have a common divisor with 1200. So we are interested in counting 
</p>
<p>the positive integers smaller than 1200 and not divisible by 2, 3, or 5. 
</p>
<p>One can easily compute that up to 1200, there are 
</p>
<p>1200 
-2- numbers divisible by 2 
</p>
<p>(every second number is even), 
</p>
<p>1200 
-3- numbers divisible by 3, 
</p>
<p>1200 
-5- numbers divisible by 5. 
</p>
<p>Those numbers divisible by both 2 and 3 are just those that are divisible 
</p>
<p>by 6. Therefore up to 1200 there are 
</p>
<p>1200 
-6- numbers divisible by 2 and 3, 
</p>
<p>and similarly, there are 
</p>
<p>1200 
10 numbers divisible by 2 and 5, 
</p>
<p>1200 
~ numbers divisible by 3 and 5. </p>
<p/>
</div>
<div class="page"><p/>
<p>116 6. Integers, Divisors, and Primes 
</p>
<p>Finally, the numbers divisible by all of 2, 3, 5 are precisely those that are 
</p>
<p>divisible by 30; so there are 
</p>
<p>1200 . . . 
30 numbers dIvIsIble by all of 2, 3, 5. 
</p>
<p>Now with these data, we can use inclusion-exclusion to compute the 
</p>
<p>number we are looking for: 
</p>
<p>1200 _ (1200 + 1200 + 1200) + 1200 + 1200 + 1200 _ 1200 = 320. 
2 3 5 2&middot;3 2&middot;5 3&middot;5 2&middot;3&middot;5 
</p>
<p>If we pull out 1200 from the left-hand side of the above equality, what 
</p>
<p>remains can be transformed into a nice product form (check the calcula-
</p>
<p>tions!): 
</p>
<p>1200. (1 _ ~ _ ~ _ ~ + _1_ + _1_ + _1 ___ 1_) 
2 3 5 2&middot;3 2&middot;5 3&middot;5 2&middot;3&middot;5 
</p>
<p>Let n be a natural number. We denote by &cent;( n) the number of those 
numbers that are not larger than n and are relatively prime to n (we used 
</p>
<p>here "not larger," instead of "smaller," which has significance only if n = 1, 
since this is the only case when the number itself is relative prime to itself; 
</p>
<p>so &cent;(1) = 1). Primes, of course, have the most numbers relatively prime to 
them: If P is a prime, then every smaller positive integer is counted in &cent;(p), 
</p>
<p>so &cent;(p) = p - 1. In general, the number &cent;( n) can be computed as we did 
in the concrete case above: if PI, P2, ... ,Pr are the different prime factors 
</p>
<p>of n, then 
</p>
<p>The proof follows the calculations above, and is given as Exercise 6.9.2. 
</p>
<p>6.9.2 Prove (6.7). 
</p>
<p>6.9.3 Let n be a natural number. We compute &cent;(d) of every divisor d of n, then 
add up all these numbers. What is the sum? (Experiment, formulate a conjecture, 
and prove it.) 
</p>
<p>6.9.4 We add up all the positive integers smaller than n and relatively prime 
to n. What do we get? 
</p>
<p>6.9.5 Prove the following extension of Fermat's Theorem: If gcd(a, b) = 1, then 
a&cent;(b) - 1 is divisible by b. 
</p>
<p>[Hint: Generalize the proof of Fermat's Theorem in Exercise 6.5.4.] </p>
<p/>
</div>
<div class="page"><p/>
<p>6.10 How to Test Whether a Number is a Prime? 117 
</p>
<p>6.10 How to Test Whether a Number is a Prime? 
</p>
<p>Is 123,456 a prime? Of course not, it is even. Is 1,234,567 a prime? This is 
</p>
<p>not so easy to answer, but if you are hard pressed, you can try all numbers 
</p>
<p>2,3,4,5 ... to see if they are divisors. If you have the patience to go up to 
</p>
<p>127, then you are done: 1234567 = 127 . 9721. 
What about 1,234,577? Again you can try to find a divisor by trying 
</p>
<p>out 2,3,4,5, .... But this time you don't find a proper divisor! Still, if you 
</p>
<p>are really patient and keep on until you get to the square root of 1234577, 
</p>
<p>which is 1111.1 ... , you know that you are not going to find a proper divisor 
</p>
<p>(Why?). 
</p>
<p>Now what about the number 
</p>
<p>1,111,222,233,334,444,555,566,667,777,888,899,967? 
</p>
<p>If this is a prime (as it is), then we have to to tryout all numbers up to its 
</p>
<p>square root; since the number is larger than 1036 , its square root is larger 
</p>
<p>than 1018 . Trying out more than 1018 numbers is a hopeless task even for 
</p>
<p>the world's most powerful computer. 
</p>
<p>The Fermat test. So how do we know that this number is a prime? Well, 
</p>
<p>our computer tells us, but how does the computer know? An approach is 
</p>
<p>offered by Fermat's Theorem. Its simplest nontrivial case says that if p is 
</p>
<p>a prime, then p I 2P - 2. If we assume that p is odd (which only excludes 
the case p = 2), then we also know that p I 2P- 1 - 1. 
</p>
<p>What happens if we check the divisibility relation n I 2n - 1 - 1 for com-
posite numbers? It obviously fails if n is even (no even number is a divisor 
</p>
<p>of an odd number), so let's restrict our attention to odd numbers. Here are 
</p>
<p>some results: 
</p>
<p>9 f28 - 1 = 255, 15 t 214 - 1 = 16,383, 21 t 220 - 1 = 1,048,575, 
</p>
<p>25 f224 - 1 = 16,777,215. 
</p>
<p>This suggests that perhaps we could test whether the number n is a prime 
</p>
<p>by checking whether the relation n I 2n - 1 - 1 holds. This is a nice idea, 
</p>
<p>but it has several major shortcomings. 
</p>
<p>How to compute LARGE powers. It is easy to write up the formula 
</p>
<p>2n - 1 - 1, but it is quite a different matter to compute it! It seems that to 
</p>
<p>get 2n-l, we have to multiply by 2 n - 2 times. For a 100-digit number n, 
</p>
<p>this is about 10100 steps, which we will never be able to carry out. 
</p>
<p>But we can be tricky when we compute 2n-l. Let us illustrate this on the 
</p>
<p>example of 224: We could start with 23 = 8, square it to get 26 = 62, square 
it again to get 212 = 4096, and square it once more to get 224 = 16,777,216. 
Instead of 23 multiplications, we needed only 5. 
</p>
<p>It seems that this trick worked only because 24 was divisible by such 
</p>
<p>a large power of 2, and so we could compute 224 by repeated squaring, </p>
<p/>
</div>
<div class="page"><p/>
<p>118 6. Integers, Divisors, and Primes 
</p>
<p>starting from a small number. Let us show how to do a similar trick if the 
</p>
<p>exponent is a less friendly integer, say 29. Here is a way compute 229: 
</p>
<p>22 = 4, 23 = 8, 26 = 64, 27 = 128, 214 = 16,384, 
</p>
<p>228 = 268,435,456, 229 = 536,870,912. 
</p>
<p>It is perhaps best to read this sequence backwards: If we have to compute an 
</p>
<p>odd power of 2, we obtain it by multiplying the previous power by 2; if we 
</p>
<p>have to compute an even power, we obtain it by squaring the appropriate 
</p>
<p>smaller power. 
</p>
<p>6.10.1 Show that if n has k bits in base 2, then 2n can be computed using fewer 
</p>
<p>than 2k multiplications. 
</p>
<p>How to avoid LARGE numbers. We have shown how to overcome the 
</p>
<p>first difficulty; but the computations above reveal the second: the numbers 
</p>
<p>grow too large! Let's say that n has 100 digits; then not only is 2n - 1 
</p>
<p>astronomical, the number of its digits is astronomical! We could never write 
</p>
<p>it down, let alone check whether it is divisible by n. 
</p>
<p>The way out is to divide by n as soon as we get any number that is 
</p>
<p>larger than n, and just work with the remainder of the division (or we 
</p>
<p>could say we work in modular arithmetic with modulus n; we won't have 
</p>
<p>to do divisions, so n does not have to be a prime). For example, if we want 
</p>
<p>to check whether 25 I 224 - 1, then we have to compute 224. As above, we 
start with computing 23 = 8, then square it to get 26 = 64. We immediately 
replace it by the remainder of the division 64 -;- 25, which is 14. Then we 
</p>
<p>compute 212 by squaring 26 , but instead we square 14 to get 196, which we 
</p>
<p>replace by the remainder of the division 196 -;- 25, which is 21. Finally, we 
</p>
<p>obtain 224 by squaring 212 , but instead we square 21 to get 441, and then 
</p>
<p>divide this by 25 to get the remainder 16. Since 16 - 1 = 15 is not divisible 
by 25, it follows that 25 is not a prime. 
</p>
<p>This does not sound like an impressive conclusion, considering the trivi-
</p>
<p>ality of the result, but this was only an illustration. If n has k bits in base 
</p>
<p>2, then as we have seen, it takes only 2k multiplications to compute 2n, 
</p>
<p>and all we have to do is one division (with remainder) in each step to keep 
</p>
<p>the numbers small. We never have to deal with numbers larger than n 2 . 
</p>
<p>If n has 100 digits, then n2 has 199 or 200; not much fun to multiply by 
</p>
<p>hand, but quite easily manageable by computers. 
</p>
<p>Pseudoprimes. But here comes the third shortcoming of the primality 
</p>
<p>test based on Fermat's Theorem. Suppose that we carry out the test for a 
</p>
<p>number n. If it fails (that is, n is not a divisor of 2n - 1 - 1), then of course 
</p>
<p>we know that n is not a prime. But suppose we find that n I 2n - 1 - 1. Can 
we conclude that n is a prime? Fermat's Theorem certainly does not justify 
</p>
<p>this conclusion. Are there composite numbers n for which n I 2n - 1 - I? </p>
<p/>
</div>
<div class="page"><p/>
<p>6.10 How to Test Whether a Number is a Prime? 119 
</p>
<p>Unfortunately, the answer is yes. The smallest such number is 341 = 11&middot;31. 
This is not a prime, but it satisfies 
</p>
<p>341 I 2340 - 1. (6.8) 
</p>
<p>(How do we know that this divisibility relation holds without extensive 
</p>
<p>computation? We can use Fermat's Theorem. It is sufficient to argue that 
</p>
<p>both 11 and 31 are divisors of 2340 - 1, since then so is their product, 11 
</p>
<p>and 31 being different primes. By Fermat's Theorem, 
</p>
<p>11 I 210 - 1. 
</p>
<p>Next we invoke the result of Exercise 6.1.6: It implies that 
</p>
<p>Hence 
</p>
<p>11 I 2340 - 1. 
For 31, we don't need Fermat's Theorem, but only exercise (6.1.6) again: 
</p>
<p>31 = 25 - 1 I 2340 - 1. 
</p>
<p>This proves (6.8).) 
</p>
<p>Such numbers, which are not primes but behave like primes in the sense 
</p>
<p>that Fermat's Theorem with base a = 3 holds true for them, are called 
pseudoprimes (fake primes), or more precisely, pseudoprimes to base 2. 
</p>
<p>While such numbers are quite rare (there are only 22 pseudoprimes to base 
</p>
<p>2 between 1 and 10,000), they do show that our primality test can give 
</p>
<p>a "false positive," and thus (in a strict mathematical sense) it is not a 
</p>
<p>primality test at all. 
</p>
<p>(If we can afford to make an error every now and then, then we can 
live with the simple Fermat test with base 2. If the worst that can happen 
</p>
<p>when a composite number is believed to be a prime is that a computer game 
</p>
<p>crashes, we can risk this; if the security of a bank, or a country, depends 
</p>
<p>on not using a fake prime, we have to find something better.) 
</p>
<p>One idea that comes to the rescue is that we haven't used the full force 
</p>
<p>of Fermat's Theorem: We can also check that n I 3n - 3, n I 5n - 5, etc. 
These tests can be carried out using the same tricks as described above. 
</p>
<p>And in fact, already the first of these tests rules out the "fake prime" 341: 
</p>
<p>it is not a divisor of 3340 - 1. 
</p>
<p>The following observation tells us that this always works, at least if we 
</p>
<p>are patient enough: 
</p>
<p>A positive integer n &gt; 1 is a prime if and only if it passes the 
Fermat test 
</p>
<p>n I an - 1 - 1 
</p>
<p>for every base a = 1,2,3, ... ,n - 1. </p>
<p/>
</div>
<div class="page"><p/>
<p>120 6. Integers, Divisors, and Primes 
</p>
<p>Fermat's Theorem tells us that primes do pass the Fermat test for every 
</p>
<p>base. On the other hand, if n is composite, then there are numbers a, 
</p>
<p>1 ::; a ::; n - 1, that are not relatively prime to n, and every such a will fail 
</p>
<p>the Fermat test: Indeed, if p is a common prime divisor of a and n, then 
</p>
<p>p is a divisor of an - 1 , so it cannot be a divisor of an - 1 - 1, and hence n 
</p>
<p>cannot be a divisor of an - 1 - l. 
</p>
<p>But this general Fermat test is not efficient enough. Imagine that we 
</p>
<p>are given a natural number n, with a few hundred digits, and we want to 
</p>
<p>test whether or not it is a prime. We can carry out the Fermat test with 
</p>
<p>base 2. Suppose it passes. Then we can try base 3. Suppose it passes again, 
</p>
<p>etc. How long do we have to go before we can conclude that n is a prime? 
</p>
<p>Looking at the argument above justifying the general Fermat test, we see 
</p>
<p>that we don't have to go farther than the first number having a common 
</p>
<p>divisor with n. It is easy to see that the smallest such number is the least 
</p>
<p>prime divisor of n. For example, if n = pq, where p and q are distinct 
primes, having say 100 digits each (so n has 199 or 200 digits), then we 
</p>
<p>have to try everything up to the smaller of p and q, which is more than 
</p>
<p>1099 trials, which is hopelessly large. (And furthermore, if we go this far 
</p>
<p>anyway, we may do a simple divisibility test, no need for anything fancy 
</p>
<p>like Fermat's Theorem!) 
</p>
<p>Instead of starting with 2, we could start checking whether Fermat's 
</p>
<p>Theorem holds with any other base a; for example, we could choose a 
</p>
<p>random integer a in the range 1 ::; a ::; n - 1. We know that it fails if we hit 
</p>
<p>any a that is not relatively prime to n. Does this give us a good chance of 
</p>
<p>discovering that n is not a prime if in fact it is not? This depends on n, but 
</p>
<p>certain values of n are definitely bad. For example, suppose that n = pq 
where p and q are different primes. It is easy to list those numbers a that are 
</p>
<p>not relatively prime to n: these are the multiples of p (p, 2p, . .. ,(q-l)p, qp) 
</p>
<p>and the multiples of q (q, 2q, ... , (p - l)q,pq). The total number of such 
</p>
<p>numbers a is q + p - 1 (since pq = n occurs on both lists). This number is 
larger than 2 . 1099 , but less than 2 . 10100 , and so the probability that we 
</p>
<p>hit one of these number when we choose a random a is less than 
</p>
<p>2 . 10100 = 2 . 10-99 
10199 ' 
</p>
<p>which shows that this event has way too small a probability to ever happen 
</p>
<p>in practice. 
</p>
<p>Carmichael numbers. Our next hope is that perhaps for a composite 
</p>
<p>number n, the Fermat test will fail much earlier than its smallest prime 
</p>
<p>divisor, or else for a random choice of a it will fail for many other numbers 
</p>
<p>besides those not relatively prime to n. Unfortunately, this is not always 
</p>
<p>so. There are integers n, called Carmichael numbers, which are even worse 
</p>
<p>than pseudoprimes: They pass the Fermat test for every base a relatively </p>
<p/>
</div>
<div class="page"><p/>
<p>6.10 How to Test Whether a Number is a Prime? 121 
</p>
<p>prime to n. In other words, they satisfy 
</p>
<p>n I an - 1 - 1 
</p>
<p>for every a such that gcd(n, a) = 1. The smallest such number is n = 561. 
While such numbers are very rare, they do show that the Fermat test is 
</p>
<p>not completely satisfactory. 
</p>
<p>The Miller-Rabin test. But in the late 1970's, M. Rabin and G. Miller 
</p>
<p>found a very simple way to strengthen Fermat Theorem just a little bit, 
</p>
<p>and thereby overcome the difficulty caused by Carmichael numbers. We 
</p>
<p>illustrate the method on the example of 561. We use some high-school 
</p>
<p>math, namely, the identity x 2 - 1 = (x - l)(x + 1), to factor the number 
a560 - 1: 
</p>
<p>a560 _ 1 = (a280 - 1) (a280 + 1) 
</p>
<p>= (a 140 _ 1) (a 140 + 1) (a280 + 1) 
</p>
<p>= (a70 _ 1) (a70 + 1) (a 140 + 1) (a280 + 1) 
= (a35 _ l)(a35 + l)(a70 + l)(a140 + l)(a280 + 1). 
</p>
<p>Now suppose that 561 were a prime. Then by Fermat's "Little" Theorem, 
</p>
<p>it would have to divide a560 - 1 for every 1 :s: a :s: 560. If a prime divides 
a product, it divides one of the factors (exercise 6.3.3), and hence at least 
</p>
<p>one of the relations 
</p>
<p>561 I a35 - 1 561 I a35 + 1 561 I a70 + 1 561 I a140 + 1 561 I a280 + 1 
</p>
<p>must hold. But already for a = 2, none of these relations hold. 
The Miller-Rabin test is an elaboration of this idea. Given an odd integer 
</p>
<p>n &gt; 1 that we want to test for primality, we choose an integer a from the 
range 0 :s: a :s: n - 1 at random, and consider an - a. We factor it as 
a(an - 1 - 1), and then go on to factor it, using the identity x 2 - 1 = 
(x - 1) (x + 1), as long as we can. Then we test that one of the factors must 
be divisible by n. 
</p>
<p>If the test fails, we can be sure that n is not a prime. But what happens 
</p>
<p>if it succeeds? Unfortunately, this can still happen even if n is composite; 
</p>
<p>but the crucial point is that this test gives a false positive with probability 
</p>
<p>less than ~ (remember that we chose a random a). 
</p>
<p>Reaching a wrong conclusion half of the time does not sound so good 
</p>
<p>at all; but we can repeat the experiment several times. If we repeat it 10 
</p>
<p>times (with a new randomly chosen a each time), the probability of a false 
</p>
<p>positive is less than 2-10 &lt; 1/1000 (since to conclude that n is prime, all 10 
runs must give a false positive, independently of each other). If we repeat 
</p>
<p>the experiment 100 times, the probability of a false positive drops below 
</p>
<p>2-100 &lt; 10-30 , which is astronomically small. </p>
<p/>
</div>
<div class="page"><p/>
<p>122 6. Integers, Divisors, and Primes 
</p>
<p>So this algorithm, when repeated sufficiently often, tests primality with 
</p>
<p>error probability that is much less than the probability of, say, hardware 
</p>
<p>failure, and therefore it is quite adequate for practical purposes. It is widely 
</p>
<p>used in programs like Maple and Mathematica and in cryptography. 
</p>
<p>Suppose that we test a number n for primality and find that it is com-
</p>
<p>posite. Then we would like to find its prime factorization. It is easy to see 
</p>
<p>that instead of this, we could ask for less: for a decomposition of n into the 
</p>
<p>product of two smaller positive integers, n = abo If we have a method to 
find such a decomposition efficiently, then we can go on and test a and b for 
</p>
<p>primality. If they are primes, we have found the prime factorization of n; 
</p>
<p>if (say) a is not a prime, we can use our method to find a decomposition of 
</p>
<p>a into the product of two smaller integers, etc. Since n has at most log2 n 
</p>
<p>prime factors (Exercise 6.3.4), we have to repeat this at most log2 n times 
</p>
<p>(which is less than the number of its bits). 
</p>
<p>But unfortunately (or fortunately? see Chapter 15 on cryptography), no 
</p>
<p>efficient method is known to write a composite number as a product of two 
</p>
<p>smaller integers. It would be very important to find an efficient factorization 
</p>
<p>method, or to give a mathematical proof that no such method exists; but 
</p>
<p>we don't know what the answer is. 
</p>
<p>6.10.2 Show that 561 is a Carmicheal number; more exactly, show that 
</p>
<p>561 I a561 - a for every integer a. [Hint: Since 561 = 3 . 11 . 17, it suffices to 
prove that 3 I a561 - a, 11 I a561 - 1 and 17 I a561 - a. Prove these relations 
separately, using the method of the proof of the fact that 341 I 2340 - 1.] 
</p>
<p>Review Exercises 
</p>
<p>6.10.3 Prove that if c i= 0 and ae I be, then a I b. 
</p>
<p>6.10.4 Prove that if a I b and a I c, then a I b2 + 3e + 2b C&bull; 
</p>
<p>6.10.5 Prove that every prime larger than 3 gives a remainder of 1 or -1 if 
</p>
<p>divided by 6. 
</p>
<p>6.10.6 Let a &gt; 1, and k, n &gt; O. Prove that ak - 1 I an - 1 if and only if kin. 
</p>
<p>6.10.7 Prove that if a&gt; 3, then a, a + 2, and a + 4 cannot be all primes. Can 
they all be powers of primes? 
</p>
<p>6.10.8 How many integers are there that are not divisible by any prime larger 
</p>
<p>than 20 and not divisible by the square of any prime? 
</p>
<p>6.10.9 Find the prime factorization of (a) (~~); (b) 201. </p>
<p/>
</div>
<div class="page"><p/>
<p>6.10 How to Test Whether a Number is a Prime? 123 
</p>
<p>6.10.10 Show that a number with 30 digits cannot have more than 100 prime 
</p>
<p>factors. 
</p>
<p>6.10.11 Show that a number with 160 digits has a prime power divisor that is 
</p>
<p>at least 100. This is not true if we want a prime divisor that is at least 100. 
</p>
<p>6.10.12 Find the number of (positive) divisors of n, for 1 ::; n ::; 20 (example: 
</p>
<p>6 has 4 divisors: 1, 2, 3, 6). Which of these numbers have an odd number of 
</p>
<p>divisors? Formulate a conjecture and prove it. 
</p>
<p>6.10.13 Find the g.c.d. of 100 and 254, using the Euclidean Algorithm. 
</p>
<p>6.10.14 Find pairs of integers for which the Euclidean Algorithm lasts (a) 2 
</p>
<p>steps; (b) 6 steps. 
</p>
<p>6.10.15 Recalling the Lucas numbers Ln introduced in Exercise 4.3.2, prove 
</p>
<p>the following: 
</p>
<p>(a) gcd(F3k' L 3k ) = 2; 
</p>
<p>(b) if n is not a multiple of 3, then gcd(Fn, Ln) = 1; 
</p>
<p>(c) L6k == 2 (mod 4). 
</p>
<p>6.10.16 Prove that for every positive integer m there is a Fibonacci number 
</p>
<p>divisible by m (well, of course, Fa = 0 is divisible by any m; we mean a larger 
</p>
<p>one). 
</p>
<p>6.10.17 Find integers x and y such that 25x + 41y = 1. 
</p>
<p>6.10.18 Find integers x and y such that 
</p>
<p>2x + y == 4 (mod 17), 
</p>
<p>5x - 5y == 9 (mod 17). 
</p>
<p>6.10.19 Prove that .vs is irrational. 
6.10.20 Prove that the two forms of Fermat's Theorem, Theorem 6.5.1 and 
</p>
<p>(6.1), are equivalent. 
</p>
<p>6.10.21 Show that if p &gt; 2 is a prime modulus, then 
</p>
<p>I p+ 1 
'2 2 
</p>
<p>6.10.22 We are given n + 1 numbers from the set {I, 2, ... , 2n}. Prove that 
there are two numbers among them such that one divides the other. 
</p>
<p>6.10.23 What is the number of positive integers not larger than 210 and not 
</p>
<p>divisible by 2, 3 or 7? </p>
<p/>
</div>
<div class="page"><p/>
<p>7 
</p>
<p>Graphs 
</p>
<p>7.1 Even and Odd Degrees 
</p>
<p>We start with the following exercise (admittedly of no practical signifi-
</p>
<p>cance). 
</p>
<p>Prove that at a party with 51 people, there is always a person 
</p>
<p>who knows an even number of others. 
</p>
<p>(We assume that acquaintance is mutual. There may be people who don't 
</p>
<p>know each other. There may even be people who don't know anybody else. 
</p>
<p>Of course, such people know an even number of others, so the assertion is 
</p>
<p>true if there is such a person.) 
</p>
<p>If you don't have any idea how to begin a solution, you should try to 
</p>
<p>experiment. But how to experiment with such a problem? Should we find 
</p>
<p>51 names for the participants, then create, for each person, a list of those 
</p>
<p>people he or she knows? This would be very tedious, and we would be lost 
</p>
<p>among the data. It would be good to experiment with smaller numbers. 
</p>
<p>But which number can we take instead of 51? It is easy to see that 50, 
</p>
<p>for example, would not do: If, say, we have 50 people who all know each 
</p>
<p>other, then everybody knows 49 others, so there is no person with an even 
</p>
<p>number of acquaintances. For the same reason, we could not replace 51 by 
</p>
<p>48, or 30, or any even number. Let's hope that this is all; let's try to prove 
</p>
<p>that 
</p>
<p>at a party with an odd number of people, there is always a person 
</p>
<p>who knows an even number of others. </p>
<p/>
</div>
<div class="page"><p/>
<p>126 7. Graphs 
</p>
<p>Now we can at least experiment with smaller numbers. Let us have, say, 
</p>
<p>5 people: Alice, Bob, Carl, Diane, and Eve. When they first met , Alice 
</p>
<p>knew everybody else; Bob and Carl knew each other, and Carl also knew 
</p>
<p>Eve. So the numbers of acquaintances are: Alice 4, Bob 2, Carl 3, Diane 1, 
</p>
<p>and Eve 2. We have not only one but three people with an even number of 
</p>
<p>acquaintances. 
</p>
<p>It is still rather tedious to consider examples by listing people and listing 
</p>
<p>pairs knowing each other, and it is quite easy to make mistakes. We can, 
</p>
<p>however, find a graphic illustration that helps a lot. We represent each 
</p>
<p>person by a point in the plane (well, by a small circle, to make the picture 
</p>
<p>nicer), and we connect two of these points by a segment if the people 
</p>
<p>know each other. This simple drawing contains all the information we need 
</p>
<p>(Figure 7.1). 
</p>
<p>FIGURE 7.1. The graph depicting acquaintance between our friends 
</p>
<p>A picture of this kind is called a graph. More exactly, a graph consists of 
</p>
<p>a set of nodes (also known as points, or vertices) with some pairs of these 
</p>
<p>(not necessarily all pairs) connected by edges. It does not matter whether 
</p>
<p>these edges are straight or curvy; all that is important is which pairs of 
</p>
<p>nodes they connect. The set of nodes of a graph G is usually denoted by 
</p>
<p>V; the set of edges, by E. Thus we write G = (V, E) to indicate that the 
graph G has node set V and edge set E. 
</p>
<p>The only thing that matters about an edge is the pair of nodes it con-
</p>
<p>nects; hence the edges can be considered as 2-element subsets of V. This 
</p>
<p>means that the edge connecting nodes u and v is just the set {u, v }. We'll 
</p>
<p>further simplify notation and denote this edge by uv. 
</p>
<p>Can two edges connect the same pair of nodes (parallel edges)? Can an 
</p>
<p>edge connect a node to itself (loop)? The answer to these questions is, of 
</p>
<p>course, our decision. In some applications it is advantageous to allow such 
</p>
<p>edges; in others, they must be excluded. In this book, we generally assume 
</p>
<p>that a pair of nodes is connected by at most one edge, and no node is 
</p>
<p>connected to itself. Such graphs are often called simple graphs. If parallel 
</p>
<p>edges are allowed, the graph is often called a multigraph to emphasize this 
</p>
<p>fact. 
</p>
<p>If two nodes are connected by an edge, then they are called adjacent. 
</p>
<p>Nodes adjacent to a given node v are called its neighbors. </p>
<p/>
</div>
<div class="page"><p/>
<p>7.1 Even and Odd Degrees 127 
</p>
<p>Coming back to our problem, we see that we can represent the party by 
</p>
<p>a graph very conveniently. Our concern is the number of people known by 
</p>
<p>a given person. We can read this off the graph by counting the number of 
</p>
<p>edges leaving a given node. This number is called the degree of the node. 
</p>
<p>The degree of node v is denoted by d(v). So A has degree 4, B has degree 
</p>
<p>2, etc. If Frank now arrives, and he does not know anybody, then we add 
</p>
<p>a new node that is not connected to any other node. So this new node has 
</p>
<p>degree O. 
</p>
<p>In the language of graph theory, we want to prove the following: 
</p>
<p>If a graph has an odd number of nodes, then it has a node with 
</p>
<p>even degree. 
</p>
<p>Since it is much easier to experiment with graphs than with tables of ac-
</p>
<p>quaintances, we can draw many graphs with an odd number of nodes, and 
</p>
<p>count the number of nodes with even degree (Figure 7.2). We find that 
</p>
<p>they contain 5,1,1,7,3,3 such nodes (the last one is a single graph on 7 
</p>
<p>nodes, not two graphs). So we observe that not only is there always such a 
</p>
<p>node, but the number of such nodes is odd. 
</p>
<p>OwV~ 
o &bull; &bull; &bull; 0 
</p>
<p>FIGURE 7.2. Some graphs with an odd number of nodes. Black circles mark 
</p>
<p>nodes of even degree. 
</p>
<p>Now, this is a case in which it is easier to prove more: If we formulate 
</p>
<p>the following stronger statement, 
</p>
<p>If a graph has an odd number of nodes, then the number of nodes 
</p>
<p>with even degree is odd, 
</p>
<p>then we made an important step towards the solution! (Why is this state-
</p>
<p>ment stronger? Because 0 is not an odd number.) Let's try to find an even 
</p>
<p>stronger statement by looking also at graphs with an even number of nodes. 
</p>
<p>Experimenting on several small graphs again (Figure 7.3), we find that the 
</p>
<p>number of nodes with even degree is 2,4,0,6,2,4. So we conjecture the 
</p>
<p>following: 
</p>
<p>if a graph has an even number of nodes, then the number of 
</p>
<p>nodes with even degree is even. 
</p>
<p>This is nicely parallel to the statement about graphs with an odd number 
</p>
<p>of nodes, but it would be better to have a single common statement for the 
</p>
<p>odd and even case. We get such a version if we look at the number of nodes 
</p>
<p>with odd, rather than even, degree. This number is obtained by subtracting </p>
<p/>
</div>
<div class="page"><p/>
<p>128 7. Graphs 
</p>
<p>&bull; 
&bull; D 
</p>
<p>FIGURE 7.3. Some graphs with an even number of nodes. Black circles mark 
</p>
<p>nodes of even degree. 
</p>
<p>the number of nodes with even degree from the total number of nodes, and 
</p>
<p>hence both statements will be implied by the following: 
</p>
<p>Theorem 7.1.1 In every graph, the number of nodes with odd degree is 
</p>
<p>even. 
</p>
<p>So what we have to prove is this theorem. It seems that having made the 
statement stronger and more general in several steps, we have made our 
</p>
<p>task harder and harder. But in fact, we have gotten closer to the solution. 
</p>
<p>Proof. One way of proving the theorem is to build up the graph one edge 
</p>
<p>at a time, and observe how the parities of the degrees change. An example 
</p>
<p>is shown in Figure 7.4. We start with a graph with no edge, in which every 
</p>
<p>degree is 0, and so the number of nodes with odd degree is 0, which is an 
</p>
<p>even number. 
</p>
<p>&bull; &bull; 
&bull; &bull; 
</p>
<p>&bull; &bull; &bull; &bull; 
</p>
<p>FIGURE 7.4. Building up a graph one edge at a time. Black circles mark nodes 
</p>
<p>of even degree. 
</p>
<p>Now if we connect two nodes by a new edge, we change the parity of the 
</p>
<p>degrees at these nodes. In particular, 
</p>
<p>- if both endpoints of the new edge had even degree, we increase the 
</p>
<p>number of nodes with odd degree by 2; 
</p>
<p>if both endpoints of the new edge had odd degree, we decrease the 
</p>
<p>number of nodes with odd degree by 2; 
</p>
<p>if one endpoint of the new edge had even degree and the other had 
</p>
<p>odd degree, then we don't change the number of nodes with odd 
</p>
<p>degree. </p>
<p/>
</div>
<div class="page"><p/>
<p>7.1 Even and Odd Degrees 129 
</p>
<p>Thus if the number of nodes with odd degree was even before adding the 
</p>
<p>new edge, it remained even after this step. This proves the theorem. (Note 
</p>
<p>that this is a proof by induction on the number of edges.) D 
</p>
<p>Graphs are very handy in representing a large variety of situations, not 
</p>
<p>only parties. It is quite natural to consider the graph whose nodes are towns 
</p>
<p>and whose edges are highways (or railroads, or telephone lines) between 
</p>
<p>these towns. We can use a graph to describe an electrical network, say the 
</p>
<p>printed circuit on a card in your computer. 
</p>
<p>In fact, graphs can be used in any situation where a "relation" between 
</p>
<p>certain objects is defined. Graphs are used to describe bonds between 
</p>
<p>atoms in a molecule, connections between cells in the brain, descent be-
</p>
<p>tween species, etc. Sometimes the nodes represent more abstract things: 
</p>
<p>For example, they may represent stages of a large construction project, 
</p>
<p>and an edge between two stages means that one arises from the other in 
</p>
<p>a single phase of work. Or the nodes can represent all possible positions 
</p>
<p>in a game (say, chess, although you don't really want to draw this graph), 
</p>
<p>where we connect two nodes by an edge if one can be obtained from the 
</p>
<p>other in a single move. 
</p>
<p>7.1.1 Find all graphs with 2,3, and 4 nodes. 
</p>
<p>7.1.2 (a) Is there a graph on 6 nodes with degrees 2,3,3,3,3, 3? 
</p>
<p>(b) Is there a graph on 6 nodes with degrees 0,1,2,3,4, 5? 
</p>
<p>(c) How many graphs are there on 4 nodes with degrees 1,1,2, 2? 
</p>
<p>(d) How many graphs are there on 10 nodes with degrees 1,1,1,1,1,1,1,1,1, 1? 
</p>
<p>7.1.3 At the end of the party with n people, everybody knows everybody else. 
</p>
<p>Draw the graph representing this situation. How many edges does it have? 
</p>
<p>7.1.4 (a) Draw a graph with nodes representing the numbers 1,2, ... , 10, in 
</p>
<p>which two nodes are connected by an edge if and only if one is a divisor of 
</p>
<p>the other. 
</p>
<p>(b) Draw a graph with nodes representing the numbers 1,2, ... ,10, in which 
</p>
<p>two nodes are connected by an edge if and only if they have no common 
</p>
<p>divisor larger than 1. 1 
</p>
<p>(c) Find the number of edges and the degrees in these graphs, and check that 
</p>
<p>Theorem 7.1.1 holds. 
</p>
<p>7.1.5 What is the largest number of edges a graph with 10 nodes can have? 
</p>
<p>IThis is an example where loops could playa role: Since gcd(l, 1) = 1 but gcd(k, k) &gt; 
1 for k &gt; 1, we could connect 1 to itself by a loop, if we allowed loops at all. </p>
<p/>
</div>
<div class="page"><p/>
<p>130 7. Graphs 
</p>
<p>7.1.6 How many graphs are there on 20 nodes? (To make this question precise, 
</p>
<p>we have to make sure we know what it means that two graphs are the same. For 
</p>
<p>the purpose of this exercise, we consider the nodes given, and labeled, say, as 
</p>
<p>Alice, Bob, .... The graph consisting of a single edge connecting Alice and Bob 
</p>
<p>is different from the graph consisting of a single edge connecting Eve and Frank.) 
</p>
<p>7.1.7 Formulate the following assertion as a theorem about graphs, and prove 
</p>
<p>it: At every party one can find two people who know the same number of other 
</p>
<p>people (like Bob and Eve in our first example). 
</p>
<p>It will be instructive to give another proof of the theorem formulated in 
</p>
<p>the last section. This will hinge on the answer to the following question: 
</p>
<p>How many edges does a graph have? This can be answered easily if we think 
</p>
<p>back to the problem of counting handshakes: For each node, we count the 
</p>
<p>edges that leave that node (this is the degree of the node). If we sum these 
</p>
<p>numbers, we count every edge twice. So dividing the sum by two, we get 
</p>
<p>the number of edges. Let us formulate this observation as a theorem: 
</p>
<p>Theorem 7.1.2 The sum of degrees of all nodes in a graph is twice the 
</p>
<p>number of edges. 
</p>
<p>In particular, we see that the sum of degrees in any graph is an even 
</p>
<p>number. If we omit the even terms from this sum, we still get an even 
</p>
<p>number. So the sum of odd degrees is even. But this is possible only if the 
</p>
<p>number of odd degrees is even (since the sum of an odd number of odd 
</p>
<p>numbers is odd). Thus we have obtained a new proof of Theorem 7.1.1. 
</p>
<p>7.2 Paths, Cycles, and Connectivity 
</p>
<p>Let us get acquainted with some special kinds of graphs. The simplest 
</p>
<p>graphs are the edgeless graphs, having any number of nodes but no edges. 
</p>
<p>We get another very simple kind of graphs if we take n nodes and connect 
</p>
<p>any two of them by an edge. Such a graph is called a complete graph (or a 
</p>
<p>clique). A complete graph with n nodes is denoted by Kn. It has G) edges 
(recall Exercise 7.1.3). 
</p>
<p>If we think of a graph as representing some kind of relation, then it is 
</p>
<p>clear that we could just as well represent the relation by connecting two 
</p>
<p>nodes if they are not related. So for every graph G, we can construct another 
</p>
<p>graph G that has the same node set but in which two nodes are connected 
</p>
<p>precisely if they are not connected in the original graph G. The graph G is 
</p>
<p>called the complement of G. 
</p>
<p>If we take n nodes and connect one of them to all the others, we get a 
</p>
<p>star. This star has n - 1 edges. 
</p>
<p>Let us draw n nodes in a row and connect the consecutive ones by an 
</p>
<p>edge. This way we obtain a graph with n - 1 edges, which is called a path. </p>
<p/>
</div>
<div class="page"><p/>
<p>7.2 Paths, Cycles, and Connectivity 131 
</p>
<p>The first and last nodes in the row are called the endpoints of the path. If 
</p>
<p>we also connect the last node to the first, we obtain a cycle (or circuit). 
</p>
<p>The number of edges in a path or cycle is called its length. A cycle of 
</p>
<p>length k is often called a k-cycle. Of course, we can draw the same graph 
</p>
<p>in many other ways, placing the nodes elsewhere, and we may get edges 
</p>
<p>that intersect (Figure 7.5). 
</p>
<p>FIGURE 7.5. Two paths and two cycles 
</p>
<p>A graph H is called a subgraph of a graph G if it can be obtained from 
</p>
<p>G by deleting some of its edges and nodes (of course, if we delete a node 
</p>
<p>we automatically delete all the edges that connect it to other nodes). 
</p>
<p>7.2.1 Find all complete graphs, paths, and cycles among the graphs in Figures 
7.1-7.5. 
</p>
<p>7.2.2 How many subgraphs does an edgeless graph on n nodes have? How many 
subgraphs does a triangle have? 
</p>
<p>7.2.3 Find all graphs that are paths or cycles and whose complements are also 
paths or cycles. 
</p>
<p>A key notion in graph theory is that of a connected graph. It is intuitively 
</p>
<p>clear what this should mean, but it is also easy to formulate the property 
</p>
<p>as follows: A graph G is connected if every two nodes of the graph are 
connected by a path in G. To be more precise: A graph G is connected if 
</p>
<p>for every two nodes u and v, there exists a path with endpoints u and v 
</p>
<p>that is a subgraph of G (Figure 7.6). 
</p>
<p>It will be useful to include a little discussion of this notion. Suppose that 
</p>
<p>nodes a and b are connected by a path P in our graph. Also suppose that 
</p>
<p>nodes band c are connected by a path Q. Can a and c be connected by a 
path? The answer seems to be obviously "yes," since we can just go from a 
</p>
<p>to b and then from b to c. But there is a difficulty: Concatenating (joining 
</p>
<p>together) the two paths may not yield a path from a to c, since P and Q 
</p>
<p>may intersect each other (Figure 7.7). But we can construct a path from a 
</p>
<p>to c easily: Let us follow the path P to its first common node d with Q; then 
</p>
<p>let us follow Q to c. Then the nodes we traversed are all distinct. Indeed, </p>
<p/>
</div>
<div class="page"><p/>
<p>132 7. Graphs 
</p>
<p>,.... y -&lt; ~ ~ 
] 
</p>
<p>- - -
</p>
<p>J" ....,. 
</p>
<p>J 
,.... 
</p>
<p>T 1 
,.... 
</p>
<p>~ 
</p>
<p>T 
0- -0 
</p>
<p>.l - - - - ~ 
FIGURE 7.6. A path in a graph connecting two nodes 
</p>
<p>the nodes on the first part of our walk are distinct because they are nodes 
</p>
<p>of the path P; similarly, the nodes on the second part are distinct because 
</p>
<p>they are nodes of the path Q; finally, any node of the first part must be 
</p>
<p>distinct from any node of the second part (except, of course, the node d), 
because d is the first common node of the two paths and so the nodes of P 
</p>
<p>that we passed through before d are not nodes of Q at all. Hence the nodes 
</p>
<p>and edges we have traversed form a path from a to c as claimed.2 
</p>
<p>A walk in a graph G is a sequence of nodes Vo, VI, ... ,Vk such that Vo is 
</p>
<p>adjacent to VI, which is adjacent to V2, which is adjacent to V3, etc.; any 
</p>
<p>two consecutive nodes in the sequence must be connected by an edge. This 
</p>
<p>sounds almost like a path: The difference is that a walk may pass through 
</p>
<p>the same node several times, while a path must go through different nodes. 
</p>
<p>Informally, a walk is a "path with repetition"; more correctly, a path is a 
</p>
<p>walk without repetition. Even the first and last nodes of the walk may be 
</p>
<p>the same; in this case, we call it a closed walk. The shortest possible walk 
</p>
<p>consists of a single node Vo (this is closed). If the first node Vo is different 
</p>
<p>from the last node Vk, then we say that this walk connects nodes Vo and 
</p>
<p>Vk&middot; 
</p>
<p>2We have given more details of this proof than was perhaps necessary. One should 
</p>
<p>note, however, that when arguing about paths and cycles in graphs, it is easy to draw 
</p>
<p>pictures (on the paper or mentally) that make implicit assumptions and are therefore 
</p>
<p>misleading. For example, when joining together two paths, one's first mental image is a 
</p>
<p>single (longer) path, which may not be the case. </p>
<p/>
</div>
<div class="page"><p/>
<p>7.2 Paths, Cycles, and Connectivity 133 
</p>
<p>FIGURE 7.7. Selecting a path from a to c, given a path from a to b and a path 
</p>
<p>from b to c. 
</p>
<p>Is there a difference between connecting two nodes by a walk and con-
</p>
<p>necting them by a path? Not really: If two nodes can be connected by a 
</p>
<p>walk, then they can also be connected by a path. Sometimes it is more 
</p>
<p>convenient to use paths, sometimes, to use walks (see Exercise 7.2.6). 
</p>
<p>Let G be a graph that is not necessarily connected. G will have connected 
</p>
<p>subgraphs; for example, the sub graph consisting of a single node (and no 
</p>
<p>edge) is connected. A connected component H is a maximal subgraph that 
</p>
<p>is connected; in other words, H is a connected component if it is connected 
</p>
<p>but every other subgraph of G that contains H is disconnected. It is clear 
that every node of G belongs to some connected component. It follows by 
</p>
<p>Exercise 7.2.7 that different connected components of G have no node in 
</p>
<p>common (otherwise, their union would be a connected subgraph containing 
</p>
<p>both of them). In other words, every node of G is contained in a unique 
</p>
<p>connected component. 
</p>
<p>7.2.4 Is the proof as given above valid if (a) the node a lies on the path Q; (b) 
</p>
<p>the paths P and Q have no node in common except b? 
</p>
<p>7.2.5 (a) We delete an edge e from a connected graph G. Show by an example 
</p>
<p>that the remaining graph may not be connected. 
</p>
<p>(b) Prove that if we assume that the deleted edge e belongs to a cycle that is 
</p>
<p>a subgraph of G, then the remaining graph is connected. 
</p>
<p>7.2.6 Let G be a graph and let u and v be two nodes of G. 
</p>
<p>(a) Prove that if there is a walk in G from u to v, then G contains a path 
</p>
<p>connecting u and v. 
</p>
<p>(b) Use part (a) to give another proof of the fact that if G contains a path 
</p>
<p>connecting a and b, and also a path connecting band c, then it contains a 
</p>
<p>path connecting a and c. </p>
<p/>
</div>
<div class="page"><p/>
<p>134 7. Graphs 
</p>
<p>7.2.7 Let G be a graph, and let HI = (VI,EI ) and H2 = (V2,E2) be two 
subgraphs of G that are connected. Assume that HI and H2 have at least one node 
</p>
<p>in common. Form their union, i.e., the subgraph H = (V', E'), where V' = VIUV2 
and E' = EI U E2. Prove that H is connected. 
</p>
<p>7.2.8 Determine the connected components of the graphs constructed in Exer-
</p>
<p>cise 7.1.4. 
</p>
<p>7.2.9 Prove that no edge of G can connect nodes in different connected com-
</p>
<p>ponents. 
</p>
<p>7.2.10 Prove that a node v is a node of the connected component of G contain-
</p>
<p>ing node u if and only if g contains a path connecting u to v. 
</p>
<p>7.2.11 Prove that a graph with n nodes and more than (n~l) edges is always 
</p>
<p>connected. </p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Eulerian Walks and Hamiltonian Cycles 135 
</p>
<p>7.3 Eulerian Walks and Hamiltonian Cycles 
</p>
<p>Perhaps the oldest result in graph theory was discovered by Leonhard Euler, 
</p>
<p>the greatest mathematician of the eighteenth century. 
</p>
<p>FIGURE 7.8. Leonhard Euler 1707- 1783 
</p>
<p>It started with a recreational challenge that the citizens of Konigsberg 
</p>
<p>(today, Kaliningrad) raised. The city was divided into four districts by 
</p>
<p>branches of the river Pregel (Figure 7.9), which were connected by seven 
</p>
<p>bridges. It was nice to walk around, crossing these bridges, and so the 
</p>
<p>question arose, is it possible to take a walk so that one crosses every bridge 
</p>
<p>exactly once? 
</p>
<p>FIGURE 7.9. The bridges of Konigsberg in Euler 's time, and the graph modeling 
</p>
<p>them. </p>
<p/>
</div>
<div class="page"><p/>
<p>136 7. Graphs 
</p>
<p>Euler published a paper in 1736 in which he proved that such a walk 
</p>
<p>was impossible. The argument is quite simple. Suppose that there is such a 
</p>
<p>walk. Consider any of the four parts of the town, say the island Kneiphoff, 
</p>
<p>and suppose that our walk does not start here. Then at some point in 
</p>
<p>time, we enter the island by crossing a bridge; somewhat later, we leave it 
</p>
<p>through another bridge (by the rules of the walk). Then we enter it again 
</p>
<p>through a third bridge, then leave it through a fourth, then enter it through 
</p>
<p>the fifth, then .... We cannot leave the island (at least not as part of the 
</p>
<p>walk), since we have used up all the bridges that lead to it. We must end 
</p>
<p>our walk on the island. 
</p>
<p>So we must either start or end our walk on the island. This is OK-the 
</p>
<p>rules don't forbid it. The trouble is that we can draw the same conclusion 
</p>
<p>for any of the other three districts of the town. The only difference is that 
</p>
<p>instead of five bridges, these districts are connected to the rest of the town 
</p>
<p>by only three bridges; so if we don't start there, we get stuck there at the 
</p>
<p>second visit, not the third. 
</p>
<p>But now we are in trouble: we cannot start or end the walk in each of 
</p>
<p>the four districts! This proves that no walk can cross every bridge exactly 
</p>
<p>once. 
</p>
<p>Euler remarked that one could reach this conclusion by making an ex-
</p>
<p>haustive list of all possible routes, and checking that none of them can be 
</p>
<p>completed as required; but this would be impractical due to the large num-
</p>
<p>ber of possibilities. More significantly, he formulated a general criterion by 
</p>
<p>which one could decide for every city (no matter how many islands and 
</p>
<p>bridges it had) whether one could take a walk crossing every bridge exactly 
</p>
<p>once. 
</p>
<p>Euler's result is generally regarded as the first theorem of graph theory. 
</p>
<p>Of course, Euler did not have the terminology of graphs (which was not to 
</p>
<p>appear for more than a century), but we can use it to state Euler's theorem. 
</p>
<p>Let G be a graph; for the following discussion, we allow parallel edges, i.e., 
</p>
<p>several edges connecting the same pair of nodes. A walk in such a graph is a 
</p>
<p>bit more difficult to define. It consists of a sequence of nodes again such that 
</p>
<p>any two consecutive nodes are connected by an edge; but if there are several 
</p>
<p>edges connecting these consecutive nodes, we also have to specify which of 
</p>
<p>these edges is used to move from one node to the next. So formally, a walk 
</p>
<p>in a graph with parallel edges is a sequence Va, el, VI, e2, V2, ... , Vk-I, ek, Vk, 
</p>
<p>where Va, VI, ... ,Vk are nodes, el, e2, ... , ek are edges, and edge ei connects 
</p>
<p>nodes Vi-I and Vi (i = 1,2, ... , k). 
An Eulerian walk is a walk that goes through every edge exactly once 
</p>
<p>(the walk mayor may not be closed; see Figure 7.10). To see how to cast 
</p>
<p>the problem of the Konigsberg bridges into this language, let us represent 
</p>
<p>each district by a node and draw an edge connecting two nodes for every 
</p>
<p>bridge connecting the two corresponding districts. We get the little graph 
</p>
<p>on the right hand side of Figure 7.9. A walk in the town corresponds to 
</p>
<p>a walk in this graph (at least, if only crossing the bridges matters), and </p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Eulerian Walks and Hamiltonian Cycles 137 
</p>
<p>a walk that crosses every bridge exactly once corresponds to an Eulerian 
</p>
<p>walk. 
</p>
<p>FIGURE 7.lD. An Eulerian walk in a graph. 
</p>
<p>Recast in this language, Euler's criteria are stated in the following the-
</p>
<p>orem. 
</p>
<p>Theorem 7.3.1 (a) If a connected graph has more than two nodes with 
</p>
<p>odd degree, then it has no Eulerian walk. 
</p>
<p>(b) If a connected graph has exactly two nodes with odd degree, then it 
</p>
<p>has an Eulerian walk. Every Eulerian walk must start at one of these and 
</p>
<p>end at the other one. 
</p>
<p>( c) If a connected graph has no nodes with odd degree, then it has an 
</p>
<p>Eulerian walk. Every Eulerian walk is closed. 
</p>
<p>Proof. Euler's argument above gives the following: If a node v has odd 
</p>
<p>degree, then every Eulerian walk must either start or end at v. Similarly, 
</p>
<p>we can see that if a node v has even degree, then every Eulerian walk either 
</p>
<p>starts and ends at v, or starts and ends somewhere else. This observation 
</p>
<p>immediately implies (a), as well as the second assertions in (b) and (c). 
</p>
<p>To finish the proof, we have to show that if a connected graph has 0 or 
</p>
<p>2 nodes with odd degree, then it has an Eulerian walk. We describe the 
</p>
<p>proof in the case where there is no node of odd degree (part (c)); the other 
</p>
<p>case is left to the reader as Exercise 7.3.14. 
</p>
<p>Let v be any node. Consider a closed walk starting and ending at v that 
</p>
<p>uses every edge at most once. Such a walk exists. For example, we can take 
</p>
<p>the walk consisting of the node v only. But we don't want this very short 
</p>
<p>walk; instead, we consider a longest closed walk W starting at v, using 
</p>
<p>every edge at most once. 
</p>
<p>We want to show that this walk W is Eulerian. Suppose not. Then there 
</p>
<p>is at least one edge e that is not used by W. We claim that we can choose 
</p>
<p>this edge so that W passes through at least one of its endpoints. Indeed, if </p>
<p/>
</div>
<div class="page"><p/>
<p>138 7. Graphs 
</p>
<p>p and q are the endpoints of e and W does not pass through them, then we 
</p>
<p>take a path from p to v (such a path exists since the graph is connected), 
</p>
<p>and look at the first node r on this path that is also on the walk W (Figure 
</p>
<p>7.11(a)). Let e' = sr be the edge of the path just before r. Then W does 
</p>
<p>.... p q &lt;. &middot;&middot;&middot;&middot;&middot;&middot;&middot;0 e 0 
</p>
<p>(a) (b) 
</p>
<p>FIGURE 7.11. (a) Finding an edge not in W but meeting W. (b) Combining W 
</p>
<p>and W'. 
</p>
<p>not pass through e (because it does not pass through s), so we can replace 
e by e' , which has one endpoint on W. 
</p>
<p>So let e be an edge that is not used by W but has an endpoint p that is 
</p>
<p>used by W. Then we start a new walk W' at p. We start through e, and 
</p>
<p>continue walking as we please, only taking care that (i) we don't use the 
</p>
<p>edges of W, and (ii) we don't use any edge twice. 
</p>
<p>Sooner of later we get stuck, but where? Let u be the node where we 
</p>
<p>get stuck, and suppose that u -=I- p. Node u has even degree; W uses up an 
</p>
<p>even number of edges incident with u; every previous visit of the new walk 
</p>
<p>to this node used up two edges (in and out); our last entrance used up one 
</p>
<p>edge; so we have an odd number of edges that are edges neither of W nor 
</p>
<p>of W'. But this means that we can continue our walk! 
</p>
<p>So the only node we can get stuck in is node p. This means that W' is a 
</p>
<p>closed walk. Now we take a walk as follows. Starting at v, we follow W to 
</p>
<p>p; then follow W' all the way through, so that eventually we get back to p; 
</p>
<p>then follow W to its end at v (Figure 7.11 (b) ). This new walk starts and 
</p>
<p>ends at v , uses every edge at most once, and is longer than W, which is a 
</p>
<p>contradiction. D 
</p>
<p>Euler's result above is often formulated as follows: A connected graph has 
</p>
<p>a closed Eulerian walk if and only if every node has even degree. 
</p>
<p>7.3.1 Which of the graphs in Figure 7.12 have an Eulerian walk? Which ofthem 
</p>
<p>have a closed Eulerian walk? Find an Eulerian walk if it exists. </p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Eulerian Walks and Hamiltonian Cycles 139 
</p>
<p>FE FE 
</p>
<p>FIGURE 7.12. Which of these graphs has an Eulerian walk? 
</p>
<p>7.3.2 When does a connected graph contain two walks such that every edge is 
</p>
<p>used by exactly one of them, exactly once? 
</p>
<p>A question similar to the problem of the Bridges of Konigsberg was raised 
</p>
<p>by another famous mathematician, the Irish William R. Hamilton, in 1856. 
</p>
<p>A Hamiltonian cycle is a cycle that contains all nodes of a graph. The 
</p>
<p>Hamilton cycle problem is the problem of deciding whether or not a given 
</p>
<p>graph has a Hamiltonian cycle. 
</p>
<p>Hamiltonian cycles sound quite similar to Eulerian walks: Instead of 
</p>
<p>requiring that every edge be used exactly once, we require that every node 
</p>
<p>be used exactly once. But much less is known about them than about 
</p>
<p>Eulerian walks. Euler told us how to decide whether a given graph has an 
</p>
<p>Eulerian walk; but no efficient way is known to check whether a given graph 
</p>
<p>has a Hamiltonian cycle, and no useful necessary and sufficient condition for 
</p>
<p>the existence of a Hamiltonian cycle is known. If you solve Exercise 7.3.3, 
</p>
<p>you'll get a feeling about the difficulty of the Hamiltonian cycle problem. 
</p>
<p>7.3.3 Decide whether the graphs in Figure 7.13 have a Hamiltonian cycle. 
</p>
<p>FIGURE 7.13. Two famous graphs: the dodecahedron graph (cf. Chapter 12) and 
</p>
<p>the Petersen graph. </p>
<p/>
</div>
<div class="page"><p/>
<p>140 7. Graphs 
</p>
<p>Review Exercises 
</p>
<p>7.3.4 Draw all graphs on 5 nodes in which every node has degree at most 2. 
</p>
<p>7.3.5 Does there exists a graph with the following degrees: (a) 0,2,2,2,4,4,6; 
</p>
<p>(b) 2,2,3,3,4,4,5. 
</p>
<p>7.3.6 Draw the graphs representing the bonds between atoms in (a) a water 
</p>
<p>molecule; (b) a methane molecule; (c) two water molecules. 
</p>
<p>7.3.7 At a party there were 7 boys and 6 girls. Every boy danced with every 
</p>
<p>girl. Draw the graph representing the dancing. How many edges does it have? 
</p>
<p>What are its degrees? 
</p>
<p>7.3.8 How many subgraphs does a 4-cycle have? 
</p>
<p>7.3.9 Prove that at least one of G and G is connected. 
</p>
<p>7.3.10 Let G be a connected graph with at least two nodes. Prove that it has 
</p>
<p>a node such that if this node is removed (along with all edges incident with it), 
</p>
<p>the remaining graph is connected. 
</p>
<p>7.3.11 Let G be a connected graph that is not a path. Prove that it has at least 
</p>
<p>three vertices such that if any of them is removed, the remaining graph is still 
</p>
<p>connected. 
</p>
<p>7.3.12 Let G be a connected graph in which every pair of edges have an endpoint 
</p>
<p>in common. Show that G is either a star or a K 3 . 
</p>
<p>7.3.13 There are (m - 1)n + 1 people in a room. Show that either there are m 
people who mutually do not know each other, or there is a person who knows at 
</p>
<p>least n others. 
</p>
<p>7.3.14 Prove part (b) of Theorem 7.3.1. 
</p>
<p>7.3.15 Theorem 7.3.1 talks about connected graphs. Which disconnected graphs 
</p>
<p>have an Eulerian walk? </p>
<p/>
</div>
<div class="page"><p/>
<p>8 
</p>
<p>Trees 
</p>
<p>8.1 How to Define Trees 
</p>
<p>We have met trees when we were studying enumeration problems; now we 
</p>
<p>take a look at them as graphs. A graph G = (V, E) is called a tree if it 
is connected and contains no cycle as a subgraph. The simplest tree has 
</p>
<p>one node and no edges. The second simplest tree consists of two nodes 
</p>
<p>connected by an edge. Figure 8.1 shows a variety of other trees. 
</p>
<p>FIGURE 8.1. Five trees. 
</p>
<p>Note that the two properties defining trees work in opposite directions: 
</p>
<p>Connectedness means that the graph cannot have "too few" edges, while 
</p>
<p>the exclusion of cycles means that it cannot have "too many." To be more 
</p>
<p>precise, if a graph is connected, then if add a new edge to it, it remains 
</p>
<p>connected (while if we delete an edge, it may become disconnected). If a 
</p>
<p>graph contains no cycle, then if we delete any edge, the remaining graph </p>
<p/>
</div>
<div class="page"><p/>
<p>142 8. Trees 
</p>
<p>will still not contain a cycle (while adding a new edge may create a cycle). 
</p>
<p>The following theorem shows that trees can be characterized as "minimally 
</p>
<p>connected" graphs as well as "maximally cycle-free" graphs. 
</p>
<p>Theorem 8.1.1 (a) A graph G is a tree if and only if it is connected, but 
</p>
<p>deleting any of its edges results in a disconnected graph. 
</p>
<p>(b) A graph G is a tree if and only if it contains no cycles, but adding 
</p>
<p>any new edge creates a cycle. 
</p>
<p>Proof. We prove part (a) of this theorem; the proof of part (b) is left as 
</p>
<p>an exercise. 
</p>
<p>First, we have to prove that if G is a tree then it satisfies the condition 
</p>
<p>given in the theorem. It is clear that G is connected (by the definition of 
</p>
<p>a tree). We want to prove that if we delete any edge, it cannot remain 
</p>
<p>connected. The proof is indirect: Assume that when the edge uv is deleted 
</p>
<p>from a tree G, the remaining graph G' is connected. Then G' contains a 
</p>
<p>path P connecting u and v. But then, if we put the edge uv back, the path 
</p>
<p>P and the edge uv will form a cycle in G, which contradicts the definition 
</p>
<p>of trees. 
</p>
<p>Second, we have to prove that if G satisfies the condition given in the 
</p>
<p>theorem, then it is a tree. It is clear that G is connected, so we only have 
</p>
<p>to argue that G does not contain a cycle. Again by an indirect argument, 
</p>
<p>assume that G does contain a cycle C. Then deleting any edge of C, we ob-
tain a connected graph (Exercise 7.2.5). But this contradicts the condition 
</p>
<p>in the theorem. 0 
</p>
<p>Consider a connected graph G on n nodes, and an edge e of G. If we 
</p>
<p>delete e, the remaining graph mayor may not remain connected. If it is 
</p>
<p>disconnected, then we call e a cut-edge. Part (a) of Theorem 8.1.1 implies 
</p>
<p>that every edge of a tree is a cut-edge. 
</p>
<p>If we find an edge that is not a cut-edge, delete it. Go on deleting edges 
</p>
<p>until a graph is obtained that is still connected, but deleting any edge from 
</p>
<p>it leaves a disconnected graph. By part (a) of Theorem 8.1.1, this is a tree, 
</p>
<p>with the same node set as G. A subgraph of G with the same node set that 
</p>
<p>is a tree is called a spanning tree of G. The edge deletion process above 
</p>
<p>can, of course, be carried out in many ways, so a connected graph can have 
</p>
<p>many different spanning trees. 
</p>
<p>Rooted trees. Often, we use trees that have a special node, which we call 
</p>
<p>the root. For example, trees that occurred in counting subsets or permuta-
</p>
<p>tions were built starting with a given node. 
</p>
<p>We can take any tree, select any of its nodes, and call it a root. A tree 
</p>
<p>with a specified root is called a rooted tree. 
</p>
<p>Let G be a rooted tree with root r. Given any node v different from r, 
</p>
<p>we know from Exercise 8.1.3 below that the tree contains a unique path 
</p>
<p>connecting v to r. The node on this path next to v is called the father of </p>
<p/>
</div>
<div class="page"><p/>
<p>8.2 How to Grow Trees 143 
</p>
<p>v. The other neighbors of v are called the sons of v. The root r does not 
</p>
<p>have a father, but all its neighbors are called its sons. 
</p>
<p>We now make a basic genealogical assertion: Every node is the father of 
</p>
<p>its sons. Indeed, let v be any node, and let u be one of its sons. Consider 
</p>
<p>the unique path P connecting v to r. The node u cannot lie on P: It cannot 
</p>
<p>be the first node after v, since then it would be the father of v, and not its 
</p>
<p>son; and it cannot be a later node, since then in going from v to u on the 
</p>
<p>path P and then back to v on the edge uv we would traverse a cycle. But 
</p>
<p>this implies that in adding the node u and the edge uv to P we get a path 
</p>
<p>connecting u to r. Since v is the first node on this path after u, it follows 
</p>
<p>that v is the father of u. (Is this argument valid when v = r? Check!) 
We have seen that every node different from the root has exactly one 
</p>
<p>father. A node can have any number of sons, including zero. A node with 
</p>
<p>no sons is called a leaf In other words, a leaf is a node with degree 1, 
</p>
<p>different from r. 
</p>
<p>8.1.1 Prove part (b) of Theorem 8.1.1. 
</p>
<p>8.1.2 Prove that connecting two nodes u and v in a graph G by a new edge 
</p>
<p>creates a new cycle if and only if u and v are in the same connected component 
</p>
<p>ofG. 
</p>
<p>8.1.3 Prove that in a tree, every two nodes can be connected by a unique path. 
</p>
<p>Conversely, prove that if a graph G has the property that every two nodes can be 
</p>
<p>connected by a path, and there is only one connecting path for each pair, then 
</p>
<p>the graph is a tree. 
</p>
<p>8.2 How to Grow Trees 
</p>
<p>The following is one of the most important properties of trees. 
</p>
<p>Theorem 8.2.1 Every tree with at least two nodes has at least two nodes 
</p>
<p>of degree 1. 
</p>
<p>Proof. Let G be a tree with at least two nodes. We prove that G has a 
</p>
<p>node of degree 1, and leave it to the reader as an exercise to prove that it 
</p>
<p>has at least one more. (A path has only two such nodes, so this is the best 
</p>
<p>possible we can claim.) 
</p>
<p>Let us start from any node Va of the tree and take a walk (climb?) on the 
</p>
<p>tree. Let's say we never want to turn back from a node on the edge through 
</p>
<p>which we entered it; this is possible unless we get to a node of degree 1, in 
</p>
<p>which case we stop and the proof is finished. 
</p>
<p>So let's argue that this must happen sooner or later. If not, then even-
</p>
<p>tually we must return to a node we have already visited; but then the </p>
<p/>
</div>
<div class="page"><p/>
<p>144 8. Trees 
</p>
<p>nodes and edges we have traversed between the two visits form a cycle. 
</p>
<p>This contradicts our assumption that G is a tree and hence contains no 
</p>
<p>cycle. 0 
</p>
<p>8.2.1 Apply the argument above to find a second node of degree 1. 
</p>
<p>A real tree grows by developing new twigs again and again. We show that 
</p>
<p>graph-trees can be grown in the same way. To be more precise, consider 
</p>
<p>the following procedure, which we call the Tree-growing Procedure: 
</p>
<p>Start with a single node. 
</p>
<p>Repeat the following any number of times: If you have any graph G, 
</p>
<p>create a new node and connect it by a new edge to any node of G. 
</p>
<p>Theorem 8.2.2 Every graph obtained by the Tree-growing Procedure is a 
</p>
<p>tree, and every tree can be obtained this way. 
</p>
<p>Proof. The proof of this is again rather straightforward, but let us go 
</p>
<p>through it, if only to gain practice in arguing about graphs. 
</p>
<p>First, consider any graph that can be obtained by this procedure. The 
</p>
<p>starting graph is certainly a tree, so it suffices to argue that we never 
</p>
<p>create a nontree; in other words, if G is a tree, and G' is obtained from G 
</p>
<p>by creating a new node v and connecting it to a node u of G, then G' is 
</p>
<p>a tree. This is straightforward: G' is connected, since any two "old" nodes 
</p>
<p>can be connected by a path in G, while v can be connected to any other 
</p>
<p>node w by first going to u and then connecting u to w. Moreover, G cannot 
</p>
<p>contain a cycle: v has degree 1, and so no cycle can go through v, but a 
</p>
<p>cycle that does not go through v would be a cycle in the old graph, which 
</p>
<p>is supposed to be a tree. 
</p>
<p>Second, let's argue that every tree can be constructed this way. We prove 
</p>
<p>this by induction on the number of nodes. 1 If the number of nodes is 1, then 
</p>
<p>the tree arises by the construction, since this is the way we start. Assume 
</p>
<p>that G is a tree with at least 2 nodes. Then by Theorem 8.2.1, G has a 
</p>
<p>node of degree 1 (at least two nodes, in fact). Let v be a node with degree 
</p>
<p>1. Delete v from G, together with the edge with endpoint v, to get a graph 
</p>
<p>G'. 
</p>
<p>We claim that G' is a tree. Indeed, G' is connected: Any two nodes of G' 
</p>
<p>can be connected by a path in G, and this path cannot go through v, since 
</p>
<p>v has degree 1. So this path is also a path in G'. Furthermore, G' does not 
</p>
<p>contain a cycle since G does not. 
</p>
<p>lThe first part of the proof is also an induction argument, even though it was not 
</p>
<p>phrased as such. </p>
<p/>
</div>
<div class="page"><p/>
<p>8.2 How to Grow Trees 145 
</p>
<p>By the induction hypothesis, every tree with fewer nodes than G arises 
</p>
<p>by the construction; in particular, G' does. But then G arises from G' by 
</p>
<p>one more iteration of the second step. This completes the proof of Theorem 
</p>
<p>8.2.2. [] 
</p>
<p>Figure 8.2 shows how trees with up to 4 nodes arise by this construction. 
</p>
<p>Note that there is a "tree of trees" here. The fact that the logical structure 
</p>
<p>of this construction is a tree does not have anything to do with the fact 
</p>
<p>that we are constructing trees: any iterative construction with free choices 
</p>
<p>at each step results in a similar "descent tree" . 
</p>
<p>FIGURE 8.2. The descent tree of trees 
</p>
<p>The Tree-growing Procedure can be used to establish a number of prop-
</p>
<p>erties of trees. Perhaps most important of these concerns the number of 
</p>
<p>edges. How many edges does a tree have? Of course, this depends on the 
</p>
<p>number of nodes; but surprisingly, it depends only on the number of nodes: 
</p>
<p>Theorem 8.2.3 Every tree on n nodes has n - 1 edges. 
</p>
<p>Proof. Indeed, we start with one more node (1) than edge (0), and at 
</p>
<p>each step, one new node and one new edge are added, so this difference of 
</p>
<p>1 is maintained. [] 
</p>
<p>8.2.2 Let G be a tree, which we consider as the network of roads in a medieval 
</p>
<p>country, with castles as nodes. The king lives at node r. On a certain day, the 
</p>
<p>lord of each castle sets out to visit the king. Argue carefully that soon after they 
</p>
<p>have left their castles, there will be exactly one lord on each edge. Give a proof 
</p>
<p>of Theorem 8.2.3 based on this. </p>
<p/>
</div>
<div class="page"><p/>
<p>146 8. Trees 
</p>
<p>8.2.3 If we delete a node v from a tree (together with all edges that end there), 
we get a graph whose connected components are trees. We call these connected 
components the branches at node v. Prove that every tree has a node such that 
every branch at this node contains at most half the nodes of the tree. 
</p>
<p>8.3 How to Count Trees? 
</p>
<p>We have counted all sorts of things in the first part of this book; now that 
</p>
<p>we are familiar with trees, it is natural to ask: How many trees are there 
</p>
<p>on n nodes? 
</p>
<p>Before attempting to answer this question, we have to clarify an impor-
</p>
<p>tant issue: when do we consider two trees different? There is more than 
</p>
<p>one reasonable answer to this question. Consider the trees in Figure 8.3. 
</p>
<p>Are they the same? One could say that they are; but then, if the nodes 
</p>
<p>are, say, towns, and the edges represent roads to be built between them, 
</p>
<p>then clearly the inhabitants of the towns will consider the two plans very 
</p>
<p>different. 
</p>
<p>FIGURE 8.3. Are these trees the same? 
</p>
<p>So we have to define carefully when we consider two trees the same. The 
</p>
<p>following are two possibilities: 
</p>
<p>We fix the set of nodes, and consider two trees the same if the same 
</p>
<p>pairs of nodes are connected in each. (This is the position the towns-
</p>
<p>people would take when they consider road construction plans.) In 
</p>
<p>this case, it is advisable to give names to the nodes, so that we can 
</p>
<p>distinguish them. It is convenient to use the numbers 0,1,2, ... ,n-1 
</p>
<p>as names (if the tree has n nodes). We express this by saying that the 
</p>
<p>vertices of the tree are labeled by 0,1,2, ... n - 1. Figure 8.4 shows 
</p>
<p>a labeled tree. Interchanging the labels 2 and 4 (say) would yield a 
</p>
<p>different labeled tree. 
</p>
<p>We don't give names to the nodes, and consider two trees the same 
</p>
<p>if we can rearrange the nodes of one so that we get the other tree. 
</p>
<p>More exactly, we consider two trees the same (the mathematical term 
</p>
<p>for this is isomorphic) if there exists a one-to-one correspondence </p>
<p/>
</div>
<div class="page"><p/>
<p>8.3 How to Count Trees? 147 
</p>
<p>between the nodes of the first tree and the nodes of the second tree 
</p>
<p>such that two nodes in the first tree that are connected by an edge 
</p>
<p>correspond to nodes in the second tree that are connected by an edge, 
</p>
<p>and vice versa. If we speak about unlabeled trees, we mean that we 
</p>
<p>don't distinguish isomorphic trees from each other. For example, all 
</p>
<p>paths on n nodes are the same as unlabeled trees. 
</p>
<p>So we can ask two questions: How many labeled trees are there on n 
</p>
<p>nodes? and how many unlabeled trees are there on n nodes? These are 
</p>
<p>really two different questions, and we have to consider them separately. 
</p>
<p>8.3.1 Find all unlabeled trees on 2,3,4, and 5 nodes. How many labeled trees 
do you get from each? Use this to find the number of labeled trees on 2,3,4, and 
5 nodes. 
</p>
<p>8.3.2 How many labeled trees on n nodes are stars? How many are paths? 
</p>
<p>The number of labeled trees. For the case of labeled trees, there is a 
</p>
<p>very nice solution. 
</p>
<p>Theorem 8.3.1 (Cayley's Theorem) The number of labeled trees on n 
nodes is nn-2. 
</p>
<p>The formula is elegant, but the surpnsmg fact about it is that it is 
</p>
<p>quite difficult to prove! It is substantially deeper than any of the previous 
</p>
<p>formulas for the number of this and that. There are various ways to prove 
</p>
<p>it, but each uses some deeper tool from mathematics or a deeper idea. 
</p>
<p>We'll give a proof that is perhaps best understood by first discussing a 
</p>
<p>quite different question in computer science: how to store trees. 
</p>
<p>7 8 
</p>
<p>1 
</p>
<p>3 }----{ 0 }----{ 
</p>
<p>5 
</p>
<p>FIGURE 8.4. A labeled tree </p>
<p/>
</div>
<div class="page"><p/>
<p>148 8. Trees 
</p>
<p>8.4 How to Store Trees 
</p>
<p>Suppose that you want to store a labeled tree, say the tree in Figure 8.4, 
</p>
<p>in a computer. How would you do this? Of course, the answer depends on 
</p>
<p>what you need to store the tree for, what information about it you want 
</p>
<p>to retrieve and how often, etc. Right now, we are concerned only with the 
</p>
<p>amount of memory we need. We want to store the tree so that it occupies 
</p>
<p>the least amount of memory. 
</p>
<p>Let's try some simple solutions. 
</p>
<p>(a) Suppose that we have a tree G with n nodes. One thing that comes to 
</p>
<p>mind is to make a big table, with n rows and n columns, and put (say) the 
</p>
<p>number 1 in the jth position of the ith row if nodes i and j are connected 
</p>
<p>by an edge, and the number 0, if they are not. It will be convenient to place 
</p>
<p>the node labeled 0 last, so it corresponds to the 10th row and to the 10th 
</p>
<p>column: 
</p>
<p>0 0 0 0 0 1 0 0 0 0 
</p>
<p>0 0 0 1 0 1 0 0 0 1 
</p>
<p>0 0 0 0 0 0 0 0 0 1 
</p>
<p>0 1 0 0 0 0 0 0 0 0 
</p>
<p>0 0 0 0 0 1 0 0 0 0 
(8.1) 
</p>
<p>1 1 0 0 1 0 0 0 0 0 
</p>
<p>0 0 0 0 0 0 0 0 1 0 
</p>
<p>0 0 0 0 0 0 0 0 1 0 
</p>
<p>0 0 0 0 0 0 1 1 0 0 
</p>
<p>0 1 1 0 0 0 0 0 0 0 
</p>
<p>This method of storing the tree can, of course, be used for any graph (it 
</p>
<p>is called the adjacency matrix of the graph, just to mention its name). It is 
</p>
<p>often very useful, but at least for trees, it is very wasteful. We need one bit 
</p>
<p>to store each entry of this table, so this takes n 2 bits. We can save a little 
</p>
<p>by noticing that it is enough to store the part below the diagonal, since the 
</p>
<p>diagonal is always 0 and the other half of the table is just the reflection of 
</p>
<p>the half below the diagonal. But this is still (n 2 - n)/2 bits. 
</p>
<p>(b) We fare better if we specify each tree by listing all its edges. We can 
</p>
<p>specify each edge by its two endpoints. It will be convenient to arrange this 
</p>
<p>list in an array whose columns correspond to the edges. For example, the 
</p>
<p>tree in Figure 8.4 can be encoded by 
</p>
<p>789 6 3 0 266 
992 2 0 2 4 1 5 
</p>
<p>Instead of a table with n rows, we get a table just with two rows. We pay a 
</p>
<p>little for this: Instead of just 0 and 1, the table will contain integers between 
</p>
<p>o and n - 1. But this is certainly worth it: Even if we count bits, to write </p>
<p/>
</div>
<div class="page"><p/>
<p>8.4 How to Store Trees 149 
</p>
<p>down the label of a node takes log2 n bits, so the whole table occupies only 
</p>
<p>2nlog2 n bits, which is much less than (n 2 - n)/2 if n is large. 
</p>
<p>There is still a lot of free choice here, which means that the same tree may 
</p>
<p>be encoded in different ways: We have freedom in choosing the order of the 
</p>
<p>edges, and also in choosing the order in which the two endpoints of an edge 
</p>
<p>are listed. We could agree on some arbitrary conventions to make the code 
</p>
<p>well defined (say, listing the two endnodes of an edge in increasing order, 
</p>
<p>and then the edges in increasing order of their first endpoints, breaking ties 
</p>
<p>according to the second endpoints); but it will be more useful to do this in 
</p>
<p>a way that also allows us to save more memory. 
</p>
<p>(c) The father code. From now on, the node with label 0 will play a 
</p>
<p>special role; we'll consider it the "root" of the tree. Then we can list the 
</p>
<p>two endnodes of an edge by listing the endpoint further from the root first, 
</p>
<p>and then the endpoint nearer to the root second. So for every edge, the 
</p>
<p>node written below is the father of the node written above. For the order 
</p>
<p>in which we list the edges, let us take the order of their first nodes. For the 
</p>
<p>tree in Figure 8.4, we get the table 
</p>
<p>1 234 5 6 789 
</p>
<p>6 002 6 2 992 
</p>
<p>Do you notice anything special about this table? The first row consists of 
</p>
<p>the numbers 1,2,3,4,5,6,7,8,9, in this order. Is this a coincidence? Well, 
</p>
<p>the order is certainly not (we ordered the edges by the increasing order of 
</p>
<p>their first endpoints). The root 0 does not occur, since it is not the son 
</p>
<p>of any other node. But why do we get every other number exactly once? 
</p>
<p>After a little reflection, this should also be clear: If a node occurs in the 
</p>
<p>first row, then its father occurs below it. Since a node has only one father, 
</p>
<p>it can occur only once. Since every node other than the root has a father, 
</p>
<p>every node other than the root occurs in the first row. 
</p>
<p>Thus we know in advance that if we have a tree on n nodes, and write up 
</p>
<p>the array using this method, then the first row will consist of 1, 2, 3, ... , n-
</p>
<p>1. So we may as well suppress the first row without losing any information; 
</p>
<p>it suffices to store the second row. So we can specify the tree by a sequence 
</p>
<p>of n - 1 numbers, each between 0 and n - 1. This takes (n - 1) ilog2 n l bits. 
This coding is not optimal, in the sense that not every "code" gives a 
</p>
<p>tree (see Exercise 8.4.1). But we'll see that this method is already nearly 
</p>
<p>optimal. 
</p>
<p>8.4.1 Consider the following "codes": (0,1,2,3,4,5,6,7); (7,6,5,4,3,2,1,0); 
</p>
<p>(0,0,0,0,0,0,0,0); (2,3,1,2,3,1,2,3). Which of these are "father codes" oftrees? 
</p>
<p>8.4.2 Prove, based on the "father code" method of storing trees, that the num-
</p>
<p>ber of labeled trees on n nodes is at most nn-l. </p>
<p/>
</div>
<div class="page"><p/>
<p>150 8. Trees 
</p>
<p>(d) Now we describe a procedure, called the Prufer code, that will assign 
</p>
<p>to any n-point labeled tree a sequence of length n - 2, not n -I, consisting 
of the numbers 0, ... ,n - 1. The gain is small, but important: we'll show 
that every such sequence corresponds to a tree. Thus we will establish a 
</p>
<p>bijection, a one-to-one correspondence, between labeled trees on n nodes 
</p>
<p>and sequences oflength n-2, consisting of numbers 0, 1, ... , n-1. Since the 
</p>
<p>number of such sequences is nn-2, this will also prove Cayley's Theorem. 
</p>
<p>The Priifer code can be considered as a refinement of method (c). We 
</p>
<p>still consider 0 as the root, we still order the two endpoints of an edge so 
</p>
<p>that the son comes first, but we order the edges (the columns of the array) 
</p>
<p>not by the magnitude of their first endpoint but a little differently, more 
</p>
<p>closely related to the tree itself. 
</p>
<p>So again, we construct a table with two rows, whose columns correspond 
</p>
<p>to the edges, and each edge is listed so that the node farther from 0 is on 
</p>
<p>the top, its father on the bottom. The issue is the order in which we list 
</p>
<p>the edges. 
</p>
<p>Here is the rule for this order: We look for a node of degree I, different 
</p>
<p>from 0, with the smallest label, and write down the edge with this endnode. 
</p>
<p>In our example, this means that we write down ~. Then we delete this node 
</p>
<p>and edge from the tree, and repeat: We look for the endnode with smallest 
</p>
<p>label, different from 0, and write down the edge incident with it. In our 
</p>
<p>case, this means adding a column ~ to the table. Then we delete this node 
</p>
<p>and edge, etc. We go until all edges are listed. The array we get is called 
</p>
<p>the extended Prufer code of the tree (we call it extended because, as we'll 
</p>
<p>see, we need only a part of it as the "real" Priifer code). The extended 
</p>
<p>Priifer code of the tree in Figure 8.4 is: 
</p>
<p>1 3 4 5 
</p>
<p>6 0 2 6 
67892 
29920 
</p>
<p>Why is this any better than the "father code"? One little observation 
</p>
<p>is that the last entry in the second row is now always 0, since it comes 
</p>
<p>from the last edge and since we never touched the node 0, this last edge 
</p>
<p>must be incident with it. But we have paid a lot for this, it seems: It is no 
</p>
<p>longer clear that the first row is superfluous; it still consists of the numbers 
</p>
<p>1,2, ... ,n - I, but now they are not in increasing order. 
The key lemma is that the first row is determined by the second: 
</p>
<p>Lemma 8.4.1 The second row of an extended Prufer code determines the 
</p>
<p>first. 
</p>
<p>Let us illustrate the proof of the lemma by an example. Suppose that 
</p>
<p>somebody gives us the second row of an extended Priifer code of a labeled 
</p>
<p>tree on 8 nodes; say, 2 4 0 3 3 1 0 (we have one edges fewer than nodes, so 
</p>
<p>the second row consists of 7 numbers, and as we have seen, it must end 
</p>
<p>with a 0). Let us figure out what the first row must have been. </p>
<p/>
</div>
<div class="page"><p/>
<p>8.4 How to Store Trees 151 
</p>
<p>FIGURE 8.5. A tree reconstructed from its Priifer code 
</p>
<p>How does the first row start? Remember that this is the node that we 
</p>
<p>delete in the first step; by the rule of constructing the Priifer code, this is 
</p>
<p>the node with degree 1 with smallest label. Could this node be node I? No, 
</p>
<p>because then we would have to delete it in the first step, and it could no 
</p>
<p>longer occur, but it does. By the same token, no number occurring in the 
</p>
<p>second row could be a leaf of the tree at the beginning. This rules out 2,3, 
</p>
<p>and 4. 
</p>
<p>What about 5? It does not occur in the second row; does this mean that 
</p>
<p>it is a leaf of the original tree? The answer is yes; otherwise, 5 would have 
</p>
<p>been the father of some other node, and it would have been written in 
</p>
<p>the second row when this other node was deleted. Thus 5 was a leaf with 
</p>
<p>smallest label, and the first row of the extended Priifer code must start 
</p>
<p>with 5. 
</p>
<p>Let's try to figure out the next entry in the first row, which is, as we 
</p>
<p>know, the leaf with smallest label of the tree after 5 was deleted. The node 
</p>
<p>1 is still ruled out, since it occurs later in the second row ; but 2 does not 
</p>
<p>occur again, which means (by the same argument as before) that 2 was the 
</p>
<p>leaf with smallest label after 5 was deleted. Thus the second entry in the 
</p>
<p>first row is 2. 
</p>
<p>Similarly, the third entry must be 4, since all the smaller numbers either 
</p>
<p>occur later or have been used already. Continuing in a similar fashion, we 
</p>
<p>get that the full array must have been 
</p>
<p>5 2 4 6 
</p>
<p>2 4 0 3 
</p>
<p>7 3 1 
</p>
<p>310 
</p>
<p>This corresponds to the tree in Figure 8.5 
</p>
<p>Proof. [of Lemma 8.4.1] The considerations above are completely general, 
</p>
<p>and can be summed up as follows: 
</p>
<p>Each entry in the first row of the extended Priifer code is the 
</p>
<p>smallest integer that does not occur in the first row before it, 
</p>
<p>nor in the second row below or after it. </p>
<p/>
</div>
<div class="page"><p/>
<p>152 8. Trees 
</p>
<p>Indeed, when this entry (say, the k-th entry in the first row) was recorded, 
</p>
<p>the nodes before it in the first row were deleted (together with the edges 
</p>
<p>corresponding to the first k - 1 columns). The remaining entries in the 
</p>
<p>second row are exactly those nodes that are fathers at this time, which 
</p>
<p>means that they are not leaves. 
</p>
<p>This describes how the first row can be reconstructed from the second. 
</p>
<p>o 
</p>
<p>So we don't need the full extended Priifer code to store the tree; it suffices 
</p>
<p>to store the second row. In fact, we know that the last entry in the second 
</p>
<p>row is 0, so we don't have to store this either. The sequence consisting of 
</p>
<p>the first n - 2 entries of the second row is called the Prufer code of the tree. 
</p>
<p>Thus the Priifer code is a sequence of length n - 2, each entry of which is 
</p>
<p>a number between 0 and n - 1. 
</p>
<p>This is similar to the father code, just one shorter; not much gain here 
</p>
<p>for all the work. But the beauty of the Priifer code is that it is optimal, in 
</p>
<p>the sense that 
</p>
<p>every sequence of numbers between 0 and n -1, of length n - 2, 
</p>
<p>is a Prufer code of some tree on n nodes. 
</p>
<p>This can be proved in two steps. First, we extend this sequence to a table 
</p>
<p>with two rows: We add a 0 at the end, and then write above each entry in 
</p>
<p>the first row the smallest integer that does not occur in the first row before 
</p>
<p>it, nor in the second row below or after it (note that it is always possible 
</p>
<p>to find such an integer: the condition excludes at most n - 1 values out of 
n). 
</p>
<p>Now this table with two rows is the Priifer code of a tree. The proof of 
</p>
<p>this fact, which is no longer difficult, is left to the reader as an exercise. 
</p>
<p>8.4.3 Complete the proof. 
</p>
<p>Let us sum up what the Priifer code gives. First, it proves Cayley's 
</p>
<p>theorem. Second, it provides a theoretically most efficient way of encoding 
</p>
<p>trees. Each Priifer code can be considered as a natural number written 
</p>
<p>in the base-n number system; in this way, we associate a "serial number" 
</p>
<p>between 0 and nn-2 - 1 with each n-point labeled tree. Expressing these 
</p>
<p>serial numbers in base two, we get a code using 0-1 sequences of length at 
</p>
<p>most i(n - 2) 10g2 n l-
As a third use of the Priifer code, let's suppose that we want to write a 
</p>
<p>program that generates a random labeled tree on n nodes in such a way 
</p>
<p>that all trees occur with the same probability. This is not easy from scratch; 
</p>
<p>but the Priifer code gives an efficient solution. We just have to generate 
</p>
<p>n - 2 independent random integers between 0 and n -1 (most programming 
languages have a statement for this) and then "decode" this sequence as a 
</p>
<p>tree, as described. </p>
<p/>
</div>
<div class="page"><p/>
<p>8.5 The Number of Unlabeled Trees 153 
</p>
<p>8.5 The Number of Unlabeled Trees 
</p>
<p>The number of unlabeled trees on n nodes, usually denoted by Tn, is even 
</p>
<p>more difficult to handle. No simple formula like Cayley's theorem is known 
</p>
<p>for this number. Our goal is to get a rough idea of how large this number 
</p>
<p>is. 
</p>
<p>There is only one unlabeled tree on 1,2, or 3 nodes; there are two on 
</p>
<p>4 nodes (the path and the star). There are 3 on 5 nodes (the star, the 
</p>
<p>path, and the tree in Figure 8.3. These numbers are much smaller than the 
</p>
<p>number of labeled trees with these numbers of nodes, which are 1,1,3,16, 
and 125 by Cayley's theorem. 
</p>
<p>It is of course clear that the number of unlabeled trees is less than the 
</p>
<p>number of labeled trees; every unlabeled tree can be labeled in many ways. 
</p>
<p>How many ways? If we draw an unlabeled tree, we can label its nodes in n! 
</p>
<p>ways. The labeled trees we get this way are not necessarily all different. For 
</p>
<p>example, if the tree is a star, then no matter how we permute the labels 
</p>
<p>of the leaves, we get the same labeled tree. So an unlabeled star yields n 
</p>
<p>labeled stars. 
</p>
<p>But at least we know that each labeled tree can be labeled in at most n! 
</p>
<p>ways. Since the number of labeled trees is nn-2, it follows that the number 
</p>
<p>of unlabeled trees is at least nn-2 In!. Using Stirling's formula (Theorem 
</p>
<p>2.2.1), we see that this number is about en In5/ 2V21f. 
This number is much smaller than the number of labeled trees, nn-2, 
</p>
<p>but of course it is only a lower bound on the number of unlabeled trees. 
</p>
<p>How can we obtain an upper bound on this number? If we think in terms of 
</p>
<p>storage, the issue is, can we store an unlabeled tree more economically than 
</p>
<p>labeling its nodes and then storing it as a labeled tree? Very informally, 
</p>
<p>how should we describe a tree if we want only the "shape" of it, and don't 
</p>
<p>care which node gets which label? 
</p>
<p>Take an n-point tree G, and specify one of its leaves as its "root." Next, 
</p>
<p>draw G in the plane without crossing edges; this can always be done, and 
</p>
<p>we almost always draw trees this way. 
</p>
<p>N ow we imagine that the edges of the tree are walls, perpendicular to 
</p>
<p>the plane. Starting at the root, walk around this system of walls, keeping 
</p>
<p>the wall always to your right. We'll call walking along an edge a step. Since 
</p>
<p>there are n - 1 edges, and each edge has two sides, we'll make 2(n - 1) 
</p>
<p>steps before returning to the root (Figure 8.6). 
</p>
<p>Each time we make a step away from the root (i.e., a step from a father 
</p>
<p>to one of its sons), we write down a 1; each time we make a step toward 
</p>
<p>the root, we write down a O. This way we end up with a sequence of 
</p>
<p>length 2(n - 1), consisting of O's and l's. We call this sequence the planar 
</p>
<p>code of the (unlabeled) tree. The planar code of the tree in Figure 8.6 is 
</p>
<p>1111100100011011010000. 
Now this name already indicates that the planar code has the following 
</p>
<p>important property: </p>
<p/>
</div>
<div class="page"><p/>
<p>154 8. Trees 
</p>
<p>, , 
</p>
<p>I ' , ' , t 
</p>
<p>, , 
</p>
<p>, 
1 , 
</p>
<p>, 
o---u X 
, , , ' 
</p>
<p>____ &gt;-f 
</p>
<p>0---0 f 
'&lt; - - - - " , 
</p>
<p>, 
, 
, 
I 
</p>
<p>FIGURE 8.6. Walking around a tree. 
</p>
<p>Every unlabeled tree is uniquely determined by its planar code. 
</p>
<p>Let us illuminate the proof of this by assuming that the tree is covered 
</p>
<p>by snow, and we have only its code. We ask a friend of ours to walk around 
</p>
<p>the tree just as above, and uncover the walls, and we look at the code in 
</p>
<p>the meanwhile. What do we see? Any time we see a 1, he walks along a 
</p>
<p>wall away from the root, and he cleans the snow from it. We see this as 
</p>
<p>growing a new twig. Any time we see a 0, he walks back, along an edge 
</p>
<p>already uncovered, toward the root. 
</p>
<p>Now, this describes a perfectly good way to draw the tree: We look at 
</p>
<p>the bits of the code one by one, while keeping the pen on the paper. Any 
</p>
<p>time we see aI, we draw a new edge to a new node (and move the pen to 
</p>
<p>the new node). Any time we see a 0, we move the pen back by one edge 
</p>
<p>toward the root. Thus the tree is indeed determined by its planar code. 
Since the number of possible planar codes is at most 22(n-l) = 4n - 1 , we 
</p>
<p>get that the number of unlabeled trees is at most this large. Summing up: 
</p>
<p>Theorem 8.5.1 The number Tn of unlabeled trees with n nodes satisfies 
</p>
<p>The exact form of this lower bound does not matter much; we can con-
</p>
<p>clude, just to have a statement simpler to remember, that the number of 
</p>
<p>unlabeled trees on n nodes is larger than 2n if n is large enough (n &gt; 30 
if you work it out). So we get, at least for n &gt; 30, the following bounds, 
which are easy to remember: 
</p>
<p>The planar code is far from optimal; every unlabeled tree has many 
</p>
<p>different codes (depending on how we draw it in the plane and how we 
</p>
<p>choose the root), and not every 0-1 sequence of length 2 (n - 1) is a code of 
</p>
<p>a tree (for example, it must start with a 1 and have the same number of O's </p>
<p/>
</div>
<div class="page"><p/>
<p>8.5 The Number of Unlabeled Trees 155 
</p>
<p>as l's). Still, the planar code is quite an efficient way of encoding unlabeled 
</p>
<p>trees: It uses less than 2n bits for trees with n nodes. Since there are more 
</p>
<p>than 2n unlabeled trees (at least for n &gt; 30), we could not possibly get by 
with codes of length n: there are just not enough of them. 
</p>
<p>In contrast to what we know for labeled trees, we don't know a simple 
</p>
<p>formula for the number of unlabeled trees on n nodes, and probably none 
</p>
<p>exists. According to a difficult result of George P61ya, the number of un-
</p>
<p>labeled trees on n nodes is asymptotically an-5/ 2bn , where a = 0.5349 ... 
and b = 2.9557 ... are real numbers defined in a complicated way. 
</p>
<p>8.5.1 Does there exist an unlabeled tree with planar code 
</p>
<p>(a) 1111111100000000; (b) 1010101010101010; (c) 1100011100? 
</p>
<p>Review Exercises 
</p>
<p>8.5.2 Let G be a connected graph, and e an edge of G. Prove that e is not a 
</p>
<p>cut-edge if and only if it is contained in a cycle of G. 
</p>
<p>8.5.3 Prove that a graph with n nodes and m edges has at least n-m connected 
</p>
<p>components. 
</p>
<p>8.5.4 Prove that if a tree has a node of degree d, then it has at least d leaves. 
</p>
<p>8.5.5 Find the number of unlabeled trees on 6 nodes. 
</p>
<p>8.5.6 A double star is a tree that has exactly two nodes that are not leaves. 
</p>
<p>How many unlabeled double stars are there on n nodes? 
</p>
<p>8.5.7 Construct a tree from a path of length n-3 by creating two new nodes and 
</p>
<p>connecting them to the same endpoint of the path. How many different labeled 
</p>
<p>trees do you get from this tree? 
</p>
<p>8.5.8 Consider any table with 2 rows and n - 1 columns; the first row holds 
</p>
<p>1,2,3, . " ,n - 1; the second row holds arbitrary numbers between 1 and n. Con-
struct a graph on nodes labeled 1, ... , n by connecting the two nodes in each 
</p>
<p>column of our table. 
</p>
<p>(a) Show by an example that this graph is not always a tree. 
</p>
<p>(b) Prove that if the graph is connected, then it is a tree. 
</p>
<p>(c) Prove that every connected component of this graph contains at most one 
</p>
<p>cycle. 
</p>
<p>8.5.9 Prove that in every tree, any two paths with maximum length have a node 
</p>
<p>in common. This is not true if we consider two maximal (i.e., nonextendable) 
</p>
<p>paths. </p>
<p/>
</div>
<div class="page"><p/>
<p>156 8. Trees 
</p>
<p>8.5.10 If C is a cycle, and e is an edge connecting two nonadjacent nodes of C, 
</p>
<p>then we call e a chord of C. Prove that if every node of a graph G has degree at 
</p>
<p>least 3, then G contains a cycle with a chord. 
</p>
<p>[Hint: Follow the proof of the theorem that a tree has a node of degree 1.J 
</p>
<p>8.5.11 Take an n-cycle, and connect two if its nodes at distance 2 by an edge. 
</p>
<p>Find the number of spanning trees in this graph. 
</p>
<p>8.5.12 A (k, I)-dumbbell graph is obtained by taking a complete graph on k 
</p>
<p>(labeled) nodes and a complete graph on I (labeled) nodes, and connecting them 
</p>
<p>by a single edge. Find the number of spanning trees of a dumbbell graph. 
</p>
<p>8.5.13 Prove that if n 2': 2, then in Theorem 8.5.1 both inequalities are strict. </p>
<p/>
</div>
<div class="page"><p/>
<p>9 
</p>
<p>Finding the Optimum 
</p>
<p>9.1 Finding the Best Tree 
</p>
<p>A country with n towns wants to construct a new telephone network to 
</p>
<p>connect all towns. Of course, they don't have to build a separate line be-
</p>
<p>tween every pair of towns; but they do need to build a connected network; 
</p>
<p>in our terms, this means that the graph of direct connections must form a 
</p>
<p>connected graph. Let's assume that they don't want to build a direct line 
</p>
<p>between towns that can be reached otherwise (there may be good reasons 
</p>
<p>for doing so, as we shall see later, but at the moment let's assume their only 
</p>
<p>goal is to get a connected network). Thus they want to build a minimal 
</p>
<p>connected graph with these nodes, i.e., a tree. 
</p>
<p>We know that no matter which tree they choose to build, they have to 
</p>
<p>construct n - 1 lines. Does this mean that it does not matter which tree 
</p>
<p>they build? No, because lines are not equally easy to build. Some lines 
</p>
<p>between towns may cost much more than some other lines, depending on 
</p>
<p>how far the towns are, whether there are mountains or lakes between them, 
</p>
<p>etc. So the task is to find a spanning tree whose total cost (the sum of costs 
</p>
<p>of its edges) is minimal. 
</p>
<p>How do we know what these costs are? Well, this is not something mathe-
</p>
<p>matics can tell you; it is the job of the engineers and economists to estimate 
</p>
<p>the cost of each possible line in advance. So we just assume that these costs 
</p>
<p>are given. 
</p>
<p>At this point, the task seems trivial (very easy) again: Just compute the 
</p>
<p>cost of each tree on these nodes, and select the tree with smallest cost. </p>
<p/>
</div>
<div class="page"><p/>
<p>158 9. Finding the Optimum 
</p>
<p>We dispute the claim that this is easy. The number of trees to consider is 
</p>
<p>enormous: We know by Cayley's Theorem (Theorem 8.3.1) that the number 
</p>
<p>of labeled trees on n nodes is nn-2. So for 10 cities, we'd have to look 
</p>
<p>at 108 (one hundred million) possible trees; for 20 cities, the number is 
astronomical (more than 1020). We have to find a better way to select an 
</p>
<p>optimal tree; and that's the point where mathematics comes to the rescue. 
</p>
<p>There is this story about the pessimist and the optimist: They each get a 
</p>
<p>box of assorted candies. The optimist always picks the best; the pessimist 
</p>
<p>always eats the worst (to save the better candies for later). So the optimist 
</p>
<p>always eats the best available candy, and the pessimist always eats the 
</p>
<p>worst available candy; and yet, they end up with eating same candies. 
</p>
<p>So let's see how the optimistic government would build the telephone 
</p>
<p>network. They start with raising money; as soon as they have enough money 
</p>
<p>to build a line (the cheapest line), they build it. Then they wait until they 
</p>
<p>have enough money to build a second connection. Then they wait until 
</p>
<p>they have enough money to build a third connection... It may happen 
</p>
<p>that the third-cheapest connection forms a triangle with the first two (say, 
</p>
<p>three towns are close to each other). Then, of course, they skip this and 
</p>
<p>raise enough money to build the fourth-cheapest connection. 
</p>
<p>At any time, the optimistic government will wait until they have enough 
</p>
<p>money to build a connection between two towns that are not yet connected 
</p>
<p>by any path, and build this connection. 
</p>
<p>Finally, they will get a connected graph on the n nodes representing 
</p>
<p>the towns. The graph does not contain a cycle, since the edge of the cycle 
</p>
<p>constructed last would connect two towns that are already accessible from 
</p>
<p>each other through the other edges of the cycle. So, the graph they get is 
</p>
<p>indeed a tree. 
</p>
<p>But is this network the least expensive possible? Could the cheap attitude 
</p>
<p>at the beginning backfire and force the government to spend much more at 
</p>
<p>the end? We'll prove below that our optimistic government has undeserved 
</p>
<p>success: The tree they build is as inexpensive as possible. 
</p>
<p>Before we jump into the proof, we should discuss why we said that the 
</p>
<p>government's success was "undeserved." We show that if we modify the 
</p>
<p>task a little, the same optimistic approach might lead to very bad results. 
</p>
<p>Let us assume that for reasons of reliability, they require that between 
</p>
<p>any two towns there should be at least two paths with no edge in common 
</p>
<p>(this guarantees that when a line is inoperational because of failure or 
</p>
<p>maintenance, any two towns can still be connected). For this, n - 1 lines 
</p>
<p>are not enough (n - 1 edges forming a connected graph must form a tree, 
</p>
<p>but then if any edge is deleted, the rest will not be connected any more). 
</p>
<p>But n lines suffice: All we have to do is to draw a single cycle through all 
</p>
<p>the towns. This leads to the following task: 
</p>
<p>Find a cycle with n given towns as nodes such that the total 
</p>
<p>cost of constructing its edges is minimum. </p>
<p/>
</div>
<div class="page"><p/>
<p>9.1 Finding the Best Tree 159 
</p>
<p>(This problem is one of the most famous tasks in mathematical optimiza-
</p>
<p>tion: it is called the Traveling Salesman Problem. We'll say more about it 
</p>
<p>later. ) 
</p>
<p>Our optimistic government would do the following: Build the cheapest 
</p>
<p>line, then the second cheapest, then the third cheapest, etc., skipping the 
</p>
<p>construction of lines that are superfluous: It will not build a third edge 
</p>
<p>out of a town that already has two, and will not build an edge completing 
</p>
<p>a cycle unless this cycle connects all nodes. Eventually, they get a cycle 
</p>
<p>through all towns, but this is not necessarily the best! Figure 9.1 shows 
</p>
<p>an example where the optimistic method (called "greedy" in this area of 
</p>
<p>applied mathematics) gives a cycle that is quite a bit worse than optimal. 
</p>
<p>FIGURE 9.1. Failure of the greedy method. Construction costs are proportional 
</p>
<p>to the distance. The first figure shows a cheapest (shortest) cycle through all 4 
</p>
<p>towns; the second shows the cycle obtained by the optimistic (greedy) method. 
</p>
<p>So the greedy method can be bad for the solution of a problem that is 
</p>
<p>only slightly different from the problem of finding the cheapest tree. Thus 
</p>
<p>the fact (to be proved below) that the optimistic government builds the 
</p>
<p>best tree is indeed undeserved luck. 
</p>
<p>So let us return to the solution of the problem of finding a tree with 
</p>
<p>minimum cost, and prove that the optimistic method yields a cheapest 
</p>
<p>tree. The optimistic method is often called the greedy Algorithm; in the 
</p>
<p>context of spanning trees, it is called Kruskal's Algorithm. Let us call the 
</p>
<p>tree obtained by the greedy method the greedy tree, and denote it by F. 
</p>
<p>In other words, we want to prove that any other tree would cost at least 
</p>
<p>as much as the greedy tree (and so no one could accuse the government of 
</p>
<p>wasting money and justify the accusation by exhibiting another tree that 
</p>
<p>would have been cheaper). 
</p>
<p>So let G be any tree different from the greedy tree F. Let us imagine the 
</p>
<p>process of constructing F, and the step when we first pick an edge that is 
</p>
<p>not an edge of G. Let e be this edge. If we add e to G, we get a cycle C. 
</p>
<p>This cycle is not fully contained in F, so it has an edge j that is not an 
</p>
<p>edge of F (Figure 9.2). If we add the edge e to G and then delete j, we get 
</p>
<p>a (third) tree H. (Why is H a tree? Give an argument!) 
</p>
<p>We want to show that H is at most as expensive as G. This clearly means 
</p>
<p>that e is at most as expensive as j. Suppose (by indirect argument) that 
</p>
<p>j is cheaper than e. 
</p>
<p>Now comes a crucial question: Why didn't the optimistic government 
</p>
<p>select j instead of e at this point in time? The only reason could be that </p>
<p/>
</div>
<div class="page"><p/>
<p>160 9. Finding the Optimum 
</p>
<p>7 5 
</p>
<p>9 
</p>
<p>FIGURE 9.2. The greedy tree is optimal 
</p>
<p>f was ruled out because it would have formed a cycle G' with the edges of 
F already selected. But all these previously selected edges are edges of G, 
</p>
<p>since we are inspecting the step when the first edge not in G was added to 
</p>
<p>F. Since f itself is an edge of G, it follows that all edges of G' are edges of 
G, which is impossible, since G is a tree. This contradiction proves that f 
cannot be cheaper than e and hence G cannot be cheaper than H. 
</p>
<p>So we replace G by this tree H that is not more expensive. In addition, 
</p>
<p>the new tree H has the advantage that it coincides with F in more edges, 
</p>
<p>since we deleted from G an edge not in F and added an edge in F. This 
</p>
<p>implies that if H is different from F and we repeat the same argument 
</p>
<p>again and again, we get trees that are not more expensive than G, and 
</p>
<p>coincide with F in more and more edges. Sooner of later we must end up 
</p>
<p>with F itself, proving that F was no more expensive than G. 
</p>
<p>9.1.1 A pessimistic government could follow the following logic: If we are not 
</p>
<p>careful, we may end up with having to build that extremely expensive connection 
</p>
<p>through the mountain; so let us decide right away that building this connection 
</p>
<p>is not an option, and mark it as "impossible." Similarly, let us find the second 
</p>
<p>most expensive line and mark it "impossible," etc. Well, we cannot go on like 
</p>
<p>this forever: We have to look at the graph formed by those edges that are still 
</p>
<p>possible, and this "possibility graph" must stay connected. In other words, if 
</p>
<p>deleting the most expensive edge that is still possible from the possibility graph 
</p>
<p>would destroy the connectivity of this graph, then like it or not, we have to build 
</p>
<p>this line. So we build this line (the pessimistic government ends up building the 
</p>
<p>most expensive line among those that are still possible). Then they go on to find 
</p>
<p>the most expensive line among those that are still possible and not yet built, 
</p>
<p>mark it impossible if this does not disconnect the possibility graph, etc. 
</p>
<p>Prove that the pessimistic government will have the same total cost as the 
</p>
<p>optimistic. 
</p>
<p>9.1.2 Formulate how the pessimistic government will construct a cycle through 
</p>
<p>all towns. Show by an example that they don't always get the cheapest solution. </p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 The 1raveling Salesman Problem 161 
</p>
<p>9.2 The Traveling Salesman Problem 
</p>
<p>Let us return to the question of finding a cheapest possible cycle through 
</p>
<p>all the given towns: We have n towns (points) in the plane, and for any 
</p>
<p>two of them we are given the "cost" of connecting them directly. We have 
</p>
<p>to find a cycle with these nodes such that the cost of the cycle (the sum of 
</p>
<p>the costs of its edges) is as small as possible. 
</p>
<p>This problem is one of the most important in the area of combinato-
</p>
<p>rial optimization, the field dealing with finding the best possible design in 
</p>
<p>various combinatorial situations, like finding the optimal tree discussed in 
</p>
<p>the previous section. It is called the Traveling Salesman Problem, and it 
</p>
<p>appears in many disguises. Its name comes from the version of the prob-
</p>
<p>lem where a traveling salesman has to visit all towns in a region and then 
</p>
<p>return to his home, and of course, he wants to minimize his travel costs. It 
</p>
<p>is clear that mathematically, this is the same problem. It is easy to imag-
</p>
<p>ine that one and the same mathematical problem appears in connection 
</p>
<p>with designing optimal delivery routes for mail, optimal routes for garbage 
</p>
<p>collection, etc. 
</p>
<p>The following important question leads to the same mathematical prob-
</p>
<p>lem, except on an entirely different scale. A machine has to drill a number 
</p>
<p>of holes in a printed circuit board (this number could be in the thousands), 
</p>
<p>and then return to the starting point. In this case, the important quantity 
</p>
<p>is the time it takes to move the drilling head from one hole to the next, since 
</p>
<p>the total time a given board has to spend on the machine determines the 
</p>
<p>number of boards that can be processed in a day. So if we take the time 
</p>
<p>needed to move the head from one hole to another as the "cost" of this 
</p>
<p>edge, we need to find a cycle with the holes as nodes, and with minimum 
</p>
<p>cost. 
</p>
<p>The Traveling Salesman Problem is closely related to Hamiltonian cycles. 
</p>
<p>First of all, a traveling salesman tour is just a Hamiltonian cycle in the 
</p>
<p>complete graph on the given set of nodes. But there is a more interesting 
</p>
<p>connection: The problem of whether a given graph has a Hamiltonian cycle 
</p>
<p>can be reduced to the Traveling Salesman Problem. 
</p>
<p>Let G be a graph with n nodes. We define the "distance" of two nodes as 
</p>
<p>follows: adjacent nodes have distance 1; nonadjacent nodes have distance 
</p>
<p>2. 
</p>
<p>What do we know about the Traveling Salesman Problem on the set 
</p>
<p>of nodes of G with this new distance function? If the graph contains a 
</p>
<p>Hamiltonian cycle, then this is a traveling salesman tour of length n. If the 
</p>
<p>graph has no Hamiltonian cycle, then the shortest traveling salesman tour 
</p>
<p>has length at least n + 1. This shows that any algorithm that solves the 
Traveling Salesman Problem can be used to decide whether or not a given 
</p>
<p>graph has a Hamiltonian cycle. 
</p>
<p>The Traveling Salesman Problem is much more difficult than the problem 
</p>
<p>of finding the cheapest tree, and there is no algorithm to solve it that would </p>
<p/>
</div>
<div class="page"><p/>
<p>162 9. Finding the Optimum 
</p>
<p>be anywhere nearly as simple, elegant and efficient as the "optimistic" 
</p>
<p>algorithm discussed in the previous section. There are methods that work 
</p>
<p>quite well most of the time, but they are beyond the scope of this book. 
</p>
<p>But we want to show at least one simple algorithm that, even though 
</p>
<p>it does not give the best solution, never loses more than a factor of 2. We 
</p>
<p>describe this algorithm in the case where the cost of an edge is just its 
</p>
<p>length, but it would not make any difference to consider any other measure 
</p>
<p>(like time, or the price of a ticket), as long as the costs c( ij) satisfy the 
</p>
<p>triangle inequality: 
</p>
<p>c(ij) + c(jk) 2 c(ik). (9.1) 
(Distances in Euclidean geometry satisfy this condition by classical re-
</p>
<p>sults in geometry: The shortest route between two points is a straight line. 
</p>
<p>Airfares sometimes don't satisfy this inequality: It may be cheaper to fly 
</p>
<p>from New York to Chicago to Philadelphia then to fly from New York to 
</p>
<p>Philadelphia. But in this case, of course, we might consider the flight New 
</p>
<p>York~Chicago~Philadelphia as one "edge," which does not count as a visit 
</p>
<p>in Chicago. The distance function on a graph we introduced above when 
</p>
<p>we discussed the connection between the Traveling Salesman Problem and 
</p>
<p>Hamiltonian cycles satisfies the triangle inequality.) 
</p>
<p>We begin by solving a problem we know how to solve: Find a cheapest 
</p>
<p>tree connecting up the given nodes. We can use any of the algorithms 
</p>
<p>discussed in the previous section for this. So we find the cheapest tree T, 
</p>
<p>with total cost c. 
</p>
<p>Now, how does this tree help in finding a tour? One thing we can do is to 
</p>
<p>walk around the tree just as we did when constructing the "planar code" of 
</p>
<p>a tree in the proof of Theorem 8.5.1 (see Figure 8.6). This certainly gives a 
</p>
<p>walk that goes through each town at least once, and returns to the starting 
</p>
<p>point. 
</p>
<p>Of course, this walk may pass through some of the towns more than once. 
</p>
<p>But this is good for us: We can make shortcuts. If the walk takes us from i 
</p>
<p>to j to k, and we have seen j already, we can proceed directly from i to k. 
</p>
<p>Doing such shortcuts as long as we can, we end up with a tour that goes 
</p>
<p>through every town exactly once (Figure 9.3). Let us call the algorithm 
</p>
<p>described above the Tree Shortcut Algorithm. 
</p>
<p>Theorem 9.2.1 If the costs in a Traveling Salesman Problem satisfy the 
</p>
<p>triangle inequality (9.1), then the Tree Shortcut Algorithm finds a tour that 
costs less than twice as much as the optimum tour. 
</p>
<p>Proof. The cost of the walk around the tree is exactly twice the cost c of 
</p>
<p>T, since we used every edge twice. The triangle inequality guarantees that 
</p>
<p>we have only shortened our walk by doing shortcuts, so the cost of the tour 
</p>
<p>we found is not more than twice the cost of the cheapest spanning tree. 
</p>
<p>But we want to relate the cost of the tour we obtained to the cost of the 
</p>
<p>optimum tour, not to the cost of the optimum spanning tree! Well, this is </p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 The Traveling Salesman Problem 163 
</p>
<p>FIGURE 9.3. The cheapest tree connecting 15 given towns, the walk around it, 
</p>
<p>and the tour produced by shortcuts (light edges on the right hand side are edges 
</p>
<p>of the tree that are not used in the tour). Costs are proportional to distances. 
</p>
<p>easy now: The cost of a cheapest spanning tree is always less than the cost 
</p>
<p>of the cheapest tour. Why? Because we can omit any edge of the cheapest 
</p>
<p>tour to get a spanning tree. This is a very special kind of tree (a path), 
</p>
<p>and as a spanning tree it mayor may not be optimal. However, its cost is 
</p>
<p>certainly not smaller than the cost of the cheapest tree, but smaller than 
</p>
<p>the cost of the optimal tour, which proves the assertion above. 
</p>
<p>To sum up, the cost of the tour we constructed is at most twice that of 
</p>
<p>the cheapest spanning tree, which in turn is less than twice the cost of a 
</p>
<p>cheapest tour. 0 
</p>
<p>9.2.1 Is the tour in Figure 9.3 shortest possible? 
</p>
<p>9.2.2 Prove that if all costs are proportional to distances, then a shortest tour 
</p>
<p>cannot intersect itself. 
</p>
<p>Review Exercises 
</p>
<p>9.2.3 Prove that if all edge-costs are different, then there is only one cheapest 
</p>
<p>tree. 
</p>
<p>9.2.4 Describe how you can find a spanning tree for which (a) the product of 
</p>
<p>the edge-costs is minimal; (b) the maximum of the edge-costs is minimal. </p>
<p/>
</div>
<div class="page"><p/>
<p>164 9. Finding the Optimum 
</p>
<p>9.2.5 In a real-life government, optimists and pessimists win in unpredictable 
</p>
<p>order. This means that sometimes they build the cheapest line that does not 
</p>
<p>create a cycle with those lines already constructed; sometimes they mark the 
</p>
<p>most expensive lines "impossible" until they get to a line that cannot be marked 
</p>
<p>impossible without disconnecting the network, and then they build it. Prove that 
</p>
<p>they still end up with the same cost. 
</p>
<p>9.2.6 If the seat of the government is town r, then quite likely the first line 
</p>
<p>constructed will be the cheapest line out of r (to some town s, say), then the 
</p>
<p>cheapest line that connects either r or s to a new town, etc. In general, there will 
</p>
<p>be a connected graph of telephone lines constructed on a subset S of the towns 
</p>
<p>including the capital, and the next line will be the cheapest among all lines that 
</p>
<p>connect S to a node outside S. Prove that the lucky government still obtains a 
</p>
<p>cheapest possible tree. 
</p>
<p>9.2.7 Find the shortest tour through the points of a (a) 3 x 3 square grid; (b) 
</p>
<p>4 x 4 square grid; (c) 5 X 5 square grid; (d) generalize to n x m grids. 
</p>
<p>9.2.8 Show by an example that if we don't assume the triangle inequality, then 
</p>
<p>the tour found by the Tree Shortcut Algorithm can be longer than 1000 times 
</p>
<p>the optimum tour. </p>
<p/>
</div>
<div class="page"><p/>
<p>10 
</p>
<p>Matchings In Graphs 
</p>
<p>10.1 A Dancing Problem 
</p>
<p>At the prom, 300 students took part. They did not all know each other; in 
</p>
<p>fact, every girl knew exactly 50 boys and every boy knew exactly 50 girls 
</p>
<p>(we assume, as before, that acquaintance is mutual). 
</p>
<p>We claim that the students can all dance simultaneously so that 
</p>
<p>only pairs who know each other dance with each other. 
</p>
<p>Since we are talking about acquaintances, it is natural to describe the 
</p>
<p>situation by a graph (or at least, imagine the graph that describes it). So 
</p>
<p>we draw 300 nodes, each representing a student, and connect two of them if 
</p>
<p>they know each other. Actually, we can make the graph a little simpler: the 
</p>
<p>fact that two boys, or two girls, know each other plays no role whatsoever 
</p>
<p>in this problem: so we don't have to draw those edges that correspond to 
</p>
<p>such acquaintances. We can then arrange the nodes, conveniently, so that 
</p>
<p>the nodes representing boys are on the left, and nodes representing girls 
</p>
<p>are on the right; then every edge will connect a node on the left to a node 
</p>
<p>on the right. We shall denote the set of nodes on the left by A, the set of 
</p>
<p>nodes on the right by B. 
</p>
<p>This way we obtain a special kind of graph, called a bipartite graph. 
</p>
<p>Figure 10.1 shows such a graph (of course, depicting a smaller party). The 
</p>
<p>thick edges show one way to pair up people for dancing. Such a set of edges 
</p>
<p>is called a perfect matching. </p>
<p/>
</div>
<div class="page"><p/>
<p>166 10. Matchings in Graphs 
</p>
<p>FIGURE 10.1. A bipartite graph with a perfect matching. 
</p>
<p>To be precise, let's give the definitions of these terms: A graph is bipartite 
</p>
<p>if its nodes can be partitioned into two classes, say A and B, such that every 
</p>
<p>edge connects a node in A to a node in B. A perfect matching is a set of 
</p>
<p>edges such that every node is incident with exactly one of these edges. 
</p>
<p>After this, we can formulate our problem in the language of graph theory 
</p>
<p>as follows: We have a bipartite graph with 300 nodes, in which every node 
</p>
<p>has degree 50. We want to prove that it contains a perfect matching. 
</p>
<p>As before, it is good idea to generalize the assertion to any number of 
</p>
<p>nodes. Let's be daring and guess that the numbers 300 and 50 play no 
</p>
<p>role whatsoever. The only condition that matters is that all nodes have the 
</p>
<p>same degree (and this is not 0). Thus we set out to prove the following 
</p>
<p>theorem, named after the Hungarian mathematician D. Konig (who wrote 
</p>
<p>the first book on graph theory). 
</p>
<p>Theorem 10.1.1 If every node of a bipartite graph has the same degree 
</p>
<p>d ~ 1, then it contains a perfect matching. 
</p>
<p>Before proving the theorem, it will be useful to solve some exercises, and 
</p>
<p>then discuss another problem in the next section. 
</p>
<p>10.1.1 It is obvious that for a bipartite graph to contain a perfect matching, it 
</p>
<p>is necessary that IAI = IBI. Show that if every node has the same degree, then 
this is indeed so. 
</p>
<p>10.1.2 Show by examples that the conditions formulated in the theorem cannot 
</p>
<p>be dropped: 
</p>
<p>(a) A nonbipartite graph in which every node has the same degree need not 
</p>
<p>contain a perfect matching. 
</p>
<p>(b) A bipartite graph in which every node has positive degree (but not all the 
</p>
<p>same) need not contain a perfect matching. 
</p>
<p>10.1.3 Prove Theorem 10.1.1 for d = 1 and d = 2. </p>
<p/>
</div>
<div class="page"><p/>
<p>A, S... areas of tribes 
</p>
<p>1, Z.. areas of tortoises 
</p>
<p>10.2 Another matching problem 167 
</p>
<p>border between tribes 
</p>
<p>border between tortoises 
</p>
<p>FIGURE 10.2. Six tribes and six tortoises on an island 
</p>
<p>10.2 Another matching problem 
</p>
<p>An island is inhabited by six tribes. They are on good terms and split up 
</p>
<p>the island between them, so that each tribe has a hunting territory of 100 
</p>
<p>square miles. The whole island has an area of 600 square miles. 
</p>
<p>The tribes decide that they all should choose new totems. They decide 
</p>
<p>that each tribe should pick one of the six species of tortoise that live on 
</p>
<p>the island. Of course, they want to pick different totems, and in such a way 
</p>
<p>that the totem of each tribe should occur somewhere on their territory. 
</p>
<p>It is given that the territories where the different species of tortoises 
</p>
<p>live don't overlap, and they have the same area, 100 square miles (so it 
</p>
<p>also follows that every part of the island is inhabited by some kind of 
</p>
<p>tortoise). Of course, the way the tortoises divide up the island may be 
</p>
<p>entirely different from the way the tribes do (Figure 10.2) 
</p>
<p>We want to prove that such a selection of totems is always possible. 
</p>
<p>To see the significance of the conditions, let's assume that we did not 
</p>
<p>stipulate that the area of each tortoise species is the same. Then some 
</p>
<p>species could occupy more, say, 200 square miles. But then it could happen 
</p>
<p>that two of tribes are living on exactly these 200 square miles, and so their 
</p>
<p>only possible choice for a totem would be one and the same species. 
</p>
<p>Let's try to illustrate our problem by a graph. We can represent each tribe 
</p>
<p>by a node, and also each species of tortoise by a node. Let us connect a tribe-
</p>
<p>node to a tortoise-node if the species occurs somewhere on the territory of 
</p>
<p>the tribe (we could also say that the tribe occurs on the territory of the </p>
<p/>
</div>
<div class="page"><p/>
<p>168 10. Matchings in Graphs 
</p>
<p>species, just in case the tortoises want to pick totems too). Drawing the 
</p>
<p>tribe-nodes on the left and the tortoise-nodes on the right makes it clear 
</p>
<p>that we get a bipartite graph (Figure 10.3). And what is it that we want 
</p>
<p>to prove? It is that this graph has a perfect matching! 
</p>
<p>A 1 
</p>
<p>B 2 
</p>
<p>c 3 
</p>
<p>D 4 
</p>
<p>E 5 
</p>
<p>F 6 
</p>
<p>FIGURE 10.3. The graph of tribes and tortoises 
</p>
<p>So this is very similar to the problem discussed (but not solved!) in the 
</p>
<p>previous section: We want to prove that a certain bipartite graph has a 
</p>
<p>perfect matching. Theorem 10.1.1 says that for this conclusion it suffices 
</p>
<p>to know that every node has the same degree. But this is too strong a 
</p>
<p>condition; it is not at all fulfilled in our example (tribe B has only two 
</p>
<p>tortoises to choose from, while tribe D has four). 
</p>
<p>So what property of this graph should guarantee that a perfect match-
</p>
<p>ing exists? Turning this question around: What would exclude a perfect 
</p>
<p>matching? 
</p>
<p>For example, it would be bad if a tribe could not find any tortoises on its 
</p>
<p>own territory. In the graph, this would correspond to a node with degree 
</p>
<p>O. Now this is not a danger, since we know that tortoises occur everywhere 
</p>
<p>on the island. 
</p>
<p>It would also be bad (and this has come up already) if two tribes could 
</p>
<p>only choose one and the same tortoise. But then this tortoise would have 
</p>
<p>an area of at least 200 square miles, which is not the case. A somewhat 
</p>
<p>more subtle sort of trouble would arise if three tribes had only two tortoises 
</p>
<p>on their combined territory. But this, too, is impossible: The two species of 
</p>
<p>tortoises would cover an area of at least 300 square miles, so one of them 
</p>
<p>would have to cover more than 100. More generally, we can see that the 
</p>
<p>combined territory of any k tribes holds at least k species of tortoises. In 
</p>
<p>terms of the graph, this means that for any k nodes on the left, there are </p>
<p/>
</div>
<div class="page"><p/>
<p>10.3 The Main Theorem 169 
</p>
<p>at least k nodes on the right connected to at least one of them. We'll see 
</p>
<p>in the next section that this is all we need to observe about this graph. 
</p>
<p>10.3 The Main Theorem 
</p>
<p>Now we state and prove a fundamental theorem about perfect matchings. 
</p>
<p>This will complete the solution of the problem about tribes and tortoises, 
</p>
<p>and (with some additional work) of the problem about dancing at the 
</p>
<p>prom (and some problems further down the road from the prom, as its 
</p>
<p>name shows). 
</p>
<p>Theorem 10.3.1 (The Marriage Theorem) A bipartite graph has a 
</p>
<p>perfect matching if and only if IAI = IBI and for any subset of (say) k 
nodes of A there are at least k nodes of B that are connected to at least 
</p>
<p>one of them. 
</p>
<p>This important theorem has many variations; some of these occur in the 
</p>
<p>exercises. These were discovered by the German mathematician G. Frobe-
</p>
<p>nius, by the Hungarian D. Konig, the American P. Hall, and others. 
</p>
<p>Before proving this theorem, let us discuss one more question. If we 
</p>
<p>interchange "left" and "right," perfect matchings remain perfect matchings. 
</p>
<p>But what happens to the condition stated in the theorem? It is easy to see 
</p>
<p>that it remains valid (as it should). To see this, we have to argue that if we 
</p>
<p>pick any set S of k nodes in B, then they are connected to at least k nodes 
</p>
<p>in A. Let n = IAI = IBI and let us color the nodes in A connected to nodes 
in S black, the other nodes white (Figure 10.4). Then the white nodes are 
</p>
<p>connected to at most n - k nodes (since they are not connected to any node 
</p>
<p>in S). Since the condition holds "from left to right," the number of white 
nodes is at most n - k. But then the number of black nodes is at least k, 
</p>
<p>which proves that the condition also holds "from right to left." 
</p>
<p>Proof. Now we can turn to the proof of Theorem 10.3.1. We shall have to 
</p>
<p>refer to the condition given in the theorem so often that it will be convenient 
</p>
<p>to call graphs satisfying this conditions "good" (just for the duration of this 
</p>
<p>proof). Thus a bipartite graph is "good" if it has the same number of nodes 
</p>
<p>left and right, and any k "left" nodes are connected to at least k "right" 
</p>
<p>nodes. 
</p>
<p>It is obvious that every graph with a perfect matching is "good," so what 
</p>
<p>we need to prove is the converse: Every "good" graph contains a perfect 
</p>
<p>matching. For a graph on just two nodes, being "good" means that these 
</p>
<p>two nodes are connected. Thus for a graph to have a perfect matching 
</p>
<p>means that it can be partitioned into "good" graphs with 2 nodes. (To 
</p>
<p>partition a graph means that we divide the nodes into classes, and keep an 
</p>
<p>edge between two nodes only if they are in the same class.) </p>
<p/>
</div>
<div class="page"><p/>
<p>170 10. Matchings in Graphs 
</p>
<p>n-k 
</p>
<p>k 
</p>
<p>FIGURE 10.4. The good graph is also good from right to left. 
</p>
<p>Now our plan is to partition our graph into two "good" parts, then 
</p>
<p>partition each of these into two "good" parts, etc., until we get "good" 
</p>
<p>parts with 2 nodes. Then the edges that remain form a perfect matching. 
</p>
<p>To carry out this plan, it suffices to prove that 
</p>
<p>if a "good" bipartite graph has more than 2 nodes, then it can 
</p>
<p>be partitioned into two good bipartite graphs. 
</p>
<p>Let us try a very simple partition first: Select nodes a E A and b E B 
</p>
<p>that are connected by an edge; let these two nodes be the first part, and 
</p>
<p>the remaining nodes the other. There is no problem with the first part: it 
</p>
<p>is "good." But the second part may not be good: It can have some set 8 of 
</p>
<p>k nodes on the left connected to fewer than k nodes on the right (Figure 
</p>
<p>10.5). In the original graph, these k nodes were connected to at least k 
</p>
<p>nodes in B; this can hold only if the kth such node was the node b. Let T 
</p>
<p>denote the set of neighbors of 8 in the original graph. What is important 
</p>
<p>to remember is that 181 = ITI. 
Now we try another way of partitioning the graph: We take 8 U T (to-
</p>
<p>gether with the edges between them) as one part, and the rest of the nodes 
</p>
<p>as the other. (This rest is not empty: The node a belongs to it, for example.) 
</p>
<p>Let's argue that both these parts are "good." Take the first graph first. 
</p>
<p>Take any subset of, say, j nodes in 8 (the left-hand side of the first graph). 
</p>
<p>Since the original graph was good, they are connected to at least j nodes, 
</p>
<p>which are all in T by the definition of T. </p>
<p/>
</div>
<div class="page"><p/>
<p>10.4 How to Find a Perfect Matching 171 
</p>
<p>a b 
</p>
<p>k 
</p>
<p>FIGURE 10.5. Goodness lost when two nodes are removed 
</p>
<p>For the second graph, it follows similarly that it is good if we interchange 
</p>
<p>"left" and "right." This completes the proof. D 
</p>
<p>We still have to prove Theorem 10.1.1. This is now quite easy and is left 
</p>
<p>to the reader as Exercise 10.3.1. 
</p>
<p>10.3.1 Prove that if in a bipartite graph every node has the same degree d of. 0, 
then the bipartite graph is "good" (and hence contains a perfect matching; this 
</p>
<p>proves Theorem 10.1.1). 
</p>
<p>10.3.2 Suppose that in a bipartite graph, for any subset X of nodes of A there 
</p>
<p>are at least IXI nodes in B that are connected to one of them (but in contrast 
to Theorem 10.3.1, we don't assume that IAI = IBI). Prove that there is a set 
of edges that match every node of A with a node of B, where different nodes 
</p>
<p>of A are matched with different nodes of B (but some nodes of B may remain 
</p>
<p>unmatched) . 
</p>
<p>10.4 How to Find a Perfect Matching 
</p>
<p>We have a condition for the existence of a perfect matching in a graph that 
</p>
<p>is necessary and sufficient. Does this condition settle this issue once and for 
</p>
<p>all? To be more precise: Suppose that somebody gives us a bipartite graph; 
</p>
<p>what is a good way to decide whether it contains a perfect matching? And 
</p>
<p>how do we find a perfect matching if there is one? </p>
<p/>
</div>
<div class="page"><p/>
<p>172 10. Matchings in Graphs 
</p>
<p>We may assume that IAI = IBI (where, as before, A is the set of nodes 
on the left and B is the set of nodes on the right). This is easy to check, 
</p>
<p>and if it fails, then it is obvious that no perfect matching exists, and we 
</p>
<p>have nothing else to do. 
</p>
<p>One thing we can try is to look at all subsets of the edges, and see 
</p>
<p>whether any of these is a perfect matching. It is easy enough to do so; but 
</p>
<p>there are terribly many subsets to check! Say, in our introductory example, 
</p>
<p>we have 300 nodes, so IAI = IBI = 150; every node has degree 50, so the 
number of edges is 150&middot; 50 = 7500; the number of subsets of a set of this 
size is 27500 &gt; 102257 , a number that is more than astronomical. 
</p>
<p>We can do a little bit better if instead of checking all subsets of the 
</p>
<p>edges, we look at all possible ways to pair up elements of A with elements 
</p>
<p>of B, and check whether any of these pairings matches only nodes that are 
</p>
<p>connected to each other by an edge. Now the number of ways to pair up 
</p>
<p>the nodes is "only" 150! :::;, 10263 . Still hopeless. 
</p>
<p>Can we use Theorem 10.3.1? To check that the necessary and sufficient 
</p>
<p>condition for the existence of a perfect matching is satisfied, we have to 
</p>
<p>look at every subset S of A, and see whether the number of it neighbors in 
</p>
<p>B is at least as large as S itself. Since the set A has 2150 :::;, 1045 subsets, 
</p>
<p>this takes a much smaller number of cases to check than any of the previous 
</p>
<p>possibilities, but still astronomical! 
</p>
<p>So Theorem 10.3.1 does not really help too much in deciding whether 
</p>
<p>a given graph has a perfect matching. We have seen that it does help in 
</p>
<p>proving that certain properties of a graph imply that the graph has a perfect 
</p>
<p>matching. We'll come back to this theorem later and discuss its significance. 
</p>
<p>Right now, we have to find some other way to deal with our problem. 
</p>
<p>Let us introduce one more expression: By a matching we mean a set of 
</p>
<p>edges that have no endpoint in common. A perfect matching is the special 
</p>
<p>case when, in addition, the edges cover all the nodes. But a matching can 
</p>
<p>be much smaller: the empty set, or any edge by itself, is a matching. 
</p>
<p>Let's try to construct a perfect matching in our graph by starting with 
</p>
<p>the empty set and building up a matching one by one. So we select two 
</p>
<p>nodes that are connected, and mark the edge between them; then we select 
</p>
<p>two other nodes that are connected, and mark the edge between them etc. 
</p>
<p>we can do this until no two unmatched nodes are connected by an edge. 
</p>
<p>The edges we have marked form a matching M. This is often called the 
</p>
<p>greedy matching, since it is constructed greedily, without consideration for 
</p>
<p>the future consequences of our choice. If we are lucky, then the greedy 
</p>
<p>matching is perfect, and we have nothing else to do. But what do we do if 
</p>
<p>M is not perfect? Can we conclude that the graph has no perfect matching 
</p>
<p>at all? No, we cannot; it may happen that the graph has a perfect matching, 
</p>
<p>but we made some unlucky choices when selecting the edges of M. </p>
<p/>
</div>
<div class="page"><p/>
<p>10.4 How to Find a Perfect Matching 173 
</p>
<p>10.4.1 Show by an example that it may happen that a bipartite graph G has 
</p>
<p>a perfect matching, but if we are unlucky, the greedy matching M constructed 
</p>
<p>above is not perfect. 
</p>
<p>10.4.2 Prove that if G has a perfect matching, then every greedy matching 
</p>
<p>matches up at least half of the nodes. 
</p>
<p>So suppose that we have constructed a matching M that is not perfect. 
</p>
<p>We have to try to increase its size by "backtracking," i.e., by deleting some 
</p>
<p>of its edges and replacing them by more edges. But how do we find the 
</p>
<p>edges we want to replace? 
</p>
<p>The trick is the following. We look for a path P in G of the following 
</p>
<p>type: P starts and ends at nodes u and v that are unmatched by M; and 
</p>
<p>every second edge of P belongs to M (Figure 10.6). Such a path is called 
</p>
<p>an augmenting path. It is clear that an augmenting path P contains an odd 
</p>
<p>number of edges, and in fact, the number of its edges not in M is one larger 
</p>
<p>than the number of its edges in M. 
</p>
<p>u 
</p>
<p>.... 
.... 
</p>
<p>.... 
.... 
</p>
<p>Edges in M 
</p>
<p>v 
</p>
<p>Edges in P 
</p>
<p>not in M 
</p>
<p>FIGURE 10.6. An augmenting path in a bipartite graph. </p>
<p/>
</div>
<div class="page"><p/>
<p>174 10. Matchings in Graphs 
</p>
<p>If we find an augmenting path P, we can delete those edges of P that are 
</p>
<p>in M and replace them by those edges of P that are not in M. It is clear 
</p>
<p>that this results in a matching M' that is larger than M by one edge. (The 
</p>
<p>fact that M' is a matching follows from the observation that the remaining 
</p>
<p>edges of M cannot contain any node of P: The two endpoints of P were 
</p>
<p>supposed to be unmatched, while the interior nodes of P were matched by 
</p>
<p>edges of M that we deleted.) So we can repeat this until we get either a 
</p>
<p>perfect matching or a matching M for which no augmenting path exists. 
</p>
<p>So we have two questions to answer: how do we find an augmenting path 
</p>
<p>if it exists? And if it does not exist, does this mean that there is no perfect 
</p>
<p>matching at all? It will turn out that an answer to the first question will 
</p>
<p>also imply the (affirmative) answer to the second. 
</p>
<p>Let U be the set of unmatched nodes in A and let W be the set of 
</p>
<p>unmatched nodes in B. As we noted, any augmenting path must have an 
</p>
<p>odd number of edges, and hence it must connect a node in U to a node in 
</p>
<p>W. Let us try to find such an augmenting path starting from some node in 
</p>
<p>U. Let's say that a path Q is almost augmenting if it starts at a node in U, 
ends at a node in A, and every second edge of it belongs to M. An almost 
</p>
<p>augmenting path must have an even number of edges, and must end with 
</p>
<p>an edge of M. 
</p>
<p>What we want to do is to find the set of nodes in A that can be reached 
</p>
<p>on an almost augmenting path. Let's agree that we consider a node in U 
</p>
<p>to be an almost augmenting path in itself (of length 0); then we know that 
</p>
<p>every node in U has this property. Starting with S = U, we build up a set 
S gradually. At any stage, the set S will consist of nodes we already know 
</p>
<p>are reachable by some almost augmenting path. We denote by T the set 
</p>
<p>of nodes in B that are matched with nodes in S (Figure 10.7). Since the 
</p>
<p>nodes of U have nothing matched with them and they are all in S, we have 
</p>
<p>lSI = ITI + lUI&middot; 
</p>
<p>We look for an edge that connects a node s E S to some node rEB that 
</p>
<p>is not in T. Let Q be an almost augmenting path starting at some node 
</p>
<p>u E U and ending at s. Now there are two cases to consider: 
</p>
<p>- If r is unmatched (which means that it belongs to W), then by ap-
</p>
<p>pending the edge sr to Q we get an augmenting path P. So we can 
</p>
<p>increase the size of M (and forget about Sand T). 
</p>
<p>- If r is matched with a node q E A, then we can append the edges sr 
and rq to Q to get an almost augmenting path from U to q. So we 
</p>
<p>can add q to S. 
</p>
<p>So if we find an edge connecting a node in S to a node not in T, we can 
</p>
<p>increase either the size of M or the set S (and leave M as it was). Sooner or 
</p>
<p>later we must encounter a situation where either M is a perfect matching </p>
<p/>
</div>
<div class="page"><p/>
<p>10.4 How to Find a Perfect Matching 175 
</p>
<p>&bull; ~ U&middot; , I. W , I 
" I " , I , 
</p>
<p>/ .-- / " -
" / s _ ........ 
</p>
<p>;-- --- --- -- -- T 5 - - , -
" - --- -" " " 0 &gt; 0 , , 
</p>
<p>q o ------------~ O r? 
</p>
<p>O ~------------~ O 
</p>
<p>FIGURE 10.7. Reaching nodes by almost augmenting paths. Only edges on these 
</p>
<p>paths, and of M, are shown. 
</p>
<p>(and we are done), or M is not perfect, but no edge connects 8 to any node 
</p>
<p>outside T. 
</p>
<p>So what are we to do in this case? Nothing! If this occurs, we can conclude 
</p>
<p>that there is no perfect matching at all. In fact, all neighbors of the set 8 
</p>
<p>are in T, and ITI = 181 - lUI &lt; 181. We know that this implies that there 
is no perfect matching at all in the graph. 
</p>
<p>Figure 10.8 shows how this algorithm finds a matching in the bipartite 
</p>
<p>graph that is a subgraph of the "grid." 
</p>
<p>To sum up, we do the following. At any point in time, we will have a 
</p>
<p>matching M and a set 8 of nodes in A that we know can be reached on 
</p>
<p>almost augmenting paths. If we find an edge connecting 8 to a node not 
</p>
<p>matched with any node in 8, we can either increase the size of M or the 
</p>
<p>set 8, and repeat. If no such edge exists, then either M is perfect or no 
</p>
<p>perfect matching exists at all. 
</p>
<p>Remark. In this chapter we restricted our attention to matchings in bipar-
</p>
<p>tite graphs. One can, of course, define matchings in general (nonbipartite) 
</p>
<p>graphs. It turns out that both the necessary and sufficient condition given 
</p>
<p>in Theorem 10.3.1 and the algorithm described in this section can be ex-
</p>
<p>tended to nonbipartite graphs. However, this requires methods that are 
</p>
<p>quite a bit more involved, which lie beyond the scope of this book. 
</p>
<p>10.4.3 Follow how the algorithm works on the graph in Figure 10.9. 
</p>
<p>10.4.4 Show how the description of the algorithm above contains a new proof 
</p>
<p>of Theorem 10.3.1. </p>
<p/>
</div>
<div class="page"><p/>
<p>176 10. Matchings in Graphs 
</p>
<p>~) 
</p>
<p>r--I ~ 
</p>
<p>~ 
</p>
<p>(a) 
</p>
<p>1 
~ 
</p>
<p>:&gt; 
</p>
<p>1 
&gt;---' 
</p>
<p>&gt;--&lt; t -~ --( ~ ---. 
1 
</p>
<p>(c) 
</p>
<p>~ 
</p>
<p>&gt;--&lt; 
</p>
<p>... )--0_. - o--&lt;? 
</p>
<p>c&middot; 
</p>
<p>(b) 
</p>
<p>~ 
</p>
<p>&gt;--
</p>
<p>-
(d) 
</p>
<p>FIGURE 10.S. (a) The graph in which we want to find a perfect matching. (b) 
</p>
<p>Pick a starting matching, and mark the unmatched nodes. There are 3 black 
</p>
<p>and 3 white unmatched nodes. Broken lines indicate an augmenting path. (c) 
</p>
<p>The new matching and the unmatched nodes after augmentation. Broken lines 
</p>
<p>indicate a new augmenting path (much longer this time). (d) The final situation: 
</p>
<p>Nodes that are accessible on almost augmenting paths are marked black. They 
</p>
<p>have fewer neighbors than their number, so the matching is maximum. 
</p>
<p>Review Exercises 
</p>
<p>10.4.5 Is there a bipartite graph with degrees 3,3,3, 3,3,3,3, 3,3,5, 6, 6? (These 
</p>
<p>can be distributed in the two classes of nodes arbitrarily.) 
</p>
<p>10.4.6 A bipartite graph has 16 nodes of degree 5, and some nodes of degree 
</p>
<p>S. We know that all degree-S nodes are on the left hand side. How many degree 
</p>
<p>S nodes can the graph have? 
</p>
<p>10.4.7 Let G be a bipartite graph with the same number of nodes on both sides. 
</p>
<p>Suppose that every nonempty subset A on the left has at least )A) + 1 neighbors 
on the right. Prove that each edge of G can be extended to a perfect matching 
</p>
<p>ofG. </p>
<p/>
</div>
<div class="page"><p/>
<p>10.4 How to Find a Perfect Matching 177 
</p>
<p>FIGURE 10.9. A graph for trying out the algorithm. 
</p>
<p>10.4.8 Now suppose that we have the weaker condition that every nonempty 
</p>
<p>subset A on the left has at least IAI - 1 neighbors on the right . Prove that G 
contains a matching that matches up all but one node on each side. 
</p>
<p>10.4.9 Let G be a bipartite graph with m nodes on both sides. Prove that if 
</p>
<p>each node has degree larger than m/2, then it has a perfect matching. 
</p>
<p>10.4.10 Does the graph in Figure 10.10 have a perfect matching? 
</p>
<p>FIGURE 10.10. A truncated chessboard. 
</p>
<p>10.4.11 Draw a graph whose nodes are the subsets of {a,b,c}, and for which 
two nodes are adjacent if and only if they are subsets that differ in exactly one 
</p>
<p>element. 
</p>
<p>(a) What is the number of edges and nodes in this graph? Can you name this 
</p>
<p>graph? 
</p>
<p>(b) Is this graph connected? Does it have a perfect matching? Does it have a 
</p>
<p>Hamilton cycle? </p>
<p/>
</div>
<div class="page"><p/>
<p>178 10. Matchings in Graphs 
</p>
<p>10.4.12 Draw a graph whose nodes are the 2-subsets of {a,b,c,d,e}, and two 
</p>
<p>nodes are adjacent if and only if they are disjoint subsets. 
</p>
<p>(a) Show that you get the Petersen graph (Figure 7.13). 
</p>
<p>(b) How many perfect matchings does the Petersen graph have? 
</p>
<p>10.4.13 (a) How many perfect matchings does a path on n nodes have? (b) How 
</p>
<p>many matchings (not necessarily perfect) does a path on n nodes have? [Find a 
</p>
<p>recurrence first.] (b) How many matchings does a cycle on n nodes have? 
</p>
<p>10.4.14 Which 2-regular bipartite graph with n nodes has the largest number 
</p>
<p>of perfect matchings? 
</p>
<p>10.4.15 How many perfect matchings does the "ladder" with 2n nodes (Figure 
</p>
<p>10.11) have? 
</p>
<p>FIGURE 10.11. The ladder graph. </p>
<p/>
</div>
<div class="page"><p/>
<p>11 
</p>
<p>Combinatorics in Geometry 
</p>
<p>11.1 Intersections of Diagonals 
</p>
<p>At first you may be surprised: What is the connection between combi-
</p>
<p>natorics and geometry? There are many geometric questions that can be 
</p>
<p>solved by combinatorial methods, but the opposite case may also occur: We 
</p>
<p>can solve combinatorial exercises and problems using geometrical tools. 
</p>
<p>Consider a convex polygon with n vertices. (We call a polygon convex if 
</p>
<p>every angle of it is convex, i.e., less than 1800 .) Assume that it has no 3 
</p>
<p>diagonals going through the same point. How many intersection points do 
</p>
<p>the diagonals have? (The vertices are not counted as intersections, and we 
</p>
<p>do not consider intersections of diagonals outside the n-gon. In Figure 11.1, 
</p>
<p>the black point is a "good" intersection, so it is counted, but the circled 
</p>
<p>point outside the polygon is not counted.) 
</p>
<p>FIGURE 11.1. </p>
<p/>
</div>
<div class="page"><p/>
<p>180 11. Combinatorics in Geometry 
</p>
<p>The first natural idea to solve this problem is the following: Count the 
</p>
<p>intersection points on each diagonal, and then add up these numbers. Let's 
</p>
<p>follow through this method in the case of a hexagon (Figure 11.2). First 
</p>
<p>consider a diagonal which connects two second-neighboring vertices of the 
</p>
<p>hexagon, say these are A and G. This diagonal AG intersects all three 
</p>
<p>diagonals that start in B, which means that there are three intersections 
</p>
<p>on the diagonal AG. There are six diagonals of this type, so altogether we 
</p>
<p>count 6 . 3 = 18 intersections. 
</p>
<p>FIGURE 11.2. 
</p>
<p>Now consider a diagonal that connects two opposite vertices of the 
</p>
<p>hexagon, say AD. One can see in the figure that there are four intersections 
</p>
<p>on this diagonal. We have three diagonals of this type, which means that 
</p>
<p>we get 3 . 4 = 12 further intersections. 
Is it true that we have 18 + 12 = 30 intersections? We must be more care-
</p>
<p>ful! The intersection of the diagonals AG and BD was counted twice: Once 
</p>
<p>when we considered the intersections on AG, and also when we counted 
</p>
<p>the intersections on BD. The same holds for any other intersection too: we 
</p>
<p>counted all of them exactly twice. So we have to divide our result by 2, so 
</p>
<p>our final, correct result is 15, which can be easily checked in the figure. 
</p>
<p>One can see that already for the case of such a small n, we have to 
</p>
<p>consider several cases, so our method is too complicated, even though it 
</p>
<p>can be carried through for arbitrary n (try it!). But we can find a much 
</p>
<p>more elegant enumeration of the intersections if we use our combinatorial 
</p>
<p>knowledge. 
</p>
<p>Label every intersection point by the endpoints of the diagonals inter-
</p>
<p>secting at this point. For instance, the intersection of the diagonals AG and 
</p>
<p>BD gets the label ABGD, the intersection of the diagonals AD and GE 
</p>
<p>gets the label AGDE, and so on. Is this labeling good, by which we mean 
</p>
<p>that different intersection points get different labels? The labeling is good, 
</p>
<p>since the labels A, B, G, D are given only to the intersection of the diago-
</p>
<p>nals ofthe convex quadrilateral ABGD (AG and BD). Furthermore, every 
</p>
<p>set of 4 vertices are used to label an intersection point of the diagonals; for 
</p>
<p>instance, the 4-tuple AGEF denotes the intersection of the diagonals AE 
</p>
<p>and GF (Figure 11.3). </p>
<p/>
</div>
<div class="page"><p/>
<p>11.2 Counting regions 181 
</p>
<p>ABEF 
A 
</p>
<p>Btf---+-+-___ --~ F 
</p>
<p>D 
</p>
<p>ACDE 
</p>
<p>FIGURE 11.3. 
</p>
<p>Now if we want to count all the intersection points, it suffices to count 
</p>
<p>quadruples of vertices; the number of intersections of the diagonals is just 
</p>
<p>the number of 4-element subsets of the set of vertices. So if n = 6, then it 
is (~), which we may compute even faster, if we recall that it is the same 
</p>
<p>as m = ~:~ = 15. In general, we get G) intersections of diagonals of a 
convex n-gon. 
</p>
<p>11.1.1 How many diagonals does a convex n-gon have? 
</p>
<p>11.2 Counting regions 
</p>
<p>Let us draw n lines in the plane. These lines divide the plane into some 
</p>
<p>number of regions. How many regions do we get? 
</p>
<p>The first thing to notice is that this question does not have a single 
</p>
<p>answer. For example, if we draw two lines, we get 3 regions if the two are 
</p>
<p>parallel, and 4 regions if they are not. 
</p>
<p>OK, let us assume that no two of the lines are parallel; then 2 lines always 
</p>
<p>give us 4 regions. But if we go on to three lines, we get 6 regions if the lines 
</p>
<p>go through one point, and 7 regions if they do not (Figure 11.4). 
</p>
<p>1 2 3 %5 4 
1 3 
</p>
<p>2 ~ 
6 4 
</p>
<p>1 ; 3 
</p>
<p>FIGURE 11.4. 
</p>
<p>OK, let us also exclude this, and assume that no 3 lines go through the 
</p>
<p>same point. One might expect that the next unpleasant example comes with 
</p>
<p>4 lines, but if you experiment with drawing 4 lines in the plane, with no two </p>
<p/>
</div>
<div class="page"><p/>
<p>182 11. Combinatorics in Geometry 
</p>
<p>parallel and no three going through the same point, then you invariably 
</p>
<p>get 11 regions. In fact, we'll have a similar experience for any number of 
</p>
<p>lines (check this in Figure 11. 5). 
</p>
<p>FIGURE 11.5. Four lines determine 11 regions, five lines determine 16. 
</p>
<p>A set of lines in the plane such that no two are parallel and no three 
</p>
<p>go through the same point is said to be in general position. If we choose 
</p>
<p>the lines "randomly," then accidents like two being parallel or three going 
</p>
<p>through the same point will be very unlikely, so our assumption that the 
</p>
<p>lines are in general position is quite natural. 
</p>
<p>Even if we accept that the number of regions is always the same for a 
</p>
<p>given number of lines, the question still remains, what is this number? Let 
</p>
<p>us collect our data in a little table (including also the observation that 0 
</p>
<p>lines divide the plane into 1 region, and 1 line divides the plane into 2): 
</p>
<p>Staring at this table for a while, we observe that each number in the 
</p>
<p>second row is the sum of the number above it and the number to the left of 
</p>
<p>it. This suggests a rule: The nth entry is n plus the previous entry. In other 
</p>
<p>words: If we have a set of n - 1 lines in the plane in general position, and 
</p>
<p>add a new line (preserving general position), then the number of regions 
</p>
<p>increases by n. 
</p>
<p>Let us prove this assertion. How does the new line increase the number 
</p>
<p>of regions? By cutting some of them into two. The number of additional 
</p>
<p>regions is just the same as the number of regions intersected. 
</p>
<p>So, how many regions does the new line intersect? At a first glance, this 
</p>
<p>is not easy to answer, since the new line can intersect very different sets 
</p>
<p>of regions, depending on where we place it. But imagine walking along the 
</p>
<p>new line, starting from very far away. We get to a new region every time we 
</p>
<p>cross a line. So the number of regions the new line intersects is one larger 
</p>
<p>than the number of crossing points on the new line with other lines. 
</p>
<p>Now, the new line crosses every other line (since no two lines are parallel), 
</p>
<p>and it crosses them in different points (since no three lines go through the 
</p>
<p>same point). Hence during our walk, we see n - 1 crossing points. So we 
see n different regions. This proves that our observation about the table is 
</p>
<p>true for every n. </p>
<p/>
</div>
<div class="page"><p/>
<p>11.2 Counting regions 183 
</p>
<p>We are not done yet; what does this give for the number of regions? We 
</p>
<p>start with 1 region for 0 lines, and then add to it 1,2,3, ... ,n. This way 
</p>
<p>we get 
</p>
<p>n(n + 1) 
1+(1+2+3+"'+n)=1+ 2 
</p>
<p>(in the last step we used the "young Gauss' problem from Chapter 1). Thus 
</p>
<p>we have proved: 
</p>
<p>Theorem 11.2.1 A set of n lines in general position in the plane divides 
</p>
<p>the plane into 1 + n( n + 1) /2 regions. 
</p>
<p>11.2.1 Describe a proof of Theorem 11.2.1 using induction on the number of 
</p>
<p>lines. 
</p>
<p>Let us give another proof of Theorem 11.2.1. 
</p>
<p>Proof. This time, we will not use induction, but rather try to relate the 
</p>
<p>number of regions to other combinatorial problems. One gets a hint from 
</p>
<p>writing the number in the form 1 + n + G). 
</p>
<p>FIGURE 11.6. 
</p>
<p>Assume that the lines are drawn on a vertical blackboard (Figure 11.6), 
</p>
<p>which is large enough so that all the intersection points appear on it. We 
</p>
<p>also assume that no line is perfectly horizontal (it it is, we tilt the picture 
</p>
<p>a little), and that the blackboard is very long, so that every line intersects 
</p>
<p>the bottom edge of the blackboard. We may also assume that the lower </p>
<p/>
</div>
<div class="page"><p/>
<p>184 11. Combinatorics in Geometry 
</p>
<p>edge of the blackboard tilts a little to the left (else, we tilt the blackboard 
</p>
<p>by a tiny amount). 
</p>
<p>Now consider the lowest point in each region on the blackboard. Each 
</p>
<p>region has exactly one lowest point, since all regions are finite, and the 
</p>
<p>bordering lines are not horizontal. This lowest point is then an intersection 
</p>
<p>point of two of our lines, or the intersection point of a line with the lower 
</p>
<p>edge of the blackboard, or the lower left corner of the blackboard. Further-
</p>
<p>more, each of these points is the lowest point of one and only one region. 
</p>
<p>For example, if we consider any intersection point of two lines, then we see 
</p>
<p>that four regions meet at this point, and the point is the lowest point of 
</p>
<p>exactly one of them. 
</p>
<p>Thus the number of lowest points is the same as the number of intersec-
</p>
<p>tion points of the lines, plus the number of intersection points between lines 
</p>
<p>and the lower edge of the blackboard, plus one for the lower left corner of 
</p>
<p>the blackboard. Since any two lines intersect, and these intersection points 
</p>
<p>are all different (this is where we use that the lines are in general position), 
</p>
<p>the number of such lowest points is G) + n + 1. 0 
</p>
<p>11.3 Convex Polygons 
</p>
<p>Let us finish our excursion to combinatorial geometry with a problem that 
</p>
<p>can be easily stated, but which is still unsolved. It is often called the Happy 
</p>
<p>End Problem, because the mathematician who raised it, Esther Klein, and 
</p>
<p>the mathematician who proved the first bounds on it, Gyi::irgy Szekeres 
</p>
<p>(together with Pal Erdos), got married shortly after. 
</p>
<p>We start with an exercise: 
</p>
<p>Prove that if we are given five points in the plane such that no 
</p>
<p>three of them are on a line, then we can always find four points 
</p>
<p>among them that form the vertices of a convex quadrilateral. 
</p>
<p>For a quadrilateral, convexity means that the two diagonals intersect 
</p>
<p>inside the quadrilateral. In Figure 11.7, the first quadrilateral is convex; 
</p>
<p>the second is concave. 
</p>
<p>FIGURE 11.7. A convex and a concave quadrilateral. </p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Convex Polygons 185 
</p>
<p>In the sequel, for the sake of brevity we will say that certain points are 
</p>
<p>in general position, if no three of them are on a line. 
</p>
<p>Imagine that our five points (in general position) are drawn on the black-
</p>
<p>board. Let us hammer nails into the points (only in imagination!) and 
</p>
<p>stretch a rubber band around them. The rubber band encloses a convex 
</p>
<p>polygon, the vertices of which are among the original points, and the other 
</p>
<p>points are inside of this polygon. This polygon is called the convex hull of 
</p>
<p>the points (Figure 11.8). 
</p>
<p>FIGURE 11.8. The convex hull of a set of points in the plane. 
</p>
<p>Using this construction, it is quite easy to solve our problem. What can 
</p>
<p>we get as the convex hull of our five points? If this is a pentagon, then any 
</p>
<p>four of these points form a convex quadrilateral, and we are done. If the 
</p>
<p>convex hull is a quadrilateral, then this quadrilateral itself is the desired 
</p>
<p>convex quadrilateral. So we may assume that the convex hull is a triangle. 
</p>
<p>Let's denote the vertices of this triangle by A, B, and C, and the two other 
</p>
<p>given points by D and E. The points D and E are inside the triangle ABC, 
</p>
<p>so the line through D and E intersects the circumference of the triangle in 
</p>
<p>two points. Assume that these two points are on the sides AB and AC (if 
</p>
<p>this is not the case, then we can relabel the vertices of the triangle). Now 
</p>
<p>you can easily show that the points B, C, D, and E form the vertices of a 
</p>
<p>convex quadrilateral (see Figure 11.9). 
</p>
<p>The next fact in the line concerns convex pentagons. 
</p>
<p>If we have 9 points in the plane in general position, then one 
</p>
<p>can choose five points among them that are the vertices of a 
</p>
<p>convex pentagon. 
</p>
<p>The proof of this statement is too lengthy to give it as an exercise, but 
</p>
<p>the reader may try to work out a proof. 
</p>
<p>11.3.1 Draw eight points in the plane in such a way that no five of them span 
a convex pentagon. 
</p>
<p>One can give 16 points in general position in the plane such that no 6 
</p>
<p>of them form a convex hexagon. Nobody has been able to construct 17 </p>
<p/>
</div>
<div class="page"><p/>
<p>186 11. Combinatorics in Geometry 
</p>
<p>A 
</p>
<p>.~.-
</p>
<p>B ~ --- -----lo C 
</p>
<p>FIGURE 11.9. Finding a convex quadrilateral. 
</p>
<p>points with this property, and in fact (as we are writing this), substantial 
</p>
<p>computer assisted research is underway to show that one can always find a 
</p>
<p>convex hexagon among any 17 points in general position in the plane. More 
</p>
<p>generally, we can ask, How many points (in general position) do we need 
</p>
<p>to make sure that we find a convex n-gon among them? In other words: 
</p>
<p>What is the maximum number of points in the plane, in general 
</p>
<p>position, that do not contain the vertices of a convex n-gon? 
</p>
<p>If we make a table from the known cases, it is not too hard to conjecture 
</p>
<p>the answer: 
</p>
<p>I n I ~ I ~ I ! I : I ~6? I 
(We didn't mention the cases for n = 2 and 3 before, because these are 
</p>
<p>not interesting, but for the sake of completeness we added them to the 
</p>
<p>table. The "twogon" is nothing but a segment, so it is convex, and every 
</p>
<p>triangle is convex as well.) 
</p>
<p>We may notice that the number of points not containing a convex n-gon 
</p>
<p>doubles as n increases by 1, at least in the known cases. It is natural to 
</p>
<p>suppose that this will be the truth for larger numbers too, so the conjec-
</p>
<p>tured number is 2n-2. It is known that for every n &gt; 1, there exists a set of 
2n - 2 points in the plane, in general position, that do not contain a convex 
</p>
<p>n-gon. But whether or not one more point guarantees a convex n-gon is 
</p>
<p>still unknown as of today. 
</p>
<p>Review Exercises 
</p>
<p>11.3.2 Given n ;::: 3 lines in the plane in general position (no two are parallel 
</p>
<p>and no three go through a point), prove that among the regions they divide the 
</p>
<p>plane into, there is at least one triangle. </p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Convex Polygons 187 
</p>
<p>11.3.3 Into how many parts do two triangles divide the plane? 
</p>
<p>11.3.4 Into how many parts do two quadrilaterals divide the plane, if 
</p>
<p>(a) they are convex, 
</p>
<p>(b) they are not necessarily convex? 
</p>
<p>11.3.5 Into how many parts do two convex n-gons divide the plane? 
</p>
<p>11.3.6 Into how many parts can n circles divide the plane, maximum and min-
</p>
<p>imum? 
</p>
<p>11.3.7 Prove that 6 points in the plane, no 3 on a line, form at least 3 convex 
</p>
<p>quadrilaterals. 
</p>
<p>11.3.8 Given a set S of 100 points in the plane, no 3 on a line, show that there 
</p>
<p>is a convex polygon whose vertices are in the set S and that contains exactly 50 
</p>
<p>points of S (including its vertices). </p>
<p/>
</div>
<div class="page"><p/>
<p>12 
</p>
<p>Euler's Formula 
</p>
<p>12.1 A Planet Under Attack 
</p>
<p>In Chapter 11 we considered problems that can be cast in the language of 
</p>
<p>graph theory: If we draw some special graphs in the plane, into how many 
</p>
<p>parts do these graphs divide the plane? Indeed, we start with a set of lines; 
</p>
<p>we consider the intersections of the given lines as nodes of the graph, and 
</p>
<p>the segments arising on these lines as the edges of our graph. (For the time 
</p>
<p>being, let us forget about the infinite half-lines. We'll come back to the 
</p>
<p>connection between graphs and sets of lines later.) 
</p>
<p>More generally, we study a planar map: a graph that is drawn in the plane 
</p>
<p>so that its edges are nonintersecting continuous curves. We also assume that 
</p>
<p>the graph is connected. Such a graph divides the plane into certain parts, 
</p>
<p>called countries. Exactly one country is infinite, the other countries are 
</p>
<p>finite. 
</p>
<p>A very important result, discovered by Euler, tells us that we may de-
</p>
<p>termine the number of countries in a connected planar map if we know the 
</p>
<p>number of nodes and edges of the graph. Euler's Formula is the following: 
</p>
<p>Theorem 12.1.1 number of countries + number of nodes = number of 
edges + 2. 
</p>
<p>Proof. To make the proof of this theorem more plausible, we'll tell a little 
</p>
<p>story. This does not jeopardize the mathematical correctness of our proof. 
</p>
<p>Let us consider the given planar map as the map of a water system of 
</p>
<p>a planet with a single very low continent. We consider the edges not as </p>
<p/>
</div>
<div class="page"><p/>
<p>190 12. Euler's Formula 
</p>
<p>boundaries between countries but as dams, with watchtowers at the nodes. 
</p>
<p>So the enclosed areas are not countries, but basins. The outermost "basin" 
</p>
<p>is the sea, and all the other "basins" are dry (Figure 12.1). One advantage 
</p>
<p>of this formulation is that we can allow a cut-edge in the graph, which we 
</p>
<p>can think of as a kind of dam, or pier; this could not be considered as a 
</p>
<p>boundary of two countries, since on both sides of it we would have the same 
</p>
<p>"country" (in this case, the sea). 
</p>
<p>FIGURE 12.1. A graph of dams and watchtowers. There are 14 watchtow-
ers, 7 basins (including the see), and 19 dams. Euler's Formula checks our: 
</p>
<p>14 + 7 = 19 + 2. 
</p>
<p>One day, an enemy attacks the island, and the defenders decide to flood 
</p>
<p>it with seawater by blowing up certain dams. The defenders are hoping to 
</p>
<p>defeat the attack and return to their island, so they try to blow up the 
</p>
<p>smallest possible number of dams. They figured out the following proce-
</p>
<p>dure: They blow up one dam at a time, and then only in the case if one side 
</p>
<p>of the dam is already flooded, and the other side is dry. After the destruc-
</p>
<p>tion of this dam the ocean fills up the previously dry basin with seawater. 
</p>
<p>Notice that all the other dams (edges) around this basin are intact at this 
</p>
<p>stage (because whenever a dam is blown up, the basins on both sides of it 
</p>
<p>are flooded), so the seawater fills up only this particular basin. In Figure 
</p>
<p>12.2 we have indicated by numbers one possible order in which the dams 
</p>
<p>can be blown up to flood the whole island. 
</p>
<p>Let us count the number of destroyed and intact dams. We denote the 
</p>
<p>number of watchtowers (nodes) by v, the number of dams (edges) bye, and 
</p>
<p>the number of basins, including the ocean, by f (we'll give an explanation 
later why are we using these letters). To flood all the f - 1 basins of the 
island, we had to destroy exactly f - 1 dams. 
</p>
<p>To count the surviving dams, let us look at the graph remaining after 
</p>
<p>the explosions (Figure 12.3). First, one can notice that it contains no cy-
</p>
<p>cles, because the interior of any cycle would have remained dry. A second 
</p>
<p>observation is that the remaining system of dams forms a connected graph, 
</p>
<p>since every dam that was blown up was an edge of a cycle (the boundary </p>
<p/>
</div>
<div class="page"><p/>
<p>12.1 A Planet Under Attack 191 
</p>
<p>FIGURE 12.2. Flooding the island. To flood 6 basins, 6 dams must be blown up. 
</p>
<p>FIGURE 12.3. The island flooded. 13 dams remain intact, forming a tree. 
</p>
<p>of the basin that was flooded by this last explosion), and we know from 
</p>
<p>exercise 7.2.5(b) that omitting such an edge would not destroy the connec-
</p>
<p>tivity of our graph. So the resulting graph after the explosions is connected 
</p>
<p>and does not contain any cycle; therefore, it is a tree. 
</p>
<p>Now we apply the important fact that if a tree has v nodes, than it has 
</p>
<p>v-I edges. 
</p>
<p>Summarizing what we have learned, we know that f -1 dams were blown 
up and v-I dams survived. So the number of edges is the sum of these two 
</p>
<p>numbers. Expressing this fact as an equation yields (v - 1) + (f - 1) = e. 
Rearranging, we get 
</p>
<p>f + v = e + 2, 
</p>
<p>and this is just Euler's Formula. o 
</p>
<p>12.1.1 Into how many parts do the diagonals divide a convex n-gon (we assume 
</p>
<p>that no 3 diagonals go through the same point)? 
</p>
<p>12.1.2 On a circular island we build n straight dams going from sea to sea, 
</p>
<p>so that every two intersect but no three go through the same point. Use Euler's 
</p>
<p>Formula to determine how many parts we get. As a hint look at Figure 12.4 (the 
</p>
<p>solution of this exercise will be the third method for solving the same problem). </p>
<p/>
</div>
<div class="page"><p/>
<p>192 12. Euler's Formula 
</p>
<p>FIGURE 12.4. The planar map given by n straight lines. 
</p>
<p>12.2 Planar Graphs 
</p>
<p>Which graphs can be drawn as planar maps? This question is important not 
</p>
<p>only because we want to know to which graphs we can apply Euler's For-
</p>
<p>mula, but also in many applications of graph theory, for example, placing 
</p>
<p>a network on a printed circuit board. 
</p>
<p>A graph is called planar if it can be drawn as a map in the plane, that 
</p>
<p>is, if we can represent its nodes by different points in the plane, and its 
</p>
<p>edges by curves connecting the appropriate points in such a way that these 
</p>
<p>curves don't intersect each other (except, of course, when two edges have 
</p>
<p>a common endpoint, in which case the two corresponding curves will have 
</p>
<p>this one common point). 
</p>
<p>Are there graphs that are not planar? As a nice application of Euler's 
</p>
<p>Formula, we can prove the following: 
</p>
<p>Theorem 12.2.1 The complete graph K5 on five nodes is not a planar 
</p>
<p>graph. 
</p>
<p>One could prove this by distinguishing a large number of cases and us-
</p>
<p>ing various intuitive but potentially misleading properties of curves in the 
</p>
<p>plane. But we are able to give an elegant proof now, using Euler's Formula. 
</p>
<p>Proof. Our proof is indirect: Assuming that K5 can be drawn in the plane 
</p>
<p>without any edges crossing, we get a contradiction. (It is not surprising that 
we are not able to provide a figure, since the impossibility of such a figure 
</p>
<p>is what we want to prove.) Let us compute the number of countries that 
</p>
<p>we would have in such a drawing. We have 5 nodes and (~) = 10 edges; 
hence the number of countries is, by Euler's Formula, 10 + 2 - 5 = 7. Every 
country has at least 3 edges on its boundary, so we must have at least 
</p>
<p>3;} = 10.5 edges. (We had to divide by 2, because we counted every edge </p>
<p/>
</div>
<div class="page"><p/>
<p>12.2 Planar Graphs 193 
</p>
<p>for two different countries.) The assumption that K5 is planar led us to a 
</p>
<p>contradiction, namely, 10 &gt; 10.5, so our assumption must have been false, 
and the complete graph on 5 nodes (K5) is not planar. 0 
</p>
<p>One of the most interesting phenomena in mathematics occurs when 
</p>
<p>in the proof of some result one can make use of theorems that at a first 
</p>
<p>glance do not have any connection with the actual problem. Would any 
</p>
<p>of you guess that one can use the nonplanarity of the complete graph on 
</p>
<p>five points to give another proof of the starting exercise of Section 11.3? 
</p>
<p>Given our five points in the plane, connect any two of them by a segment. 
</p>
<p>The resulting graph is a complete graph on five vertices, which is not a 
</p>
<p>planar graph, as we already know; therefore, we can find two segments 
</p>
<p>that intersect each other. The four endpoints of these two segments form 
</p>
<p>a quadrilateral whose diagonals intersect; therefore, this quadrilateral is 
</p>
<p>convex. 
</p>
<p>As another application of Euler's Formula, let's answer the following 
</p>
<p>question: How many edges can a planar map with n nodes have? 
</p>
<p>Theorem 12.2.2 A planar graph on n nodes has at most 3n - 6 edges. 
</p>
<p>Proof. The derivation of this bound is quite similar to our argument 
</p>
<p>above showing that K5 is not a planar graph. Let the graph have n nodes, 
</p>
<p>e edges, and 1 faces. We know by Euler's Formula that 
</p>
<p>n + 1 = e + 2. 
</p>
<p>We obtain another relation among these numbers if we count edges face by 
</p>
<p>face. Each face has at least 3 edges on its boundary, so we count at least 
</p>
<p>31 edges. Every edge is counted twice (it is on the border of two faces), so 
</p>
<p>the number of edges is at least 31/2. In other words, 1 :::; ~e. Using this 
</p>
<p>with Euler's Formula, we get 
</p>
<p>2 
e + 2 = n + 1 :::; n + "3e, 
</p>
<p>which after rearrangement gives e :::; 3n - 6. o 
</p>
<p>12.2.1 Is the graph obtained by omitting an edge of K5 planar? 
</p>
<p>12.2.2 There are three houses and three wells. Can we build a path from ev-
</p>
<p>ery house to every well so that these paths do not cross? (The paths are not 
</p>
<p>necessarily straight lines.) </p>
<p/>
</div>
<div class="page"><p/>
<p>194 12. Euler's Formula 
</p>
<p>12.3 Euler's Formula for Polyhedra 
</p>
<p>There is still an apparently irrelevant question to deal with. Why did we 
</p>
<p>denote the number of countries by 1? Well, this is the starting letter of the 
</p>
<p>word face. When Euler was trying to find "his" formula, he was studying 
</p>
<p>polyhedra (solids bounded by plane polygons) like the cube, pyramids, and 
</p>
<p>prisms. Let us count for some polyhedra the number of faces, edges, and 
</p>
<p>vertices (Table 12.1). 
</p>
<p>Polyhedron # of vertices # of edges # of faces 
cube 8 12 6 
</p>
<p>tetrahedron 4 6 4 
</p>
<p>triangular prism 6 9 5 
</p>
<p>pentagonal prism 10 15 7 
</p>
<p>pentagonal pyramid 6 10 6 
</p>
<p>dodecahedron 20 30 12 
</p>
<p>icosahedron 12 30 20 
</p>
<p>TABLE 12.1. 
</p>
<p>(You don't know what the dodecahedron and icosahedron are? These are 
</p>
<p>two very pretty regular polyhedra; their faces are regular pentagons and 
</p>
<p>triangles, respectively. They can be seen in Figure 12.5.) 
</p>
<p>FIGURE 12.5. Two regular polyhedra: the dodecahedron and the icosahedron. 
</p>
<p>Staring at these numbers for a little while, one discovers that in every 
</p>
<p>case the following relation holds: 
</p>
<p>number of faces + number of vertices = number of edges + 2. 
</p>
<p>This formula strongly resembles Euler's Formula; the only difference is 
</p>
<p>that instead of nodes, we speak of vertices, and instead of countries, here 
</p>
<p>we speak of faces. This similarity is not a coincidence; we may get the 
</p>
<p>formula for polyhedra from the formula for planar maps very easily as 
</p>
<p>follows. Imagine that our polyhedron is made out of rubber. Punch a hole </p>
<p/>
</div>
<div class="page"><p/>
<p>12.3 Euler's Formula for Polyhedra 195 
</p>
<p>into one of the faces and blow it up like balloon. The most familiar solids 
</p>
<p>will be blown up to spheres (for instance the cube and prism). But we have 
</p>
<p>to be careful here: There are solids that cannot be blown up to a sphere. For 
</p>
<p>instance, the "picture frame" shown on Figure 12.6 blows up to a "torus," 
</p>
<p>similar to a life buoy (or doughnut). Be careful, the above relation holds 
</p>
<p>only for solids that can be blown up to spheres! (Just to reassure you, all 
</p>
<p>the convex solids can be blown up to spheres.) Now grab the rubber sphere 
</p>
<p>at the side of the hole and stretch it until you get a huge rubber plane. If 
</p>
<p>we paint the edges of the original solid with black ink, then we will see a 
</p>
<p>map on the plane. The nodes of this map are the vertices of the solid, the 
</p>
<p>edges are the edges of the solid, and the countries are the faces of the body. 
</p>
<p>Therefore, if we use Euler's Formula for maps, we get Euler's Formula for 
</p>
<p>polyhedra (Euler himself stated the theorem in the polyhedral form) . 
</p>
<p>./ ./ 
</p>
<p>........ ./ 
</p>
<p>V \ ./ 
</p>
<p>FIGURE 12.6. A nonconvex polyhedron that blows up to a torus. 
</p>
<p>Review Exercises 
</p>
<p>12.3.1 Is the complement of the cycle of length 6 (C6 ) a planar graph? 
</p>
<p>12.3.2 Take a hexagon and add the three longest diagonals. Is the graph ob-
</p>
<p>tained this way planar? 
</p>
<p>12.3.3 Does the "picture frame" polyhedron in Figure 12.6 satisfy Euler's For-
</p>
<p>mula? 
</p>
<p>12.3.4 Prove that a planar bipartite graph on n nodes has at most 2n-4 edges. 
</p>
<p>12.3.5 Using Euler's Formula, show that the Petersen graph is not planar. 
</p>
<p>12.3.6 A convex polyhedron has only pentagonal and hexagonal faces. Prove 
</p>
<p>that it has exactly 12 pentagonal faces. 
</p>
<p>12.3.7 Every face of a convex polyhedron has at least 5 vertices, and every 
</p>
<p>vertex has degree 3. Prove that if the number of vertices is n, then the number 
</p>
<p>of edges is at most 5(n - 2)/3. </p>
<p/>
</div>
<div class="page"><p/>
<p>196 12. Euler's Formula 
</p>
<p>12.3.8 Does the "picture frame" polyhedron in Figure 12.6 satisfy Euler's For-
</p>
<p>mula? </p>
<p/>
</div>
<div class="page"><p/>
<p>13 
</p>
<p>Coloring Maps and Graphs 
</p>
<p>13.1 Coloring Regions with Two Colors 
</p>
<p>We draw some circles on the plane (say, n in number). These divide the 
</p>
<p>plane into a number of regions. Figure 13.1 shows such a set of circles, and 
</p>
<p>also an "alternating" coloring of the regions with two colors; it gives a nice 
</p>
<p>pattern. Now our question is, can we always color these regions this way? 
</p>
<p>We'll show that the answer is yes. Let us state this more exactly: 
</p>
<p>Theorem 13.1.1 The regions formed by n circles in the plane can be col-
</p>
<p>ored with red and blue in such a way that any two regions that share a 
</p>
<p>common boundary arc will be colored differently. 
</p>
<p>(If two regions have only one or two boundary points in common, then they 
may get the same color.) 
</p>
<p>Let us first see why a direct approach to proving this theorem does not 
</p>
<p>work. We could start with coloring the outer region, say blue; then we have 
</p>
<p>to color its neighbors red. Could it happen that two neighbors are at the 
</p>
<p>same time neighbors of each other? Perhaps drawing some pictures and 
</p>
<p>then arguing carefully about them, you can design a proof that this cannot 
</p>
<p>happen. But then we have to color the neighbors of the neighbors blue 
</p>
<p>again, and we would have to prove that no two of these are neighbors of 
</p>
<p>each other. This could get quite complicated! And then we would have to 
</p>
<p>repeat this for the neighbors of the neighbors of the neighbors .... 
</p>
<p>We should find a better way to prove this, and fortunately, there is a 
</p>
<p>better way! </p>
<p/>
</div>
<div class="page"><p/>
<p>198 13. Coloring Maps and Graphs 
</p>
<p>FIGURE 13.1. Two-coloring the regions formed by a set of circles. 
</p>
<p>Proof. We prove the assertion by induction on n, the number of circles. 
</p>
<p>If n = 1, then we get only two regions, and we can color one of them red, 
the other one blue. So let n &gt; 1. Select any of the circles, say C, and forget 
about it for the time being. We assume that the regions formed by the 
</p>
<p>remaining n - 1 circles can be colored with red and blue so that regions 
</p>
<p>that share a common boundary arc get different colors (this is just the 
</p>
<p>induction hypothesis). 
</p>
<p>Now we put back the remaining circle, and change the coloring as follows: 
</p>
<p>Outside C, we leave the coloring as it was; inside C, we interchange red 
</p>
<p>and blue (Figure 13.2). 
</p>
<p>. ..... 
</p>
<p>~ ..... 
</p>
<p>FIGURE 13.2. Adding a new circle and recoloring. 
</p>
<p>It is easy to see that the coloring obtained this way satisfies what we 
</p>
<p>wanted. In fact, look at any small piece of arc of any of the circles. If this 
</p>
<p>arc is outside C, then the two regions on its two sides were different and 
</p>
<p>their colors did not change. If the arc is inside C, then again, the two regions 
</p>
<p>on its two sides were differently colored, and even though their colors were 
</p>
<p>switched, they are still different. Finally, the arc could be on C itself. Then </p>
<p/>
</div>
<div class="page"><p/>
<p>13.2 Coloring Graphs with Two Colors 199 
</p>
<p>the two regions on both sides of the arc were one and the same before we 
</p>
<p>put C back, and so they had the same color. Now, one of them is inside C 
and this switched its color; the other is outside, and this did not. So after 
</p>
<p>the recoloring, their colors will be different. 
</p>
<p>Thus we have proved that the regions formed by n circles can be colored 
</p>
<p>with two colors, provided that the regions formed by n - 1 circles can 
</p>
<p>be colored with 2 colors. By the Principle of Induction, this proves the 
</p>
<p>theorem. D 
</p>
<p>FIGURE 13.3. Find the color of a region. 
</p>
<p>13.1.1 Assume that the color of the outer region is blue. Then we can describe 
</p>
<p>what the color of a particular region R is without having to color the whole 
</p>
<p>picture as follows: 
</p>
<p>if R lies inside an even number of circles, it will be colored blue; 
</p>
<p>if R lies inside an odd number of circles, it will be colored red. 
</p>
<p>Prove this assertion (see Figure 13.3). 
</p>
<p>13.1.2 (a) Prove that the regions, into which n straight lines divide the plane, 
</p>
<p>are colorable with 2 colors. 
</p>
<p>(b) How could you describe what the color of a given region is? 
</p>
<p>13.2 Coloring Graphs with Two Colors 
</p>
<p>Jim has six children, and it is not an easy bunch. Chris fights with Bob, 
</p>
<p>Faye, and Eve all the time; Eve fights (besides with Chris) with Al and 
</p>
<p>Di all the time; and Al and Bob fight all the time. Jim wants to put the 
</p>
<p>children in two rooms so that pairs of fighters should be in different rooms. 
</p>
<p>Can he do this? </p>
<p/>
</div>
<div class="page"><p/>
<p>200 13. Coloring Maps and Graphs 
</p>
<p>As in Chapter 7, the solution is much easier if we make a drawing of the 
</p>
<p>information we have. We construct a "fighting graph": We represent each 
</p>
<p>child by a node, and connect two nodes if these children fight all the time. 
</p>
<p>We get the graph in Figure 13.4(a). Jim's task is to split the nodes into 
</p>
<p>two groups so that every fighting pair is separated. A solution is shown in 
</p>
<p>part (b) of the figure. 
</p>
<p>A B 
</p>
<p>FD---+----... C 
</p>
<p>E 
</p>
<p>(a) 
</p>
<p>---D 
</p>
<p>A B 
</p>
<p>Fo--f'--&middot;C Fo---+----... C 
</p>
<p>E D E D 
</p>
<p>(b) (c) 
</p>
<p>FIGURE 13.4. The fight graph of Jim's children; how to put them in two rooms; 
</p>
<p>and how this translates to a 2-coloring. 
</p>
<p>Instead of redrawing the graph putting its nodes left and right, we can 
</p>
<p>indicate which child goes in which room by coloring the corresponding 
</p>
<p>node black or white. The rule of the coloring is that adjacent nodes must 
</p>
<p>be colored with different colors. Figure 13.4( c) shows the corresponding 
</p>
<p>coloring. Jim can put the children represented by white nodes in one room, 
</p>
<p>and the others (represented by black nodes) in the other. 
</p>
<p>Looking at Figure 13.4(b), we notice that we have already met such 
</p>
<p>graphs: we called them bipartite, since the vertex set of these graphs can 
</p>
<p>be split into two disjoint sets (or parts) such that edges go only between 
</p>
<p>vertices belonging to different sets. 
</p>
<p>The problem of coloring the regions formed by circles in the previous 
</p>
<p>section can also be stated as a problem on coloring the nodes of graphs 
</p>
<p>with 2 colors. We associate a graph with the regions formed by circles the 
</p>
<p>following way: Represent every region by a vertex of the graph. Two vertices 
</p>
<p>are connected by an edge in the graph if and only if the corresponding 
</p>
<p>regions share a common boundary arc (just sharing a point at a vertex 
</p>
<p>does not qualify). 
</p>
<p>Which graphs are 2-colorable (in other words, bipartite)? It is clear that 
</p>
<p>if a graph consists of isolated vertices, 1 color is enough to get a good 
</p>
<p>coloring. If the graph has at least one edge, then we need at least two 
</p>
<p>colors. It is easy to see that a triangle, the complete graph on 3 vertices, 
</p>
<p>needs 3 colors to be well colored. It is also obvious that if a graph contains 
</p>
<p>a triangle, then it needs at least 3 colors for a good coloring. 
</p>
<p>But a graph need not contain a triangle and may still not be 2-colorable. 
</p>
<p>A little more involved example is a pentagon: It is easy to convince ourselves 
</p>
<p>that no matter how we color its vertices with 2 colors, we'll necessarily end </p>
<p/>
</div>
<div class="page"><p/>
<p>13.2 Coloring Graphs with Two Colors 201 
</p>
<p>up with two adjacent vertices with the same color. We can generalize this 
</p>
<p>observation to any cycle of odd length: If we start coloring any node with 
</p>
<p>(say) black, then as we walk along the cycle we must color the next node 
</p>
<p>white, the third node black, and so on. We must alternate with colors black 
</p>
<p>and white. But because the cycle is odd, we return to the start node in the 
</p>
<p>wrong phase, ending up with coloring the last node black, and so having 
</p>
<p>two adjacent black nodes. 
</p>
<p>It follows that if a graph contains an odd cycle, then it cannot be 2-
</p>
<p>colorable. The following simple theorem asserts that nothing more compli-
</p>
<p>cated can go wrong: 
</p>
<p>Theorem 13.2.1 A graph is 2-colorable if and only if it contains no odd 
</p>
<p>cycle. 
</p>
<p>Proof. We already know the "only if" part of this theorem. To prove the 
</p>
<p>"if" part, suppose that our graph has no odd cycle. Pick any vertex a and 
</p>
<p>color it black. Color all its neighbors white. Notice that there cannot be an 
</p>
<p>edge connecting two neighbors of a, because this would give a triangle. Now 
</p>
<p>color every uncolored neighbor of these white vertices black. We have to 
</p>
<p>show that there is no edge between the black vertices: no edge goes between 
</p>
<p>u and the new black vertices, since the new black vertices didn't belong to 
</p>
<p>the neighbors of a; no edge can go between the new black vertices, because 
</p>
<p>it would give a cycle of length 3 or 5. Continuing this procedure the same 
</p>
<p>way, if our graph is connected, we'll end up with 2-coloring all vertices. 
</p>
<p>It is easy to argue that there is no edge between two vertices of the same 
</p>
<p>color: Suppose that this is not the case, so we have two adjacent vertices 
</p>
<p>u and v colored black (say). The node u is adjacent to a node Ul colored 
</p>
<p>earlier (which is white); this in turn is adjacent to a node U2 colored even 
</p>
<p>earlier (which is black); etc. This way we can pick a path P from U that 
</p>
<p>goes back all the way to the starting node. Similarly, we can pick a path 
</p>
<p>Q from v to the starting node. Starting from v, let's follow Q back until it 
first hits P, and then follow P forward to u. This path forms a cycle with 
</p>
<p>the edge uv. Since the nodes along the path alternate in color, but start 
</p>
<p>and end with black, this cycle is odd, a contradiction (Figure 13.5). 
</p>
<p>If the graph is connected, we are done: We have colored all vertices. 
</p>
<p>If our graph is not connected, we perform the same procedure in every 
</p>
<p>component, and obviously, this will give a good 2-coloring of the whole 
</p>
<p>graph. This proves Theorem 13.2.1. 0 
</p>
<p>It is worth pointing out that in the proof above we did not really have 
</p>
<p>much choice: We could choose the color of the starting node, but then our 
</p>
<p>hands were forced all the way through coloring the connected component 
</p>
<p>of that point. Then we had a free choice for the color of the first node of the 
</p>
<p>next component, but then the rest of the component was forced again. This 
</p>
<p>means that we not only proved Theorem 13.2.1, but also gave an algorithm 
</p>
<p>for finding a 2-coloring if it exists (and to find an odd cycle if it does not). </p>
<p/>
</div>
<div class="page"><p/>
<p>202 13. Coloring Maps and Graphs 
</p>
<p>u 
</p>
<p>a 
</p>
<p>FIGURE 13.5. Bad 2-coloring yields an odd cycle. 
</p>
<p>13.2.1 Prove that the graph obtained from the regions of a system of circles 
</p>
<p>contains no odd cycle. 
</p>
<p>13.3 Coloring graphs with many colors 
</p>
<p>Suppose that we have a graph, and we find that it cannot be colored with 
</p>
<p>two colors; we may want to color it with more colors. (The rule of the game 
</p>
<p>is the same: the two endpoints of any edge must be colored differently.) If we 
</p>
<p>have many colors, then we can just color every node with a different color. 
</p>
<p>If the graph has n nodes, then n colors are always sufficient. Obviously, if 
</p>
<p>the graph is complete, then we do need n colors, since every node must get 
</p>
<p>a different color (recall the Pigeonhole Principle!). 
</p>
<p>If we can color a graph with k colors, we say that the graph is k-colorable. 
</p>
<p>The smallest k for which the graph is k-colorable is called the chromatic 
</p>
<p>number of the graph. 
</p>
<p>Suppose that we want to use, say, only 3 colors. Can we decide whether 
</p>
<p>they are enough to color the nodes? It turns out that going from 2 colors 
</p>
<p>to 3 is a real jump in difficulty. 
</p>
<p>We can try to proceed as in the case of 2 colors. Let the 3 colors be 
</p>
<p>red, blue and green. We start with any node a, and color it red. This we 
</p>
<p>can do without loss of generality, since all colors play the same role. Then 
</p>
<p>we take a neighbor b of a, and color it blue (this is still no restriction of 
</p>
<p>generality). Now we proceed to another neighbor c of a. If c is connected 
</p>
<p>to b by an edge, then its color is forced to be green. But suppose that it 
</p>
<p>is not connected to b. Then we have two choices to color c, blue or green, 
</p>
<p>and these are not alike: It makes a difference whether band c have the 
</p>
<p>same color or not. So we make a choice and proceed. In the next step, we 
</p>
<p>may have to make a choice again, etc. If any of these choices turns out to 
</p>
<p>be wrong, we'll have to backtrack and try the other one. Eventually, if a 
</p>
<p>3-coloring is possible at all, we'll find it. </p>
<p/>
</div>
<div class="page"><p/>
<p>13.3 Coloring graphs with many colors 203 
</p>
<p>All this backtracking takes a lot of time. We don't give a rigorous analysis 
</p>
<p>here, just note that in general, we may have to go through both choices for 
</p>
<p>a large fraction (say, half) of the nodes, which will take time 2n/2. We have 
</p>
<p>seen that this number becomes astronomical for very moderate sizes of n. 
</p>
<p>But the jump in difficulty is not that this simple procedure takes so 
</p>
<p>long: the real trouble is that nothing substantially better is known! And 
</p>
<p>there are results in complexity theory (cf. Section 15.1) that suggest that 
</p>
<p>nothing substantially better can be designed at all. The situation is similar 
</p>
<p>for coloring with any number k of colors, once k &gt; 2. 
Suppose that we have a graph and we badly need to color it with k colors. 
</p>
<p>Are there at least some special cases when we can do so? One such case is 
</p>
<p>described in the following result, called Brooks's Theorem: 
</p>
<p>Theorem 13.3.1 If every node in a graph has degree at most d, then the 
</p>
<p>graph can be colored with d + 1 colors. 
</p>
<p>Of course, the condition given in Brooks's Theorem is only sufficient, 
</p>
<p>but not necessary: there are graphs in which some nodes, possibly even all 
</p>
<p>nodes have high degree, and the graph is colorable with 2 colors. 
</p>
<p>Proof. We give a proof using the Principle of Induction. We can start our 
</p>
<p>proof with small graphs. If the graph has less than d + 1 vertices, then it 
can be colored by d + 1 (or fewer) colors, since every vertex can be colored 
differently. Suppose that our theorem is true for any graph with fewer than 
</p>
<p>n vertices. Pick a point v of our graph G, and omit from G this vertex v 
</p>
<p>and the edges incident to it. The remaining graph G' has n - 1 vertices. 
Obviously every degree is at most d (omitting a vertex does not increase the 
</p>
<p>degrees), so G' can be colored by d + 1 colors, by the induction hypothesis. 
Since v has at most d neighbors, but we have d + 1 colors, there must be a 
color that does not occur among the neighbors of v. Coloring v with this 
</p>
<p>color, we get a coloring of G by d + 1 colors. This completes the induction. 
o 
</p>
<p>Brooks, in fact, proved more: With some simple exceptions, a graph 
</p>
<p>in which all nodes have degree at most d can be colored with d colors. 
</p>
<p>The exceptions can be described as follows. For d = 2, the graph has a 
connected component that is an odd cycle; for d &gt; 2, the graph has a 
connected component that is a complete graph with d + 1 nodes. The proof 
that these graphs are exceptions is easy; the proof that these are the only 
</p>
<p>exceptions is harder and not given in this book. 
</p>
<p>Returning to the situation where you want to k-color a graph, suppose 
</p>
<p>you find that Brooks's Theorem does not apply, and say a large number of 
</p>
<p>random trials to color the graph also fail, and you begin to suspect that no 
</p>
<p>k-coloring exists at all. How can you convince yourself that this is indeed 
</p>
<p>the case? One lucky break is if you find k + 1 nodes in the graph forming 
a complete subgraph. Obviously, this part of the graph needs k + 1 colors. </p>
<p/>
</div>
<div class="page"><p/>
<p>204 13. Coloring Maps and Graphs 
</p>
<p>Unfortunately, for every positive integer k there are graphs that contain 
</p>
<p>no such complete graph and yet they are not k-colorable. It may even 
</p>
<p>happen that a graph contains no triangle and it is not k-colorable. Figure 
</p>
<p>13.6 shows a graph that contains no complete graph with 4 vertices but 
</p>
<p>is not 3-colorable, and a more complicated graph that does not contain a 
</p>
<p>triangle but is not 3-colorable (see also Exercise 13.3.1). 
</p>
<p>On this sad note we leave the topic of coloring general graphs. 
</p>
<p>FIGURE 13.6. Two non-3-colorable graphs. 
</p>
<p>13.3.1 Prove that the graphs in Figure 13.6 are not 3-colorable. 
</p>
<p>13.3.2 Draw n lines in the plane such that no 3 of them go through the same 
</p>
<p>point. Prove that their intersection points can be colored with 3 colors so that 
</p>
<p>on every line, consecutive intersection points get different colors. 
</p>
<p>13.3.3 Let G be a connected graph such that all vertices but one have degree 
</p>
<p>at most d (one vertex may have degree larger than d). Prove that Gis (d + 1)-
colorable. 
</p>
<p>13.3.4 Prove that if every subgraph of G has a node of degree at most d, then 
</p>
<p>Gis (d + I)-colorable. 
</p>
<p>13.4 Map Coloring and the Four Color Theorem 
</p>
<p>We started this chapter by coloring the regions formed by a set of circles 
</p>
<p>in the plane. But when do we need to color drawings in the plane? Such 
</p>
<p>a task arises in cartography: It is a natural requirement to color maps in 
</p>
<p>such a way that neighboring countries (or counties) get different colors. In 
</p>
<p>the previous example we saw that in special cases (like maps derived from 
</p>
<p>circles), we may find "good" colorings of the maps in the previous sense, 
</p>
<p>using just two colors. "Real" maps are much more complicated configu-
</p>
<p>rations, so it is not surprising that they need more than two colors. It is 
</p>
<p>very easy to draw four countries so that any two of them have a common </p>
<p/>
</div>
<div class="page"><p/>
<p>13.4 Map Coloring and the Four Color Theorem 205 
</p>
<p>FIGURE 13.7. Four mutually neighboring countries 
</p>
<p>boundary, and so all four need different colors in a "good" coloring (see 
</p>
<p>Figure 13.7). 
</p>
<p>Now consider a "real-life" planar map, for instance the map of the states 
</p>
<p>of the continental US. We assume that each country (state) is connected 
</p>
<p>(consists of one piece). In school maps usually six colors are used, but four 
</p>
<p>colors are enough, as shown in Figure 13.8. 
</p>
<p>FIGURE 13.8. Coloring the states of the United States. 
</p>
<p>Would three colors be enough? One can easily see that the answer is 
</p>
<p>negative. Let's start to color our map with three colors, say red, blue, and 
</p>
<p>yellow (it does not make any difference which of the three colors we start 
</p>
<p>with); we have to prove that sooner or later we get stuck. Let's start by 
</p>
<p>coloring Nevada red. Then all the neighboring states can get only colors 
</p>
<p>blue or yellow. Let's color California blue (without loss of generality). Then 
</p>
<p>the next neighboring state clockwise, Oregon, is a common neighbor of both 
</p>
<p>Nevada and California, so it must be colored yellow; the next state, Idaho, 
</p>
<p>must be blue again; the next state, Utah, must be yellow. But now we 
</p>
<p>are stuck, because the last state among the neighbors of Nevada, Arizona, </p>
<p/>
</div>
<div class="page"><p/>
<p>206 13. Coloring Maps and Graphs 
</p>
<p>cannot get any of the three colors red, blue, or yellow, so we must use a 
</p>
<p>fourth color (see Figure 13.8). 
</p>
<p>It is not by accident that in two different cases to color a map we needed 
</p>
<p>four colors, but four colors were enough. It is a theorem that to color any 
</p>
<p>planar map, four colors always suffice. 
</p>
<p>This famous theorem has a history well over a century old. It was raised 
</p>
<p>by Francis Guthrie in England in 1852. For decades it was kicked around 
</p>
<p>by mathematicians as a simple but elusive puzzle, until the difficulties in 
</p>
<p>obtaining a proof became apparent in the 1870s. An erroneous proof was 
</p>
<p>published in 1879 by Alfred Kempe , and the problem was regarded as 
</p>
<p>solved for a good decade before the error was discovered. The difficulty 
</p>
<p>of the problem was overlooked to the degree that in 1886 it was posed at 
</p>
<p>Clifton College as a challenge problem to students; part of the requirement 
</p>
<p>was that "No solution may exceed one page, 30 lines of MS., and one page 
</p>
<p>of diagrams." (The real solution 90 years later used more than 1000 hours 
</p>
<p>of CPU time!) 
</p>
<p>After the collapse of Kempe's proof, for more than a century many math-
</p>
<p>ematicians, amateur and professional, tried in vain to solve this intriguing 
</p>
<p>question, called the Four Color Conjecture. Several further erroneous proofs 
</p>
<p>were published and the refuted. 
</p>
<p>A whole new area of mathematics, graph theory, grew out of attempts to 
</p>
<p>prove the Four Color Conjecture. Finally, in 1976 events took a surprising 
</p>
<p>turn: Kenneth Appel and Wolfgang Haken gave a proof of the Four Color 
</p>
<p>Conjecture (which is therefore the Four Color Theorem now), but their 
</p>
<p>proof used computers very heavily to check an enormous number of cases. 
</p>
<p>Even today, the use of computers could not be eliminated from the proof 
</p>
<p>(although nowadays it takes much less time than the first proof, partly 
</p>
<p>because computers are faster, partly because a better arrangement of the 
</p>
<p>case distinction was found); we still don't have a "pure" mathematical proof 
</p>
<p>of this theorem. 
</p>
<p>It is beyond the scope of this book even to sketch this proof; but we can 
</p>
<p>use the results about graphs that we have learned to prove the weaker fact 
</p>
<p>that 5 colors suffice to color every planar map. 
</p>
<p>We can transform this to a graph coloring problem. In each country we 
</p>
<p>pick a point; let's call this the capital of the country. Now, if two countries 
</p>
<p>share a border, then we can connect their capitals by a railway line that 
</p>
<p>stays in the two countries and crosses the border only once. Furthermore, 
</p>
<p>we can design these lines so that the lines from any capital to various points 
</p>
<p>on the border of the country (going on to capitals of adjacent countries) 
</p>
<p>do not cross each other. Then the capitals and the lines connecting them 
</p>
<p>form a graph, which also is planar. This graph is called the dual graph of 
</p>
<p>the original map (Figure 13.9). 
</p>
<p>A word here to make things precise: It could happen that the common 
</p>
<p>border of two countries consists of several pieces. (For example, in our 
</p>
<p>world the border of China and Russia consists of two pieces, separated by </p>
<p/>
</div>
<div class="page"><p/>
<p>13.4 Map Coloring and the Four Color Theorem 207 
</p>
<p>" . 
</p>
<p>.... 
</p>
<p>FIGURE 13.9. A graph and its dual 
</p>
<p>Mongolia.) For the purpose of studying colorings, it suffices to connect the 
</p>
<p>capitals of these two countries by one line only, through either one of these 
</p>
<p>pieces of their common border. 
</p>
<p>There is another graph in the picture, consisting of the borders between 
</p>
<p>countries. The nodes of this graph are the "triangles," points where three 
</p>
<p>or more countries meet. But we have to be careful: This "graph" may have 
</p>
<p>two or more edges connecting the same pair of nodes! So this is an example 
</p>
<p>where we need multigraphs to model the situation correctly. We don't need 
</p>
<p>to bother about this, however: we can just talk about a planar map and its 
</p>
<p>dual graph. 
</p>
<p>Instead of coloring the countries of the original map, we could color the 
</p>
<p>nodes of its dual graph: Then the rules of the game would be that two 
</p>
<p>nodes connected by an edge must be colored with different colors. In other 
</p>
<p>words, this is graph coloring as defined in Section 13.3. So we can rephrase 
</p>
<p>the Four Color Theorem as follows: 
</p>
<p>Theorem 13.4.1 Every planar graph can be colored with 4 colors. 
</p>
<p>Our more modest goal is to prove the "Five Color Theorem" : 
</p>
<p>Theorem 13.4.2 Every planar graph can be colored with 5 colors. 
</p>
<p>Let us start with something even more modest: 
</p>
<p>Every planar graph can be colored with 6 colors. 
</p>
<p>(7 colors or 8 colors would be even more modest, but would not be any 
</p>
<p>easier. ) 
</p>
<p>Let us look at what we already know about graph coloring; is any of it 
</p>
<p>applicable here? Do we know any condition that guarantees that the graph 
</p>
<p>is 6-colorable? One such condition is that all points in a graph have degree 
</p>
<p>at most 5 (Theorem 13.3.1). This result is not applicable here, though, </p>
<p/>
</div>
<div class="page"><p/>
<p>208 13. Coloring Maps and Graphs 
</p>
<p>because a planar graph can have points of degree higher than 5 (the "dual" 
</p>
<p>graph in Figure 13.9 has a point of degree 7, for example). But if you solved 
</p>
<p>the exercises, you may recall that we don't have to assume that all nodes 
</p>
<p>of the graph have degree at most 5. The same procedure as used in the 
</p>
<p>proof of Theorem 13.3.1 gives a 6-coloring if we know that the graph has 
</p>
<p>at least one point of degree 5 or less, and so do all its subgraphs (Exercise 
</p>
<p>13.3.4). Is this condition applicable here? 
</p>
<p>The answer is yes: 
</p>
<p>Lemma 13.4.3 Every planar graph has a point of degree at most 5. 
</p>
<p>Proof. This lemma follows from Euler's Formula. In fact, we only need a 
</p>
<p>consequence of Euler's Formula, namely, Theorem 12.2.2: A planar graph 
</p>
<p>with n nodes has at most 3n - 6 edges. 
</p>
<p>Assume that our graph violates Lemma 13.4.3, and so every node has 
</p>
<p>degree at least 6. Then counting the edges node by node, we count at least 
</p>
<p>6n edges. Each edge is counted twice, so the number of edges is at least 3n, 
</p>
<p>contradicting Theorem 12.2.2. 0 
</p>
<p>Since the subgraphs of a planar graph are planar as well, it follows that 
</p>
<p>they too have a point of degree at most 5, and so Exercise 13.3.4 can be 
</p>
<p>applied, and we get that every planar graph is 6-colorable. 
</p>
<p>So we have proved the "Six Color Theorem." We want to shave off 1 
</p>
<p>color from this result (how nice it would be to shave off 2!). For this, we 
</p>
<p>use the same procedure of coloring points one by one again, together with 
</p>
<p>Lemma 13.4.3; but we have to look at the procedure more carefully. 
</p>
<p>Proof [of the Five Color Theorem]. So, we have a planar graph with n 
</p>
<p>nodes. We use induction on the number of nodes, so we assume that planar 
</p>
<p>graphs with fewer than n nodes are 5-colorable. We also know that our 
</p>
<p>graph has a node v with degree at most 5. 
</p>
<p>If v has degree 4 or less, then the argument is easy: Let us delete v from 
</p>
<p>the graph, and color the remaining graph with 5 colors (which is possible 
</p>
<p>by the induction hypothesis, since this is a planar graph with fewer nodes). 
</p>
<p>The node v has at most 4 neighbors, so we can find a color for v that is 
</p>
<p>different from the colors of its neighbors, and extend the coloring to v. 
</p>
<p>So the only difficult case occurs when the degree of v is exactly 5. Let 
</p>
<p>u and w be two neighbors of v. Instead of just deleting v, we change the 
</p>
<p>graph a bit more: We use the place freed up by the deletion of v to merge 
</p>
<p>u and w to a single point, which we call uw. Every edge that entered either 
</p>
<p>u or w will be redirected to the new node uw (Figure 13.10). 
</p>
<p>This modified graph is planar and has fewer nodes, so it can be colored 
</p>
<p>with 5 colors by the induction hypothesis. If we pull the two points u and w 
</p>
<p>apart again, we get a coloring of all nodes of G except v with 5 colors. What 
</p>
<p>we gained by this trick of merging u and w is that in this coloring they 
</p>
<p>have the same color! So even though v has 5 neighbors, two of those have </p>
<p/>
</div>
<div class="page"><p/>
<p>13.4 Map Coloring and the Four Color Theorem 209 
</p>
<p>FIGURE 13.10. Proof of the 5-color theorem. 
</p>
<p>the same color, so one of the 5 colors does not occur among the neighbors 
</p>
<p>at all. We can use this color as the color of v, completing the proof. 
</p>
<p>Warning! We have overlooked a difficulty here. (You can see how easy it 
</p>
<p>is to make errors in these kinds of arguments!) When we merged u and w, 
</p>
<p>two bad things could have happened: (a) u and w were connected by an 
</p>
<p>edge, which after the merging became an edge connecting a node to itself; 
</p>
<p>(b) there could have been a third node p connected to both u and w, which 
</p>
<p>after the merging became a node connected to uw by two edges. We did 
</p>
<p>not allow for either of these! 
</p>
<p>The second trouble (b) is in fact no trouble at all. If we get two edges 
</p>
<p>connecting the same pair of nodes, we could just ignore one of them. The 
</p>
<p>graph remains planar, and in the 5-coloring the color of p would be different 
</p>
<p>from the common color of u and w, so when we pull them apart, both edges 
</p>
<p>connecting p to u and w would connect nodes with different color. 
</p>
<p>But the first trouble (a) is serious. We cannot just ignore the edge con-
</p>
<p>necting uw to itself; in fact, there is no way that u and w can get the same 
</p>
<p>color in the final coloring, since they are connected by an edge! 
</p>
<p>What comes to the rescue is the fact that we can choose another pair 
</p>
<p>u, w of neighbors of v. Could it happen that we have this problem with 
</p>
<p>every pair? No, because then every pair of neighbors would be adjacent, 
</p>
<p>and this would mean a complete graph with 5 nodes, which we know is not 
</p>
<p>planar. So we can find at least one pair u and w for which the procedure 
</p>
<p>above works. This completes the proof of the Five Color Theorem. D 
</p>
<p>Review Exercises 
</p>
<p>13.4.1 We draw a closed curve in the plane without lifting the pencil, inter-
</p>
<p>secting itself several times (Figure 13.11). Prove the fact (familiar from boring 
</p>
<p>classes) that the regions formed by this curve can be colored with 2 colors. </p>
<p/>
</div>
<div class="page"><p/>
<p>210 13. Coloring Maps and Graphs 
</p>
<p>FIGURE 13.11. 2-coloring the regions of a curve 
</p>
<p>13.4.2 Let G be a connected graph such that all vertices have degree at most 
</p>
<p>d, and there exists vertex with degree strictly less than d. Prove that G is d-
</p>
<p>colorable. 
</p>
<p>13.4.3 Let G be a connected graph such that all vertices but d + 1 have degree 
at most d (the remaining d + 1 vertices may have degree larger than d). Prove 
that G is (d + 1 )-colorable. 
</p>
<p>13.4.4 Construct a graph G as follows: The vertices of G are the edges of a 
</p>
<p>complete graph Ks on 5 vertices. The vertices of G are adjacent if and only 
</p>
<p>if the corresponding edges of Ks have an endpoint in common. Determine the 
</p>
<p>chromatic number of this graph. 
</p>
<p>13.4.5 Let Gn be the graph arising from Kn (where Kn is the complete graph on 
</p>
<p>n vertices) by omitting the edges of a Hamiltonian cycle. Determine the chromatic 
</p>
<p>number of Gn . 
</p>
<p>13.4.6 Show by an example that on a continent where countries are not neces-
</p>
<p>sarily connected (as in medieval Europe), 100 colors may not be enough to color 
</p>
<p>a map. 
</p>
<p>13.4.7 If every face of a planar map has an even number of edges, then the 
</p>
<p>graph is bipartite. 
</p>
<p>13.4.8 If every node of a planar map has even degree, then the faces can be 
</p>
<p>2-colored. 
</p>
<p>13.4.9 (a) Consider a planar map in which every node has degree 3. Suppose 
</p>
<p>that the faces can be 3-colored. Prove that the graph of the map is bipartite. 
</p>
<p>(b) [A challenge exercise.] Prove the converse: If every node of a bipartite 
</p>
<p>planar graph has degree 3, then in the map obtained by drawing it in the plane, 
</p>
<p>the faces can be 3-colored. </p>
<p/>
</div>
<div class="page"><p/>
<p>14 
</p>
<p>Finite Geometries, Codes, 
Latin Squares, 
and Other Pretty Creatures 
</p>
<p>14.1 Small Exotic Worlds 
</p>
<p>The Fano plane is a really small world (Figure 14.1). It only has 7 points, 
</p>
<p>which form 7 lines. In the figure, 6 of these lines are straight and one 
</p>
<p>is circular; but for the inhabitants of this tiny world (the Fanoans), the 
</p>
<p>straight and curved lines look the same. Also, in our figure it seems that the 
</p>
<p>circular line intersects some of the straight lines twice; but the intersection 
</p>
<p>points that are not marked are not real intersection points, they are there 
</p>
<p>only because we want to draw a picture of this very different world in our 
</p>
<p>Euclidean plane. 
</p>
<p>FIGURE 14.1. The Fano plane. 
</p>
<p>The Fanoans are very proud of their world. They say that it is tiny but 
</p>
<p>perfect in various ways. They point out that 
</p>
<p>(a) through any two points their world has a unique line. </p>
<p/>
</div>
<div class="page"><p/>
<p>212 14. Finite Geometries, Codes,Latin Squares, and Other Pretty Creatures 
</p>
<p>If you check this out and admit it's true, but reply that this also holds in 
</p>
<p>our own world, they go on and boast that 
</p>
<p>(b) any two lines have exactly one intersection point. 
</p>
<p>This is certainly not true in our Euclidean world (we have paraUellines), so 
</p>
<p>we have to admit that this is nice indeed. But then we can draw a new figure 
</p>
<p>(Figure 14.2) and point out that this rather uninteresting construction also 
</p>
<p>has properties (a) and (b). But the Fanoans are ready for this attack: "It 
would be enough if we pointed out that in our world, 
</p>
<p>( c) every line has at least 3 points. " 
</p>
<p>FIGURE 14.2. An ugly plane 
</p>
<p>Our Fanoan friend goes on: "Theoretical physicists have shown that just 
</p>
<p>from (a), (b), and (c), many properties of our world can be derived. For 
</p>
<p>example, 
</p>
<p>(d) all our lines have the same number of points. 
</p>
<p>"Indeed, let K and L be two lines. By (b), they have an intersection 
</p>
<p>point p; by (c), they contain other points (at least two, but we only need 
</p>
<p>one right now). Let us select a point q from K and a point r from L that 
</p>
<p>are both different from p. By (a), there is a line M through q and r. Let s 
</p>
<p>be a third point on M (which exists by (c); see Figure 14.3). 
</p>
<p>K 
q 
</p>
<p>p x l r L 
</p>
<p>FIGURE 14.3. All lines have the same number of points. 
</p>
<p>"Consider any point x on K, and connect it to s. This line intersects 
</p>
<p>L at a point x' (we can think of this as projecting K onto L from center 
</p>
<p>s). Conversely, given x', we get x by the same construction. Thus this 
</p>
<p>projection establishes a bijection between K and L, and so they have the 
</p>
<p>same number of points. 
</p>
<p>"This argument also shows that </p>
<p/>
</div>
<div class="page"><p/>
<p>14.1 Small Exotic Worlds 213 
</p>
<p>(e) all our points have the same number of lines through them. 
</p>
<p>"No doubt you can prove this yourself, if you study the previous argument 
</p>
<p>carefully. " 
</p>
<p>Our intelligent Fanoan friend adds, "These theoretical physicists (obvi-
</p>
<p>ously having a lot of time on their hands) also determined that the fact that 
</p>
<p>the number of points on each line is 3 does not follow from (a), (b), and 
</p>
<p>(c); they say that alternative universes can exist with 4, 5 or 6 points on a 
</p>
<p>line. Imagining this is beyond me, though! But they say that no universe 
</p>
<p>could have 7 points on a line; there could be universes with 8, 9, and 10 
</p>
<p>points on each line, but 11 points are impossible again. This is, of course, 
</p>
<p>a favorite topic for our science fiction writers." 
</p>
<p>The Fanoans hate Figure 14.2 for another reason: they are true egalitar-
</p>
<p>ians, and the fact that one point is special is intolerable in their society. 
</p>
<p>You may raise here that the Fano plane also has a special point, the one 
</p>
<p>in the middle. But they immediately explain that this is again an artifact 
</p>
<p>of our drawing. "In our world, 
</p>
<p>(f) all points and all lines are alike 
</p>
<p>in the sense that if we pick any two points (or two lines), we can just rename 
</p>
<p>every point so that one of them becomes the other, and nobody will notice 
</p>
<p>the difference." You may trust them about this, or you may verify this 
</p>
<p>claim by solving exercise 14.1.7. 
</p>
<p>Let us leave the Fano plane now and visit a larger world, the Tictactoe 
</p>
<p>plane. This has 9 points and 12 lines (Figure 14.4). We have learned from 
</p>
<p>our excursion to the Fano plane that we have to be careful with drawing 
</p>
<p>these strange worlds, and so we have drawn it in two ways: In the second 
</p>
<p>figure, the first two columns are repeated, so that the two families of lines 
</p>
<p>(one leaning right, one leaning left) can be seen better. 1 
</p>
<p>The Tictacs boast that they have a much more interesting world than 
</p>
<p>the Fanoans. It is still true that any two points determine a single line; but 
</p>
<p>two lines may be intersecting or parallel (which simply means that they 
</p>
<p>don't intersect). One of our Tictac friends explains: "I heard that your 
</p>
<p>mathematicians have been long concerned about the statement that 
</p>
<p>(g) for any line and any point not on the line, there is one and only one 
line that goes through the point and is parallel to the given line. 
</p>
<p>They called it the Axiom of Parallels or Euclid's Fifth Postulate. They were 
</p>
<p>trying to prove it from other basic properties of your world, until eventually 
</p>
<p>1 If you have learned about matrices and determinants, you may recognize the follow-
</p>
<p>ing description of this world: if we think of the points in this plane as the entries of a 
</p>
<p>3 x 3 matrix, then the lines are the rows and columns of the matrix and expansion terms 
</p>
<p>of its determinant. The second drawing in the figure corresponds to Sarrus's Rule in the 
</p>
<p>theory of determinants. </p>
<p/>
</div>
<div class="page"><p/>
<p>214 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>FIGURE 14.4. The Tictactoe plane. 
</p>
<p>they showed that this cannot be done. Well, this is true in our world, and 
</p>
<p>since our world is finite, it is easy to check that it is true." (We hope our 
</p>
<p>readers will accept the challenge.) 
</p>
<p>"We have 3 points on each line just as in the Fano plane, but we have 
</p>
<p>4 lines through each point-more than those Fanoans. All of our points 
</p>
<p>are alike, and so are all of our lines (even though the way you draw them 
</p>
<p>in your own geometry seems to differentiate between straight and curved 
</p>
<p>lines )." 
</p>
<p>FIGURE 14.5. Extending the Tictactoe plane by 1 line and 4 points at infinity. 
</p>
<p>When we point out how the Fanoans love their property (b) , our Tictac 
</p>
<p>guide replies, "We could easily achieve this ourselves. All we'd have to do 
</p>
<p>is add 4 new points to our plane. Each line should go through exactly one 
</p>
<p>of these new points; parallel lines should go through the same new point, 
</p>
<p>nonparallel lines through different new points. And we could even things 
</p>
<p>out by declaring that the 4 new points also form a line. We could call the 
</p>
<p>new points 'points at infinity ' and the new line, the 'line at infinity ' (Figure </p>
<p/>
</div>
<div class="page"><p/>
<p>14.1 Small Exotic Worlds 215 
</p>
<p>14.5). Then we would have properties (a) through (g) ourselves.2 But we 
</p>
<p>prefer to distinguish between finite and infinite points, which makes our 
</p>
<p>world more interesting." 
</p>
<p>FIGURE 14.6. The Cube space. 
</p>
<p>Finally, we visit a third tiny world called the Cube space (Figure 14.6). 
</p>
<p>While this one has only 8 points, it is much richer than the Tictactoe plane 
</p>
<p>in one sense: It is 3-dimensional! Its lines are uninteresting: Every line has 
</p>
<p>just 2 points, and any two points form a line. But it has planes! In our 
</p>
<p>(deficient) Euclidean picture, the points are arranged as the vertices of a 
</p>
<p>cube. The planes are (1) 4-tuples of points forming a face of the cube (there 
</p>
<p>are six of these), (2) 4-tuples of points on two opposite edges of the cube 
</p>
<p>(6 of these again), (3) the four black points, and (4) the four light points. 
</p>
<p>The Cube space has the following very nice properties (whose verification 
</p>
<p>is left to the reader): 
</p>
<p>(A) Any three points determine a unique plane. 
</p>
<p>(The Cubics remark at this point, "In your world, this is only true if 
</p>
<p>the three points are not on a line. Luckily, we never have three points on a 
</p>
<p>line!" ) 
</p>
<p>(B) Any two planes are either parallel (nonintersecting), or their inter-
section is a line. 
</p>
<p>(C) For any plane and any point outside it, there is exactly one plane 
through the given point parallel to the given plane. 
</p>
<p>(D) Any two points are alike. 
</p>
<p>(E) Any two planes are alike. 
</p>
<p>This last claim looks so unlikely, considering that we have such different 
</p>
<p>kinds of planes, that a proof is in order. Let us label the points of the cube 
</p>
<p>by A, ... , H as in Figure 14.7. It is clear that the faces of the cube are alike 
</p>
<p>2This construction appending new points at infinity can be carried out in our own 
</p>
<p>Euclidean plane, leading to an interesting kind of geometry, called projective geometry. </p>
<p/>
</div>
<div class="page"><p/>
<p>216 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>(one can be moved onto any other by appropriately rotating the cube, and 
</p>
<p>this rotation maps all the other planes onto planes). It is also clear that 
</p>
<p>the planes formed by two opposite edges are alike, and the all-black plane 
</p>
<p>is like the all-light plane (reflecting the cube in its center will interchange 
</p>
<p>black and light vertices). 
</p>
<p>This was the easy part. Now we do a trickier transformation: We in-
</p>
<p>terchange E with F and G with H (Figure 14.7). What happens to the 
</p>
<p>planes? 
</p>
<p>A 
</p>
<p>H 
</p>
<p>o 
&middot;D 
</p>
<p>G 
</p>
<p>B 
</p>
<p>G H 
</p>
<p>F 
</p>
<p>A B 
</p>
<p>FIGURE 14.7. Why different-looking planes are alike. 
</p>
<p>Some of them are not changed (even though their points will change 
</p>
<p>places): The top, bottom, front , and back faces and the planes ABGH and 
</p>
<p>GDEF are mapped onto themselves. The left face ADEH is mapped onto 
</p>
<p>the plane ADFG, and vice versa. Similarly, the right face BGFG is mapped 
</p>
<p>onto the plane BGEH, and vice versa. The all-black plane is mapped onto 
</p>
<p>the plane AGEG, and vice versa. The all-light plane is mapped onto the 
</p>
<p>plane BDF H , and vice versa. 
</p>
<p>Thus all planes are accounted for. We make two observations: 
</p>
<p>Every plane is mapped onto a plane, and so if we relabel the cube as 
</p>
<p>above, the Cubics won't notice the difference! 
</p>
<p>- There is a face-plane mapped onto an opposite-edge-plane, and there 
</p>
<p>is an opposite-edge-plane mapped onto the all-black plane. This im-
</p>
<p>plies that the Cubics cannot see any difference between these three 
</p>
<p>types of planes. 
</p>
<p>14.1.1 Fanoan philosophers have long been troubled by the difference between 
</p>
<p>points and lines. There are many similarities (for example, there are 7 of each); 
</p>
<p>why are they different? Represent each line by a new point; for each old point, 
</p>
<p>take the 3 lines through it, and connect the 3 new points representing them by a 
</p>
<p>(new) line. What structure do you get? 
</p>
<p>14.1.2 The Fanoans call a set of 3 points a circle if they are not on a line. For 
</p>
<p>example, the 3 vertices in figure 14.1 form a circle. They call a line a tangent to </p>
<p/>
</div>
<div class="page"><p/>
<p>14.2 Finite Affine and Projective Planes 217 
</p>
<p>the circle, if it contains exactly one point of the circle. Show that at every point 
</p>
<p>of a circle there is exactly one tangent. 
</p>
<p>14.1.3 The Fanoans call a set of 4 points a hypercircle if no 3 of them are a 
</p>
<p>line. Prove that the 3 points not on a hypercircle form a line, and vice versa. 
</p>
<p>14.1.4 Representatives of the 7 points in the Fano plane often vote on different 
</p>
<p>issues. In votes where everyone has to vote yes or no, they have a strange rule to 
</p>
<p>count ballots, however: it is not the majority who wins, but "line wins": if all 3 
</p>
<p>points on a line want something, then this is so decided. Show that (a) it cannot 
</p>
<p>happen that contradictory decisions are reached because the points on another 
</p>
<p>line want the opposite, and (b) in every issue there is a line whose points want 
</p>
<p>the same, and so decision is reached. 
</p>
<p>14.1.5 Prove that the Tictactoe plane, extended with elements at infinity, sat-
</p>
<p>isfies all properties (a )~( d). 
</p>
<p>14.1.6 In response to the Tictacs' explanation about how they could extend 
</p>
<p>their world with infinite elements, the Fanoans decided to declare one of their 
</p>
<p>lines the "line at infinity," and the points on this line "points at infinity." The 
</p>
<p>remaining 4 points and 6 lines form a really tiny plane. Will property (g) of 
</p>
<p>parallel lines be valid in this geometry? 
</p>
<p>14.1. 7 We want to verify the claim of the Fanoans that all their points are alike, 
</p>
<p>and rearrange the points of the Fano plane so that the middle point becomes (say) 
</p>
<p>the top point, but lines remain lines. Describe a way to do this. 
</p>
<p>14.1.8 Every point of the Cube space is contained in 7 lines and 7 planes. Is 
</p>
<p>this numerical similarity with the Fano plane a coincidence? 
</p>
<p>14.2 Finite Affine and Projective Planes 
</p>
<p>It is time to leave our excursion to imaginary worlds and introduce math-
</p>
<p>ematical names for the structures we studied above. If we have a finite set 
</p>
<p>V whose elements are called points, and some of its subsets are called lines, 
</p>
<p>and (a), (b), and (c) above are satisfied, then we call it a finite projective 
</p>
<p>plane. The Fano plane (named after the Italian mathematician Gino Fano) 
</p>
<p>is one projective plane (we'll see that it has the least possible number, 
</p>
<p>7, of points), and another one was constructed by the Tictac theoretical 
</p>
<p>physicists by adding to their world 4 points and a line at infinity. 
</p>
<p>We have heard the proof from Fanoan scientists that every line in a finite 
</p>
<p>projective plane has the same number of points; for reasons that should 
</p>
<p>become clear soon, this number is denoted by n + 1, where the positive 
integer n is called the order of the plane. So the Fano plane has order 2, 
</p>
<p>and the extended Tictactoe plane has order 3. The Fanoans also know that </p>
<p/>
</div>
<div class="page"><p/>
<p>218 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>if a finite projective plane has order n, then n + 1 lines go through every 
point of it. 
</p>
<p>14.2.1 Prove that a finite projective plane of order n has n 2 + n + 1 points and 
n 2 + n + 1 lines. 
</p>
<p>We can also study structures consisting of points and lines, where (a) 
</p>
<p>and the "Axiom of Parallels" (g) are assumed; to exclude trivial (ugly?) 
</p>
<p>examples, we assume that each line has at least 2 points. Such a structure 
</p>
<p>is called a finite affine plane. 
</p>
<p>The "Axiom of Parallels" implies that all lines parallel to a given line L 
</p>
<p>are also parallel to each other (if two of them had a point p in common, 
</p>
<p>then we would have two lines through p parallel to L). So all lines parallel 
to L form a "parallel class" of mutually parallel lines, which cover every 
</p>
<p>point in the affine plane. 
</p>
<p>Affine versus projective planes. The construction used by the Tictacs 
</p>
<p>to extend their plane can be used in general. To every parallel class of lines 
</p>
<p>we append a new "point at infinity" and create a new "line at infinity" going 
</p>
<p>through all points at infinity. Then (a) remains satisfied: Two "ordinary" 
</p>
<p>points are still connected by a line (the same line as before), two "infinite" 
</p>
<p>points are connected by a line (the "infinite" line), and an ordinary and an 
</p>
<p>infinite point are connected by a line (the parallel class belonging to the 
</p>
<p>infinite point contains a line through the given ordinary point). It is even 
</p>
<p>easier to see that we do not have two lines through any pair of points. 
</p>
<p>Furthermore, (b) is satisfied: Two ordinary lines intersect each other 
</p>
<p>unless they are parallel, in which case they share a point at infinity; an 
</p>
<p>ordinary line intersects the infinite line at its point at infinity. We leave it 
</p>
<p>to you to check (c), (d), and (e) (condition (f) does not hold for every finite 
</p>
<p>projective plane; it is a special feature of the Fano plane and some other 
</p>
<p>projective planes). 
</p>
<p>The construction in Exercise 14.1.6 is again quite general. We can take 
</p>
<p>any finite projective plane, and call any of its lines along with the points 
</p>
<p>on this line "infinite." The remaining points and lines form a finite affine 
</p>
<p>plane. So in spite of the rivalry between the Fanoans and Tictacs, finite 
</p>
<p>affine planes and projective planes are essentially the same structures. 
</p>
<p>To sum up, we have the following theorem. 
</p>
<p>Theorem 14.2.1 Every finite affine plane can be extended to a finite pro-
</p>
<p>jective plane by adding new points and a single new line. Conversely, from 
</p>
<p>every projective plane we can construct an affine plane by deleting any line 
</p>
<p>and its points. 
</p>
<p>A projective plane of order n has n + 1 points on each line; the corre-
sponding affine plane has n. We call this number the order of the affine 
</p>
<p>plane. (So this turns out to be more natural for affine planes than for pro-
</p>
<p>jective planes. We'll see soon why we chose the number of points on a line </p>
<p/>
</div>
<div class="page"><p/>
<p>14.2 Finite Affine and Projective Planes 219 
</p>
<p>of the affine plane, rather than on a line of the projective plane, to be called 
</p>
<p>the order.) 
</p>
<p>We have seen (Exercise 14.2.1) that the projective plane has n 2 + n + 1 
points. To get the affine plane, we delete the n + 1 points on a line, so the 
affine plane has n 2 points. 
</p>
<p>Coordinates. We have discussed two finite planes (affine or projective; we 
</p>
<p>know it does not matter much): the Fano and the Tictactoe planes. Are 
</p>
<p>there any others? 
</p>
<p>Coordinate geometry gives the solution: Just as we can describe the Eu-
</p>
<p>clidean plane using real coordinates, we can describe finite affine planes us-
</p>
<p>ing the strange arithmetic of prime fields from Section 6.8. Let us fix a prime 
</p>
<p>p, and consider the "numbers" (elements of the prime field) 0, T, ... ,p - 1. 
In the Euclidean plane, every point has two coordinates, so let's do the 
</p>
<p>same here: Let the points of the plane be all pairs (u, v). This gives us p2 
points. 
</p>
<p>We have to define the lines. In the Euclidean plane, these are given by 
</p>
<p>linear equations, so let's do the same here: For every equation 
</p>
<p>ax + by = c, 
</p>
<p>we take the set of all pairs (u, v) for which x = u, y = v satisfies the 
equation, and introduce a line containing all these points. To be precise, 
</p>
<p>we have to assume that the above equation is proper, in the sense that at 
</p>
<p>least one of a and b is different from 0. 
N ow we have to verify that (a) through any two points there is exactly 
</p>
<p>one line, (b) for any line and any point outside it, there is exactly one line 
</p>
<p>through the point that is parallel to the line, and (c) there are at least 2 
</p>
<p>points on each line. We'll not go through this proof, which is not difficult, 
</p>
<p>but lengthy. It is more important to realize that all this works because it 
</p>
<p>works in the Euclidean plane, and we can do arithmetic in prime fields just 
</p>
<p>as with real numbers. 
</p>
<p>This construction provides an affine plane for every prime order (from 
</p>
<p>this we can construct a projective plane for every prime order). Let's see 
</p>
<p>what we get from the smallest prime field, the 2-element field. This will 
</p>
<p>have 22 = 4 points, given by the four pairs (0,0), (0, 1), (1,0), (1, 1). The 
lines will be given by linear equations, of which there are six: x = 0, x = 1, 
y = 0, y = 1, x + y = 0, x + y = 1. Each of these lines goes through 2 
points; for example, y = 1 goes through (0,1) and (1,1), and x+y = &deg; goes 
through (0,0) and (1,1). So we get the very trivial affine plane (already 
</p>
<p>familiar from Exercise 14.1. 6) consisting of 4 points and 6 lines. If we extend 
</p>
<p>this to a projective plane, we get the Fano plane. 
</p>
<p>Figure 14.8 shows the affine plane of order 5 obtained this way (we don't 
</p>
<p>show all the lines; there are too many). 
</p>
<p>14.2.2 Show that the Cube space can be obtained by 3-dimensional coordinate 
</p>
<p>geometry from the 2-element field. </p>
<p/>
</div>
<div class="page"><p/>
<p>220 14. Finite Geometries, Codes ,Latin Squares,and Other Pretty Creatures 
</p>
<p>(0,4) (2,4) 
rr--~r)--- ~ ~ --~ 
</p>
<p>(0, 2) .----{)------o&gt;--+--o---o 
</p>
<p>2x+3y=1 
</p>
<p>(0 0) (3,0) (4, 0) 
</p>
<p>FIGURE 14.8. An affine plane of order 5. Only one line is shown besides the 
</p>
<p>trivial "vertical" and "horizontal" lines. 
</p>
<p>What are the possible orders of planes? The construction with coor-
</p>
<p>dinates above shows that for every prime number there is a finite affine (or 
</p>
<p>projective) plane of that order. Using similar but more involved algebra, 
</p>
<p>one can construct projective planes for every order that is a higher power 
</p>
<p>of a prime number (so for 4, 8, 9 etc.) 
</p>
<p>Theorem 14.2.2 For every order that is a power of a prime (including 
</p>
<p>the primes themselves) there is a finite affine (as well as a finite projective) 
</p>
<p>plane of that order. 
</p>
<p>The smallest positive integer that is not a prime power is 6, and Gaston 
</p>
<p>Tarry proved in 1901 that no finite plane of order 6 exists. The next one is 
</p>
<p>10; the nonexistence of a finite projective plane of order 10 was proved in 
</p>
<p>1988 by Lam, Thiel and Swiercz based on an extensive use of computers. 
</p>
<p>Nobody has ever found a projective plane whose order is not a prime power, 
</p>
<p>but the question whether such a plane exists is unsolved. 
</p>
<p>14.2.3 Suppose that we want to verify the nonexistence of a finite projective 
</p>
<p>plane of order 10 by computer, by simple "brute force": We check that no matter 
</p>
<p>how we specify the appropriate number of subsets of points as lines, one of the 
</p>
<p>conditions (a), (b), or (c) will not hold. How may possibilities do we have to try? 
</p>
<p>About how long would this take? 
</p>
<p>14.3 Block Designs 
</p>
<p>The inhabitants of a town like to form clubs. They are socially very sensitive 
</p>
<p>(almost as sensitive as the Fanoans), and don't tolerate any inequalities. </p>
<p/>
</div>
<div class="page"><p/>
<p>14.3 Block Designs 221 
</p>
<p>Therefore, they don't allow larger and smaller clubs (because they are 
</p>
<p>afraid that larger clubs might suppress smaller ones). Furthermore, they 
</p>
<p>don't allow some people to be members of more clubs than others, since 
</p>
<p>those who are members of more clubs would have larger influence than the 
</p>
<p>others. Finally, there is one further condition: Each citizen A must behave 
</p>
<p>"equally" toward citizens Band C, A can not be in a tighter relationship 
</p>
<p>with B than C. So A must meet B in the same number of clubs as he/she 
meets C. 
</p>
<p>We can formulate these strongly democratic conditions mathematically 
</p>
<p>as follows. The town has v inhabitants; they organize b clubs; every club 
</p>
<p>has the same number of members, say k; everybody belongs to exactly r 
</p>
<p>clubs, and for any pair of citizens, there are exactly A clubs where both of 
</p>
<p>them are members. 
</p>
<p>The structure of clubs discussed in the previous paragraphs is called 
</p>
<p>a block design. Such a structure consists of a set of v elements, together 
</p>
<p>with a family of k-element subsets of this set (called blocks) in such a way 
</p>
<p>that every element occurs in exactly r blocks, and every pair of elements 
</p>
<p>occurs in A blocks jointly. We denote the number of blocks by b. It is clear 
</p>
<p>that block designs describe what we were discussing when talking about the 
</p>
<p>clubs in the town. In the sequel, sometimes we use this everyday description 
</p>
<p>and sometimes the block design formulation. 
</p>
<p>Let us see some concrete examples for block designs. One example is given 
</p>
<p>by the Fano plane (Figure 14.1). The points represent the inhabitants of 
</p>
<p>the town, and 3 people form a club if they are on a line. 
</p>
<p>Let us check that this configuration is indeed a block design: Every club 
</p>
<p>consists of 3 elements (so k = 3). Every person belongs to exactly 3 clubs 
(which means that r = 3). Finally, any pair of people belongs to exactly 
</p>
<p>one club by (a) (which means A = 1). Thus our configuration is indeed a 
block design (the number of elements is v = 7, the number of blocks is 
b = 7). 
</p>
<p>The Tictactoe plane gives another block design. Here we have nine points, 
</p>
<p>so v = 9; the blocks are the lines, having 3 points on each (so k = 3), and 
there are 12 of them (so b = 12). Each point is contained in 4 lines (r = 4), 
and through each pair of points there is a unique line (so A = 1). 
</p>
<p>A block design in which A =1= 1 can be obtained from the Cube space if 
</p>
<p>we take the planes as blocks. Clearly, we have v = 8 elements; each block 
contains k = 4 elements, the number of blocks is b = 14 and every block is 
contained in r = 7 planes. The crucial property is that every pair of points 
is contained in exactly 3 planes, so we have A = 3. 
</p>
<p>There are some uninteresting, trivial block designs. For k = 2, there is 
only one block design on a given number v of elements: It consists of all G) 
pairs. The same construction gives a block design for every k ~ 2: We can 
</p>
<p>take all k-subsets as blocks to get a block design with b = m, r = (~=i), 
and A = (~=;). The most boring block design consists of a single block </p>
<p/>
</div>
<div class="page"><p/>
<p>222 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>(k = v, b = r = ), = 1). This is so uninteresting that we exclude it from 
further consideration and don't call it a block design. 
</p>
<p>Parameters of block designs. Are there any relations among the num-
</p>
<p>bers b, v, r, k,),? One equation can be derived from the following. Suppose 
</p>
<p>that every club gives a membership card to everyone of its members; how 
</p>
<p>many membership cards do they need? There are b clubs and every club 
</p>
<p>has k members, so altogether there are bk membership cards. On the other 
</p>
<p>hand, the town has v inhabitants and everybody has r membership cards, 
</p>
<p>so counting this way we get vr membership cards. In counting the number 
</p>
<p>of membership cards two ways we have to get the same number, so we get 
</p>
<p>bk = vr. (14.1) 
</p>
<p>Let us find another relation. Imagine that the clubs want to strengthen the 
</p>
<p>friendship among their members, so they require that every member should 
</p>
<p>have a dinner one-on-one with each of his/her fellow club members in the 
</p>
<p>clubhouse. How many dinners will a citizen C eat? We can count this in 
</p>
<p>the following two ways: 
</p>
<p>First reasoning: There are v-I other citizens in the town, and each 
</p>
<p>of them is in ), clubs jointly with C, so with everyone of the other v-I 
citizens, C will have to eat), dinners in the different clubhouses. This means 
</p>
<p>altogether ),(v -1) dinners. 
Second reasoning: C is a member in r clubs. Every club has k - 1 further 
</p>
<p>members, so in every club C is a member of, C has to eat k - 1 dinners. 
Altogether this means r(k - 1) dinners. 
</p>
<p>The result of the two counts must be equal: 
</p>
<p>),(v-1)=r(k-1). (14.2) 
</p>
<p>14.3.1 If a town has 924 clubs, each club has 21 members, and any 2 persons 
belong to exactly 2 clubs jointly, then how many inhabitants does the town have? 
How many clubs does each person belong to? (Don't be surprised: This is a very 
small town, and everybody belongs to many clubs!) 
</p>
<p>14.3.2 Show that the assumption that every person is in the same number of 
clubs is superfluous: It follows from the other assumptions we made about the 
clubs. 
</p>
<p>It follows that among the numbers b, v, r, k,), we can specify at most 
</p>
<p>three freely, and the other two are already determined by the relations 
</p>
<p>(14.1) and (14.2). In fact, we cannot arbitrarily specify even three. Is it 
</p>
<p>possible, for instance, that in a town of 500 people all the clubs have 11 
</p>
<p>members, and everybody belongs to 7 clubs? The answer is no; please don't 
</p>
<p>read on, but try to prove it yourself (it is not too hard). </p>
<p/>
</div>
<div class="page"><p/>
<p>14.3 Block Designs 223 
</p>
<p>Here is our proof: If this were possible, then for the number of clubs b 
</p>
<p>we would get from (14.1) that 
</p>
<p>v&middot; r 500&middot;7 
b=T=-n-' 
</p>
<p>But this is not an integer, so these numbers cannot occur. 
</p>
<p>OK, there is a rather trivial answer to this problem: We must specify 
</p>
<p>three of the given numbers so that in computing the other two using (14.1) 
</p>
<p>and (14.2) we get integer values. But this is not the whole story. There is an 
</p>
<p>important inequality that holds true in every block design, called Fisher's 
</p>
<p>Inequality: 
</p>
<p>b? v. (14.3) 
</p>
<p>The proof of this inequality uses mathematical tools that go beyond the 
</p>
<p>scope of this book. 
</p>
<p>Unfortunately, one can find five numbers b, v, r, k, A satisfying conditions 
</p>
<p>(14.1), (14.2), and (14.3) for which no block design with these parameters 
</p>
<p>exists. But we are running out of simple, easily checkable necessary condi-
</p>
<p>tions. For instance, there is no block design with parameters b = v = 43, 
k = r = 7, A = 1 (since this block design would be a finite projective plane 
of order 6, which we know does not exist). These numbers satisfy (14.1), 
</p>
<p>(14.2), and (14.3), and there is no simple way to rule out this block design 
</p>
<p>(just a tedious study of many cases). 
</p>
<p>14.3.3 (a) Find an example of specific values for v, T, and k where computing 
</p>
<p>b from (14.1) gives an integer value, but (14.2) leads to a contradiction. (b) Find 
</p>
<p>an example of 5 integers b, v, k, T, A (b, k, v, T ? 2, A? 1) that satisfy both (14.1) 
and (14.2), but b &lt; v. 
</p>
<p>14.3.4 For every v &gt; 1, construct a block design with b = v. 
</p>
<p>Club badges. In our town, every club has a badge. The town organizes a 
</p>
<p>parade in which everybody participates and everybody is required to wear 
</p>
<p>the badge of one of the clubs where he/she is a member. Can the badges 
</p>
<p>be chosen so that no two persons wear the same badge? 
</p>
<p>We need, of course, that there are enough different badges, at least as 
</p>
<p>many as citizens. That is, b ? v. This is indeed guaranteed by Fisher's 
Inequality (14.3). But is this enough? We have to make sure that every 
</p>
<p>citizen is wearing a badge of one of his or her clubs; not just different 
</p>
<p>badges. 
</p>
<p>The question has some resemblance to the Marriage Theorem (Theorem 
</p>
<p>10.3.1) described in Chapter 10. To make use of this resemblance, we assign 
</p>
<p>a bipartite graph to our block design (Figure 14.9). The lower set of points 
</p>
<p>represents the people; the upper set of points represents the clubs. We 
</p>
<p>connect point a to point X if citizen a is a member in club X (in Figure </p>
<p/>
</div>
<div class="page"><p/>
<p>224 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>Clubs 
~ 
</p>
<p>r ......, 
</p>
<p>0 0 0 
</p>
<p>\ 0 0 
</p>
<p>0 0 
</p>
<p>member of ... 
</p>
<p>&bull; &bull; &bull; &bull; &bull; ~ "- -v-
Citizens 
</p>
<p>FIGURE 14.9. Representing club membership by a graph 
</p>
<p>14.9 we have drawn only one edge of the graph). We know the following 
</p>
<p>properties of our graph: from every point below, exactly r edges go up, and 
</p>
<p>from every upper point exactly k edges go down. Below we have v points, 
</p>
<p>above we have b points. If we choose n points from the lower set (obviously, 
</p>
<p>n ::::: v), then we know that from these n points nr edges leave. Let us 
</p>
<p>denote by m the number of other endpoints of these nr edges. 
</p>
<p>We claim that n ::::: m. Since every upper point has degree k, altogether 
this makes mk edges. The nr edges mentioned above are among these mk 
</p>
<p>edges, and hence 
</p>
<p>nr::::: mk. (14.4) 
</p>
<p>On the other hand, bk = vr by (14.1). By b 2:: v we get k ::::: r, and so 
</p>
<p>mk:::::mr. (14.5) 
</p>
<p>From (14.4) and (14.5) we get 
</p>
<p>nr::::: mr, 
</p>
<p>and therefore n ::::: m, as claimed. 
So any n lower points are connected to at least n upper points. We invoke 
</p>
<p>the Marriage Theorem, more precisely, its version stated in Exercise 10.3.2: 
</p>
<p>We get that there exists a matching of the lower set into the upper set, i.e., 
</p>
<p>there exist v independent edges that connect every lower point to a different 
</p>
<p>point above. This matching tells every citizen which badge to wear. 
</p>
<p>14.4 Steiner Systems 
</p>
<p>We have seen that block designs with k ::::: 2 are trivial; we take a closer 
</p>
<p>look at the next case, k = 3. We also take the smallest possible value 
for A, namely A = 1. Block designs with k = 3 and A = 1 are called 
Steiner systems (named after Jakob Steiner, a Swiss mathematician in the 
</p>
<p>nineteenth century). The Fano plane and the Tictactoe plane are Steiner 
</p>
<p>systems, but the Cube space is not. </p>
<p/>
</div>
<div class="page"><p/>
<p>14.4 Steiner Systems 225 
</p>
<p>How many inhabitants must a town have to allow a system of clubs that 
</p>
<p>is a Steiner system? In other words, what conditions do we get for v if 
</p>
<p>our block design is a Steiner system? We use equations (14.1) and (14.2), 
</p>
<p>substituting the values k = 3 and A = 1. We get 
</p>
<p>3b = vr 
</p>
<p>and hence 
</p>
<p>and 
</p>
<p>and 2r = v-I, 
</p>
<p>v-I 
r=--
</p>
<p>2 
</p>
<p>b= v(v-l). 
</p>
<p>6 
</p>
<p>(14.6) 
</p>
<p>(14.7) 
</p>
<p>The numbers r and v must be integers, which imposes some conditions on 
</p>
<p>v. Since the denominator in (14.7) is 6 and that in (14.6) is a divisor of 
</p>
<p>6, the condition imposed concerns the remainder of v upon division by 6. 
</p>
<p>From (14.6) it follows that v must be an odd number, so if we divide it by 
</p>
<p>6, the remainders can be 1, 3, or 5. This means that v can be written in 
</p>
<p>the forms 6j + 1, 6j + 3, or 6j + 5, where j is an integer. Furthermore, v 
can not be of the form 6j + 5, because then by (14.7) we get 
</p>
<p>b = (6j + 5)(6j + 4) = 6 &middot;2 + 9' + 3 + ~ 
6 J J 3' 
</p>
<p>which is not an integer. 
</p>
<p>So v must be of the form 6j + 1 or 6j + 3. Taking into consideration that 
we must have v &gt; k = 3, we see that one can have a Steiner system only 
in towns where the number of inhabitants is v = 7,9, 13, 15, 19,21, ... etc. 
</p>
<p>For these numbers one can construct Steiner systems indeed. In the case 
</p>
<p>v = 7 we already have seen the Fano plane, and for v = 9, the Tictactoe 
plane. The general construction is quite involved, and we don't describe it 
</p>
<p>here. 
</p>
<p>14.4.1 Show that for for v = 7, the Fano plane is the only Steiner system. (Of 
course, 7 citizens can set up their clubs in many different ways, by "switching 
identities." We can think of 7 chairs, with triples forming the clubs specified. The 
citizens can choose chairs in many different ways.) 
</p>
<p>14.4.2 Does the Fisher inequality give any further condition on the number of 
elements in a Steiner system? 
</p>
<p>Representing the clubs. Imagine that in a town of v people, where the 
</p>
<p>clubs form a Steiner system, people become unhappy about the membership 
</p>
<p>fees, and they create a committee whose task is to protest these high fees. 
</p>
<p>The committee needs at least one member from every club. How many 
</p>
<p>members does this protest committee need to have? </p>
<p/>
</div>
<div class="page"><p/>
<p>226 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>This problem sounds similar to the badge problem discussed at the end 
</p>
<p>of section 14.3, but there are two differences: First, in the badge problem 
</p>
<p>every citizen (his or her interest) was "represented" by one of the clubs the 
</p>
<p>citizen belonged to, while here the clubs will be represented by one of their 
</p>
<p>members; and second (and more significantly), one and the same person 
</p>
<p>can represent several clubs. 
</p>
<p>Consider citizen Andrew, who does not belong to the committee. Andrew 
</p>
<p>is a member of r clubs, and since the clubs form a Steiner system, we have 
</p>
<p>v-I 
r=--
</p>
<p>2 
</p>
<p>(see equation (14.6)). 
</p>
<p>Every club in which Andrew is a member has two other members, and 
</p>
<p>since Andrew is a member jointly in exactly one club with every other 
</p>
<p>citizen, these (v - 1) /2 clubs have no members in common other than 
Andrew. The protest committee must have a member from each of them, 
</p>
<p>and since this member is not Andrew (since he is not a member of the 
</p>
<p>committee), the committee has at least V;I members. This means that 
one needs quite a large committee-almost half of the citizens! 
</p>
<p>And even this is only a lower bound! Can it be realized, or is there 
</p>
<p>some other argument that gives perhaps an even larger lower bound on 
</p>
<p>the size of the committee? In the case of the Fano plane, our lower bound 
</p>
<p>is (7 - 1) /2 = 3, and indeed, the three points of any line represent every 
line (any two lines intersect). In the case of the Tictactoe plane, our lower 
</p>
<p>bound is (9 - 1)/2 = 4, but there is no obvious choice of a committee of 4 
representing every line; in fact, there is no such choice at all! 
</p>
<p>This can be seen by a tedious case distinction, but let us offer a nice 
</p>
<p>argument that takes care of many other cases as well. We claim the following 
</p>
<p>surprising fact: 
</p>
<p>Theorem 14.4.1 If there exists a committee of size V;I representing every 
club, then this committee itself is also a Steiner system. 
</p>
<p>To be more precise, the elements of this new Steiner system will be the 
</p>
<p>VI people in the committee, and its blocks will be those clubs for which 
</p>
<p>all three members belong to the committee (such clubs will be called priv-
</p>
<p>ileged). 
</p>
<p>Proof. To prove that this is indeed a Steiner system, first we show that 
</p>
<p>every two committee members are contained in a privileged club. Suppose 
</p>
<p>not, say Bob and Carl are two committee members who are not jointly 
</p>
<p>contained in a privileged club. This means that the third member of the club 
</p>
<p>to which both Bob and Carl belong (in the original Steiner system) is not 
</p>
<p>on the committee. We may assume that this third member is Andrew. But 
</p>
<p>then in the argument above we see that each club containing Andrew has at 
</p>
<p>least one representative in the committee, and one club has two (Bob and </p>
<p/>
</div>
<div class="page"><p/>
<p>14.4 Steiner Systems 227 
</p>
<p>Carl). This implies that the committee has at least (v-3)/2+2 = (v+1)/2 
members, a contradiction. 
</p>
<p>So any two committee members belong to a privileged club. Since no 
</p>
<p>two citizens belong to more than one club in common, no two committee 
</p>
<p>members belong to more than one privileged club in common. So every pair 
</p>
<p>of committee members belongs to exactly one privileged club in common. 
</p>
<p>This proves that the committee is indeed a Steiner system. 0 
</p>
<p>Now, if the 9-element Steiner system could be represented by 4 elements, 
</p>
<p>then we would get a Steiner system on 4 elements, which we already know 
</p>
<p>cannot exist! We get similarly that for Steiner systems on 13,21,25,33, ... 
</p>
<p>points, more than half of the citizens are needed to represent every club. 
</p>
<p>14.4.3 Suppose that a Steiner system on v elements contains a subset S of 
(v - 1)/2 elements such that those triples of the original system that belong 
totally to S form a Steiner system. Prove that in this case S forms a representative 
committee (so every triple of the original Steiner system contains an element of 
S). 
</p>
<p>Gender balance. The inhabitants of our town want to set up their clubs 
</p>
<p>so that in addition to forming a Steiner system, they should be "gender-
</p>
<p>balanced." Ideally, they would like to have the same number of males and 
</p>
<p>females in each club. But realizing that this cannot happen (3 being an 
</p>
<p>odd number), they would settle for less: They require that every club must 
</p>
<p>contain at least one male and at least one female. 
</p>
<p>In mathematical terms, we have a Steiner system, and we want to color 
</p>
<p>the elements with 2 colors (red and blue, corresponding to "female" and 
</p>
<p>"male") in such a way that no block (club) gets only one color. Let us call 
</p>
<p>such a coloring a good 2-coloring of the Steiner system. 
</p>
<p>Is this possible? Let's start with the first nontrivial special case, the case 
</p>
<p>v = 7. We have seen (Exercise 14.4.1) that the only Steiner system in 
this case is the Fano plane. After a little experimentation we can convince 
</p>
<p>ourselves that there is no way to 2-color this system. In fact, we have stated 
</p>
<p>this already in exercise 14.1.2: If a good 2-coloring were possible, then in 
</p>
<p>any case where the males vote one way and the females the other way, the 
</p>
<p>"line rule" would not provide a clear-cut decision. 
</p>
<p>But it is not only the Fano plane for which no good 2-coloring is possible: 
</p>
<p>Theorem 14.4.2 No Steiner system has a good 2-coloring. 
</p>
<p>Proof. After our preparations, this is not hard to prove. Suppose that 
</p>
<p>we have found a good 2-coloring (thus every triple contains differently col-
</p>
<p>ored elements). Then the set of red points and the set of blue points each 
</p>
<p>represent all clubs, so (by our discussion above) both sets must contain at 
</p>
<p>least v;l elements. Altogether this gives v-I points, so there is only one 
further point, which is blue or red; say it is red. Then the (v - 1)/2 blue </p>
<p/>
</div>
<div class="page"><p/>
<p>228 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>points form a representative committee, and as we have seen, it is itself a 
</p>
<p>Steiner system. But then any club that is a block in this smaller Steiner 
</p>
<p>system contains only blue points, contradicting the fact that we supposed 
</p>
<p>we had a good coloring. 0 
</p>
<p>14.4.4 Show that if we allow 3 colors, then both the Fano plane and the Tic-
</p>
<p>tactoe plane can be colored so that every block gets at least two colors (but not 
</p>
<p>necessarily all three). 
</p>
<p>The Schoolgirls' Walking Schedule. A teacher has a group consisting 
</p>
<p>of 9 schoolgirls. She takes them for a walk every day; they walk in three 
</p>
<p>lines, with three girls in each line. The teacher wants to arrange the walks 
</p>
<p>so that after several days, every girl should have walked with every other 
</p>
<p>girl in one line exactly once. 
</p>
<p>14.4.5 How many days do they need for that? 
</p>
<p>If you've solved the previous exercise, then you know how many days 
</p>
<p>they need, but is it possible to arrange the walk as the teacher wishes? 
</p>
<p>Trying to make a plan from scratch is not easy. 
</p>
<p>An observation that helps is the following. Call a triple of girls a block if 
</p>
<p>they walk in one line at any time. This way we get a Steiner system. We 
</p>
<p>already know a Steiner system on 9 elements, the Tictactoe plane. 
</p>
<p>Are we done? No, because the problem asks for more than simply a 
</p>
<p>Steiner system: We have to specify which blocks (triples) form lines on 
</p>
<p>each day. The order of the days is clearly irrelevant, so what we need is 
</p>
<p>a splitting of the 12 triples into 4 classes such that each class consists of 
</p>
<p>three disjoint triples (thus giving a walk plan for a day). If we take a careful 
</p>
<p>look at the Tictactoe plane, then we notice that this is exactly how it is 
</p>
<p>constructed: a set of 3 parallel lines gives a walk plan for one day. 
</p>
<p>Thomas Kirkman, an English amateur mathematician, asked this ques-
</p>
<p>tion about 15 girls (then the girls need 7 days to complete a walking plan). 
</p>
<p>The question for 15 girls remained unsolved for several years, but finally 
</p>
<p>mathematicians found a solution. Obviously, once you have the right plan, 
</p>
<p>it is easy to check the correctness of it, but there are many possible plans 
</p>
<p>to try. 
</p>
<p>To find a perfect walking plan for the general case when v = 6j + 3, 
instead of 9 or 15, turned out to be a much harder question. It was solved 
</p>
<p>only more than 100 years later, in 1969, by the Indian-American mathe-
</p>
<p>matician Ray-Chaudhuri. One should notice that from this result it follows 
</p>
<p>that there exists a Steiner system for every v = 6j + 3; even to prove this 
simpler fact is quite hard. 
</p>
<p>There is a related question: Suppose that the teacher wants a plan in 
</p>
<p>which every three girls walk together in a line exactly once. It is not hard 
</p>
<p>to see that such a plan would last for C35 ) /5 = 91 days. The triples that </p>
<p/>
</div>
<div class="page"><p/>
<p>14.5 Latin Squares 229 
</p>
<p>walk together form a block design again, but now this is what we called 
</p>
<p>above "trivial" (all triples out of 15 points). So this problem appears easier 
</p>
<p>than the Kirkman Schoolgirl Problem, but its solution (in general, with v 
</p>
<p>schoolgirls walking in lines of k) took even more time: it was solved in 1974 
by the Hungarian mathematician Zsolt Baranyai. 
</p>
<p>14.5 Latin Squares 
</p>
<p>Look at the little 4 x 4 tables below. Each of them has the property that 
</p>
<p>on every field we have one of the numbers 0, 1, 2, and 3, in such a way that 
</p>
<p>no number occurs in any row or in any column, more than once. A table 
</p>
<p>with this property is called a (4 x 4) Latin square. 
</p>
<p>0 1 2 3 0 2 1 3 
</p>
<p>1 2 3 0 
</p>
<p>2 3 0 1 
</p>
<p>2 1 3 0 
</p>
<p>1 3 0 2 
(14.8) 
</p>
<p>3 0 1 2 3 0 2 1 
</p>
<p>0 1 2 3 0 1 2 3 
</p>
<p>1 0 3 2 
</p>
<p>2 3 0 1 
</p>
<p>3 2 1 0 
</p>
<p>1 0 3 2 
(14.9) 
</p>
<p>3 2 1 0 2 3 0 1 
</p>
<p>It is easy to construct many Latin squares with any number of rows and 
</p>
<p>columns (see Exercise 14.5.2). Once we have a Latin square, it is easy to 
</p>
<p>make many more from it. We can reorder the rows, reorder the columns, or 
</p>
<p>permute the numbers 0, 1, ... occurring in them. For example, if we replace 
</p>
<p>1 by 2 and 2 by 1 in the first Latin square in (14.8), we get the second Latin 
</p>
<p>square. 
</p>
<p>14.5.1 How many 4 x 4 Latin squares are there? What is the answer if we don't 
</p>
<p>consider two Latin squares different if one of them can be obtained from the other 
</p>
<p>by permuting rows, columns, and numbers? 
</p>
<p>14.5.2 Construct an n x n Latin square for every n &gt; 1. 
</p>
<p>Let us have a closer look at the Latin squares in (14.9). If we place these 
</p>
<p>two squares on top of each other, in every field we get an ordered pair of 
</p>
<p>numbers: The first element of the pair comes from the appropriate field of 
</p>
<p>the first square, and the second element from the appropriate field of the </p>
<p/>
</div>
<div class="page"><p/>
<p>230 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>second: 
</p>
<p>0,0 1,1 2,2 3,3 
</p>
<p>1,3 0,2 3,1 2,0 
</p>
<p>2,1 3,0 0,3 1,2 
(14.10) 
</p>
<p>3,2 2,3 1,0 0,1 
</p>
<p>Do you notice something about this composite square? Every field contains 
</p>
<p>a different pair of numbers! From this it follows that each of the possible 
</p>
<p>42 = 16 pairs occurs exactly once (Pigeonhole Principle). If two Latin 
squares have this property, we call them orthogonal. One may check the 
</p>
<p>orthogonality of two Latin squares in the following way: We take all the 
</p>
<p>fields in the first Latin square that contain 0, and we check the same fields 
</p>
<p>on the second square, to see whether they contain different integers. We do 
</p>
<p>the same with 1, 2, etc. If the squares pass all these checks, then the first 
</p>
<p>square is orthogonal to the second one, and vice versa. 
</p>
<p>14.5.3 Find two orthogonal 3 x 3 Latin squares. 
</p>
<p>Magic squares. If we have two orthogonal Latin squares, we may very 
</p>
<p>easily construct from them a magic square. (In a magic square the sums of 
</p>
<p>the numbers in every row and every column are equal.) Consider the pairs 
</p>
<p>in the fields in (14.10). Replace each pair (a, b) by ab = 4a + b (in other 
words, consider ab as a two-digit number in base 4). Writing our numbers 
</p>
<p>in decimal notation, we get the magic square shown in (14.11). 
</p>
<p>&deg; 5 10 15 7 2 13 8 
9 12 3 6 
</p>
<p>(14.11) 
</p>
<p>14 11 4 1 
</p>
<p>(This is a magic square indeed: Every row and column sum is 30.) From 
</p>
<p>any two orthogonal Latin squares we can get a magic square using the 
</p>
<p>same method. In every row (and also in every column) the numbers 0, 1, 
</p>
<p>2, 3 occur exactly once in the first position and exactly once in the second 
</p>
<p>position, so in every row (and column) the sum of the elements is exactly 
</p>
<p>(0 + 1 + 2 + 3) &middot;4+ (0 + 1 + 2 + 3) = 30, 
</p>
<p>as required in a magic square. 
</p>
<p>14.5.4 In our magic square we have the numbers 0 through 15, instead of 1 
</p>
<p>through 16. Try to make a magic square from (14.10) formed by the numbers 1 
</p>
<p>through 16. 
</p>
<p>14.5.5 The magic square constructed from our two orthogonal Latin squares is 
</p>
<p>not "perfect", because in a perfect magic square the sums on the diagonals are </p>
<p/>
</div>
<div class="page"><p/>
<p>14.5 Latin Squares 231 
</p>
<p>the same as the row and column sums. From which orthogonal Latin squares can 
</p>
<p>we make perfect magic squares? 
</p>
<p>Is there a 4 x 4 Latin square that is orthogonal to both of our Latin 
</p>
<p>squares making up (14.10)7 The answer is yes; try to construct it yourself 
</p>
<p>before looking at (14.12). It is interesting to notice that these three Latin 
</p>
<p>squares consist of the same rows, but in different orders. 
</p>
<p>0 1 2 3 
</p>
<p>2 3 0 1 
</p>
<p>1 0 3 2 
(14.12) 
</p>
<p>3 2 1 0 
</p>
<p>14.5.6 Prove that there does not exist a fourth 4 x 4 Latin square orthogonal 
</p>
<p>to all three Latin squares in (14.9) and (14.12). 
</p>
<p>14.5.7 Consider the Latin square (14.13). It is almost the same as the previous 
</p>
<p>one in (14.12); but (prove!) there does not exist any Latin square orthogonal to 
</p>
<p>it. So Latin squares that look similar can be very different! 
</p>
<p>0 1 2 3 
</p>
<p>1 3 0 2 
</p>
<p>2 0 3 1 
(14.13) 
</p>
<p>3 2 1 0 
</p>
<p>Latin squares and finite planes. There is a very close connection be-
</p>
<p>tween Latin squares and finite affine planes. Consider an affine plane of or-
</p>
<p>der n; pick any class of parallel lines, and call them "vertical"; pick another 
</p>
<p>class and call them "horizontal". Enumerate the vertical lines arbitrarily, 
</p>
<p>and also the horizontal lines arbitrarily. Thus we can think of the points of 
</p>
<p>the plane as entries of an n x n table in which every row as well as every 
</p>
<p>column is a line (this is the way we presented the Tictactoe plane at the 
</p>
<p>beginning of this Chapter). 
</p>
<p>Now consider an arbitrary third parallel class of lines, and again, label 
</p>
<p>the lines arbitrarily 0,1, ... ,n - 1. Each entry of the table (point in the 
plane) belongs to exactly one line of this third parallel class, and we can 
</p>
<p>write the label of this line in the field. So all the 0 entries will form a line 
</p>
<p>of the plane, all the 1 entries a different, but parallel, line, etc. 
</p>
<p>Since any two nonparallel lines have exactly one point in common, the 
</p>
<p>line of O's will meet every row (and similarly every column) exactly once, 
</p>
<p>and the same holds for the lines of l's, 2's, etc. This implies that the table 
</p>
<p>we constructed is a Latin square. 
</p>
<p>This is not too exiting so far, since Latin squares are easy to construct. 
</p>
<p>But if we take a fourth parallel class, and construct a Latin square from it, </p>
<p/>
</div>
<div class="page"><p/>
<p>232 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>then these two Latin squares will be orthogonal! (This is just a translation 
</p>
<p>of the fact that every line from the third parallel class intersects every line 
</p>
<p>from the fourth exactly once.) The affine plane has n + 1 parallel classes; 
two of these were used to set up the table, but the remaining n - 1 provide 
n - 1 mutually orthogonal Latin squares. 
</p>
<p>From the Tictactoe plane we get two orthogonal 3 x 3 Latin squares 
</p>
<p>this way (not surprisingly, they are just the ones found directly in exer-
</p>
<p>cise 14.5.3). From the affine plane of order 5 constructed earlier, we get 4 
</p>
<p>mutually orthogonal Latin squares, as shown below. 
</p>
<p>0 1 2 3 4 0 1 2 3 4 
</p>
<p>1 2 3 4 0 2 3 4 0 1 
</p>
<p>2 3 4 0 1 4 0 1 2 3 
</p>
<p>3 4 0 1 2 1 2 3 4 0 
</p>
<p>4 0 1 2 3 3 4 0 1 2 
</p>
<p>0 1 2 3 4 0 1 2 3 4 
</p>
<p>3 4 0 1 2 4 0 1 2 3 
</p>
<p>1 2 3 4 0 3 4 0 1 2 
</p>
<p>4 0 1 2 3 2 3 4 0 1 
</p>
<p>0 1 2 3 4 1 2 3 4 0 
</p>
<p>This nice connection between Latin squares and affine planes works both 
</p>
<p>ways: If we have n - 1 mutually orthogonal Latin squares, we can use them 
</p>
<p>to construct an affine plane in a straightforward way. The points of the 
</p>
<p>plane are the fields in an n x n table. The lines are the rows and columns, 
</p>
<p>and for every number in {O, 1, ... ,n - I} and every Latin square, we form 
a line from those fields that contain this number. 
</p>
<p>Recall that we have constructed finite planes only of prime order, even 
</p>
<p>though we remarked that they exist for all prime power orders. We can 
</p>
<p>now settle at least the first of the missing orders: Just use this reverse 
</p>
<p>construction to get an affine plane of order 4 from our three mutually 
</p>
<p>orthogonal 4 x 4 Latin squares in (14.9) and (14.12). 
</p>
<p>14.6 Codes 
</p>
<p>We are ready to talk about some real applications of the ideas discussed 
</p>
<p>in this Chapter. Suppose that we want to send a message through a noisy 
</p>
<p>channel. The message is (as usual) a long string of bits (O's and l's), and 
</p>
<p>"noisy" means that some of these bits may be corrupted (changed from 0 to 
</p>
<p>lor vice versa). The channel itself could be radio transmission, telephone, 
</p>
<p>internet, or just your compact disc player (in which case the "noise" may 
</p>
<p>be a piece of dirt or a scratch on the disc). </p>
<p/>
</div>
<div class="page"><p/>
<p>14.6 Codes 233 
</p>
<p>How can we cope with these errors and recover the original message? Of 
</p>
<p>course, a lot depends on the circumstances. Can we ask for a few bits to be 
</p>
<p>resent, if we notice that there is an error? In internet protocols we can; in 
</p>
<p>transmissions from a Mars probe or in listening to music on compact discs, 
</p>
<p>we can't. So in some cases it is enough if we can detect whether there is an 
</p>
<p>error in the message we receive, while in other cases we have to be able to 
</p>
<p>correct the error just from the received message itself. 
</p>
<p>The simplest solution is to send the message twice, and check whether any 
</p>
<p>of the bits arrives differently in the two messages (we can repeat each bit 
</p>
<p>immediately, or repeat the whole message; it does not make any difference 
</p>
<p>at this point). This is called a repetition code. Certainly, if a bit does not 
</p>
<p>match, then we know something is wrong, but of course we don't know 
</p>
<p>whether the first or second copy of the bit was wrong. So we detect an 
</p>
<p>error, but cannot correct it. (Of course, it may happen that both copies of 
</p>
<p>the bit are corrupted; we have to make the assumption that the channel is 
</p>
<p>not too noisy, so that the probability that this happens is small. We'll come 
</p>
<p>back to this issue.) An easy way to strengthen this is to send the message 
</p>
<p>three times. Then we can also correct the error (for every bit, take as correct 
</p>
<p>the version that arrives at least twice), or in the very noisy situation, at 
</p>
<p>least detect it even if 2 (but not 3) copies of a bit are corrupted. 
</p>
<p>There is another simple way of detecting errors: a parity check. This is 
</p>
<p>the simple trick of appending a bit to each string of a given length (say, after 
</p>
<p>7 bits) so that the number of l's in the extended message is even (so we 
</p>
<p>append a 0 if the number of l's is already even, and append a 1 if it is odd). 
</p>
<p>The recipient can look at the received block of 8 bits (a byte), and check 
</p>
<p>whether it has an even number of l's. If so, we consider it OK; otherwise, 
</p>
<p>we know that it contains an error. (Again, in a very noisy channel errors 
</p>
<p>may remain undetected: If two bits of the 8 are changed, then the parity 
</p>
<p>check does not reveal it.) 
</p>
<p>Here is an example of how a string (namely, 10110010000111) is encoded 
</p>
<p>in these two ways: 
</p>
<p>1100111100001100000000111111 
</p>
<p>1011001000001111 
</p>
<p>(repetition code) 
</p>
<p>(parity check) 
</p>
<p>These solutions are not cheap; their main cost is that the messages be-
</p>
<p>come longer. In the repetition code, the increase is 100%; in the parity 
</p>
<p>check, it is about 14%. If the errors are so rare that we can safely assume 
</p>
<p>that only one bit in (say) every 127 is corrupted, then it suffices to append 
</p>
<p>a parity check bit after every 127 bits, at a cost of less than 1%. (Note that 
</p>
<p>the repetition code can be thought of as inserting a parity check bit after 
</p>
<p>every single bit!) 
</p>
<p>Is this the best way? To answer this question, we have to make an as-
</p>
<p>sumption about the noisiness of the channel. So we assume that we are 
</p>
<p>sending a message of length k, and that there are no more than e errors 
</p>
<p>(corrupted bits). We cannot use all strings of length k to send messages </p>
<p/>
</div>
<div class="page"><p/>
<p>234 14. Finite Geometries, Codes,Latin Squares, and Other Pretty Creatures 
</p>
<p>(since then any error would result in another possible message, and the 
</p>
<p>error could not be detected). The set of strings that we use is called a code. 
</p>
<p>So a code is a set of 0-1 strings of length k. For k = 8 (one byte), the 
repetition code consists of the following 16 strings: 
</p>
<p>00000000, 00000011, 00001100, 00001111, 00110000, 00110011, 
</p>
<p>00111100, 00111111,11000000, 11000011, 11001100, 11001111, 
</p>
<p>11110000, 11110011, 11111100, 11111111; 
</p>
<p>the parity check code consists of all strings of length 8 in which the number 
</p>
<p>of l's is even (there are 27 = 128 of these, and so we don't list them all 
</p>
<p>here). 
</p>
<p>We have seen that the parity check code is l-error-detecting, and so is 
</p>
<p>the repetition code. What is the strongest code on 8 bits (detecting the 
</p>
<p>largest number of errors)? The answer is easy: the code consisting of the 
</p>
<p>two codewords 
</p>
<p>00000000, 11111111 
</p>
<p>is 7-error-detecting: All 8 bits must be corrupted before we can be fooled. 
</p>
<p>But this code comes with a very high price tag: What it means is that we 
</p>
<p>resend every bit 8 times. 
</p>
<p>We can construct a more interesting code from the Cube space. This has 
</p>
<p>8 points, corresponding to the 8 bits. Let us fix an ordering of the points, say 
</p>
<p>ABCDEFGH in Figure 14.7. Every plane P in the geometry will provide 
</p>
<p>a codeword: We send a 1 if the corresponding point lies in the plane P. For 
</p>
<p>example, the bottom-face plane gives the codeword 11110000; the black 
</p>
<p>plane gives the codeword 10100101. We also add the words 00000000 and 
</p>
<p>11111111, to get a total of 16 codewords. 
</p>
<p>How good is this code? How many bits must be corrupted before one 
</p>
<p>codeword is changed into another? Assume that the two codewords come 
</p>
<p>from two planes P and Q, which by property (B) of the Cube space are 
either parallel or intersect each other in a line (i.e., in two points). 
</p>
<p>First suppose that these planes are parallel. For example, if they are the 
</p>
<p>"black" and "light" planes, then the two codewords they provide are 
</p>
<p>10100101 
</p>
<p>01011010. 
</p>
<p>We wrote the codewords above each other, so that it should be easier to 
</p>
<p>make the following observation: The two planes have no point in common, 
</p>
<p>which (according to the way we constructed the code) means that in no 
</p>
<p>position can both of them have a "1". Since each of them has four l's, it 
</p>
<p>follows that in no position can both of them have a "0" either. So all 8 bits 
</p>
<p>must be changed before one of them becomes the other. </p>
<p/>
</div>
<div class="page"><p/>
<p>14.6 Codes 235 
</p>
<p>Second, suppose that the two planes intersect in two points. For example, 
</p>
<p>the "black" plane and the "bottom" plane give the codewords 
</p>
<p>10100101, 
</p>
<p>11110000. 
</p>
<p>The two codewords will have two common l's, and (since each has four l's) 
</p>
<p>two common O's. So 4 bits must be changed before one of them becomes 
</p>
<p>the other. 
</p>
<p>The two further codewords that we added as a kind of an afterthought, 
</p>
<p>all-O and all-1, are easy to check: We must change 4 bits in them to get 
</p>
<p>a codeword coming from a plane, and 8 bits in them to get one from the 
</p>
<p>other. 
</p>
<p>What is important from these is that if we change up to 3 bits in any 
</p>
<p>codeword, we get a string that is not a codeword. In other words, this code 
</p>
<p>is 3-error-detecting. 
</p>
<p>a 
</p>
<p>1 a a 
</p>
<p>FIGURE 14.10. Two codewords from one line. 
</p>
<p>The Fano plane provides another interesting code. Again, let each point 
</p>
<p>correspond to a position in the codewords (so the codewords will consist of 
</p>
<p>7 bits). Each line will provide two codewords, one in which we put l's for 
</p>
<p>the points on the line and O's for the points outside, and one in which it is 
</p>
<p>the other way around. Again, we add the all-O and all-1 strings to get 16 
</p>
<p>codewords. 
</p>
<p>Instead of ordering the bits of the codeword, we can think of them as 
</p>
<p>writing 0 or 1 next to each point of the Fano plane. Figure 14.10 illustrates 
</p>
<p>the two codewords associated with a line. 
</p>
<p>Since we have 16 codewords again, but use only 7 bits, we expect less 
</p>
<p>from these codes than from the codes coming from the Cube space. In-
</p>
<p>deed, these Fano codes can no longer detect 3 errors. If we start with the 
</p>
<p>codeword defined by a line L (1 on the line and 0 elsewhere), and change 
</p>
<p>the three 1 's to O's, then we get the all-O string. But it is not only these 
</p>
<p>two special codewords that cause the problem: Again, if we start with the 
</p>
<p>same codeword, and flip the 3 bits on any other line K (from 1 to 0 at the 
</p>
<p>intersection point of K and L, from 0 to 1 at the other two points of K), 
</p>
<p>then we get a codeword coming from a third line (Figure 14.11). </p>
<p/>
</div>
<div class="page"><p/>
<p>236 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>o o 
</p>
<p>o 
</p>
<p>FIGURE 14.1l. Three errors are too much for the Fano code: flipping the bits 
</p>
<p>along the dotted line produces another valid codeword. 
</p>
<p>Going through an argument as above, we can see that 
</p>
<p>the Fano code is 2-error-detecting: We cannot get a valid code-
</p>
<p>word from another valid codeword by flipping 1 or 2 bits. 
</p>
<p>This implies that 
</p>
<p>the Fano code is l-error-correcting. 
</p>
<p>What this means is that not only can we detect if there is an erroneous 
</p>
<p>bit, but we can correct it. Suppose that we receive a string that comes from 
</p>
<p>a valid codeword a by changing a single bit. Could this string come from 
</p>
<p>another valid codeword b? The answer is no: Otherwise, the codewords a 
</p>
<p>and b would differ in only two places, which is not possible. 
</p>
<p>The codes we derived from the Fano plane and the Cube space are special 
</p>
<p>cases of a larger family of codes called Reed-Miiller codes. These are very 
</p>
<p>important in practice. For example, the NASA Mariner probes used them 
</p>
<p>to send back images from the Mars. Just as the Cube Code was based on 
</p>
<p>2-dimensional subspaces of a 3-dimensional space, the code used by the 
</p>
<p>Mariner probes were based on 3-dimensional subspaces of a 5-dimensional 
</p>
<p>space. They worked with blocks of size 32 (instead of 8 as we did), and could 
</p>
<p>correct up to 7 errors in each block. The price was, of course, pretty stiff: 
</p>
<p>There were only 64 codewords used, so to safely transmit 6 bits, one had 
</p>
<p>to package them in 32 bits. But of course, the channel (the space between 
</p>
<p>Earth and Mars) was very noisy! 
</p>
<p>Error-correcting codes are used all around us. Your CD player uses a 
</p>
<p>more sophisticated error-correcting code (called the Reed-Solomon code) 
</p>
<p>to produce a perfect sound even if the disk is scratched or dusty. Your 
</p>
<p>Internet connection and digital phone use such codes to correct for noise 
</p>
<p>on the line. 
</p>
<p>14.6.1 Prove that a code is d-error-correcting if and only if it is (2d)-error-
</p>
<p>detecting. 
</p>
<p>14.6.2 Show that every string of length 7 is either a codeword of the Fano code 
</p>
<p>or arises from a unique codeword by flipping one bit (a code with this property 
</p>
<p>is called perfect l-error-correcting). </p>
<p/>
</div>
<div class="page"><p/>
<p>14.6 Codes 237 
</p>
<p>Review Exercises 
</p>
<p>14.6.3 Verify that the Tictactoe plane is the same as the affine plane over the 
</p>
<p>3-element field. 
</p>
<p>14.6.4 A lab has 7 employees. Everybody works 3 nights a week: Alice on 
</p>
<p>Monday, Thesday, and Thursday; Bob on Thesday, Wednesday, and Friday; etc. 
</p>
<p>Show that any two employees meet exactly one night a week, and for any two 
</p>
<p>nights there is an employee who is working on both. What is the connection with 
</p>
<p>the Fano plane? 
</p>
<p>14.6.5 The game SMALLSET (which is a simplified version of the commercial 
</p>
<p>card game SET) is played with a deck of 27 cards. Each card has 1, 2, or 3 
</p>
<p>identical shapes; each shape can be a circle, triangle, or square, and it can be 
</p>
<p>red, blue, or green. There is exactly one card with 2 green triangles, exactly one 
</p>
<p>with 3 red circles, etc. A SET is a triple of cards such that the number of shapes 
</p>
<p>on them is either all the same or all different; the shapes are either all the same or 
</p>
<p>all different; and their colors are all the same or all different. The game consists 
</p>
<p>of putting down 9 cards, face up, and recognizing and removing SETs as quickly 
</p>
<p>as you can; if no SETs are left, 3 new cards are turned up. If no SETs are left 
</p>
<p>and all the remaining cards are turned up, the game is over. 
</p>
<p>(a) What is the number of SETs? 
</p>
<p>(b) Show that for any two cards there is exactly one third card that forms with 
</p>
<p>them a SET. 
</p>
<p>(c) What is the connection between this game and the affine space over the 
</p>
<p>3-element field? 
</p>
<p>(d) Prove that at the end of the game, either no cards or at least 6 cards 
</p>
<p>remain. 
</p>
<p>14.6.6 How many points do the two smallest projective planes have? 
</p>
<p>14.6.7 Consider the prime field with 13 elements. For every two numbers x and 
</p>
<p>y in the field, consider the triple {x + y, 2x + y, 3x + y} of elements of the field. 
Show that these triples form a block design, and compute its parameters. 
</p>
<p>14.6.8 Determine whether there exists a block design with the following pa-
</p>
<p>rameters: 
</p>
<p>(a) v = 15, k = 4, A = 1; 
</p>
<p>(b) v = 8, k = 4, A = 3; 
</p>
<p>(c) v=16,k=6,A=1. 
</p>
<p>14.6.9 Prove that the Tictactoe plane is the only Steiner system with v = 9. 
</p>
<p>14.6.10 Consider the addition table of the "Days of the Week" number system 
</p>
<p>in Section 6.8. Show that this table is a Latin square. Can you generalize this 
</p>
<p>observation? </p>
<p/>
</div>
<div class="page"><p/>
<p>238 14. Finite Geometries, Codes,Latin Squares,and Other Pretty Creatures 
</p>
<p>14.6.11 Describe the code you get from the projective plane over the 3-element 
</p>
<p>field, analogously to the Fano code. How much error correction/detection does it 
</p>
<p>provide? </p>
<p/>
</div>
<div class="page"><p/>
<p>15 
</p>
<p>A Glimpse of Complexity and 
Cryptography 
</p>
<p>15.1 A Connecticut Class in King Arthur's Court 
</p>
<p>In the court of King Arthur1 there dwelt 150 knights and 150 ladies-in-
</p>
<p>waiting. The king decided to marry them off, but the trouble was that 
</p>
<p>some pairs hated each other so much that they would not get married, let 
</p>
<p>alone speak! King Arthur tried several times to pair them off but each time 
</p>
<p>he ran into conflicts. So he summoned Merlin the Wizard and ordered him 
</p>
<p>to find a pairing in which every pair was willing to marry. Now, Merlin had 
</p>
<p>supernatural powers, and he saw immediately that none of the 150! possible 
</p>
<p>pairings was feasible, and this he told the king. But Merlin was not only a 
</p>
<p>great wizard, but a suspicious character as well, and King Arthur did not 
</p>
<p>quite trust him. "Find a pairing or I shall sentence you to be imprisoned 
</p>
<p>in a cave forever!" said Arthur. 
</p>
<p>Fortunately for Merlin, he could use his supernatural powers to browse 
</p>
<p>forthcoming scientific literature, and he found several papers in the early 
</p>
<p>twentieth century that gave the 'reason why such a pairing could not exist. 
</p>
<p>He went back to the king when all the knights and ladies were present, and 
</p>
<p>asked a certain 56 ladies to stand on one side of the king and 95 knights on 
</p>
<p>the other side, and asked, "Is anyone of you ladies willing to marry any of 
</p>
<p>lFrom L. Lovasz and M.D. Plummer: Matching Theory, Akademiai Kiad6, North 
</p>
<p>Holland, Budapest, 1986 (with slight modifications), with the kind permission of Mike 
</p>
<p>Plummer. The material was developed as a handout at Yale University, New Haven, 
</p>
<p>Connecticut. </p>
<p/>
</div>
<div class="page"><p/>
<p>240 15. A Glimpse of Complexity and Cryptography 
</p>
<p>these knights?" and when all said "No!" Merlin said, "Oh King, how can 
</p>
<p>you command me to find a husband for each of these 56 ladies among the 
</p>
<p>remaining 55 knights?" So the king, whose courtly education did include 
</p>
<p>the Pigeonhole Principle, saw that in this case Merlin had spoken the truth, 
</p>
<p>and he graciously dismissed him. 
</p>
<p>Some time elapsed and the king noticed that at the dinners served for 
</p>
<p>the 150 knights at the famous round table, neighbors often quarreled and 
</p>
<p>even fought. Arthur found this bad for the digestion and so once again he 
</p>
<p>summoned Merlin and ordered him to find a way to seat the 150 knights 
</p>
<p>around the table so that each of them should sit between two friends. Again, 
</p>
<p>using his supernatural powers Merlin saw immediately that none of the 150! 
</p>
<p>seatings would do, and this he reported to the king. Again, the king bade 
</p>
<p>him find one or explain why it was impossible. "Oh, I wish there were some 
</p>
<p>simple reason I could give to you! With some luck there could be a knight 
</p>
<p>having only one friend, and so you, too, could see immediately that what 
</p>
<p>you demand from me is impossible. But alas!, there is no such simple reason 
</p>
<p>here, and I cannot explain to you mortals why no such seating exists, unless 
</p>
<p>you are ready to spend the rest of your life listening to my arguments!" The 
</p>
<p>king was naturally unwilling to do that, and so Merlin has lived imprisoned 
</p>
<p>in a cave ever since. (A severe loss for applied mathematics!) 
</p>
<p>The moral of this tale is that there are properties of graphs that when 
</p>
<p>they hold, are easily proven to hold. If a graph has a perfect matching, or a 
</p>
<p>Hamilton cycle, this can be "proved" easily by exhibiting one. If a bipartite 
</p>
<p>graph does not have a perfect matching, then this can be "proved" by 
</p>
<p>exhibiting a subset X of one color class that has fewer than IXI neighbors 
in the other. The reader (and King Arthur!) are directed to Figure 15.1, in 
</p>
<p>which the graph on the left-hand side has a perfect matching (indicated by 
</p>
<p>the heavy lines), but the graph on the right-hand side does not. To convince 
</p>
<p>ourselves (and the king) of the latter, consider the four black points and 
</p>
<p>their neighbors. 
</p>
<p>FIGURE 15.1. A bigraph with a perfect matching and one without 
</p>
<p>Most graph-theoretic properties that interest us have this logical struc-
</p>
<p>ture. If it is easy to prove (certify, exhibit) that the property holds, then 
</p>
<p>the property is called (in the jargon of computer science) an NP property (if </p>
<p/>
</div>
<div class="page"><p/>
<p>15.1 A Connecticut Class in King Arthur's Court 241 
</p>
<p>you really want to know, NP is the abbreviation of Nondeterministic Poly-
</p>
<p>nomial Time, but it would be difficult to explain where this highly technical 
</p>
<p>phrase comes from). The two problems that Merlin had to face-the ex-
</p>
<p>istence of a perfect matching and the existence of a Hamilton cycle--are 
</p>
<p>clearly NP properties. But NP properties also appear quite frequently in 
</p>
<p>other parts of mathematics. A very important NP property of natural num-
</p>
<p>bers is their compositeness: If a natural number is composite, then this can 
</p>
<p>be exhibited easily by showing a decomposition n = ab (a, b &gt; 1). 
The remarks we have made so far explain how Merlin can remain free if 
</p>
<p>he is lucky and the task assigned to him by King Arthur has a solution. For 
</p>
<p>instance, suppose he could find a good way to seat the knights for dinner. 
</p>
<p>He could then convince King Arthur that his seating plan was "good" by 
</p>
<p>asking if there was anybody sitting beside any enemy of his (or just wait 
</p>
<p>and see if the dinner was quiet). This shows that the property of the cor-
</p>
<p>responding "graph of friendships" that it contains a Hamilton cycle is an 
</p>
<p>NP property. But how could he survive Arthur's wrath in the case of the 
</p>
<p>marriage problem and not in the case of the seating problem when these 
</p>
<p>problems do not have solutions? What distinguishes the nonexistence of a 
</p>
<p>Hamilton cycle in a graph from the nonexistence of a perfect matching in 
</p>
<p>a bipartite graph? From our tale, we hope the answer is clear: the nonexis-
</p>
<p>tence of a perfect matching in a bipartite graph is also an NP property (this 
</p>
<p>is a main implication of the Marriage Theorem, Theorem 10.3.1), while the 
</p>
<p>nonexistence of a Hamilton cycle in a graph is not! (To be precise, no proof 
</p>
<p>of this latter fact is known, but there is strong evidence in favor of it.) 
</p>
<p>So for certain NP properties the negation of the property is again an NP 
</p>
<p>property. A theorem asserting the equivalence of an NP property with the 
</p>
<p>negation of another NP property is called a good characterization. There 
</p>
<p>are famous good characterizations throughout graph theory and elsewhere. 
</p>
<p>Many NP properties are even better. Facing the problem of marrying off 
</p>
<p>his knights and ladies, Arthur himself (say, after reading this book) could 
</p>
<p>decide himself whether or not it was solvable: He could run the algorithm 
</p>
<p>described in Section 10.4. A lot of work, but probably doable with the help 
</p>
<p>of quite ordinary people, without using the supernatural talents of Merlin. 
</p>
<p>Properties that can be decided efficiently are called properties in the class 
</p>
<p>P (here P stand for Polynomial Time, an exact but quite technical defi-
</p>
<p>nition of the phrase "efficiently"). Many other simple properties of graphs 
</p>
<p>discussed in this book also belong to this class, such as connectivity and the 
</p>
<p>existence of a cycle. One of our favorite problems, that of deciding whether 
</p>
<p>a number is prime, was shown to be in this class just before our book went 
</p>
<p>to press. (The algorithm we described in Section 6.10 does not quite qualify 
</p>
<p>for the class P, because it uses a random selection of the base a.) 
The introduction of the notions of Polynomial Time and NP properties 
</p>
<p>signaled the birth of modern complexity theory. Notions and paradigms 
</p>
<p>from this theory have penetrated a large part of mathematics and its ap-
</p>
<p>plications. In the sequel we describe how ideas of complexity theory can be </p>
<p/>
</div>
<div class="page"><p/>
<p>242 15. A Glimpse of Complexity and Cryptography 
</p>
<p>applied in one of the most important areas of theoretical computer science, 
</p>
<p>namely, cryptography. 
</p>
<p>15.2 Classical Cryptography 
</p>
<p>Ever since writing was invented, people have been interested not only in 
</p>
<p>using it to communicate with their partners, but also in trying to conceal 
</p>
<p>the content of their messages from their adversaries. This leads to cryptog-
</p>
<p>raphy (or cryptology), the science of secret communication. 
</p>
<p>The basic situation is that one party, say King Arthur, wants to send 
</p>
<p>a message to King Bela. There is, however, a danger that the evil Caesar 
</p>
<p>Caligula intercepts the message and learns things that he is not supposed 
</p>
<p>to know about. The message, understandable even for Caligula, is called 
</p>
<p>the plain text. To protect its content, King Arthur encrypts his message. 
</p>
<p>When King Bela receives it, he must decrypt it in order to be able to read 
</p>
<p>it. For the kings to be able to encrypt and decrypt the message, they must 
</p>
<p>know something that Caligula does not know: this information is the key. 
</p>
<p>Many cryptosystems have been used in history; most of them, in fact, 
</p>
<p>turn out to be insecure, especially if the adversary can use powerful com-
</p>
<p>puting tools to break it. 
</p>
<p>Perhaps the simplest method is substitution code: We replace each letter 
</p>
<p>of the alphabet by another letter. The key is the table that contains for each 
</p>
<p>letter the letter to be substituted for it. While a message encrypted this 
</p>
<p>way looks totally scrambled, substitution codes are, in fact, easy to break. 
</p>
<p>Solving Exercise 15.2.1 will make it clear how the length and positions 
</p>
<p>of the words can be used to figure out the original meaning of letters if 
</p>
<p>the word breaks are preserved (i.e., "space" is not replaced by another 
</p>
<p>character). But even if the splitting into words is hidden, an analysis of 
</p>
<p>the frequency of various letters provides enough information to break the 
</p>
<p>substitution code. 
</p>
<p>One-time pads. There is another simple frequently used method that is 
</p>
<p>much more secure: the use of "one-time pads." This method is very safe; it 
</p>
<p>was used during World War II for communication between the American 
</p>
<p>president and the British prime minister. Its disadvantage is that it requires 
</p>
<p>a very long key ("pad"), which can only be used once. 
</p>
<p>A one-time pad is a randomly generated string of O's and 1 'So Here is 
</p>
<p>one: 
</p>
<p>11000111000010000110010100100100101100110010101100001110110000010 
</p>
<p>Both Kings Arthur and Bela know this sequence (it was sent well in advance 
</p>
<p>by a messenger). Now King Arthur wants to send the following message to 
</p>
<p>King Bela: 
</p>
<p>ATTACK MONDAY </p>
<p/>
</div>
<div class="page"><p/>
<p>15.2 Classical Cryptography 243 
</p>
<p>First, he has to convert it to O's and l's. It is not clear that medieval kings 
</p>
<p>had the knowledge to do so, but the reader should be able to think of 
</p>
<p>various ways: using ASCII codes, or Unicodes of the letters, for example. 
</p>
<p>But we want to keep things simple, so we just number the letters from 1 to 
</p>
<p>26, and then write down the binary representation of the numbers, putting 
</p>
<p>O's in front so that we get a string of length 5 for each letter. Thus we have 
</p>
<p>"00001" for A, "00010" for B, etc. We use "00000" for "space." The above 
</p>
<p>message becomes 
</p>
<p>00001100101001000001000110101100000011010111101110001000000111001 
</p>
<p>This might look cryptic enough, but Caligula (or rather one of the excellent 
</p>
<p>Greek scientists he keeps in his court as slaves) could easily figure out what 
</p>
<p>it stands for. To encrypt it, Arthur adds the one-time pad to the message 
</p>
<p>bit-by-bit. To the first bit of the message (which is 0) he adds the first 
</p>
<p>bit of the pad (1) and writes down the first bit of the encoded message: 
</p>
<p>o EB 1 = 1. He computes the second, third, etc., bits similarly: 0 EB 1 = 1, 
o EB 0 = 0, 0 EB 0 = 0, 1 EB 0 = 1, 1 EB 1 = 0, .... (Note that he uses this 
strange addition from the 2-element field, for which 1 EB 1 = 0.) Another 
way of saying what King Arthur does is the following: if the k-th bit of the 
</p>
<p>pad is 1, he flips the k-th bit of the text; else, he leaves it as it was. 
</p>
<p>So Arthur computes the encoded message: 
</p>
<p>11001011101011000111010010001000101111100101000010000110110111011 
</p>
<p>He sends this to King Bela, who, using the one-time pad, can easily flip 
</p>
<p>back the appropriate bits, and recover the original message. 
</p>
<p>But Caligula does not know the one-time pad (nor do his excellent scien-
</p>
<p>tists), so he has no idea about which bits were flipped, and so he is helpless. 
</p>
<p>The message is safe. 
</p>
<p>It can be expensive to make sure that the sender and the receiver both 
</p>
<p>have such a common key; but note that the key can be sent at a safer time 
</p>
<p>and by a completely different method than the message (moreover, it may 
</p>
<p>be possible to agree on a key even without actually passing it; but this 
</p>
<p>would lead us too far into cryptography). 
</p>
<p>Once the Kings managed to pass the key to each other, it is tempting 
</p>
<p>to reuse it; after all, if Bela encrypts his reply by the same pad, it is still 
</p>
<p>completely random-looking. In solving exercises 15.2.2 and 15.2.3 you will 
</p>
<p>see that this is not a good idea, along with some other weaknesses of the 
</p>
<p>one-time pad method. 
</p>
<p>15.2.1 For the following message, the kings used substitution code. Caligula 
</p>
<p>intercepted the message and quite easily broke it. Can you do it too? 
</p>
<p>U GXUAY LS ZXMEKW AMG TGGTIY HMD TAMGXSD LSSY, 
</p>
<p>FEG GXSA LUGX HEKK HMDIS. FSKT </p>
<p/>
</div>
<div class="page"><p/>
<p>244 15. A Glimpse of Complexity and Cryptography 
</p>
<p>15.2.2 At one time, Arthur made the mistake of using the one-time pad shifted: 
</p>
<p>The first bit of the plain text he encoded using the second bit of the pad, the 
</p>
<p>second bit of the plain text he encoded using the third bit of the pad etc. He 
</p>
<p>noticed his error after he sent the message off. Being afraid that Bela would 
</p>
<p>not understand his message, he encoded it again (now correctly) using the same 
</p>
<p>one-time pad, and sent it to Bela by another courier, explaining what happened. 
</p>
<p>Caligula intercepted both messages, and was able to recover the plain text. 
</p>
<p>How? 
</p>
<p>15.2.3 The Kings were running low on one-time pads, and so Bela had to use 
</p>
<p>the same pad to encode his reply as they used for Arthur's message. Caligula 
</p>
<p>intercepted both messages, and was able to reconstruct both plain texts. How? 
</p>
<p>15.3 How to Save the Last Move in Chess 
</p>
<p>Modern cryptography started in the late 1970's with the idea that it is not 
</p>
<p>only lack of information that can protect our message against an unautho-
</p>
<p>rized eavesdropper, but also the computational complexity of processing it. 
</p>
<p>The idea can be illustrated by the following simple example. 
</p>
<p>Alice and Bob are playing chess over the phone. They want to interrupt 
</p>
<p>the game for the night; how can they do it so that the person to move should 
</p>
<p>not get the improper advantage of being able to think about his move the 
</p>
<p>whole night? At a tournament, the last move is not made on the board, 
</p>
<p>only written down, put in an envelope, and deposited with the referee. The 
</p>
<p>next morning, the envelope is opened, and the other player learns what 
</p>
<p>the move was as his clock begins to run. But now the two players have no 
</p>
<p>referee, no envelope, no contact other than the telephone line. The player 
</p>
<p>making the last move (say, Alice) has to send Bob some message. The 
</p>
<p>next morning (or whenever they continue the game) she has to give some 
</p>
<p>additional information, some "key," which allows Bob to reconstruct the 
</p>
<p>move. Bob should not be able to reconstruct Alice's move without the key; 
</p>
<p>Alice should not be able to change her mind overnight and modify her 
</p>
<p>move. 
</p>
<p>Surely, this seems to be impossible! If she gives enough information the 
</p>
<p>first time to uniquely determine her move, Bob will know the move too 
</p>
<p>soon; if the information given the first time allows several moves, then she 
</p>
<p>can think about it overnight, figure out the best among these, and give the 
</p>
<p>remaining information, the "key," accordingly. 
</p>
<p>If we measure information in the sense of classical information theory, 
</p>
<p>then there is no way out of this dilemma. But complexity comes to our help: 
</p>
<p>it is not enough to communicate information, it must also be processed. 
</p>
<p>So here is a solution to the problem, using elementary number theory! 
</p>
<p>(Many other schemes can be designed.) Alice and Bob agree to encode 
</p>
<p>every move as a 4-digit number (say, '11' means 'K', '6' means 'f', and '3' 
</p>
<p>means itself, so '1163' means 'Kf3'). So far, this is just notation. </p>
<p/>
</div>
<div class="page"><p/>
<p>15.3 How to Save the Last Move in Chess 245 
</p>
<p>Next, Alice extends the four digits describing her move to a prime number 
</p>
<p>p = 1163 ... with 200 digits. She also generates another prime q with 201 
</p>
<p>digits and computes the product N = pq (this would take rather long on 
paper, but is trivial using a personal computer). The result is a number 
</p>
<p>with 400 or 401 digits; she sends this number to Bob. 
</p>
<p>Next morning, she sends both prime factors p and q to Bob. He recon-
</p>
<p>structs Alice's move from the first four digits of the smaller prime. To make 
</p>
<p>sure that Alice was not cheating, he should check that p and q are primes 
</p>
<p>and that their product is N. 
</p>
<p>Let us argue that this protocol does the job. 
</p>
<p>First, Alice cannot change her mind overnight. This is because the num-
</p>
<p>ber N contains all the information about her move: This is encoded as the 
</p>
<p>first four digits of the smaller prime factor of N. So Alice commits herself 
</p>
<p>to the move when sending N. 
</p>
<p>But exactly because the number N contains all the information about 
</p>
<p>Alice's move, Bob seems to have the advantage, and he indeed would have 
</p>
<p>if he had unlimited time or unbelievably powerful computers. What he has 
</p>
<p>to do is to find the prime factors of the number N. But since N has 400 
</p>
<p>digits (or more), this is a hopelessly difficult task with current technology. 
</p>
<p>Can Alice cheat by sending a different pair (p', q') of primes the next 
morning? No, because Bob can easily compute the product p' q', and check 
</p>
<p>that this is indeed the number N that was sent the previous night. (Note 
</p>
<p>the role of the uniqueness of prime factorization, Theorem 6.3.1.) 
</p>
<p>All the information about Alice's move is encoded in the first 4 digits of 
</p>
<p>the smaller prime factor p. We could say that the rest of p and the other 
</p>
<p>prime factor q serve as a "deposit box": This box hides this information 
</p>
<p>from Bob, and it can be opened only if the appropriate key (the factoriza-
</p>
<p>tion of N) is available. The crucial ingredient of this scheme is complexity: 
</p>
<p>the computational difficulty to find the factorization of an integer. 
</p>
<p>With the spread of electronic communication in business, many solutions 
</p>
<p>of traditional correspondence and trade must be replaced by electronic 
</p>
<p>versions. We have seen an electronic "deposit box" above. Other schemes 
</p>
<p>(similar or more involved) can be found for electronic passwords, autho-
</p>
<p>rization, authentication, signatures, watermarking, etc. These schemes are 
</p>
<p>extremely important in computer security, cryptography, automatic teller 
</p>
<p>machines, and many other fields. The protocols are often based on simple 
</p>
<p>number theory; in the next section we discuss (a very simplified version of) 
</p>
<p>one of them. 
</p>
<p>15.3.1 Motivated by the one-time pad method, Alice suggests the following 
</p>
<p>protocol for saving the last move in their chess game: In the evening, she encrypts 
</p>
<p>her move (perhaps with other text added, to make it reasonably long) using 
</p>
<p>a randomly generated 0-1 sequence as the key (just like in the one-time pad 
</p>
<p>method). The next morning she sends the key to Bob, so that he can decrypt the 
</p>
<p>message. Should Bob accept this suggestion? </p>
<p/>
</div>
<div class="page"><p/>
<p>246 15. A Glimpse of Complexity and Cryptography 
</p>
<p>15.3.2 Alice modifies her suggestion as follows: instead of the random 0-1 se-
</p>
<p>quence, she offers to use a random, but meaningful text as the key. For whom 
</p>
<p>would this be advantageous? 
</p>
<p>15.4 How to Verify a Password-Without Learning 
it 
</p>
<p>In a bank, a cash machine works by name and password. This system is 
</p>
<p>safe as long as the password is kept secret. But there is one weak point: 
</p>
<p>The computer of the bank must store the password, and the administrator 
</p>
<p>of this computer may learn it and later misuse it. 
</p>
<p>Complexity theory provides a scheme whereby the bank can verify that 
</p>
<p>the customer does indeed know the password-without storing the pass-
</p>
<p>word itself! At first glance this looks impossible-just as the problem with 
</p>
<p>filing the last chess move was. And the solution (at least the one we discuss 
</p>
<p>here) uses the same kind of construction as our telephone chess example. 
</p>
<p>Suppose that the password is a 100-digit prime number p (this is, of 
</p>
<p>course, too long for everyday use, but it illustrates the idea best). When 
</p>
<p>the customer chooses the password, he chooses another prime q with 101 
</p>
<p>digits, forms the product N = pq of the two primes, and tells the bank the 
number N. When the teller machine is used, the customer tells his name 
</p>
<p>and the password p. The computer of the bank checks whether or not p is 
</p>
<p>a divisor of N; if so, it accepts p as a proper password. The division of a 
</p>
<p>200 digit number by a 100 digit number is a trivial task for a computer. 
</p>
<p>Let us assume that the system administrator learns the number N stored 
</p>
<p>along with the files of our customer. To use this in order to impersonate 
</p>
<p>the customer, he has to find a 100-digit number that is a divisor of N; 
</p>
<p>but this is essentially the same problem as finding the prime factorization 
</p>
<p>of N, and this is hopelessly difficult. So-even though all the necessary 
</p>
<p>information is contained in the number N -the computational complexity 
</p>
<p>of the factoring problem protects the password of the customer! 
</p>
<p>15.5 How to Find These Primes 
</p>
<p>In our two simple examples of "modern cryptography," as well as in almost 
</p>
<p>all the others, one needs large prime numbers. We know that there are 
</p>
<p>arbitrarily large primes (Theorem 6.4.1), but are there any with 200 digits, 
</p>
<p>starting with 1163 (or any other 4 given digits)? Maple found (in a few 
</p>
<p>seconds on a laptop!) the smallest such prime number: </p>
<p/>
</div>
<div class="page"><p/>
<p>15.6 Public Key Cryptography 247 
</p>
<p>11630000000000000000000000000000000000000000000000 
00000000000000000000000000000000000000000000000000 
00000000000000000000000000000000000000000000000000 
00000000000000000000000000000000000000000000000371 
</p>
<p>The smallest 200 digit integer starting with 1163 is 1163.10196 . This is of 
</p>
<p>course not a prime, but above we found a prime very close by. There must 
</p>
<p>be zillions of such primes! Indeed, a computation very similar to what we 
</p>
<p>did in section 6.4 shows that the number of primes Alice can choose from 
</p>
<p>is about 1.95 . 10193 . 
</p>
<p>This is a large number of possibilities, but how do we find one? It would 
</p>
<p>not be good to use the prime above (the smallest eligible): Bob could guess 
</p>
<p>this and thereby find out Alice's move. What Alice can do is to fill in the 
</p>
<p>missing 196 digits randomly, and then test whether the number she obtains 
</p>
<p>is a prime. If not, she can throw it away and try again. As we computed 
</p>
<p>in Section 6.4, one in every 460 numbers with 200 digits is a prime, so on 
</p>
<p>the average in 460 trials she gets a prime. This looks like a lot of trials, but 
</p>
<p>of course she uses a computer; here is one we computed for you with this 
</p>
<p>method (in a few seconds again): 
</p>
<p>11631467128765557632799097045596606908283654760066 
68873814489354662474360419891104680411103886895880 
57457155724800095696391740333854584185935354886223 
23782317577559864739652701127177097278389465414589 
</p>
<p>So we see that in the "envelope" scheme above, both computational facts 
</p>
<p>mentioned in Section 6.10 playa crucial role: It is easy to test whether a 
</p>
<p>number is a prime (and thereby it is easy to compute the encryption), but 
</p>
<p>it is difficult to find the prime factors of a composite number (and so it is 
</p>
<p>difficult to break the cryptosystem). 
</p>
<p>15.6 Public Key Cryptography 
</p>
<p>Cryptographic systems used in real life are more complex than those de-
</p>
<p>scribed in the previous section; but they are based on similar principles. In 
</p>
<p>this section we sketch the math behind the most commonly used system, 
</p>
<p>the RSA code (named after its inventors, Rivest, Shamir, and Adleman). 
</p>
<p>The protocol. Alice generates two 100-digit prime numbers, p and q and 
</p>
<p>computes their product m = pq. Then she generates two 200-digit numbers 
d and e such that (p - 1) (q - 1) is a divisor ed - 1. (We will return to the 
question of how this is done.) 
</p>
<p>The numbers m and e she publishes on her web site (or in the phone 
</p>
<p>book), but the prime factors p and q and the number d remain her closely 
</p>
<p>guarded secrets. The number d is called her private key, and the number </p>
<p/>
</div>
<div class="page"><p/>
<p>248 15. A Glimpse of Complexity and Cryptography 
</p>
<p>e, her public key (the numbers p and q she may even forget; they will not 
</p>
<p>be needed to operate the system, just to set it up). 
</p>
<p>Suppose that Bob wants to send a message to Alice. He writes the mes-
</p>
<p>sage as a number x (we have seen before how to do this). This number x 
</p>
<p>must be a non-negative integer less than m (if the message is longer, he 
</p>
<p>can just break it up into smaller chunks). 
</p>
<p>The next step is the trickiest: Bob computes the remainder of x e modulo 
</p>
<p>m. Since both x and e are huge integers (200 digits), the number x d has 
</p>
<p>more than 10200 digits; we could not even write it down, let alone compute 
</p>
<p>it! Luckily, we don't have to compute this number, only its remainder when 
</p>
<p>dividing by m. This is still a large number, but at least it can be written 
</p>
<p>down in 2 or 3 lines. 
</p>
<p>So let r be this remainder; this is sent to Alice. When she receives it, 
</p>
<p>she can decrypt it using her private key d by carrying out essentially the 
</p>
<p>same procedure as Bob did: She computes the remainder of rd modulo m. 
</p>
<p>And-a black magic of number theory, until you see the explanations-this 
</p>
<p>remainder is just the plain text x. 
</p>
<p>What if Alice wants to send a message to Bob? He also needs to go 
</p>
<p>through the trouble of generating his private and public keys. He has to 
</p>
<p>pick two primes p' and q', compute their product m', select two positive 
integers d' and e' such that (p' - 1) (q' -1) is a divisor of e'd' -1, and finally 
publish m' and e'. Then Alice can send him a secure message. 
</p>
<p>The black math magic behind the protocol. The key fact from math-
</p>
<p>ematics we use is Fermat's Theorem, Theorem 6.5.1. Recall that x is the 
</p>
<p>plain text (written as an integer) and the encrypted message r is the re-
</p>
<p>mainder of x e modulo m. So we can write 
</p>
<p>r == x e (mod m). 
</p>
<p>To decrypt, Alice raises this to the dth power to get 
</p>
<p>rd == xed (mod m). 
</p>
<p>To be more precise, Alice computes the remainder x' of rd modulo m, which 
</p>
<p>is the same as the remainder of xed modulo m. We want to show that this 
</p>
<p>remainder is precisely x. Since 0 ~ x &lt; m, it suffices to argue that xed - x 
is divisible by m. Since m = pq is the product of two distinct primes, it 
suffices to prove that xed - x is divisible by both p and q. 
</p>
<p>Let us consider divisibility by p, for example. The main property of e 
</p>
<p>and d is that ed - 1 is divisible by (p - 1) (q - 1), and hence also by p - 1. 
This means that we can write ed = (p -l)l + 1, where l is a positive integer. 
We have 
</p>
<p>xed _ X = X(x(p-l)l -1). 
</p>
<p>Here X(p-l)l - 1 is divisible by x p- 1 - 1 (see Exercise 6.1.6), and so 
</p>
<p>X(x(p-l)l - 1) is divisible by x P - x, which in turn is divisible by p by 
Fermat's Theorem. </p>
<p/>
</div>
<div class="page"><p/>
<p>15.6 Public Key Cryptography 249 
</p>
<p>How to do all this computation. We already discussed how to find 
</p>
<p>primes, and Alice can follow the method described in section 6.10. 
</p>
<p>The next issue is the computation of the two keys e and d. One of them, 
</p>
<p>say e, Alice can choose at random, from the range 1, ... , (p -l)(q -1) -1. 
</p>
<p>She has to check that it is relatively prime to (p -1) (q -1); this can be done 
</p>
<p>efficiently with the help of the Euclidean Algorithm discussed in Section 
</p>
<p>6.6. If the number she chose is not relatively prime to (p - l)(q - 1), she 
just throws it out and tries another one. This is similar to the method we 
</p>
<p>used to find a prime, and it is not hard to see that she will find a good 
</p>
<p>number in about the same number of trials as it takes to find a prime. 
</p>
<p>But if she finally succeeds and the Euclidean Algorithm shows that she 
</p>
<p>found a number e relatively prime to (p - 1) (q - 1), then (as in Section 6.6) 
it also gives two integers u and v such that 
</p>
<p>eu - (p - l)(q - l)v = 1. 
</p>
<p>So eu - 1 is divisible by (p - 1) (q - 1). Let d denote the remainder of u 
</p>
<p>modulo (p - l)(q - 1), then ed - 1 is also divisible by (p - l)(q - 1), and 
</p>
<p>so we have found a suitable private key d. 
</p>
<p>Finally, how do we compute the remainder of x e modulo m, when just 
</p>
<p>to write down x e would fill the universe? This is done in the same way as 
</p>
<p>described in Section 6.10. 
</p>
<p>Signatures, etc. There are many other useful things this system can do. 
</p>
<p>For example, suppose that Alice gets a message from Bob as described 
</p>
<p>above. How can she know that it indeed came from Bob? Just because it 
</p>
<p>is signed "Bob," it could have come from anybody. But Bob can do the 
</p>
<p>following. First, he encrypts the message with his private key, then adds 
</p>
<p>"Bob," and encrypts it again with Alice's public key. When Alice receives it, 
</p>
<p>she can decrypt it with her private key. She'll see a still encrypted message, 
</p>
<p>signed "Bob." She can cut away the signature, look up Bob's public key in 
</p>
<p>the phonebook, and use it to decrypt the message. 
</p>
<p>Could anyone have faked this message? No, because the interloper would 
</p>
<p>have to use Bob's private key to encrypt the message (using any other key 
</p>
<p>would mean that Alice gets garbage when she decrypts the message by 
</p>
<p>Bob's public key, and she would know immediately that it is a fake). 
</p>
<p>One can use similar tricks to implement many other electronic gadgets, 
</p>
<p>using the RSA public key system: authentication, watermarking, etc. 
</p>
<p>Security. The security of the RSA protocol is a difficult issue, and since its 
</p>
<p>inception in 1977, thousands of researchers have investigated it. The fact 
</p>
<p>that no attack has been generally successful is a good sign; but unfortu-
</p>
<p>nately, no exact proof of its security has been found (and it appears that 
</p>
<p>current mathematics lacks the tools to provide such a proof). 
</p>
<p>We can give, however, at least some arguments that support its security. 
</p>
<p>Suppose that you intercept the message of Bob, and want to decipher it. </p>
<p/>
</div>
<div class="page"><p/>
<p>250 15. A Glimpse of Complexity and Cryptography 
</p>
<p>You know the remainder r (this is the intercepted message). You also know 
</p>
<p>Alice's public key e, and the number m. One could think of two lines of 
</p>
<p>attack: Either you can figure out her private key d and then decrypt the 
</p>
<p>message just as she does, or you could somehow more directly find the 
</p>
<p>integer x, knowing the remainder of x e modulo m. 
</p>
<p>Unfortunately, there is no theorem stating that either ofthis is impossible 
</p>
<p>in less than astronomical time. But one can justify the security of the system 
</p>
<p>with the following fact: if one can break the RSA system, then one can use 
</p>
<p>the same algorithm to find the prime factors of m (see Exercise 15.6.1). The 
</p>
<p>factorization problem has been studied by many people, and no efficient 
</p>
<p>method has been found, which makes the security of RSA quite probable. 
</p>
<p>15.6.1 Suppose that Bob develops an algorithm that can break RSA in the 
</p>
<p>first, more direct, way described above: Knowing Alice's public key m and e, he 
</p>
<p>can find her private key d. 
</p>
<p>(a) Show that he can use this to find the number (p - l)(q - 1); 
</p>
<p>(b) from this, he can find the prime factorization m = pq. 
</p>
<p>The real world. How practical could such a complicated system be? It 
</p>
<p>seems that only a few mathematicians could ever use it. But in fact you 
</p>
<p>have probably used it yourself hundreds of times! RSA is used in SSL 
</p>
<p>(Secure Socket Layer), which in turn is used in https (secure http). Any 
</p>
<p>time you visit a "secure site" on the Internet (to read your e-mail or to 
</p>
<p>order merchandise), your computer generates a public and private key for 
</p>
<p>you, and uses them to make sure that your credit card number and other 
</p>
<p>personal data remain secret. It does not have to involve you in this at all; 
</p>
<p>all you notice is that the connection is a bit slower. 
</p>
<p>In practice, the two lOO-digit primes are not considered sufficiently se-
</p>
<p>cure. Commercial applications use more than twice this length, military 
</p>
<p>applications, more than 4 times. 
</p>
<p>While the hairy computations of raising the plain text x to an exponent 
</p>
<p>that itself has hundreds of digits are surprisingly efficient, it would still be 
</p>
<p>too slow to encrypt and decrypt each message this way. A way out is to 
</p>
<p>send, as a first message, the key to a simpler encryption system (think of 
</p>
<p>a one-time pad, although one uses a more efficient system in practice, like 
</p>
<p>DES, the Digital Encryption Standard). This key is then used for a few 
</p>
<p>minutes to encode the messages going back and force, then thrown away. 
</p>
<p>The idea is that in a short session, the number of encoded messages is not 
</p>
<p>enough for an eavesdropper to break the system. </p>
<p/>
</div>
<div class="page"><p/>
<p>16 
</p>
<p>Answers to Exercises 
</p>
<p>1 Let's Count! 
</p>
<p>1.1 A Party 
</p>
<p>1.1.1. 7&middot;6&middot;&middot;&middot;2&middot; 1 = 5040. 
</p>
<p>1.1.2. Carl: 15 . 23 = 120. Diane: 15&middot; 3 . 2 . 1 = 90. 
</p>
<p>1.1.3. Bob: 9&middot;7&middot;5&middot;3 = 945. Carl: 945.25 = 302,40. Diane: 945&middot;5&middot;4&middot;3&middot;2&middot;1 = 
</p>
<p>113,400. 
</p>
<p>1.2 Sets and the Like 
</p>
<p>1.2.1. (a) all houses in a street; (b) an Olympic team; (c) class of '99; (d) 
</p>
<p>all trees in a forest; (e) the set ofrational numbers; (f) a circle in the plane. 
</p>
<p>1.2.2. (a) soldiers; (b) people; (c) books; (d) animals. 
</p>
<p>1.2.3. (a) all cards in a deck; (b) all spades in a deck; (c) a deck of Swiss 
cards; (d) nonnegative integers with at most two digits; (e) nonnegative 
</p>
<p>integers with exactly two digits; (f) inhabitants of Budapest, Hungary. 
</p>
<p>1.2.4. Alice, and the set whose only element is the number l. 
</p>
<p>1.2.5. No. 
</p>
<p>1.2.6. 0, {O}, {I}, {3}, {O, I}, {O, 3}, {I, 3}, {O, 1, 3}. 8 subsets. 
</p>
<p>1.2.7. women; people at the party; students of Yale. </p>
<p/>
</div>
<div class="page"><p/>
<p>252 16. Answers to Exercises 
</p>
<p>1.2.8. {a},{a,c},{a,d},{a,e},{a,c,d},{a,c,e},{a,d,e},{a,c,d,e}. 
</p>
<p>1.2.9. Z or Z+. The smallest is {O, 1,3,4, 5}. 
</p>
<p>1.2.10. (a) {a,b,c,d,e}. (b) The union operation is associative. (c) The 
union of any set of sets consists of those elements that are elements of at 
</p>
<p>least one of the sets. 
</p>
<p>1.2.11. The union of a set of sets {AI, A2 , &bull;.&bull; , Ad is the smallest set 
</p>
<p>containing each Ai as a subset. 
</p>
<p>1.2.12. 6,9,10,14. 
</p>
<p>1.2.13. The cardinality of the union is at least the larger of nand m and 
</p>
<p>at most n + m. 
</p>
<p>1.2.14. (a) {1,3}; (b) 0; (c) {2}. 
</p>
<p>1.2.15. The cardinality of the intersection is at most the minimum of n 
</p>
<p>and m. 
</p>
<p>1.2.16. Commutativity (1.2) is obvious. To show that (A n B) n C = 
A n (B n C), it suffices to check that both sides consist of those elements 
that belong to all three of A, B, and C. The proof of the other identity in 
(1.3) is similar. Finally, one can prove (1.4) completely analogously to the 
</p>
<p>proof of (1.1). 
</p>
<p>1.2.17. The common elements of A and B are counted twice on both sides; 
</p>
<p>the elements in either A or B but not both are counted once on both sides. 
</p>
<p>1.2.18. (a) The set of negative even integers and positive odd integers. 
</p>
<p>(b) B. 
</p>
<p>1.3 The Number of Subsets 
</p>
<p>1.3.1. (a) Powers of 2. (b) 2n -1. (c) sets not containing the last element. 
</p>
<p>1.3.2. 2n-l. 
</p>
<p>1.3.3. Divide all subsets into pairs such that each pair differs only in 
</p>
<p>their first element. Each pair contains an even and an odd subset, so their 
</p>
<p>numbers are the same. 
</p>
<p>1.3.4. (a) 2&middot; lGn - 1; (b) 2&middot; (lon - lGn- I ). 
</p>
<p>1.4.1. 101. 
</p>
<p>1.4.2. 1 + l n 19 2 J. 
</p>
<p>1.5 Sequences 
</p>
<p>1.5.1. The trees have 9 and 12 leaves, respectively. 
</p>
<p>1.5.2. 5&middot; 4 . 3 = 60. </p>
<p/>
</div>
<div class="page"><p/>
<p>1.5.3. 313 . 
</p>
<p>1.5.4. 6&middot; 6 = 36. 
</p>
<p>1.5.5. 1220. 
</p>
<p>1.5.6. (22&deg;)12. 
</p>
<p>1.6 Permutations 
</p>
<p>1.6.1. n!. 
</p>
<p>16. Answers to Exercises 253 
</p>
<p>1.6.2. (a) 7&middot;5&middot;3&middot;1 = 105. (b) (2n - 1) . (2n - 3)&middot;&middot;&middot;3&middot;1. 
</p>
<p>1.7 The Number of Ordered Subsets 
</p>
<p>1. 7.1. (We don't think you could really draw the whole tree; it has almost 
</p>
<p>1020 leaves. It has 11 levels of nodes.) 
</p>
<p>1.7.2. (a) 100!. (b) 90!. (c) 100!/90! = 100&middot;99&middot;&middot;&middot;91. 
</p>
<p>1.7.3. (n:':!k)! = n(n -1)&middot; (n - k + 1). 
</p>
<p>1. 7.4. In one case, repetition is not allowed, while in the other case, it is 
</p>
<p>allowed. 
</p>
<p>1.8 The Number of Subsets of a Given Size 
</p>
<p>1.8.1. Handshakes; lottery; hands in bridge. 
</p>
<p>1.8.2. See Pascal's Triangle in Chapter 3. 
</p>
<p>1.8.3. (~) = (~) = 1, G) = (n"-l) = n. 
1.8.4. An algebraic proof of (1.7) is straightforward. In (1.8), the right-
</p>
<p>hand side counts k-subsets of an n-element set by separately counting those 
</p>
<p>that contain a given element and those that do not. 
</p>
<p>1.8.5. An algebraic proof is easy. A combinatorial interpretation: n 2 is the 
</p>
<p>number of all ordered pairs (a, b) with a, b E {I, 2, ... , n}, and G) is the 
number of ordered pairs (a, b) among these with a &lt; b (why?). To count the 
remaining ordered pairs (a, b) (those with a .:::: b), add 1 to their first entry. 
Then we get a pair (a', b) with 1 :S: a', b :S: n + 1, a' &gt; b, and conversely, 
every such pair is obtained this way. Hence the number of these pairs is 
(n!l). 
</p>
<p>1.8.6. Again, an algebraic proof is easy. A combinatorial interpretation: 
</p>
<p>We can choose a k-element set by first choosing one element (n possibilities) 
</p>
<p>and then choosing a (k I)-element subset of the remaining n - 1 elements 
((~=i) possibilities). But we get every k-element subset exactly k times 
</p>
<p>(depending on which of its elements was chosen first), so we have to divide 
</p>
<p>the result by k. </p>
<p/>
</div>
<div class="page"><p/>
<p>254 16. Answers to Exercises 
</p>
<p>1.8.7. Both sides count the number of ways to divide an a-element set 
</p>
<p>into three sets with a - b, b - c, and c elements. 
</p>
<p>2 Combinatorial Tools 
</p>
<p>2.1 Induction 
</p>
<p>2.1.1. One of nand n + 1 is even, so the product n(n + 1) is even. By 
induction: true for n = 1; if n &gt; 1, then n(n + 1) = (n - l)n + 2n, and 
n(n - 1) is even by the induction hypothesis, 2n is even, and the sum of 
two even numbers is even. 
</p>
<p>2.1.2. 1lue for n = 1. If n &gt; 1, then 
</p>
<p>(n-l)n n(n+l) 
1+2+ .. &middot;+n=(1+2+ .. &middot;+(n-l))+n= +n= . 
</p>
<p>2 2 
</p>
<p>2.1.3. The youngest person will count n handshakes. The 7th oldest will 
</p>
<p>count 6 handshakes. So they count 1 + 2 + ... + n handshakes. We already 
know that there are n(n + 1)/2 handshakes. 
</p>
<p>2.1.4. Compute the area of the rectangle in two different ways. 
</p>
<p>2.1.5. By induction on n. 1lue for n = 2. For n &gt; 2, we have 
</p>
<p>(n-2)&middot;(n-l)&middot;n 
1&middot; 2 + 2&middot;3 + 3&middot;4 + ... + (n - 1) . n = + (n - 1) . n 
</p>
<p>3 
(n-l)&middot;n&middot;(n+l) 
</p>
<p>3 
</p>
<p>2.1.6. Ifn is even, then l+n = 2+(n-l) = ... = (~-1) +~ = n+1, so 
the sum is ~(n + 1) = n(~+1). If n is odd, then we have to add the middle 
term separately. 
</p>
<p>2.1.7. Ifn is even, then 1+(2n-l) = 3+(2n-3) = ... = (n-l)+(n+l) = 
2n, so the sum is ~ (2n) = n2 . Again, if n is odd, then the solution is similar, 
but we have to add the middle term separately. 
</p>
<p>2.1.8. By induction. 1lue for n = 1. If n &gt; 1, then 
</p>
<p>12 + 22+ ... + (n _1)2 = (12 + 22 + ... + (n _ 1)2) + n2 
</p>
<p>(n - l)n(2n - 1) 2 n(n + 1)(2n + 1) 
= 6 +n = 6 . 
</p>
<p>2.1.9. By induction. 1lue for n = 1. If n &gt; 1 then 
</p>
<p>20 + 21 + 22 + ... + 2n - 1 = (20 + 21 + ... + 2n - 2 ) + 2n - 1 
</p>
<p>= (2n - 1 _ 1) + 2n - 1 = 2n - 1. </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 255 
</p>
<p>2.1.10. (Strings) True for n = 1. If n &gt; 1 then to get a string of length n 
we can start with a string of length n -1 (this can be chosen in k n - 1 ways 
</p>
<p>by the induction hypothesis) and append an element (this can be chosen 
</p>
<p>in k ways). So we get kn- 1 . k = kn. 
</p>
<p>(Permutations) True for n = 1. To seat n people, we can start with seating 
the oldest (this can be done in n ways) and then seating the rest (this can be 
</p>
<p>done in (n - I)! ways by the induction hypothesis). We get n&middot; (n - I)! = n!. 
</p>
<p>2.1.11. True if n = 1. Let n &gt; 1. The number of handshakes between n 
people is the number of handshakes by the oldest person (this is n - 1) plus 
</p>
<p>the number of handshakes between the remaining n - 1 persons (which is 
(n -1)(n - 2)/2 by the induction hypothesis). We get (n -1) + (n -1)(n-
2)/2 = n(n - 1)/2 handshakes. 
</p>
<p>2.1.12. We did not check the base case n = 1. 
</p>
<p>2.1.13. The proof uses that there are at least four lines. But we checked 
</p>
<p>only n = 1, 2 as base cases. The assertion is false for n = 3 and for every 
value of n after that. 
</p>
<p>2.2 Comparing and Estimating Numbers 
</p>
<p>2.2.1. (a) The left-hand side counts all subsets of an n-set; the right-hand 
</p>
<p>side counts only the 3-element subsets. (b) 2n/n2 &gt; G)/n2 = (n -1)(n-
2)/(6n), which becomes arbitrarily large. 
</p>
<p>2.2.2. Start the induction with n = 4: 4! = 24 &gt; 16 = 24. If the inequality 
holds for n, then (n + I)! = (n + l)n! &gt; (n + 1)2n &gt; 2&middot; 2n = 2n+l. 
</p>
<p>2.3 Inclusion-Exclusion 
</p>
<p>2.3.1. 18 + 23 + 21 + 17 - 9 - 7 - 6 - 12 - 9 - 12 + 4 + 3 + 5 + 7 - 3 = 40. 
</p>
<p>2.4 Pigeonholes 
</p>
<p>2.4.1. If each of the giant boxes contains at most 20 New Yorkers, then 
</p>
<p>500,000 boxes contain at most 20&middot;500,000 = 10,000,000 New Yorkers, which 
is a contradiction. </p>
<p/>
</div>
<div class="page"><p/>
<p>256 16. Answers to Exercises 
</p>
<p>3 Binomial Coefficients and Pascal's Triangle 
</p>
<p>3.1 The Binomial Theorem 
</p>
<p>3.1.1. 
</p>
<p>(x + y)n+l 
= (X+y)n(X+y) 
</p>
<p>= (xn+ (~)Xn-ly+ ... + (n: l)Xyn+ (~)yn) (x+y) 
</p>
<p>= xn(x + y) + (~)Xn-ly(X + y) + ... 
</p>
<p>+ (n: 1)Xyn- 1 (X + y) + (~)yn(X + y) 
</p>
<p>= (Xn+l + xny) + (7) (xny + Xn- 1y2) + ... 
+ (n: 1) (x2yn-l + xyn) + (~) (xyn + yn+l) 
</p>
<p>= xn+1 + (1 + (7) ) xny + ( (7) + (~) ) xn-ly2 + ... 
+ ( (n : 1) + (~) ) xyn + yn+l 
</p>
<p>= xn+l + (n ~ l)Xny + (n; 1)Xn-ly2 + ... + (n: l)Xyn + yn+l. 
</p>
<p>3.1.2. (a) (l-l)n = O. (b) By C) = (n:"k)&middot; 
3.1.3. The identity says that the number of subsets of an n-element set 
</p>
<p>with an even number of elements is the same as the number of subsets with 
</p>
<p>an odd number of elements. We can establish a bijection between even and 
</p>
<p>odd subsets as follows: If a subset contains 1, delete it from the subset; 
</p>
<p>otherwise, add it to the subset. 
</p>
<p>3.2 Distributing Presents 
</p>
<p>3.2.1. 
</p>
<p>n! (n-nd! 
</p>
<p>nl!(n - nd! n2!(n - nl - n2)! 
</p>
<p>n! 
</p>
<p>(n-nl-&middot;&middot;&middot;-nk-d! 
</p>
<p>nk-l!(n - nl - ... - nk)! </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 257 
</p>
<p>since n - nl - ... - nk-l - nk = O. 
</p>
<p>3.2.2. (a) n! (distribute positions instead of presents). (b) n(n -1) ... (n-
</p>
<p>k + 1) (distribute as "presents" the first k positions at the competition and 
</p>
<p>n - k certificates of participation). (c) (,~J (d) Chess seating in Diane's 
sense (distribute players to boards). 
</p>
<p>3.2.3. (a) [n = 8] 8!. (b) 8! . (:). (c) (8!)2. 
</p>
<p>3.3 Anagrams 
</p>
<p>3.3.1. 13!/23 . 
</p>
<p>3.3.2. COMBINATORICS. 
</p>
<p>3.3.3. Most: any word with 13 different letters; least: any word with 13 
</p>
<p>identical letters. 
</p>
<p>3.3.4. (a) 266 . 
</p>
<p>(b) (246) ways to select the four letters that occur; for each selection, (~) 
</p>
<p>ways to select the two letters that occur twice; for each selection, we dis-
</p>
<p>tribute 6 positions to these letters (2 of them get 2 positions); this gives 
</p>
<p>2?~! ways. Thus we get (2;) m 2?~!' (There are many other ways to arrive 
at the same number!) 
</p>
<p>(c) Number of ways to partition 6 into a sum of positive integers: 
</p>
<p>6=6=5+1=4+2=4+1+1=3+3=3+2+1=3+1+1+1 
</p>
<p>= 2 + 2 + 2 = 2 + 2 + 1 + 1 = 2 + 1 + 1 + 1 + 1 = 1 + 1 + 1 + 1 + 1 + 1, 
</p>
<p>which makes 11 possibilities. 
</p>
<p>(d) This is too difficult in this form. What we meant is the following: how 
</p>
<p>many words of length n are there such that none is an anagram of another? 
</p>
<p>This means distributing n pennies to 26 children, and so the answer is 
(n+25) 
</p>
<p>25 . 
</p>
<p>3.4 Distributing Money 
</p>
<p>3.4.1. (n-k-1). 
k-1 
</p>
<p>3.4.2. (n+k-1). 
&pound;+k-1 
</p>
<p>3.4.3. ep+k -1). 
k-1 
</p>
<p>3.5 Pascal's Triangle 
</p>
<p>3.5.1. This is the same as (~) = (n~k)' </p>
<p/>
</div>
<div class="page"><p/>
<p>258 16. Answers to Exercises 
</p>
<p>3.5.2. (~) = (~) = 1 (e.g., by the general formula for the binomial coeffi-
cients). 
</p>
<p>3.6 Identities in Pascal's Triangle 
</p>
<p>3.6.1. 
</p>
<p>3.6.2. The coefficient of xnyn in 
</p>
<p>is 
</p>
<p>3.6.3. The left-hand side counts all k-element subsets of an (n + m)-
element set by distinguishing them according to how many elements they 
</p>
<p>pick up from the first n. 
</p>
<p>3.6.4. If the largest element is j (which is at least n + 1), then the rest 
can be chosen e~l) ways. If we sum over all j ~ n + 1, we get the identity 
</p>
<p>Using that (n~i) = (nti) , we get (3.5). 
</p>
<p>3.7 A Bird's Eye View of Pascal's Triangle 
</p>
<p>3.7.1. n = 3k + 2. 
</p>
<p>3.7.2. This is not easy. We want to determine the first value of k where 
</p>
<p>the difference of differences turns nonpositive: </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 259 
</p>
<p>We can divide the equation by (k::l) and multiply by k(k + 1) to get 
</p>
<p>(n - k + l)(n - k) - 2(n - k + l)(k + 1) + k(k + 1) ::; o. 
</p>
<p>Simplifying, we obtain 
</p>
<p>4k2 - 4nk + n2 - n - 2 &lt; o. 
</p>
<p>Solving for k, we get that the left-hand side is nonpositive between the two 
</p>
<p>roots: 
n 1 n 1 - - -vn + 2 &lt; k &lt; - + -vn + 2. 
2 2 - -2 2 
</p>
<p>So the first integer k for which this is nonpositive is 
</p>
<p>3.8 An Eagle's-Eye View: Fine Details 
</p>
<p>3.8.2. We apply the lower bound in Lemma 2.5.1 to the logarithms. For 
</p>
<p>a typical term, we get 
</p>
<p>In(m+t-k) ~ ~-1 
m - k m+t-k 
</p>
<p>m-k 
</p>
<p>t 
</p>
<p>m+t-k' 
</p>
<p>and so 
</p>
<p>n -- +n +&middot;&middot;&middot;+n 1 ( m+t) 1 (m+t-1) 1 ( m+1 ) 
m m-1 m-t+1 
</p>
<p>t t t 
&gt;--+ + ... +--. 
- m+t m+t-1 m+1 
</p>
<p>We replace each denominator by the largest one to decrease the sum: 
</p>
<p>t t t t2 
--+ + ... +--&gt;--. 
m+t m+t-1 m+1 - m+t 
</p>
<p>Inverting the steps of taking the logarithm and taking the reciprocal, this 
gives the upper bound in (3.9). 
</p>
<p>3.8.1. (a) We have to show that e- t2 /(m-t+l) ::; e- t2 / m ::; e-t2 /(m+t). 
</p>
<p>This is straightforward using that eX is a monotone increasing function. 
</p>
<p>(b) Take the ratio of the upper and lower bounds; we obtain </p>
<p/>
</div>
<div class="page"><p/>
<p>260 16. Answers to Exercises 
</p>
<p>Here the exponent is 
</p>
<p>t2 t2 (2t - 1)t2 
-------
m-t+1 m+t (m-t+1)(m+t)' 
</p>
<p>In our case, this is 1900/(4h60) ~ 0.772, and so the ratio is eO. 772 ~ 2.1468. 
</p>
<p>3.8.3. By (3.9), we have 
</p>
<p>c:) / (~: t) ~ et2 /(m+t). 
Here the exponent is a monotone increasing function of t for t ~ 0 (to 
</p>
<p>see this, write it as t(l - m~t)' or take its derivative), and so from our 
</p>
<p>assumption that t ~ V mIn C + In C it follows that 
</p>
<p>t 2 (vmlnC + InC)2 InC(m + 2vmlnC + InC) 
-- &gt; =-~-~=====---~ 
m+t - m+vmlnC+lnC m+vmlnC+lnC 
</p>
<p>&gt; InC, 
</p>
<p>which implies that 
</p>
<p>The proof of the other half is similar. 
</p>
<p>4 Fibonacci Numbers 
</p>
<p>4.1 Fibonacci's Exercise 
</p>
<p>4.1.1. Because we use the two previous elements to compute the next. 
</p>
<p>4.1.2. Fn+l' 
</p>
<p>4.1.3. Let us denote by Sn the number of good subsets. If n = 1, then 
S1 = 2 (the empty set and the set {I}. Ifn = 2, then 0, {I}, {2}, so S2=3. 
For any n, if the subset contains n, then it can not contain n - 1, so there 
are Sn-2 subsets of this type; if it does not contain n, then there are Sn-1 
</p>
<p>subsets. So we have the same recursive formula, so Sn = Fn+2. 
</p>
<p>4.2 Lots of Identities 
</p>
<p>4.2.1. It is clear from the recurrence that two odd members are followed 
</p>
<p>by an even, then by two odd numbers again. 
</p>
<p>4.2.2. We formulate the following nasty-looking statement: If n is divisible 
</p>
<p>by 5, then so is Fn; if n has remainder 1 when divided by 5, then Fn has 
</p>
<p>remainder 1; if n has remainder 2 when divided by 5, then Fn has remainder </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 261 
</p>
<p>1; if n has remainder 3 when divided by 5, then Fn has remainder 2; if n 
has remainder 4 when divided by 5, then Fn has remainder 3. This is then 
</p>
<p>easily proved by induction on n. 
</p>
<p>4.2.3. By induction. All of them are true for n = 1 and n = 2. Assume 
that n ~ 3. 
</p>
<p>(a) FI + F3 + F5 + ... + F2n- 1 = (FI + F3 + .,. + F2n-3) + F2n- 1 = 
F2n- 2 + F2n- 1 = F2n &middot; 
</p>
<p>(b) Fo - FI +F2 - F3 + ... - F2n- 1 +F2n = (Fo - FI +F2 - .. . +F2n- 2) + 
(-F2n- 1 + F2n ) = (F2n- 3 - 1) + F2n- 2 = F2n- 1 - 1. 
</p>
<p>(c) FJ+Fr+Fj+ .. . +F~ = (FJ+Fr+" .+F~_I)+F~ = Fn-IFn +F~ = 
Fn(Fn-1 + Fn) = Fn' Fn+l . 
</p>
<p>(d) Fn-IFn+1 - F~ = Fn-l(Fn-1 + Fn) - F~ = F~_I + Fn(Fn-1 - Fn) = 
F~_I -FnFn-2 = _(_l)n-1 = (_l)n. 
</p>
<p>4.2.4. We can write (4.1) as Fn- I = Fn+1 - Fn , and use this to compute 
</p>
<p>Fn for negative n recursively (going backwards): 
</p>
<p>... , -21, 13, -8, 5, -3, 2, -1, 1, O. 
</p>
<p>It is easy to recognize that these are the same as the ordinary Fibonacci 
</p>
<p>numbers, except that every second number has a negative sign. As a for-
</p>
<p>mula, we have 
F_n = (_l)n+IFn . 
</p>
<p>This is now easily proved by induction on n. It is true for n = 0,1, and 
</p>
<p>assuming that it is true for nand n - 1, we get for n + 1, 
</p>
<p>F-(n+l) = F-(n-I) - F_n = (_l)n Fn- I - (-It+1 Fn 
</p>
<p>= (_l)n(Fn_1 + Fn) = (_l)n Fn+1 = (_l)n+2 Fn+l, 
</p>
<p>which completes the induction. 
</p>
<p>4.2.5. 
</p>
<p>Replacing n by 2n - 1, we get the recurrence for odd-index Fibonacci 
</p>
<p>numbers. Using this to prove (4.2): 
</p>
<p>F;+I + F; = (Fn + Fn_ I )2 + F; = 2F; + FLI + 2FnFn- 1 
</p>
<p>= 3F; + 2F;_1 - (Fn - Fn_ I )2 = 3F; + 2FLl - FL2 
</p>
<p>= 3(F; + F;_I) - (F;-l + FL2) = 3F2n- 1 - F2n- 3 
</p>
<p>= F2n+l &middot; </p>
<p/>
</div>
<div class="page"><p/>
<p>262 16. Answers to Exercises 
</p>
<p>4.2.6. The identity is 
</p>
<p>(n) (n - 1) (n - 2) (n - k) o + 1 + 2 + ... + k = Fn+l' 
where k = l n/2 J. Proof by induction. True for n = 0 and n = 1. Let n 2 2. 
Assume that n is odd; the even case is similar, except that the last term 
</p>
<p>below needs a little different treatment. 
</p>
<p>4.2.7. (4.2) follows by taking a = b = n -1. (4.3), follows by taking a = n, 
b=n-1. 
4.2.8. Let n = km. We use induction on m. For m = 1 the assertion is 
obvious. If m &gt; 1, then we use (4.5) with a = k(m - 1), b = k - 1: 
</p>
<p>By the induction hypothesis, both terms are divisible by Fa. 
</p>
<p>4.2.9. The "diagonal" is in fact a very long and narrow parallelogram 
</p>
<p>with area 1. The trick depends on the fact Fn+1Fn- 1 - F~ = (_l)n is very 
small compared to F~. </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 263 
</p>
<p>4.3 A Formula for the Fibonacci Numbers 
</p>
<p>4.3.1. True for n = 0, 1. Let n ?: 2. Then by the induction hypothesis, 
</p>
<p>Fn = Fn- 1 + Fn- 2 
</p>
<p>= )g ( (1+2)5) .-, _ (1-2)5) '-') 
</p>
<p>+ )g ( (1+2)5) .-2 _ (1-2)5) n-,) 
</p>
<p>= )g ( (1+2)5) .-2 (1+2)5 +1) + (1-2)5) .-2 (1-2)5 +1) ) 
</p>
<p>= )g (( 1+2)5)" -C-2)5n 
</p>
<p>4.3.2. For n = 1 and n = 2, if we require that Ln be of the given form, 
then we get 
</p>
<p>L1 = 1 = a+b, L2 = 3 = a 1 + J5 + b 1 - J5. 
2 2 
</p>
<p>Solving for a and b, we get 
</p>
<p>Then 
</p>
<p>1+J5 
a= --2-' 
</p>
<p>1-J5 
b=-2-&middot; 
</p>
<p>L. = C+2)5r + C-2)5)", 
which follows by induction on n just as in the previous problem. 
</p>
<p>4.3.3. (a) For example, every day Jack buys either an ice cream for $1 or 
</p>
<p>a giant sundae for $2. There are 4 different flavors of ice cream, but only 
one kind of sundae. If he has n dollars, in how many ways can he spend 
</p>
<p>the money? 
</p>
<p>4.3.4. The formula works for n = 1,2, ... , 10 but fails for n = 11, when 
</p>
<p>it gives 91. In fact, it will be more and more off as we increase n. We have 
</p>
<p>seen that 
</p>
<p>1 (1 + J5)n n Fn rv J5 2 = (0.447 ... ) . (1.618 ... ) . </p>
<p/>
</div>
<div class="page"><p/>
<p>264 16. Answers to Exercises 
</p>
<p>In the formula of Alice, the rounding plays less and less of a role, so 
</p>
<p>I en / 2- 1l rv en / 2- 1 = (0.367 ... ) . (1.648 ... )n, 
</p>
<p>and so the ratio between Alice's numbers and the corresponding Fibonacci 
</p>
<p>numbers is 
</p>
<p>I en / 2- 11 ~ (0.367 ... ) . (1.648 .. . )n = (2 ) . (1 018 )n -'---,:---'- ~ 0.8 2... . . . . . 
Fn 0.447 ... 
</p>
<p>Since the base of the exponential is larger than 1, this tends to infinity as 
</p>
<p>n grows. 
</p>
<p>5 Combinatorial Probability 
</p>
<p>5.1 Events and Probabilities 
</p>
<p>5.1.1. The union of two events A and B corresponds to "A or B", i.e., at 
</p>
<p>least one of A or B occurs. 
</p>
<p>5.1.2. It is the sum of some of the probabilities of outcomes, and even if 
</p>
<p>we add up all of the probabilities, we get just 1. 
</p>
<p>5.1.3. P(E) = ~, P(T) = ~. 
</p>
<p>5.1.4. The same probabilities P(s) are added up on both sides. 
</p>
<p>5.1.5. Every probability P(s) with s E AnB is added twice to both sides; 
every probability P( s) with sEA U B but s tJ. An B is added once to both 
sides. 
</p>
<p>5.2 Independent Repetition of an Experiment 
</p>
<p>5.2.1. The pairs (E, T), (0, T), (L, T) are independent. The pair (E,O) is 
exclusive. Neither the pair (E, L) nor the pair (0, L) is independent. 
</p>
<p>5.2.2. P(0 n A) = P(0) = 0 = P(0)P(A). The set S also has this property: 
P(S n A) = P(A) = P(S)P(A). 
</p>
<p>_ ISl n - 1 _ 1 _ ISl n - 1 _ 1 _ ISln- 2 _ 
5.2.3. P(A) - lSF" - TST' P(B) - lSF" - TST' P(A n B) - ISln -
</p>
<p>lil2 = P(A)P(B). 
</p>
<p>5.2.4. The probability that your mother has the same birthday as you 
</p>
<p>is 1/365 (here we assume that birthdays are distributed evenly among all 
</p>
<p>numbers of the year, and we ignore leap years). There are (roughly) 7 billion 
</p>
<p>people in the word. This means that one could expect that 7.109 /365 (about 
</p>
<p>20 million) people have the same birthday as their mother. The events that 
</p>
<p>your birthday coincides with that of your mother, father, or spouse are 
</p>
<p>independent, so the probability that for a given person, all three were born </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 265 
</p>
<p>on his or her birthday is 1/3653 = 1/48,627,125. Let's say there are 2 billion 
married people; then we can expect that 2,000,000,000/48,627,125 ~ 41 of 
</p>
<p>them have the same birthday as their mother, father, and spouse. 
</p>
<p>6 Integers, Divisors, and Primes 
</p>
<p>6.1 Divisibility of Integers 
</p>
<p>6.1.1. a = a&middot;1 = (-a)&middot; (-1). 
</p>
<p>6.1.2. (a) even; (b) odd; (c) a = O. 
</p>
<p>6.1.3. (a) If b = am and e = bn, then e = amn. (b) If b = am and e = an, 
then b + e = a(m + n) and b - e = a(m - n). (c) If b = am and a, b &gt; 0, 
then m &gt; 0; hence m ~ 1, and so b ~ a. (d) Trivial if a = O. Assume a =J O. 
If b = am and a = bn, then a = amn, so mn = 1. Hence either m = n = 1 
or m = n =-1. 
</p>
<p>6.1.4. We have a = en and b = em, hence r = b - aq = e(m - nq). 
</p>
<p>6.1.5. We have b = am, e = aq + rand e = bt + s. Hence s = e - bt = 
(aq + r) - (am)t = (q - mt)a + r. Since 0 ::; r &lt; a, the remainder of the 
division s -;- a is r. 
</p>
<p>6.1.6. (a) a2 -1 = (a-1)(a+1). (b) an -1 = (a-1)(an - 1 + ... +a+1). 
</p>
<p>6.3 Factorization into Primes 
</p>
<p>6.3.1. There is a smallest one among positive criminals (indeed, in every 
</p>
<p>set of positive integers), but a set of negative integers need not have a 
</p>
<p>smallest element (if it is infinite). 
</p>
<p>6.3.2. Yes, the number 2. 
</p>
<p>6.3.3. (a) P occurs in the prime factorization of ab, so it must occur in 
</p>
<p>the prime factorization of a or in the prime factorization of b. 
</p>
<p>(b) P I a(b/a), but pta, so by (a), we must have p I (b/a). 
</p>
<p>6.3.4. Let n = PIP2'" Pk; each Pi ~ 2; hence n ~ 2k. 
</p>
<p>6.3.5. If ri = rj, then ia - ja is divisible by p. But ia - ja = (i - j)a and 
</p>
<p>neither a nor i - j is divisible by p. Hence the ri are all different. None of 
</p>
<p>them is O. Their number is P - 1, so every value 1,2, ... ,p - 1 must occur 
</p>
<p>among the rio 
</p>
<p>6.3.6. For a prime p, the proof is the same as for 2. If n is composite but 
</p>
<p>not a square, then there is a prime p that occurs in the prime factorization 
</p>
<p>of n an odd number of times. We can repeat the proof by looking at this p. 
</p>
<p>6.3.7. Fact: If vn is not an integer, then it is irrational. Proof: There is a 
prime that occurs in the prime factorization of n, say t times, where k t t. If </p>
<p/>
</div>
<div class="page"><p/>
<p>266 16. Answers to Exercises 
</p>
<p>(indirect assumption) vn = alb then nbk = ak , and so the number of times 
p occurs in the prime factorization of the left-hand side is not divisible by 
</p>
<p>k, while the number of times it occurs in the prime factorization of the 
</p>
<p>right-hand side is divisible by k. A contradiction. 
</p>
<p>6.4 On the Set of Primes 
</p>
<p>6.4.1. Just as in the treatment of the case k = 200 above, we subtract the 
number of primes up to 10k - 1 from the number of primes up to 10k . By 
</p>
<p>the Prime Number Theorem, this number is about 
</p>
<p>Since 
</p>
<p>10k lOk - 1 
-- - --,-------:---
klnlO (k-1)lnlO 
</p>
<p>(9k - 1O)lOk - 1 
</p>
<p>k(k-1)ln10 
</p>
<p>9k -10 _ 9 1 
k-1 - -k-1 
</p>
<p>is very close to 9 if k is large, we get that the number of primes with k 
</p>
<p>digits is approximately 
9. lOk - 1 
</p>
<p>kIn 10 . 
</p>
<p>Comparing this with the total number of positive integers with k digits, 
</p>
<p>which we know is 10k - lOk - 1 = 9 . 10k - I , we get 
</p>
<p>9&middot;10k - 1 1 1 
</p>
<p>kIn 10 . 9 . lOk - 1 (In 10)k f':;:; 2.3k 
</p>
<p>6.5 Fermat's "Little" Theorem 
</p>
<p>6.5.1. 4 f @ = 6. 4 f24 - 2 = 14. 
</p>
<p>6.5.2. (a) We need that each of the p rotated copies of a set are different. 
</p>
<p>Suppose that there is a rotated copy that occurs a times. Then trivially 
</p>
<p>every other rotated copy occurs a times. But then a I p, so we must have 
a = lora = p. If all p rotated copies are the same, then trivially either 
k = 0 or k = p, which were excluded. So we have a = 1 as claimed. (b) 
Consider the set of two opposite vertices of a square. (c) If each box contains 
</p>
<p>p subsets of size k, the total number of subsets must be divisible by p. 
</p>
<p>6.5.3. We consider each number to have p digits by appending zeros at the 
</p>
<p>front if necessary. We get p numbers from each number a by a cyclic shift. 
</p>
<p>These are all the same when all digits of a are the same, but all different 
</p>
<p>otherwise (why? the assumption that p is a prime is needed here!). So we 
</p>
<p>get aP - a numbers that are divided into classes of size p. Thus p I aP - a. 
</p>
<p>6.5.4. Assume that p f a. Consider the product a(2a)(3a) .. . ((p - l)a) = 
(p - 1)!aP - 1 &bull; Let ri be the remainder of ia when divided by p. Then the </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 267 
</p>
<p>product above has the same remainder when divided by p as the product 
</p>
<p>TIT2&middot;&middot;&middot; Tp-I. But this product is just (p - I)!. Hence p is a divisor of (p-
l)!aP- 1 - (p -I)! = (p -l)!(aP- 1 -1). Since p is a prime, it is not a divisor 
of (p - I)!, and so it is a divisor of aP- 1 - 1. 
</p>
<p>6.6 The Euclidean Algorithm 
</p>
<p>6.6.1. gcd(a, b) ::; a, but a is a common divisor, so gcd(a, b) = a. 
</p>
<p>6.6.2. (a) Let d = gcd(a,b). Then d I a and d I b, and hence d I b-a. Thus 
d is a common divisor of a and b - a, and hence d ::; gcd( a, b). A similar 
argument shows the reverse inequality. (b) By repeated application of (a). 
</p>
<p>6.6.3. (a) gcd(a/2, b) I (a/2) and hence gcd(a/2, b) I a. So gcd(a/2, b) 
is a common divisor of a and b, and hence gcd(a/2, b) ::; gcd(a, b). The 
reverse inequality follows similarly, using that gcd(a, b) is odd, and hence 
</p>
<p>gcd(a, b) I (a/2). 
</p>
<p>(b) gcd(a/2, b/2) I (a/2) and hence 2gcd(a/2, b/2) I a. Similarly, we 
have 2gcd(a/2, b/2) I b, and hence 2gcd(a/2, b/2) ::; gcd(a, b). Conversely, 
gcd(a, b) I a and hence ~gcd(a, b) I a/2. Similarly, ~gcd(a, b) I b/2, and 
hence ~gcd(a, b) ::; gcd(a/2, b/2). 
</p>
<p>6.6.4. Consider each prime that occurs in either one of them, raise it to 
</p>
<p>the larger of the two exponents, and multiply these prime powers. 
</p>
<p>6.6.5. If a and b are the two integers, and you know the prime factorization 
</p>
<p>of a, then take a prime factor of a, divide b by this prime repeatedly to 
</p>
<p>determine its exponent in the prime factorization of b, and raise this prime 
</p>
<p>to the smaller of its exponent in the prime factorizations of a and b. Repeat 
</p>
<p>this for all prime factors of a, and multiply these prime powers. 
</p>
<p>6.6.6. By the descriptions of the gcd and lcm above, each prime occurs 
</p>
<p>the same number of times in the prime factorization of both sides. 
</p>
<p>6.6.7. (a) Straightforward. (b) Let z = gcd(a,b,c), and let A = a/z, 
B = b / z, C = c / z. Then A, B, and C are relatively prime and form a 
Pythagorean triple. One of A and B must be odd, since if both of them 
</p>
<p>were even, then C would be even as well, and so the three numbers would 
</p>
<p>not be relatively prime. Suppose that B is odd. Then A must be even. 
</p>
<p>Indeed, the square of an odd number gives a remainder of 1 when divided 
</p>
<p>by 4, so if both A and B were odd, then C2 = A2 + B2 would give a 
remainder of 2 when divided by 4, which is impossible. It follows that C 
</p>
<p>must be odd. 
</p>
<p>So A is even, and we can write it in the form A = 2Ao. Write the equation 
in the form </p>
<p/>
</div>
<div class="page"><p/>
<p>268 16. Answers to Exercises 
</p>
<p>Let p be any prime number dividing Ao. Then p must divide either (C + 
B) /2 or (C - B) /2. But p cannot divide both, since then it would also 
divide the sum C+B + C-B = C as well as the difference C+B - C-B = B 
</p>
<p>2 2 2 2 ' 
</p>
<p>contradicting the assumption that A, B, and C are relatively prime. 
</p>
<p>The prime p may occur in the prime decomposition of Ao several times, 
</p>
<p>say k times. Then in the prime decomposition of A6, p occurs 2k times. By 
the argument above, p must occur 2k times in the prime decomposition of 
</p>
<p>one of (C + B) /2 and (C - B) /2, and not at all in the prime decomposition 
of the other. So we see that in the prime decomposition of (C + B) /2 (and 
similarly in the prime decomposition of (C - B)/2), every prime occurs 
to an even power. This is the same as saying that both (C + B) /2 and 
(C - B) /2 are squares; say, (C + B) /2 = x 2 and (C - B) /2 = y2 for some 
integers x and y. 
</p>
<p>Now we can express A, B, and C in terms of x and y: 
</p>
<p>C = C + B + C - B = x2 + y2 
22' 
</p>
<p>/C+BC-B 
A = 2Ao = 2Y-2--2- = 2xy. 
</p>
<p>We get a, b, and c by multiplying A, B, and C by z, which completes the 
</p>
<p>solution. 
</p>
<p>6.6.8. gcd(a, a + 1) = gcd(a, 1) = gcd(O, 1) = 1. 
</p>
<p>6.6.9. The remainder of Fn+1 divided by Fn is Fn- 1 . Hence 
</p>
<p>gcd(Fn+l' Fn) = gcd(Fn, Fn-d = ... = gcd(F3, F2 ) = 1. This lasts n - 1 
steps. 
</p>
<p>6.6.10. By induction on k. True if k = 1. Suppose that k &gt; 1. Let 
b = aq + r, 1 :S r &lt; a. Then the Euclidean Algorithm for computing 
gcd(a,r) lasts k - 1 steps; hence a :2': Fk and r :2': Fk- 1 by the induction 
hypothesis. But then b = aq + r :2': a + r :2': Fk + Fk- 1 = Fk+1' 
</p>
<p>6.6.11. (a) Takes 10 steps. (b) Follows from gcd(a,b) = gcd(a - b,b). (c) 
gcd(10100 - 1,10100 - 2) takes 10100 - 1 steps. 
</p>
<p>6.6.12. (a) Takes 8 steps. (b) At least one of the numbers remains odd 
</p>
<p>all the time. (c) Follows from Exercises 6.6.2 and 6.6.3. (d) The product of 
</p>
<p>the two numbers drops by a factor of two in one of any two iterations. 
</p>
<p>6.7 Congruences 
</p>
<p>6.7.1. m = 54321- 12345 = 41976. 
</p>
<p>6.7.2. Only (b) is correct. 
</p>
<p>6.7.3. a == b (mod 0) should mean that there exists an integer k such 
that a - b = 0 . k. This means that a - b = 0, that is, a = b. So equality 
</p>
<p>can be considered as a special case of congruence. </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 269 
</p>
<p>6.7.4. (a) Take a = 2 and b = 5. (b) If ae == be (mod me), then me I ae-be, 
so there is an integer k such that ae - be = kme. Since e #- 0, this implies 
that a - b = km, and so a == b (mod m). 
</p>
<p>6.7.5. First, from x == y (mod p) it follows (by the multiplication rule) 
that XV == yV (mod p), so it suffices to prove that 
</p>
<p>(16.1) 
</p>
<p>If x == 0 (mod p), then both sides of (16.1) are divisible by p, and the 
assertion follows. Suppose that x =1= 0 (mod p). Suppose that (say) u &lt; v. 
We know that p - 1 I v - u, so we can write v - U = k(p - 1) with 
some positive integer k. Now we know by Fermat's Little Theorem that 
</p>
<p>x p - 1 == 1 (mod p), hence by the multiplication rule of congruences, we 
have Xk(p-l) == 1 (mod p), and by the multiplication rule again, we get 
XV = xu. Xk(p-l) == XU (mod p), which proves (16.1). 
</p>
<p>6.8 Strange Numbers 
</p>
<p>6.8.1. Tu; Sa; Th; We. 
</p>
<p>6.8.2. not-A = 1 EEl A; A-or-B = A EEl B EEl A . B; A-and-B = A . B. 
</p>
<p>6.8.3. 2&middot; 0 == 2 . 3 (mod 6) but 0 =1= 3 (mod 6). More generally, if 
m = ab (a, b &gt; 1) is a composite modulus, then a&middot; 0 == a&middot; b (mod m), but 
0=1= b (mod m). 
</p>
<p>6.8.4. We start with the Euclidean Algorithm: 
</p>
<p>gcd(53, 234527) = gcd(53, 2) = gcd(l, 2) = 1. 
</p>
<p>Here we got 2 as 2 = 234527 - 4425 . 53, and then 1 as 
</p>
<p>1 = 53 - 26&middot;2 = 53 - 26(234527 - 4425&middot;53) = l15051 . 53 - 26 . 234527. 
</p>
<p>It follows that 1 == l15051 &middot;53 (mod 234527), and so 1/53 = l15051. 
</p>
<p>6.8.5. x == 5, y == 8 (mod l1). 
</p>
<p>6.8.6. (a) We have l11 x2-2x = x(x-2); hence either l11 x or l11 x-2, 
</p>
<p>so x == 0 (mod 11) and x == 2 (mod l1) are the two solutions. (b) Similarly 
from 231 x2-4 = (x-2)(x+2) we get x == 2 (mod 23) or x == -2 (mod 23). 
</p>
<p>6.9 Number Theory and Combinatorics 
</p>
<p>6.9.1. There are two neighboring integers k and k + 1 among the given n 
numbers (Pigeonhole Principle) that are relatively prime. 
</p>
<p>6.9.2. By the rules of inclusion-exclusion, we have to subtract from n the 
</p>
<p>number of multiples of Pi (between 1 and n) for every Pi; then we have to </p>
<p/>
</div>
<div class="page"><p/>
<p>270 16. Answers to Exercises 
</p>
<p>add the number of common multiples of Pi and Pj for any two primes Pi 
</p>
<p>and Pj; then we have to subtract the number of common multiples of Pi, 
</p>
<p>Pj, and Pk for any three primes Pi, Pj, and Pk, etc. Just as in the numerical 
</p>
<p>example, the number of multiples of Pi is n/pi; the number of common 
</p>
<p>multiples of Pi and Pj is n/(PiPj); the number of common multiples of Pi, 
</p>
<p>Pj, and Pk is n/(PiPjPk), etc. So we get 
</p>
<p>n n n n n n 
&cent;(n) = n - - - ... - - + - + - + ... + -- - -- - .... 
</p>
<p>PI Pr P1P2 PIP3 Pr-lPr PIP2P2 
</p>
<p>This is equal to the expression in (6.7). Indeed, if we expand the product, 
</p>
<p>every term arises by picking either "I" or "-*" from each factor (1- *), 
which gives a term of the form 
</p>
<p>1 (_I)k __ _ 
Pi, ... Pik 
</p>
<p>This is just a typical term in the inclusion-exclusion formula above. 
</p>
<p>6.9.3. It is not hard to come up with the conjecture that the answer is 
</p>
<p>n. To prove this, consider the fractions ~, ~, ... , ~, and simplify them as 
</p>
<p>much as possible. We get fractions of the form ~, where d is a divisor of 
</p>
<p>n, 1 :s; a :s; d, and gcd( a, d) = 1. It is also clear that we get every such 
fraction. The number of such fractions with a given denominator is &cent;(d). 
Since the total number of fractions we started with is n, this proves our 
</p>
<p>conjecture. 
</p>
<p>6.9.4. For n = 1 and 2 the answer is 1. Suppose that n &gt; 2. If k is such 
an integer, then so is n - k. So these integers come in pairs adding up to n 
</p>
<p>(we have to add that n/2 is not among these numbers). There are &cent;(n)/2 
</p>
<p>such pairs, so the answer is n&cent;( n) /2. 
</p>
<p>6.9.5. The proof is similar to the solution of Exercise 6.5.4. 
</p>
<p>Let SI, ... , Sk be the numbers between 1 and b relatively prime to b; so 
</p>
<p>k = &cent;(b). Let ri be the remainder of Sia when divided by p. We have 
gcd(b, ri) = 1, since if there were a prime P dividing both band ri, then P 
would also divide Sia, which is impossible, since both Si and a are relatively 
</p>
<p>prime to b. Second, rl, r2,"" rk are different, since ri = rj would mean 
that b I Sia - sja = (Si - Sj )a; since gcd( a, b) = 1, this would imply that 
b I Si - Sj, which is clearly impossible. Hence it follows that r1, r2, ... ,rk 
are just the numbers Sl, S2, ... , Sk, in a different order. 
</p>
<p>Consider the product (sla)(s2a) ... (Ska). On the one hand, we can write 
</p>
<p>this as 
</p>
<p>on the other, </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 271 
</p>
<p>Comparing, we see that 
</p>
<p>or 
</p>
<p>b I (Sl S2&middot;&middot;&middot; sk)(ak -1). 
Since SlS2 ... Sk is relatively prime to b, this implies that b I a k - 1 as 
</p>
<p>claimed. 
</p>
<p>6.10 How to Test Whether a Number is a Prime 
</p>
<p>6.lD.1. By induction on k. True if k = 1. Let n = 2m + a, where a is 0 
or 1. Then m has k - 1 bits, so by induction, we can compute 2m using at 
</p>
<p>most 2(k - 1) multiplications. Now 2n = (2m)2 if a = 0 and 2n = (2m)2 &middot;2 
if a = 1. 
</p>
<p>6.10.2. If 3 I a, then clearly 3 I a 561 - a. If 3 f a, then 3 I a2 -1 by Fermat, 
hence 3 I (a2)280 - 1 = a 560 - 1. Similarly, if 11 f a, then 11 I a 10 - 1 and 
hence 11 I (a 10 )56 -1 = a560 -1. Finally, if 17 f a, then 17 I a 16 -1 and 
hence 17 I (a16 )35 -1 = a560 _1. 
</p>
<p>7 Graphs 
</p>
<p>7.1 Even and Odd Degrees 
</p>
<p>7.1.1. There are 2 graphs on 2 nodes, 8 graphs on 3 nodes (but only 
</p>
<p>four "essentially different"), 64 graphs on 4 nodes (but only 11 "essentially 
</p>
<p>different" ) . 
</p>
<p>7.1.2. (a) No; the number of odd degrees must be even. (b) No; node 
</p>
<p>with degree 5 must be connected to all other nodes, so we cannot have a 
</p>
<p>node with degree o. (c) 12 (but they are all "essentially the same"). (d) 
9 . 7 . 5 . 3 . 1 = 945 (but again they are all "essentially the same"). 
</p>
<p>7.1.3. This graph (which we will call a complete graph) has G) edges if it 
has n nodes. 
</p>
<p>7.1.4. In graph (a), the number of edges is 17, the degrees are 
</p>
<p>9,5,3,3,2,3,1,3,2,3. In graph (b), the number of edges is 31, the degrees 
</p>
<p>are 9,5,7,5,8,3,9,5,7,4. 
</p>
<p>7.1.5. C20) = 45. 
</p>
<p>7.1.6. 2(22&deg;) = 2190. 
</p>
<p>7.1.7. Every graph has two nodes with the same degree. Since each degree 
</p>
<p>is between 0 and n - 1, if all degrees were different, then they would be 
0,1,2,3, ... n -1 (in some order). But the node with degree n - 1 must be </p>
<p/>
</div>
<div class="page"><p/>
<p>272 16. Answers to Exercises 
</p>
<p>connected to all the others, in particular to the node with degree 0, which 
</p>
<p>is impossible. 
</p>
<p>7.2 Paths, Cycles, and Connectivity 
</p>
<p>7.2.1. There are 4 paths, 6 cycles, and 1 complete graph. 
</p>
<p>7.2.2. The edgeless graph on n nodes has 2n subgraphs. The triangle has 
</p>
<p>18 subgraphs. 
</p>
<p>7.2.3. The path oflength 3 and the cycle of length 5 are the only examples. 
</p>
<p>(The complement of a longer path or cycle has too many edges.) 
</p>
<p>7.2.4. Yes, the proof remains valid. 
</p>
<p>7.2.5. (a) Delete any edge from a path. (b) Consider two nodes u and 
</p>
<p>v. the original graph contains a path connecting them. If this does not go 
</p>
<p>through e, then it remains a path after e is deleted. If it goes through e, 
</p>
<p>then let e = xy, and assume that the path reaches x first (when traversed 
from u to v). Then after e is deleted, there is a path in the remaining graph 
</p>
<p>from u to x, and also from x to y (the remainder of the cycle), so there is 
</p>
<p>one from u to y. But there is also one from y to v, so there is also a path 
</p>
<p>from u to v. 
</p>
<p>7.2.6. (a) Consider a shortest walk from u to v; if this goes through any 
</p>
<p>nodes more than once, the part of it between two passes through this node 
</p>
<p>can be deleted, to make it shorter. (b) The two paths together form a walk 
</p>
<p>from a to c. 
</p>
<p>7.2.7. Let w be a common node of Hl and H 2 . If you want a path between 
</p>
<p>nodes u and v in H, then you can take a path from u to w, followed by a 
</p>
<p>path from w to v, to get a walk from u to w. 
</p>
<p>7.2.8. Both graphs are connected. 
</p>
<p>7.2.9. The union of this edge and one of these components would form a 
</p>
<p>connected graph that is strictly larger than the component, contradicting 
</p>
<p>the definition of a component. 
</p>
<p>7.2.10. If u and v are in the same connected component, then this com-
</p>
<p>ponent, and hence G too, contains a path connecting them. Conversely, if 
</p>
<p>there is a path P in G connecting u and v, then this path is a connected 
</p>
<p>subgraph, and a maximal connected subgraph containing P is a connected 
</p>
<p>component containing u and v. 
</p>
<p>7.2.11. Assume that the graph is not connected and let a connected 
</p>
<p>component H of it have k nodes. Then H has at most (~) edges. The rest 
</p>
<p>of the graph has at most (n;k) edges. Then the number of edges is at most 
</p>
<p>(k) (n - k) (n - 1) (n - 1) 2 + 2 = 2 -(k-l)(n-k-l)::; 2 . </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 273 
</p>
<p>7.13 Eulerian Walks and Hamiltonian Cycles 
</p>
<p>7.3.1. The upper left graph does not have an Eulerian walk. The lower 
</p>
<p>left graph has an open Eulerian walk. The two graphs on the right have 
</p>
<p>closed Eulerian walks. 
</p>
<p>7.3.2. Every node with an odd degree must be the endpoint of one of the 
</p>
<p>two walks, so a necessary condition is that the number of nodes with odd 
</p>
<p>degree to be at most four. We show that this condition is also sufficient. 
</p>
<p>We know that the number of nodes with odd degree is even. If this number 
</p>
<p>is 0 or 2, then there is a single Eulerian walk (and we can take any single 
</p>
<p>node as the other walk). 
</p>
<p>Suppose that this number is four. Add a new edge connecting two of the 
</p>
<p>nodes with odd degree. Then there are only two nodes with odd degree left, 
</p>
<p>so the graph has an Eulerian walk. Deleting the edge splits this walk into 
</p>
<p>two, which together use every edge exactly once. 
</p>
<p>7.3.3. The first graph does; the second does not. 
</p>
<p>8 Trees 
</p>
<p>8.1 How to Define a Tree 
</p>
<p>8.1.1. If G is a tree, then it contains no cycles (by definition), but adding 
</p>
<p>any new edge creates a cycle (with the path in the tree connecting the 
</p>
<p>endpoints of the new edge). Conversely, if a graph has no cycles but adding 
</p>
<p>any edge creates a cycle, then it is connected (either two nodes u and v 
</p>
<p>are connected by an edge, or else adding an edge connecting them creates 
</p>
<p>a cycle, which contains a path between u and v in the old graph), and 
</p>
<p>therefore it is a tree. 
</p>
<p>8.1.2. If u and v are in the same connected component, then the new 
</p>
<p>edge uv forms a cycle with the path connecting u and v in the old graph. 
</p>
<p>If joining u and v by a new edge creates a cycle, then the rest of this cycle 
</p>
<p>is a path between u and v, and hence u and v are in the same component. 
</p>
<p>8.1.3. Assume that G is a tree. Then there is at least one path between 
</p>
<p>two nodes, by connectivity. But there cannot be two paths, since then we 
</p>
<p>would get a cycle (find the node v where the two paths branch away, and 
</p>
<p>follow the second path until it hits the first path again; follow the first path 
</p>
<p>back to v to get a cycle). 
</p>
<p>Conversely, assume that there is a unique path between each pair of nodes. 
</p>
<p>Then the graph is connected (since there is a path) and cannot contain a 
</p>
<p>cycle (since two nodes on the cycle would have at least two paths connecting 
</p>
<p>them). </p>
<p/>
</div>
<div class="page"><p/>
<p>274 16. Answers to Exercises 
</p>
<p>8.2 How to Grow Trees 
</p>
<p>8.2.1. Start the path from a node of degree l. 
</p>
<p>8.2.2. Any edge has only one lord, since if there were two, they would 
</p>
<p>have to start from different ends, and they would have then two ways to 
</p>
<p>get to the king: either continuing as they started, or waiting for the other 
</p>
<p>and walking together. Similarly, an edge with no lord would have to lead 
</p>
<p>to two different ways of walking. 
</p>
<p>8.2.3. Start at any node v. If one of the branches at this node contains 
</p>
<p>more than half of all nodes, move along the edge leading to this branch. 
</p>
<p>Repeat. You'll never backtrack, because this would mean that there is an 
</p>
<p>edge whose deletion results in two connected components, both containing 
</p>
<p>more than half of the nodes. You'll never cycle back to a node already seen, 
</p>
<p>because the graph is a tree. Therefore, you must get stuck at a node such 
</p>
<p>that each branch at this node contains at most half of all nodes. 
</p>
<p>8.3 How to Count Trees 
</p>
<p>8.3.1. The number of unlabeled trees on 2,3,4,5 nodes is 1,1,2,3. They 
</p>
<p>give rise to a total of 1,3, 16, 125 labeled trees. 
</p>
<p>8.3.2. There are n stars and n!/2 paths on n nodes. 
</p>
<p>8.4 How to Store Trees 
</p>
<p>8.4.1. The first is the father code of a path; the third is the father code 
</p>
<p>of a star. The other two are not father codes of trees. 
</p>
<p>8.4.2. This is the number of possible father codes. 
</p>
<p>8.4.3. Define a graph on {I, ... ,n} by connecting all pairs of nodes in the 
</p>
<p>same column. If we do it backwards, starting with the last column, we get a 
</p>
<p>procedure for growing a tree by adding a new node and an edge connecting 
</p>
<p>it to an old node. 
</p>
<p>8.5.1. (a) encodes a path; (b) encodes a star; (c) does not encode any tree 
</p>
<p>(there are more O's than 1 's among the first 5 elements, which is impossible 
</p>
<p>in the planar code of any tree). 
</p>
<p>9 Finding the Optimum 
</p>
<p>9.1 Finding the Best Tree 
</p>
<p>9.1.1. Let H be an optimal tree and let G be the tree constructed by the 
</p>
<p>pessimistic government. Look at the first step at which an edge e = uv 
</p>
<p>of H is eliminated. Deleting e from H we get two components; since G is </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 275 
</p>
<p>connected, it has an edge f connecting these two components. The edge f 
cannot be more expensive than e, or else the pessimistic government would 
</p>
<p>have chosen f to eliminate instead of e. But then we can replace e by f 
in H without increasing its cost. Hence we conclude as in the proof given 
</p>
<p>above. 
</p>
<p>9.1.2. Take nodes 1,2,3,4 and costs c(12) = c(23) = c(34) = c(41) = 3, 
c(13) = 4, c(24) = 1. The pessimistic government builds (12341), while the 
best solution is 12431. 
</p>
<p>9.2 Traveling Salesman 
</p>
<p>9.2.1. No, because it intersects itself (see next exercise). 
</p>
<p>9.2.2. Replacing two intersecting edges by two other edges pairing up the 
</p>
<p>same 4 nodes, just differently, gives a shorter tour by the triangle inequality. 
</p>
<p>10 Matchings in graphs 
</p>
<p>10.1 A Dancing Problem 
</p>
<p>10.1.1. If every degree is d, then the number of edges is d&middot; IAI, but also 
d&middot;IBI&middot; 
10.1.2. (a) a triangle; (b) a star. 
</p>
<p>10.1.3. A graph in which every node has degree 2 is the union of disjoint 
</p>
<p>cycles. If the graph is bipartite, these cycles have even length. 
</p>
<p>10.3 The Main Theorem 
</p>
<p>10.3.1. Let X ~ A and let Y denote the set of neighbors of X in B. There 
</p>
<p>are exactly dlXI edges starting from X. Every node in Y accommodates 
</p>
<p>no more than d of these; hence WI ~ IXI. 
</p>
<p>10.3.2. The assumption for X = A yields that IBI ~ IAI. If IBI = IAI, then 
we already know the assertion (Theorem 10.3.1), so suppose that IBI &gt; IAI. 
Add IBI-IAI new nodes to A to get a set A' with IA'I = IBI. Connect every 
new node to every node in B. The graph we get satisfies the conditions 
</p>
<p>in the Marriage Theorem (Theorem 10.3.1): We have IA'I = IBI, and if 
X ~ A' then either X ~ A (in which case it has at least IXI neighbors in 
B by the assumption of the exercise), or X contains a new node, in which 
</p>
<p>case every node in B is a neighbor of X. So the new graph has a perfect 
</p>
<p>matching. Deleting the newly added nodes, we see that the edges of the 
</p>
<p>perfect matching that remain match all nodes of A with different nodes of 
</p>
<p>B. </p>
<p/>
</div>
<div class="page"><p/>
<p>276 16. Answers to Exercises 
</p>
<p>10.4 How to Find a Perfect Matching 
</p>
<p>10.4.1. On a path with 4 nodes, we may select the middle edge. 
</p>
<p>10.4.2. The edges in the greedy matching M must meet every edge in 
</p>
<p>G (otherwise, we could further extend M), in particular every edge in the 
</p>
<p>perfect matching matching. So every edge in the perfect matching has at 
</p>
<p>most one endpoint unmatched by M. 
</p>
<p>10.4.3. The largest matching has 5 edges. 
</p>
<p>10.4.4. If the algorithm terminates without a perfect matching, then the 
</p>
<p>set S shows that the graph is not "good." 
</p>
<p>11 Combinatorics in Geometry 
</p>
<p>11.1 Intersections of Diagonals 
</p>
<p>11 1 1 n(n-3) &bull; &bull;&bull; 2 . 
</p>
<p>11.2 Counting Regions 
</p>
<p>11.2.1. True for n = 1. Let n &gt; 1. Delete any line. The remaining lines 
divide the plane into (n - 1)n/2 + 1 regions by the induction hypothesis. 
The last line cuts n of these into two. So we get 
</p>
<p>(n-1)n n(n+1) 
2 +l+n= 2 +1. 
</p>
<p>11.3 Convex Polygons 
</p>
<p>11.3.1. See Figure 16.1. 
</p>
<p>-"-, 
</p>
<p>&bull; &bull; i 
.&lt;-----------------------------------------------&gt;. 
</p>
<p>FIGURE 16.1. </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 277 
</p>
<p>12 Euler's Formula 
</p>
<p>12.1 A Planet Under Attack 
</p>
<p>12.1.1. There are n nodes of degree n - 1 and (~) nodes of degree 4 
</p>
<p>(see Section 11.1). So the number of edges is ~ (n . (n - 1) + (~) .4). From 
Euler's Formula, the number of countries is 
</p>
<p>you have to subtract 1 for the country outside. 
</p>
<p>12.1.2. Let f be the number of regions of the island. Consider the graph 
formed by the dams and also the boundary of the island. There are 2n nodes 
</p>
<p>of degree 3 (along the shore), and (~) nodes of degree 4 (the intersection 
</p>
<p>points of straight dams). So the number of edges is 
</p>
<p>The number of countries is f + 1 (we have to count the ocean too), so Euler's 
formula gives f + 1 + 2n + G) = 2G) + 3n + 2, whence f = (~) + n + 1. 
</p>
<p>12.2 Planar Graphs 
</p>
<p>12.2.1. Yes, see Figure 16.2. 
</p>
<p>FIGURE 16.2. 
</p>
<p>12.2.2. No; the argument is similar to the one showing that K5 is not 
</p>
<p>planar. The houses, wells, and paths form a bipartite graph with 6 nodes 
</p>
<p>and 9 edges. Suppose that this can be drawn in the plane without inter-
</p>
<p>sections. Then we have 9 + 2 - 6 = 5 regions. Each region has at least 4 
edges (since there are no triangles), and hence the number of edges is at 
</p>
<p>least ~ . 5 . 4 = 10, which is a contradiction. </p>
<p/>
</div>
<div class="page"><p/>
<p>278 16. Answers to Exercises 
</p>
<p>13 Coloring Maps and Graphs 
</p>
<p>13.1 Coloring Regions with Two Colors 
</p>
<p>13.1.1. By induction. True if n = 1. Let n &gt; 1. Assume that the descrip-
tion of the coloring is valid for the first n - 1 circles. If we add the nth, the 
color and the parity don't change outside this circle; both change inside 
</p>
<p>the circle. So the description remains valid. 
</p>
<p>13.1.2. (a) By induction. True for 1 line. Adding a line, we recolor all 
</p>
<p>regions on one side. 
</p>
<p>(b) One possible description: Designate a direction as "up." Let p any point 
</p>
<p>not on any of the lines. Start a half-line "up" from P. Count how many of 
</p>
<p>the given lines intersect it. Color according to the parity of this intersection 
</p>
<p>number. 
</p>
<p>13.2 Coloring Graphs with Two Colors 
</p>
<p>13.2.1. This graph cannot contain any odd cycle. Indeed, if we consider 
</p>
<p>any cycle C, then each edge of it contains exactly one intersection point 
with the union of circles. The contribution of every circle is even, since 
</p>
<p>walking around C, we cross the circle alternatingly in and out. 
</p>
<p>13.3 Coloring Graphs with Many Colors 
</p>
<p>13.3.1. Suppose that we have a good 3-coloring of the first graph. Starting 
</p>
<p>from above, the first vertex gets (say) color 1, the vertices on the second 
</p>
<p>level must get colors 2 and 3, and then both of the lowest two vertices must 
</p>
<p>get color 1. But this is impossible, since they are connected. 
</p>
<p>Suppose that we have a good 3-coloring of the second graph. Starting from 
</p>
<p>the center, we may assume that it has color 1, so its neighbors get colors 2 
</p>
<p>or 3. Now recolor each outermost vertex with color 1 by giving it the color 
</p>
<p>of its inner "twin". This coloring would give a good coloring of a 5-cycle 
</p>
<p>by 2 colors, since "twins" have the same neighbors (except that the inner 
</p>
<p>twin is also connected to the center). This is a contradiction. 
</p>
<p>13.3.2. By rotating the plane a little, we may assume that all intersection 
</p>
<p>points have different y coordinates (which we just call "heights"). Starting 
</p>
<p>with the highest intersection point, and moving down, we can color the 
</p>
<p>intersection points one by one. Each time, there are at most two intersection 
</p>
<p>points that are adjacent to the current point along the two lines that were 
</p>
<p>colored previously, and so we can find a color for the current point different 
</p>
<p>from these. 
</p>
<p>13.3.3. We may assume that there are at least 2 nodes, and so there is 
</p>
<p>a node of degree at most d. We delete it, recursively color the remaining </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 279 
</p>
<p>graph by d + 1 colors, and then we can extend this coloring to the last 
point, since its d neighbors exclude only d colors. 
</p>
<p>13.3.4. We delete a point of degree d, and recursively color the remaining 
</p>
<p>graph with d + 1 colors. We can extend this as in the previous solution. 
</p>
<p>14 Finite Geometries, Codes, Latin 
Squares, and Other Pretty Creatures 
</p>
<p>14.1 Small Exotic Worlds 
</p>
<p>14.1.1. The Fano plane itself. 
</p>
<p>14.1.2. Let abc be a circle. Then two of the lines through a contain band 
</p>
<p>c, respectively, so they are not tangents. The third line through a is the 
</p>
<p>tangent. 
</p>
<p>14.1.3. If H is a hypercircle, then its 4 points determine 6 lines, and 3 
</p>
<p>of these 6 lines go through each of its points. So the seventh line does not 
</p>
<p>go through any of the 4 points of the hypercircle. Conversely, if L is a line, 
</p>
<p>then the 4 points not on L cannot contain another line (otherwise, these 
</p>
<p>two lines would not intersect), and so these 4 points form a hypercircle. 
</p>
<p>14.1.4. (a) If everybody on line L votes yes, then (since every line intersects 
</p>
<p>L) every line has at least one point voting yes, and so no line will vote all 
no. (b) We may assume that at least 4 points vote yes; let a, b, c, and d be 
</p>
<p>4 of them. Suppose that there is no line voting all yes. Then each of the 3 
</p>
<p>lines through a contains at most one further yes vote, so each of them must 
</p>
<p>contain exactly one of b, c, and d. So the remaining 3 points vote no. The 
</p>
<p>yes votes form a hypercircle (exercise 14.1. 3), so the no votes form a line. 
</p>
<p>14.1.5. (a) Through two original points there is the original line; through 
</p>
<p>an original point a and a new point b there is a unique line through a among 
</p>
<p>all parallel lines to which b was added; and for two new points there is the 
</p>
<p>new line. (b) is similar. (c) is obvious. (d) follows from (a), (b), and (c), as 
</p>
<p>we saw above. 
</p>
<p>14.1.6. Yes, for every line (2 points) there is exactly one line that is 
</p>
<p>disjoint from it (the other 2 points). 
</p>
<p>14.1. 7. See Figure 16.3 (there are many other ways to map the points). 
</p>
<p>14.1.8. This is not a coincidence. Fix any point A of the Cube space. Every 
</p>
<p>plane through A contains 3 lines through A. If we call the lines through a 
</p>
<p>given point "POINTS," and those triples of these lines that belong to one 
</p>
<p>plane "LINES," then these POINTS and LINES form a Fano plane. </p>
<p/>
</div>
<div class="page"><p/>
<p>280 16. Answers to Exercises 
</p>
<p>FIGURE 16.3. 
</p>
<p>14.2 Finite Affine and Projective Planes 
</p>
<p>14.2.1. Fix any point a. There are n + 1 lines through a, which have no 
other points in common and cover the whole plane by (a). Each of these 
</p>
<p>lines has n points besides a, so there are (n + l)n points besides a, and 
n(n + 1) + 1 = n 2 + n + 1 points altogether. 
</p>
<p>14.2.2. We can assign coordinates to the vertices of the cube as if it were in 
</p>
<p>Euclidean space, but think of the coordinates as elements of the 2-element 
</p>
<p>field (Figure 16.4). Then it is straightforward (if lengthy) to check that the 
</p>
<p>planes of the Cube space are precisely the sets of points given by linear 
</p>
<p>equations. For example, the linear equation x + y + z = 1 gives the points 
001, 010, 011, 111 (don't forget that we are working in the 2-element field), 
</p>
<p>which is just the plane consisting of the light points. 
</p>
<p>011 111 
</p>
<p>001 101 
</p>
<p>i010 
.0--&middot;----------&middot;------&middot;-------
</p>
<p>/ .. / 110 
</p>
<p>000 100 
</p>
<p>FIGURE 16.4. 
</p>
<p>14.2.3. A projective plane of order 10 ought to have 102 + 10 + 1 = 111 
points, 111 lines, with 11 points on each line. The number of ways to select 
</p>
<p>a candidate line is (~ln; the number of ways to select 111 candidate lines </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 281 
</p>
<p>is 
</p>
<p>( (\\1)) = (473239787751081) 101448. 
111 11 &gt; 
</p>
<p>One could not check so many possibilities even with the fastest computer 
</p>
<p>within the lifetime of the universe! Lam, Thiel, and Swiercz had to work 
</p>
<p>in a much more sophisticated manner. 
</p>
<p>14.3 Block Designs 
</p>
<p>14.3.1. 441, 44. 
</p>
<p>14.3.2. For any two citizens C and D, there are). clubs containing both. 
</p>
<p>If we add this up for every D, we count (v -1). clubs containing C. Each 
such club is counted k - 1 times (once for every member different from C, 
</p>
<p>so the number of clubs containing C is (v - l)Ajk. This is the same for 
every citizen C. 
</p>
<p>14.3.3. (a) v = 6, r = 3, k = 3 gives b = 6 by (14.1), but). = 6/5 by 
</p>
<p>(14.2). (b) b = 8, v = 16, r = 3, k = 6, ). = 1 (there are many other 
</p>
<p>examples in both cases). 
</p>
<p>14.3.4. Take b = v clubs, and construct for every citizen C a club in which 
everybody else is a member except C. Then b = v, k = v-I, r = v-I, 
</p>
<p>). = v - 2. 
</p>
<p>14.4 Steiner Systems 
</p>
<p>14.4.1. Let A, B, C be 3 elements that do not form a club. There is a 
</p>
<p>unique club containing A and B, which has a unique third element; call 
</p>
<p>this D. Similarly, there is a unique element E such that ACE is a club, 
</p>
<p>and a unique element F such that BCF is a club. The elements D, E, F 
</p>
<p>must be distinct, since if (say) D = E, then A and D are contained in two 
clubs (one with B and one with C). Let the seventh element be G. There 
</p>
<p>is a unique club containing C and D, and the third member of this club 
</p>
<p>must be G (we can check that any of the other 4 choices would yield two 
</p>
<p>clubs with two members is common). Similarly, AFG and BEG are clubs. 
</p>
<p>Similarly, there is a unique club containing D and E, whose third member 
</p>
<p>must be F. So, apart from the names of the citizens, the club structure is 
</p>
<p>uniquely determined. 
</p>
<p>14.4.2. We have r = (v - 1)/2 by (14.2), and hence b = v(v - 1)/6 by 
</p>
<p>(14.1). Since v-I 2': 6, we have b 2': v. 
</p>
<p>14.4.3. Call a triple contained in S an S -triple. The total number of triples 
</p>
<p>is b = v( v-I) /6, the number of S-triples is 
</p>
<p>b' = Y (y -1) 
6 
</p>
<p>(v-1)(v-3) 
</p>
<p>24 </p>
<p/>
</div>
<div class="page"><p/>
<p>282 16. Answers to Exercises 
</p>
<p>and so the number of non-S-triples is b - b' = (V+l)S(V-l). Every non-S-
triple has at most one point in S and thus at least two points not in S. 
</p>
<p>But the number of pairs not is S is (V+i)/2) = (V+l)S(V-l), and since these 
pairs can belong to one of the non-S-triples only, it follows that each of 
</p>
<p>the non-S-triples must contain exactly one pair of elements outside S. This 
proves that each non-S-triple must contain an element of S. 
</p>
<p>14.4.4. See Figure 16.5. 
</p>
<p>FIGURE 16.5. 
</p>
<p>14.4.5. Every girl has 8 other girls to walk with; every day she can walk 
</p>
<p>with 2 in a line. So 4 days are necessary for her to walk with everybody 
</p>
<p>exactly once. 
</p>
<p>14.5 Latin Squares 
</p>
<p>14.5.1. There are 576 different 4 x 4 Latin squares. There are many ways 
</p>
<p>to arrive at this figure; we sketch one. The first row can be filled out 4! 
</p>
<p>ways. These are all equivalent in the sense that the number of ways they 
</p>
<p>can be completed is the same for each of them, so we may fix the first 
</p>
<p>row as 0 1 2 3 and just count the number of ways to complete this. The 
</p>
<p>first column now can be filled out in 3! ways, and again all of these are 
</p>
<p>equivalent, so let's fix it as 0 1 2 3. 
</p>
<p>If the 0 in the second row is in the second position, then the rest of the 
</p>
<p>second row and second column is forced, but we get two ways to fill out 
</p>
<p>the 4 fields in the lower right corner. If the 0 in the second row is in the 
</p>
<p>third or fourth position, then the way to fill out the rest is forced. Thus we 
</p>
<p>get the 4 Latin squares below: 
</p>
<p>o 123 
103 2 
230 1 
3 2 1 0 
</p>
<p>o 1 2 3 
103 2 
2 3 1 0 
</p>
<p>3 2 0 1 
</p>
<p>o 1 2 3 
123 0 
230 1 
301 2 
</p>
<p>o 1 2 3 
1 3 0 2 
</p>
<p>2 0 3 1 
</p>
<p>3 2 1 0 
</p>
<p>Therefore, the number of ways to fill out the remaining 9 fields is 4, so the 
</p>
<p>total number is 4! . 3! . 4 = 576. </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 283 
</p>
<p>These four may look different, but if we flip 1 and 2 in the third, flip rows 
</p>
<p>2 and 3, and flip columns 2 and 3, we get the second. Similarly, if we flip 
</p>
<p>1 and 3 in the fourth, flip rows 2 and 4, and flip columns 2 and 4, we get 
</p>
<p>the second. So the last 3 of these are not essentially different. 
</p>
<p>There is no way to get the second square from the first by such operations 
</p>
<p>(this follows, e.g., by Exercise 14.5.7). So there are two essentially different 
</p>
<p>4 x 4 Latin squares. 
</p>
<p>14.5.2. This is quite simple. For example, the table below is good (there 
</p>
<p>are many other possibilities): 
</p>
<p>0 1 2 n-2 n-l 
1 2 3 n-l 0 
2 3 4 0 1 
</p>
<p>n-l 0 1 n-3 n-2 
</p>
<p>14.5.3. 
</p>
<p>1 2 3 1 2 3 
2 3 1 3 1 2 
</p>
<p>3 1 2 2 3 1 
</p>
<p>14.5.4. We add 1 to every number; in this way, every row and column 
</p>
<p>sum increases by 4 . 
</p>
<p>14.5.5. . We need two Latin squares where not only in the rows and 
</p>
<p>columns, but also in the diagonals every number occurs once. These two 
</p>
<p>will do: 
</p>
<p>0 1 2 3 0 1 2 3 
</p>
<p>2 3 0 1 3 2 1 0 
</p>
<p>3 2 1 0 1 0 3 2 
</p>
<p>1 0 3 2 2 3 0 1 
</p>
<p>From these two we get the following perfect magic square: 
</p>
<p>0 5 10 15 
</p>
<p>11 14 1 4 
</p>
<p>13 8 7 2 
</p>
<p>6 3 12 9 
</p>
<p>14.5.6. If there exists such a Latin square, then arbitrarily permuting the 
</p>
<p>numbers 0,1,2,3 in it would give another square orthogonal to the three 
</p>
<p>squares in (14.9) and (14.12). (Prove!) So we may start with a square having 
</p>
<p>its first row 0 1 2 3. But then what can its first entry in the second row 
</p>
<p>be? Zero is impossible (because the entry above it is also 0), but 1, 2, or 3 
</p>
<p>are also ruled out: for instance, if we had 2, then it wouldn't be orthogonal 
</p>
<p>to square (14.12), because the pair (2,2) would occur twice. So there does 
</p>
<p>not exist such a Latin square. (Try to generalize this result: From the n x n </p>
<p/>
</div>
<div class="page"><p/>
<p>284 16. Answers to Exercises 
</p>
<p>Latin squares we can choose at most n - 1 squares pairwise orthogonal to 
</p>
<p>each other.) 
</p>
<p>14.5.7. If we had a square orthogonal to (14.13), then using the same 
</p>
<p>argument as in the solution of Exercise 14.5.6, we may suppose that the 
</p>
<p>first row is 0 1 2 3. Then the pairs (0,0), (1,1), (2,2), and (3,3) occur in 
</p>
<p>the first row, which implies that in the other rows, the two squares cannot 
</p>
<p>have the same number in the same position. 
</p>
<p>In particular, the first entry of the second row cannot be 1, and it cannot 
</p>
<p>be 0 (because the entry above it is 0). So it is 2 or 3. 
</p>
<p>Suppose it is 2. Then the second entry in this row cannot be 1 or 2 (there 
</p>
<p>is a 1 above it and a 2 before it), and it cannot be 3, so it is O. The fourth 
</p>
<p>entry cannot be 2, 0 or 3, so it must be 1; it follows that the second row 
</p>
<p>is 2 0 3 1 (the same as the third row in (14.13)). Next we can figure out 
</p>
<p>the last row: Each entry is different from the two above it in the first and 
</p>
<p>second row, and also from the last row of (14.13), which implies that this 
</p>
<p>row must be the same as the second row of (14.13): 1302. Hence the third 
</p>
<p>row must be 3 2 1 0; but now the pair (3,1) occurs twice when the last two 
</p>
<p>rows are overlaid. 
</p>
<p>The case where the second row starts with a 3 can be argued in the same 
</p>
<p>way. 
</p>
<p>14.6 Codes 
</p>
<p>14.6.1. Suppose that a code is d-error-correcting. We claim that for any 
</p>
<p>two codewords we must flip at least 2d+ 1 bits to get from one to the other. 
</p>
<p>Indeed, if we could get from codeword u to codeword v by flipping only 2d 
</p>
<p>bits, then consider the codeword w obtained from u by flipping d of these 
</p>
<p>bits. We could receive w instead of u, but also instead of v, so the code is 
</p>
<p>not d-error-correcting. 
</p>
<p>Now if we receive any message that has at most 2d errors, then this message 
</p>
<p>is not another codeword, so we can detect up to 2d errors. 
</p>
<p>The converse is proved similarly. 
</p>
<p>14.6.2. If the string has no l's, then it is a codeword. If it contains one 1, 
</p>
<p>this can be flipped to get a codeword. If it has two 1 's, then there is a line 
</p>
<p>through the corresponding two points of the Fano plane, and flipping the 
</p>
<p>o in the position corresponding to the third point gives a codeword. If it 
has three l's, and these are collinear, then it is a codeword. If it has three 
</p>
<p>1 's, and these are not collinear, then there is a unique point not on any of 
</p>
<p>the three lines determined by them, and flipping this we get a codeword. 
</p>
<p>If it contains at least four 1 's, then we can argue similarly, interchanging 
</p>
<p>the role of l's and O's. </p>
<p/>
</div>
<div class="page"><p/>
<p>16. Answers to Exercises 285 
</p>
<p>15 A Glimpse of Complexity and Cryptogra-
phy 
</p>
<p>15.2 Classical cryptography 
</p>
<p>15.2.1. I THINK WE SHOULD NOT ATTACK FOR ANOTHER 
</p>
<p>WEEK, BUT THEN WITH FULL FORCE. BELA 
</p>
<p>15.2.2. Let ala2 ... an be the key and bl b2 . .. bn the plain text. Caligula 
</p>
<p>intercepts one message whose bits are a2 EB bl , a3 EB b2, ... an EB bn-l, and 
</p>
<p>another message whose bits are al EB bl , a2 EB b2, ... , an EB bn . (The second 
</p>
<p>message is one bit longer, which may give him a hint of what happened.) 
</p>
<p>He can compute the binary sum of the first bits, second bits, etc. So he 
</p>
<p>gets (a2 EB bI) EB (al EB bl ) = al EB a2, (a3 EB b2) EB (a2 EB b2) = a2 EB a3, etc. 
</p>
<p>Now he guesses that al = 0; since he knows al EB a2, he can compute a2, 
then similarly a3, and so on, until he gets the whole key. It may be that 
</p>
<p>his initial guess was wrong, which he notices, since in trying to decode the 
</p>
<p>message he gets garbage; but then he can tryout al = 1, and recover the 
key. One of the two guesses will work. 
</p>
<p>15.2.3. Let ala2 ... an be the key and let bl b2 ... bn and ClC2 ... Cn be the 
</p>
<p>two plain texts. Caligula intercepts one message whose bits are al EB bl , a2 EB 
</p>
<p>b2, ... anEBbn , and another message whose bits are al EBcl, a2EBc2, ... ,anEBcn . 
</p>
<p>As before, he computes the binary sum of the first bits, second bits, etc., 
</p>
<p>to get (al EB bI) EB (al EB Cl) = bl EB Cl, (a2 EB b2) EB (a2 EB C2) = b2 EB C2, etc. 
The rest is not as straightforward as in the previous exercise, but suppose 
</p>
<p>that Caligula can guess part of (say) Arthur's message (signature, or ad-
</p>
<p>dress, or the like). Then, since he knows the bit-by-bit binary sum of the 
</p>
<p>two messages, he can recover the corresponding part of Bela's message. 
</p>
<p>With luck, this is not a full phrase, and it contains part of a word. Then 
</p>
<p>he can guess the rest of the word, and this gives him a few more letters 
</p>
<p>of Arthur's message. With luck, this suggests some more letters of Bela's 
</p>
<p>message, etc. 
</p>
<p>This is not completely straightforward, but typically it gives enough infor-
</p>
<p>mation to decode the messages (as World War II codebreakers learned). 
</p>
<p>One important point: Caligula can verify that his reconstruction is correct, 
</p>
<p>since in this case both messages must turn out to be meaningful. 
</p>
<p>15.3 How to Save the Last Move in Chess 
</p>
<p>15.3.1. Alice can easily cheat: She can send just a random string x in 
</p>
<p>the evening, figure out her move overnight, along with the string y that 
</p>
<p>encodes it, and send the binary sum of x and y as the alleged key. 
</p>
<p>15.3.2. This certainly eliminates the cheating in the previous exercise, 
</p>
<p>since if she changes her mind, the "key" she computes back from the mes-</p>
<p/>
</div>
<div class="page"><p/>
<p>286 16. Answers to Exercises 
</p>
<p>sage the next morning will not be meaningful. But now Bob has the ad-
</p>
<p>vantage: He can tryout all "random but meaningful" keys, since there are 
</p>
<p>not so many of them. 
</p>
<p>15.6 Public Key Cryptography 
</p>
<p>15.6.1. (a) Pick random numbers (public keys) el, e2, ... eM and apply 
</p>
<p>the hypothesized algorithm to compute the the corresponding secret keys 
</p>
<p>d1, d2 , ... , dM . The number k = (p - l)(q - 1) is a common divisor of 
e1d1 - 1, e2d2 - 1, ... , eMdM - 1, so it is a divisor of K = gcd(e1d1 -
</p>
<p>1, e2d2 - 1, ... ,eMdM - 1), which we can compute. If K &lt; m, then we 
know that in fact k = K, since k = (p-1)(q-1) &gt; pq/2 = m/2. Otherwise 
we pick another public key eM+l and repeat. One can show that after no 
</p>
<p>more than about log m iterations, we find k with large probability. 
</p>
<p>(b) If we know m = pq and k = (p-1)(q-1), then we know p+q = m-k+1, 
and so p and q can be determined as the solutions of the quadratic equation 
</p>
<p>x 2 - (m - k + l)x + m = O. </p>
<p/>
</div>
<div class="page"><p/>
<p>Index 
</p>
<p>adjacency matrix, 148 
</p>
<p>Adleman, L., 247 
</p>
<p>associative operation, 7 
</p>
<p>Axiom of Parallels, 213 
</p>
<p>Baranyai, Zsolt, 229 
</p>
<p>bell curve, 58 
</p>
<p>bijection, 14, 150 
</p>
<p>binary representation, 12 
</p>
<p>bits, 13 
</p>
<p>binomial coefficients, 20-21, 23, 
</p>
<p>24, 43-64, 70, 81 
</p>
<p>Binomial Theorem, 44 
</p>
<p>block design, 220-224, 229, 237 
</p>
<p>blocks, 221 
</p>
<p>Brooks's Theorem, 203, 207 
</p>
<p>cardinality of a set, 5 
</p>
<p>Carmichael numbers, 120 
</p>
<p>Cayley's Theorem, 147, 150, 158 
</p>
<p>ceiling, 15 
</p>
<p>chromatic number, 202 
</p>
<p>circuit, 131 
</p>
<p>clique, 130 
</p>
<p>code, 232 
</p>
<p>error-correcting, 236 
</p>
<p>error-detecting, 234 
</p>
<p>Fano, 236 
</p>
<p>parity check, 233 
</p>
<p>perfect 1-error-correcting, 236 
</p>
<p>planar, 162 
</p>
<p>Reed-Muller, 236 
</p>
<p>Reed-Solomon, 236 
</p>
<p>repetition, 233 
</p>
<p>RSA,247 
</p>
<p>coloring 
</p>
<p>graph, 199-204, 206-210 
</p>
<p>regions, 197-199, 204-206 
</p>
<p>Steiner system, 227 
</p>
<p>commutative operation, 7 
</p>
<p>complement 
</p>
<p>graph, 130 
</p>
<p>set, 21 
</p>
<p>complexity theory, 203,241, 246 
</p>
<p>composite number, 88 
</p>
<p>computer, 89, 110, 186,206, 220, 
</p>
<p>242, 246 
</p>
<p>congruence, 105-107 
</p>
<p>reflexivity, 105 
</p>
<p>symmetry, 105 </p>
<p/>
</div>
<div class="page"><p/>
<p>288 Index 
</p>
<p>transitivity, 106 
</p>
<p>conjecture, 68 
</p>
<p>convex polygon, 179, 191 
</p>
<p>countries of a map, 189 
</p>
<p>cryptography, 110, 122, 242 
</p>
<p>cryptosystem, 242 
</p>
<p>cube, 194 
</p>
<p>Cube space, 215, 221, 224, 236 
</p>
<p>cut-edge, 142 
</p>
<p>cycle, 131, 141 
</p>
<p>Hamiltonian, 139, 161 
</p>
<p>length, 131 
</p>
<p>odd, 201 
</p>
<p>decrypt, 242 
</p>
<p>definition by induction, 66 
</p>
<p>degree of a node, 143, 150, 155, 
</p>
<p>195 
</p>
<p>difference of sets, 6 
</p>
<p>Digital Encryption Standard, 250 
</p>
<p>disjoint, 6 
</p>
<p>divisor, 87 
</p>
<p>dodecahedron, 194 
</p>
<p>graph, 139 
</p>
<p>double star, 155 
</p>
<p>edge, 126 
</p>
<p>parallel, 126 
</p>
<p>element of a set, 4 
</p>
<p>encoding, 11 
</p>
<p>encrypt, 242 
</p>
<p>Erdos, Pal, 184 
</p>
<p>Euclid's Fifth Postulate, 213 
</p>
<p>Euclidean Algorithm, 99-104, 112, 
</p>
<p>123, 249 
</p>
<p>Euler's Formula, 189-191, 194-
</p>
<p>196, 208 
</p>
<p>Euler, L., 135 
</p>
<p>event, 77 
</p>
<p>exclusive, 78 
</p>
<p>experiment, 77 
</p>
<p>face of a map, 194 
</p>
<p>factorization, 90, 99, 122 
</p>
<p>Fano, G., 217 
</p>
<p>father code, 149 
</p>
<p>Fermat test, 117 
</p>
<p>general, 120 
</p>
<p>Fermat's "Little" Theorem, 97-
</p>
<p>99, 117, 121, 248 
</p>
<p>Fermat, Pierre de, 97 
</p>
<p>Fibonacci numbers, 65-75, 83, 
</p>
<p>102, 123 
</p>
<p>Fibonacci, Leonardo, 65 
</p>
<p>Fisher's Inequality, 223 
</p>
<p>Five Color Theorem, 207 
</p>
<p>floor, 15 
</p>
<p>Four Color Theorem, 206 
</p>
<p>Frobenius, G., 169 
</p>
<p>Fundamental Theorem of Arith-
</p>
<p>metic,90 
</p>
<p>Gauss curve, 57 
</p>
<p>Gauss, C.F., 105 
</p>
<p>general position, 182 
</p>
<p>Goldbach's conjecture, 96 
</p>
<p>golden ratio, 74 
</p>
<p>graph, 126, 189 
</p>
<p>k-colorable, 202 
</p>
<p>2-colorable, 200 
</p>
<p>bipartite, 165, 195, 200, 223 
</p>
<p>complement, 130 
</p>
<p>complete, 130, 192 
</p>
<p>connected, 131, 142 
</p>
<p>connected component, 133 
</p>
<p>dual,206 
</p>
<p>edgeless, 130 
</p>
<p>planar, 192, 206-208 
</p>
<p>simple, 126 
</p>
<p>greatest common divisor, 99 
</p>
<p>Guthrie, F., 206 
</p>
<p>Hall, P., 169 
</p>
<p>Happy End Problem, 184 
</p>
<p>https, 250 
</p>
<p>icosahedron, 194 
</p>
<p>Inclusion-Exclusion Formula, 34, 
</p>
<p>114 
</p>
<p>independent events, 79 </p>
<p/>
</div>
<div class="page"><p/>
<p>indirect proof, 37, 90, 92, 93, 142, 
</p>
<p>159, 192 
</p>
<p>induction, 25-31, 41, 44, 53, 61, 
</p>
<p>66, 68, 69, 71, 90, 98, 
</p>
<p>114, 129, 144, 183, 198, 
</p>
<p>203, 208 
</p>
<p>simultaneous, 70 
</p>
<p>induction hypothesis, 27, 29, 53, 
</p>
<p>68, 98, 145, 198, 203, 
</p>
<p>208 
</p>
<p>integer part, 15 
</p>
<p>intersection of sets, 6 
</p>
<p>irrational number, 92 
</p>
<p>isomorphic, 146 
</p>
<p>Kempe, A.B., 206 
</p>
<p>key of cryptosystem, 242 
</p>
<p>private, 247 
</p>
<p>public, 248 
</p>
<p>Kirkman, T.P., 228 
</p>
<p>Konig, D., 166, 169 
</p>
<p>Konigsberg bridges, 136 
</p>
<p>Kruskal's Algorithm, 159 
</p>
<p>labeled tree, 146, 148 
</p>
<p>Lam, C.W.H., 220 
</p>
<p>Latin square, 229-232 
</p>
<p>orthogonal, 230 
</p>
<p>Law of Large Numbers, 77, 80 
</p>
<p>Law of Small Numbers, 83 
</p>
<p>Law of Very Large Numbers, 83 
</p>
<p>least common multiple, 99 
</p>
<p>line at infinity, 218 
</p>
<p>logarithm, 15, 31, 32, 37-40, 56, 
</p>
<p>59-62, 95, 102 
</p>
<p>loop, 126 
</p>
<p>Lucas numbers, 74 
</p>
<p>magic square, 230 
</p>
<p>Maple, 122, 246 
</p>
<p>Marriage Theorem, 169, 223 
</p>
<p>matching, 165-178 
</p>
<p>greedy, 172 
</p>
<p>perfect, 165 
</p>
<p>Mathematica, 122 
</p>
<p>Index 289 
</p>
<p>Miller-Rabin test, 121 
</p>
<p>minimal criminal, 90 
</p>
<p>modular arithmetic, 109 
</p>
<p>modulus, 105 
</p>
<p>multigraph, 126, 207 
</p>
<p>multiple, 87 
</p>
<p>node, 126 
</p>
<p>adjacent, 126 
</p>
<p>degree, 127, 166, 171, 176, 
</p>
<p>203, 207, 210 
</p>
<p>father, 142 
</p>
<p>neighbors, 126 
</p>
<p>son, 143 
</p>
<p>noisy channel, 232 
</p>
<p>one-time pad, 242 
</p>
<p>one-to-one correspondence, 14, 
</p>
<p>150 
</p>
<p>P6lya, G., 155 
</p>
<p>Pascal's Triangle, 49, 77 
</p>
<p>Pascal, Blaise, 49 
</p>
<p>password, 246 
</p>
<p>path, 130 
</p>
<p>augmenting, 173 
</p>
<p>endpoints, 131 
</p>
<p>length, 131 
</p>
<p>permutation, 17 
</p>
<p>Petersen graph, 139, 195 
</p>
<p>Pigeonhole Principle, 35, 37, 114, 
</p>
<p>202, 230, 240 
</p>
<p>plain text, 242 
</p>
<p>planar code, 153 
</p>
<p>planar graph, see graph, planar 
</p>
<p>planar map, 189, 205, 206, 210 
</p>
<p>plane 
</p>
<p>affine, 218 
</p>
<p>coordinates, 219 
</p>
<p>order, 218 
</p>
<p>Euclidean, 211, 219 
</p>
<p>Fano, 211, 221, 224, 236 
</p>
<p>projective, 217 
</p>
<p>order, 217 
</p>
<p>Tictactoe, 213, 221, 224 </p>
<p/>
</div>
<div class="page"><p/>
<p>290 Index 
</p>
<p>point at infinity, 218 
</p>
<p>point of a graph, 126 
</p>
<p>polyhedron, 194 
</p>
<p>Priifer code, 150, 152 
</p>
<p>extended, 150 
</p>
<p>prime factorization, 245, 250 
</p>
<p>prime field, 109, 219, 237 
</p>
<p>prime number, 83, 88, 219, 245 
</p>
<p>Prime Number Theorem, 94 
</p>
<p>Principle of Induction, 27, 29, 
</p>
<p>199, 203 
</p>
<p>prism 
</p>
<p>pentagonal, 194 
</p>
<p>triangular, 194 
</p>
<p>probability space, 78 
</p>
<p>pseudoprime, 118 
</p>
<p>public key cryptography, 247 
</p>
<p>pyramid 
</p>
<p>pentagonal, 194 
</p>
<p>Pythagoras, 92 
</p>
<p>Pythagorean triple, 100 
</p>
<p>Pythagoreans, 92 
</p>
<p>Ray-Chaudhuri, D.K., 228 
</p>
<p>recurrence, 66 
</p>
<p>relatively prime, 99, 249 
</p>
<p>remainder, 87, 248 
</p>
<p>Rivest, R., 247 
</p>
<p>sample space, 77 
</p>
<p>Schoolgirls' Walking Schedule, 228 
</p>
<p>Secure Socket Layer, 250 
</p>
<p>security, 249 
</p>
<p>set, 4 
</p>
<p>cardinality, 5 
</p>
<p>complement, 21 
</p>
<p>difference, 6 
</p>
<p>disjoint, 6 
</p>
<p>element, 4 
</p>
<p>empty, 5 
</p>
<p>intersection, 6 
</p>
<p>ordered, 17 
</p>
<p>subset, 5, 20 
</p>
<p>ordered, 19, 20 
</p>
<p>symmetric difference, 6 
</p>
<p>union, 6 
</p>
<p>Venn diagram, 6 
</p>
<p>SET, game, 237 
</p>
<p>Shamir, A., 247 
</p>
<p>Sieve Formula, 34 
</p>
<p>signature, 249 
</p>
<p>star, 130 
</p>
<p>Steiner system, 224-229, 237 
</p>
<p>coloring, 227 
</p>
<p>Steiner, J., 224 
subgraph, 131 
</p>
<p>substitution code, 242 
</p>
<p>Swiercz, S., 220 
</p>
<p>symmetric difference of sets, 6 
</p>
<p>Szekeres, Gy6rgy, 184 
</p>
<p>Tarry, G., 220 
</p>
<p>tetrahedron, 194 
</p>
<p>Thiel, L., 220 
</p>
<p>Traveling Salesman Problem, 161 
</p>
<p>tree, 10, 11, 141-157, 191 
</p>
<p>branch, 146 
</p>
<p>edge, 10 
</p>
<p>greedy, 159 
</p>
<p>labeled, 158 
</p>
<p>leaf, 143 
</p>
<p>node, 10 
</p>
<p>root, 142 
</p>
<p>rooted,142 
</p>
<p>spanning, 142 
</p>
<p>Tree-growing Procedure, 144 
</p>
<p>Tree Shortcut Algorithm, 162 
</p>
<p>triangle inequality, 162 
</p>
<p>Twin Paradox, 37 
</p>
<p>twin primes, 94 
</p>
<p>uniform probability space, 78 
</p>
<p>union of sets, 6 
</p>
<p>unlabeled tree, 147, 153 
</p>
<p>Venn diagram, 6 
</p>
<p>vertex, 126 
</p>
<p>walk, 132, 136 
</p>
<p>closed, 132 
</p>
<p>Eulerian, 136 </p>
<p/>
</div>
<div class="page"><p/>
<p>Undergraduate Texts in Mathematics 
</p>
<p>(continued from page iiJ 
</p>
<p>Gamelin: Complex Analysis. 
Gordon: Discrete Probability. 
</p>
<p>HairerlWanner: Analysis by Its History. 
</p>
<p>Readings in Mathematics. 
</p>
<p>Halmos: Finite-Dimensional Vector 
</p>
<p>Spaces. Second edition. 
</p>
<p>Halmos: Naive Set Theory. 
</p>
<p>HlimmerliniHoffmann: Numerical 
</p>
<p>Mathematics. 
</p>
<p>Readings in Mathematics. 
</p>
<p>Harris/HirstlMossinghoff: 
</p>
<p>Combinatorics and Graph Theory. 
</p>
<p>Hartshorne: Geometry: Euclid and 
</p>
<p>Beyond. 
</p>
<p>Hijab: Introduction to Calculus and 
</p>
<p>Classical Analysis. 
</p>
<p>HiitonIHolton/Pedersen: Mathematical 
</p>
<p>Reflections: In a Room with Many 
</p>
<p>Mirrors. 
</p>
<p>HiitoniHoltonlPedersen: Mathematical 
</p>
<p>Vistas: From a Room with Many 
</p>
<p>Windows. 
</p>
<p>Iooss/Joseph: Elementary Stability 
</p>
<p>and Bifurcation Theory. Second 
</p>
<p>edition. 
</p>
<p>Isaac: The Pleasures of Probability. 
</p>
<p>Readings in Mathematics. 
</p>
<p>James: Topological and Uniform 
</p>
<p>Spaces. 
</p>
<p>Jlinich: Linear Algebra. 
</p>
<p>Jlinich: Topology. 
</p>
<p>Jlinich: Vector Analysis. 
</p>
<p>Kemeny/Snell: Finite Markov Chains. 
</p>
<p>Kinsey: Topology of Surfaces. 
</p>
<p>Klambauer: Aspects of Calculus. 
</p>
<p>Lang: A First Course in Calculus. Fifth 
</p>
<p>edition. 
</p>
<p>Lang: Calculus of Several Variables. 
</p>
<p>Third edition. 
</p>
<p>Lang: Introduction to Linear Algebra. 
</p>
<p>Second edition. 
</p>
<p>Lang: Linear Algebra. Third edition. 
</p>
<p>Lang: Short Calculus: The Original 
</p>
<p>Edition of "A First Course in 
</p>
<p>Calculus." 
</p>
<p>Lang: Undergraduate Algebra. Second 
</p>
<p>edition. 
</p>
<p>Lang: Undergraduate Analysis. 
</p>
<p>Laubenbacher/Pengelley: Mathematical 
</p>
<p>Expeditions. 
</p>
<p>Lax/BursteinILax: Calculus with 
</p>
<p>Applications and Computing. 
</p>
<p>Volume 1. 
</p>
<p>LeCuyer: College Mathematics with 
</p>
<p>APL. 
</p>
<p>Lidl/Pilz: Applied Abstract Algebra. 
</p>
<p>Second edition. 
</p>
<p>Logan: Applied Partial Differential 
</p>
<p>Equations. 
</p>
<p>LovaszlPelikllnN esztergombi: Discrete 
</p>
<p>Mathematics. 
</p>
<p>Macki-Strauss: Introduction to Optimal 
</p>
<p>Control Theory. 
</p>
<p>Malitz: Introduction to Mathematical 
</p>
<p>Logic. 
</p>
<p>MarsdenlWeinstein: Calculus I, II, III. 
</p>
<p>Second edition. 
</p>
<p>Martin: Counting: The Art of 
Enumerative Combinatorics. 
</p>
<p>Martin: The Foundations of Geometry 
</p>
<p>and the Non-Euclidean Plane. 
</p>
<p>Martin: Geometric Constructions. 
</p>
<p>Martin: Transformation Geometry: An 
</p>
<p>Introduction to Symmetry. 
</p>
<p>MillmaniParker: Geometry: A Metric 
</p>
<p>Approach with Models. Second 
</p>
<p>edition. 
</p>
<p>Moschovakis: Notes on Set Theory. 
</p>
<p>Owen: A First Course in the 
</p>
<p>Mathematical Foundations of 
</p>
<p>Thermodynamics. 
</p>
<p>Palka: An Introduction to Complex 
</p>
<p>Function Theory. 
</p>
<p>Pedrick: A First Course in Analysis. 
</p>
<p>PeressiniiSullivanlUhl: The Mathematics 
</p>
<p>of Nonlinear Programming. 
</p>
<p>PrenowitzlJantosciak: Join Geometries. 
</p>
<p>Priestley: Calculus: A Liberal Art. 
</p>
<p>Second edition. 
</p>
<p>Protter/Morrey: A First Course in Real 
</p>
<p>Analysis. Second edition. 
</p>
<p>Protter/Morrey: Intermediate Calculus. 
</p>
<p>Second edition. 
</p>
<p>Pugh: Real Mathematical Analysis. </p>
<p/>
</div>
<div class="page"><p/>
<p>Undergraduate Texts in Mathematics 
</p>
<p>Roman: An Introduction to Coding and 
</p>
<p>Information Theory. 
</p>
<p>Ross: Elementary Analysis: The Theory 
of Calculus. 
</p>
<p>Samuel: Projective Geometry. 
</p>
<p>Readings in Mathematics. 
</p>
<p>Saxe: Beginning Functional Analysis 
</p>
<p>Scharlau/Opolka: From Fermat to 
</p>
<p>Minkowski. 
</p>
<p>Schiff: The Laplace Transform: Theory 
</p>
<p>and Applications. 
</p>
<p>Sethuraman: Rings, Fields, and Vector 
</p>
<p>Spaces: An Approach to Geometric 
</p>
<p>Constructability. 
</p>
<p>Sigler: Algebra. 
</p>
<p>Silverman/Tate: Rational Points on 
Elliptic Curves. 
</p>
<p>Simmonds: A Brief on Tensor Analysis. 
</p>
<p>Second edition. 
</p>
<p>Singer: Geometry: Plane and Fancy. 
</p>
<p>Singer/Thorpe: Lecture Notes on 
</p>
<p>Elementary Topology and 
</p>
<p>Geometry. 
</p>
<p>Smith: Linear Algebra. Third edition. 
</p>
<p>Smith: Primer of Modem Analysis. 
</p>
<p>Second edition. 
</p>
<p>StantonlWhite: Constructive 
</p>
<p>Combinatorics. 
</p>
<p>Stillwell: Elements of Algebra: Geometry, 
</p>
<p>Numbers, Equations. 
</p>
<p>Stillwell: Elements of Number Theory. 
</p>
<p>Stillwell: Mathematics and Its History. 
</p>
<p>Second edition. 
</p>
<p>Stillwell: Numbers and Geometry. 
</p>
<p>Readings in Mathematics. 
</p>
<p>Strayer: Linear Programming and Its 
</p>
<p>Applications. 
</p>
<p>Toth: Glimpses of Algebra and Geometry. 
</p>
<p>Second Edition. 
</p>
<p>Readings in Mathematics. 
</p>
<p>Troutman: Variational Calculus and 
</p>
<p>Optimal Control. Second edition. 
</p>
<p>Valenza: Linear Algebra: An Introduction 
</p>
<p>to Abstract Mathematics. 
</p>
<p>WhyburnlDuda: Dynamic Topology. 
</p>
<p>Wilson: Much Ado About Calculus. </p>
<p/>
</div>
</body></html>