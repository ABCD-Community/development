<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Untitled</title>
</head>
<body><div class="page"><p/>
<p>Mechanical Engineering Series
</p>
<p>Jorge&nbsp;Angeles
</p>
<p>Fundamentals of 
Robotic Mechanical 
Systems
Theory, Methods, and Algorithms
</p>
<p> Fourth Edition </p>
<p/>
</div>
<div class="page"><p/>
<p>Fundamentals of Robotic Mechanical Systems</p>
<p/>
</div>
<div class="page"><p/>
<p>Mechanical Engineering Series
</p>
<p>Frederick F. Ling
Editor-in-Chief
</p>
<p>The Mechanical Engineering Series features graduate texts and research monographs to
address the need for information in contemporary mechanical engineering, including areas
of concentration of applied mechanics, biomechanics, computational mechanics, dynamical
systems and control, energetics, mechanics of materials, processing, production systems,
thermal science, and tribology.
</p>
<p>Advisory Board/Series Editors
</p>
<p>Applied Mechanics D. Gross
Technical University of Darmstadt
</p>
<p>Biomechanics V.C. Mow
Columbia University
</p>
<p>Computational Mechanics H.T. Yang
University of California,
Santa Barbara
</p>
<p>Dynamic Systems and Control/ D. Bryant
Mechatronics University of Texas at Austin
</p>
<p>Energetics J.R.Welty
University of Oregon, Eugene
</p>
<p>Processing K.K. Wang
Cornell University
</p>
<p>Production Systems G.-A. Klutke
Texas A&amp;M University
</p>
<p>Thermal Science A.E. Bergles
Rensselaer Polytechnic Institute
</p>
<p>Tribology W.O. Winer
Georgia Institute of Technology
</p>
<p>For further volumes:
http://www.springer.com/series/1161</p>
<p/>
<div class="annotation"><a href="http://www.springer.com/series/1161">http://www.springer.com/series/1161</a></div>
</div>
<div class="page"><p/>
<p>Jorge Angeles
</p>
<p>Fundamentals of Robotic
Mechanical Systems
</p>
<p>Theory, Methods, and Algorithms
</p>
<p>Fourth Edition
</p>
<p>123</p>
<p/>
</div>
<div class="page"><p/>
<p>Jorge Angeles
Department of Mechanical Engineering
Centre for Intelligent Machines (CIM)
McGill University
Montreal, QC, Canada
</p>
<p>ISSN 0941-5122 ISSN 2192-063X (electronic)
ISBN 978-3-319-01850-8 ISBN 978-3-319-01851-5 (eBook)
DOI 10.1007/978-3-319-01851-5
Springer Cham Heidelberg New York Dordrecht London
</p>
<p>Library of Congress Control Number: 2013952913
</p>
<p>&copy; Springer International Publishing Switzerland 2014
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part of
the material is concerned, specifically the rights of translation, reprinting, reuse of illustrations, recitation,
broadcasting, reproduction on microfilms or in any other physical way, and transmission or information
storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology
now known or hereafter developed. Exempted from this legal reservation are brief excerpts in connection
with reviews or scholarly analysis or material supplied specifically for the purpose of being entered
and executed on a computer system, for exclusive use by the purchaser of the work. Duplication of
this publication or parts thereof is permitted only under the provisions of the Copyright Law of the
Publisher&rsquo;s location, in its current version, and permission for use must always be obtained from Springer.
Permissions for use may be obtained through RightsLink at the Copyright Clearance Center. Violations
are liable to prosecution under the respective Copyright Law.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication
does not imply, even in the absence of a specific statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
While the advice and information in this book are believed to be true and accurate at the date of
publication, neither the authors nor the editors nor the publisher can accept any legal responsibility for
any errors or omissions that may be made. The publisher makes no warranty, express or implied, with
respect to the material contained herein.
</p>
<p>Printed on acid-free paper
</p>
<p>Springer is part of Springer Science+Business Media (www.springer.com)</p>
<p/>
<div class="annotation"><a href="www.springer.com">www.springer.com</a></div>
</div>
<div class="page"><p/>
<p>To Anne-Marie, who has given me not only
</p>
<p>her love,
</p>
<p>but also her precious time, without which this
</p>
<p>book
</p>
<p>would not have been possible.</p>
<p/>
</div>
<div class="page"><p/>
</div>
<div class="page"><p/>
<p>Preface to the Fourth Edition
</p>
<p>The aim of the Fourth Edition is the same as that of the past editions: to provide the
reader with the tools needed to better understand the fundamental concepts behind
the design, analysis, control, and programming of robotic mechanical systems at
large. The current edition includes additional examples and exercises. Furthermore,
an updated account of progress and trends in the broad area of robotic mechanical
systems, which continues developing at an impressive pace, is included in Chap. 1.
However, a comprehensive summary of up-to-date developments is not possible in
the limits of a book that stresses fundamentals. An effort was made to include an
overview of the subject, with pertinent references for the details. Robotic systems
that were not even mentioned in the First Edition, namely, flying robots, especially
drones and quadrotors, are now highlighted.
</p>
<p>In producing the Fourth Edition, special attention was given to the consistency
and accuracy of the presentation. In Chap. 4 new examples illustrating the imple-
mentation of the Denavit&ndash;Hartenberg notation and methodology are included, along
with a numerical example on the inverse-displacement problem for spherical wrists.
</p>
<p>Some materials that complement the book are available on the Springer site
allocated to the book:
</p>
<p>http://www.springer.com/engineering/robotics/book/978-3-319-01850-8
</p>
<p>Material posted therein includes code intended to help better understand the
most cumbersome derivations, and to provide useful tools when working out the
exercises, or simply to assist the curious reader in exploring alternative examples or
alternative methods. Animation files and film are also included.
</p>
<p>An important feature of the code provided is that it allows for either symbolic
manipulations, using Maple, or numerical computations, using Matlab. The rough
estimates of the solutions to systems of bivariate equations, arising in various
chapters, but most intensively in Chap. 9, are facilitated by the inclusion of a Matlab
graphic user interface. Further refinements of these estimates are implemented by
means of a Newton&ndash;Gauss least-square approximation to an overdetermined system
of nonlinear equations, as implemented in Matlab.
</p>
<p>vii</p>
<p/>
<div class="annotation"><a href="http://www.springer.com/engineering/robotics/book/978-3-319-01850-8">http://www.springer.com/engineering/robotics/book/978-3-319-01850-8</a></div>
</div>
<div class="page"><p/>
<p>viii Preface to the Fourth Edition
</p>
<p>The excellent work done by Dr. Kourosh Etemadi Zanganeh, currently at
Canmet (Nepean, Ontario, Canada), when he was a Ph.D. candidate under the
author&rsquo;s supervision, was instrumental in completing the Second Edition. This work
comprises the development of algorithms and code for the solution of the inverse
displacement problem of serial robots with architectures that prevent a decoupling
of the positioning from the orientation problems. The material in Chap. 9, which
was deeply revised in the Third Edition and remained virtually untouched in the
current edition, is largely based on this work.
</p>
<p>I would like to thank all those who provided valuable advice for improvement:
Profs. Carlos L&oacute;pez-Caj&uacute;n, Universidad Aut&oacute;noma de Quer&eacute;taro (Mexico), and J.
Jes&uacute;s Cervantes-S&aacute;nchez, Universidad de Guanajuato (Mexico), pointed out many
inconsistencies in the First Edition; Dr. Zheng Liu, Canadian Space Agency, St.-
Hubert (Quebec, Canada), who taught a course based on the first six chapters of
the book at McGill University, pointed out mistakes and gave valuable suggestions
for improving the readability of the book. Additionally, the valuable suggestions
received from Prof. Pierre Larochelle, Florida Institute of Technology, were also
incorporated. Needless to say, the feedback received from students throughout more
than 20 years of using this material in the classroom is highly acknowledged.
</p>
<p>Not the least, the C-code RVS, developed on Silicon Graphics&rsquo; IRIX&mdash;a dialect
of UNIX&mdash;in the 1990s, was ported into Windows. The code is now available under
the name RVS4W (RVS for Windows). RVS, introduced already in the First Edition,
is the software system I have used at McGill University&rsquo;s Centre for Intelligent
Machines to visualize robot motions in projects on design, control, and motion-
planning. The original C-code, and the whole idea of RVS, is due to the creative
work of John Darcovich, now a Senior Engineer at CAE Electronics Ltd., when
he was a Research Engineer at McGill University&rsquo;s Robotic Mechanical Systems
Laboratory.
</p>
<p>In the Fourth Edition, I include new photographs that replaced old ones. For the
magnificent animation of space robots, included in the above site, I am indebted to
the Canadian Space Agency and MDA, the Brampton, Ontario-based manufacturer
of Canadarm and Canadarm2.
</p>
<p>Since there is always room for improvement, I welcome suggestions from the
readership, to the address below. Updates on the book will be posted at
</p>
<p>www.cim.mcgill.ca/~rmsl
</p>
<p>The Solutions Manual has been expanded to include more solutions of sampled
problems. By the same token, the number of exercises has been expanded. The
manual is typeset in LATEX and contains numerous figures; it is available from the
publisher upon request.
</p>
<p>In closing, I would like to thank Dr. Xiaoqing Ma, who assisted me with the
editing of the Fourth Edition and the production of a few figures. Dr. Waseem
A. Khan, now a Senior Research Engineer at Montreal-based Jabez Technologies
Inc., is to be thanked for the excellent additional drawings required by the Third
Edition, besides some coding, while he was a Ph.D. candidate at McGill University.</p>
<p/>
<div class="annotation"><a href="www.cim.mcgill.ca/~rmsl">www.cim.mcgill.ca/~rmsl</a></div>
</div>
<div class="page"><p/>
<p>Preface to the Fourth Edition ix
</p>
<p>Dr. St&eacute;phane Caro, currently a researcher at France&rsquo;s Ecole Centrale de Nantes,
contributed with Matlab coding while working at McGill University&rsquo;s Robotic
Mechanical Systems Laboratory as a postdoctoral fellow.
</p>
<p>Montreal, QC, Canada Jorge Angeles</p>
<p/>
</div>
<div class="page"><p/>
</div>
<div class="page"><p/>
<p>Preface to the First Edition
</p>
<p>No todos los pensamientos son algor&iacute;tmicos.
</p>
<p>&mdash;Mario Bunge1
</p>
<p>The beginnings of modern robotics can be traced back to the late 1960s with
the advent of the microprocessor, which made possible the computer control of a
multiaxial manipulator. Since those days, robotics has evolved from a technology
developed around this class of manipulators for the replaying of a preprogrammed
task to a multidiscipline encompassing many branches of science and engineering.
Research areas such as computer vision, artificial intelligence, and speech recogni-
tion play key roles in the development and implementation of robotics; these are,
in turn, multidisciplines supported by computer science, electronics, and control, at
their very foundations. Thus we see that robotics covers a rather broad spectrum of
knowledge, the scope of this book being only a narrow band of this spectrum, as
outlined below.
</p>
<p>Contemporary robotics aims at the design, control, and implementation of
systems capable of performing a task defined at a high level, in a language
resembling those used by humans to communicate among themselves. Moreover,
robotic systems can take on forms of all kinds, ranging from the most intangible,
such as interpreting images collected by a space sound, to the most concrete, such
as cutting tissue in a surgical operation. We can, therefore, notice that motion is not
essential to a robotic system, for this system is meant to replace humans in many
of their activities, moving being but one of them. However, since robots evolved
from early programmable manipulators, one tends to identify robots with motion
</p>
<p>1Not all thinking processes are algorithmic&mdash;translation of the author&mdash;personal communication
during the Symposium on the Brain-Mind Problem. A Tribute to Professor Mario Bunge on His
75th Birthday, Montreal, September 30, 1994.
</p>
<p>xi</p>
<p/>
</div>
<div class="page"><p/>
<p>xii Preface to the First Edition
</p>
<p>and manipulation. Certainly, robots may rely on a mechanical system to perform
their intended tasks. When this is the case, we can speak of robotic mechanical
systems, which are the subject of this book. These tasks, in turn, can be of a most
varied nature, mainly involving motions such as manipulation, but they can also
involve locomotion. Moreover, manipulation can be as simple as displacing objects
from a belt conveyor to a magazine. On the other hand, manipulation can also be
as complex as displacing these objects while observing constraints on both motion
and force, e.g., when cutting live tissue of vital organs. We can, thus, distinguish
between plain manipulation and dextrous manipulation. Furthermore, manipulation
can involve locomotion as well.
</p>
<p>The task of a robotic mechanical system is, hence, intimately related to motion
control, which warrants a detailed study of mechanical systems as elements of a
robotic system. The aim of this book can, therefore, be stated as establishing the
foundations on which the design, control, and implementation of robotic mechanical
</p>
<p>systems are based.
The book evolved from sets of lecture notes developed at McGill University over
</p>
<p>the last 12 years, while I was teaching a two-semester sequence of courses on robotic
mechanical systems. For this reason, the book comprises two parts&mdash;an introductory
and an intermediate part on robotic mechanical systems. Advanced topics, such
as redundant manipulators, manipulators with flexible links and joints, and force
control, are omitted. The feedback control of robotic mechanical systems is also
omitted, although the book refers the reader, when appropriate, to the specialized
literature. An aim of the book is to serve as a textbook in a 1-year robotics course;
another aim is to serve as a reference to the practicing engineer.
</p>
<p>The book assumes some familiarity with the mathematics taught in any engineer-
ing or science curriculum in the first 2 years of college. Familiarity with elementary
mechanics is helpful, but not essential, for the elements of this science needed to
understand the mechanics of robotic systems are covered in the first three chapters,
thereby making the book self-contained. These three chapters, moreover, are meant
to introduce the reader to the notation and the basics of mathematics and rigid-body
mechanics needed in the study of the systems at hand. The material covered in the
same chapters can thus serve as reading material for a course on the mathematics
of robotics, intended for sophomore students of science and engineering, prior to a
more formal course on robotics.
</p>
<p>The first chapter is intended to give the reader an overview of the subject
matter and to highlight the major issues in the realm of robotic mechanical
systems. Chapter 2 is devoted to notation, nomenclature, and the basics of linear
transformations to understand best the essence of rigid-body kinematics, an area
that is covered in great detail throughout the book. A unique feature of this chapter
is the discussion of the hand&ndash;eye calibration problem: Many a paper has been
written in an attempt to solve this fundamental problem, always leading to a
cumbersome solution that invokes nonlinear-equation solving, a task that invariably
calls for an iterative procedure; moreover, within each iteration, a singular-value
decomposition, itself iterative as well, is required. In Chap. 2, a novel approach is
introduced, which resorts to invariant properties of rotations and leads to a direct</p>
<p/>
</div>
<div class="page"><p/>
<p>Preface to the First Edition xiii
</p>
<p>solution, involving straightforward matrix and vector multiplications. Chapter 3
reviews, in turn, the basic theorems of rigid-body kinetostatics and dynamics.
The viewpoint here represents a major departure from most existing books on
robotic manipulators: proper orthogonal matrices can be regarded as coordinate
transformations indeed, but they can also be regarded as representations, once
a coordinate frame has been selected, of rigid-body rotations. I adopt the latter
viewpoint, and hence fundamental concepts are explained in terms of their invariant
properties, i.e., properties that are independent of the coordinate frame adopted.
Hence, matrices are used first and foremost to represent the physical motions
undergone by rigid bodies and systems thereof; they are to be interpreted as such
when studying the basics of rigid-body mechanics in this chapter. Chapter 4 is the
first chapter entirely devoted to robotic mechanical systems, properly speaking.
This chapter covers extensively the kinematics of robotic manipulators of the
serial type. However, as far as displacement analysis is concerned, the chapter
limits itself to the simplest robotic manipulators, namely, those with a decoupled
architecture, i.e., those that can be decomposed into a regional architecture for the
positioning of one point of their end-effector (EE), and a local architecture for the
orientation of their EE. In this chapter, the notation of Denavit and Hartenberg
is introduced and applied consistently throughout the book. Jacobian matrices,
workspaces, singularities, and kinetostatic performance indices are concepts studied
in this chapter. A novel algorithm is included for the determination of the workspace
boundary of positioning manipulators. Furthermore, Chap. 5 is devoted to the topic
of trajectory planning, while limiting its scope to problems suitable to a first course
on robotics; this chapter thus focuses on pick-and-place operations. Chapter 6,
moreover, introduces the dynamics of robotic manipulators of the serial type,
while discussing extensively the recursive Newton&ndash;Euler algorithm and laying the
foundations of multibody dynamics, with an introduction to the Euler&ndash;Lagrange
formulation. The latter is used to derive the general algebraic structure of the
mathematical models of the systems under study, thus completing the introductory
part of the book.
</p>
<p>The intermediate part comprises four chapters. Chapter 7 is devoted to the
increasingly important problem of determining the angular velocity and the angular
acceleration of a rigid body, when the velocity and acceleration of a set of its points
are known. Moreover, given the intermediate level of the chapter, only the theoret-
ical aspects of the problem are studied, and hence, perfect measurements of point
position, velocity, and acceleration are assumed, thereby laying the foundations for
the study of the same problems in the presence of noisy measurements. This problem
is finding applications in the control of parallel manipulators, which is the reason
why it is included here. If time constraints so dictate, this chapter can be omitted,
for it is not needed in the balance of the book.
</p>
<p>The formulation of the inverse kinematics of the most general robotic manip-
ulator of the serial type, leading to a univariate polynomial of the 16th degree,
not discussed in previous books on robotics, is included in Chap. 8. Likewise,
the direct kinematics of the platform manipulator popularly known as the Stewart
platform, a.k.a. the Stewart&ndash;Gough platform, leading to a 16th-degree monovariate</p>
<p/>
</div>
<div class="page"><p/>
<p>xiv Preface to the First Edition
</p>
<p>polynomial, is also given due attention in this chapter. Moreover, an alternative
approach to the monovariate-polynomial solution of the two foregoing problems,
that is aimed at solving them semigraphically, is introduced in this chapter. With
this approach, the underlying multivariate algebraic system of equations is reduced
to a system of two nonlinear bivariate equations that are trigonometric rather than
polynomial. Each of these two equations, then, leads to a contour in the plane
of the two variables, the desired solutions being found as the coordinates of the
intersections of the two contours.
</p>
<p>Discussed in Chap. 9 is the problem of trajectory planning as pertaining to
continuous paths, which calls for some concepts of differential geometry, namely,
the Frenet&ndash;Serret equations relating the tangent, normal, and binormal vectors of
a smooth curve to their rates of change with respect to the arc length. The chapter
relies on cubic parametric splines for the synthesis of the generated trajectories in
joint space, starting from their descriptions in Cartesian space. Finally, Chap. 10
completes the discussion initiated in Chap. 6, with an outline of the dynamics of
parallel manipulators and rolling robots. Here, a multibody dynamics approach is
introduced, as in the foregoing chapter, that eases the formulation of the underlying
mathematical models.
</p>
<p>Two appendices are included: Appendix A summarizes a series of facts from the
kinematics of rotations, that are available elsewhere, with the purpose of rendering
the book self-contained; Appendix B is devoted to the numerical solution of over-
and underdetermined linear algebraic systems, its purpose being to guide the reader
to the existing robust techniques for the computation of least-square and minimum-
norm solutions. The book concludes with a set of problems, along with a list of
references, for all ten chapters.
</p>
<p>On Notation
</p>
<p>The important issue of notation is given due attention. In figuring out the notation, I
have adopted what I call the C 3 norm. Under this norm, the notation should be
</p>
<p>1. Comprehensive,
2. Concise, and
3. Consistent.
</p>
<p>Within this norm, I have used boldface fonts to indicate vectors and matrices, with
uppercases reserved for matrices and lowercases for vectors. In compliance with the
invariant approach adopted at the outset, I do not regard vectors solely as arrays, but
as geometric or mechanical objects. Regarding such objects as arrays is necessary
only when it is required to perform operations with them for a specific purpose. An
essential feature of vectors in a discussion is their dimension, which is indicated
with a single number, as opposed to the convention whereby vectors are regarded
as matrix arrays of numbers; in this convention, the dimension has to be indicated
with two numbers, one for the number of columns, and one for the number of rows;</p>
<p/>
</div>
<div class="page"><p/>
<p>Preface to the First Edition xv
</p>
<p>in the case of vectors, the latter is always one, and hence need not be mentioned.
Additionally, calligraphic literals are reserved for sets of points or of other objects.
Since variables are defined every time that they are introduced, and the same variable
is used in the book to denote different concepts in different contexts, a list of
symbols is not included.
</p>
<p>How to Use the Book
</p>
<p>The book can be used as a reference or as a text for the teaching of the mechanics of
robots to an audience that ranges from junior undergraduates to doctoral students.
In an introductory course, the instructor may have to make choices regarding what
material to skip, given that the duration of a regular semester does not allow to
cover all that is included in the first six chapters. Topics that can be skipped, if
time so dictates, are the discussions, in Chap. 4, of workspaces and performance
indices, and the section on simulation in Chap. 6. Under strict time constraints, the
whole Chap. 5 can be skipped, but then, the instructor will have to refrain from
assigning problems or projects that include calculating the inverse dynamics of a
robot performing pick-and-place operations. None of these has been included in
Sect. 6 of the Exercises.
</p>
<p>If sections of Chaps. 4 and 5 have been omitted in a first course, it is highly
advisable to include them in a second course, prior to discussing the chapters
included in the intermediate part of the book.
</p>
<p>Acknowledgments
</p>
<p>For the technical support received during the writing of this book, I am indebted to
many people: First and foremost, Eric Martin and Ferhan Bulca, Ph.D. candidates
under my cosupervision, are deeply thanked for their invaluable help and unlimited
patience in the editing of the manuscript and the professional work displayed in
the production of the drawings. With regard to this task, Dr. Max A. Gonz&aacute;lez-
Palacios, currently Assistant Professor of Mechanical Engineering at Universidad
Iberoamericana at Le&oacute;n, Mexico, is due special recognition for the high standards
he set while working on his Ph.D. at McGill University. My colleagues Ken J.
Waldron, Cl&eacute;ment Gosselin, and Jean-Pierre Merlet contributed with constructive
criticism. Dr. Andr&eacute;s Kecskem&eacute;thy proofread major parts of the manuscript during
his sabbatical leave at McGill University. In doing this, Dr. Kecskem&eacute;thy corrected
a few derivations that were flawed. Discussions on geometry and analysis held
with Dr. Manfred Husty, of Leoben University, in Austria, also a sabbaticant at
McGill University, were extremely fruitful in clearing up many issues in Chaps. 2
and 3. An early version of the manuscript was deeply scrutinized by Meyer Nahon,
now Associate Professor at the University of Victoria, when he was completing his</p>
<p/>
</div>
<div class="page"><p/>
<p>xvi Preface to the First Edition
</p>
<p>Ph.D. at McGill University. Discussions with Farzam Ranjbaran, a Ph.D. candidate
at McGill University, on kinetostatic performance indices, helped clarify many
concepts around this issue. Dr. Kourosh Etemadi Zanganeh contributed with ideas
for a more effective discussion of the parametric representation of paths in Chap. 9
and with some of the examples in Chaps. 4 and 8 during his work at McGill
University as a Ph.D. student. The material supplied by Cl&eacute;ment Gosselin on
trajectory planning helped me start the writing of Chap. 5. All individuals and
institutions who contributed with graphical material are given due credit in the book.
Here, they are all deeply acknowledged.
</p>
<p>A turning point in writing this manuscript was the academic year 1991&ndash;
1992, during which I could achieve substantial progress while on sabbatical
leave at the Technical University of Munich under an Alexander von Humboldt
Research Award. Deep gratitude is expressed here to both the AvH Foundation and
Prof. Friedrich Pfeiffer, Director of the Institute B for Mechanics and my host in
Munich. Likewise, Prof. Manfred Broy, of the Computer Science Institute at the
Technical University of Munich, is herewith acknowledged for having given me
access to his Unix network when the need arose. The intellectual environment at the
Technical University of Munich was a source of encouragement and motivation to
pursue the writing of the book.
</p>
<p>Moreover, financial support from NSERC2 and Quebec&rsquo;s FCAR,3 in the form of
research and strategic grants, is duly acknowledged. IRIS,4 a network of Canadian
centers of excellence, supported this work indirectly through project grants in the
areas of robot design and robot control. An invaluable tool in developing material
for the book proved to be RVS, the McGill Robot Visualization System, developed
in the framework of an NSERC Strategic Grant on robot design, and the two IRIS
project grants mentioned above. RVS was developed by John Darcovich, a Software
Engineer at McGill University for about 4 years, and now at CAE Electronics Ltd.,
of Saint-Laurent, Quebec. While RVS is user-friendly and available upon request,
no technical support is offered. For further details on RVS, the reader is invited to
look at the home page of the McGill University Centre for Intelligent Machines:
</p>
<p>http://www.cim.mcgill.ca/~rvs
</p>
<p>Furthermore, Lenore Reismann, a professional technical editor based in Red-
wood City, California, proofread parts of the manuscript and edited its language with
great care. Lenore&rsquo;s professional help is herewith highly acknowledged. Dr. R&uuml;diger
Gebauer, mathematics editor at Springer-Verlag, New York, is gratefully acknowl-
edged for his encouragement in pursuing this project. Springer-Verlag&rsquo;s Dr. Thomas
von Foerster is likewise acknowledged for the care with which he undertook the
production of the book, and also his colleague Steven Pisano, for his invaluable
help in the copy-editing of the final draft. Steven and his staff not only took care
</p>
<p>2Natural Sciences and Engineering Research Council of Canada.
3Fonds pour la formation de chercheurs et l&rsquo;aide &agrave; la recherche.
4Institute for Robotics and Intelligent Systems.</p>
<p/>
</div>
<div class="page"><p/>
<p>Preface to the First Edition xvii
</p>
<p>of the fine points of the typesetting but also picked up a few technical flaws in that
draft. Last but not least, may I acknowledge the excellent facilities and research
environment provided by the Centre for Intelligent Machines, the Department of
Mechanical Engineering of McGill University, and McGill University as a whole,
which were instrumental in completing this rather lengthy project.
</p>
<p>Montreal, QC, Canada Jorge Angeles</p>
<p/>
</div>
<div class="page"><p/>
</div>
<div class="page"><p/>
<p>Contents
</p>
<p>1 An Overview of Robotic Mechanical Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1
1.2 The General Architecture of Robotic Mechanical Systems . . . . . . . . 3
</p>
<p>1.2.1 Types of Robots by Function. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
1.2.2 Types of Robots by Size . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
1.2.3 Types of Robots by Application . . . . . . . . . . . . . . . . . . . . . . . . . . . 7
</p>
<p>1.3 Manipulators. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8
1.3.1 Robotic Arms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9
1.3.2 Robotic Hands . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
</p>
<p>1.4 Motion Generators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
1.4.1 Parallel Robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
1.4.2 SCARA Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15
</p>
<p>1.5 Locomotors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
1.5.1 Legged Robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
1.5.2 Wheeled Robots and Rovers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
</p>
<p>1.6 Swimming Robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
1.7 Flying Robots. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
1.8 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
</p>
<p>2 Mathematical Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
2.1 Preamble . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27
2.2 Linear Transformations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28
2.3 Rigid-Body Rotations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33
</p>
<p>2.3.1 The Cross-Product Matrix. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37
2.3.2 The Rotation Matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
2.3.3 The Linear Invariants of a 3 � 3 Matrix . . . . . . . . . . . . . . . . . . . 44
2.3.4 The Linear Invariants of a Rotation . . . . . . . . . . . . . . . . . . . . . . . . 46
2.3.5 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48
2.3.6 The Euler&ndash;Rodrigues Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . 55
</p>
<p>2.4 Composition of Reflections and Rotations . . . . . . . . . . . . . . . . . . . . . . . . . . 58
</p>
<p>xix</p>
<p/>
</div>
<div class="page"><p/>
<p>xx Contents
</p>
<p>2.5 Coordinate Transformations and Homogeneous Coordinates . . . . . . 60
2.5.1 Coordinate Transformations Between Frames
</p>
<p>with a Common Origin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60
2.5.2 Coordinate Transformation with Origin Shift . . . . . . . . . . . . . 64
2.5.3 Homogeneous Coordinates. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66
</p>
<p>2.6 Similarity Transformations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70
2.7 Invariance Concepts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76
</p>
<p>2.7.1 Applications to Redundant Sensing . . . . . . . . . . . . . . . . . . . . . . . 81
2.8 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85
</p>
<p>3 Fundamentals of Rigid-Body Mechanics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95
3.2 General Rigid-Body Motion and Its Associated Screw . . . . . . . . . . . . 95
</p>
<p>3.2.1 The Screw of a Rigid-Body Motion . . . . . . . . . . . . . . . . . . . . . . . 99
3.2.2 The Pl&uuml;cker Coordinates of a Line . . . . . . . . . . . . . . . . . . . . . . . . 102
3.2.3 The Pose of a Rigid Body . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
</p>
<p>3.3 Rotation of a Rigid Body About a Fixed Point . . . . . . . . . . . . . . . . . . . . . 108
3.4 General Instantaneous Motion of a Rigid Body . . . . . . . . . . . . . . . . . . . . 109
</p>
<p>3.4.1 The Instant Screw of a Rigid-Body Motion . . . . . . . . . . . . . . . 110
3.4.2 The Twist of a Rigid Body . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
</p>
<p>3.5 Acceleration Analysis of Rigid-Body Motions . . . . . . . . . . . . . . . . . . . . . 117
3.6 Rigid-Body Motion Referred to Moving Coordinate Axes . . . . . . . . 120
3.7 Static Analysis of Rigid Bodies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
3.8 Dynamics of Rigid Bodies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
3.9 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
</p>
<p>4 Geometry of Decoupled Serial Robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
4.2 The Denavit&ndash;Hartenberg Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139
4.3 The Geometric Model of Six-Revolute Manipulators . . . . . . . . . . . . . . 150
4.4 The Inverse Displacement Analysis of Decoupled Manipulators . . 154
</p>
<p>4.4.1 The Positioning Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154
4.4.2 The Orientation Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
</p>
<p>4.5 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
</p>
<p>5 Kinetostatics of Serial Robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185
5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 185
5.2 Velocity Analysis of Serial Manipulators . . . . . . . . . . . . . . . . . . . . . . . . . . . 186
</p>
<p>5.2.1 Decoupled Manipulators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
5.3 Jacobian Evaluation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194
</p>
<p>5.3.1 Evaluation of Submatrix A . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
5.3.2 Evaluation of Submatrix B . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197
</p>
<p>5.4 Singularity Analysis of Decoupled Manipulators. . . . . . . . . . . . . . . . . . . 199
5.4.1 Manipulator Workspace . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 202
</p>
<p>5.5 Acceleration Analysis of Serial Manipulators . . . . . . . . . . . . . . . . . . . . . . 206
5.6 Static Analysis of Serial Manipulators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210</p>
<p/>
</div>
<div class="page"><p/>
<p>Contents xxi
</p>
<p>5.7 Planar Manipulators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 212
5.7.1 Displacement Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 214
5.7.2 Velocity Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 216
5.7.3 Acceleration Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218
5.7.4 Static Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 220
</p>
<p>5.8 Kinetostatic Performance Indices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221
5.8.1 Positioning Manipulators. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 228
5.8.2 Orienting Manipulators. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 231
5.8.3 Positioning and Orienting Manipulators. . . . . . . . . . . . . . . . . . . 232
5.8.4 Computation of the Characteristic Length:
</p>
<p>Applications to Performance Evaluation . . . . . . . . . . . . . . . . . . 240
5.9 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 249
</p>
<p>6 Trajectory Planning: Pick-and-Place Operations . . . . . . . . . . . . . . . . . . . . . . . 255
6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 255
6.2 Background on PPO. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 256
6.3 Polynomial Interpolation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 258
</p>
<p>6.3.1 A 3-4-5 Interpolating Polynomial. . . . . . . . . . . . . . . . . . . . . . . . . . 258
6.3.2 A 4-5-6-7 Interpolating Polynomial . . . . . . . . . . . . . . . . . . . . . . . 262
</p>
<p>6.4 Cycloidal Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 265
6.5 Trajectories with via Poses. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 267
6.6 Synthesis of PPO Using Cubic Splines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 269
6.7 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 277
</p>
<p>7 Dynamics of Serial Robotic Manipulators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 281
7.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 281
7.2 Inverse vs. Forward Dynamics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 281
7.3 Fundamentals of Multibody System Dynamics . . . . . . . . . . . . . . . . . . . . . 283
</p>
<p>7.3.1 On Nomenclature and Basic Definitions . . . . . . . . . . . . . . . . . . 283
7.3.2 The Euler&ndash;Lagrange Equations of Serial Manipulators . . 284
7.3.3 Kane&rsquo;s Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 293
</p>
<p>7.4 Recursive Inverse Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 294
7.4.1 Kinematics Computations: Outward Recursions . . . . . . . . . . 295
7.4.2 Dynamics Computations: Inward Recursions . . . . . . . . . . . . . 301
</p>
<p>7.5 The Natural Orthogonal Complement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 306
7.5.1 Derivation of Constraint Equations and
</p>
<p>Twist&ndash;Shape Relations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 311
7.5.2 Noninertial Base Link . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 316
</p>
<p>7.6 Manipulator Forward Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 317
7.6.1 Planar Manipulators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 330
7.6.2 Algorithm Complexity . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 335
7.6.3 Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 339
</p>
<p>7.7 Incorporation of Gravity into the Dynamics Equations . . . . . . . . . . . . 342
7.8 The Modeling of Dissipative Forces. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 343
7.9 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 346</p>
<p/>
</div>
<div class="page"><p/>
<p>xxii Contents
</p>
<p>8 Special Topics in Rigid-Body Kinematics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 353
8.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 353
8.2 Computation of Angular Velocity from Point-Velocity Data. . . . . . . 353
</p>
<p>8.2.1 A Robust Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 360
8.3 Computation of Angular Acceleration
</p>
<p>from Point-Acceleration Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 362
8.3.1 A Robust Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 369
</p>
<p>8.4 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 370
</p>
<p>9 Geometry of General Serial Robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 375
9.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 375
9.2 The IDP of General Six-Revolute Manipulators . . . . . . . . . . . . . . . . . . . . 375
</p>
<p>9.2.1 Preliminaries . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 377
9.2.2 Derivation of the Fundamental Closure Equations . . . . . . . . 381
</p>
<p>9.3 The Univariate-Polynomial Approach . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 390
9.3.1 The Raghavan&ndash;Roth Procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . 390
9.3.2 The Li&ndash;Woernle&ndash;Hiller Procedure . . . . . . . . . . . . . . . . . . . . . . . . . 398
</p>
<p>9.4 The Bivariate-Equation Approach . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 401
9.4.1 Numerical Conditioning of the Solutions . . . . . . . . . . . . . . . . . 403
</p>
<p>9.5 Implementation of the Solution Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . 404
9.6 Computation of the Remaining Joint Angles . . . . . . . . . . . . . . . . . . . . . . . 406
</p>
<p>9.6.1 The Raghavan&ndash;Roth Procedure . . . . . . . . . . . . . . . . . . . . . . . . . . . . 406
9.6.2 The Li&ndash;Woernle&ndash;Hiller Procedure . . . . . . . . . . . . . . . . . . . . . . . . . 407
9.6.3 The Bivariate-Equation Approach . . . . . . . . . . . . . . . . . . . . . . . . . 408
</p>
<p>9.7 Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 410
9.8 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 418
</p>
<p>10 Kinematics of Alternative Robotic Mechanical Systems . . . . . . . . . . . . . . . 421
10.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421
10.2 Kinematics of Parallel Manipulators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 421
</p>
<p>10.2.1 Velocity and Acceleration Analyses
of Parallel Manipulators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 436
</p>
<p>10.3 Multifingered Hands . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 442
10.4 Walking Machines. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 447
10.5 Rolling Robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 450
</p>
<p>10.5.1 Robots with Conventional Wheels . . . . . . . . . . . . . . . . . . . . . . . . . 451
10.5.2 Robots with Omnidirectional Wheels . . . . . . . . . . . . . . . . . . . . . 457
</p>
<p>10.6 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 461
</p>
<p>11 Trajectory Planning: Continuous-Path Operations . . . . . . . . . . . . . . . . . . . . 465
11.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 465
11.2 Curve Geometry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 466
11.3 Parametric Path Representation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 472
11.4 Parametric Splines in Trajectory Planning . . . . . . . . . . . . . . . . . . . . . . . . . . 486
11.5 Continuous-Path Tracking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 492
11.6 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 501</p>
<p/>
</div>
<div class="page"><p/>
<p>Contents xxiii
</p>
<p>12 Dynamics of Complex Robotic Mechanical Systems . . . . . . . . . . . . . . . . . . . 507
12.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 507
12.2 Classification of Robotic Mechanical Systems
</p>
<p>with Regard to Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 507
12.3 The Structure of the Dynamics Models
</p>
<p>of Holonomic Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 509
12.4 Dynamics of Parallel Manipulators. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 512
12.5 Dynamics of Rolling Robots. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 523
</p>
<p>12.5.1 Robots with Conventional Wheels . . . . . . . . . . . . . . . . . . . . . . . . . 524
12.5.2 Robots with Omnidirectional Wheels . . . . . . . . . . . . . . . . . . . . . 534
</p>
<p>12.6 Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 543
</p>
<p>A Kinematics of Rotations: A Summary. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 547
</p>
<p>B Numerical Equation-Solving . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 555
B.1 The Overdetermined Linear Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 556
</p>
<p>B.1.1 The Numerical Solution of an Overdetermined
System of Linear Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 558
</p>
<p>B.2 The Underdetermined Linear Case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 562
B.2.1 The Numerical Solution of an
</p>
<p>Underdetermined System of Linear
Equations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 563
</p>
<p>B.3 Nonlinear-Equation Solving: The Determined Case . . . . . . . . . . . . . . . 564
B.3.1 The Newton&ndash;Raphson Method. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 566
</p>
<p>B.4 Overdetermined Nonlinear Systems of Equations . . . . . . . . . . . . . . . . . . 568
B.4.1 The Newton&ndash;Gauss Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 568
B.4.2 Convergence Criterion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 569
</p>
<p>References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 573
</p>
<p>Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 583
</p>
<p>. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . E-1Erratum  </p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 1
</p>
<p>An Overview of Robotic Mechanical Systems
</p>
<p>1.1 Introduction
</p>
<p>In defining the scope of our subject, we have to establish the genealogy of robotic
mechanical systems. These are, obviously, a subclass of the much broader class of
mechanical systems. Mechanical systems, in turn, constitute a subset of the more
general concept of dynamic systems. In the end, we must have an idea of what, in
general, a system is.
</p>
<p>The Concise Oxford Dictionary defines system as a &ldquo;complex whole, set of
connected things or parts, organized body of material or immaterial things,&rdquo; whereas
the Random House College Dictionary defines the same as &ldquo;an assemblage or
combination of things or parts forming a complex or unitary whole.&rdquo; Le Petit
Robert, in turn, defines system as &ldquo;Ensemble poss&eacute;dant une structure, constituant
un tout organique,&rdquo; which can be loosely translated as &ldquo;A structured assemblage
constituting an organic whole.&rdquo; In the foregoing definitions, we note that the
underlying idea is that of a set of elements interacting as a whole.
</p>
<p>On the other hand, a dynamic system is a subset of the set of systems. For our
purposes, we can dispense with a rigorous definition of this concept. Suffice it to
say that, to qualify as dynamic, a system should be endowed with three elements,
namely, a state, an input, and an output, in addition to a rule of transition from one
current state to a future one. Moreover, the state is a functional of the input and a
function of a previous state. In this concept, then, the idea of order is important, and
can be taken into account by properly associating each state value with time. The
state at every instant is a functional, as opposed to a function, of the input, which is
characteristic of dynamic systems. This means that the state of a dynamic system at
a certain instant is determined not only by the value of the input at that instant, but
</p>
<p>Electronic supplementary material The online version of this article (doi: 10.1007/978-3-319-
01851-5_1) contains supplementary material, which is available to authorized users.
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__1,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>1</p>
<p/>
</div>
<div class="page"><p/>
<p>2 1 An Overview of Robotic Mechanical Systems
</p>
<p>also by the past history of the input&mdash;besides, of course, its initial state. By virtue
of this property, dynamic systems are said to have memory.
</p>
<p>On the contrary, systems whose state at a given instant is only a function of the
input at the current time are static, and said to have no memory. Additionally, since
the state of a dynamic system is a result of all the past history of the input, the
future values of this having no influence on the state, dynamic systems are said to
be nonanticipative or causal. By the same token, systems whose state is the result of
future values of the input are said to be anticipative or noncausal. In fact, we need
not worry about the latter, and hence, all systems we will study will be assumed to
be causal.
</p>
<p>Obviously, a mechanical system is a system composed of mechanical elements.
If this system complies with the definition of dynamic system, then we end up with
a dynamic mechanical system. For brevity, we will refer to such systems as mechan-
ical systems, the dynamic property being implicit throughout the book. Mechanical
systems of this type are those that occur whenever the inertia of their elements is
accounted for. Static mechanical systems are those in which inertia is neglected.
Moreover, the elements constituting a mechanical system are rigid and deformable
solids, compressible and incompressible fluids, and inviscid and viscous fluids.
</p>
<p>From the foregoing discussion, then, it is apparent that mechanical systems can
be constituted either by lumped-parameter or by distributed-parameter elements.
The former reduce to particles; rigid bodies; massless, conservative springs; and
massless, nonconservative dashpots. The latter appear whenever bodies are modeled
as continuous media. In this book, we will focus on lumped-parameter mechanical
systems. In mechanical systems, the driving forces and moments exerted by the
actuators and the environment play the role of the input, the set of signals picked up
by the sensors that of the output. Finally, the rules of transition are dictated by the
laws of nature, especially from mechanics, electromagnetics and biology.
</p>
<p>Furthermore, a mechanical system can be either natural or engineered,1 the
latter being the subject of our study. Engineered mechanical systems can be either
controlled or uncontrolled. Most engineering systems are controlled mechanical
systems, and hence, we will focus on these. Moreover, a controlled mechanical
system may be robotic or nonrobotic. The latter are systems supplied with primitive
controllers, mostly analog, such as thermostats, servovalves, etc. Robotic mechan-
ical systems, in turn, can be programmable, such as most current industrial robots,
or intelligent, as discussed below. Programmable mechanical systems obey motion
commands either stored in a memory device or generated on-line. In either case,
they need sensors, such as joint encoders, accelerometers, and dynamometers.
</p>
<p>Intelligent robots or, more broadly speaking, intelligent machines, are yet to
be demonstrated, but have become the focus of intensive research. If intelligent
</p>
<p>1In the previous editions we had used the term &ldquo;man-made&rdquo; instead. To avoid a gender-biased
terminology, we could have used &ldquo;artificial,&rdquo; but this term, while meaning &ldquo;human-made,&rdquo; also has
a negative connotation: &ldquo;lacking in natural or spontaneous quality.&rdquo;</p>
<p/>
</div>
<div class="page"><p/>
<p>1.2 The General Architecture of Robotic Mechanical Systems 3
</p>
<p>machines are ever feasible, they will depend highly on a sophisticated sensory
system and the associated hardware and software for the processing of the infor-
mation supplied by the sensors. The processed information would then be supplied
to the actuators in charge of producing the desired robot motion. Contrary to pro-
grammable robots, whose operation is limited to structured environments, intelligent
machines should be capable of reacting to unpredictable changes in an unstructured
environment. Thus, intelligent machines should be supplied with decision-making
capabilities aimed at mimicking the natural decision-making process of living
organisms. This is the reason why such systems are termed intelligent in the first
place. Thus, intelligent machines are expected to perceive their environment and
draw conclusions based on this perception. What is supposed to make these systems
intelligent is their capability of perceiving, which involves a certain element of
subjectivity. By far, the most complex of perception tasks, both in humans and
machines, is visual (Levine 1985; Horn 1986).
</p>
<p>In summary, then, an intelligent machine is expected to (a) perceive the environ-
ment; (b) reason about this perception; (c) make decisions based on this reasoning;
and (d) act according to a plan specified at a very high level. What the latter means is
that the motions undergone by the machine are decided upon based on instructions
similar to those given to a human being, like bring me a glass of water without
spilling the water.
</p>
<p>Whether intelligent machines with all the above features will be 1 day possible
or not is still a subject of discussion, sometimes at a philosophical level. Penrose
(1994) wrote a refutal to the claim that intelligent machines are possible.
</p>
<p>A genealogy of mechanical systems, including robotic ones, is given in Fig. 1.1.
In that figure, we have drawn a dashed line between mechanical systems and
other systems, both engineered and natural. This line is intended to emphasize
the interaction of mechanical systems with electrical, thermal, and other systems,
including the human system, which is present in telemanipulators, to be discussed
below.
</p>
<p>1.2 The General Architecture of Robotic Mechanical
</p>
<p>Systems
</p>
<p>From Sect. 1.1, then, a robotic mechanical system is composed of a few subsystems,
namely, (a) a mechanical subsystem composed in turn of both rigid and deformable
bodies, although the systems we will study here are composed only of the former;
(b) a sensing subsystem; (c) an actuation subsystem; (d) a controller; and (e) an
information-processing subsystem. Additionally, these subsystems communicate
among themselves via interfaces, whose function consists basically of decoding
the transmitted information from one medium to another. Figure 1.2 illustrates the</p>
<p/>
</div>
<div class="page"><p/>
<p>4 1 An Overview of Robotic Mechanical Systems
</p>
<p>Fig. 1.1 A genealogy of robotic mechanical systems
</p>
<p>Fig. 1.2 General architecture of a robotic mechanical system</p>
<p/>
</div>
<div class="page"><p/>
<p>1.2 The General Architecture of Robotic Mechanical Systems 5
</p>
<p>general architecture2 of a typical robotic mechanical system. The input here is a
prescribed task, which is defined either on the spot or off-line. The former case
is essential for a machine to be called intelligent, while the latter is present in
programmable machines. Thus, tasks would be described to intelligent machines by
a software system based on techniques of artificial intelligence (AI). This system
would replace the human being in the decision-making process. Programmable
robots require human intervention either for the coding of preprogrammed tasks
at a very low level or for telemanipulation. A &ldquo;very low level of programming&rdquo;
means that the motions of the machine are specified as a sequence of either joint
motions or Cartesian coordinates associated with landmark points of that specific
body performing the task at hand. The output of a robotic mechanical system is the
actual task, which is monitored by the sensors. The sensors, in turn, transmit task
information in the form of feedback signals, to be compared with the prescribed
task. The errors between the prescribed and the actual task are then fed back into the
controller, which further synthesizes the necessary corrective signals. These are, in
turn, fed back into the actuators, which then drive the mechanical system through the
required task, thereby closing the loop. The problem of robot control has received
extensive attention in the literature, and will not be pursued here. The interested
reader is referred to the excellent works on the subject, e.g., those of Samson et al.
(1991), Khalil and Dombre (2002); and Spong et al. (2006). Of special relevance to
robot control is the subject of nonlinear control at large, a pioneer here being Isidori
(1989).
</p>
<p>Robotic mechanical systems with a human being in their control loop are
called telemanipulators. Thus, a telemanipulator is a robotic mechanical system in
which the task is controlled by a human, possibly aided by sophisticated sensors
and display units. The human operator replaces the ROBOT MODEL block in the
diagram of Fig. 1.2, produces the task description, becomes a part of the sensory
system, and plays a major role in the INFORMATION PROCESSING UNIT
block. Based on the information displayed, the operator makes decisions about
corrections in order to accomplish the prescribed task. Shown in Fig. 1.3 is a
telemanipulator designed for space applications, namely, the Canadarm2, along
with DEXTRE, the Special-Purpose Dextrous Manipulator (SPDM), both mounted
on the Mobile Servicing System (MSS), a module of the International Space Station.
Moreover, a detailed view of DEXTRE is shown in Fig. 1.4. In the manipulators of
these two figures, the human operator is an astronaut who commands and monitors
the motions of the robot from inside the EVA (extravehicular activity) workstation.
The number of controlled axes of each of these manipulators being larger than
</p>
<p>2In Chap. 4 we introduce the concept of robotic architecture, to indicate the geometry of the
underlying mechanical system. We refer here to the &ldquo;general architecture&rdquo; of the whole robotic
system, to distinguish between the two concepts.</p>
<p/>
</div>
<div class="page"><p/>
<p>6 1 An Overview of Robotic Mechanical Systems
</p>
<p>Fig. 1.3 Canadarm2 and
DEXTRE (courtesy of the
Canadian Space Agency)
</p>
<p>Fig. 1.4 DEXTRE, the
special-purpose dextrous
manipulator (courtesy of the
Canadian Space Agency)
</p>
<p>six, both are termed redundant. The challenge here is that the mapping from task
coordinates to joint motions is not unique, and hence, among the infinitely many
joint trajectories that the operator has at his or her disposal for a given task, an
on-board processor must evaluate the best one according to a performance criterion.</p>
<p/>
</div>
<div class="page"><p/>
<p>1.2 The General Architecture of Robotic Mechanical Systems 7
</p>
<p>1.2.1 Types of Robots by Function
</p>
<p>When the first edition was written, in the early nineties, the classification of
robots was rather straightforward, for there were mainly two kinds: serial and
parallel. Nowadays a robot classification is a daunting task, by virtue of the intense
activity displayed in the areas of robotics research, robot design, innovation and
applications. For example, a look at the proceedings of a recent edition of the
IEEE International Conference on Robotics and Automation will reveal a vast
spectrum of robots currently working on the shopfloor, in the operating room, in
rehabilitation centers, and even at home. In attempting a classification of robots, the
most comprehensive criterion would be by function. We thus have a tentative, but
by no means comprehensive, classification:
</p>
<p>&bull; Manipulators: robotic arms and hands;
&bull; motion generators: flight simulators; SCARA (Selective-Compliance Assembly
</p>
<p>Robot Arm); and moving platforms at large;
&bull; locomotors, a.k.a. mobile robots: legged and wheeled robots, including rovers;
&bull; swimming robots; and
&bull; flying robots.
</p>
<p>We expand below on these robot types.
</p>
<p>1.2.2 Types of Robots by Size
</p>
<p>The most common type of robots under this criterion is macro-robots, or those
whose dimensions are measured in meter. These are robots with a reach of
typically a couple of meters. Shown in Fig. 1.5 is a heavy-duty robot, IRB-7600,
manufactured by ABB Robotics, with a reach of 2.800 m and a load-carrying
capacity of 3,332 N. This robot finds applications mainly in the manipulation of
heavy parts in the automobile industry.
</p>
<p>Micro-robots bear dimensions allowing them a reach of a fraction of
a mm. For example, the robot reported by Sun et al. (2005) for MEMS
(micro-electromechanical systems) assembly, features a maximum reach of 100�m
in each of two orthogonal directions and one of 50�m in a direction orthogonal to
these two.
</p>
<p>1.2.3 Types of Robots by Application
</p>
<p>Robot applications have widespread as much as robot architectures. Current
applications span the classical industrial robots for arc-welding, for example,
on to material-handling, surveillance, surgical operations, rehabilitation and
entertainment.</p>
<p/>
</div>
<div class="page"><p/>
<p>8 1 An Overview of Robotic Mechanical Systems
</p>
<p>Fig. 1.5 The IRB-7600, a
heavy-duty robotic arm with a
serial architecture (courtesy
of ABB robotics)
</p>
<p>1.3 Manipulators
</p>
<p>Of all robotic mechanical systems, manipulators deserve special attention for
various reasons. One is that, in their simplest form, as robotic arms, they occur most
frequently in industry. Another is that the architecture of robotic arms constitutes the
simplest of all robotic architectures, and hence, appear as constituents of other, more
complex robotic mechanical systems, as will become apparent in later chapters.
A manipulator, in general, is a mechanical system aimed at object manipulation.
Manipulating, in turn, means to move something with one&rsquo;s hands, as the word
derives from the Latin manus, meaning hand. The basic idea behind the foregoing
concept is that hands are among the organs that the human brain can control
mechanically with the highest accuracy, as the work of an artist like Picasso, of
an accomplished guitar player, or of a surgeon can attest.
</p>
<p>A manipulator is thus any device that helps a human operator perform a
manipulating task. Although manipulators have existed ever since man created the
first tool, only very recently, namely, by the end of World War II, have manipulators
developed to the extent that they are now capable of actually mimicking motions of
the human arm, and of the human hand, for that matter. In fact, during WWII, the
need arose for manipulating probe tubes containing radioactive substances. This led
to the first six-degree-of-freedom (six-dof) manipulators.
</p>
<p>Shortly thereafter, the need for manufacturing workpieces with high accuracy
arose in the aircraft industry, which led to the first numerically-controlled (NC)</p>
<p/>
</div>
<div class="page"><p/>
<p>1.3 Manipulators 9
</p>
<p>machine tools. The synthesis of the six-DOF manipulator and the NC machine
tool produced what became the robotic manipulator. Thus, the essential difference
between the early manipulator and the evolved robotic manipulator is the &ldquo;robotic&rdquo;
qualifier, which came into the picture in the late sixties. A robotic manipulator is
to be distinguished from the early manipulator by its capability of lending itself to
computer control. While the early manipulator needed the presence of a human in
the loop, to have a master manipulator perform a gesture, the robotic manipulator
can be programmed once and for all to repeat the same task forever. Programmable
manipulators owe their existence to the microprocessor. Indeed, the microprocessor,
introduced in 1976 by Intel, allowed a human master to teach the manipulator
by actually driving the manipulator itself, or a replica thereof, through a desired
task, while recording all motions undergone by the master. Thus, the manipulator
would later repeat the identical task by mere playback. However, the capabilities
of industrial robots are fully exploited only if the manipulator is programmed
with software, rather than actually driving it through its task trajectory, which
many a time, e.g., in car-body spot-welding, requires separating the robot from the
production line for more than a week. One of the objectives of this book is to develop
tools for the programming of robotic manipulators.
</p>
<p>Nevertheless, the capabilities offered by robotic mechanical systems go well
beyond the mere playback of preprogrammed tasks. Current research aims to
providing robotic systems with software and hardware that will allow them to make
decisions on the spot and learn while performing a task. The implementation of such
systems calls for task-planning techniques that fall beyond the scope of this book
and, hence, will not be treated here. For a glimpse of such techniques, the reader is
referred to the work of Latombe (1991) and the references therein.
</p>
<p>1.3.1 Robotic Arms
</p>
<p>Robotic manipulators first appeared as mechanical systems resembling the human
arm. Robotic arms are thus constituted by a mechanical system consisting of
structurally robust links coupled by either rotational or translating joints, the former
being called revolutes, the latter prismatic joints. Moreover, these structures are a
concatenation of links, thereby forming an open kinematic chain, with each link
coupled to a predecessor and a successor, except for the two end links, which are
coupled only to either a predecessor or to a successor, but not to both. The robot
displayed in Fig. 1.5 is an example of a robotic arm with strong links.
</p>
<p>Because of the serial nature of the coupling of links in this type of manipulator,
even if they are supplied with structurally robust links, their load-carrying capacity
and their stiffness is too low when compared with the other multiaxis machines, such
as NC machine tools. Obviously, a low stiffness implies a low positioning accuracy.</p>
<p/>
</div>
<div class="page"><p/>
<p>10 1 An Overview of Robotic Mechanical Systems
</p>
<p>1.3.2 Robotic Hands
</p>
<p>Besides the hand, other mechanical subsystems constituting the human manipu-
lation system are the arm and the forearm. Moreover, the shoulder, coupling the
arm with the torso, can be regarded as a spherical joint, i.e., the concatenation of
three revolute joints with intersecting axes. Furthermore, the arm and the forearm
are coupled via the elbow, with the forearm and the hand finally being coupled
by the wrist. Frequently, the wrist is modeled as a spherical joint as well, while
the elbow is modeled as a simple revolute joint. Robotic mechanical systems
mimicking the motions of the arm and the forearm constitute the manipulators
discussed above. Here we outline more sophisticated manipulation systems that aim
to produce the motions of the human hand, i.e., robotic hands. These systems are
designed to perform manipulation tasks, a distinction being made between simple
manipulation and dextrous manipulation. What the former means is the simplest
form, in which the fingers play a minor role, namely, by serving as simple static
structures that keep an object rigidly attached to the palm of the hand&mdash;when the
palm is regarded as a rigid body. As opposed to simple manipulation, dextrous
manipulation involves a controlled motion of the grasped object with respect to
the palm. Simple manipulation can be achieved with the aid of a manipulator and
a gripper, and need not be further discussed here. The discussion here is about
dextrous manipulation.
</p>
<p>In dextrous manipulation, the grasped object is required to move with respect
to the palm of the grasping hand. This kind of manipulation appears in performing
tasks that require high levels of accuracy, like handwriting or cutting tissue with a
scalpel. Usually, grasping hands are multifingered, although some grasping devices
exist that are constituted by a simple, open, highly redundant kinematic chain (Petti-
nato and Stephanou 1989). The kinematics of grasping is discussed in Chap. 10. The
basic kinematic structure of a multifingered hand consists of a palm, which plays the
role of the base of a simple manipulator, and a set of fingers. Thus, kinematically
speaking, a multifingered hand has a tree topology, i.e., it entails a common rigid
body, the palm, and a set of jointed bodies emanating from the palm. Upon grasping
an object with all the fingers, the chain becomes closed, with multiple loops.
Moreover, the architecture of the fingers is that of a simple manipulator, consisting
of a number&mdash;two to four&mdash;of revolute-coupled links playing the role of phalanges.
However, unlike manipulators of the serial type, whose joints are all independently
actuated, those of a mechanical finger are not and, in many instances, are driven by
one single master actuator, the remaining joints acting as slaves. Many versions
of multifingered hands exist: Stanford/JPL; Utah/MIT; TU Munich; Karlsruhe;
Bologna; Leuven; Milan; Belgrade; and University of Toronto, among others. Of
these, the Utah/MIT Hand (Jacobsen et al. 1984, 1986) is commercially available.
This hand carries four fingers, one of which is opposed to the other three and
hence, plays the role of the human thumb. Each finger consists, in turn, of four
phalanges coupled by revolute joints; each of these is driven by two tendons that
can deliver force only when in tension, each being actuated independently. The TU</p>
<p/>
</div>
<div class="page"><p/>
<p>1.3 Manipulators 11
</p>
<p>Fig. 1.6 Two instances of robotic hands: (a) the four-fingered hydraulically actuated TU Munich
Hand (courtesy of Prof. F. Pfeiffer); and (b) Universit&eacute; Laval&rsquo;s, three-fingered SARAH (courtesy
of Prof. C. Gosselin)
</p>
<p>Munich Hand, shown in Fig. 1.6a, is designed with four identical fingers laid out
symmetrically on a hand palm. This hand is hydraulically actuated, and provided
with a very high payload-to-weight ratio. Indeed, each finger weighs only 1.470 N,
but can exert a force of up to 30 N. A three-fingered hand with 12 degrees of
freedom and six actuators, SARAH, was designed at Universit&eacute; Laval&rsquo;s Laboratoire
de Robotique. This hand, illustrated in Fig. 1.6b, is twice as big as the human hand,
weighs 88.2 N, and can hold a 686-N load (Lalibert&eacute; et al. 2002).
</p>
<p>We outline below some problems and research trends in the area of dextrous
hands. A key issue here is the programming of the motions of the fingers, which is
a much more complicated task than the programming of a six-axis manipulator.
In this regard, Liu et al. (1989) introduced a task-analysis approach intended
to program robotic hand motions at a higher level. These researchers used a
heuristic, knowledge-based approach. From an analysis of the various modes of
grasping, they concluded that the requirements for grasping tasks are (a) stability,
(b) manipulability, (c) torquability, and (d) radial rotatability. Stability is defined
as a measure of the tendency of an object to return to its original position
after disturbances. Manipulability, as understood in this context, is the ability to
impart motion to the object while keeping the fingers in contact with the object.
Torquability, or tangential rotatability, is the ability to rotate the long axis of an
object&mdash;here the authors must assume that the manipulated objects are convex and
can be approximated by three-axis ellipsoids, thereby distinguishing between a long
and a short axis&mdash;with a minimum force, for a prescribed amount of torque. Finally,</p>
<p/>
</div>
<div class="page"><p/>
<p>12 1 An Overview of Robotic Mechanical Systems
</p>
<p>radial rotatability is the ability to rotate the grasped object about its long axis with
minimum torque about the axis.
</p>
<p>Furthermore, Allen et al. (1989) introduced an integrated system of both
hardware and software for dextrous manipulation. The system integrates force and
position sensors with control commands for both the arm and the hand. To demon-
strate the effectiveness of their system, the authors implemented a task consisting
of removing a light bulb from its socket. Rus (1992) proposed, in turn, a paradigm
allowing the high-level, task-oriented manipulation control of planar hands.
</p>
<p>While the technological aspects of dextrous manipulation are highly advanced,
theoretical aspects are still under research in this area. An extensive literature survey,
with 405 references on the subject of manipulation, was given by Reynaerts (1995).
But that was the state of the art in the early nineties. In the 2005 IEEE International
Conference on Robotics and Automation, there were five sessions on grasping,
robotic-finger design, robotic hands and dextrous manipulation. An interesting
approach to the programming of dextrous hands, programming by demonstration,
was reported by Ekvall and Krajić (2005), under which the robotic hand is taught
how to reproduce the grasping sequences of a human hand. The use of vision as a
means of grasp-planning was also reported in this conference (Gockel et al. 2005).
</p>
<p>1.4 Motion Generators
</p>
<p>Under this heading we include robotic systems designed to produce a certain class of
motions for various purposes, ranging from manipulation tasks, e.g., the positioning
of a camera for surveillance, to the orientation of a surgeon&rsquo;s scalpel, on to moving
platforms for pilot training, as in flight simulators, or for entertainment, to give
people the realism of an earthquake or a roller-coaster, or simply of following a
musical rhythm. Many a motion generator is supplied with a parallel architecture,
as described below.
</p>
<p>1.4.1 Parallel Robots
</p>
<p>Parallel robots were originally proposed to cope with the problems encountered
with their serial counterparts (Merlet 2006), namely, a limited load-carrying capac-
ity, low accuracy, and low stiffness. This kind of robot was thus introduced to
withstand higher payloads with lighter links. In a parallel robot, we distinguish
one base platform, one moving platform, and various legs or limbs. Each leg is,
in turn, a kinematic chain of the serial type, whose end-links are the two platforms.
Contrary to serial robots, all of whose joints are actuated, parallel robots are supplied
with unactuated joints, which brings about a substantial difference between the two
types. The presence of unactuated joints makes the analysis of parallel manipulators,
in general, more complex than that of serial robots.</p>
<p/>
</div>
<div class="page"><p/>
<p>1.4 Motion Generators 13
</p>
<p>Fig. 1.7 Universit&eacute; Laval&rsquo;s
Agile Eye, a
three-degree-of-freedom
spherical robot with a parallel
architecture (courtesy of Prof.
Cl&eacute;ment Gosselin)
</p>
<p>A paradigm of parallel manipulators is the flight simulator, consisting of six legs
actuated by hydraulic pistons. The flight simulator with this architecture motivated
the early work, starting in the late eighties, on parallel robots. Recently, an explosion
of novel designs of parallel robots has occurred, aimed at fast manipulation tasks.
An example of these robots, departing from the architecture of flight simulators, is
Universit&eacute; Laval&rsquo;s Agile Eye, depicted in Fig. 1.7. This robot is designed with one
fixed base and one moving platform, that carries a small camera. Base and platform
are coupled by means of three identical legs, each composed of two links and three
revolute joints.3 Moreover, the axes of all nine revolutes intersect at one single point,
the center of the mechanical system. For this reason, all robot links move, with
respect to the base, under pure rotation, with the robot center remaining fixed. All
three direct-drive motors are mounted on the base, and actuate the proximal links of
the legs. This robot can reportedly produce angular velocities of the camera as high
as 1,000ı/s and angular accelerations of 20,000ı=s2.
</p>
<p>Other parallel robots have been designed for fast assembly operations, e.g., the
Delta robot (Clavel 1988), developed at the Lausanne Federal Polytechnic Institute
(EPFL). The Delta robot was designed to produce pure translations of its end-
platform in 3D space. An instance of this robot, enhanced with a fourth joint of
vertical axis, the FlexPicker, is shown in Fig. 1.8. This robot is designed with three
identical legs, hanging from the ceiling, which is the robot base. Each leg carries one
proximal link, coupled to the base by a revolute, which is actuated by the leg-motor.
Furthermore, this link is coupled to the end-plate by means of two revolutes and
</p>
<p>3It can be appreciated in Fig. 1.7 that the proximal links are made up of two curved beams, each
with an axis in the form of one-quarter of a circle. These two beams are rigidly fastened, with their
planes forming a 90ı dihedral angle.</p>
<p/>
</div>
<div class="page"><p/>
<p>14 1 An Overview of Robotic Mechanical Systems
</p>
<p>Fig. 1.8 FlexPicker, a
realization of EPFL&rsquo;s Delta
Robot (courtesy of ABB
Robotics)
</p>
<p>one novel kinematic pair, the &hellip;-pair, which is nothing but a parallelogram four-bar
linkage, the&hellip;-pair being located between the two revolutes. It is noteworthy that the
FlexPicker is supplied with one additional actuated joint, at the interface between
the moving platform of the original Delta Robot and the gripper, appearing in the
figure as a cylindrical piece. This revolute is actuated from the base by means of a
transmission mechanism stemming from the center of the base in the figure.
</p>
<p>Other instances of parallel robots can be cited: Hexa (Pierrot et al. 1991),
developed at Universit&eacute; de Montpellier, as a six-degree-of-freedom extension of
Clavel&rsquo;s Delta Robot; Star (Herv&eacute; and Sparacino 1992), developed at Ecole Centrale
of Paris; the Trussarm, developed at the University of Toronto Institute of Aerospace
Studies (UTIAS), shown in Fig. 1.9a (Hughes et al. 1991); INRIA&rsquo;s main gauche,
or left hand, developed by Merlet (2006)4 and shown in Fig. 1.9b, which is used
as an aid to another robot, possibly of the serial type, to enhance its dexterity;
and McGill University&rsquo;s parallel manipulator, intended as a shoulder module for
</p>
<p>4INRIA is France&rsquo;s Institut National de Recherche en Informatique et en Automatique, the left
hand, and other parallel robots having been developed at INRIA&rsquo;s center at Sophia-Antipolis,
France.</p>
<p/>
</div>
<div class="page"><p/>
<p>1.4 Motion Generators 15
</p>
<p>Fig. 1.9 A sample of parallel manipulators: (a) the UTIAS Trussarm (courtesy of Prof. P. C.
Hughes); (b) the Merlet left hand (courtesy of Dr. J.-P. Merlet); and (c) the Hayward shoulder
module (courtesy of Prof. V. Hayward)
</p>
<p>orientation tasks (Hayward 1994), and capable of three-degree-of-freedom motions,
produced by four hydraulic actuators, which gives the robot redundant actuation&mdash;
Fig. 1.9c.
</p>
<p>1.4.2 SCARA Systems
</p>
<p>SCARA is an acronym standing for Selective-Compliance Assembly Robot Arm, as
coined by Hiroshi Makino (Makino and Furuya 1980), the inventor of this new</p>
<p/>
</div>
<div class="page"><p/>
<p>16 1 An Overview of Robotic Mechanical Systems
</p>
<p>class of robots. The class was proposed as a means to provide motion capabilities
to the end-effector that are required by the assembly of printed-board circuits and
other electronic devices with a flat geometry. Motions consist of three independent
translations and one rotation about an axis of fixed orientation, usually vertical.
These robots have received special attention because of their special structure,
offering an extremely high stiffness about two axes of tilting&mdash;the axes normal to
the axis of rotation. The first robots of this kind appeared with a serial architecture,
involving three revolutes and one prismatic joint, the latter being located either at
the base or at the end-effector. These robots have attained impressive performance,
capable of cycle times of 500 ms or lower, for a standard pick-and-place operation
consisting of: (a) upwards translation of 25 mm; (b) horizontal translation of
300 mm, concurrently rotating through an angle of 180ı; and (c) downwards
translation of 25 mm. The cycle is closed by returning to the original posture
following exactly the same displacement program, but in the reverse order.
</p>
<p>Given the serial architecture of most SCARA systems, it appears that the cycle
times are extremely difficult to cut further and the load-carrying capacity is equally
difficult to increase. This state of affairs has motivated the emergence of alternative
architectures, such as parallel or hybrid (serial-parallel). For example, Fanuc&rsquo;s
M410iB and ABB Robotics&rsquo; FlexPicker, shown in Fig. 1.8, feature hybrid SCARA
architectures with long reaches, of around 3 m and payloads of above 2000 N. The
manufacturers did this by means of parallelogram linkages capable of transmitting
torque and motion from a common base, turning about a vertical axis, to two
horizontal revolute joints, the fourth revolute having a vertical axis. Interestingly,
although these robots are medium-to-heavy-duty SCARAs, the manufacturers bill
them as &ldquo;palletizing robots,&rdquo; with no relation to SCARAs. As a matter of fact,
SCARAs can be regarded as generators of the Sch&ouml;nflies displacement subgroup
(Bottema and Roth 1979; Herv&eacute; 1999). For this reason, SCARA systems are
currently referred to as Sch&ouml;nflies-motion generators.
</p>
<p>In yet another attempt to overcome the natural limitations of serial SCARAs,
parallel architectures have been proposed: H4, a four-limb Sch&ouml;nflies-motion gen-
erator developed at France&rsquo;s Universit&eacute; de Montpellier (Company et al. 2001); the
four-limb robot driven with actuated prismatic joints developed at Institut Fran&ccedil;ais
de M&eacute;canique Avanc&eacute;e (Gogu 2004); and the McGill SMG developed at McGill
University (Al-Widyan and Angeles 2004), that features only two limbs. However,
this robot is overconstrained, besides exhibiting a rather limited rotatability of its
moving platform. An alternative two-limb parallel SCARA was proposed recently
that features an isostatic kinematic chain (Lee and Lee 2010), thereby allowing
for assembly even in the presence of non-negligible machining and manufacturing
errors. The architecture of this robot is illustrated in Fig. 1.10, which features
two cylindrical pairs&mdash;two-degree-of-freedom (two-dof) joints that produce rotation
about an axis and translation in a direction parallel to the axis&mdash;as drive units, to
produce Sch&ouml;nflies motions. The gripper is rigidly fastened to a rod with two screws
at the ends, of different pitches.</p>
<p/>
</div>
<div class="page"><p/>
<p>1.5 Locomotors 17
</p>
<p>Fig. 1.10 An isostatic
two-limb robot capable of
SCARA motions
</p>
<p>1.5 Locomotors
</p>
<p>Under locomotors we include all robots capable of displacing themselves on a
surface without any attachment to the surface. Here we distinguish two kinds of
robots, legged and wheeled, as outlined below.
</p>
<p>1.5.1 Legged Robots
</p>
<p>A common architecture of walking machines is the hexapod, examples of which are
the Ohio State University (OSU) Hexapod (Klein et al. 1983) and the OSU Adaptive
Suspension Vehicle (ASV) (Song and Waldron 1989). A six-legged walking
machine with a design that mimics the locomotion system of the Carausius morosus
(Graham 1972), also known as the walking stick, was developed at the Technical
University of Munich (Pfeiffer et al. 1995). A prototype of this machine, known
as the TUM Hexapod, is displayed in Fig. 1.11. The legs of the TUM Hexapod
are operated under neural-network control, which gives them a reflex-like response
when encountering obstacles: upon sensing an obstacle, the leg bounces back and
tries again to move forward, but raising the foot to a higher level. Other legged robots
worth mentioning as pioneers are the Sutherland, Sprout and Associates Hexapod
(Sutherland and Ullner 1984), the Titan series of quadrupeds (Hirose et al. 1985)
and the Odetics series of axially symmetric hexapods (Russell 1983).</p>
<p/>
</div>
<div class="page"><p/>
<p>18 1 An Overview of Robotic Mechanical Systems
</p>
<p>Fig. 1.11 A prototype of the
TU Munich Hexapod
(courtesy of Prof. F. Pfeiffer.
Reproduced with permission
of TSI Enterprises, Inc.)
</p>
<p>Surveys of walking machines, of historical interest now, are those of Todd (1985)
and the special issue of The International Journal of Robotics Research (Vol. 9,
No. 2).
</p>
<p>Walking machines appear as the sole means of providing locomotion in highly
unstructured environments. In fact, the unique adaptive suspension provided by
these machines allows them to navigate on uneven terrain. However, walking
machines cannot traverse every type of uneven terrain, for they are of limited
dimensions. Hence, if terrain irregularities such as a crevasse wider than the
maximum horizontal leg reach or a cliff of depth greater than the maximum vertical
leg reach are present, then the machine is prevented from making any progress. This
limitation, however, can be overcome by providing the machine with the capability
of attaching its feet to the terrain in the same way as a mountain climber goes
up a cliff. Moreover, machine functionality is limited not only by the topography
of the terrain, but also by the terrain constitution. Whereas hard rock poses no
serious problem to a walking machine, muddy terrain can hamper its operation to
the point that it may jam the machine. Still, under such adverse conditions, walking
machines offer a better maneuverability than other vehicles. Recent work at McGill
University5 on legged locomotion has led to robots with robust designs allowing
them to negotiate mud and even ponds. A series of hexapods, under the name RHEX,
has been developed with these features, as shown in Fig. 1.12. The same robot is
shown in Fig. 1.13 roaming a patterned floor, of about 500 mm in length, to give a
clue on its dimensions.
</p>
<p>Humanoids
</p>
<p>An important class of legged robots is that of humanoids. Pioneer work by
Vukobratovic and Stepanenko (1972) has led to modern bipeds exhibiting impres-
</p>
<p>5Originally led by Prof. Martin Buehler.</p>
<p/>
</div>
<div class="page"><p/>
<p>1.5 Locomotors 19
</p>
<p>Fig. 1.12 RHEX, a
six-legged robot (courtesy of
G. Dudek, McGill University)
</p>
<p>Fig. 1.13 RHEX walking on
a patterned floor, to indicate
its dimensions (courtesy of G.
Dudek, McGill University)
</p>
<p>sive performance. Indeed, work initiated in 1986 at Honda led to ASIMO, a robotic
mechanical system integrating both manipulation and locomotion in one single unit.
</p>
<p>Research in humanoids is quite intensive at the moment, with multiple sessions
on the subject during the annual IEEE International Conference on Robotics
and Automation, including controls, motion-planning, design, voice-mimicry, and
human-robot interaction.
</p>
<p>1.5.2 Wheeled Robots and Rovers
</p>
<p>Robots in this category are systems evolved from earlier systems called automatic
guided vehicles, or AGVs for short. AGVs in their most primitive versions are four-
wheeled, electrically powered vehicles that perform moving tasks with a certain
degree of autonomy. However, these vehicles are usually limited to motions along
predefined tracks that are either railways or magnetic strips glued to the ground.</p>
<p/>
</div>
<div class="page"><p/>
<p>20 1 An Overview of Robotic Mechanical Systems
</p>
<p>The most common rolling robots use conventional wheels, i.e., wheels consisting
basically of a pneumatic tire mounted on a hub that rotates about an axle fixed to the
robot platform. Thus, the operation of these machines does not differ much from that
of conventional terrestrial vehicles. An essential difference between rolling robots
and other robotic mechanical systems is the kinematic constraints between wheel
and ground in the former. These constraints are of a type known as nonholonomic,
as discussed in detail in Chap. 12. Nonholonomic constraints are kinematic relations
between point velocities and angular velocities that cannot be integrated in the form
of algebraic relations between translational and rotational displacement variables.
The outcome of this lack of integrability leads to a lack of a one-to-one relationship
between Cartesian variables and joint variables. In fact, while angular displacements
read by joint encoders of serial manipulators determine uniquely the position and
orientation of their end-effector, the angular displacement of the wheels of rolling
machines do not determine the position and orientation of the vehicle body. As
a matter of fact, the control of rolling robots bears common features with the
redundancy-resolution of manipulators of the serial type at the joint-rate level. In
these manipulators, the number of actuated joints is greater than the dimension of
the task space. As a consequence, the task velocity does not determine the joint
rates. Not surprisingly, the two types of problems have been solved using the same
tools, namely, differential geometry and Lie algebra (De Luca and Oriolo 1995).
</p>
<p>As a means to supply rolling robots with three-dof capabilities, not found
in conventional terrestrial vehicles, omnidirectional wheels (ODWs) have been
developed. Examples of ODWs bear names such as Mekanum wheels, Swedish
wheels, ilonators, or others. ODWs consist of a hub with rollers on its periphery that
roll freely about their axes, the latter being oriented at a constant angle with respect
to the hub axis. Rolling robots with ODWs are, thus, three-dof vehicles, and hence,
can translate freely in two horizontal directions and rotate independently about a
vertical axis. However, like their two-dof counterparts, three-dof rolling robots are
also nonholonomic devices, and thus, pose the same problems for their control
as the former. The kinematics and dynamics of robots with ODWs are studied in
Sects. 10.5.2 and 12.5.2, respectively.
</p>
<p>Further developments in the technology of rolling robots have been reported
that incorporate alternative types of ODWs. For example, Killough and Pin (1992)
developed a rolling robot with what they call orthogonal ball wheels, consisting
of spherical wheels that can rotate about two mutually orthogonal axes. Borenstein
(1993) proposed a mobile robot with four degrees of freedom; these were achieved
with two chassis coupled by an extensible link, each chassis being driven by two
actuated conventional wheels. West and Asada (1995), in turn, designed a rolling
robot with ball wheels, i.e., balls that act as omnidirectional wheels; each ball is
mounted on a set of rollers, one of which is actuated; hence, three such wheels are
necessary to fully control the vehicle. The unactuated rollers serve two purposes,
i.e., to provide stability to the wheels and the vehicle, and to measure the rotation of
the ball, thereby detecting slip.</p>
<p/>
</div>
<div class="page"><p/>
<p>1.5 Locomotors 21
</p>
<p>Fig. 1.14 QUASIMORO, a
quasiholonomic mobile robot
</p>
<p>Mobile Wheeled Pendulums
</p>
<p>A new class of wheeled robots has emerged since the turn of the century. This class,
known as mobile wheeled pendulums (MWP), comprises two coaxial wheels and an
intermediate body, the challenge being to control both the motion of the common
wheel axis and that of the intermediate body. Interest on the subject was probably
promoted by the US patent behind the Ginger and the Segway Human Transporter
projects. Another mobile inverted pendulum is known as JOE. More recently, a
new class of nonholonomic mechanical systems was found that lies somewhat
between holonomic and nonholonomic systems; these systems were thus termed
quasiholonomic (Ostrovskaya and Angeles 1998). A realization of this class was
reported by Salerno and Angeles (2004), featuring Quasimoro, shown in Fig. 1.14,
a quasiholonomic mobile robot intended as a service robot for the motion-impaired.
Quasimoro&rsquo;s central body is to carry food, drinks and books to the user. This robot
also falls within the category of MWP. A feature common to this category, that is
not encountered in other wheeled robots, is that their central body, which plays the
role of the robot platform, can rotate about the wheel axis. This motion should be
controlled, thereby leading to a new challenging problem, which is the stabilization
of the central body, aside the classical control problem due to nonholonomy.
</p>
<p>1.5.2.1 Rovers
</p>
<p>Yet another class of wheeled mobile robots is known as rovers. These differ from
other wheeled robots in that they are intended for uneven, unstructured terrain, like
that found off-road on the Earth, on the Moon and on Mars. The latest high-profile
rover is NASA&rsquo;s Curiosity, launched from Cape Canaveral on November 26, 2011,
having landed on Mars on August 6, 2012. As rovers are intended for extraterrestrial
exploration, their wheels are not expected to roll without slipping; instead, they are</p>
<p/>
</div>
<div class="page"><p/>
<p>22 1 An Overview of Robotic Mechanical Systems
</p>
<p>Fig. 1.15 Rover Chassis
Prototype (RCP) undergoing
tests at the University of
Toronto Institute for
Aerospace Studies
(UTIAS)Mars Dome
(courtesy of MDA
Corporation, Brampton, ON)
</p>
<p>Fig. 1.16 A computer model
of the Sojourner, produced
with Vortex (image courtesy
of CM Labs Simulations Inc.)
</p>
<p>designed to provide enough traction in the presence of soft, dry terrain. To this
end, the rover wheels are supplied with grousers, i.e., crests protruding from the
periphery of metal wheels. A prototype produced by MDA for planetary exploration
is displayed in Fig. 1.15, showing its six wheels, all supplied with grousers. A
challenge in the development of planetary rovers lies in that tests on the environment
on which rovers are intended to roam are not possible. Conditions are emulated on
the Earth that try to mimic the Moon&rsquo;s or Mars&rsquo;s regolith. One instance is the UTIAS
Mars Dome&mdash;see Fig. 1.15. Moreover, the mechanics of wheel&ndash;soil interaction can
only be simulated with suitable software. CM Labs&rsquo; Vortex was used to produce the
model of the Sojourner depicted in Fig. 1.16. Using this model, a novel approach
was introduced to represent the wheel&ndash;soil interaction, that is based on plasticity
theory (Azimi et al. 2012).</p>
<p/>
</div>
<div class="page"><p/>
<p>1.6 Swimming Robots 23
</p>
<p>Fig. 1.17 Aqua, an
amphibious robot (courtesy
of G. Dudek/M. Jenkin on
behalf of the Aqua Project)
</p>
<p>Fig. 1.18 Aqua, swimming
under monitoring by its
designer (courtesy of G.
Dudek/M. Jenkin on behalf of
the Aqua Project)
</p>
<p>1.6 Swimming Robots
</p>
<p>A novel class of robots with swimming capabilities is currently under development
in various research laboratories. Some of these robots have been designed with
the morphology of fish (Wen et al. 2011). One swimming robot designed with a
hexapod morphology, featuring six flippers in lieu of legs is Aqua, developed at
McGill University, and depicted in Figs. 1.17 and 1.18. The latter shows Aqua with
its designer, Chris Prahacs.</p>
<p/>
</div>
<div class="page"><p/>
<p>24 1 An Overview of Robotic Mechanical Systems
</p>
<p>1.7 Flying Robots
</p>
<p>This field is becoming quite active, with some robots mimicking the morphology
of insects, and falling into the category of micro-robots Hines et al. (2011); other
flying robots are designed as unmanned aerial vehicles (UAV) Thorne and Yim
(2011). Intensive research is now being reported in the design and control of
two novel types of UAVs, namely, drones and quadrotors. The control of drones
undergoing fast manuevers has been made possible by the inception of gyro-
free inertial measurement systems fabricated with MEMS6 technology. Highly
maneuverable quadrotors, especially suitable for surveillance and reconnaissance
missions, are small-size, light-weight flying machines supplied with &ldquo;two pairs of
counter-rotating rotors and propellers, located at the vertices of a square frame&rdquo;
(Lee et al. 2010). A recent issue of IEEE&rsquo;s Robotics &amp; Automation Magazine&mdash;
Vol. 19, No. 3, September 2012&mdash;includes a state-of-the-art account of quadrotor
technology.
</p>
<p>1.8 Exercises
</p>
<p>The exercises included below are intended to familiarize the uninitiated reader
with the issues involved in robotics, especially in the area of robotic mechanical
systems. A major issue, regrettably quite often overlooked, is terminology. In
attempting to work out these exercises, the beginner should be able to better
understand the language of robotics and realize that a common terminology is
not yet available. Some exercises are provided as an aid to either recall or learn
fundamental computational issues that are extremely useful in the development of
algorithms for the analysis, simulation and control of robotic mechanical systems.
</p>
<p>1.1 List some definitions of machine, say about half a dozen, trying to cover the
broadest timespan to date. Hint: Hartenberg and Denavit (1964) list a few
bibliographical references.
</p>
<p>1.2 Try to give an answer to the question: Are intelligent machines possible?
Express your own ideas and explore what scientists like Penrose (1994) think
about this controversial issue.
</p>
<p>1.3 What is the difference among machine, mechanism, and linkage? In particular,
analyze critically the definitions given by authorities, such as those found
in the most respected dictionaries, encyclopedias, and archival documents of
learned societies, e.g., the complete issue of Vol. 38, Nos. 7&ndash;10 (2003) of
Mechanism and Machine Theory on Standardization of Terminology.
</p>
<p>1.4 What is artificial intelligence? What is fuzzy logic? Can the techniques of
these fields be applied to robotics?
</p>
<p>6Microelectromechanical systems.</p>
<p/>
</div>
<div class="page"><p/>
<p>1.8 Exercises 25
</p>
<p>1.5 What is mechatronics? What is the difference between mechatronics and
robotics? Comerford (1994) and Soureshi et al. (1994) give an account on
this technology.
</p>
<p>1.6 What do you understand as dexterity? The concept of dexterity is normally
applied to persons. Can it be applied to animals as well? What about
machines?
</p>
<p>1.7 Define the term algorithm. In this context, make a clear distinction between
recursion and iteration. Note that, in the robotics literature, there is often
confusion between these two terms in particular. Make sure that you do not
make the same mistake! Again, Penrose (1994) has provided an extensive
discussion on the nature of algorithms.
</p>
<p>1.8 What is the difference among terms like real-time, on-line, and run-time?
1.9 How fast can two floating-point numbers be multiplied using a personal
</p>
<p>computer? What about using a UNIX workstation? a supercomputer? Write
a piece of code to estimate this time on your computer facility.
</p>
<p>1.10 Answer the foregoing question as pertaining to floating-point addition.
1.11 What is the smallest floating-point number on your computer? Rather than
</p>
<p>looking for the answer in manuals, write a procedure to estimate it.
1.12 What is the difference between procedural programming and object-oriented
</p>
<p>programming? In terms of programming languages, what is the difference
between C and CCC? Rumbaugh et al. (1991) provide an introduction to
object-oriented programming, while Stroustrup (1991) gives an introduction
to CCC.</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 2
</p>
<p>Mathematical Background
</p>
<p>2.1 Preamble
</p>
<p>First and foremost, the study of motions undergone by robotic mechanical systems
or, for that matter, by mechanical systems at large, requires a suitable motion
representation. Now, the motion of mechanical systems involves the motion of
the particular links comprising those systems, which in this book are supposed
to be rigid. The assumption of rigidity, although limited in scope, still covers a
wide spectrum of applications, while providing insight into the motion of more
complicated systems, such as those involving deformable bodies.
</p>
<p>The most general kind of rigid-body motion consists of both translation and
rotation. While the study of the former is covered in elementary mechanics courses
and is reduced to the mechanics of particles, the latter is more challenging. Indeed,
point translation can be studied simply with the aid of three-dimensional vector
calculus, while rigid-body rotations require the introduction of tensors, i.e., entities
mapping vector spaces into vector spaces.
</p>
<p>Emphasis is placed on invariant concepts, i.e., items that do not change upon a
change of coordinate frame. Examples of invariant concepts are geometric quantities
such as distances and angles between lines. Although we may resort to a coordinate
frame and vector algebra to compute distances and angles, and will represent vectors
in that frame, the final result will be independent of how we choose that frame. The
same applies to quantities whose evaluation calls for the introduction of tensors.
Here, we must distinguish between the physical quantity represented by a vector or
a tensor and the representation of that quantity in a coordinate frame using a one-
dimensional array of components in the case of vectors, or a two-dimensional array
in the case of tensors. It is unfortunate that the same word is used in English to
denote a vector and its array representation in a given coordinate frame. Regarding
tensors, the associated arrays are called matrices. By abuse of terminology, we will
refer to both tensors and their arrays as matrices, although keeping in mind the
essential conceptual differences involved.
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__2,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>27</p>
<p/>
</div>
<div class="page"><p/>
<p>28 2 Mathematical Background
</p>
<p>2.2 Linear Transformations
</p>
<p>The physical three-dimensional space is a particular case of a vector space.
A vector space is a set of objects, called vectors, that follow certain algebraic rules.
Throughout the book, vectors will be denoted by boldface lowercase characters,
whereas tensors and their matrix representations will be denoted by boldface
uppercase characters. Let v, v1, v2, v3, and w be elements of a given vector space V ,
which is defined over the real field, and let ˛ and ˇ be two elements of this field, i.e.,
˛ and ˇ are two real numbers. Below we summarize the rules mentioned above:
</p>
<p>(i) The sum of v1 and v2, denoted by v1 C v2, is itself an element of V and is
commutative, i.e., v1 C v2 D v2 C v1;
</p>
<p>(ii) V contains an element 0, called the zero vector of V , which, when added to
any other element v of V , leaves it unchanged, i.e., vC 0 D v;
</p>
<p>(iii) The sum defined in (i) is associative, i.e., v1 C .v2 C v3/ D .v1 C v2/C v3;
(iv) For every element v of V , there exists a corresponding element, w, also of V ,
</p>
<p>which, when added to v, produces the zero vector, i.e., vC w D 0. Moreover,
w is represented as �v;
</p>
<p>(v) The product ˛v, or v˛, is also an element of V , for every v of V and every real
˛. This product is associative, i.e., ˛.ˇv/ D .˛ˇ/v;
</p>
<p>(vi) If ˛ is the real unity, then ˛v is identically v;
(vii) The product defined in (v) is distributive in the sense that (a) .˛ C ˇ/v D
</p>
<p>˛vC ˇv and (b) ˛.v1 C v2/ D ˛v1 C ˛v2.
Although vector spaces can be defined over other fields, we will deal with
</p>
<p>vector spaces over the real field, unless explicit reference to another field is made.
Moreover, vector spaces can be either finite- or infinite-dimensional, but we will not
need the latter. In geometry and elementary mechanics, the dimension of the vector
spaces needed is usually three, but when studying multibody systems, an arbitrary
finite dimension will be required. The concept of dimension of a vector space is
discussed in more detail later.
</p>
<p>A linear transformation, represented as an operator L, of a vector space U into
a vector space V , is a rule that assigns to every vector u of U at least one vector v of
V , represented as v D Lu, with L endowed with two properties:
(i) homogeneity: L.˛u/ D ˛v; and
</p>
<p>(ii) additivity: L.u1 C u2/ D v1 C v2.
Note that, in the foregoing definitions, no mention has been made of components,
</p>
<p>and hence, vectors and their transformations should not be confused with their array
representations.
</p>
<p>Particular types of linear transformations of the three-dimensional Euclidean
space that will be encountered frequently in this context are projections, reflections,
and rotations. One further type of transformation, which is not linear, but neverthe-
less appears frequently in kinematics, is the one known as affine transformation. The
foregoing transformations are defined below. It is necessary, however, to introduce
additional concepts pertaining to general linear transformations before expanding
into these definitions.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.2 Linear Transformations 29
</p>
<p>Fig. 2.1 A projection onto a
plane ˘ of unit normal n
</p>
<p>The range of a linear transformation L of U into V is the set of vectors v of V
into which some vector u of U is mapped, i.e., the range of L is defined as the set
of v D Lu, for every vector u of U . The kernel of L is the set of vectors uN of
U that are mapped by L into the zero vector 0 2 V . It can be readily proven (see
Exercises 2.1&ndash;2.3) that the kernel and the range of a linear transformation are both
vector subspaces of U and V , respectively, i.e., they are themselves vector spaces,
but of a dimension smaller than or equal to that of their associated vector spaces.
Moreover, the kernel of a linear transformation is often called the null space of the
said transformation.
</p>
<p>Henceforth, the three-dimensional Euclidean space is denoted by E3. Having
chosen an origin O for this space, its geometry can be studied in the context
of general vector spaces. Hence, points of E3 will be identified with vectors of
the associated three-dimensional vector space. Moreover, lines and planes passing
through the origin are subspaces of dimensions 1 and 2, respectively, of E3. Clearly,
lines and planes not passing through the origin of E3 are not subspaces but can be
handled with the algebra of vector spaces, as will be shown here.
</p>
<p>An orthogonal projection P of E3 onto itself is a linear transformation of the said
space onto a plane ˘ passing through the origin and having a unit normal n, with
the properties:
</p>
<p>P2 D P; Pn D 0 (2.1a)
</p>
<p>Any matrix with the first property above is termed idempotent. For n � n matrices,
it is sometimes necessary to indicate the lowest integer l for which an analogous
relation follows, i.e., for which Pl D P. In this case, the matrix is said to be
idempotent of degree l .
</p>
<p>Clearly, the projection of a position vector p, denoted by p0, onto a plane ˘ of
unit normal n, is p itself minus the component of p along n as shown in Fig. 2.1, i.e.,
</p>
<p>p0 D p � n.nT p/ (2.1b)
</p>
<p>where the superscript T denotes either vector or matrix transposition and nT p is
equivalent to the usual dot product n � p.</p>
<p/>
</div>
<div class="page"><p/>
<p>30 2 Mathematical Background
</p>
<p>Fig. 2.2 A reflection onto a
plane ˘ of unit normal n
</p>
<p>Now, the identity matrix 1 is defined as the mapping of a vector space V into
itself leaving every vector v of V unchanged, i.e.,
</p>
<p>1v D v (2.2)
</p>
<p>Thus, p0, as given by Eq. (2.1b), can be rewritten as
</p>
<p>p0 D 1p � nnT p � .1 � nnT /p (2.3)
</p>
<p>and hence, the orthogonal projection P onto ˘ can be represented as
</p>
<p>P D 1 � nnT (2.4)
</p>
<p>where the product nnT amounts to a 3 � 3 matrix.
Now we turn to reflections. Here we have to take into account that reflections
</p>
<p>occur frequently accompanied by rotations, as yet to be studied. Since reflections
are simpler to represent, we first discuss these, rotations being discussed in full
detail in Sect. 2.3. What we shall discuss in this section is pure reflections, i.e.,
those occurring without any concomitant rotation. Thus, all reflections studied in
this section are pure reflections, but for the sake of brevity, they will be referred to
simply as reflections.
</p>
<p>A reflection R of E3 onto a plane ˘ passing through the origin and having a
unit normal n is a linear transformation of the said space into itself, as depicted in
Fig. 2.2, such that a vector p is mapped by R into a vector p0 given by
</p>
<p>p0 D p � 2nnT p � .1 � 2nnT /p
</p>
<p>Thus, the reflection R can be expressed as
</p>
<p>R D 1 � 2nnT (2.5)</p>
<p/>
</div>
<div class="page"><p/>
<p>2.2 Linear Transformations 31
</p>
<p>From Eq. (2.5) it is then apparent that a pure reflection is represented by a linear
transformation that is symmetric and whose square equals the identity matrix, i.e.,
R2 D 1. Indeed, symmetry is apparent from the equation above; the second property
is readily proven below:
</p>
<p>R2 D .1 � 2nnT /.1 � 2nnT /
D 1 � 2nnT � 2nnT C 4.nnT /.nnT / D 1 � 4nnT C 4n.nT n/nT
</p>
<p>which apparently reduces to 1 because n is a unit vector. Note that from the second
property above, we find that pure reflections observe a further interesting property,
namely,
</p>
<p>R�1 D R
</p>
<p>i.e., every pure reflection equals its inverse. This result can be understood intuitively
by noticing that, upon doubly reflecting an image using two mirrors, the original
image is recovered. Any square matrix which equals its inverse will be termed self-
inverse henceforth.
</p>
<p>Further, we take to deriving the orthogonal decomposition of a given vector v
into two components, one along and one normal to a unit vector e. The component
of v along e, termed here the axial component, vk&mdash;read v-par&mdash;is simply given as
</p>
<p>vk � eeT v (2.6a)
</p>
<p>while the corresponding normal component, v?&mdash;read v-perp&mdash;is simply the
difference v � vk, i.e.,
</p>
<p>v? � v � vk � .1 � eeT /v (2.6b)
</p>
<p>the matrix in parentheses in the foregoing equation being rather frequent in
kinematics. This matrix will appear when studying rotations.
</p>
<p>Further concepts are now recalled: The basis of a vector space V is a set of
linearly independent vectors of V , fvi gn1 , in terms of which any vector v of V can be
expressed as
</p>
<p>v D ˛1v1 C ˛2v2 C � � � C ˛nvn (2.7)
</p>
<p>where the elements of the set f˛ign1 are all elements of the field over which V is
defined, i.e., they are real numbers in the case at hand. The number n of elements
in the set B D fvign1 is called the dimension of V . Note that any set of n linearly
independent vectors of V can play the role of a basis of this space, but once this
basis is defined, the set of real coefficients f˛ign1 representing a given vector v is
unique.
</p>
<p>Let U and V be two vector spaces of dimensions m and n, respectively, and L a
linear transformation of U into V , and define bases BU and BV for U and V as
</p>
<p>BU D fuj gm1 ; BV D fvign1 (2.8)</p>
<p/>
</div>
<div class="page"><p/>
<p>32 2 Mathematical Background
</p>
<p>Since each Luj is an element of V , it can be represented uniquely in terms of the
vectors of BV , namely, as
</p>
<p>Luj D l1j v1 C l2j v2 C � � � C lnj vn; j D 1; : : : ; m (2.9)
</p>
<p>Consequently, in order to represent the images of the m vectors of BU , namely,
the set fLuj gm1 , n � m real numbers lij , for i D 1; : : : ; n and j D 1; : : : ; m, are
necessary. These real numbers are now arranged in the n �m array ŒL &#141;BVBU defined
below:
</p>
<p>ŒL &#141;
BV
BU
�
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>l11 l12 � � � l1m
l21 l22 � � � l2m
:::
:::
: : :
</p>
<p>:::
</p>
<p>ln1 ln2 � � � lnm
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(2.10)
</p>
<p>The foregoing array is thus called the matrix representation of L with respect to
BU and BV . We thus have an important definition:
</p>
<p>Definition 2.2.1. The j th column of the matrix representation of L with respect to
the bases BU and BV is composed of the n real coefficients lij of the representation
of the image of the j th vector of BU in terms of BV .
</p>
<p>The notation introduced in Eq. (2.10) is rather cumbersome, for it involves one
subscript and one superscript. Moreover, each of these is subscripted. In practice,
the bases involved are self-evident, which makes an explicit mention of these
unnecessary. In particular, when L is a mapping of U onto itself, a single basis
suffices to represent L in matrix form. In this case, its bracket will bear only a
subscript, and no superscript, namely, ŒL &#141;B. Moreover, we will use, henceforth, the
concept of basis and coordinate frame interchangeably, since one implies the other.
</p>
<p>Two different bases are unavoidable when the two spaces under study are
physically distinct, which is the case in velocity analysis of manipulators. As we
will see in Chap. 5, in these analyses we distinguish between the velocity of
the manipulator in Cartesian space and that in the joint-rate space. While the
Cartesian-space velocity&mdash;or Cartesian velocity, for brevity&mdash;consists, in general,
of a six-dimensional vector containing the three-dimensional angular velocity of
the end-effector and the translational velocity of one of its points, the latter is an
n-dimensional vector. Moreover, if the manipulator is coupled by revolute joints
only, the units of the joint-rate vector are all s�1, whereas the Cartesian velocity
contains some components with units of s�1 and others with units of ms�1.
</p>
<p>Further definitions are now recalled. Given a mapping L of an n-dimensional
vector space U into the n-dimensional vector space V , a nonzero vector e that is
mapped by L into a multiple of itself, �e, is called an eigenvector of L, the scalar
� being called an eigenvalue of L. The eigenvalues of L are determined by the
equation
</p>
<p>det.�1 � L/ D 0 (2.11)</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 33
</p>
<p>Note that the matrix �1�L is linear in �, and since the determinant of a n�nmatrix
is a homogeneous nth-order function of its entries, the left-hand side of Eq. (2.11) is
a nth-degree polynomial in �. The foregoing polynomial is termed the characteristic
polynomial of L. Hence, every n�nmatrix L has n complex eigenvalues, even if L is
defined over the real field. If it is, then its complex eigenvalues appear in conjugate
pairs. Clearly, the eigenvalues of L are the roots of its characteristic polynomial,
while Eq. (2.11) is called the characteristic equation of L.
</p>
<p>Example 2.2.1. What is the representation of the reflection R of E3 into itself, with
respect to the x&ndash;y plane, in terms of unit vectors parallel to the X, Y, Z axes that
form a coordinate frame F?
</p>
<p>Solution: Note that in this case, U D V D E3 and, hence, it is not necessary to use
two different bases for U and V . Now, let i, j, k, be unit vectors parallel to the X, Y,
and Z axes. Clearly,
</p>
<p>Ri D i
Rj D j
Rk D �k
</p>
<p>Thus, the representations of the images of i, j and k under R, in F , are
</p>
<p>ŒRi &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>0
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; ŒRj &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>1
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; ŒRk &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>�1
</p>
<p>3
</p>
<p>5
</p>
<p>where subscripted brackets are used to indicate the representation frame. Hence, the
matrix representation of R in F , denoted by ŒR &#141;F , is
</p>
<p>ŒR &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 1 0
</p>
<p>0 0 �1
</p>
<p>3
</p>
<p>5
</p>
<p>2.3 Rigid-Body Rotations
</p>
<p>A linear isomorphism, i.e., a one-to-one linear transformation mapping a space V
onto itself, is called an isometry if it preserves distances between any two points
of V . If u and v are regarded as the position vectors of two such points, then the
distance d between these two points is defined as
</p>
<p>d �
p
</p>
<p>.u � v/T .u � v/ (2.12)</p>
<p/>
</div>
<div class="page"><p/>
<p>34 2 Mathematical Background
</p>
<p>The volume V of the tetrahedron defined by the origin and three points of the
three-dimensional Euclidean space of position vectors u, v, and w is obtained as
one-sixth of the absolute value of the double mixed product of these three vectors,
</p>
<p>V � 1
6
ju � v � wj D 1
</p>
<p>6
</p>
<p>ˇ
ˇdet
</p>
<p>�
</p>
<p>u v w
�ˇ
ˇ (2.13)
</p>
<p>i.e., if a 3�3 array ŒA&#141; is defined in terms of the components of u, v, and w, in a
given basis, then the first column of ŒA&#141; is given by the three components of u, the
second and third columns being defined likewise.
</p>
<p>Now, let Q be an isometry mapping the triad fu; v; wg into fu0; v0; w0g.
Moreover, the distance from the origin to the points of position vectors u, v, and
w is given simply as kuk, kvk, and kwk, which are defined as
</p>
<p>kuk �
p
</p>
<p>uT u; kvk �
p
</p>
<p>vT v; kwk �
p
</p>
<p>wTw (2.14)
</p>
<p>Clearly,
</p>
<p>ku0k D kuk; kv0k D kvk; kw0k D kwk (2.15a)
</p>
<p>and
</p>
<p>det
�
</p>
<p>u0 v0 w0
�
</p>
<p>D ˙det
�
</p>
<p>u v w
�
</p>
<p>(2.15b)
</p>
<p>If, in the foregoing relations, the sign of the determinant is preserved, the
isometry represents a rotation; otherwise, it represents a reflection. Now, let p be
the position vector of any point of E3, its image under a rotation Q being p0. Hence,
distance preservation requires that
</p>
<p>pT p D p0T p0 (2.16)
</p>
<p>where
</p>
<p>p0 D Qp (2.17)
</p>
<p>condition (2.16) thus leading to
</p>
<p>QTQ D 1 (2.18)
</p>
<p>where 1 was defined in Sect. 2.2 as the 3 � 3 identity matrix, and hence, Eq. (2.18)
states that Q is an orthogonal matrix. Moreover, let T and T0 denote the two matrices
defined below:
</p>
<p>T D
�
</p>
<p>u v w
�
</p>
<p>; T0 D
�
</p>
<p>u0 v0 w0
�
</p>
<p>(2.19)</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 35
</p>
<p>from which it is clear that
</p>
<p>T0 D QT (2.20)
</p>
<p>Now, for a rigid-body rotation, Eq. (2.15b) should hold with the positive sign,
and hence,
</p>
<p>det.T/ D det.T0/ (2.21a)
</p>
<p>and, by virtue of Eq. (2.20), we conclude that
</p>
<p>det.Q/ D C1 (2.21b)
</p>
<p>Therefore, Q is a proper orthogonal matrix, i.e., it is a proper isometry. Now we
have
</p>
<p>Theorem 2.3.1. The eigenvalues of a proper orthogonal matrix Q lie on the unit
</p>
<p>circle centered at the origin of the complex plane.
</p>
<p>Proof. Let � be one of the eigenvalues of Q and e the corresponding eigenvector,
so that
</p>
<p>Qe D �e (2.22)
</p>
<p>In general, Q is not expected to be symmetric, and hence, � is not necessarily real.
Thus, � is considered complex, in general. In this light, when transposing both sides
of the foregoing equation, we will need to take the complex conjugates as well.
Henceforth, the complex conjugate of a vector or a matrix will be indicated with
an asterisk as a superscript. As well, the conjugate of a complex variable will be
indicated with a bar over the said variable. Thus, the transpose conjugate of the
above equation takes on the form
</p>
<p>e�Q� D �e� (2.23)
</p>
<p>Multiplying the corresponding sides of the two previous equations yields
</p>
<p>e�Q�Qe D ��e�e (2.24)
</p>
<p>However, Q has been assumed real, and hence, Q� reduces to QT , the foregoing
equation thus reducing to
</p>
<p>e�QTQe D ��e�e (2.25)
</p>
<p>But Q is orthogonal by assumption, and hence, it obeys Eq. (2.18), which means
that Eq. (2.25) reduces to
</p>
<p>e�e D j�j2e�e (2.26)</p>
<p/>
</div>
<div class="page"><p/>
<p>36 2 Mathematical Background
</p>
<p>where j � j denotes the module of the complex variable within it. Thus, the foregoing
equation leads to
</p>
<p>j�j2 D 1 (2.27)
</p>
<p>thereby completing the intended proof. As a direct consequence of Theorem 2.3.1,
we have
</p>
<p>Corollary 2.3.1. A proper orthogonal 3� 3 matrix has at least one eigenvalue that
isC1.
</p>
<p>Now, let e be the eigenvector of Q associated with the eigenvalue C1. Thus,
</p>
<p>Qe D e (2.28)
</p>
<p>What Eq. (2.28) states is summarized as a theorem below:
</p>
<p>Theorem 2.3.2 (Euler 1776). A rigid-body motion about a point O leaves fixed
</p>
<p>a set of points lying on a line L that passes through O and is parallel to the
</p>
<p>eigenvector e of Q associated with the eigenvalue C1.
A further result, that finds many applications in robotics and, in general, in
</p>
<p>system theory, is given below:
</p>
<p>Theorem 2.3.3 (Cayley&ndash;Hamilton). Let P.�/ be the characteristic polynomial of
</p>
<p>a n � n matrix A, i.e.,
</p>
<p>P.�/ D det.�1 � A/ D �n C an�1�n�1 C � � � C a1�C a0 (2.29)
</p>
<p>Then A satisfies its characteristic equation, i.e.,
</p>
<p>An C an�1An�1 C � � � C a1AC a01 D O (2.30)
</p>
<p>where O is the n � n zero matrix.
Proof. See Kaye and Wilson (1998).
</p>
<p>What the Cayley&ndash;Hamilton Theorem states is that any power p � n of the
n � n matrix A can be expressed as a linear combination of the first n powers of
A&mdash;the 0th power of A is, of course, the n � n identity matrix 1. An important
consequence of this result is that any analytic matrix function of A can be expressed
not as an infinite series, but as a sum, namely, a linear combination of the first n
powers of A: 1; A; : : : ; An�1. An analytic function f .x/ of a real variable x is, in
turn, a function with a series expansion. Moreover, an analytic matrix function of
a matrix argument A is defined likewise, an example of which is the exponential
function. From the previous discussion, then, the exponential of A can be written as
a linear combination of the first n powers of A. It will be shown later that any proper
orthogonal matrix Q can be represented as the exponential of a skew-symmetric
matrix derived from the unit vector e of Q, of eigenvalue C1, and the associated
angle of rotation, as yet to be defined.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 37
</p>
<p>2.3.1 The Cross-Product Matrix
</p>
<p>Prior to introducing the matrix representation of a rotation, we will need a few
definitions. We will start by defining the partial derivative of a vector with respect
to another vector. This is a matrix, as described below: In general, let u and v be
vectors of spaces U and V , of dimensions m and n, respectively. Furthermore, let
t be a real variable and f be real-valued function of t , u D u.t/ and v D v.u.t//
being m- and n-dimensional vector functions of t as well, with f D f .u; v/. The
derivative of u with respect to t , denoted by Pu.t/, is a m-dimensional vector whose
i th component is the derivative of the i th component ui of u, in a given basis, with
respect to t . A similar definition follows for Pv.t/. The partial derivative of f with
respect to u is am-dimensional vector whose i th component is the partial derivative
of f with respect to ui , with a corresponding definition for the partial derivative of
f with respect to v. The foregoing derivatives, as all other vectors, will be assumed,
henceforth, to be column arrays. Thus,
</p>
<p>@f
</p>
<p>@u
�
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>@f=@u1
@f=@u2
:::
</p>
<p>@f=@um
</p>
<p>3
</p>
<p>7
7
7
5
;
</p>
<p>@f
</p>
<p>@v
�
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>@f=@v1
@f=@v2
:::
</p>
<p>@f=@vn
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(2.31)
</p>
<p>Furthermore, let v D v.u/. In order to derive @u=@v, first the differential dv upon
a differential du is computed:
</p>
<p>dv D @v
@u1
</p>
<p>du1 C
@v
</p>
<p>@u2
du2 C : : :C
</p>
<p>@v
</p>
<p>@um
dum (2.32a)
</p>
<p>or, in array form,
</p>
<p>dv D
�
@v
</p>
<p>@u1
</p>
<p>@v
</p>
<p>@u2
� � � @v
</p>
<p>@um
</p>
<p>�
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>@v
</p>
<p>@u
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>du1
du2
:::
</p>
<p>dum
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>du
</p>
<p>(2.32b)
</p>
<p>That is, the partial derivative of v with respect to u is a n � m array whose .i; j /
entry is defined as @vi=@uj , i.e.,
</p>
<p>@v
</p>
<p>@u
�
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>@v1=@u1 @v1=@u2 � � � @v1=@um
@v2=@u1 @v2=@u2 � � � @v2=@um
</p>
<p>:::
:::
</p>
<p>: : :
:::
</p>
<p>@vn=@u1 @vn=@u2 � � � @vn=@um
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(2.33)</p>
<p/>
</div>
<div class="page"><p/>
<p>38 2 Mathematical Background
</p>
<p>Hence, the total derivative of f with respect to u can be written as
</p>
<p>df
</p>
<p>du
D @f
@u
C
�
@v
</p>
<p>@u
</p>
<p>�T
@f
</p>
<p>@v
(2.34)
</p>
<p>If, moreover, f is an explicit function of t , i.e., if f D f .u; v; t / and v D
v.u; t /, then, one can write the total derivative of f with respect to t as
</p>
<p>df
</p>
<p>dt
D @f
@t
C
�
@f
</p>
<p>@u
</p>
<p>�T
du
</p>
<p>dt
C
�
@f
</p>
<p>@v
</p>
<p>�T
@v
</p>
<p>@t
C
�
@f
</p>
<p>@v
</p>
<p>�T
@v
</p>
<p>@u
</p>
<p>du
</p>
<p>dt
(2.35)
</p>
<p>The total derivative of v with respect to t can be written, likewise, as
</p>
<p>dv
</p>
<p>dt
D @v
@t
C @v
@u
</p>
<p>du
</p>
<p>dt
(2.36)
</p>
<p>Example 2.3.1. Let the components of v and x in a certain reference frame F be
given as
</p>
<p>Œ v &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>v1
v2
v3
</p>
<p>3
</p>
<p>5 ; Œ x &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>x1
x2
x3
</p>
<p>3
</p>
<p>5 (2.37a)
</p>
<p>Then
</p>
<p>Œ v � x &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>v2x3 � v3x2
v3x1 � v1x3
v1x2 � v2x1
</p>
<p>3
</p>
<p>5 (2.37b)
</p>
<p>Hence,
</p>
<p>�
@.v � x/
@x
</p>
<p>�
</p>
<p>F
</p>
<p>D
</p>
<p>2
</p>
<p>4
</p>
<p>0 �v3 v2
v3 0 �v1
�v2 v1 0
</p>
<p>3
</p>
<p>5 (2.37c)
</p>
<p>Henceforth, the partial derivative of v�x with respect to x will be denoted by the
3� 3 matrix V. For obvious reasons, V is termed the cross-product matrix of vector
v. Sometimes the cross-product matrix of a vector v is represented as Qv, but we do
not follow this notation for the sake of consistency, since we decided at the outset
to represent matrices with boldface uppercases. Thus, the foregoing cross product
admits the alternative representations
</p>
<p>v � x D Vx (2.38)
</p>
<p>Now, it should be apparent that:</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 39
</p>
<p>Theorem 2.3.4. The cross-product matrix A of any three-dimensional vector a is
</p>
<p>skew-symmetric, i.e.,
</p>
<p>AT D �A
</p>
<p>and, as a consequence,
</p>
<p>a � .a � b/ D A2b (2.39)
</p>
<p>where A2 can be readily proven to be
</p>
<p>A2 D �kak21C aaT (2.40)
</p>
<p>with k � k denoting the Euclidean norm of the vector inside it.
Note that given any three-dimensional vector a, its cross-product matrix A is
</p>
<p>uniquely defined. Moreover, this matrix is skew-symmetric. The converse also
holds, i.e., given any 3 � 3 skew-symmetric matrix A, its associated vector is
uniquely defined as well. This result is made apparent from Example 2.3.1 and will
be discussed further when we define the axial vector of an arbitrary 3 � 3 matrix
below.
</p>
<p>Example 2.3.2. Let a be an arbitrary three-dimensional vector and A its cross-
product matrix. Further, let B � 1C A, with 1 defined as the 3 � 3 identity matrix.
Without resorting to components,
</p>
<p>(a) prove that
</p>
<p>det.B/ D 1C kak2 &gt; 1
</p>
<p>and hence, B is nonsingular.
(b) Find B�1 in terms of A or, equivalently, of a.
</p>
<p>Solution:
</p>
<p>(a) Let f˛i g31 be the set of eigenvalues and f ai g31 the set of corresponding
eigenvectors of A. Likewise, let fˇi g31 be the set of eigenvalues and fbi g31 the
set of corresponding eigenvectors of B. That is,
</p>
<p>Aai D ˛iai ; Bbi D ˇibi ; i D 1; 2; 3
</p>
<p>Next, add ai to both sides of the first of the above equations:
</p>
<p>ai C Aai D ai C ˛iai ) .1C A/ai D .1C ˛i /ai ; i D 1; 2; 3
</p>
<p>But, in light of the definition of B, the second of the above equations leads to
</p>
<p>Bai D .1C ˛i /ai ; i D 1; 2; 3</p>
<p/>
</div>
<div class="page"><p/>
<p>40 2 Mathematical Background
</p>
<p>which means that bi D ai and ˇi D 1C˛i , i D 1; 2; 3. Now, det.B/ D ˇ1ˇ2ˇ3,
and hence,
</p>
<p>det.B/ D .1C ˛1/.1C ˛2/.1C ˛3/
</p>
<p>Therefore, to find the eigenvalues of A � CPM.a/, notice that A can be
written as
</p>
<p>A D CPM.a/ � CPM.kake/; e � akak
</p>
<p>i.e., e is a unit vector obtained upon dividing a by its norm. By virtue of the
definition of the cross-product matrix, moreover, the factor kak can be taken
outside of the CPM. � / operator, and hence,
</p>
<p>A D kakCPM.e/ � kakE; E � CPM.e/
</p>
<p>But the eigenvalues of the CPM of a unit vector are proven in Exercise 2.11 to
be 0, j and �j , with j �
</p>
<p>p
�1. Therefore, ˛1 D 0, ˛2 D j kak, ˛3 D �j kak,
</p>
<p>and hence, ˇ1 D 1, ˇ2 D 1C j kak, ˇ3 D 1 � j kak. Thus,
</p>
<p>det.B/ D 1.1C j kak/.1 � j kak/ D 1C kak2
</p>
<p>thereby completing the intended proof.
(b) Now, to find B�1, the characteristic equations of A and B will be needed. These
</p>
<p>are readily derived below:
</p>
<p>AW .� � ˛1/.� � ˛2/.� � ˛3/ D 0 ) �3 C kak2� D 0
</p>
<p>and
</p>
<p>BW .��ˇ1/.��ˇ2/.��ˇ3/ D 0 ) �3�3�2C.3Ckak2/��.1Ckak2/ D 0
</p>
<p>If now the Cayley&ndash;Hamilton Theorem is invoked, the foregoing scalar
characteristic equations lead to matrix polynomials in A and B, namely,
</p>
<p>A3 C kak2A D O; B3 � 3B2 C .3C kak2/B � .1C kak2/1 D O
</p>
<p>with O denoting the 3 � 3 zero matrix. Since B is known to be non-singular
from (a), the two sides of the polynomial in B can be multiplied by B�1; the
last term of the right-hand side of the matrix polynomial thus resulting involves
B�1. Upon solving for this term,
</p>
<p>B�1 D 1
1C kak2 ŒB
</p>
<p>2 � 3BC .3C kak2/1&#141;</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 41
</p>
<p>a b
</p>
<p>Fig. 2.3 Rotation of a rigid body about a line
</p>
<p>which, upon expansion, yields
</p>
<p>B�1 D 1
1C kak2 Œ.1C kak
</p>
<p>2/1 � AC A2&#141;
</p>
<p>The reader should be able to verify that the foregoing expression is indeed the
inverse of 1C A.
</p>
<p>2.3.2 The Rotation Matrix
</p>
<p>In deriving the matrix representation of a rotation, we should recall Theorem 2.3.2,
which suggests that an explicit representation of Q in terms of its eigenvector e
is possible. Moreover, this representation must contain information on the amount
of the rotation under study, which is nothing but the angle of rotation. Furthermore,
line L, mentioned in Euler&rsquo;s Theorem, is termed the axis of rotation of the motion of
interest. In order to derive the representation mentioned above, consider the rotation
depicted in Fig. 2.3 of angle � about line L.
</p>
<p>From Fig. 2.3a, one can apparently write
</p>
<p>p0 D
���!
OQ C
</p>
<p>���!
QP 0 (2.41)
</p>
<p>where
���!
OQ is the axial component of p along vector e, which is derived as in
</p>
<p>Eq. (2.6a), namely,
</p>
<p>���!
OQD eeT p (2.42)
</p>
<p>Furthermore, from Fig. 2.3b,
</p>
<p>���!
QP 0D .cos�/
</p>
<p>���!
QP C.sin�/
</p>
<p>����!
QP 00 (2.43)</p>
<p/>
</div>
<div class="page"><p/>
<p>42 2 Mathematical Background
</p>
<p>with
���!
QP being nothing but the normal component of p with respect to e, as
</p>
<p>introduced in Eq. (2.6b), i.e.,
</p>
<p>���!
QPD .1 � eeT /p (2.44)
</p>
<p>and
���!
QP 00 given as
</p>
<p>����!
QP 00D e � p � Ep (2.45)
</p>
<p>Substitution of Eqs. (2.44) and (2.45) into Eq. (2.43) leads to
</p>
<p>���!
QP 0D cos�.1 � eeT /pC sin�Ep (2.46)
</p>
<p>If now Eqs. (2.42) and (2.46) are substituted into Eq. (2.41), one obtains
</p>
<p>p0 D eeT pC cos�.1 � eeT /pC sin�Ep (2.47)
</p>
<p>Thus, Eq. (2.41) reduces to
</p>
<p>p0 D ŒeeT C cos�.1 � eeT /C sin�E&#141;p (2.48)
</p>
<p>From Eq. (2.48) it is apparent that p0 is a linear transformation of p, the
transformation being given by the expression inside the brackets, which is the
rotation matrix Q sought, i.e.,
</p>
<p>Q D eeT C cos�.1 � eeT /C sin�E (2.49)
</p>
<p>A special case arises when � D � ,
</p>
<p>Q D �1C 2eeT ; for � D � (2.50)
</p>
<p>whence it is apparent that Q is symmetric if � D � . Of course, Q becomes
symmetric also when � D 0, but this is a rather obvious case, leading to Q D 1.
Except for these two cases, the rotation matrix is not symmetric. However, under no
circumstance does the rotation matrix become skew-symmetric, for a 3 � 3 skew-
symmetric matrix is by necessity singular, which contradicts the property of proper
orthogonal matrices of Eq. (2.21b).
</p>
<p>Now one more representation of Q in terms of e and � is given. For a fixed axis
of rotation, i.e., for a fixed value of e, the rotation matrix Q is a function of the angle
of rotation �, only. Thus, the series expansion of Q in terms of � is
</p>
<p>Q.�/ D Q.0/CQ0.0/� C 1
2Š
</p>
<p>Q00.0/�2 C � � � C 1
kŠ
</p>
<p>Q.k/.0/�k C � � � (2.51)</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 43
</p>
<p>where the superscript .k/ stands for the kth derivative of Q with respect to �. Now,
from the definition of E, one can readily prove the relations below:
</p>
<p>E.2kC1/ D .�1/kE; E2k D .�1/k.1 � eeT / (2.52)
</p>
<p>Furthermore, using Eqs. (2.49) and (2.52), one can readily show that
</p>
<p>Q.k/.0/ D Ek (2.53)
</p>
<p>with E defined already as the cross-product matrix of e. Moreover, from Eqs. (2.51)
and (2.53), Q.�/ can be expressed as
</p>
<p>Q.�/ D 1C E� C 1
2Š
</p>
<p>E2�2 C � � � C 1
kŠ
</p>
<p>Ek�k C � � �
</p>
<p>whose right-hand side is nothing but the exponential of E�, i.e.,
</p>
<p>Q.�/ D eE� (2.54)
</p>
<p>Equation (2.54) is the exponential representation of the rotation matrix in terms of its
natural invariants, e and �. The foregoing parameters are termed invariants because
they are independent of the coordinate axes chosen to represent the rotation under
study. The adjective natural is necessary to distinguish them from other invariants
that will be introduced presently. This adjective seems suitable because the said
invariants stem naturally from Euler&rsquo;s Theorem.
</p>
<p>Now, in view of Eqs. (2.52), the above series can be written as
</p>
<p>Q.�/ D 1C
�
</p>
<p>� 1
2Š
�2 C 1
</p>
<p>4Š
�4 � � � � C 1
</p>
<p>.2k/Š
.�1/k�2k C � � �
</p>
<p>�
</p>
<p>.1 � eeT /
</p>
<p>C
�
</p>
<p>� � 1
3Š
�3 C � � � C 1
</p>
<p>.2k C 1/Š .�1/
k�2kC1 C � � �
</p>
<p>�
</p>
<p>E
</p>
<p>The series inside the first pair of brackets is apparently cos� � 1, while that in the
second pair is sin�. We have, therefore, an alternative representation of Q:
</p>
<p>Q D 1C sin�EC .1 � cos�/E2 (2.55)
</p>
<p>which is an expected result in view of the Cayley&ndash;Hamilton Theorem.
</p>
<p>The Canonical Forms of the Rotation Matrix
</p>
<p>The rotation matrix takes on an especially simple form if the axis of rotation
coincides with one of the coordinate axes. For example, if the X axis is parallel
to the axis of rotation, i.e., parallel to vector e, in a frame that we will label X , then,
we will have</p>
<p/>
</div>
<div class="page"><p/>
<p>44 2 Mathematical Background
</p>
<p>Œ e &#141;X D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>0
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; ŒE &#141;X D
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 0
</p>
<p>0 0 �1
0 1 0
</p>
<p>3
</p>
<p>5 ; ŒE2 &#141;X D
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 0
</p>
<p>0 �1 0
0 0 �1
</p>
<p>3
</p>
<p>5
</p>
<p>In the X -frame, then,
</p>
<p>ŒQ &#141;X D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 cos� � sin�
0 sin� cos�
</p>
<p>3
</p>
<p>5 (2.56a)
</p>
<p>Likewise, if we define the coordinate frames Y and Z so that their Y andZ axes,
respectively, coincide with the axis of rotation, then
</p>
<p>ŒQ &#141;Y D
</p>
<p>2
</p>
<p>4
</p>
<p>cos� 0 sin�
0 1 0
</p>
<p>� sin� 0 cos�
</p>
<p>3
</p>
<p>5 (2.56b)
</p>
<p>and
</p>
<p>ŒQ &#141;Z D
</p>
<p>2
</p>
<p>4
</p>
<p>cos� � sin� 0
sin� cos� 0
0 0 1
</p>
<p>3
</p>
<p>5 (2.56c)
</p>
<p>The representations of Eqs. (2.56a&ndash;c) can be called the X -, Y -, and Z-canonical
forms of the rotation matrix. In many instances, a rotation matrix cannot be derived
directly from information on the original and the final orientations of a rigid
body, but the overall motion can be readily decomposed into a sequence of simple
rotations taking the above canonical forms. An application of canonical forms lies
in the parameterization of rotations by means of Euler angles, consisting of three
successive rotations, �; � and  , about one axis of a coordinate frame. Euler angles
are introduced in Exercise 2.19, and applications thereof are given in Exercises 2.37,
2.38 and 3.10.
</p>
<p>2.3.3 The Linear Invariants of a 3 � 3Matrix
</p>
<p>Now we introduce two linear invariants of 3 � 3 matrices. Given any 3 � 3 matrix
A, its Cartesian decomposition, the counterpart of the Cartesian representation of
complex numbers, consists of the sum of its symmetric part, AS , and its skew-
symmetric part, ASS , defined as
</p>
<p>AS �
1
</p>
<p>2
.AC AT /; ASS �
</p>
<p>1
</p>
<p>2
.A � AT / (2.57)</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 45
</p>
<p>The axial vector or for brevity, the vector of A, is the vector a with the property
</p>
<p>a � v � ASSv (2.58)
</p>
<p>for any three-dimensional vector v. The trace of A is the sum of the eigenvalues of
AS , which are real. Since no coordinate frame is involved in the above definitions,
these are invariant. When calculating these invariants, of course, a particular
coordinate frame must be used. Let us assume that the entries of matrix A in a certain
coordinate frame are given by the array of real numbers aij , for i; j D 1; 2; 3.
Moreover, let a have components ai , for i D 1; 2; 3, in the same frame. The above-
defined invariants are thus calculated as
</p>
<p>vect.A/ � a � 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>a32 � a23
a13 � a31
a21 � a12
</p>
<p>3
</p>
<p>5 ; tr.A/ � a11 C a22 C a33 (2.59)
</p>
<p>From the foregoing definitions, we have now
</p>
<p>Theorem 2.3.5. The vector of a 3� 3 matrix vanishes if and only if it is symmetric,
whereas the trace of an n � n matrix vanishes if the matrix is skew symmetric.
</p>
<p>Other useful relations are given below. For any three-dimensional vectors a
and b,
</p>
<p>vect.abT / D �1
2
</p>
<p>a � b (2.60)
</p>
<p>and
</p>
<p>tr.abT / D aT b (2.61)
</p>
<p>The second relation is quite straightforward, but the first one is less so; a proof of
the first relation follows: Let w denote vect.abT /. From Definition (2.58), for any
three-dimensional vector v,
</p>
<p>w � v DWv (2.62)
</p>
<p>where W is the skew-symmetric component of abT , namely,
</p>
<p>W � 1
2
.abT � baT / (2.63)
</p>
<p>and hence,
</p>
<p>Wv D w � v D 1
2
Œ.bT v/a � .aT v/b&#141; (2.64)</p>
<p/>
</div>
<div class="page"><p/>
<p>46 2 Mathematical Background
</p>
<p>Now, let us compare the last expression with the double cross product1 .b � a/ � v,
namely,
</p>
<p>.b � a/ � v D .bT v/a � .aT v/b (2.65)
</p>
<p>from which it becomes apparent that
</p>
<p>w D 1
2
</p>
<p>b � a (2.66)
</p>
<p>thereby proving the aforementioned relation.
Note that Theorem 2.3.5 states a necessary and sufficient condition for the
</p>
<p>vanishing of the vector of a 3 � 3 matrix, but only a sufficient condition for the
vanishing of the trace of a n � n matrix. What this implies is that the trace of a
n � n matrix can vanish without the matrix being necessarily skew symmetric, but
the trace of a skew-symmetric matrix necessarily vanishes. Also note that whereas
the vector of a matrix is defined only for 3 � 3 matrices, the trace can be defined
more generally for n � n matrices.
</p>
<p>In some applications, the cross-product matrix of the product Ab of a 3�3matrix
A by a vector b is needed2:
</p>
<p>CPM.Ab/ D .BA/T � BAC tr.A/B D
�
</p>
<p>tr.A/1 � AT
�
</p>
<p>B � BA (2.67)
</p>
<p>where B D CPM.b/. The reader is encouraged to verify the correctness of the above
relation using components. Caveat: a component-free proof of the above relation is
particularly challenging.
</p>
<p>2.3.4 The Linear Invariants of a Rotation
</p>
<p>From the invariant representations of the rotation matrix, Eqs. (2.49) and (2.55), it is
clear that the first two terms of Q, eeT and cos�.1 � eeT /, are symmetric, whereas
the third one, sin�E, is skew-symmetric. Hence,
</p>
<p>vect.Q/ D vect.sin� E/ D sin� e (2.68)
</p>
<p>whereas
</p>
<p>tr.Q/ D trŒeeT C cos�.1 � eeT /&#141; � eT eC cos�.3 � eT e/ D 1C 2 cos� (2.69)
</p>
<p>1Popularly known as the triple cross product.
2This relation was derived by Ph.D. candidate Philippe Cardou.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 47
</p>
<p>from which one can readily solve for cos�, namely,
</p>
<p>cos� D tr.Q/ � 1
2
</p>
<p>(2.70)
</p>
<p>Henceforth, the vector of Q will be denoted by q and its components in a
given coordinate frame by q1, q2, and q3. Moreover, rather than using tr(Q) as
the other linear invariant, q0 � cos� will be introduced to refer to the linear
invariants of the rotation matrix. Hence, the rotation matrix is fully defined by four
scalar parameters, namely fqig30, which will be conveniently stored in the four-
dimensional array �, defined as
</p>
<p>� � Œq1; q2; q3; q0&#141;T (2.71)
</p>
<p>Note, however, that the four components of � are not independent, for they obey
the relation
</p>
<p>kqk2 C q20 � sin2 � C cos2 � D 1 (2.72)
</p>
<p>Thus, Eq. (2.72) can be written in a more compact form as
</p>
<p>k�k2 � q21 C q22 C q23 C q20 D 1 (2.73)
</p>
<p>What Eq. (2.72) states has a straightforward geometric interpretation: As a body
rotates about a fixed point, its motion can be described in a four-dimensional space
by the motion of a point of position vector � that moves on the surface of the unit
sphere centered at the origin of the said space. Alternatively, one can conclude
that, as a rigid body rotates about a fixed point, its motion can be described in a
three-dimensional space by the motion of position vector q, which moves within the
unit solid sphere centered at the origin of the said space. Given the dependence of
the four components of vector �, one might be tempted to solve for, say, q0 from
Eq. (2.72) in terms of the remaining components, namely, as
</p>
<p>q0 D ˙
q
</p>
<p>1 � .q21 C q22 C q23/ (2.74)
</p>
<p>This, however, is not a good idea because the sign ambiguity of Eq. (2.74) leaves
angle � undefined, for q0 is nothing but cos�. Moreover, the three components of
vector q alone, i.e., sin� e, do not suffice to define the rotation represented by Q.
Indeed, from the definition of q, one has
</p>
<p>sin� D ˙kqk; e D q= sin� (2.75)
</p>
<p>from which it is clear that q alone does not suffice to define the rotation under
study, since it leaves angle � undefined. Indeed, the vector of the rotation matrix</p>
<p/>
</div>
<div class="page"><p/>
<p>48 2 Mathematical Background
</p>
<p>provides no information about cos�. Yet another representation of the rotation
matrix is displayed below, in terms of its linear invariants, that is readily derived
from representations (2.49) and (2.55), namely,
</p>
<p>Q D qq
T
</p>
<p>kqk2 C q0
�
</p>
<p>1 � qq
T
</p>
<p>kqk2
�
</p>
<p>CQ (2.76a)
</p>
<p>in which Q is the cross-product matrix of vector q, i.e.,
</p>
<p>Q � @.q � x/
@x
</p>
<p>for any vector x.
Note that by virtue of Eq. (2.72), the representation of Q given in Eq. (2.76a) can
</p>
<p>be expressed alternatively as
</p>
<p>Q D q01CQC
qqT
</p>
<p>1C q0
(2.76b)
</p>
<p>From either Eq. (2.76a) or (2.76b) it is apparent that linear invariants are not suitable
to represent a rotation when the associated angle is either � or close to it. Note that a
rotation through an angle � about an axis given by vector e is identical to a rotation
through an angle �� about an axis given by vector �e. Hence, changing the sign of
e does not change the rotation matrix, provided that the sign of � is also changed.
Henceforth, we will choose the sign of the components of e so that sin� � 0, which
is equivalent to assuming that 0 � � � � . Thus, sin� is calculated as kqk, while
cos� as indicated in Eq. (2.70). Obviously, e is simply q normalized, i.e., q divided
by its Euclidean norm.
</p>
<p>2.3.5 Examples
</p>
<p>The examples below are meant to stress the foregoing ideas on rotation invariants.
</p>
<p>Example 2.3.3. If Œe&#141;F D Œ
p
3=3; �
</p>
<p>p
3=3;
</p>
<p>p
3=3 &#141;T in a given coordinate frame F
</p>
<p>and � D 120ı, what is Q in F?
Solution: From the data,
</p>
<p>cos� D �1
2
; sin� D
</p>
<p>p
3
</p>
<p>2
</p>
<p>Moreover, in the F frame,
</p>
<p>Œ eeT &#141;F D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>�1
1
</p>
<p>3
</p>
<p>5
�
</p>
<p>1 �1 1
�
</p>
<p>D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>1 �1 1
�1 1 �1
1 �1 1
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 49
</p>
<p>and hence,
</p>
<p>Œ 1 � eeT &#141;F D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>2 1 �1
1 2 1
</p>
<p>�1 1 2
</p>
<p>3
</p>
<p>5 ; ŒE &#141;F �
p
3
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 �1
1 0 �1
1 1 0
</p>
<p>3
</p>
<p>5
</p>
<p>Thus, from Eq. (2.49),
</p>
<p>ŒQ&#141;F D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1 �1 1
�1 1 �1
1 �1 1
</p>
<p>3
</p>
<p>5 � 1
6
</p>
<p>2
</p>
<p>4
</p>
<p>2 1 �1
1 2 1
</p>
<p>�1 1 2
</p>
<p>3
</p>
<p>5C 3
6
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 �1
1 0 �1
1 1 0
</p>
<p>3
</p>
<p>5
</p>
<p>i.e.,
</p>
<p>ŒQ&#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 0
0 0 �1
1 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>Example 2.3.4. The matrix representation of a linear transformation Q in a certain
reference frame F is given below. Find out whether the said transformation is a
rigid-body rotation. If it is, find its natural invariants.
</p>
<p>ŒQ &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>0 1 0
</p>
<p>0 0 1
</p>
<p>1 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>Solution: First the given array is tested for orthogonality:
</p>
<p>ŒQ &#141;F ŒQ
T &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>0 1 0
</p>
<p>0 0 1
</p>
<p>1 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 1
</p>
<p>1 0 0
</p>
<p>0 1 0
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 1 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>thereby showing that the said array is indeed orthogonal. Thus, the linear transfor-
mation could represent a reflection or a rotation. In order to decide which one this
represents, the determinant of the foregoing array is computed:
</p>
<p>det.Q / D C1
</p>
<p>which makes apparent that Q indeed represents a rigid-body rotation. Now, its nat-
ural invariants are computed. The unit vector e can be computed as the eigenvector
of Q associated with the eigenvalueC1. This requires, however, finding a nontrivial
solution of a homogeneous linear system of three equations in three unknowns. This
is not difficult to do, but it is cumbersome and is not necessary. In order to find e and
�, it is recalled that vect.Q/ D sin� e, which is readily computed with differences
only, as indicated in Eq. (2.59), namely,</p>
<p/>
</div>
<div class="page"><p/>
<p>50 2 Mathematical Background
</p>
<p>Œq &#141;F � sin� Œe&#141;F D �
1
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>Under the assumption that sin� � 0, then,
</p>
<p>sin� � kqk D
p
3
</p>
<p>2
</p>
<p>and hence,
</p>
<p>Œe&#141;F D
Œq&#141;F
</p>
<p>kqk D �
p
3
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>and
</p>
<p>� D 60ı or 120ı
</p>
<p>The foregoing ambiguity is resolved by the trace of Q, which yields
</p>
<p>1C 2 cos� � tr.Q/ D 0; cos� D �1
2
</p>
<p>The negative sign of cos� indicates that � lies in the second quadrant&mdash;it cannot lie
in the third quadrant because of our assumption about the sign of sin�&mdash;and hence
</p>
<p>� D 120ı
</p>
<p>Example 2.3.5. A coordinate frame X1; Y1; Z1 is rotated into a configuration
X2; Y2; Z2 in such a way that
</p>
<p>X2 D �Y1; Y2 D Z1; Z2 D �X1
Find the matrix representation of the rotation in X1; Y1; Z1 coordinates. From this
representation, compute the direction of the axis and the angle of rotation.
</p>
<p>Solution: Let i1; j1; k1 be unit vectors parallel to X1; Y1; Z1, respectively,
i2; j2; k2 being defined correspondingly. One has
</p>
<p>i2 D �j1; j2 D k1; k2 D �i1
and hence, from Definition 2.2.1, the matrix representation ŒQ &#141;1 of the rotation
under study in the X1; Y1; Z1 coordinate frame is readily derived:
</p>
<p>ŒQ &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 �1
�1 0 0
0 1 0
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 51
</p>
<p>from which the linear invariants follow, namely,
</p>
<p>Œq&#141;1 � Œ vect.Q/ &#141;1 D sin� Œ e &#141;1 D
1
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>�1
�1
</p>
<p>3
</p>
<p>5 ; cos� D 1
2
Œ tr.Q/ � 1 &#141; D �1
</p>
<p>2
</p>
<p>Under our assumption that sin� � 0, we obtain
</p>
<p>sin� D kqk D
p
3
</p>
<p>2
; Œ e &#141;1 D
</p>
<p>Œq&#141;1
</p>
<p>sin�
D
p
3
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>�1
�1
</p>
<p>3
</p>
<p>5
</p>
<p>From the foregoing values for sin� and cos�, angle � is computed uniquely as
</p>
<p>� D 120ı
</p>
<p>Example 2.3.6. Show that the matrix P given in Eq. (2.4) satisfies properties (2.1a).
</p>
<p>Solution: First, we prove idempotency, i.e.,
</p>
<p>P2 D .1 � nnT /.1 � nnT /
D 1 � 2nnT C nnT nnT D 1 � nnT D P
</p>
<p>thereby showing that P is, indeed, idempotent. Now we prove that n is an
eigenvector of P with eigenvalue, 0 and hence, n spans the null space of P. In fact,
</p>
<p>Pn D .1 � nnT /n D n � nnT n D n � n D 0
</p>
<p>thereby completing the proof.
</p>
<p>Example 2.3.7. The representations of three linear transformations in a given
coordinate frame F are given below:
</p>
<p>ŒA &#141;F D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>2 1 2
</p>
<p>�2 2 1
�1 �2 2
</p>
<p>3
</p>
<p>5
</p>
<p>ŒB &#141;F D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>2 1 1
</p>
<p>1 2 �1
1 �1 2
</p>
<p>3
</p>
<p>5
</p>
<p>ŒC &#141;F D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1 2 2
</p>
<p>2 1 �2
2 �2 1
</p>
<p>3
</p>
<p>5
</p>
<p>One of the foregoing matrices is an orthogonal projection, one is a reflection, and
one is a rotation. Identify each of these and give its invariants.</p>
<p/>
</div>
<div class="page"><p/>
<p>52 2 Mathematical Background
</p>
<p>Solution: From representations (2.49) and (2.55), it is clear that a rotation matrix
is symmetric if and only if sin� D 0. This means that a rotation matrix cannot be
symmetric unless its angle of rotation is either 0 or � , i.e., unless its trace is either 3
or �1. Since ŒB &#141;F and ŒC &#141;F are symmetric, they cannot be rotations, unless their
traces take the foregoing values. Their traces are thus evaluated below:
</p>
<p>tr.B/ D 2; tr.C/ D 1
</p>
<p>which thus rules out the foregoing matrices as suitable candidates for rotations.
Thus, A is the only candidate left for proper orthogonality, its suitability being tested
below:
</p>
<p>ŒAAT &#141;F D
1
</p>
<p>9
</p>
<p>2
</p>
<p>4
</p>
<p>9 0 0
</p>
<p>0 9 0
</p>
<p>0 0 9
</p>
<p>3
</p>
<p>5 ; det.A/ D C1
</p>
<p>and hence, A indeed represents a rotation. Its natural invariants are next computed:
</p>
<p>sin� Œe&#141;F D Œvect.A/&#141;F D
1
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>�1
1
</p>
<p>�1
</p>
<p>3
</p>
<p>5 ; cos� D 1
2
Œtr.A/ � 1&#141; D 1
</p>
<p>2
.2 � 1/ D 1
</p>
<p>2
</p>
<p>We assume, as usual, that sin� � 0. Then,
</p>
<p>sin� D kvect.A/k D
p
3
</p>
<p>2
; i:e:; � D 60ı
</p>
<p>Moreover,
</p>
<p>Œe&#141;F D
Œvect.A/&#141;F
kvect.A/k D
</p>
<p>p
3
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>�1
1
</p>
<p>�1
</p>
<p>3
</p>
<p>5
</p>
<p>Now, one matrix of B and C is an orthogonal projection and the other is a reflection.
To be a reflection, a matrix has to be orthogonal. Hence, each matrix is tested for
orthogonality:
</p>
<p>ŒBBT &#141;F D
1
</p>
<p>9
</p>
<p>2
</p>
<p>4
</p>
<p>6 3 3
</p>
<p>3 6 �3
3 �3 6
</p>
<p>3
</p>
<p>5 D ŒB2 &#141;F D ŒB &#141;F ; ŒCCT &#141;F D
1
</p>
<p>9
</p>
<p>2
</p>
<p>4
</p>
<p>9 0 0
</p>
<p>0 9 0
</p>
<p>0 0 9
</p>
<p>3
</p>
<p>5
</p>
<p>thereby showing that C is orthogonal and B is not. Furthermore, det.C/ D �1,
which confirms that C is a reflection. Now, if B is a projection, it is bound to be
singular and idempotent. From the orthogonality test it is clear that it is idempotent.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 53
</p>
<p>Moreover, one can readily verify that det.B/ D 0, and hence B is singular, the unit
vector Œn &#141;F D Œ n1; n2; n3 &#141;T that spans its null space being determined from the
general form of projections, Eq. (2.1a), whence,
</p>
<p>nnT D 1 � B
</p>
<p>Therefore, if a solution n has been found, then�n is also a solution, i.e., the problem
admits two solutions, one being the negative of the other. These two solutions are
found below, by first rewriting the above system of equations in component form:
</p>
<p>2
</p>
<p>4
</p>
<p>n21 n1n2 n1n3
n1n2 n
</p>
<p>2
2 n2n3
</p>
<p>n1n3 n2n3 n
2
3
</p>
<p>3
</p>
<p>5 D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>1 �1 �1
�1 1 1
�1 1 1
</p>
<p>3
</p>
<p>5
</p>
<p>Now, from the diagonal entries of the above matrices, it is apparent that the three
components of n have identical absolute values, i.e.,
</p>
<p>p
3=3. Moreover, from the off-
</p>
<p>diagonal entries of the same matrices, the second and third components of n bear
equal signs, but we cannot tell whether positive or negative, because of the quadratic
nature of the problem at hand. The two solutions are thus obtained as
</p>
<p>n D ˙
p
3
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>�1
�1
</p>
<p>3
</p>
<p>5
</p>
<p>which is the only invariant of B.
We now look at C, which is a reflection, and apparently, bears the form
</p>
<p>C D 1 � 2nnT
</p>
<p>In order to determine n, note that
</p>
<p>nnT D 1
2
.1 � C/
</p>
<p>or in component form,
2
</p>
<p>4
</p>
<p>n21 n1n2 n1n3
n1n2 n
</p>
<p>2
2 n2n3
</p>
<p>n1n3 n2n3 n
2
3
</p>
<p>3
</p>
<p>5 D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>1 �1 �1
�1 1 1
�1 1 1
</p>
<p>3
</p>
<p>5
</p>
<p>which is identical to the matrix equation derived in the case of matrix B. Hence, the
solution is the same, i.e.,
</p>
<p>n D ˙
p
3
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>�1
�1
</p>
<p>3
</p>
<p>5
</p>
<p>thereby finding the invariant sought.</p>
<p/>
</div>
<div class="page"><p/>
<p>54 2 Mathematical Background
</p>
<p>Example 2.3.8. The vector and the trace of a rotation matrix Q, in a certain
reference frame F , are given as
</p>
<p>Œvect.Q/&#141;F D
1
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>�1
1
</p>
<p>�1
</p>
<p>3
</p>
<p>5 ; tr.Q/ D 2
</p>
<p>Find the matrix representation of Q in the given coordinate frame and in a frame
having its Z-axis parallel to vect(Q).
</p>
<p>Solution: We shall resort to Eq. (2.76a) to determine the rotation matrix Q. The
quantities involved in the representation of Q in F are readily computed:
</p>
<p>ŒqqT &#141;F D
1
</p>
<p>4
</p>
<p>2
</p>
<p>4
</p>
<p>1 �1 1
�1 1 �1
1 �1 1
</p>
<p>3
</p>
<p>5 ; kqk2 D 3
4
; ŒQ &#141;F D
</p>
<p>1
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>0 1 1
</p>
<p>�1 0 1
�1 �1 0
</p>
<p>3
</p>
<p>5
</p>
<p>from which Q follows:
</p>
<p>ŒQ &#141;F D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>2 1 2
</p>
<p>�2 2 1
�1 �2 2
</p>
<p>3
</p>
<p>5
</p>
<p>in the given coordinate frame. Now, let Z denote a coordinate frame whose Z-axis
is parallel to q. Hence,
</p>
<p>Œq &#141;Z D
p
3
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; ŒqqT &#141;Z D
3
</p>
<p>4
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 0
</p>
<p>0 0 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5 ; ŒQ &#141;Z D
p
3
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 0
1 0 0
</p>
<p>0 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>which readily leads to
</p>
<p>ŒQ &#141;Z D
</p>
<p>2
</p>
<p>4
</p>
<p>1=2 �
p
3=2 0p
</p>
<p>3=2 1=2 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>and is in the Z-canonical form.
</p>
<p>Example 2.3.9. A procedure for trajectory planning produced a matrix representing
a rotation for a certain pick-and-place operation, as shown below:
</p>
<p>ŒQ &#141; D
</p>
<p>2
</p>
<p>4
</p>
<p>0:433 �0:500 z
x 0:866 �0:433
</p>
<p>0:866 y 0:500
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 55
</p>
<p>where x, y, and z are entries that are unrecognizable due to failures in the printing
hardware. Knowing that Q is in fact a rotation matrix, find the missing entries.
</p>
<p>Solution: Since Q is a rotation matrix, the product P � QTQ should equal the
3 � 3 identity matrix, and det(Q) should beC1. The foregoing product is computed
first:
</p>
<p>ŒP &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>0:437C z2 0:433.x � z � 1/ 0:5.�y C z/C 0:375
� 0:937C x2 0:866.x C y/ � 0:216
� � 1C y2
</p>
<p>3
</p>
<p>5
</p>
<p>where the entries below the diagonal need not be printed because the matrix is
symmetric. Upon equating the diagonal entries of the foregoing array to unity, we
obtain
</p>
<p>x D ˙0:250; y D 0; z D ˙0:750
</p>
<p>while the vanishing of the off-diagonal entries leads to
</p>
<p>x D 0:250; y D 0; z D �0:750
</p>
<p>which can be readily verified to produce det.Q/ D C1.
</p>
<p>2.3.6 The Euler&ndash;Rodrigues Parameters
</p>
<p>The invariants defined so far, namely, the natural and the linear invariants of a
rotation matrix, are not the only ones that are used in kinematics. Additionally, one
has the Euler parameters, or Euler&ndash;Rodrigues parameters, as Cheng and Gupta
(1989) propose that they should be called, represented here as r and r0. The Euler&ndash;
Rodrigues parameters are defined as
</p>
<p>r � sin
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>e; r0 D cos
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>(2.77)
</p>
<p>One can readily show that Q takes on a quite simple form in terms of the Euler&ndash;
Rodrigues parameters, namely,
</p>
<p>Q D .r02 � r � r/1C 2rrT C 2r0R (2.78)
</p>
<p>in which R is the cross-product matrix of r, i.e.,
</p>
<p>R � @.r � x/
@x
</p>
<p>for arbitrary x.</p>
<p/>
</div>
<div class="page"><p/>
<p>56 2 Mathematical Background
</p>
<p>Note that the Euler&ndash;Rodrigues parameters appear quadratically in the rotation
matrix. Hence, these parameters cannot be computed with simple sums and
differences. A closer inspection of Eq. (2.76b) reveals that the linear invariants
appear almost linearly in the rotation matrix. This means that the rotation matrix,
as given by Eq. (2.76b), is composed of two types of terms, namely, linear and
rational. Moreover, the rational term is composed of a quadratic expression in the
numerator and a linear expression in the denominator, the ratio thus being linear,
which explains why the linear invariants can be obtained by sums and differences
from the rotation matrix.
</p>
<p>The relationship between the linear invariants and the Euler&ndash;Rodrigues parame-
ters can be readily derived, namely,
</p>
<p>r0 D ˙
r
</p>
<p>1C q0
2
</p>
<p>; r D q
2r0
</p>
<p>; � &curren; � (2.79)
</p>
<p>Furthermore, note that, if � D � , then r0 D 0, and formulae (2.79) fail to produce
r. However, from Eq. (2.77),
</p>
<p>For � D � W r D e; r0 D 0 (2.80)
</p>
<p>We now derive invariant relations between the rotation matrix and the Euler&ndash;
Rodrigues parameters. To do this, we resort to the concept of matrix square root.
As a matter of fact, the square root of a square matrix is nothing but a particular
case of an analytic function of a square matrix, discussed in connection with
Theorem 2.3.3 and the exponential representation of the rotation matrix. Indeed,
the square root of a square matrix is an analytic function of that matrix, and hence,
admits a series expansion in powers of the matrix. Moreover, by virtue of the
Cayley&ndash;Hamilton Theorem (Theorem 2.3.3) the said square root should be, for a
3 � 3 matrix, a linear combination of the identity matrix 1, the matrix itself, and its
square, the coefficients being found using the eigenvalues of the matrix.
</p>
<p>Furthermore, from the geometric meaning of a rotation through the angle �
about an axis parallel to the unit vector e, it is apparent that the square of the
matrix representing the foregoing rotation is itself a rotation about the same axis,
but through the angle 2�. By the same token, the square root of the rotation matrix
is again a rotation matrix about the same axis, but through an angle �=2. Now,
while the square of a matrix is unique, its square root is not. This fact is apparent
for diagonalizable matrices, whose diagonal entries are their eigenvalues. Each
eigenvalue, whether positive or negative, admits two square roots, and hence, a
diagonalizable n � n matrix admits as many square roots as there are combinations
of the two possible roots of individual eigenvalues, disregarding rearrangements of
the latter. Such a number is 2n, and hence, a 3 � 3 matrix admits eight square roots.
For example, the eight square roots of the identity 3� 3matrix are displayed below:</p>
<p/>
</div>
<div class="page"><p/>
<p>2.3 Rigid-Body Rotations 57
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 1 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5 ;
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 1 0
</p>
<p>0 0 �1
</p>
<p>3
</p>
<p>5 ;
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 �1 0
0 0 1
</p>
<p>3
</p>
<p>5 ;
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>�1 0 0
0 1 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>7
7
5
;
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 �1 0
0 0 �1
</p>
<p>3
</p>
<p>5 ;
</p>
<p>2
</p>
<p>4
</p>
<p>�1 0 0
0 1 0
</p>
<p>0 0 �1
</p>
<p>3
</p>
<p>5 ;
</p>
<p>2
</p>
<p>4
</p>
<p>�1 0 0
0 �1 0
0 0 1
</p>
<p>3
</p>
<p>5 ;
</p>
<p>2
</p>
<p>4
</p>
<p>�1 0 0
0 �1 0
0 0 �1
</p>
<p>3
</p>
<p>5
</p>
<p>In fact, the foregoing result can be extended to orthogonal matrices as well and,
for that matter, to any square matrix with n linearly independent eigenvectors. That
is, an n� n orthogonal matrix admits 2n square roots. However, not all eight square
roots of a 3�3 orthogonal matrix are orthogonal. In fact, not all eight square roots of
a 3�3 proper orthogonal matrix are proper orthogonal either. Of these square roots,
nevertheless, there is one that is proper orthogonal, the one representing a rotation of
�=2. We will denote this particular square root of Q by
</p>
<p>p
Q. The Euler&ndash;Rodrigues
</p>
<p>parameters of Q can thus be expressed as the linear invariants of
p
</p>
<p>Q, namely,
</p>
<p>r D vect.
p
</p>
<p>Q/; r0 D
tr.
p
</p>
<p>Q/ � 1
2
</p>
<p>(2.81)
</p>
<p>It is important to recognize the basic differences between the linear invariants
and the Euler&ndash;Rodrigues parameters. Whereas the former can be readily derived
from the matrix representation of the rotation involved by simple additions and
subtractions, the latter require square roots and entail sign ambiguities. However,
the former fail to produce information on the axis of rotation whenever the angle of
rotation is � , whereas the latter produce that information for any value of the angle
of rotation.
</p>
<p>The Euler&ndash;Rodrigues parameters are nothing but the quaternions invented by
Sir William Rowan Hamilton (1844) in an extraordinary moment of creativity on
Monday, October 16, 1843, as &ldquo;Hamilton, accompanied by Lady Hamilton, was
walking along the Royal Canal in Dublin towards the Royal Irish Academy, where
Hamilton was to preside a meeting&rdquo; (Altmann 1989).
</p>
<p>Moreover, the Euler&ndash;Rodrigues parameters should not be confused with the
Euler angles, which are not invariant and hence, admit multiple definitions. The
foregoing means that no single set of Euler angles exists for a given rotation matrix,
the said angles depending on how the rotation is decomposed into three simpler
rotations. For this reason, Euler angles will not be stressed here. The reader is
referred to Exercise 2.19 for a short discussion of Euler angles; Synge (1960)
includes a classical treatment, while Kane et al. (1983) provide an extensive
discussion of the same.
</p>
<p>Example 2.3.10. Find the Euler&ndash;Rodrigues parameters of the proper orthogonal
matrix Q given as
</p>
<p>Q D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>�1 2 2
2 �1 2
2 2 �1
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>58 2 Mathematical Background
</p>
<p>Solution: Since the given matrix is symmetric, its angle of rotation is � and its
vector linear invariant vanishes, which prevents us from finding the direction of
the axis of rotation from the linear invariants; moreover, expressions (2.79) do not
apply. However, we can use Eq. (2.50) to find the unit vector e parallel to the axis of
rotation, i.e.,
</p>
<p>eeT D 1
2
.1CQ/
</p>
<p>or in component form,
</p>
<p>2
</p>
<p>4
</p>
<p>e21 e1e2 e1e3
e1e2 e
</p>
<p>2
2 e2e3
</p>
<p>e1e3 e2e3 e
2
3
</p>
<p>3
</p>
<p>5 D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>1 1 1
</p>
<p>1 1 1
</p>
<p>1 1 1
</p>
<p>3
</p>
<p>5
</p>
<p>A simple inspection of the components of the two sides of the above equation reveals
that all three components of e are identical and moreover, of the same sign, but we
cannot tell which sign this is. Therefore,
</p>
<p>e D ˙
p
3
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>Moreover, from the symmetry of Q, we know that � D � , and hence,
</p>
<p>r D e sin
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>D ˙
p
3
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; r0 D cos
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>D 0
</p>
<p>2.4 Composition of Reflections and Rotations
</p>
<p>As pointed out in Sect. 2.2, reflections occur often accompanied by rotations. The
effect of this combination is that the rotation destroys the two properties of pure
reflections, symmetry and self-inversion, as defined in Sect. 2.2. Indeed, let R be
a pure reflection, taking on the form appearing in Eq. (2.5), and Q an arbitrary
rotation, taking on the form of Eq. (2.49). The product of these two transformations,
QR, denoted by T, is apparently neither symmetric nor self-inverse, as the reader
can readily verify. Likewise, the product of these two transformations in the reverse
order is neither symmetric nor self-inverse.
</p>
<p>As a consequence of the foregoing discussion, an improper orthogonal trans-
formation that is not symmetric can always be decomposed into the product of a
rotation and a pure reflection, the latter being symmetric and self-inverse. Moreover,
this decomposition can take on the form of any of the two possible orderings of the</p>
<p/>
</div>
<div class="page"><p/>
<p>2.4 Composition of Reflections and Rotations 59
</p>
<p>rotation and the reflection. Note, however, that once the order has been selected,
the decomposition is not unique. Indeed, if we want to decompose T in the above
paragraph into the product QR, then we can freely choose the unit normal n of the
plane of reflection and write
</p>
<p>R � 1 � 2nnT
</p>
<p>vector n then being found from
</p>
<p>nnT D 1
2
.1 � R/
</p>
<p>Hence, the factor Q of that decomposition is obtained as
</p>
<p>Q D TR�1 � TR D T � 2.Tn/nT
</p>
<p>where use has been made of the self-inverse property of R. Any other selection of
vector n will lead to a different decomposition of T.
</p>
<p>Example 2.4.1. Join the palms of your two hands in the position adopted by
swimmers when preparing for plunging, while holding a sheet of paper between
them. The sheet defines a plane in each hand that we will call the hand plane,
its unit normal, pointing outside of the hand, being called the hand normal and
represented as vectors nR and nL for the right and left hand, respectively. Moreover,
let oR and oL denote unit vectors pointing in the direction of the finger axes of each
of the two hands. Thus, in the swimmer position described above, nL D �nR and
oL D oR. Now, without moving your right hand, let the left hand attain a position
whereby the left-hand normal lies at right angles with the right-hand normal, the
palm pointing downwards and the finger axes of the two hands remaining parallel.
Find the representation of the transformation carrying the right hand to the final
configuration of the left hand, in terms of the unit vectors nR and oR.
</p>
<p>Solution: Let us regard the desired transformation T as the product of a rotation
Q by a pure reflection R, in the form T D QR. Thus, the transformation occurs so
that the reflection takes place first, then the rotation. The reflection is simply that
mapping the right hand into the left hand, and hence, the reflection plane is simply
the hand plane, i.e.,
</p>
<p>R D 1 � 2nRnTR
</p>
<p>Moreover, the left hand rotates from the swimmer position about an axis parallel
to the finger axes through an angle of 90ı clockwise from your viewpoint, i.e., in
the positive direction of vector oR. Hence, the form of the rotation involved can be
derived readily from Eq. (2.49) and the above information, namely,
</p>
<p>Q D oRoTR COR</p>
<p/>
</div>
<div class="page"><p/>
<p>60 2 Mathematical Background
</p>
<p>where OR is the cross-product matrix of oR. Hence, upon performing the product
QR, we have
</p>
<p>T D oRoTR C 2OR � 2.oR � nR/nTR
which is the transformation sought.
</p>
<p>2.5 Coordinate Transformations and Homogeneous
</p>
<p>Coordinates
</p>
<p>Crucial to robotics is the unambiguous description of the geometric relations among
the various bodies in the environment surrounding a robot. These relations are
established by means of coordinate frames, or frames, for brevity, attached to each
rigid body in the scene, including the robot links. The origins of these frames,
moreover, are set at landmark points and orientations defined by key geometric
entities like lines and planes. For example, in Chap. 4 we attach two frames to every
moving link of a serial robot, with origin at a point on each of the axis of the two
joints coupling this link with its two neighbors. Moreover, the Z-axis of each frame
is defined, according to the Denavit&ndash;Hartenberg notation, introduced in that chapter,
along each joint axis, while the X-axis of the frame closer to the base&mdash;termed the
fore frame&mdash;is defined along the common perpendicular to the two joint axes. The
origin of the same frame is thus defined as the intersection of the fore axis with the
common perpendicular to the two axes. This section is devoted to the study of the
coordinate transformations of vectors when these are represented in various frames.
</p>
<p>2.5.1 Coordinate Transformations Between Frames
</p>
<p>with a Common Origin
</p>
<p>We will refer to two coordinate frames in this section, namely, A D fX; Y; Zg and
B D fX ; Y; Zg. Moreover, let Q be the rotation carrying A into B, i.e.,
</p>
<p>QW A ! B (2.82)
</p>
<p>The purpose of this subsection is to establish the relation between the representa-
tions of the position vector of a point P in A and in B, denoted by Œp &#141;A and Œp &#141;B,
respectively. Let
</p>
<p>Œp &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>x
</p>
<p>y
</p>
<p>z
</p>
<p>3
</p>
<p>5 (2.83)</p>
<p/>
</div>
<div class="page"><p/>
<p>2.5 Coordinate Transformations and Homogeneous Coordinates 61
</p>
<p>a b
</p>
<p>Fig. 2.4 Coordinate transformation: (a) coordinates of point P in the A-frame; and (b) relative
orientation of frame B with respect to A
</p>
<p>We want to find Œp &#141;B in terms of Œp &#141;A and Q, when the latter is represented in either
frame. The coordinate transformation can best be understood if we regard point P
as attached to frame A, as if it were a point of a box with sides of lengths x, y, and
z, as indicated in Fig. 2.4a. Now, frame A undergoes a rotation Q about its origin
that carries it into a new attitude, that of frame B, as illustrated in Fig. 2.4b. Point P
in its rotated position is labeled ˘ , of position vector �, i.e.,
</p>
<p>� D Qp (2.84)
</p>
<p>It is apparent that the relative position of point P with respect to its box does not
change under the foregoing rotation, and hence,
</p>
<p>Œ� &#141;B D
</p>
<p>2
</p>
<p>4
</p>
<p>x
</p>
<p>y
</p>
<p>z
</p>
<p>3
</p>
<p>5 (2.85)
</p>
<p>Moreover, let
</p>
<p>Œ� &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>�
</p>
<p>�
</p>
<p>�
</p>
<p>3
</p>
<p>5 (2.86)
</p>
<p>The relation between the two representations of the position vector of any point of
the three-dimensional Euclidean space is given by
</p>
<p>Theorem 2.5.1. The representations of the position vector � of any point in two
</p>
<p>frames A and B, denoted by Œ� &#141;A and Œ� &#141;B, respectively, are related by
</p>
<p>Œ� &#141;A D ŒQ &#141;AŒ� &#141;B (2.87)</p>
<p/>
</div>
<div class="page"><p/>
<p>62 2 Mathematical Background
</p>
<p>Proof. Let us write Eq. (2.84) in A:
</p>
<p>Œ� &#141;A D ŒQ &#141;AŒp &#141;A (2.88)
</p>
<p>Now, from Fig. 2.4b and Eqs. (2.83) and (2.85) it is apparent that
</p>
<p>Œ� &#141;B D Œp &#141;A (2.89)
</p>
<p>Upon substituting Eq. (2.89) into Eq. (2.88), we obtain
</p>
<p>Œ� &#141;A D ŒQ &#141;AŒ� &#141;B (2.90)
</p>
<p>q.e.d. Moreover, we have
</p>
<p>Theorem 2.5.2. The representations of Q carrying A into B in these two frames
</p>
<p>are identical, i.e.,
</p>
<p>ŒQ &#141;A D ŒQ &#141;B (2.91)
</p>
<p>Proof. Upon substitution of Eq. (2.84) into Eq. (2.87), we obtain
</p>
<p>ŒQp &#141;A D ŒQ &#141;AŒQp &#141;B
</p>
<p>or
</p>
<p>ŒQ &#141;AŒp &#141;A D ŒQ &#141;AŒQp &#141;B
</p>
<p>Now, since Q is orthogonal, it is nonsingular, and hence, ŒQ &#141;A can be deleted from
the foregoing equation, thus leading to
</p>
<p>Œp &#141;A D ŒQ &#141;BŒp &#141;B (2.92)
</p>
<p>However, by virtue of Theorem 2.5.1, the two representations of p observe the
relation
</p>
<p>Œp &#141;A D ŒQ &#141;AŒp &#141;B (2.93)
</p>
<p>the theorem being proved upon equating the right-hand sides of Eqs. (2.92)
and (2.93).
</p>
<p>Note that the foregoing theorem states a relation valid only for the conditions
stated therein. The reader should not conclude from this result that rotation
matrices have the same representations in every frame. This point is stressed in
Example 2.5.1. Furthermore, we have</p>
<p/>
</div>
<div class="page"><p/>
<p>2.5 Coordinate Transformations and Homogeneous Coordinates 63
</p>
<p>Fig. 2.5 Coordinate frames
A and B with a common
origin
</p>
<p>Theorem 2.5.3. The inverse relation of Theorem 2.5.1 is given by
</p>
<p>Œ� &#141;B D ŒQT &#141;BŒ� &#141;A (2.94)
</p>
<p>Proof. This is straightforward in light of the two foregoing theorems, and is left to
the reader as an exercise.
</p>
<p>Example 2.5.1. Coordinate frames A and B are shown in Fig. 2.5. Find the
representations of Q rotating A into B in these two frames and show that they are
identical. Moreover, if Œp &#141;A D Œ 1; 1; 1 &#141;T , find Œp &#141;B.
</p>
<p>Solution: Let i, j, and k be unit vectors in the directions of the X-, Y-, and Z-axes,
respectively; unit vectors �, &#13; , and � are defined likewise as parallel to the X -, Y-,
and Z-axes of Fig. 2.5. Therefore,
</p>
<p>Q i � � D �k; Q j � &#13; D �i; Q k � � D j
</p>
<p>Therefore, using Definition 2.2.1, the matrix representation of Q carrying A into
B, in A, is given by
</p>
<p>ŒQ &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 0
0 0 1
</p>
<p>�1 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>Now, in order to find ŒQ &#141;B, we apply Q to the three unit vectors of B, �, &#13; , and �.
Thus, for �, we have
</p>
<p>Q� D Q.�k/ D �Qk D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>�1
0
</p>
<p>3
</p>
<p>5 D �j D ��</p>
<p/>
</div>
<div class="page"><p/>
<p>64 2 Mathematical Background
</p>
<p>Likewise,
</p>
<p>Q&#13; D ��; Q� D &#13;
</p>
<p>again, from Definition 2.2.1, we have
</p>
<p>ŒQ &#141;B D
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 0
0 0 1
</p>
<p>�1 0 0
</p>
<p>3
</p>
<p>5 D ŒQ &#141;A
</p>
<p>thereby confirming Theorem 2.5.2. Note that the representation of this matrix in any
other coordinate frame would be different. For example, if we represent this matrix
in a frame whose X -axis is directed along the axis of rotation of Q, then we end up
with the X -canonical representation of Q, namely,
</p>
<p>ŒQ &#141;X D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 cos� � sin�
0 sin� cos�
</p>
<p>3
</p>
<p>5
</p>
<p>with the angle of rotation � being readily computed as � D 120ı, which thus yields
</p>
<p>ŒQ &#141;X D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 �1=2 �
p
3=2
</p>
<p>0
p
3=2 �1=2
</p>
<p>3
</p>
<p>5
</p>
<p>Apparently, the entries of ŒQ &#141;X are different from those of ŒQ &#141;A and ŒQ &#141;B found
above.
</p>
<p>Now, from Eq. (2.94),
</p>
<p>Œp &#141;B D
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 �1
�1 0 0
0 1 0
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>�1
�1
1
</p>
<p>3
</p>
<p>5
</p>
<p>a result that can be readily verified by inspection.
</p>
<p>2.5.2 Coordinate Transformation with Origin Shift
</p>
<p>Now, if the coordinate origins do not coincide, let b be the position vector, in
A, of O, the origin of B, as shown in Fig. 2.6. The corresponding coordinate
transformation from A to B, the counterpart of Theorem 2.5.1, is given below.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.5 Coordinate Transformations and Homogeneous Coordinates 65
</p>
<p>Fig. 2.6 Coordinate frames with different origins
</p>
<p>Theorem 2.5.4. The representations of the position vector p of a point P of the
</p>
<p>Euclidean three-dimensional space in two frames A and B are related by
</p>
<p>Œp &#141;A D Œb &#141;A C ŒQ &#141;AŒ� &#141;B (2.95a)
Œ�&#141;B D ŒQT &#141;B.Œ�b &#141;A C Œp &#141;A/ (2.95b)
</p>
<p>with b defined as the vector directed from the origin of A to that of B, and � the
</p>
<p>vector directed from the origin of B to P , as depicted in Fig. 2.6.
</p>
<p>Proof. We have, from Fig. 2.6, in any coordinate frame,
</p>
<p>p D bC � (2.96)
</p>
<p>If we express the above equation in the A-frame, we obtain
</p>
<p>Œp &#141;A D Œb &#141;A C Œ� &#141;A
</p>
<p>where � is assumed to be readily available in B, and so the foregoing equation must
be expressed as
</p>
<p>Œp &#141;A D Œb &#141;A C ŒQ &#141;AŒ� &#141;B (2.97)
</p>
<p>which thus proves Eq. (2.95a). To prove Eq. (2.95b), we simply solve Eq. (2.96) for
� and apply Eq. (2.94) to the equation thus resulting, which readily leads to the
desired relation.
</p>
<p>Notice the geometric interpretation of the second term in the right-hand side of
Eq. (2.97): this term represents, in frame A, the position vector of a point P 0, whose
image under Q is �.</p>
<p/>
</div>
<div class="page"><p/>
<p>66 2 Mathematical Background
</p>
<p>Example 2.5.2. If Œb &#141;A D Œ�1;�1; �1 &#141;T and A and B have the relative
orientations given in Example 2.5.1, find the position vector, in B, of a point P
of position vector Œp &#141;A given as in the same example.
</p>
<p>Solution: What we obviously need is Œ� &#141;B, which is given in Eq. (2.95b). We thus
compute first the sum inside the parentheses of that equation, i.e.,
</p>
<p>Œ�b &#141;A C Œp &#141;A D
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>2
</p>
<p>2
</p>
<p>2
</p>
<p>3
</p>
<p>7
7
5
</p>
<p>We need further ŒQT &#141;B, which can be readily derived from ŒQ &#141;B. We do not have
as yet this matrix, but we have ŒQT &#141;A, which is identical to ŒQT &#141;B by virtue of
Theorem 2.5.2. Therefore,
</p>
<p>Œ� &#141;B D
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 �1
�1 0 0
0 1 0
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>2
</p>
<p>2
</p>
<p>2
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>�2
�2
2
</p>
<p>3
</p>
<p>5
</p>
<p>a result that the reader is invited to verify by inspection.
</p>
<p>2.5.3 Homogeneous Coordinates
</p>
<p>The general coordinate transformation, involving a shift of the origin, is not linear
in the sense of the definition given in Subsection 2.2, as can be readily realized by
virtue of the nonhomogeneous term involved, i.e., the first term of the right-hand side
of Eq. (2.95a), which is independent of p. Such a transformation, nevertheless, can
be represented in homogeneous form if homogeneous coordinates are introduced.
These are defined below: Let Œp &#141;M be the coordinate array of a finite point P in
reference frame M. What we mean by a finite point is one whose coordinates are
all finite. We are thus assuming that the point P at hand is not at infinity, points at
infinity being introduced presently. The homogeneous coordinates of P are those in
the four-dimensional array fpgM, defined as
</p>
<p>fpgM �
�
</p>
<p>Œp &#141;M
1
</p>
<p>�
</p>
<p>(2.98)
</p>
<p>The affine transformation of Eq. (2.95a) can now be rewritten in homogeneous-
coordinate form as
</p>
<p>fpgA D fTgAf�gB (2.99)
</p>
<p>where fTgA is defined as a 4 � 4 array, namely,
</p>
<p>fTgA �
�
</p>
<p>ŒQ &#141;A Œb &#141;A
0T 1
</p>
<p>�
</p>
<p>(2.100)</p>
<p/>
</div>
<div class="page"><p/>
<p>2.5 Coordinate Transformations and Homogeneous Coordinates 67
</p>
<p>The inverse transformation of that defined in Eq. (2.100) is derived from Eqs. (2.95a
and b), i.e.,
</p>
<p>fT�1 gB D
�
</p>
<p>ŒQT &#141;B Œ�b &#141;B
0T 1
</p>
<p>�
</p>
<p>(2.101)
</p>
<p>Now, fT�1 gA can be readily derived from the above expression, upon applica-
tion of Theorems 2.5.1 and 2.5.2, which leads to
</p>
<p>fT�1 gA D
�
</p>
<p>ŒQT &#141;A �ŒQ &#141;AŒb &#141;B
0T 1
</p>
<p>�
</p>
<p>(2.102)
</p>
<p>Furthermore, homogeneous transformations can be concatenated. Indeed, let Fk ,
for k D i�1; i; iC1, denote three coordinate frames, with origins atOk . Moreover,
let Qi�1 be the rotation carrying Fi�1 into an orientation coinciding with that of Fi .
If a similar definition for Qi is adopted, then Qi denotes the rotation carrying Fi
into an orientation coinciding with that of FiC1. First, the case in which all three
origins coincide is considered. Clearly,
</p>
<p>Œp &#141;i D ŒQTi�1 &#141;i�1Œp &#141;i�1 (2.103a)
Œp &#141;iC1 D ŒQTi &#141;i Œp &#141;i D ŒQTi &#141;i ŒQTi�1 &#141;i�1Œp &#141;i�1 (2.103b)
</p>
<p>the inverse relations of those appearing in Eqs. (2.103a and b) being
</p>
<p>Œp &#141;i�1 D ŒQi�1 &#141;i�1Œp &#141;i (2.104a)
Œp &#141;i�1 D ŒQi�1 &#141;i�1ŒQi &#141;i Œp &#141;iC1 (2.104b)
</p>
<p>If now the origins do not coincide, let ai�1 and ai denote the vectors
�����!
Oi�1Oi
</p>
<p>and
�����!
OiOiC1, respectively. The transformations fTi�1gi�1 and fTigi thus arising are
</p>
<p>obviously
</p>
<p>fTi�1gi�1 D
�
</p>
<p>ŒQi�1 &#141;i�1 Œ ai�1 &#141;i�1
0T 1
</p>
<p>�
</p>
<p>; fTigi D
�
</p>
<p>ŒQi &#141;i Œ ai &#141;i
0T 1
</p>
<p>�
</p>
<p>(2.105)
</p>
<p>whereas their inverse transformations are
</p>
<p>fT�1i�1gi D
�
</p>
<p>ŒQTi�1 &#141;i ŒQ
T
i�1 &#141;i Œ�ai�1 &#141;i�1
</p>
<p>0T 1
</p>
<p>�
</p>
<p>(2.106a)
</p>
<p>fT�1i giC1 D
�
</p>
<p>ŒQTi &#141;iC1 ŒQ
T
i &#141;iC1Œ�ai &#141;i
</p>
<p>0T 1
</p>
<p>�
</p>
<p>(2.106b)</p>
<p/>
</div>
<div class="page"><p/>
<p>68 2 Mathematical Background
</p>
<p>The coordinate transformations involved are derived upon simply replacing Qi�1
and Qi with Ti�1 and Ti , respectively, in Eqs. (2.104a and b), i.e.,
</p>
<p>fpgi�1 D fTi�1gi�1fpgi (2.107a)
fpgi�1 D fTi�1gi�1fTigifpgiC1 (2.107b)
</p>
<p>the corresponding inverse transformations being
</p>
<p>fp gi D fT�1i�1gi�1fp gi�1 (2.108a)
fp giC1 D fT�1i gifp gi D fT�1i gifT�1i�1gi�1fp gi�1 (2.108b)
</p>
<p>which are the counterpart transformations of Eqs. (2.103a and b) for the case of no
rigin shift.
</p>
<p>Now, if P lies at infinity, we can express its homogeneous coordinates in a
simpler form. To this end, we rewrite expression (2.98) in the form
</p>
<p>fpgM � kpk
�
</p>
<p>Œ e &#141;M
1=kpk
</p>
<p>�
</p>
<p>and hence,
</p>
<p>lim
kpk!1
</p>
<p>fpgM D
�
</p>
<p>lim
kpk!1
</p>
<p>kpk
��
</p>
<p>lim
kpk!1
</p>
<p>�
</p>
<p>Œ e &#141;M
1=kpk
</p>
<p>��
</p>
<p>or
</p>
<p>lim
kpk!1
</p>
<p>fpgM D
�
</p>
<p>lim
kpk!1
</p>
<p>kpk
��
</p>
<p>Œ e &#141;M
0
</p>
<p>�
</p>
<p>We now define the homogeneous coordinates of a point P lying at infinity as the
four-dimensional array appearing in the foregoing expression, i.e.,
</p>
<p>fp1 gM �
�
</p>
<p>Œ e &#141;M
0
</p>
<p>�
</p>
<p>(2.109)
</p>
<p>which means that a point at infinity, in homogeneous coordinates, has only a
direction, given by the unit vector e, but an undefined location. When working with
objects within the atmosphere of the Earth, for example, stars can be regarded as
lying at infinity, and hence, their location is completely specified simply by their
longitude and latitude, which suffice to define the direction cosines of a unit vector
in spherical coordinates.
</p>
<p>On the other hand, a rotation matrix can be regarded as composed of three
columns, each representing a unit vector, e.g.,
</p>
<p>Q D
�
</p>
<p>e1 e2 e3
�</p>
<p/>
</div>
<div class="page"><p/>
<p>2.5 Coordinate Transformations and Homogeneous Coordinates 69
</p>
<p>where the triad f ek g31 is orthonormal. We can thus represent fT gA of Eq. (2.100)
in the form
</p>
<p>fT gA D
�
</p>
<p>e1 e2 e3 b
</p>
<p>0 0 0 1
</p>
<p>�
</p>
<p>(2.110)
</p>
<p>thereby concluding that the columns of the 4 � 4 matrix T represent the homoge-
neous coordinates of a set of corresponding points, the first three of which lie at
infinity.
</p>
<p>Example 2.5.3. An ellipsoid is centered at a point OB of position vector b, its
three axes X , Y , and Z defining a coordinate frame B. Moreover, its semiaxes
have lengths a D 1, b D 2, and c D 3, the coordinates of OB in a
coordinate frame A being Œb &#141;A D Œ 1; 2; 3 &#141;T . Additionally, the direction cosines
of X are .0:933; 0:067; �0:354/, whereas Y is perpendicular to b and to the
unit vector u that is parallel to the X -axis. Find the equation of the ellipsoid
in A. (This example has relevance in collision-avoidance algorithms, some of
which approximate manipulator links as ellipsoids, thereby easing tremendously
the computational requirements.)
</p>
<p>Solution: Let u, v, and w be unit vectors parallel to the X -, Y-, and Z-axes,
respectively. Then,
</p>
<p>Œu &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>0:933
</p>
<p>0:067
</p>
<p>�0:354
</p>
<p>3
</p>
<p>5 ; v D u � bku � bk ; w D u � v
</p>
<p>and hence,
</p>
<p>Œ v &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>0:243
</p>
<p>�0:843
0:481
</p>
<p>3
</p>
<p>5 ; Œw &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:266
�0:535
�0:803
</p>
<p>3
</p>
<p>5
</p>
<p>from which the rotation matrix Q, rotating the axes of A into orientations coinciding
with those of B, can be readily represented in A, or in B for that matter, as
</p>
<p>ŒQ &#141;A D Œu; v; w &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>0:933 0:243 �0:266
0:067 �0:843 �0:535
�0:354 0:481 �0:803
</p>
<p>3
</p>
<p>5
</p>
<p>On the other hand, if the coordinates of a point P in A and B are Œp &#141;A D
Œ p1; p2; p3 &#141;
</p>
<p>T and Œ� &#141;B D Œ �1; �2; �3 &#141;T , respectively, then the equation of the
ellipsoid in B is, apparently,
</p>
<p>BW �
2
1
</p>
<p>12
C �
</p>
<p>2
2
</p>
<p>22
C �
</p>
<p>2
3
</p>
<p>32
D 1</p>
<p/>
</div>
<div class="page"><p/>
<p>70 2 Mathematical Background
</p>
<p>Now, what is needed in order to derive the equation of the ellipsoid in A is simply
a relation between the coordinates of P in B and those in A. These coordinates are
related by Eq. (2.95b), which requires ŒQT &#141;B, while we have ŒQ &#141;A. Nevertheless,
by virtue of Theorem 2.5.2
</p>
<p>ŒQT &#141;B D ŒQT &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>0:933 0:067 �0:354
0:243 �0:843 0:481
�0:266 �0:535 �0:803
</p>
<p>3
</p>
<p>5
</p>
<p>Hence,
</p>
<p>Œ� &#141;B D
</p>
<p>2
</p>
<p>4
</p>
<p>0:933 0:067 �0:354
0:243 �0:843 0:481
�0:266 �0:535 �0:803
</p>
<p>3
</p>
<p>5
</p>
<p>0
</p>
<p>@
</p>
<p>2
</p>
<p>4
</p>
<p>�1
�2
�3
</p>
<p>3
</p>
<p>5C
</p>
<p>2
</p>
<p>4
</p>
<p>p1
p2
p3
</p>
<p>3
</p>
<p>5
</p>
<p>1
</p>
<p>A
</p>
<p>Therefore,
</p>
<p>�1 D 0:933p1 C 0:067p2 � 0:354p3 � 0:005
�2 D 0:243p1 � 0:843p2 C 0:481p3
�3 D �0:266p1 � 0:535p2 � 0:803p3 C 3:745
</p>
<p>Substitution of the foregoing relations into the ellipsoid equation in B leads to
</p>
<p>AW 32:1521p12 C 7:70235p22 C 9:17286p32 � 8:30524p1 � 16:0527p2
�23:9304p3 C 9:32655p1p2 C 9:02784p2p3 � 19:9676p1p3 C 20:101 D 0
</p>
<p>which is the equation sought, as obtained using computer algebra.
</p>
<p>2.6 Similarity Transformations
</p>
<p>Transformations of the position vector of points under a change of coordinate frame
involving both a translation of the origin and a rotation of the coordinate axes
was the main subject of Sect. 2.5. In this section, we study the transformations of
components of vectors other than the position vector, while extending the concept
to the transformation of matrix entries. How these transformations take place is the
subject of this section.
</p>
<p>What is involved in the present discussion is a change of basis of the associated
vector spaces, and hence, this is not limited to three-dimensional vector spaces.
That is, n-dimensional vector spaces will be studied in this section. Moreover, only
isomorphisms, i.e., transformations L of the n-dimensional vector space V onto
itself will be considered. Let A D faign1 and B D fbign1 be two different bases of
the same space V . Hence, any vector v of V can be expressed in either of two ways,
namely,</p>
<p/>
</div>
<div class="page"><p/>
<p>2.6 Similarity Transformations 71
</p>
<p>v D ˛1a1 C ˛2a2 C � � � C ˛nan (2.111)
v D ˇ1b1 C ˇ2b2 C � � � C ˇnbn (2.112)
</p>
<p>from which two representations of v are readily derived, namely,
</p>
<p>Œ v &#141;A D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>˛1
˛2
:::
</p>
<p>˛n
</p>
<p>3
</p>
<p>7
7
7
5
; Œ v &#141;B D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>ˇ1
ˇ2
:::
</p>
<p>ˇn
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(2.113)
</p>
<p>In order to find the representation of the linear transformation that relates the
two bases, let A be the linear transformation that carries the set A into the set B,
i.e., A: A! B.
</p>
<p>Furthermore, let the two foregoing bases be related by
</p>
<p>bj D a1j a1 C a2j a2 C � � � C anj an; j D 1; : : : ; n (2.114)
</p>
<p>Hence, the representation sought, ŒA&#141;A&mdash;in the basis A&mdash; is, according to
Definition 2.2.1,
</p>
<p>ŒA &#141;A D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>a11 a12 � � � a1n
a21 a22 � � � a2n
:::
</p>
<p>:::
: : :
</p>
<p>:::
</p>
<p>an1 an2 � � � ann
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(2.115)
</p>
<p>Now, in order to find the relationship between the two representations of
Eq. (2.113), Eq. (2.114) is substituted into Eq. (2.112), which yields
</p>
<p>v D ˇ1.a11a1 C a21a2 C � � � C an1an/
Cˇ2.a12a1 C a22a2 C � � � C an2an/
</p>
<p>:::
</p>
<p>Cˇn.a1na1 C a2na2 C � � � C annan/ (2.116)
</p>
<p>This can be rearranged to yield
</p>
<p>v D .a11ˇ1 C a12ˇ2 C � � � C a1nˇn/a1
C .a21ˇ1 C a22ˇ2 C � � � C a2nˇn/a2
</p>
<p>:::
</p>
<p>C .an1ˇ1 C an2ˇ2 C � � � C annˇn/an (2.117)</p>
<p/>
</div>
<div class="page"><p/>
<p>72 2 Mathematical Background
</p>
<p>Comparing Eq. (2.117) with Eq. (2.111), one readily derives
</p>
<p>Œ v &#141;A D ŒA &#141;AŒ v &#141;B (2.118)
</p>
<p>with ŒA&#141;A introduced in Eq. (2.115). Equation (2.118) is the relation, sought, its
inverse being
</p>
<p>Œ v &#141;B D ŒA�1 &#141;AŒ v &#141;A (2.119)
</p>
<p>Next, let L have the representation in A given below:
</p>
<p>ŒL &#141;A D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>l11 l12 � � � l1n
l21 l22 � � � l2n
:::
:::
: : :
</p>
<p>:::
</p>
<p>ln1 ln2 � � � lnn
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(2.120)
</p>
<p>Now we aim to find the relationship between ŒL &#141;A and ŒL &#141;B. To this end, let w be
the image of v under L, i.e.,
</p>
<p>Lv D w (2.121)
</p>
<p>which can be expressed in terms of either A or B as
</p>
<p>ŒL &#141;AŒ v &#141;A D Œw &#141;A (2.122)
ŒL &#141;BŒ v &#141;B D Œw &#141;B (2.123)
</p>
<p>Further, since L is an isomorphism by hypothesis, w of Eq. (2.121) lies in the same
space V as v. Hence, similar to Eq. (2.118),
</p>
<p>Œw &#141;A D ŒA &#141;AŒw &#141;B (2.124)
</p>
<p>Now, substitution of Eqs. (2.118) and (2.124) into Eq. (2.122) yields
</p>
<p>ŒA &#141;AŒw &#141;B D ŒL &#141;AŒA &#141;AŒ v &#141;B (2.125)
</p>
<p>which can be readily rearranged in the form
</p>
<p>Œw &#141;B D ŒA�1 &#141;AŒL &#141;AŒA &#141;AŒ v &#141;B (2.126)
</p>
<p>Comparing Eq. (2.123) with Eq. (2.126) readily leads to
</p>
<p>ŒL &#141;B D ŒA�1 &#141;AŒL &#141;AŒA &#141;A (2.127)</p>
<p/>
</div>
<div class="page"><p/>
<p>2.6 Similarity Transformations 73
</p>
<p>which upon rearrangement, becomes
</p>
<p>ŒL &#141;A D ŒA&#141;AŒL &#141;BŒA�1 &#141;A (2.128)
</p>
<p>Now, paraphrasing Theorems 2.5.2 and 2.5.4, we can state
</p>
<p>Theorem 2.6.1. The representations of A carrying A into B in these two frames
</p>
<p>are identical, i.e.,
</p>
<p>ŒA &#141;A D ŒA &#141;B (2.129)
</p>
<p>Proof. Substitute L for A in Eq. (2.127) to obtain the above relation, q.e.d.
Relations (2.118), (2.119), (2.127), and (2.128) constitute what are called
</p>
<p>similarity transformations. These are important because they preserve invariant
quantities such as the eigenvalues and eigenvectors of matrices, the magnitudes of
vectors, the angles between vectors, and so on. Indeed, one has:
</p>
<p>Theorem 2.6.2. The characteristic polynomial of a given n � n matrix remains
unchanged under a similarity transformation. Moreover, the eigenvalues of two
</p>
<p>matrix representations of the same n � n linear transformation are identical, and
if Œ e &#141;B is an eigenvector of ŒL &#141;B, then under the similarity transformation (2.128),
</p>
<p>the corresponding eigenvector of ŒL &#141;A is Œ e &#141;A D ŒA &#141;AŒ e &#141;B.
Proof. From Eq. (2.11), the characteristic polynomial of ŒL &#141;B is
</p>
<p>P.�/ D det.�Œ 1 &#141;B � ŒL &#141;B/ (2.130)
</p>
<p>which can be rewritten as
</p>
<p>P.�/ � det.�ŒA�1 &#141;AŒ 1 &#141;AŒA &#141;A � ŒA�1 &#141;AŒL &#141;AŒA &#141;A/
D det.ŒA�1 &#141;A.�Œ 1 &#141;A � ŒL &#141;A/ŒA &#141;A/
D det.ŒA�1 &#141;A/det.�Œ 1 &#141;A � ŒL &#141;A/det.ŒA &#141;A/
</p>
<p>But
</p>
<p>det.ŒA�1 &#141;A/det.ŒA &#141;A/ D 1
</p>
<p>and hence, the characteristic polynomial of ŒL &#141;A is identical to that of ŒL &#141;B. Since
both representations have the same characteristic polynomial, they have the same
eigenvalues. Now, if Œ e &#141;B is an eigenvector of ŒL &#141;B associated with the eigenvalue
�, then
</p>
<p>ŒL &#141;BŒ e &#141;B D �Œ e &#141;B</p>
<p/>
</div>
<div class="page"><p/>
<p>74 2 Mathematical Background
</p>
<p>Next, Eq. (2.127) is substituted into the foregoing equation, which thus leads to
</p>
<p>ŒA�1 &#141;AŒL &#141;AŒA &#141;AŒ e &#141;B D �Œ e &#141;B
</p>
<p>Upon rearrangement, this equation becomes
</p>
<p>ŒL &#141;AŒA &#141;AŒ e &#141;B D �ŒA &#141;AŒ e &#141;B (2.131)
</p>
<p>whence it is apparent that ŒA &#141;AŒ e &#141;B is an eigenvector of ŒL &#141;A associated with the
eigenvalue �, q.e.d.
</p>
<p>Theorem 2.6.3. If ŒL &#141;A and ŒL &#141;B are related by the similarity transformation
</p>
<p>(2.127), then
</p>
<p>ŒLk &#141;B D ŒA�1 &#141;AŒLk &#141;AŒA &#141;A (2.132)
</p>
<p>for any integer k.
</p>
<p>Proof. This is done by induction. For k D 2, one has
</p>
<p>ŒL2 &#141;B � ŒA�1 &#141;AŒL &#141;AŒA &#141;AŒA�1 &#141;AŒL &#141;AŒA &#141;A
D ŒA�1 &#141;AŒL2 &#141;AŒA &#141;A
</p>
<p>Now, assume that the proposed relation holds for k D n. Then,
</p>
<p>ŒLnC1 &#141;B � ŒA�1 &#141;AŒLn &#141;AŒA &#141;AŒA�1 &#141;AŒL &#141;AŒA &#141;A
D ŒA�1 &#141;AŒLnC1 &#141;AŒA &#141;A
</p>
<p>i.e., the relation holds for k D nC 1 as well, thereby completing the proof.
Theorem 2.6.4. The trace of a n � n matrix does not change under a similarity
transformation.
</p>
<p>Proof. A preliminary relation will be needed: Let ŒA &#141;; ŒB &#141; and ŒC &#141; be three
different n � n matrix arrays, in a given reference frame, that need not be indicated
with any subscript. Moreover, let aij ; bij , and cij be the components of the said
arrays, with indices ranging from 1 to n. Hence, using standard index notation,
</p>
<p>tr.ŒA &#141; ŒB &#141; ŒC &#141;/ � aij bjkcki D bjkckiaij � tr.ŒB &#141; ŒC &#141; ŒA &#141;/ (2.133)
</p>
<p>Taking the trace of both sides of Eq. (2.127) and applying the foregoing result
produces
</p>
<p>tr.ŒL &#141;B/ D tr.ŒA�1 &#141;AŒL &#141;AŒA &#141;A/ D tr.ŒA &#141;AŒA�1 &#141;AŒL &#141;A/ D tr.ŒL &#141;A/
(2.134)
</p>
<p>thereby proving that the trace remains unchanged under a similarity transformation.
</p>
<p>Example 2.6.1. We consider the equilateral triangle sketched in Fig. 2.7, of side
length equal to 2, with vertices P1, P2, and P3, and coordinate frames A and B of</p>
<p/>
</div>
<div class="page"><p/>
<p>2.6 Similarity Transformations 75
</p>
<p>Fig. 2.7 Two coordinate
frames used to represent the
position vectors of the corners
of an equilateral triangle
</p>
<p>axes X , Y and X 0, Y 0, respectively, both with origin at the centroid of the triangle.
Let P be a 2 � 2 matrix defined by
</p>
<p>P D
�
</p>
<p>p1 p2
�
</p>
<p>with pi denoting the position vector of Pi in a given coordinate frame. Show that
matrix P does not obey a similarity transformation upon a change of frame, and
compute its trace in frames A and B to make it apparent that this matrix does not
comply with the conditions of Theorem 2.6.4.
</p>
<p>Solution: From the figure it is apparent that
</p>
<p>ŒP &#141;A D
�
</p>
<p>1 0
</p>
<p>�
p
3=3 2
</p>
<p>p
3=3
</p>
<p>�
</p>
<p>; ŒP &#141;B D
�
</p>
<p>0 1
</p>
<p>�2
p
3=3
p
3=3
</p>
<p>�
</p>
<p>Apparently,
</p>
<p>tr.ŒP &#141;A/ D 1C
2
p
3
</p>
<p>3
&curren; tr.ŒP &#141;B/ D
</p>
<p>p
3
</p>
<p>3
</p>
<p>The reason why the trace of this matrix did not remain unchanged under a coordinate
transformation is that the matrix does not obey a similarity transformation under a
change of coordinates. Indeed, vectors pi change as
</p>
<p>Œpi &#141;A D ŒQ &#141;AŒpi &#141;B
</p>
<p>under a change of coordinates from B to A, with Q denoting the rotation carrying
A into B. Hence,
</p>
<p>ŒP &#141;A D ŒQ &#141;AŒP &#141;B</p>
<p/>
</div>
<div class="page"><p/>
<p>76 2 Mathematical Background
</p>
<p>which is different from the similarity transformation of Eq. (2.128). However, if we
now define
</p>
<p>R � PPT
</p>
<p>then
</p>
<p>ŒR &#141;A D
�
</p>
<p>1 �
p
3=3
</p>
<p>�
p
3=3 5=3
</p>
<p>�
</p>
<p>; ŒR &#141;B D
�
</p>
<p>1
p
3=3p
</p>
<p>3=3 5=3
</p>
<p>�
</p>
<p>and hence,
</p>
<p>tr.ŒR &#141;A/ D tr.ŒR &#141;B/ D
8
</p>
<p>3
</p>
<p>thereby showing that the trace of R does not change under a change of frame.
In order to verify whether matrix R complies with the conditions of Theorem 2.6.4,
we notice that, under a change of frame, matrix R changes as
</p>
<p>ŒR &#141;A D ŒPPT &#141;A D Œ ŒQ &#141;AŒP &#141;B.ŒQ &#141;AŒP &#141;B/T D ŒQ &#141;AŒPPT &#141;BŒQT &#141;A&#141;
</p>
<p>which is indeed a similarity transformation.
</p>
<p>2.7 Invariance Concepts
</p>
<p>From Example 2.6.1 it is apparent that certain properties, like the trace of certain
square matrices, do not change under a coordinate transformation. For this reason,
a matrix like R of that example is said to be frame-invariant, or simply invariant,
whereas matrix P of the same example is not. In this section, we formally define the
concept of invariance and highlight its applications and its role in robotics. Let a
scalar, a vector, and a matrix function of the position vector p be denoted by f .p/,
f.p/ and F.p/, respectively. The representations of f.p/ in two different coordinate
frames, labelled A and B, will be indicated as Œf.p/&#141;A and Œf.p/&#141;B, respectively,
with a similar notation for the representations of F.p/. Moreover, let the two frames
differ both in the location of their origins and in their orientations. Additionally,
let the proper orthogonal matrix ŒQ&#141;A denote the rotation of coordinate frame A
into B. Then, the scalar function f .p/ is said to be frame invariant, or invariant for
brevity, if
</p>
<p>f .Œp&#141;B/ D f .Œp&#141;A/ (2.135)
</p>
<p>Moreover, the vector quantity f is said to be invariant if
</p>
<p>Œf&#141;A D ŒQ&#141;AŒf&#141;B (2.136)</p>
<p/>
</div>
<div class="page"><p/>
<p>2.7 Invariance Concepts 77
</p>
<p>and finally, the matrix quantity F is said to be invariant if
</p>
<p>ŒF&#141;A D ŒQ&#141;AŒF&#141;BŒQT &#141;A (2.137)
</p>
<p>Thus, the difference in origin location becomes irrelevant in this context, and
hence, will no longer be considered. From the foregoing discussion, it is clear that
the same vector quantity has different components in different coordinate frames;
moreover, the same matrix quantity has different entries in different coordinate
frames. However, certain scalar quantities associated with vectors, e.g., the inner
product, and matrices, e.g., the matrix moments, to be defined presently, remain
unchanged under a change of frame. Additionally, such vector operations as the
cross product of two vectors are invariant. In fact, the scalar product of two vectors
a and b remains unchanged under a change of frame, i.e.,
</p>
<p>Œ a &#141;TA Œ b &#141;A D Œ a &#141;TB Œb &#141;B (2.138)
</p>
<p>Additionally,
</p>
<p>Œ a � b &#141;A D ŒQ &#141;A Œ a � b &#141;B (2.139)
</p>
<p>The kth moment of a n � n matrix T, denoted by Ik , is defined as (Leigh 1968)
</p>
<p>Ik � tr.Tk/; k D 0; 1; : : : (2.140)
</p>
<p>where I0 D tr.1/ D n. Now we have
Theorem 2.7.1. The moments of a n � n matrix are invariant under a similarity
transformation.
</p>
<p>Proof. This is straightforward. Indeed, from Theorem 2.6.3, we have
</p>
<p>ŒTk &#141;B D ŒA�1 &#141;AŒTk &#141;AŒA &#141;A (2.141)
</p>
<p>Now, let Œ Ik &#141;A and Œ Ik &#141;B denote the kth moment of ŒT &#141;A and ŒT &#141;B, respectively.
Thus,
</p>
<p>Œ Ik &#141;B D tr.ŒA�1 &#141;AŒTk &#141;AŒA &#141;A/ � tr.ŒA &#141;AŒA�1 &#141;AŒTk &#141;A/
D tr.ŒTk &#141;A/ � Œ Ik &#141;A
</p>
<p>thereby completing the proof.
</p>
<p>Furthermore,
</p>
<p>Theorem 2.7.2. A n � n matrix has only n linearly independent moments.
Proof. Let the characteristic polynomial of T be
</p>
<p>P.�/ D a0 C a1�C � � � C an�1�n�1 C �n D 0 (2.142)</p>
<p/>
</div>
<div class="page"><p/>
<p>78 2 Mathematical Background
</p>
<p>Upon application of the Cayley&ndash;Hamilton Theorem, Eq. (2.142) leads to
</p>
<p>a01C a1TC � � � C an�1Tn�1 C Tn D 0 (2.143)
</p>
<p>where 1 denotes the n � n identity matrix.
Now, if we take the trace of both sides of Eq. (2.143), and Definition (2.140) is
</p>
<p>recalled, one has
</p>
<p>a0I0 C a1I1 C � � � C an�1In�1 C In D 0 (2.144)
</p>
<p>from which it is apparent that In can be expressed as a linear combination of the first
nmoments of T, f Ik gn�10 . By simple induction, one can likewise prove that themth
moment is dependent upon the first n moments if m � n, thereby completing the
proof. Also notice that I0 D n, and hence, all n � n matrices share the same zeroth
moment I0.
</p>
<p>The vector invariants of a n � n matrix are its eigenvectors, which have a direct
geometric significance in the case of symmetric matrices. The eigenvalues of these
matrices are all real, its eigenvectors being also real and mutually orthogonal.
Skew-symmetric matrices, in general, need not have either real eigenvalues or real
eigenvectors. However, if we limit ourselves to 3 � 3 skew-symmetric matrices,
exactly one of their eigenvalues, and its associated eigenvector, are both real.
The eigenvalue of interest is 0, and the associated vector is the axial vector of the
matrix under study.
</p>
<p>It is now apparent that two n � n matrices related by a similarity transformation
have the same set of moments. Now, by virtue of Theorem 2.7.2, one may be
tempted to think that if two n � n matrices share their first n moments f Ik gn�10 ,
then the two matrices are related by a similarity transformation. To prove that this
is not the case, let two n� n matrices A and B have characteristic polynomials with
coefficients fakgn�1 and fbkgn�10 , respectively, the two sets being not necessarily
identical. Moreover, let the n C 1 moments of A and B be denoted by fIkgn0 and
fI 0kgn0 , with
</p>
<p>I0 D I 00 D n; Ik D I 0k ; for k D 1; : : : ; n � 1
</p>
<p>Hence, from Eq. (2.144),
</p>
<p>In D �.a0nC a1I1 C � � � C an�1In�1/
I 0n D �.b0nC b1I1 C � � � C bn�1In�1/
</p>
<p>Therefore, in spite of Theorem 2.7.2, two n � n matrices with identical moments
Ik D I 0k , for k D 1; : : : ; n � 1 may still have In &curren; I 0n if these matrices are
not related by a similarity transformation, and hence, have distinct characteristic
polynomials. We thus have</p>
<p/>
</div>
<div class="page"><p/>
<p>2.7 Invariance Concepts 79
</p>
<p>Theorem 2.7.3. Two n � n matrices are related by a similarity transformation if
and only if their n moments fIkgn1 are identical.
Hence,
</p>
<p>Corollary 2.7.1. If two n� n matrices share the same n moments fIkgn1 , then their
characteristic polynomials are identical.
</p>
<p>Consider the two matrices A and B given below:
</p>
<p>A D
�
</p>
<p>1 0
</p>
<p>0 1
</p>
<p>�
</p>
<p>; B D
�
</p>
<p>1 2
</p>
<p>2 1
</p>
<p>�
</p>
<p>The two foregoing matrices cannot possibly be related by a similarity transforma-
tion, for the first one is the identity matrix, while the second is not. However, the
two matrices share the two moments I0 D 2 and I1 D 2. Let us now compute the
second moments of these matrices:
</p>
<p>tr.A2/ D 2; tr.B2/ D tr
�
</p>
<p>5 4
</p>
<p>4 5
</p>
<p>�
</p>
<p>D 10
</p>
<p>which are indeed different. Therefore, to test whether two different n � n matrices
represent the same linear transformation, and hence, are related by a similarity
transformation, we must verify that they share the same set of nC1moments f Ik gn0 .
In fact, since all n� n matrices share the same zeroth moment, only the n moments
f Ik gn1 need be tested for similarity verification. That is, if two n� n matrices share
the same n moments f Ik gn1 , then they represent the same linear transformation,
albeit in different coordinate frames.
</p>
<p>The foregoing discussion does not apply, in general, to nonsymmetric matrices,
for these matrices are not fully characterized by their eigenvalues. For example,
consider the matrix
</p>
<p>A D
�
</p>
<p>1 1
</p>
<p>0 1
</p>
<p>�
</p>
<p>) A2 D
�
</p>
<p>1 2
</p>
<p>0 1
</p>
<p>�
</p>
<p>Its two moments of interest are I1 D tr.A/ D 2, I2 D 2, which happen to be the
corresponding moments of the 2 � 2 identity matrix as well. However, while the
identity matrix leaves all two-dimensional vectors unchanged, matrix A does not.
</p>
<p>Now, if two symmetric matrices, say A and B, represent the same transformation,
they are related by a similarity transformation, i.e., a nonsingular matrix T exists
such that
</p>
<p>B D T�1AT
</p>
<p>Given A and T, then, finding B is trivial, a similar statement holding if B and
T are given; however, if A and B are given, finding T is more difficult. The latter
problem occurs sometimes in robotics in the context of calibration, to be discussed
in Sect. 2.7.1.</p>
<p/>
</div>
<div class="page"><p/>
<p>80 2 Mathematical Background
</p>
<p>Example 2.7.1. Two symmetric matrices are displayed below. Find out whether
they are related by a similarity transformation.
</p>
<p>A D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 1
</p>
<p>0 1 0
</p>
<p>1 0 2
</p>
<p>3
</p>
<p>5 ; B D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 2 �1
0 �1 1
</p>
<p>3
</p>
<p>5
</p>
<p>Solution: The traces of the two matrices are apparently identical, namely, 4. Now
we have to verify whether their second and third moments are also identical. To do
this, we need the square and the cube of the two matrices, from which we then
compute their traces. Thus, from
</p>
<p>A2 D
</p>
<p>2
</p>
<p>4
</p>
<p>2 0 3
</p>
<p>0 1 0
</p>
<p>3 0 5
</p>
<p>3
</p>
<p>5 ; B2 D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 5 �3
0 �3 2
</p>
<p>3
</p>
<p>5
</p>
<p>we readily obtain
</p>
<p>tr.A2/ D tr.B2/ D 8
</p>
<p>Moreover,
</p>
<p>A3 D
</p>
<p>2
</p>
<p>4
</p>
<p>5 0 8
</p>
<p>0 1 0
</p>
<p>8 0 13
</p>
<p>3
</p>
<p>5 ; B3 D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 13 �8
0 �8 5
</p>
<p>3
</p>
<p>5
</p>
<p>whence
</p>
<p>tr.A3/ D tr.B3/ D 19
</p>
<p>Therefore, the two matrices are related by a similarity transformation. Hence, they
represent the same linear transformation.
</p>
<p>Example 2.7.2. Same as Example 2.7.1, for the two matrices displayed below:
</p>
<p>A D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 2
</p>
<p>0 1 0
</p>
<p>2 0 0
</p>
<p>3
</p>
<p>5 ; B D
</p>
<p>2
</p>
<p>4
</p>
<p>1 1 1
</p>
<p>1 1 0
</p>
<p>1 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>Solution: As in the previous example, the traces of these matrices are identical,
i.e., 2. However, tr.A2/ D 10, while tr.B2/ D 6. We thus conclude that the two
matrices cannot be related by a similarity transformation.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.7 Invariance Concepts 81
</p>
<p>2.7.1 Applications to Redundant Sensing
</p>
<p>A sensor, such as a camera or a range finder, is often mounted on a robotic end-
effector to determine the pose&mdash;i.e., the position and orientation, as defined in
Sect. 3.2.3&mdash;of an object. If two redundant sensors are introduced, and we attach
frames A and B to each of these, then each sensor can be used to determine the
orientation of the end-effector with respect to a reference pose. This is a simple
task, for all that is needed is to measure the rotation R that each of the foregoing
frames underwent from the reference pose, in which these frames are denoted by A0
and B0, respectively. Let us assume that these measurements produce the orthogonal
matrices A and B, representing R in A and B, respectively. With this information
we would like to determine the relative orientation Q of frame B with respect to
frame A, a problem that is called here instrument calibration.
</p>
<p>We thus have A � ŒR &#141;A and B � ŒR &#141;B, and hence, the algebraic problem
at hand consists in determining ŒQ &#141;A or equivalently, ŒQ &#141;B. The former can be
obtained from the similarity transformation of Eq. (2.137), which leads to
</p>
<p>A D ŒQ &#141;A BŒQT &#141;A
</p>
<p>or
</p>
<p>A ŒQ &#141;A D ŒQ &#141;A B
</p>
<p>This problem could be solved if we had three invariant vectors associated with
each of the two matrices A and B. Then, each corresponding pair of vectors of these
triads would be related by Eq. (2.136), thereby obtaining three such vector equations
that should be sufficient to compute the nine components of the matrix Q rotating
frame A into B. However, since A and B are orthogonal matrices, they admit only
one real invariant vector, namely, their axial vector, and we are short of two vector
equations. We thus need two more invariant vectors, represented in both A and B, to
determine Q. The obvious way of obtaining one additional vector in each frame is
to take not one, but two measurements of the orientation of A0 and B0 with respect
to A and B, respectively. Let the matrices representing these orientations be given,
in each of the two coordinate frames, by Ai and Bi , for i D 1; 2. Moreover, let ai
and bi , for i D 1; 2, be the axial vectors of matrices Ai and Bi , respectively.
</p>
<p>Now, if none of a1 and a2 vanishes, and the two vectors are linearly independent,
a third vector can be obtained out of each pair, namely,
</p>
<p>a3 D a1 � a2; b3 D b1 � b2 (2.145)
</p>
<p>If one of the vectors of the two pairs vanishes, we have two more possibilities,
namely, the angle of rotation of that orthogonal matrix, A1 or A2, whose axial vector
vanishes is either 0 or � . If the foregoing angle vanishes, then A underwent a
pure translation from A0, the same holding, of course, for B and B0. This means</p>
<p/>
</div>
<div class="page"><p/>
<p>82 2 Mathematical Background
</p>
<p>that the corresponding measurement becomes useless for our purposes, and a new
measurement is needed, involving a rotation. If, on the other hand, the same angle
is � , then the associated rotation is symmetric and the unit vector e parallel to its
axis can be determined from Eq. (2.50) in both A and B. This unit vector, then,
would play the role of the vanishing axial vector, and we would thus end up, in
any event, with two pairs of nonzero vectors, fai g21 and fbi g21. Moreover, the pairs
can be linearly dependent while none of its two vectors vanishes and the vectors
are distinct. This is possible if the two rotations take place about the same axis but
through distinct angles. In this case, the second rotation becomes useless, should be
rejected, and a new second rotation must be taken. In conclusion, we can always
find two triads of nonzero vectors, f ai g31 and fbi g31, that are related by
</p>
<p>ai D ŒQ &#141;A bi ; for i D 1; 2; 3 (2.146)
</p>
<p>The problem at hand now reduces to computing ŒQ &#141;A from Eq. (2.146). In order
to perform this computation, we write the three foregoing equations in matrix form,
namely,
</p>
<p>E D ŒQ &#141;A F (2.147)
</p>
<p>with E and F defined as
</p>
<p>E �
�
</p>
<p>a1 a2 a3
�
</p>
<p>; F �
�
</p>
<p>b1 b2 b3
�
</p>
<p>(2.148)
</p>
<p>Now, by virtue of the form in which the two vector triads were defined, none of the
two above matrices is singular, and hence, we have
</p>
<p>ŒQ &#141;A D EF�1 (2.149)
</p>
<p>Moreover, note that the inverse of F can be expressed in terms of its columns
explicitly, without introducing components, if the concept of reciprocal bases is
recalled (Brand 1965). Thus,
</p>
<p>F�1 D 1
&#129;
</p>
<p>2
</p>
<p>4
</p>
<p>.b2 � b3/T
</p>
<p>.b3 � b1/T
</p>
<p>.b1 � b2/T
</p>
<p>3
</p>
<p>5 ; &#129; � b1 � b2 � b3 (2.150)
</p>
<p>Therefore,
</p>
<p>ŒQ &#141;A D
1
</p>
<p>&#129;
Œa1.b2 � b3/T C a2.b3 � b1/T C a3.b1 � b2/T &#141; (2.151)
</p>
<p>thereby completing the computation of ŒQ &#141;A directly and with simple vector
operations.</p>
<p/>
</div>
<div class="page"><p/>
<p>2.7 Invariance Concepts 83
</p>
<p>Fig. 2.8 Measuring the orientation of a camera-fixed coordinate frame with respect to a frame
fixed to a robotic end-effector
</p>
<p>Example 2.7.3 (Hand&ndash;Eye Calibration). Determine the relative orientation of a
frame B attached to a camera mounted on a robot end-effector, with respect to a
frame A fixed to the latter, as shown in Fig. 2.8. It is assumed that two measurements
of the orientation of the two frames with respect to frames A0 and B0 in the reference
configuration of the end-effector are available. These measurements produce the
orientation matrices Ai of the frame fixed to the camera and Bi of the frame fixed to
the end-effector, for i D 1; 2. The numerical data of this example are given below:
</p>
<p>A1 D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:92592593 �0:37037037 �0:07407407
0:28148148 �0:80740741 0:51851852
�0:25185185 0:45925926 0:85185185
</p>
<p>3
</p>
<p>5
</p>
<p>A2 D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:83134406 0:02335236 �0:55526725
�0:52153607 0:31240270 0:79398028
0:19200830 0:94969269 �0:24753503
</p>
<p>3
</p>
<p>5
</p>
<p>B1 D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:90268482 0:10343126 �0:41768659
0:38511568 0:62720266 �0:67698060
0:19195318 �0:77195777 �0:60599932
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>84 2 Mathematical Background
</p>
<p>B2 D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:73851280 �0:54317226 0:39945305
�0:45524951 0:83872293 0:29881721
�0:49733966 0:03882952 �0:86668653
</p>
<p>3
</p>
<p>5
</p>
<p>Solution: Shiu and Ahmad (1987) formulated this problem in the form of a
matrix linear homogeneous equation, while Chou and Kamel (1988) solved the
same problem using quaternions and very cumbersome numerical methods that
involve singular-value computations. The latter require an iterative procedure within
a Newton&ndash;Raphson method, itself iterative, for nonlinear-equation solving. Other
attempts to solve the same problem have been reported in the literature, but these
also resorted to extremely complicated numerical procedures for nonlinear-equation
solving (Chou and Kamel 1991; Horaud and Dornaika 1995). The latter proposed
a more concise method based on quaternions&mdash;isomorphic to the Euler&ndash;Rodrigues
parameters&mdash;that nevertheless is still computationally expensive.
</p>
<p>More recently, Daniilidis (1999) proposed an algorithm based on dual quater-
nions to simultaneously estimate the relative pose of the two frames of interest.
In this book we do not study either quaternions&mdash;at least, not by this name&mdash;or
dual algebra; the former are, in fact, isomorphic to the Euler&ndash;Rodrigues parameters
of a rotation, which were introduced in Sect. 2.3.6. Dual algebra, in turn, is
used to manipulate scalars, vectors and matrices comprising one rotation and one
translation, or their statics counterparts, one moment and one force (Angeles 1988).
In the above reference, Daniilidis resorts to the singular-value decomposition to find
the relative pose in question, but this decomposition slows down the computational
procedure. Angeles et al. (2000), in turn, proposed an alternative approach based
on the invariance concepts introduced in this section, that leads to an algorithm
involving only linear equations. This algorithm, moreover, relies on recursive least-
square computations, thereby doing away with singular-value computations and
allowing for real-time performance. This reference and (Daniilidis 1999) report
experimental results.
</p>
<p>First, the vector of matrix Ai , represented by ai , and the vector of matrix Bi ,
represented by bi , for i D 1; 2, are computed from simple differences of the off-
diagonal entries of the foregoing matrices, followed by a division by 2 of all the
entries thus resulting, which yields
</p>
<p>a1 D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:02962963
0:08888889
</p>
<p>0:32592593
</p>
<p>3
</p>
<p>5 ; a2 D
</p>
<p>2
</p>
<p>4
</p>
<p>0:07784121
</p>
<p>�0:37363778
�0:27244422
</p>
<p>3
</p>
<p>5
</p>
<p>b1 D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:04748859
�0:30481989
0:14084221
</p>
<p>3
</p>
<p>5 ; b2 D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:12999385
0:44869636
</p>
<p>0:04396138
</p>
<p>3
</p>
<p>5
</p>
<p>In the calculations below, 16 digits were used, but only eight are displayed.
Furthermore, with the foregoing vectors, we compute a3 and b3 from cross products,</p>
<p/>
</div>
<div class="page"><p/>
<p>2.8 Exercises 85
</p>
<p>thus obtaining
</p>
<p>a3 D
</p>
<p>2
</p>
<p>4
</p>
<p>0:09756097
</p>
<p>0:01730293
</p>
<p>0:00415020
</p>
<p>3
</p>
<p>5
</p>
<p>b3 D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:07655343
�0:01622096
�0:06091842
</p>
<p>3
</p>
<p>5
</p>
<p>Furthermore, &#129; is obtained as
</p>
<p>&#129; D 0:00983460
</p>
<p>while the individual rank-one matrices inside the brackets of Eq. (2.151) are
calculated as
</p>
<p>a1.b2 � b3/T D
</p>
<p>2
</p>
<p>4
</p>
<p>0:00078822 0:00033435 �0:00107955
�0:00236467 �0:00100306 0:00323866
�0:00867044 �0:00367788 0:01187508
</p>
<p>3
</p>
<p>5
</p>
<p>a2.b3 � b1/T D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:00162359 0:00106467 0:00175680
0:00779175 �0:00510945 �0:00843102
0:00568148 �0:00372564 �0:00614762
</p>
<p>3
</p>
<p>5
</p>
<p>a3.b1 � b2/T D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:00746863 �0:00158253 �0:00594326
�0:00132460 �0:00028067 �0:00105407
�0:00031771 �0:00006732 �0:00025282
</p>
<p>3
</p>
<p>5
</p>
<p>whence Q in the A frame is readily obtained as
</p>
<p>ŒQ &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:84436553 �0:01865909 �0:53545750
0:41714750 �0:65007032 �0:63514856
�0:33622873 �0:75964911 0:55667078
</p>
<p>3
</p>
<p>5
</p>
<p>thereby completing the desired computation.
</p>
<p>2.8 Exercises
</p>
<p>N.B.: Unless either a numerical result is required or you are instructed to do
</p>
<p>otherwise, do not resort to components in the exercises below.
</p>
<p>2.1 Prove that the range and the null space of any linear transformation L of vector
space U into vector space V are vector spaces as well, the former of V , the
latter of U .</p>
<p/>
</div>
<div class="page"><p/>
<p>86 2 Mathematical Background
</p>
<p>2.2 Let L map U into V and dimfUg D n, dimfVg D m. Moreover, let R and N be
the range and the null space of L, their dimensions being � and �, respectively.
Show that �C � D n.
</p>
<p>2.3 Given two arbitrary nonzero vectors u and v in E3, find the matrix P
representing the projection of E3 onto the subspace spanned by u and v.
</p>
<p>2.4 Verify that P, whose matrix representation in a certain coordinate system is
given below, is a projection. Then, describe it geometrically, i.e., identify the
plane onto which the projection takes place. Moreover, find the null space
of P.
</p>
<p>ŒP &#141; D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>2 1 �1
1 2 1
</p>
<p>�1 1 2
</p>
<p>3
</p>
<p>5
</p>
<p>2.5 If for any three-dimensional vectors a and v, matrix A is defined as
</p>
<p>A � @.a � v/
@v
</p>
<p>then we have
</p>
<p>AT � @.v � a/
@v
</p>
<p>Show that A is skew-symmetric without introducing components.
2.6 Let u and v be any three-dimensional vectors, and define T as
</p>
<p>T � 1C uvT
</p>
<p>The (unit) eigenvectors of T are denoted by w1, w2, and w3. Show that, say, w1
and w2 are any unit vectors perpendicular to v and different from each other,
whereas w3 D u=kuk. Also show that the corresponding eigenvalues, denoted
by �1, �2, and �3, associated with w1, w2, and w3, respectively, are given as
</p>
<p>�1 D �2 D 1; �3 D 1C u � v
</p>
<p>2.7 Show that if u and v are any three-dimensional vectors, then
</p>
<p>det.1C uvT / D 1C u � v
</p>
<p>Hint: Use the results of the Exercise 2.6.
2.8 For the two unit vectors e and f in three-dimensional space, define the two
</p>
<p>reflections
</p>
<p>R1 D 1 � 2eeT ; R2 D 1 � 2f fT</p>
<p/>
</div>
<div class="page"><p/>
<p>2.8 Exercises 87
</p>
<p>Now, show that Q D R1R2 is a rigid-body rotation, and find its axis and its
angle of rotation in terms of unit vectors e and f. Again, no components are
permitted in this exercise.
</p>
<p>2.9 State the conditions on the unit vectors e and f, of two reflections R1 and
R2, respectively, under which a given rotation Q can be factored into the
reflections R1 and R2 given in the foregoing exercise. In other words, not
every rotation matrix Q can be factored into those two reflections, for fixed e
and f, but special cases can. Identify these cases.
</p>
<p>2.10 For given three-dimensional, non-zero a and b, find v that verifies
</p>
<p>vC a � v D b
</p>
<p>When finding an expression for v in terms of a and b, answer the questions
below:
</p>
<p>(a) Is it possible to find v for arbitrary a and b? If so, find an expression for v.
(b) Can v be orthogonal to a? If so, under which conditions?
(c) Can v be orthogonal to b? If so, under which conditions?
</p>
<p>2.11 Prove that the eigenvalues of the cross-product matrix of the unit vector e are
0, j , and �j , where j D
</p>
<p>p
�1. Then show that the eigenvectors associated
</p>
<p>with the complex eigenvalues are both complex mutually orthogonal vectors,
and find expressions thereof in terms of e. Note: Given two n-dimensional
vectors u and v defined over the complex field, their scalar product is defined
</p>
<p>as u�v, where u� stands for the transpose conjugate of u.
2.12 Prove that the eigenvalues of a proper orthogonal matrix Q are 1, ej� , and
</p>
<p>e�j� , with � denoting the angle of rotation. Hint: Use the result of the
foregoing exercise and the Cayley&ndash;Hamilton Theorem.
</p>
<p>2.13 Find the axis and the angle of rotation of the proper orthogonal matrix Q given
below in a certain coordinate frame F .
</p>
<p>ŒQ &#141;F D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>�1 �2 2
�2 �1 �2
2 �2 �1
</p>
<p>3
</p>
<p>5
</p>
<p>2.14 Prove that the vect. � / and the tr. � / operators are linear homogeneous, i.e.,
that vect.˛A C ˇB/ D ˛vect.A/ C ˇvect.B/, with a similar expression for
tr.˛AC ˇB/.
</p>
<p>2.15 Cayley&rsquo;s Theorem, which is not to be confused with the Theorem of Cayley&ndash;
Hamilton, states that every 3 � 3 proper orthogonal matrix Q can be uniquely
factored as
</p>
<p>Q D .1 � S/.1C S/�1
</p>
<p>where S is a skew-symmetric matrix. Find a general expression for S in terms
of Q, and state the condition under which this factoring is not possible.</p>
<p/>
</div>
<div class="page"><p/>
<p>88 2 Mathematical Background
</p>
<p>2.16 Find matrix S of Cayley&rsquo;s factoring for Q as given in Exercise 2.13.
2.17 If Q represents a rotation about an axis parallel to the unit vector e through an
</p>
<p>angle �, then the Rodrigues vector � of this rotation can be defined as
</p>
<p>� � tan
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>e
</p>
<p>Note that if r and r0 denote the Euler&ndash;Rodrigues parameters of the rotation
under study, then � D r=r0. Show that
</p>
<p>� D �vect(S)
</p>
<p>for S given in Exercise 2.15.
2.18 The vertices of a cube, labeled A, B , : : :, H , are located so that A, B , C ,
</p>
<p>and D, as well as E, F , G, and H , are in clockwise order when viewed from
outside. Moreover, AE, BH , CG, and DF are edges of the cube, which is to
be manipulated so that a mapping of vertices takes place as indicated below:
</p>
<p>A! D; B ! C; C ! G; D ! F
E ! A; F ! E; G ! H; H ! B
</p>
<p>Find the angle of rotation and the angles that the axis of rotation makes with
edges AB , AD, and AE.
</p>
<p>2.19 (Euler angles) A rigid body can attain an arbitrary configuration starting from
any reference configuration, 0, by means of the composition of three rotations
about coordinate axes, as described below: Attach axes X0, Y0, and Z0 to
the body in the reference configuration and rotate the body through an angle �
aboutZ0, thus carrying the axes intoX1, Y1, andZ1 (=Z0), respectively. Next,
rotate the body through an angle � about axis Y1, thus carrying the axes into
X2, Y2, andZ2, respectively. Finally, rotate the body through an angle  about
Z2 so that the axes coincide with their desired final orientation, X3, Y3, and
Z3. Angle  is chosen so that axis Z3 lies in the plane of Z0 and X1, whereas
angle � is chosen so as to carry axis Z1 (=Z0) into Z3 (=Z2). Show that the
rotation matrix carrying the body from configuration 0 to configuration 3 is:
</p>
<p>Q D
</p>
<p>2
</p>
<p>4
</p>
<p>c�c�c � s�s �c�c�s � s�c s�c�
c�s�c C c�s �c�s�s C c�c s�s�
�s�c s�s c�
</p>
<p>3
</p>
<p>5
</p>
<p>where c.�/ and s.�/ stand for cos.�/ and sin.�/, respectively. Moreover, show
that ˛, the angle of rotation of Q given above, obeys the relation
</p>
<p>cos
�˛
</p>
<p>2
</p>
<p>�
</p>
<p>D cos
�
 C �
2
</p>
<p>�
</p>
<p>cos
</p>
<p>�
�
</p>
<p>2
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>2.8 Exercises 89
</p>
<p>Hint: Let Ri be the rotation carrying frame
3 Fi�1 into Fi , for i D 1; 2; 3.
</p>
<p>Then, the total rotation carrying F0 into F3 can be found to be R1R2R3,
</p>
<p>provided that all three rotation matrices are given in the same frame. However,
</p>
<p>each Ri admits a simple representation, in canonical form, in Fi�1. Hence, to
represent Ri , for i D 2; 3, in F0, a similarity transformation &aacute;la Eqs. (2.127)
and (2.128) is needed.
</p>
<p>2.20 Given an arbitrary rigid-body rotation about an axis parallel to the unit vector e
through an angle �, it is possible to find both e and � using the linear invariants
of the rotation matrix, as long as the vector invariant does not vanish. The latter
happens if and only if � D 0 or � . Now, if � D 0, the associated rotation
matrix is the identity, and e is any three-dimensional vector; if � D � , then
we have
</p>
<p>Q.�/ � Q� D �1C 2eeT
</p>
<p>whence we can solve for eeT as
</p>
<p>eeT D 1
2
.Q� C 1/
</p>
<p>Now, it is apparent that the three eigenvalues of Q� are real and the associated
eigenvectors are mutually orthogonal. Find these.
</p>
<p>2.21 Explain why all the off-diagonal entries of a symmetric rotation matrix cannot
be negative.
</p>
<p>2.22 The three entries above the diagonal of a 3 � 3 matrix Q that is supposed to
represent a rotation are given below:
</p>
<p>q12 D
1
</p>
<p>2
; q13 D �
</p>
<p>2
</p>
<p>3
; q23 D
</p>
<p>3
</p>
<p>4
</p>
<p>Without knowing the other entries, explain why the above entries are unac-
ceptable.
</p>
<p>2.23 Let p1, p2, and p3 be the position vectors of three arbitrary points in three-
dimensional space. Now, define a matrix P as
</p>
<p>P �
�
</p>
<p>p1 p2 p3
�
</p>
<p>Show that P is not frame-invariant. Hint: Show, for example, that it is always
possible to find a coordinate frame in which tr.P/ vanishes. This task will be
eased if you represent the position vectors of the three points in a suitable
</p>
<p>coordinate frame in which a few of their coordinates will vanish.
</p>
<p>2.24 For P defined as in Exercise 2.23, let
</p>
<p>q � tr.P2/ � tr2.P/
</p>
<p>3Fi is obviously frame Xi ; Yi ; Zi .</p>
<p/>
</div>
<div class="page"><p/>
<p>90 2 Mathematical Background
</p>
<p>ba
</p>
<p>Fig. 2.9 A cube in two different configurations
</p>
<p>Show that q vanishes if the three given points and the origin are collinear, for
P represented in any coordinate frame.
</p>
<p>2.25 For P defined, again, as in Exercise 2.23, show that PPT is invariant under
frame-rotations about the origin, and becomes singular if and only if either
the three given points are collinear or the origin lies in the plane of the three
points. Note that this matrix is more singularity-robust than P.
</p>
<p>2.26 The diagonal entries of a rotation matrix are known to be �0:5, 0:25, and
�0:75. Find the off-diagonal entries.
</p>
<p>2.27 As a generalization to the foregoing exercise, discuss how you would go about
finding the off-diagonal entries of a rotation matrix whose diagonal entries are
known to be a, b, and c. Hint: This problem can be formulated as finding
the intersection of the coupler curve of a four-bar spherical linkage (Chiang
</p>
<p>1988), which is a curve on a sphere, with a certain parallel of the same sphere.
</p>
<p>2.28 Shown in Fig. 2.9a is a cube that is to be displaced in an assembly operation
to a configuration in which face EFGH lies in the XY plane, as indicated in
Fig. 2.9b. Compute the unit vector e parallel to the axis of the rotation involved
and the angle of rotation �, for 0 � � � � .
</p>
<p>2.29 The axes X1, Y1, Z1 of a frame F1 are attached to the base of a robotic
manipulator, whereas the axes X2, Y2, Z2 of a second frame F2 are attached
to its end-effector, as shown in Fig. 2.10. Moreover, the origin P of F2 has
the F1-coordinates .1;�1; 1/. Furthermore, the orientation of the end effector
with respect to the base is defined by a rotation Q, whose representation in F1
is given by</p>
<p/>
</div>
<div class="page"><p/>
<p>2.8 Exercises 91
</p>
<p>Fig. 2.10 Robotic EE approaching a stationary object ABC
</p>
<p>ŒQ&#141;1 D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1 1 �
p
3 1C
</p>
<p>p
3
</p>
<p>1C
p
3 1 1 �
</p>
<p>p
3
</p>
<p>1 �
p
3 1C
</p>
<p>p
3 1
</p>
<p>3
</p>
<p>5
</p>
<p>(a) What are the end-effector coordinates of point C of Fig. 2.10?
(b) The end-effector is approaching the ABC plane shown in Fig. 2.10. What
</p>
<p>is the equation of the plane in end-effector coordinates? Verify your result
by substituting the answer to (a) into this equation.
</p>
<p>2.30 Shown in Fig. 2.11 is a cube of unit side, which is composed of two parts.
Frames .X0; Y0; Z0/ and .X1; Y1; Z1/ are attached to each of the two parts, as
illustrated in the figure. The second part is going to be picked up by a robotic
gripper as the part is transported on a belt conveyor and passes close to the
stationary first part. Moreover, the robot is to assemble the cube by placing
the second part onto the first one in such a way that vertices A1; B1; C1
are coincident with vertices A0; B0; C0. Determine the axis and the angle of
rotation that will carry the second part onto the first one as described above.
</p>
<p>2.31 A piece of code meant to produce the entries of rotation matrices is being
tested. In one run, the code produced a matrix with diagonal entries �0:866,
�0:866, �0:866. Explain how without looking at the other entries, you can
decide that the code has a bug.
</p>
<p>2.32 Shown in Fig. 2.12 is a rigid cube of unit side in three configurations. The
second and the third configurations are to be regarded as images of the first</p>
<p/>
</div>
<div class="page"><p/>
<p>92 2 Mathematical Background
</p>
<p>Fig. 2.11 Roboticized assembly operation
</p>
<p>cba
</p>
<p>Fig. 2.12 Three configurations of a cube
</p>
<p>one. One of the last two configurations is a reflection, and the other is a rotation
of the first one. Identify the rotated configuration and find its associated
invariants.
</p>
<p>2.33 Two frames, G and C, are attached to a robotic gripper and to a camera
mounted on the gripper, respectively. Moreover, the camera is rigidly attached
to the gripper, and hence, the orientation of C with respect to G, denoted by Q,
remains constant under gripper motions. The orientation of the gripper with
respect to a frame B fixed to the base of the robot was measured in both G
and C. Note that this orientation is measured in G simply by reading the joint
encoders, which report values of the joint variables, as discussed in detail
in Chap. 4. The same orientation is measured in C from estimations of the
coordinates of a set of points fixed to B, as seen by the camera.
</p>
<p>Two measurements of the above-mentioned orientation, denoted R1 and
R2, were taken in G and C, with the numerical values reported below:
</p>
<p>ŒR1 &#141;G D
</p>
<p>2
</p>
<p>4
</p>
<p>0:667 0:333 0:667
</p>
<p>�0:667 0:667 0:333
�0:333 �0:667 0:667
</p>
<p>3
</p>
<p>5 ;</p>
<p/>
</div>
<div class="page"><p/>
<p>2.8 Exercises 93
</p>
<p>ŒR1 &#141;C D
</p>
<p>2
</p>
<p>4
</p>
<p>0:500 0 �0:866
0 1:000 0
</p>
<p>0:866 0 0:500
</p>
<p>3
</p>
<p>5 ;
</p>
<p>ŒR2 &#141;G D
</p>
<p>2
</p>
<p>4
</p>
<p>0:707 0:577 0:408
</p>
<p>0 0:577 �0:816
�0:707 0:577 0:408
</p>
<p>3
</p>
<p>5 ;
</p>
<p>ŒR2 &#141;C D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 0:346 �0:938
0 0:938 0:346
</p>
<p>3
</p>
<p>5
</p>
<p>(a) Verify that the foregoing matrices represent rotations.
(b) Verify that the first two matrices represent, in fact, the same rotation R1,
</p>
<p>albeit in different coordinate frames.
(c) Repeat item (b) for R2.
(d) Find ŒQ &#141;G . Is your computed Q orthogonal? If not, can the error be
</p>
<p>attributed to data-incompatibility? to roundoff-error amplification?
</p>
<p>2.34 The orientation of the end-effector of a given robot is to be inferred from
joint-encoder readouts, which report an orientation given by a matrix Q in
F1-coordinates, namely,
</p>
<p>ŒQ &#141;1 D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>�1 2 2
2 �1 2
2 2 �1
</p>
<p>3
</p>
<p>5
</p>
<p>(a) Show that the above matrix can indeed represent the orientation of a rigid
body.
</p>
<p>(b) What is Q in end-effector coordinates, i.e., in a frame F7, if Z7 is chosen
parallel to the axis of rotation of Q?
</p>
<p>2.35 The rotation Q taking a coordinate frame B, fixed to the base of a robot, into a
coordinate frame G, fixed to its gripper, and the position vector g of the origin
of G have the representations in B given below:
</p>
<p>ŒQ &#141;B D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>1 1 �
p
3 1C
</p>
<p>p
3
</p>
<p>1C
p
3 1 1 �
</p>
<p>p
3
</p>
<p>1 �
p
3 1C
</p>
<p>p
3 1
</p>
<p>3
</p>
<p>5 ; Œ g &#141;B D
</p>
<p>2
</p>
<p>4
</p>
<p>1 �
p
3p
</p>
<p>3
</p>
<p>1C
p
3
</p>
<p>3
</p>
<p>5
</p>
<p>Moreover, let p be the position vector of any point P of the three-dimensional
space, its coordinates in B being .x; y; z/. The robot is supported by a
cylindrical column C of circular cross section, bounded by planes ˘1 and
˘2. These are given below:
</p>
<p>C W x2 C y2 D 4I ˘1W z D 0I ˘2W z D 10
</p>
<p>Find the foregoing equations in G coordinates.</p>
<p/>
</div>
<div class="page"><p/>
<p>94 2 Mathematical Background
</p>
<p>Fig. 2.13 An elliptical path
on an inclined plane
</p>
<p>2.36 A certain point of the gripper of a robot is to trace an elliptical path of semiaxes
a and b, with center at C , the centroid of triangle PQR, as shown in Fig. 2.13.
Moreover, the semiaxis of length a is parallel to edge PQ, while the ellipse
lies in the plane of the triangle, and all three vertices are located a unit distance
away from the origin.
</p>
<p>(a) For b D 2a=3, the gripper is to keep a fixed orientation with respect to the
unit tangent, normal, and binormal vectors of the ellipse, denoted by et ,
en, and eb , respectively.4 Determine the matrix representing the rotation
undergone by the gripper from an orientation in which vector et is parallel
to the coordinate axisX , while en is parallel to Y and eb toZ. Express this
matrix inX; Y; Z coordinates, if the equation of the ellipse, in parametric
form, is given as
</p>
<p>x0 D a cos'; y0 D b sin'; z0 D 0
</p>
<p>the orientation of the gripper thus becoming a function of '.
(b) Find the value of ' for which the angle of rotation of the gripper, with
</p>
<p>respect to the coordinate axes X; Y; Z, becomes � .
</p>
<p>2.37 With reference to Exercise 2.28, find Euler angles �, � , and  that will rotate
the cube of Fig. 2.9a into the attitude displayed in Fig. 2.9b. For a definition of
Euler angles, see Exercise 2.19
</p>
<p>2.38 Find a sequence of Euler angles �, � , and  , as defined in Exercise 2.19, that
will carry triangle A1, B1, C1 into triangle A0, B0, C0, of Fig. 2.11.
</p>
<p>4An account of curve geometry is given in Sect. 11.2.</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 3
</p>
<p>Fundamentals of Rigid-Body Mechanics
</p>
<p>3.1 Introduction
</p>
<p>The purpose of this chapter is to lay down the foundations of the kinetostatics
and dynamics of rigid bodies, as needed in the study of multibody mechanical
systems. With this background, we study the kinetostatics and dynamics of robotic
manipulators of the serial type in Chaps. 5 and 7, respectively, while devoting
Chap. 6 to the study of trajectory planning. The latter requires, additionally, the
background of Chap. 4. A special feature of the current chapter is the study of
the relations between the angular velocity of a rigid body and the time-rates of
change of the various sets of rotation invariants introduced in Chap. 2. Similar
relations between the angular acceleration and the second time-derivatives of the
rotation invariants are also recalled, the corresponding derivations being outlined in
Appendix A.
</p>
<p>Furthermore, an introduction to the extremely useful analysis tool known as
screw theory (Roth 1984) is included. In this context, the concepts of twist and
wrench are introduced, which prove in subsequent chapters to be extremely useful
in deriving the kinematic and static, i.e., the kinetostatic, relations among the various
bodies of multibody mechanical systems.
</p>
<p>3.2 General Rigid-Body Motion and Its Associated Screw
</p>
<p>In this section we analyze the general motion of a rigid body. Thus, let A and P be
two points of the same rigid body B, the former being a particular reference point,
whereas the latter is an arbitrary point of B, as shown in Fig. 3.1. Moreover, the
position vector of point A in the original configuration is a, and the position vector
of the same point in the displaced configuration, denoted by A0, is a0. Similarly, the
position vector of point P in the original configuration is p, while in the displaced
configuration B0, this point is P 0, its position vector being p0. Furthermore, p0 is to
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__3,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>95</p>
<p/>
</div>
<div class="page"><p/>
<p>96 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>Fig. 3.1 General rigid-body
displacement
</p>
<p>be determined, while a, a0, and p are given, along with the rotation matrix Q. Vector
p�a can be considered to undergo a rotation Q about pointA throughout the motion
taking the body from the original to the final configuration. Since vector p � a is
mapped into p0 � a0 under the above rotation, one can write
</p>
<p>p0 � a0 D Q.p � a/ (3.1)
</p>
<p>and hence
</p>
<p>p0 D a0 CQ.p � a/ (3.2)
</p>
<p>which is the relationship sought. Moreover, let dA and dP denote the displacements
of A and P , respectively, i.e.,
</p>
<p>dA � a0 � a; dP � p0 � p (3.3)
</p>
<p>From Eqs. (3.2) and (3.3) one can readily obtain an expression for dP , namely,
</p>
<p>dP D a0 � pCQ.p � a/
D a0 � a � pCQ.p � a/C a
D dA C .Q � 1/.p � a/
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>dP=A
</p>
<p>(3.4)
</p>
<p>where dP=A denotes the relative displacement of P with respect to A. Notice that
this displacement is caused only by the rotation. What Eq. (3.4) states is that the
displacement of an arbitrary point P of a rigid body, of position vector p in an
original configuration, is determined by the displacement of one certain point A
and the concomitant rotation Q, as depicted in Fig. 3.2. In this figure, the final
configuration B0 is attained via an intermediate configuration B00, which is in
turn attained from B by a pure translation.1 Then, B0 is attained from B00 by a
pure rotation Q, of axis parallel to vector e and of angle �. Apparently, once the
</p>
<p>1A body undergoes a pure translation when all its points move under the same displacement.</p>
<p/>
</div>
<div class="page"><p/>
<p>3.2 General Rigid-Body Motion and Its Associated Screw 97
</p>
<p>Fig. 3.2 General rigid-body
displacement attained by a
combination of translation
and rotation
</p>
<p>displacement of P is known, its position vector p0 can be readily determined.
An interesting result in connection with the foregoing discussion is summarized
below:
</p>
<p>Theorem 3.2.1. Let a rigid body B move under a general displacement, of rotation
</p>
<p>Q with axis parallel to the unit vector e. Then, the displacements of all the points of
</p>
<p>B have the same component along e.
</p>
<p>Proof. Multiply both sides of Eq. (3.4) by eT , thereby obtaining
</p>
<p>eT dP D eT dA C eT .Q � 1/.p � a/
</p>
<p>Now, the second term of the right-hand side of the above equation vanishes because
Qe D e, and hence, QT e D e; the said equation thus leads to
</p>
<p>eT dP D eT dA � d0 (3.5)
</p>
<p>thereby showing that the displacements of all points of the body have the same
projection d0 onto the axis of rotation, q.e.d.
</p>
<p>As a consequence of the foregoing result, we have the classical Mozzi&ndash;Chasles
Theorem (Mozzi 1763; Chasles 1830; Ceccarelli 1995), namely,
</p>
<p>Theorem 3.2.2 (Mozzi 1763; Chasles 1830). Given a rigid body moving with a
</p>
<p>general displacement, a set of its points, located on a line L, undergo identical dis-
</p>
<p>placements of minimum magnitude. Moreover, line L and the minimum-magnitude
</p>
<p>displacement are parallel to the axis of the rotation involved, as illustrated
</p>
<p>in Fig. 3.3.
</p>
<p>Proof. The proof is straightforward in light of Theorem 3.2.1, which allows us to
express the displacement of an arbitrary point P as the sum of two orthogonal
components, namely, one parallel to the axis of rotation, independent of P and
denoted by dk&mdash;read &ldquo;d-par&rdquo;&mdash;and one perpendicular to this axis, denoted by d?&mdash;
read &ldquo;d-perp&rdquo;&mdash;i.e.,
</p>
<p>dP D dk C d? (3.6a)</p>
<p/>
</div>
<div class="page"><p/>
<p>98 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>Fig. 3.3 The Mozzi&ndash;Chasles
theorem
</p>
<p>where
</p>
<p>dk D eeT dP D d0e � d0; d? D .1 � eeT /dP (3.6b)
</p>
<p>and clearly, d0 is a constant, as defined in Eq. (3.5), while dk and d? are mutually
orthogonal. Indeed, orthogonality is apparent by definition, but is also verified
below:
</p>
<p>dk � d? D d0eT .1 � eeT /dP D d0.eT � eT /dP D 0
</p>
<p>Now, by virtue of the orthogonality of the two components of dP , it is apparent that
</p>
<p>kdP k2 D kdkk2 C kd?k2 D d 20 C kd?k2
</p>
<p>for the displacement dP of any point of the body. Hence, in order to minimize kdP k
we have to make kd?k, and hence, d? itself, equal to zero, i.e., we must have dP
parallel to e:
</p>
<p>dP D ˛e
</p>
<p>for a certain scalar ˛. That is, the displacements of minimum magnitude of the
body under study are parallel to the axis of Q, thereby proving the first part of the
Mozzi&ndash;Chasles Theorem. The second part is also readily proven by noticing that
if P � is a point of minimum displacement magnitude, of position vector p�, its
component perpendicular to the axis of rotation must vanish, and hence,
</p>
<p>d�?� .1 � eeT /dP�
</p>
<p>D .1 � eeT /dA C .1 � eeT /.Q � 1/.p� � a/ D 0
</p>
<p>Upon expansion of the above expression for d�?, we obtain
</p>
<p>.1 � eeT /dA C .Q � 1/.p� � a/ D 0</p>
<p/>
</div>
<div class="page"><p/>
<p>3.2 General Rigid-Body Motion and Its Associated Screw 99
</p>
<p>Now it is apparent that if we define a line L passing through P � and parallel to
e, then the position vector p� C �e of any of its points P satisfies the foregoing
equation. As a consequence, all points of minimum displacement magnitude lie in a
line parallel to the axis of rotation of Q, q.e.d.
</p>
<p>An important implication of the foregoing theorem is that a rigid body can attain
an arbitrary configuration from a given original one, following a screw-like motion
of axis L and pitch p, the latter being defined presently. Thus, it seems appropriate
to call L the screw axis of the rigid-body motion.
</p>
<p>Note that d0, as defined in Eq. (3.5), is an invariant of the motion at hand. Thus,
associated with a rigid-body motion, one can then define a screw of axis L and
pitch p. Of course, the pitch is defined as
</p>
<p>p � d0
�
D d
</p>
<p>T
P e
</p>
<p>�
or p � 2�d0
</p>
<p>�
(3.7)
</p>
<p>which has units of m/rad or, correspondingly, of m/turn. Moreover, the angle � of the
rotation involved can be regarded as one more feature of this motion. This angle is,
in fact, the amplitude associated with the said motion. We will come across screws
in discussing velocities and forces acting on rigid bodies, along with their pitches
and amplitudes. Thus, it is convenient to introduce this concept at this stage.
</p>
<p>3.2.1 The Screw of a Rigid-Body Motion
</p>
<p>The screw axis L is totally specified by a given point P0 of L that can be defined, for
example, as that lying closest to the origin, and a unit vector e defining its direction.
Expressions for the position vector p0 of P0 in terms of a, a0 and Q, are derived
below:
</p>
<p>Since P0 was defined as the point of L lying closest to the origin, p0 obviously
is perpendicular to e, i.e.,
</p>
<p>eT p0 D 0 (3.8)
</p>
<p>Moreover, the displacement d0 of P0 is parallel to the vector of Q, and hence, is
identical to dk defined in Eq. (3.6b), i.e., it satisfies
</p>
<p>.Q � 1/d0 D 0
</p>
<p>where d0 can be expressed using the general expression for the displacement,
Eq. (3.4), namely,
</p>
<p>d0 D dA C .Q � 1/.p0 � a/ (3.9a)</p>
<p/>
</div>
<div class="page"><p/>
<p>100 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>Now, since d0 is identical to dk, we have, from Eq. (3.6b),
</p>
<p>dA C .Q � 1/.p0 � a/ D dk � eeT d0
</p>
<p>But from Theorem 3.2.1,
</p>
<p>eT d0 D eT dA
</p>
<p>and so
</p>
<p>dA C .Q � 1/.p0 � a/ D eeT dA
</p>
<p>or, after rearranging terms,
</p>
<p>.Q � 1/p0 D .Q � 1/a � .1 � eeT /dA (3.9b)
</p>
<p>which cannot be solved for p0 because, as the reader is invited to show, its matrix
coefficient, Q � 1, is singular, with null space spanned by vector e. Nevertheless,
an expression for p0 can be found if Eq. (3.8) is adjoined to Eq. (3.9b), thereby
obtaining
</p>
<p>Ap0 D b (3.10)
</p>
<p>where A is a 4 � 3 matrix and b is a four-dimensional vector, both given by
</p>
<p>A �
�
</p>
<p>Q � 1
eT
</p>
<p>�
</p>
<p>; b �
�
</p>
<p>.Q � 1/a � .1 � eeT /dA
0
</p>
<p>�
</p>
<p>(3.11)
</p>
<p>Equation (3.10) cannot be solved for p0 directly, because A is not a square matrix.
In fact, that equation represents an overdetermined system of four equations and
three unknowns. Thus, in general, that system does not admit a solution. However,
the four equations are compatible, and hence, in this particular case, a solution of
that equation, which turns out to be unique, can be determined. In fact, if both sides
of Eq. (3.10) are multiplied from the left by AT , we have
</p>
<p>ATAp0 D AT b (3.12)
</p>
<p>Moreover, if the product ATA, which is a 3 � 3 matrix, is invertible, then p0 can be
computed from Eq. (3.12). In fact, the said product is not only invertible, but also
admits an inverse that is rather simple to derive, as shown below. Now the rotation
matrix Q is recalled in terms of its natural invariants, namely, the unit vector e
parallel to its axis of rotation and the angle of rotation � about this axis, as given in
Eq. (2.49), reproduced below for quick reference:
</p>
<p>Q D eeT C cos�.1 � eeT /C sin�E</p>
<p/>
</div>
<div class="page"><p/>
<p>3.2 General Rigid-Body Motion and Its Associated Screw 101
</p>
<p>where 1 represents the 3 � 3 identity matrix and E the cross-product matrix of e,
as introduced in Eq. (2.38). Further, Eq. (2.49) is substituted into Eq. (3.11), which
yields
</p>
<p>ATA D 2.1 � cos�/1 � .1 � 2 cos�/eeT (3.13)
</p>
<p>It is now apparent that the foregoing product is a linear combination of 1 and eeT .
This suggests that its inverse is very likely a linear combination of these two matrices
as well. If this is in fact true, then one can write
</p>
<p>.ATA/�1 D ˛1C ˇeeT (3.14)
</p>
<p>coefficients ˛ and ˇ being determined from the condition that the product of ATA
by its inverse should be 1, which leads to
</p>
<p>˛ D 1
2.1 � cos�/ ; ˇ D
</p>
<p>1 � 2 cos�
2.1 � cos�/ (3.15)
</p>
<p>and hence,
</p>
<p>.ATA/�1 D 1
2.1 � cos�/1C
</p>
<p>1 � 2 cos�
2.1 � cos�/ee
</p>
<p>T (3.16)
</p>
<p>On the other hand, from Eq. (3.11),
</p>
<p>AT b D .Q � 1/T Œ.Q � 1/a � dA&#141; (3.17)
</p>
<p>Upon solving Eq. (3.12) for p0 and substituting relations (3.16) and (3.17) into the
expression thus resulting, one finally obtains
</p>
<p>p0 D
.Q � 1/T .Qa � a0/
2.1 � cos�/ ; for � &curren; 0 (3.18)
</p>
<p>Apparently, p0 can be computed as long as � &curren; 0. If � D 0, then we are
in the presence of a pure translation, all the points of the body undergoing the
same displacement. Therefore, any point of the body is of minimum-magnitude
displacement.
</p>
<p>We have thus defined a line L of the rigid body under study that is completely
defined by its point P0 of position vector p0 and a unit vector e determining its
direction. Moreover, we have already defined the pitch of the associated motion,
Eq. (3.7). The line thus defined, along with the pitch, determines the screw of the
motion under study.</p>
<p/>
</div>
<div class="page"><p/>
<p>102 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>Fig. 3.4 A line L passing
through two points
</p>
<p>3.2.2 The Pl&uuml;cker Coordinates of a Line
</p>
<p>Alternatively, the screw axis, and any line for that matter, can be defined more
conveniently by its Pl&uuml;cker coordinates. In motivating this concept, we recall the
equation of a line L passing through two points P1 and P2 of position vectors p1
and p2, as shown in Fig. 3.4.
</p>
<p>If point P lies in L, then, it must be collinear with P1 and P2, a property that is
expressed as
</p>
<p>.p2 � p1/ � .p � p1/ D 0
</p>
<p>or upon expansion,
</p>
<p>.p2 � p1/ � pC p1 � .p2 � p1/ D 0 (3.19)
</p>
<p>If we now introduce the cross-product matrices P1 and P2 of vectors p1 and p2 in
the above equation, we have an alternative expression for the equation of the line,
namely,
</p>
<p>.P2 � P1/pC p1 � .p2 � p1/ D 0
</p>
<p>The above equation can be regarded as a linear equation in the homogeneous
coordinates of point P , namely,
</p>
<p>�
</p>
<p>P2 � P1 p1 � .p2 � p1/
�
�
</p>
<p>p
</p>
<p>1
</p>
<p>�
</p>
<p>D 0 (3.20)
</p>
<p>It is now apparent that the line is defined completely by two vectors, the
difference p2 � p1, or its cross-product matrix for that matter, and the cross product
p1 � .p2 � p1/. We will thus define a six-dimensional array &#13;L containing these two
vectors, namely,
</p>
<p>&#13;L �
�
</p>
<p>p2 � p1
p1 � .p2 � p1/
</p>
<p>�
</p>
<p>(3.21)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.2 General Rigid-Body Motion and Its Associated Screw 103
</p>
<p>whose six scalar entries are the Pl&uuml;cker coordinates of L. Moreover, if we let
</p>
<p>e � p2 � p1kp2 � p1k
; n � p1 � e (3.22)
</p>
<p>then we can write
</p>
<p>&#13;L D kp2 � p1k
�
</p>
<p>e
</p>
<p>n
</p>
<p>�
</p>
<p>The six scalar entries of the above array are the normalized Pl&uuml;cker coordinates
of L. Vector e determines the direction of L, while n determines its location; n can
be interpreted as the moment of a unit force parallel to e and of line of action L.
Hence, n is called the moment of L. Henceforth, only the normalized Pl&uuml;cker
coordinates of lines will be used. For brevity, we will refer to these simply as the
Pl&uuml;cker coordinates of the line under study. The Pl&uuml;cker coordinates thus defined
will be stored in a Pl&uuml;cker array � in the form
</p>
<p>� D
�
</p>
<p>e
</p>
<p>n
</p>
<p>�
</p>
<p>(3.23)
</p>
<p>where for conciseness, we have dropped the subscript L, while assuming that the
line under discussion is self-evident.
</p>
<p>Note, however, that the six components of the Pl&uuml;cker array, i.e., the Pl&uuml;cker
coordinates of line L, are not independent, for they obey
</p>
<p>e � e D 1; n � e D 0 (3.24)
</p>
<p>and hence, any line L has only four independent Pl&uuml;cker coordinates. In the
foregoing paragraphs, we have talked about the Pl&uuml;cker array of a line, and not about
the Pl&uuml;cker vector; the reason for this distinction is given below. The set of Pl&uuml;cker
arrays is a clear example of an array of real numbers not constituting a vector
space. What disables Pl&uuml;cker arrays from being vectors are the two constraints
that their components must satisfy, namely, (a) the sum of the squares of the first
three components of a Pl&uuml;cker array is unity, and (b) the unit vector of a line is
normal to the moment of the line. Nevertheless, we can perform with Pl&uuml;cker arrays
certain operations that pertain to vectors, as long as we keep in mind the essential
differences. For example, we can multiply Pl&uuml;cker arrays by matrices of the suitable
dimension, with entries having appropriate units, as we will show presently.
</p>
<p>It must be pointed out that a Pl&uuml;cker array is dependent upon the location of
the point with respect to which the moment of the line is measured. Indeed, let �A
and �B denote the Pl&uuml;cker arrays of the same line L when its moment is measured
at points A and B , respectively. Moreover, this line passes through a point P of
position vector p for a particular origin O . Now, let the moment of L with respect
to A and B be denoted by nA and nB , respectively, i.e.,
</p>
<p>nA � .p � a/ � e; nB � .p � b/ � e (3.25)</p>
<p/>
</div>
<div class="page"><p/>
<p>104 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>and hence,
</p>
<p>�A �
�
</p>
<p>e
</p>
<p>nA
</p>
<p>�
</p>
<p>; �B �
�
</p>
<p>e
</p>
<p>nB
</p>
<p>�
</p>
<p>(3.26)
</p>
<p>Obviously,
</p>
<p>nB � nA D .a � b/ � e (3.27)
</p>
<p>i.e.,
</p>
<p>�B D
�
</p>
<p>e
</p>
<p>nA C .a � b/ � e
</p>
<p>�
</p>
<p>(3.28)
</p>
<p>which can be rewritten as
</p>
<p>�B D U�A (3.29a)
</p>
<p>with the 6 � 6 matrix U defined as
</p>
<p>U �
�
</p>
<p>1 O
</p>
<p>A � B 1
</p>
<p>�
</p>
<p>(3.29b)
</p>
<p>while A and B are, respectively, the cross-product matrices of vectors a and b, and
O denotes the 3�3 zero matrix. Given the lower-triangular structure of matrix U, its
determinant is simply the product of its diagonal entries, which are all unity. Hence,
</p>
<p>det.U/ D 1 (3.30)
</p>
<p>U thus belonging to the unimodular group of 6 � 6 matrices. These matrices are
rather simple to invert. In fact, as one can readily prove,
</p>
<p>U�1 D
�
</p>
<p>1 O
</p>
<p>B � A 1
</p>
<p>�
</p>
<p>(3.31)
</p>
<p>Relations (3.29a and b) can then be called the Pl&uuml;cker-coordinate transfer formulas.
</p>
<p>Note that upon multiplication of both sides of Eq. (3.27) by .a � b/,
</p>
<p>.a � b/T nB D .a � b/T nA (3.32)
</p>
<p>and hence, the moments of the same line L with respect to two points are not
independent, for they have the same component along the line joining the two points.
</p>
<p>A special case of a line, of interest in kinematics, is a line at infinity. This
is a line with undefined orientation, but with a defined direction of its moment;</p>
<p/>
</div>
<div class="page"><p/>
<p>3.2 General Rigid-Body Motion and Its Associated Screw 105
</p>
<p>this moment is, moreover, independent of the point with respect to which it is
measured. Very informally, the Pl&uuml;cker coordinates of a line at infinity can be
derived from the general expression, Eq. (3.23), if we rewrite it in the form
</p>
<p>� D knk
�
</p>
<p>e=knk
n=knk
</p>
<p>�
</p>
<p>where clearly n=knk is a unit vector; henceforth, this vector will be denoted by f.
Now let us take the limit of the above expression as P goes to infinity, i.e., when
kpk ! 1, and consequently, as knk ! 1. Thus,
</p>
<p>lim
knk!1
</p>
<p>� D
�
</p>
<p>lim
knk!1
</p>
<p>knk
��
</p>
<p>lim
knk!1
</p>
<p>�
</p>
<p>e=knk
f
</p>
<p>��
</p>
<p>whence
</p>
<p>lim
knk!1
</p>
<p>� D
�
</p>
<p>lim
knk!1
</p>
<p>knk
��
</p>
<p>0
</p>
<p>f
</p>
<p>�
</p>
<p>The six-dimensional array appearing in the above equation is defined as the Pl&uuml;cker
array of a line at infinity, �1, namely,
</p>
<p>�1 D
�
</p>
<p>0
</p>
<p>f
</p>
<p>�
</p>
<p>(3.33)
</p>
<p>Note that a line at infinity of unit moment f can be thought of as being a line lying in
a plane perpendicular to the unit vector f, but otherwise with an indefinite location
in the plane, except that it is an infinitely large distance from the origin. Thus, lines
at infinity vary only in the orientation of the plane in which they lie.
</p>
<p>3.2.3 The Pose of a Rigid Body
</p>
<p>A possible form of describing a general rigid-body motion, then, is through a set
of eight real numbers, namely, the six Pl&uuml;cker coordinates of its screw axis, its
pitch, and its amplitude, i.e., its angle. Hence, a rigid-body motion is fully described
by six independent parameters. Moreover, the pitch can attain values from �1 to
C1. Alternatively, a rigid-body displacement can be described by seven dependent
parameters as follows: four invariants of the concomitant rotation&mdash;the linear
invariants, the natural invariants, or the Euler&ndash;Rodrigues parameters, introduced in
Sect. 2.3&mdash;and the three components of the displacement of an arbitrary point. Since
those invariants are not independent, but subject to one constraint, this description
consistently involves six independent parameters. Thus, let a rigid body undergo a</p>
<p/>
</div>
<div class="page"><p/>
<p>106 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>general motion, of rotation Q from a reference configuration C0. If a landmark point
A of the body undergoes a displacement dA, then the pose array, or simply the pose
s, of the body in configuration C is defined as a seven-dimensional array, namely,
</p>
<p>s �
</p>
<p>2
</p>
<p>4
</p>
<p>q
</p>
<p>q0
dA
</p>
<p>3
</p>
<p>5 (3.34)
</p>
<p>where the three-dimensional vector q and the scalar q0 are any four invariants of Q.
For example, if these are the Euler&ndash;Rodrigues parameters, then
</p>
<p>q � sin
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>e; q0 � cos
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>If alternatively, we work with the linear invariants, then
</p>
<p>q � .sin�/e; q0 � cos�
</p>
<p>and, of course, if we work instead with the natural invariants, then
</p>
<p>q � e; q0 � �
</p>
<p>In the first two cases, the constraint mentioned above is
</p>
<p>kqk2 C q20 D 1 (3.35)
</p>
<p>In the last case, the constraint is simply
</p>
<p>kek2 D 1 (3.36)
</p>
<p>Notice that the pose of a rigid body is an array of numbers quantifying the displace-
ment of the body from a reference configuration C0 to a current configuration C. As
such, then, the pose is a relative concept.
</p>
<p>An important problem in kinematics is the computation of the screw parameters,
i.e., the components of s, as given in Eq. (3.34), from coordinate measurements over
a certain finite set of points. From the foregoing discussion, it should be clear that
the computation of the attitude of a rigid body, given by matrix Q or its invariants,
is crucial in solving this problem. Moreover, besides its theoretical importance,
this problem, known as pose estimation, has also practical relevance. Actually,
the problem of interest can be regarded as one of relative-pose estimation, as the
pose is, in reality, a relative concept. In space applications, for example, a common
operation is the rendezvousing of two objects, e.g., the now-defunct Space Shuttle
with the International Space Station. Another example is the grabbing of objects
floating in space, e.g., a drifting satellite, by a robotic gripper. In order to properly
orient the gripper, the relative pose of the satellite with respect to the gripper palm</p>
<p/>
</div>
<div class="page"><p/>
<p>3.2 General Rigid-Body Motion and Its Associated Screw 107
</p>
<p>Fig. 3.5 MDA Space Vision
Marker System (SVMS) at
MDA&rsquo;s Space Vision
Laboratory in Brampton,
Ontario, Canada. Developed
under contract with the
Canadian Space Agency
</p>
<p>Fig. 3.6 Decomposition of the displacement of a rigid body
</p>
<p>is needed. This can be estimated by means of markers previously attached on the
satellite surface, that identify corresponding points thereof. These markers are not
simple points, but arrays of visual features similar to the simple one-dimensional and
two-dimensional barcodes, although more evolved, to package a larger amount of
information in the same area. The purpose here is to add robustness to the estimation
algorithm in use. A new concept, the Space Vision Marker System (SVMS), was
introduced by a MDA Team (Bondy et al. 2007), that uses markers of the kind
shown in Fig. 3.5, along with estimation algorithms. These markers are aimed at
marker-detection throughout &ldquo;a wide range of viewing distances and angles, and
illumination (including direct sun light and shadows); encoded redundant features
allow identification even with a partial data loss.&rdquo;
</p>
<p>A straightforward method of computing the screw parameters consists in regard-
ing the motion as follows: Choose a certain pointA of the body, of position vector a,
and track it as the body moves to a displaced configuration, at which point A
moves to A0, of position vector a0. Assume that the body reaches the displaced
configuration B0, passing through an intermediate one B00, which is attained by a
pure translation, as depicted in Fig. 3.2. Next, configuration B0 is reached by rotating
the body about point A0, as indicated in Fig. 3.6.</p>
<p/>
</div>
<div class="page"><p/>
<p>108 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>Matrix Q can now be readily determined. To do this, define three points of
the body, P1, P2, and P3, in such a way that the three vectors defined below are
orthonormal and form a right-hand system:
</p>
<p>e1 �
��!
AP1; e2 �
</p>
<p>��!
AP2; e3 �
</p>
<p>��!
AP3 (3.37)
</p>
<p>ei � ej D ıij ; i; j D 1; 2; 3; e3 D e1 � e2 (3.38)
</p>
<p>where ıij is the Kronecker delta, defined as 1 if i D j , and as 0 otherwise. Now,
let the set feig31 be labeled fe0ig31 and fe00i g31 in configurations B0 and B00, respectively.
Moreover, let qij denote the entries of the matrix representation of the rotation Q in
a frame X; Y; Z with origin at A and such that the foregoing axes are parallel to
vectors e1, e2, and e3, respectively. It is clear, from Definition 2.2.1, that
</p>
<p>qij D ei � e0j (3.39)
</p>
<p>i.e.,
</p>
<p>ŒQ &#141; D
</p>
<p>2
</p>
<p>4
</p>
<p>e1 � e01 e1 � e02 e1 � e03
e2 � e01 e2 � e02 e2 � e03
e3 � e01 e3 � e02 e3 � e03
</p>
<p>3
</p>
<p>5 (3.40)
</p>
<p>Note that all ei and e0i appearing in Eq. (3.40) must be represented in the same
coordinate frame. Once Q is determined, computing the remaining screw parameters
is straightforward. One can use, for example, Eq. (3.18) to determine the point of the
screw axis that lies closest to the origin, which would thus allow one to compute the
Pl&uuml;cker coordinates of the screw axis.
</p>
<p>3.3 Rotation of a Rigid Body About a Fixed Point
</p>
<p>In this section, the motion of a rigid body having a point fixed is analyzed. This
motion is fully described by a rotation matrix Q that is proper orthogonal. Now, Q
will be assumed to be a smooth function of time, and hence, the position vector of a
point P in an original configuration, denoted here by p0, is mapped smoothly into a
new vector p.t/, namely,
</p>
<p>p.t/ D Q.t/p0 (3.41)
</p>
<p>The velocity of P is computed by differentiating both sides of Eq. (3.41) with
respect to time, thus obtaining
</p>
<p>Pp.t/ D PQ.t/p0 (3.42)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.4 General Instantaneous Motion of a Rigid Body 109
</p>
<p>which is not a very useful expression, because it requires knowledge of the original
position of P . An alternative expression can be derived if Eq. (3.41) is solved for p0
and the expression thus resulting is substituted into Eq. (3.42), which yields
</p>
<p>Pp D PQQT p (3.43)
</p>
<p>where the argument t has been dropped for the sake of simplicity, but one must keep
in mind that all quantities are now time-varying. The product PQQT is known as the
angular-velocity matrix of the rigid-body motion and is denoted by&#127;, i.e.,
</p>
<p>&#127; � PQQT (3.44)
</p>
<p>As a consequence of the orthogonality of Q, one has a basic result, namely,
</p>
<p>Theorem 3.3.1. The angular-velocity matrix is skew-symmetric.
</p>
<p>Proof. This follows directly from definition (3.44).
In order to derive the angular-velocity vector of a rigid-body motion, we recall
</p>
<p>the concept of axial vector, or simply vector, of a 3 � 3 matrix, introduced in
Sect. 2.3.3. Thus, the angular-velocity vector! of the rigid-body motion under study
is defined as the vector of&#127;, i.e.,
</p>
<p>! � vect.&#127;/ (3.45)
</p>
<p>and hence, Eq. (3.43) can be written as
</p>
<p>Pp D &#127;p D ! � p (3.46)
</p>
<p>from which it is apparent that the velocity of any point P of a body moving with a
point O fixed is perpendicular to line OP .
</p>
<p>3.4 General Instantaneous Motion of a Rigid Body
</p>
<p>If a rigid body now undergoes the most general motion, none of its points remains
fixed, and the position vector of any of these, P , in a displaced configuration is
given by Eq. (3.2). Let a0 and p0 denote the position vectors of points A and P
of Sect. 3.2, respectively, in the reference configuration C0, a.t/ and p.t/ being the
position vectors of the same points in the displaced configuration C. Moreover, if
Q.t/ denotes the rotation matrix, then
</p>
<p>p.t/ D a.t/CQ.t/.p0 � a0/ (3.47)
</p>
<p>Now, the velocity of P is computed by differentiating both sides of Eq. (3.47) with
respect to time, thus obtaining
</p>
<p>Pp.t/ D Pa.t/C PQ.t/.p0 � a0/ (3.48)</p>
<p/>
</div>
<div class="page"><p/>
<p>110 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>which again, as expression (3.48), is not very useful, for it requires the values of the
position vectors of A and P in the original configuration. However, if Eq. (3.47) is
solved for p0�a0 and the expression thus resulting is substituted into Eq. (3.48), we
obtain
</p>
<p>Pp D PaC&#127;.p � a/ (3.49)
</p>
<p>or in terms of the angular-velocity vector,
</p>
<p>Pp D PaC! � .p � a/ (3.50)
</p>
<p>where the argument t has been dropped for brevity but is implicit, since all variables
of the foregoing equation are now functions of time. Furthermore, from Eq. (3.50),
it is apparent that
</p>
<p>. Pp � Pa/ � .p � a/ D 0 (3.51)
</p>
<p>which can be summarized as
</p>
<p>Theorem 3.4.1. The relative velocity of two points of the same rigid body is
</p>
<p>perpendicular to the line joining them.
</p>
<p>Moreover, similar to the outcome of Theorem 3.2.1, one now has an additional
result that is derived upon dot-multiplying both sides of Eq. (3.50) by !, namely,
</p>
<p>! � Pp D ! � Pa
</p>
<p>and hence,
</p>
<p>Corollary 3.4.1. The projections of the velocities of all the points of a rigid body
</p>
<p>onto the angular-velocity vector are identical.
</p>
<p>Similar to the Mozzi&ndash;Chasles theorem, we have
</p>
<p>Theorem 3.4.2. Given a rigid body under general motion, a set of its points located
</p>
<p>on a line L0 undergoes the identical minimum-magnitude velocity v0 parallel to the
angular velocity.
</p>
<p>Definition 3.4.1. The line containing the points of a rigid body undergoing
minimum-magnitude velocities is called the instant screw axis (ISA) of the body
under the given motion.
</p>
<p>3.4.1 The Instant Screw of a Rigid-Body Motion
</p>
<p>From Theorem 3.4.2, the instantaneous motion of a body is equivalent to that of the
nut of a screw of axis L0, the ISA. As the body moves, the ISA changes, for which
reason the motion of the body is called an instantaneous screw. Moreover, since v0
is parallel to !, it can be expressed in the form</p>
<p/>
</div>
<div class="page"><p/>
<p>3.4 General Instantaneous Motion of a Rigid Body 111
</p>
<p>v0 D v0
!
</p>
<p>k!k (3.52)
</p>
<p>where v0 is a scalar quantity denoting the signed magnitude of v0 and bears the sign
of v0 �!. Furthermore, the pitch p0 of the instantaneous screw is defined as
</p>
<p>p0 � v0k!k �
Pp �!
k!k2 or p
</p>
<p>0 � 2�v0k!k (3.53)
</p>
<p>which thus bears units of m/rad or, correspondingly, of m/turn.
Again, the ISA L0 can be specified uniquely through its Pl&uuml;cker coordinates,
</p>
<p>stored in the pL0 array defined as
</p>
<p>pL0 �
�
</p>
<p>e0
</p>
<p>n0
</p>
<p>�
</p>
<p>(3.54)
</p>
<p>where e0 and n0 are, respectively, the unit vector defining the direction of L0 and its
moment about the origin, i.e.,
</p>
<p>e0 � !k!k ; n
0 � p � e0 (3.55)
</p>
<p>p being the position vector of any point of the ISA. Clearly, e0 is defined uniquely but
becomes trivial when the rigid body instantaneously undergoes a pure translation,
i.e., a motion during which, instantaneously, ! D 0 and all body-points move with
the same velocity v0. In this case, e0 is defined as the unit vector parallel to v0.
Thus, an instantaneous rigid-body motion is defined by a line L0, a pitch p0, and
an amplitude k!k. Such a motion is, then, fully determined by six independent
parameters, namely, the four independent Pl&uuml;cker coordinates of L0, its pitch, and
its amplitude. A line supplied with a pitch is, in general, called a screw; a screw
supplied with an amplitude representing the magnitude of an angular velocity
provides the representation of an instantaneous rigid-body motion that is sometimes
called the twist, an item that will be discussed in more detail below.
</p>
<p>Hence, the instantaneous screw is fully defined by six independent real numbers.
Moreover, such as in the case of the screw motion, the pitch of the instantaneous
screw can attain values from �1 toC1.
</p>
<p>The ISA can be alternatively described in terms of the position vector p00 of its
point lying closest to the origin. Expressions for p00 in terms of the position and
the velocity of an arbitrary body-point and the angular velocity are derived below.
To this end, we decompose Pp into two orthogonal components, Ppk and Pp?, along and
transverse to the angular-velocity vector, respectively&mdash;see Eqs. (2.6a) and (2.6b).
Hence, Pa is first decomposed into two such orthogonal components, Pak and Pa?, the
former being parallel, the latter normal to the ISA, i.e.,
</p>
<p>Pa � Pak C Pa? (3.56)</p>
<p/>
</div>
<div class="page"><p/>
<p>112 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>These orthogonal components are given as
</p>
<p>Pak � Pa �!
!
</p>
<p>k!k2 �
!!T
</p>
<p>k!k2 Pa; Pa? �
�
</p>
<p>1 � !!
T
</p>
<p>k!k2
�
</p>
<p>Pa � � 1k!k2&#127;
2 Pa (3.57)
</p>
<p>In the derivation of Eq. (3.57) we have used the identity introduced in Eq. (2.40),
which means, in our case:
</p>
<p>&#127;2 � !!T � k!k21 (3.58)
</p>
<p>Upon substitution of Eqs. (3.57) into Eq. (3.50), we obtain
</p>
<p>Pp D !!
T
</p>
<p>k!k2 Pa
&bdquo;ƒ&sbquo;&hellip;
</p>
<p>Ppk
</p>
<p>� 1k!k2&#127;
2 PaC&#127;.p � a/
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>Pp?
</p>
<p>(3.59)
</p>
<p>Of the three components of Pp, the first, henceforth referred to as its axial component,
is parallel, the last two being normal to !. The sum of the last two components is
referred to as the normal component of Pp. From Eq. (3.59) it is apparent that the axial
component is independent of p, while the normal component is a linear function of
p. An obvious question now arises: For an arbitrary motion, is it possible to find
a certain point of position vector p whose velocity normal component vanishes?
</p>
<p>The vanishing of the normal component obviously implies the minimization of the
magnitude of Pp. The condition under which this happens can now be stated as
</p>
<p>Pp? D 0
</p>
<p>or
</p>
<p>&#127;.p � a/ � 1k!k2&#127;
2 Pa D 0 (3.60)
</p>
<p>which can be further expressed as a vector equation linear in p, namely,
</p>
<p>&#127;p D &#127;
�
</p>
<p>aC 1k!k2&#127;Pa
�
</p>
<p>(3.61)
</p>
<p>or
</p>
<p>&#127;.p � r/ D 0 (3.62a)
</p>
<p>with r defined as
</p>
<p>r � aC 1k!k2&#127;Pa (3.62b)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.4 General Instantaneous Motion of a Rigid Body 113
</p>
<p>and hence, a possible solution of the foregoing problem is
</p>
<p>p D r D aC 1k!k2&#127;Pa (3.63)
</p>
<p>However, this solution is not unique, for Eq. (3.62a) does not require that p � r be
zero, only that this difference lie in the null space of &#127;, i.e., that p � r be linearly
dependent with!. In other words, if a vector ˛! is added to p as given in Eq. (3.63),
then the sum also satisfies Eq. (3.61). It is then apparent that Eq. (3.61) does not
determine a single point whose normal velocity component vanishes, but a set of
points lying on the ISA, and thus, other solutions are possible. For example, we can
find the point of the ISA lying closest to the origin. To this end, let p00 be the position
vector of that point. This vector is obviously perpendicular to !, i.e.,
</p>
<p>!T p00 D 0 (3.64)
</p>
<p>Next, Eq. (3.61) is rewritten for p00, and Eq. (3.64) is adjoined to it, thereby deriving
an expanded linear system of equations, namely,
</p>
<p>Ap00 D b (3.65)
</p>
<p>where A is a 4�3matrix and b is a four-dimensional vector, both being given below:
</p>
<p>A �
�
</p>
<p>&#127;
</p>
<p>!T
</p>
<p>�
</p>
<p>; b �
�
</p>
<p>&#127;aC .1=k!k2/&#127;2 Pa
0
</p>
<p>�
</p>
<p>(3.66)
</p>
<p>This system is of the same nature as that appearing in Eq. (3.10), and hence, it can
be solved for p00 following the same procedure. Thus, both sides of Eq. (3.65) are
multiplied from the left by AT , thereby obtaining
</p>
<p>ATAp00 D AT b (3.67)
</p>
<p>where
</p>
<p>ATA D &#127;T&#127;C!!T D �&#127;2 C!!T (3.68)
</p>
<p>Moreover, from Eq. (3.58), the rightmost side of the foregoing relation becomes
k!k21, and hence, the matrix coefficient of the left-hand side of Eq. (3.67) and the
right-hand side of the same equation reduce, respectively, to
</p>
<p>ATA D k!k21; AT b D &#127;.Pa �&#127;a/ (3.69)
</p>
<p>Upon substitution of Eq. (3.69) into Eq. (3.67) and further solving for p00, the desired
expression is derived:
</p>
<p>p00 D
&#127;.Pa �&#127;a/
k!k2 �
</p>
<p>! � .Pa �! � a/
k!k2 (3.70)</p>
<p/>
</div>
<div class="page"><p/>
<p>114 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>Thus, the instantaneous screw is fully defined by an alternative set of six
independent scalars, namely, the three components of its angular velocity ! and
the three components of the velocity of an arbitrary body point A, denoted by Pa. As
in the case of the screw motion, we can also represent the instantaneous screw by a
line and two additional parameters, as we explain below.
</p>
<p>3.4.2 The Twist of a Rigid Body
</p>
<p>A line, as we saw earlier, is fully defined by its six-dimensional Pl&uuml;cker array, which
contains only four independent components. Now, if a pitch p is added as a fifth
feature to the line or, correspondingly, to its Pl&uuml;cker array, we obtain a screw s,
namely,
</p>
<p>s �
�
</p>
<p>e
</p>
<p>p � eC pe
</p>
<p>�
</p>
<p>(3.71)
</p>
<p>An amplitude is any scalar A multiplying the foregoing screw. The amplitude
produces a twist or a wrench, to be discussed presently, depending on its units. The
twist or the wrench thus defined can be regarded as an eight-parameter array. These
eight parameters, of which only six are independent, are the amplitude, the pitch,
and the six Pl&uuml;cker coordinates of the associated line. Clearly, a twist or a wrench
is defined completely by six independent real numbers. More generally, a twist can
be regarded as a six-dimensional array defining completely the velocity field of a
rigid body; it comprises the three components of the angular velocity and the three
components of the velocity of any of the points of the body.
</p>
<p>Below we elaborate on the foregoing concepts. Upon multiplication of the screw
appearing in Eq. (3.71) by the amplitudeA representing the magnitude of an angular
velocity, we obtain a twist t, namely,
</p>
<p>t �
�
</p>
<p>Ae
</p>
<p>p � .Ae/C p.Ae/
</p>
<p>�
</p>
<p>where the product Ae can be readily identified as the angular velocity ! parallel to
vector e, of magnitude jAj. Moreover, the lower part of t can be readily identified
with the velocity of a point of a rigid body. Indeed, if we regard the line L and point
O as sets of points of a rigid body B moving with an angular velocity ! and such
that point P moves with a velocity p! parallel to the angular velocity, then the
lower vector of t, denoted by v, represents the velocity of point O , i.e.,
</p>
<p>v D �! � pC p!
</p>
<p>We can thus express the twist t as
</p>
<p>t �
�
</p>
<p>!
</p>
<p>v
</p>
<p>�
</p>
<p>(3.72)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.4 General Instantaneous Motion of a Rigid Body 115
</p>
<p>If the pitch is zero, the twist is a pure rotation; if infinite, the twist is a pure
translation, in which case the twist is
</p>
<p>t �
�
</p>
<p>0
</p>
<p>v
</p>
<p>�
</p>
<p>D kvk
�
</p>
<p>0
</p>
<p>e
</p>
<p>�
</p>
<p>(3.73)
</p>
<p>Then, the screw of infinite pitch s1 is defined as the six-dimensional array appearing
in the above equation, namely,
</p>
<p>s1 �
�
</p>
<p>0
</p>
<p>e
</p>
<p>�
</p>
<p>(3.74)
</p>
<p>Note that this screw array is identical to the Pl&uuml;cker array of a line at infinity lying
in a plane of unit normal e, as displayed in Eq. (3.33).
</p>
<p>The twist array, as defined in Eq. (3.72), with ! on top, represents the ray
coordinates of the twist. An exchange of the order of the two Cartesian vectors
of this array, in turn, gives rise to the axis coordinates of the twist.
</p>
<p>The foregoing twist was also termed motor by Everett (1875). As Phillips (1990)
points out, the word motor is an abbreviation of moment and vector. An extensive
introduction into motor algebra was published by von Mises (1924), a work that
is now available in English (von Mises 1996). Roth (1984), in turn, provided a
summary of these concepts, as applicable to robotics. The foregoing array goes also
by other names, such as the German Kinemate or the French torseur cin&eacute;matique.
</p>
<p>The relationships between the angular-velocity vector and the time derivatives of
the invariants of the associated rotation are linear. Indeed, let the three sets of four
invariants of rotation, namely, the natural invariants, the linear invariants, and the
Euler&ndash;Rodrigues parameters be grouped in the four-dimensional arrays �, �, and �,
respectively, i.e.,
</p>
<p>� �
�
</p>
<p>e
</p>
<p>�
</p>
<p>�
</p>
<p>; � �
�
</p>
<p>.sin�/e
cos�
</p>
<p>�
</p>
<p>; � �
�
</p>
<p>Œsin.�=2/&#141;e
cos.�=2/
</p>
<p>�
</p>
<p>(3.75)
</p>
<p>We then have the linear relations derived in full detail elsewhere (Angeles 1988),
and outlined in Appendix A for quick reference, namely,
</p>
<p>P� D N!; P� D L!; P� D H! (3.76a)
</p>
<p>with N, L, and H defined as
</p>
<p>N �
�
</p>
<p>Œsin�=.2.1 � cos�//&#141;.1 � eeT / � .1=2/E
eT
</p>
<p>�
</p>
<p>; (3.76b)
</p>
<p>L �
�
</p>
<p>.1=2/Œtr.Q/1 �Q&#141;
�.sin�/eT
</p>
<p>�
</p>
<p>; (3.76c)
</p>
<p>H � 1
2
</p>
<p>�
</p>
<p>cos.�=2/1 � sin.�=2/E
� sin.�=2/eT
</p>
<p>�
</p>
<p>(3.76d)
</p>
<p>where, it is recalled, tr.�/ denotes the trace of its square matrix argument .�/, i.e., the
sum of the diagonal entries of that matrix.</p>
<p/>
</div>
<div class="page"><p/>
<p>116 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>The inverse relations of those shown in Eqs. (3.76a) are to be derived by resorting
to the approach introduced when solving Eq. (3.65) for p00, thereby obtaining
</p>
<p>! D QN P� D QL P� D QH P� (3.77a)
</p>
<p>the 3 � 4 matrices QN, QL, and QH being defined below:
</p>
<p>QN �
�
</p>
<p>.sin�/1C .1 � cos�/E e
�
</p>
<p>; (3.77b)
</p>
<p>QL �
�
</p>
<p>1C Œ.sin�/=.1C cos�/&#141;E �Œ.sin�/=.1C cos�/&#141;e
�
</p>
<p>; (3.77c)
</p>
<p>QH � 2
�
</p>
<p>Œcos.�=2/&#141;1C Œsin.�=2/&#141;E �Œsin.�=2/&#141;e
�
</p>
<p>(3.77d)
</p>
<p>Caveat The angular velocity vector is not a time-derivative, i.e., no Cartesian vector
</p>
<p>exists whose time-derivative is the angular-velocity vector.
</p>
<p>However, matrices N, L, and H of Eqs. (3.76b&ndash;d) can be regarded as integration
factors that yield time-derivatives.
</p>
<p>Now we can write the relationship between the twist and the time-rate of change
of the seven-dimensional pose array s, namely,
</p>
<p>Ps D Tt (3.78)
</p>
<p>where
</p>
<p>T �
�
</p>
<p>F O43
</p>
<p>O 1
</p>
<p>�
</p>
<p>(3.79)
</p>
<p>in which O and O43 are the 3 � 3 and the 4 � 3 zero matrices, while 1 is the 3 � 3
identity matrix and F is, correspondingly, N, L, or H, depending upon the invariant
representation chosen for the rotation. The inverse relationship of Eq. (3.78) takes
the form
</p>
<p>t D SPs (3.80a)
</p>
<p>where
</p>
<p>S �
� QF O
</p>
<p>O34 1
</p>
<p>�
</p>
<p>(3.80b)
</p>
<p>in which O34 is the 3 � 4 zero matrix. Moreover, QF is one of QN, QL, or QH, depending
on the rotation representation adopted, namely, the natural invariants, the linear
invariants, or the Euler&ndash;Rodrigues parameters, respectively.
</p>
<p>A formula that relates the twist of the same rigid body at two different points is
now derived. Let A and P be two arbitrary points of a rigid body. The twist at each
of these points is defined as
</p>
<p>tA D
�
</p>
<p>!
</p>
<p>vA
</p>
<p>�
</p>
<p>; tP D
�
</p>
<p>!
</p>
<p>vP
</p>
<p>�
</p>
<p>(3.81)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.5 Acceleration Analysis of Rigid-Body Motions 117
</p>
<p>Moreover, Eq. (3.50) can be rewritten as
</p>
<p>vP D vA C .a � p/ �! (3.82)
</p>
<p>Combining Eq. (3.81) with Eq. (3.82) yields
</p>
<p>tP D UtA (3.83a)
</p>
<p>where
</p>
<p>U �
�
</p>
<p>1 O
</p>
<p>A � P 1
</p>
<p>�
</p>
<p>(3.83b)
</p>
<p>with the 6 � 6 matrix U defined as in Eq. (3.29b), while A and P denote the cross-
product matrices of vectors a and p, respectively. Thus, Eqs. (3.83a and b) can be
fairly called the twist-transfer formulas.
</p>
<p>3.5 Acceleration Analysis of Rigid-Body Motions
</p>
<p>Upon differentiation of both sides of Eq. (3.49) with respect to time, one obtains
</p>
<p>Rp D RaC P&#127;.p � a/C&#127;. Pp � Pa/ (3.84)
</p>
<p>Now, Eq. (3.49) is solved for Pp � Pa, and the expression thus resulting is substituted
into Eq. (3.84), thereby obtaining
</p>
<p>Rp D RaC . P&#127;C&#127;2/.p � a/ (3.85)
</p>
<p>where the matrix sum in parentheses is termed the angular-acceleration matrix of
the rigid-body motion and is represented by W, i.e.,
</p>
<p>W � P&#127;C&#127;2 (3.86)
</p>
<p>Apparently, the first term of the right-hand side of Eq. (3.86) is skew-symmetric,
whereas the second one is symmetric. Thus,
</p>
<p>vect.W/ D vect. P&#127;/ D P! (3.87)
</p>
<p>P! being termed the angular-acceleration vector of the rigid-body motion. We have
now an interesting result, namely,
</p>
<p>tr.W/ D tr.&#127;2/ D tr.�k!k21C!!T /
D �k!k2tr.1/C! �! D �2k!k2 (3.88)</p>
<p/>
</div>
<div class="page"><p/>
<p>118 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>Moreover, Eq. (3.85) can be written as
</p>
<p>Rp D RaC P! � .p � a/C! � Œ! � .p � a/&#141; (3.89)
</p>
<p>On the other hand, the time derivative of t, henceforth referred to as the twist rate,
is displayed below:
</p>
<p>Pt �
�
</p>
<p>P!
Pv
</p>
<p>�
</p>
<p>(3.90)
</p>
<p>in which Pv is the acceleration of a point of the body. The relationship between the
twist rate and the second time derivative of the screw is derived by differentiation of
both sides of Eq. (3.78), which yields
</p>
<p>Rs D TPtC PTt (3.91)
</p>
<p>where
</p>
<p>PT �
� PF O43
</p>
<p>O O
</p>
<p>�
</p>
<p>(3.92)
</p>
<p>and F is one of N, L, or H, accordingly. The inverse relationship of Eq. (3.91) is
derived by differentiating both sides of Eq. (3.80a) with respect to time, which yields
</p>
<p>Pt D SRsC PSPs (3.93)
</p>
<p>where
</p>
<p>PS D
" PQF O
</p>
<p>O34 O
</p>
<p>#
</p>
<p>(3.94)
</p>
<p>with O and O34 already defined in Eq. (3.80b) as the 3 � 3 and the 3 � 4 zero
matrices, respectively, while PQF is one of PQN, PQL, or PQH, according with the type of
rotation representation at hand.
</p>
<p>Before we embark in differentiating the foregoing matrices, we introduce a few
definitions: Let
</p>
<p>� �
�
</p>
<p>u
</p>
<p>u0
</p>
<p>�
</p>
<p>; � �
�
</p>
<p>r
</p>
<p>r0
</p>
<p>�
</p>
<p>(3.95a)
</p>
<p>i.e.,
</p>
<p>u � sin�e; u0 � cos�; r � sin
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>e; r0 � cos
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>(3.95b)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.5 Acceleration Analysis of Rigid-Body Motions 119
</p>
<p>Thus, the time derivatives sought take on the forms
</p>
<p>PN D 1
4.1 � cos�/
</p>
<p>�
</p>
<p>B
</p>
<p>Pe
</p>
<p>�
</p>
<p>(3.96a)
</p>
<p>PL D
�
</p>
<p>.1=2/Œ1tr. PQ/ � PQ&#141;
�.1=2/!T Œ1tr.Q/ �QT &#141;
</p>
<p>�
</p>
<p>D
�
</p>
<p>�.! � u/1 � .1=2/&#127;Q
�.1=2/!T Œ1tr.Q/ �QT &#141;
</p>
<p>�
</p>
<p>(3.96b)
</p>
<p>PH D 1
2
</p>
<p>�
</p>
<p>Pr01 � PR
�PrT
</p>
<p>�
</p>
<p>(3.96c)
</p>
<p>where we have used the identities below, which are derived in Appendix A.
</p>
<p>tr. PQ/ � tr.&#127;Q/ � �2!T u (3.96d)
</p>
<p>Furthermore, R denotes the cross-product matrix of r, and B is defined as
</p>
<p>B � �2.e �!/1C 2.3 � cos�/.e �!/eeT � 2.1C sin�/!eT
</p>
<p>�.2 cos� C sin�/e!T � .sin�/Œ&#127; � .e �!/E&#141; (3.96e)
</p>
<p>Moreover,
</p>
<p>PQN D
� P�.cos�/1C P�.sin �/E Pe
</p>
<p>�
</p>
<p>(3.97a)
</p>
<p>PQL D
�
</p>
<p>V=D Pu
�
</p>
<p>(3.97b)
</p>
<p>PQH D
�
</p>
<p>Pr01C PR �Pr
�
</p>
<p>(3.97c)
</p>
<p>where V and D are defined below:
</p>
<p>V � PU � . PuuT C u PuT / � Pu0
D
.U � uuT / (3.97d)
</p>
<p>D � 1C u0 (3.97e)
</p>
<p>with U denoting, now, the cross-product matrix of u.</p>
<p/>
</div>
<div class="page"><p/>
<p>120 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>3.6 Rigid-Body Motion Referred to Moving Coordinate Axes
</p>
<p>Although in kinematics no &ldquo;preferred&rdquo; coordinate system exists, in dynamics the
governing equations of rigid-body motions are valid only in inertial frames, the
concept to be defined in Sect. 3.8. Thus, it is important to refer vectors and matrices
to inertial frames, but sometimes it is not possible to do so directly. For instance,
a space vessel can be supplied with instruments to measure the velocity and the
acceleration of a satellite drifting in space, but the measurements taken from the
space vessel will be referred to a coordinate frame fixed to it, which is not inertial.
If the motion of the vessel with respect to an inertial coordinate frame is recorded,
e.g., from an Earth-based station, then the acceleration of the satellite with respect
to an inertial frame can be computed using the foregoing information. How to do
this is the subject of this section.
</p>
<p>In the realm of kinematics, it is not necessary to distinguish between inertial
and noninertial coordinate frames, and hence, it will suffice to call the coordinate
systems involved fixed and moving. Thus, consider the fixed coordinate frame
X; Y; Z, which will be labeled F , and the moving coordinate frame X , Y , Z , which
will be labeled M, both being depicted in Fig. 3.7. Moreover, let Q be the rotation
matrix taking frame F into the orientation of M, and o the position vector of the
origin of M from the origin of F . Further, let p be the position vector of point P
from the origin of F and � the position vector of the same point from the origin of
M. From Fig. 3.7 one has
</p>
<p>Œp &#141;F D Œ o &#141;F C Œ� &#141;F (3.98)
</p>
<p>where it will be assumed that � is not available in frame F , but in M. Hence,
</p>
<p>Œ� &#141;F D ŒQ &#141;F Œ� &#141;M (3.99)
</p>
<p>Fig. 3.7 Fixed and moving coordinate frames</p>
<p/>
</div>
<div class="page"><p/>
<p>3.7 Static Analysis of Rigid Bodies 121
</p>
<p>Substitution of Eq. (3.99) into Eq. (3.98) yields
</p>
<p>Œp &#141;F D Œ o &#141;F C ŒQ &#141;F Œ� &#141;M (3.100)
</p>
<p>Now, in order to compute the velocity of P , both sides of Eq. (3.100) are
differentiated with respect to time, which leads to
</p>
<p>Œ Pp &#141;F D Œ Po &#141;F C Œ PQ &#141;F Œ� &#141;M C ŒQ &#141;F Œ P� &#141;M (3.101)
</p>
<p>Furthermore, from the definition of&#127;, Eq. (3.44), we have
</p>
<p>Œ PQ &#141;F D Œ&#127; &#141;F ŒQ &#141;F (3.102)
</p>
<p>Upon substitution of the foregoing relation into Eq. (3.101), we obtain
</p>
<p>Œ Pp &#141;F D Œ Po &#141;F C Œ&#127; &#141;F ŒQ &#141;F Œ� &#141;M C ŒQ &#141;F Œ P� &#141;M (3.103)
</p>
<p>which is an expression for the velocity of P in F in terms of the velocity of P in M
and the twist of M with respect to F . Next, the acceleration of P in F is derived
by differentiation of both sides of Eq. (3.103) with respect to time, which yields
</p>
<p>Œ Rp &#141;F D Œ Ro &#141;F C Œ P&#127; &#141;F ŒQ &#141;F Œ� &#141;M C Œ&#127; &#141;F Œ PQ &#141;F Œ� &#141;M
CŒ&#127; &#141;F ŒQ &#141;F Œ P� &#141;M C Œ PQ &#141;F Œ P� &#141;M C ŒQ &#141;F Œ R� &#141;M (3.104)
</p>
<p>Further, upon substitution of identity (3.102) into Eq. (3.104), we obtain
</p>
<p>Œ Rp &#141;F D Œ Ro &#141;F C . Œ P&#127; &#141;F C Œ&#127;2 &#141;F /ŒQ &#141;F Œ� &#141;M
C2Œ&#127; &#141;F ŒQ &#141;F Œ P� &#141;M C ŒQ &#141;F Œ R� &#141;M (3.105)
</p>
<p>Moreover, from the results of Sect. 3.5, it is apparent that the first two terms of
the right-hand side of Eq. (3.105) represent the acceleration of P as a point of M,
whereas the fourth term is the acceleration of P measured from M. The third term
is known as the Coriolis acceleration, for it was first pointed out by the French
mathematician Gustave Gaspard Coriolis (1835).
</p>
<p>3.7 Static Analysis of Rigid Bodies
</p>
<p>Germane to the velocity analysis of rigid bodies is their force-and-moment analysis.
In fact, striking similarities exist between the velocity relations associated with rigid
bodies and the forces and moments acting on them. From elementary statics it is
known that the resultant of all external actions, i.e., forces and moments, exerted
on a rigid body can be reduced to a force f acting at a point, say A, and a moment</p>
<p/>
</div>
<div class="page"><p/>
<p>122 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>a b
</p>
<p>Fig. 3.8 Equivalent systems of force and moment acting on a rigid body
</p>
<p>nA. Alternatively, the same force f can be defined as acting at an arbitrary point
P of the body, as depicted in Fig. 3.8, but then the resultant moment nP changes
correspondingly.
</p>
<p>In order to establish a relationship between nA and nP , the moment of the first
system of force and moment with respect to point P is equated to the moment about
the same point of the second system, thus obtaining
</p>
<p>nP D nA C .a � p/ � f (3.106)
</p>
<p>which can be rewritten as
</p>
<p>nP D nA C f � .p � a/ (3.107)
</p>
<p>whence the analogy with Eq. (3.50) is apparent. Indeed, nP and nA of Eq. (3.107)
play the role of the velocities of P and A, Pp and Pa, respectively, whereas f of
Eq. (3.107) plays the role of ! of Eq. (3.50). Thus, similar to Theorem 3.4.2,
one has
</p>
<p>Theorem 3.7.1. For a given system of forces and moments acting on a rigid body, if
</p>
<p>the resultant force is applied at any point of a particular line L00, then the resultant
moment is of minimum magnitude. Moreover, that minimum-magnitude moment is
</p>
<p>parallel to the resultant force.
</p>
<p>Hence, the resultant of the system of forces and moments is equivalent to a
force f acting at a point of L00 and a moment n, with both f and n parallel to L00.
Paraphrasing the definition of the ISA, one defines line L00 as the axis of the wrench
acting on the body. Let n0 be the minimum-magnitude moment. Paraphrasing
Eq. (3.52) in turn, n0 can be expressed as
</p>
<p>n0 D n0
f
</p>
<p>kfk ; n0 �
nP � f
kfk (3.108)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.7 Static Analysis of Rigid Bodies 123
</p>
<p>Moreover, the pitch of the wrench, p00, is defined as
</p>
<p>p00 � n0kfk D
nP � f
kfk2 or p
</p>
<p>00 D 2�nP � fkfk2 (3.109)
</p>
<p>which, again, has units of m/rad or, correspondingly, of m/turn. Of course, the
wrench axis can be defined by its Pl&uuml;cker array, pL00 , i.e.,
</p>
<p>pL00 �
�
</p>
<p>e00
</p>
<p>n00
</p>
<p>�
</p>
<p>; e00 D fkfk ; n
00 D p � e00 (3.110)
</p>
<p>where e00 is the unit vector parallel to L00, n00 is the moment of L00 about the origin,
and p is the position vector of any point on L00.
</p>
<p>The wrench axis is fully specified, then, by the direction of f and point P 000 of
position vector p000 lying closest to the origin, which can be derived by analogy with
Eq. (3.70), namely, as
</p>
<p>p000 D
1
</p>
<p>kfk2 f � .nA � f � a/ (3.111)
</p>
<p>Similar to Theorem 3.4.1, one has
</p>
<p>Theorem 3.7.2. Consider a system of moments and forces acting on a rigid body,
</p>
<p>with the resultant force applied at an arbitrary point of the body. The projection of
</p>
<p>the resultant moment onto the wrench axis is identical for all points.
</p>
<p>From the foregoing discussion, then, the wrench applied to a rigid body can
be fully specified by the resultant force f acting at an arbitrary point P and
the associated moment, nP . We shall derive presently the counterpart of the six-
dimensional array of the twist, namely, the wrench array. Upon multiplication of
the screw of Eq. (3.71) by an amplitude A with units of force, what we will obtain
would be a wrench w, i.e., a six-dimensional array with its first three components
having units of force and its last components units of moment. We would like to
be able to obtain the power developed by the wrench on the body moving with the
twist t by a simple inner product of the two arrays. However, because of the form the
wrench w has taken, the inner product of these two arrays would be meaningless,
for it would involve the sum of two scalar quantities with different units; moreover,
none of the two quantities has an immediate physical meaning. In fact, the first
scalar would have units of force by frequency (angular velocity by force), while the
second would have units of moment of moment multiplied by frequency (velocity
by moment), thereby leading to a physically meaningless result. This inconsistency
can be resolved if we redefine the wrench not simply as the product of a screw by an
amplitude, but as a linear transformation of that screw involving the 6 � 6 array &#128;
defined as
</p>
<p>&#128; �
�
</p>
<p>O 1
</p>
<p>1 O
</p>
<p>�
</p>
<p>(3.112)</p>
<p/>
</div>
<div class="page"><p/>
<p>124 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>where O and 1 denote, respectively, the 3 � 3 zero and identity matrices. Now we
define the wrench as a linear transformation of the screw s defined in Eq. (3.71). This
transformation is obtained upon multiplying s by the product A&#128; , the amplitude A
having units of force, i.e.,
</p>
<p>w � A&#128;s �
�
</p>
<p>p � .Ae/C p.Ae/
Ae
</p>
<p>�
</p>
<p>The foregoing wrench is given in axis coordinates, while the twist was given in ray
coordinates.
</p>
<p>Now, the first three components of the foregoing array can be readily identified
as the moment of a force of magnitude A acting along a line of action given by the
Pl&uuml;cker array of Eq. (3.110), with respect to a point P , to which a moment parallel
to that line and of magnitude pA is added. Moreover, the last three components of
that array pertain apparently to a force of magnitude A and parallel to the same line.
We denote here the above-mentioned moment by n and the force by f, i.e.,
</p>
<p>f � Ae; n � p � fC pf
</p>
<p>The wrench w is then defined as
</p>
<p>w �
�
</p>
<p>n
</p>
<p>f
</p>
<p>�
</p>
<p>(3.113)
</p>
<p>which can thus be interpreted as a representation of a system of forces and moments
acting on a rigid body, with the force acting at point P of the body B defined above
and a moment n. Under these circumstances, we say that w acts at point P of B.
</p>
<p>With the foregoing definitions it is now apparent that the wrench has been defined
so that the inner product tTw will produce the power&hellip; developed by w acting at P
when B moves with a twist t defined at the same point, i.e.,
</p>
<p>&hellip; D tTw (3.114)
</p>
<p>When a wrench w that acts on a rigid body moving with the twist t develops zero
power onto the body, we say that the wrench and the twist are reciprocal to each
other. By the same token, the screws associated with that wrench&ndash;twist pair are said
to be reciprocal. More specifically, let the wrench and the twist be given in terms of
their respective screws, sw and st , as
</p>
<p>w D W &#128;sw; t D T st ; (3.115)
</p>
<p>where W and T are the amplitudes of the wrench and the twist, respectively, while
&#128; is as defined in Eq. (3.112). Thus, the two screws sw and st are reciprocal if
</p>
<p>.&#128;sw/
T st � sTw&#128;T st D 0 (3.116)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.8 Dynamics of Rigid Bodies 125
</p>
<p>and by virtue of the symmetry of &#128; , the foregoing relation can be further
expressed as
</p>
<p>sTw&#128;st D 0 or sTt &#128;sw D 0 (3.117)
</p>
<p>The product sTw&#128;st or its equivalent s
T
t &#128;sw is termed the reciprocal product of the
</p>
<p>two screws st and sw.
Now, if A and P are arbitrary points of a rigid body, we define the wrench at
</p>
<p>these points as
</p>
<p>wA �
�
</p>
<p>nA
</p>
<p>f
</p>
<p>�
</p>
<p>; wP �
�
</p>
<p>nP
</p>
<p>f
</p>
<p>�
</p>
<p>(3.118)
</p>
<p>Therefore, Eq. (3.106) leads to
</p>
<p>wP D VwA (3.119a)
</p>
<p>where
</p>
<p>V �
�
</p>
<p>1 A � P
0 1
</p>
<p>�
</p>
<p>(3.119b)
</p>
<p>with A and P already defined in Eq. (3.83b) as the cross-product matrices of vectors
a and p, respectively. Thus, wP is a linear transformation of wA. By analogy with
the twist-transfer formulas of Eqs. (3.83a and b), Eqs. (3.119a and b) are termed here
the wrench-transfer formulas.
</p>
<p>Multiplying the transpose of Eq. (3.83a) by Eq. (3.119a) yields
</p>
<p>tTPwP D tTAUTVwA (3.120)
</p>
<p>where
</p>
<p>UTV D
�
</p>
<p>1 �AC P
0 1
</p>
<p>� �
</p>
<p>1 A � P
0 1
</p>
<p>�
</p>
<p>D 16�6 (3.121)
</p>
<p>with 16�6 denoting the 6 � 6 identity matrix. Thus, tTPwP D tTAwA, as expected,
since the wrench develops the same amount of power, regardless of where the force
is assumed to be applied. Also note that an interesting relation between U and V
follows from Eq. (3.121), namely,
</p>
<p>V�1 D UT (3.122)
</p>
<p>3.8 Dynamics of Rigid Bodies
</p>
<p>The equations governing the motion of rigid bodies are recalled in this section and
cast into a form suitable to multibody dynamics. A rigid body B of mass density �,
which need not be uniform, is assumed at the outset. It is further assumed that the</p>
<p/>
</div>
<div class="page"><p/>
<p>126 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>body is under motion, with angular velocity !. The kinetic energy of B is defined
as the integral of the elementary kinetic energy of a differential element dB of the
body over the whole body. The mass of the body is thus given by
</p>
<p>m D
Z
</p>
<p>B
</p>
<p>�dB (3.123)
</p>
<p>B denoting also the region of the three-dimensional space occupied by the body.
Given that the laws of classical mechanics&mdash;as exemplified by the Newton&ndash;Euler
equations, to be recalled presently&mdash;hold only in inertial frames, the concept is now
introduced:
</p>
<p>An inertial frame is a coordinate system that translates with uniform velocity and constant
orientation with respect to the stars.
</p>
<p>Now, if p denotes the position vector of an arbitrary point P of the body, from
the originO of a given inertial frame, the mass first moment of the body with respect
to O , qO , is defined as
</p>
<p>qO �
Z
</p>
<p>B
</p>
<p>�pdB (3.124)
</p>
<p>Upon recalling the Mean-value Theorem of integral calculus (Brand 1965), there
exists a point C , of position vector c, such that
</p>
<p>Z
</p>
<p>B
</p>
<p>�pdB D mc
</p>
<p>point C thus being defined as the center of mass of B. That is,
</p>
<p>c � qO
m
</p>
<p>(3.125)
</p>
<p>Notice that point C need not be located within the physical boundary of B&mdash;
think, for example, of a homogeneous torus.
</p>
<p>Further, the mass second moment of the body with respect to O is introduced.
To this end, the kinetic energy of the rigid body, denoted by T , is defined as the
integral of the kinetic energy of the mass element dm � �dB of the body over the
whole body, i.e.,
</p>
<p>T �
Z
</p>
<p>B
</p>
<p>1
</p>
<p>2
�kPpk2dB (3.126)
</p>
<p>where Pp is the velocity of P and p is the position vector of P in the same inertial
frame, whose origin, for the sake of simplicity, is assumed to be stationary. Next,
the velocity of P is expressed as in Eq. (3.50), using a reference&mdash;or base&mdash;point; in
that equation, an arbitrary point A was used as a reference. It will prove convenient
to use the center of mass C as reference in the sequel. Thus,
</p>
<p>Pp D PcC! � r; r � p � c (3.127)</p>
<p/>
</div>
<div class="page"><p/>
<p>3.8 Dynamics of Rigid Bodies 127
</p>
<p>or, if matrix R � CPM.r/ is introduced, then
</p>
<p>Pp D Pc � R! (3.128)
</p>
<p>Upon substitution of the above expression into Eq. (3.126), an alternative expres-
sion for the kinetic energy is obtained:
</p>
<p>T D 1
2
</p>
<p>Z
</p>
<p>B
</p>
<p>�ŒkPck2 � 2PcTR!C!TRTR!&#141;dB
</p>
<p>The foregoing expression is now rewritten as the sum of three integrals:
</p>
<p>T D 1
2
kPck2
</p>
<p>Z
</p>
<p>B
</p>
<p>�dB
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>m
</p>
<p>�PcT
�Z
</p>
<p>B
</p>
<p>�RdB
</p>
<p>�
</p>
<p>!C 1
2
!T
</p>
<p>0
</p>
<p>@
</p>
<p>Z
</p>
<p>B
</p>
<p>� RTR
&bdquo;ƒ&sbquo;&hellip;
</p>
<p>�R2
dB
</p>
<p>1
</p>
<p>A! (3.129)
</p>
<p>Now, since R is skew-symmetric, its square expands according to Eq. (2.40),
namely,
</p>
<p>R2 D �krk21C rrT
</p>
<p>Furthermore, the integral appearing in the second term of Eq. (3.129) vanishes.
Indeed,
</p>
<p>Z
</p>
<p>B
</p>
<p>�RdB D
Z
</p>
<p>B
</p>
<p>�CPM.r/dB � CPM.
Z
</p>
<p>B
</p>
<p>�rdB/
</p>
<p>where the integral and the CPM. � / operators have been interchanged because
they are both linear and smooth.2 Further, if the definition of r is recalled from
Eq. (3.127), the above integral expands to
</p>
<p>Z
</p>
<p>B
</p>
<p>�RdB D CPM.
Z
</p>
<p>B
</p>
<p>�pdB
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
mc
</p>
<p>�c
Z
</p>
<p>B
</p>
<p>�dB
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
m
</p>
<p>/
</p>
<p>which indeed vanishes. Therefore, the kinetic energy of B reduces to
</p>
<p>T � 1
2
mkPck2 C 1
</p>
<p>2
!T Œ
</p>
<p>Z
</p>
<p>B
</p>
<p>�.krk21 � rrT /dB&#141;
&bdquo; ƒ&sbquo; &hellip;
</p>
<p>IC
</p>
<p>! (3.130)
</p>
<p>2Smoothness means that they do not introduce jump discontinuities upon differentiation.</p>
<p/>
</div>
<div class="page"><p/>
<p>128 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>which is known to be a positive-definite quantity, in that it (a) is positive and (b)
only vanishes when the body is stationary in an inertial frame, i.e., when both Pc
and ! vanish. In fact, the first term of the above expression is apparently positive-
definite, for its first factor, the mass, is positive, its second factor being the square
of a real quantity, namely, a Euclidean norm&mdash;which is itself positive. The second
term is a quadratic form in the angular-velocity vector, associated with matrix
IC , defined as the moment of inertia of B at the center of mass. As this is a
matrix, IC is also referred to as the moment-of-inertia matrix . This matrix is the
integral of the quantity in parentheses that appears multiplied by the density �,
an inherently positive quantity. The term in parentheses, however, is apparently
positive-semidefinite, as it equals the product RRT ; this product would be positive-
definite, were it not for the cross-product matrix R, which is known to be singular,
of rank 2&mdash;see Excercise 2.11. Therefore, IC is at least positive-semidefinite. As a
matter of fact, the only case in which IC is semidefinite occurs when B is one-
dimensional, i.e., a &ldquo;long&rdquo; body with two of its dimensions negligible with respect
to its length. This would be a body filling the space of a line segment, its moment-of-
inertia matrix having a nullity&mdash;dimension of its null space&mdash;of 1, with null space
spanned by a vector parallel to the line. Other than this rather unlikely case, IC is
positive-definite.
</p>
<p>Therefore, IC has three real eigenvalues, in general all three positive, known
as the principal moments of inertia, and three mutually orthogonal eigenvectors,
defining three principal axes of inertia of B, all three concurring at the center of
mass.
</p>
<p>Note, however, that the principal moments and the principal axes of inertia of
a rigid body depend on the point with respect to which the moment of inertia is
defined. Indeed, the moment of inertia can be defined about an arbitrary point of
the body, whether within its physical boundary or without. If, in Eq. (3.126), the
moment of inertia is taken with respect to an arbitrary point A of B, then, the
moment of inertia IA with respect to A is defined as
</p>
<p>IA �
Z
</p>
<p>B
</p>
<p>�Œkp � ak21 � .p � a/.p � a/T &#141;dB (3.131)
</p>
<p>Next, notice that, with the definition of r in Eq. (3.127), p � a can be expressed as
</p>
<p>p � a D r � .a � c/ (3.132)
</p>
<p>whence IA becomes
</p>
<p>IA D
Z
</p>
<p>B
</p>
<p>�fkr � .a � c/k21 � Œr � .a � c/&#141;Œr � .a � c/&#141;T gdB
</p>
<p>which expands to</p>
<p/>
</div>
<div class="page"><p/>
<p>3.8 Dynamics of Rigid Bodies 129
</p>
<p>IA D
Z
</p>
<p>B
</p>
<p>�.krk21 � rrT /dB
&bdquo; ƒ&sbquo; &hellip;
</p>
<p>IC
</p>
<p>C2 .�
Z
</p>
<p>B
</p>
<p>rT �dB/
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>0T
</p>
<p>.a � c/1C .a � c/
Z
</p>
<p>B
</p>
<p>rT �dB
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>0T
</p>
<p>C .
Z
</p>
<p>B
</p>
<p>r�dB/
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>0
</p>
<p>.a � c/T C
Z
</p>
<p>B
</p>
<p>�Œka � ck21 � .a � c/.a � c/T &#141;dB
&bdquo; ƒ&sbquo; &hellip;
</p>
<p>mŒka�ck21�.a�c/.a�c/T &#141;
</p>
<p>the final expression for IA thus being
</p>
<p>IA D IC CmŒka � ck21 � .a � c/.a � c/T &#141; (3.133a)
</p>
<p>which, in light of Eq. (2.39), can be cast in the form
</p>
<p>IA D IC Cm.A � C/.A � C/T (3.133b)
</p>
<p>a result known as Steiner&rsquo;s Theorem, a.k.a. the Theorem of Parallel Axes .
Next, the Newton&ndash;Euler equations governing the motion of a rigid body are
</p>
<p>recalled, with the body B acted upon by a wrench of force f applied at its center
of mass, and of moment nC about the center of mass. The Newton equation then
takes the form
</p>
<p>f D mRc (3.134a)
</p>
<p>whereas the Euler equation is
</p>
<p>nC D IC P!C! � IC! (3.134b)
</p>
<p>The momentum m and the angular momentum hC of a rigid body moving with a
velocity of its center of mass Pc and an angular velocity ! are defined below, the
angular momentum being defined, moreover, with respect to the center of mass.
These momenta are
</p>
<p>m � mPc; hC � IC! (3.135)
</p>
<p>Furthermore, the time-derivatives of the foregoing quantities are readily computed
(see Exercise 3.17) as
</p>
<p>Pm D mRc; PhC D IC P!C! � IC! (3.136)
</p>
<p>and hence, Eqs. (3.134a and b) take the forms
</p>
<p>f D Pm; nC D PhC (3.137)</p>
<p/>
</div>
<div class="page"><p/>
<p>130 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>The set of equations (3.134a and b) are known as the Newton&ndash;Euler equations .
These can be written in a more compact form as described below. First, a 6 � 6
matrix M is introduced that, following von Mises (1924), is termed here the inertia
dyad, namely,
</p>
<p>M �
�
</p>
<p>IC O
</p>
<p>O m1
</p>
<p>�
</p>
<p>(3.138)
</p>
<p>where O and 1 denote the 3�3 zero and identity matrices. A similar 6�6matrix was
defined by von Mises under the above name. However, von Mises&rsquo;s inertia dyad is
full, while the matrix defined above is block-diagonal. Both matrices, nevertheless,
denote the same physical property of a rigid body, i.e., its mass and moment of
inertia. Now the Newton&ndash;Euler equations can be written as
</p>
<p>MPtCWMt D w (3.139)
</p>
<p>in which matrix W, henceforth termed the angular-velocity dyad, by similarity with
the inertia dyad, is defined in turn as
</p>
<p>W �
�
</p>
<p>&#127; O
</p>
<p>O O
</p>
<p>�
</p>
<p>(3.140)
</p>
<p>with &#127; already defined as the angular-velocity matrix, namely, as CPM.!/. Note
that the twist of a rigid body lies in the null space of its angular-velocity dyad, i.e.,
</p>
<p>Wt D 0 (3.141)
</p>
<p>Further definitions are introduced below: the momentum screw of the rigid body
about the center of mass is the six-dimensional vector � defined as
</p>
<p>� �
�
</p>
<p>IC!
</p>
<p>mPc
</p>
<p>�
</p>
<p>DMt (3.142)
</p>
<p>Moreover, from Eqs. (3.136) and definition (3.142), the time-derivative of � can be
readily derived as3
</p>
<p>P� DMPtCW� DMPtCWMt (3.143)
</p>
<p>The kinetic energy of a rigid body undergoing a motion in which its center of
mass moves with velocity Pc and rotates with an angular velocity ! is given by
Eq. (3.130), repeated below for quick reference:
</p>
<p>T D 1
2
mkPck2 C 1
</p>
<p>2
!T IC! (3.144)
</p>
<p>3See Exercise 3.17.</p>
<p/>
</div>
<div class="page"><p/>
<p>3.9 Exercises 131
</p>
<p>From the foregoing definitions, then, the kinetic energy can now be written as a
quadratic form of the body twist, namely,
</p>
<p>T D 1
2
</p>
<p>tTMt (3.145)
</p>
<p>while the Newton&ndash;Euler equations can be written in a form more compact than that
of Eq. (3.139):
</p>
<p>P� D w (3.146)
</p>
<p>which is a six-dimensional vector equation.
Properly speaking, M, as given by Eq. (3.138), should be subscripted with C , to
</p>
<p>emphasize that the moment of inertia in the upper left block of M is taken with
respect to the center of mass. For brevity, we will dispense with this subscript
whenever the moment of inertia is centroidal. If the moment of inertia is taken
with respect to any other arbitrary point A, then the corresponding inertia dyad is
represented with MA. The reader is asked to verify that MA takes the form
</p>
<p>MA D
�
</p>
<p>IA m.C � A/
m.C � A/T m1
</p>
<p>�
</p>
<p>(3.147)
</p>
<p>Notice that, contrary to the inertia dyad defined with respect to the center of mass
in Eq. (3.138), which is block-diagonal, MA is full. It should not be too difficult
to prove that, regardless of the point with respect to which the moment of inertia
is defined, the inertia dyad is positive-definite&mdash;see Exercise 3.20. The proof, as
suggested in that exercise, hinges on a decomposition of MA in the form
</p>
<p>MA DMC CmPPT (3.148)
</p>
<p>The reader is invited to find an expression for P. The foregoing expression for MA
can be fairly referred to as Steiner&rsquo;s Theorem in dyad form.
</p>
<p>3.9 Exercises
</p>
<p>3.1 The cube of Fig. 3.9 is displaced from configuration AB : : :H into configura-
tion A0B 0 : : :H 0.
</p>
<p>(a) Determine the matrix representing the rotation Q undergone by the cube,
in X; Y; Z coordinates.
</p>
<p>(b) Find the Pl&uuml;cker coordinates of line L of the cube undergoing displace-
ments of minimum magnitude.
</p>
<p>(c) Find the intersections of L with the coordinate planes.</p>
<p/>
</div>
<div class="page"><p/>
<p>132 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>Fig. 3.9 Motion of a cube
</p>
<p>Fig. 3.10 A regular
tetrahedron
</p>
<p>3.2 Two unit forces, f1 and f2, are applied to the regular tetrahedron of unit-length
edges displayed in Fig. 3.10 in such a way that f1 is directed from P2 to P3,
whereas f2 is directed from P4 to P1. The effect of the foregoing system of
forces on the rigid tetrahedron is obtained by application of the resultant of
the two forces on a certain point P and a moment n. Find the location of point
P lying closest to P4 that will make the magnitude of n a minimum.</p>
<p/>
</div>
<div class="page"><p/>
<p>3.9 Exercises 133
</p>
<p>3.3 The moment of a line L1 about a second line L2 is a scalar � defined as
</p>
<p>� D n1 � e2
</p>
<p>where n1 is the moment of L1 about an arbitrary point P of L2, while e2
is a unit vector parallel to line L2. Apparently, the necessary and sufficient
condition for two lines to intersect is that the moment of one about the other
vanish.
</p>
<p>Using the above concept, show that the locus of all lines L intersecting
three given lines fLk g31 is a quadric, i.e., a surface defined by a function
that is quadratic in the position vector p of a point of the surface: f .p/ D
pTMpCgT pCh D 0; h &gt; 0. Notice that, the surface being generated by the
motion of a line constrained to touch the three given lines, the surface is bound
to be ruled. Now, there are only two ruled, second-order surfaces (Pottmann
and Wallner 2001), the one-sheet hyperboloid and the hyperbolic paraboloid.
Geometrically, the former is a closed surface, the latter open. Algebraically,
the former is characterized by a matrix coefficient M with det.M/ &lt; 0,
meaning that the matrix has two positive and one negative eigenvalues. The
hyperbolic paraboloid is characterized by a singular M, i.e., det.M/ D 0.
Show, furthermore, that det.M/ is nonzero&mdash;showing that det.M/ &lt; 0 is far
more challenging!&mdash;and hence, the quadric is a one-sheet hyperboloid. Hint:
Deriving the given expression for f .p/ should be done without resorting to
</p>
<p>components. Showing that M is singular requires resorting to components.
</p>
<p>To this end, choose the coordinate axes appropriately so as to avoid too
</p>
<p>cumbersome expressions.
3.4 A robotic gripper is provided with two redundant sensors that are meant to
</p>
<p>measure a wrench acting on the gripper. The i th sensor, moreover, has its
own coordinate frame, labeled Fi , for i D 1; 2. Sensor i reported the i th
measurement of the wrench wP , where subscript P indicates that the force is
applied at point P , as ŒwP &#141;i � ŒnT ; fT &#141;Ti , for i D 1; 2. These measurements
are given as
</p>
<p>Œn &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>5
</p>
<p>3
</p>
<p>5 ; Œ f &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>2
</p>
<p>0
</p>
<p>3
</p>
<p>5
</p>
<p>Œn &#141;2 D
</p>
<p>2
</p>
<p>4
</p>
<p>�5=3
�10=3
10=3
</p>
<p>3
</p>
<p>5 ; Œ f &#141;2 D
</p>
<p>2
</p>
<p>4
</p>
<p>�4=3
4=3
</p>
<p>2=3
</p>
<p>3
</p>
<p>5
</p>
<p>(a) Show that the measurements are compatible, based on invariance argu-
ments.
</p>
<p>(b) Determine the relative orientation of the two frames, i.e., find the rotation
matrix transforming F2-coordinates into F1-coordinates.</p>
<p/>
</div>
<div class="page"><p/>
<p>134 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>Fig. 3.11 A workpiece B to be grasped by a gripper G
</p>
<p>3.5 A robot-calibration method has been proposed that allows us to determine
the location of a joint axis, L, via the Pl&uuml;cker coordinates of the axis in a
coordinate frame fixed to the gripper. The Pl&uuml;cker coordinates are given as
�L D Œ eT ; nT &#141;T .
(a) Show that the distance of the axis to the origin of the gripper-fixed
</p>
<p>coordinate frame, d , can be determined as d D knk.
(b) Show that the point P � on the axis, which lies closest to the above-
</p>
<p>mentioned origin, has a position vector p� given as
</p>
<p>p� D e � n
</p>
<p>(c) From measurements on a robot, the Pl&uuml;cker coordinates were estimated,
in a gripper-fixed frame G, as
</p>
<p>Œ�L &#141;G D Œ�
p
2=2; 0;
</p>
<p>p
2=2; 0; �
</p>
<p>p
2; 0 &#141;T
</p>
<p>Find d and p� in gripper coordinates
</p>
<p>3.6 The gripper G of a robot is approaching a workpiece B, as indicated in
Fig. 3.11, with planes ˘1 and ˘2 parallel to each other and normal to ˘3.
The workpiece is made out of a cube of unit length from which two vertices
have been removed, thereby producing the equilateral triangular faces DEF
and D0E 0F 0. Moreover, two coordinate frames, F (X , Y , Z) and F 0 (X 0, Y 0,
Z0), are defined as indicated in the figure, in which Y is, apparently, parallel
to line D0C 0.</p>
<p/>
</div>
<div class="page"><p/>
<p>3.9 Exercises 135
</p>
<p>It is required to grasp B with G in such a way that planes ˘1 and ˘2
coincide with the triangular faces, while carrying the Y 0 axis to an orientation
perpendicular to the diagonal CC 0 of B. More concretely, in the grasping
configuration, frame F 0 is carried into F 00 (X 00, Y 00, and Z00), not shown in
the figure, in such a way that unit vectors i00, j00, k00, parallel to X 00, Y 00, Z00,
respectively, are oriented so that i00 has all three of its F-components positive,
while j00 has its Z-component positive.
</p>
<p>(a) Compute the angle of rotation of the motion undergone by G from a pose
in which F 0 and F have identical orientations, termed the reference pose,
and find the unit vector parallel to the axis of rotation, in frame F .
</p>
<p>(b) The position vector of point P of G is known to be, in the reference pose,
</p>
<p>Œp &#141;F D
</p>
<p>2
</p>
<p>4
</p>
<p>2
</p>
<p>�1
0:25
</p>
<p>3
</p>
<p>5
</p>
<p>Determine the set of points of G undergoing a displacement of minimum
magnitude, under the condition that P , in the displaced configuration of
G, coincides with C 0.
</p>
<p>3.7 In calibrating a robot, the Pl&uuml;cker coordinates of one of its axes are to be
determined in a given coordinate frame. To this end, the moment of this axis
is measured with respect to two points, A and B , of position vectors Œ a &#141; D
Œ 1; 0; 0 &#141;T and Œb &#141; D Œ 0; 1; 1 &#141;T , respectively. The said moments, nA and nB ,
respectively, are measured as
</p>
<p>ŒnA &#141; D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>2
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; ŒnB &#141; D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>with all entries given in meters.
</p>
<p>(a) Determine the unit vector e defining the direction of the axis under
discussion.
</p>
<p>(b) Find the coordinates of the point P � of the axis that lies closest to the
origin
</p>
<p>(c) Find the Pl&uuml;cker coordinates of the axis about the origin, i.e., the Pl&uuml;cker
coordinates of the axis in which the moment is defined with respect to the
origin.
</p>
<p>3.8 Prove that for any three-dimensional vectors ! and p,
</p>
<p>! � .! � � � � .! � .!
&bdquo; ƒ&sbquo; &hellip;
</p>
<p>2k factors
</p>
<p>�p// � � � / D .�1/k.k!k2k1 � k!k2.k�1/!!T /p
</p>
<p>! � .! � � � � .! � .!
&bdquo; ƒ&sbquo; &hellip;
</p>
<p>2kC1 factors
</p>
<p>�p// � � � / D .�1/k.k!k2k!/ � p</p>
<p/>
</div>
<div class="page"><p/>
<p>136 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>3.9 A &ldquo;small&rdquo; rotation is defined as that about an arbitrary axis parallel to the
unit vector e, through a &ldquo;small&rdquo; angle �, so that � � 1. Prove that the
angular-velocity vector, in the special case of &ldquo;small&rdquo; rotations, turns out to be
a time-derivative. What is the vector whose time-derivative yields the angular-
velocity vector?
</p>
<p>3.10 Derive an expression for the angular velocity ! in terms of Euler angles,
which were introduced in Exercise 2.19. More specifically, if we store the
Euler angles in array � D Œ �; �;  &#141;T , then, find the matrix W such that
</p>
<p>! DW P�
</p>
<p>Notice that, given � and!, an expression for P� can be obtained upon inverting
W. However, W is not always invertible. Find under which conditions W
becomes singular. Notice: The use of computer algebra is strongly recom-
mended to solve this exercise.
</p>
<p>3.11 A rectangular prism with regular hexagonal bases whose sides are 25 mm
long and whose height is 150 mm is to undergo a pick-and-place operation&mdash;
see Chap. 6 to understand what this means&mdash;that requires knowledge of
its centroid location and its moment-of-inertia matrix. Find the centroidal
principal axes and moments of inertia under the assumption that the prism
is made from a homogeneous material.
</p>
<p>3.12 The prism of Exercise 3.11 now undergoes a machining process cutting it into
two parts, which are separated by a plane that contains one of the edges of the
base and makes an angle of 45ı with the axis of the prism. Find the centroidal
principal axes and moments of inertia of each of the two parts.
</p>
<p>3.13 In Exercise 2.23 assume that a mass m is located at every point Pi of position
vector pi . Give a mechanical interpretation of the matrix mŒtr.PPT /1� PPT &#141;,
with P defined in that exercise.
</p>
<p>3.14 The centroidal inertia matrix of a rigid body is measured by two observers,
who report the two results below:
</p>
<p>Œ I &#141;A D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 2 0
</p>
<p>0 0 3
</p>
<p>3
</p>
<p>5 ; Œ I &#141;B D
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>6 2 2
</p>
<p>2 5 0
</p>
<p>2 0 7
</p>
<p>3
</p>
<p>5
</p>
<p>Show that the two measurements are acceptable. Hint: Use invariance argu-
ments.
</p>
<p>3.15 State the conditions under which a point and the center of mass of a rigid
body share the same principal axes of inertia. In other words, let IP and IC be
the moment-of-inertia matrices of a rigid body about a point P and its center
of mass, C , respectively. State the conditions under which the two matrices
have common eigenvectors. Moreover, under these conditions, what are the
relationships between the two sets of principal moments of inertia?</p>
<p/>
</div>
<div class="page"><p/>
<p>3.9 Exercises 137
</p>
<p>3.16 Show that the smallest principal moment of inertia of a rigid body attains its
minimum value at the center of mass.
</p>
<p>3.17 Show that the time-rate of change of the inertia dyad M of a rigid body is
given by
</p>
<p>PM DWM �MW
</p>
<p>Then, recall the momentum screw � defined as
</p>
<p>� �Mt
</p>
<p>where t is the twist of the body, defined at its center of mass. Now, with the
above expression for PM, restate the result displayed in Eq. (3.143), i.e., show
that
</p>
<p>P� DMPtCWMt
</p>
<p>3.18 A classical result in the dynamics of robots establishes a relation between the
time-derivative of the n � n inertia matrix I.�/ of a serial robot and what
is known as the &ldquo;Coriolis and centrifugal forces&rdquo; matrix C.�; P�/, where �
is the n-dimensional vector of joint angles&mdash;these concepts are the subject
of Chap. 7. According to this relation, the difference PI.�/� 2C.�; P�/ is skew-
symmetric. Show that the same relation holds for one single rigid body moving
in space under the action of a given wrench. That is, show that the difference
PM � 2WM is skew-symmetric, with M and W introduced in Sect. 3.8.
</p>
<p>3.19 A wrench w D ŒnT fT &#141;T , with f acting at point P of the gripper of Fig. 2.10,
is measured by a six-axis force sensor, to which a frame FS is attached, as
indicated in that figure. If points P and S lie a distance of 100 mm apart, find
the wrench in F2, when the readouts of the sensor are
</p>
<p>Œn &#141;S D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5 Nm; Œ f &#141;S D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>1
</p>
<p>0
</p>
<p>3
</p>
<p>5 N
</p>
<p>3.20 Derive Eq. (3.147). Moreover, show that MA, as given in that equation, is
positive-definite&mdash;Hint: show that MA can be expressed as MA D MC C
PPT , with MC positive-definite and PP
</p>
<p>T positive-semidefinite. The above
expression can be termed the 6 � 6 form of Steiner&rsquo;s Theorem, a.k.a. the
Parallel-Axis Theorem. Now, in trying to mimic Steiner&rsquo;s Theorem, one would
like to express P in the same form as the second term of Eq. (3.133a), as the
product mRRT , with R defined as a suitable 6 � 6 matrix. Can this matrix be
found? If yes, give an expression for R; if not, explain why.
</p>
<p>3.21 The inner (dot) product of two m � n matrices A and B can be defined as
tr.ABT /, which leads to the definition of the angle � between A and B as</p>
<p/>
</div>
<div class="page"><p/>
<p>138 3 Fundamentals of Rigid-Body Mechanics
</p>
<p>cos � D tr.ABT /=kAkkBk, where kAk D
p
</p>
<p>tr.AAT / with a similar definition
for kBk. Moreover, Eq. (3.86) can be regarded as the Cartesian decomposition
of the angular-acceleration matrix W. Show that the two components of the
foregoing decomposition are mutually orthogonal, which is a restatement of
the orthogonality of the tangential and the centripetal relative acceleration of
two points of a rigid body.</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 4
</p>
<p>Geometry of Decoupled Serial Robots
</p>
<p>4.1 Introduction
</p>
<p>This chapter is devoted to the displacement analysis of robotic manipulators of the
serial type, which we call the geometry of serial robots. The study is limited to
decoupled robots, to be defined below, the inverse displacement analysis of general
six-axis robots being the subject of Chap. 9. These robots serving mainly to perform
manipulation tasks, they are also referred to as manipulators.
</p>
<p>We begin by defining a serial, n-axis manipulator. In connection with this
manipulator, additionally, we will (a) introduce the Denavit&ndash;Hartenberg notation
for the definition of link frames that uniquely determine the architecture and the
configuration, or posture, of the manipulator at hand; (b) define the Cartesian and
joint coordinates of this manipulator; and (c) relate these two sets of variables by
means of its geometric model. Moreover, with regard to six-axis manipulators, we
will define decoupled manipulators and provide a procedure for the solution of their
inverse displacement model.
</p>
<p>4.2 The Denavit&ndash;Hartenberg Notation
</p>
<p>One of the first tasks of a robotics engineer is the geometric modeling of a robotic
manipulator. This task consists in devising a model that can be unambiguously (a)
described to a control unit through a database and (b) interpreted by other robotics
engineers. The purpose of this task is to give manipulating instructions to a robot,
regardless of the dynamics of the manipulated load and the robot itself. The simplest
way of geometrically modeling a robotic manipulator is by means of the concept of
</p>
<p>Electronic supplementary material The online version of this article (doi: 10.1007/978-3-319-
01851-5_4) contains supplementary material, which is available to authorized users.
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__4,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>139</p>
<p/>
</div>
<div class="page"><p/>
<p>140 4 Geometry of Decoupled Serial Robots
</p>
<p>Fig. 4.1 The two basic lower kinematic pairs: the revolute and the prismatic joints
</p>
<p>kinematic chain. A kinematic chain is a set of rigid bodies, also called links, coupled
by kinematic pairs, also termed joints. A kinematic pair is, then, the coupling of two
rigid bodies so as to constrain their relative motion. We distinguish two basic types
of kinematic pairs, namely, higher and lower kinematic pairs. A higher kinematic
pair arises between rigid bodies when contact takes place along a line or at a point.
This type of coupling occurs in cam-and-follower mechanisms, gear trains, and
roller bearings, for example. A lower kinematic pair occurs when contact takes place
along a surface common to the two bodies. Six different types of lower kinematic
pairs can be distinguished (Angeles 1982; Hartenberg and Denavit 1964), but all
these can be produced from two basic types, namely, the rotating pair, denoted by
R and also called revolute, and the sliding pair, represented by P and also called
prismatic.
</p>
<p>The common surface along which contact takes place in a revolute pair is
commonly billed as a cylinder. However, a cylinder exhibits two kinds of symmetry,
of revolution and of extrusion, a cylindrical surface thus allowing for both rotation
about the axis of the cylinder and translation along a direction parallel to the axis.
For this reason, an axially symmetric surface devoid of symmetry of extrusion was
proposed by Khan and Angeles (2011). A typical realization of the revolute joint is
the coupling through journal bearings. Thus, two rigid bodies coupled by a revolute
can rotate relative to each other about the axis of the common cylinder, which is thus
referred to as the axis of the revolute, but are prevented from undergoing relative
translations as well as rotations about axes other than the cylinder axis. On the
other hand, the common surface of contact between two rigid bodies coupled by
a prismatic pair is a prism of arbitrary cross section, and hence, the two bodies
coupled in this way are prevented from undergoing any relative rotation and can
move only in a pure-translation motion along a direction parallel to the axis of the
prism. As an example of this kinematic pair, one can cite the dovetail coupling. Note
that whereas the revolute axis is a totally defined line in three-dimensional space,
the prismatic pair has no axis; this pair has only a direction. That is, the prismatic
pair does not have a particular location in space. Nevertheless, and for the sake of
conciseness, we will refer to joint axis generically, when speaking of either revolute
or prismatic joints. Bodies coupled by a revolute and a prismatic pair are shown in
Fig. 4.1.</p>
<p/>
</div>
<div class="page"><p/>
<p>4.2 The Denavit&ndash;Hartenberg Notation 141
</p>
<p>Serial manipulators will be considered in this chapter, their associated kinematic
chains thus being of the simple type, i.e., each and every link is coupled to at most
two other links. A simple kinematic chain can be either closed or open. It is closed
if each and every link is coupled to two other links, the chain then being called a
linkage; it is open if it contains exactly two links, the end ones, that are coupled to
only one other link. Thus, simple kinematic chains studied in this chapter are open,
and in the particular robotics terminology, their first link is called the manipulator
base, whereas their last link is termed the end-effector (EE).
</p>
<p>Thus, the kinematic chains associated with manipulators of the serial type are
composed of binary links, the intermediate ones, and exactly two simple links, those
at the ends. Hence, except for the end links, all links carry two kinematic pairs,
and as a consequence, two pair axes&mdash;just remember that a prismatic pair has a
direction but no axis. In order to uniquely describe the architecture of a kinematic
chain, i.e., the relative location and orientation of its neighboring pair axes, the
Denavit&ndash;Hartenberg notation (Denavit and Hartenberg 1955) is introduced. To this
end, links are numbered 0; 1; : : : ; n, the i th pair being defined as that coupling the
.i � 1/st link with the i th link. Hence, the manipulator is assumed to be composed
of nC 1 links and n pairs; each of the latter can be either R or P, where link 0 is the
fixed base, while link n is the end-effector. Next, a coordinate frame Fi is defined
with originOi and axesXi ; Yi ; Zi . This frame is attached to the .i �1/st link&mdash;not
to the i th link!&mdash;for i D 1; : : : ; n C 1. This is the classical Denavit&ndash;Hartenberg
notation. Khalil and collaborators (Khalil and Dombre 2002) modified this notation
to make it &ldquo;less ambiguous.&rdquo; In the balance of the book we follow the classical
notation. For the first n frames, this is done following the rules given below:
</p>
<p>1. Zi is the axis of the i th pair. Notice that there are two possibilities of defining the
positive direction of this axis, since each pair axis is only a line, not a directed
segment. Moreover, the Zi axis of a prismatic pair can be located arbitrarily,
since only its direction is defined.
</p>
<p>2. Xi is defined as the common perpendicular to Zi�1 and Zi , directed from the
former to the latter, as shown in Fig. 4.2a. Notice that if these two axes intersect,
the positive direction of Xi is undefined and hence, can be freely assigned.
Henceforth, we will follow the right-hand rule in this case. This means that if
unit vectors ii ; ki�1, and ki are attached to axes Xi ; Zi�1, and Zi , respectively,
as indicated in Fig. 4.2b, then ii is defined as ki�1 � ki . Moreover, if Zi�1 and
Zi are parallel, the location of Xi is undefined. In order to define it uniquely, we
will specify Xi as passing through the origin of the .i � 1/st frame, as shown in
Fig. 4.2c.
</p>
<p>3. The distance between Zi and ZiC1 is defined as ai , which is thus nonnegative.
4. The Zi -coordinate of the intersection O 0i of Zi with XiC1 is denoted by bi .
</p>
<p>Since this quantity is a coordinate, it can be either positive or negative. Its
absolute value is the distance betweenXi andXiC1, also called the offset between
successive common perpendiculars to the corresponding joint axes.
</p>
<p>5. The angle between Zi and ZiC1 is defined as ˛i and is measured about the
positive direction of XiC1. This item is known as the twist angle between
successive pair axes.</p>
<p/>
</div>
<div class="page"><p/>
<p>142 4 Geometry of Decoupled Serial Robots
</p>
<p>a b
</p>
<p>c
</p>
<p>Fig. 4.2 Definition of Xi when Zi�1 and Zi : (a) are skew; (b) intersect; and (c) are parallel
</p>
<p>6. The angle between Xi and XiC1 is defined as �i and is measured about the
positive direction of Zi .
</p>
<p>The (nC 1)st coordinate frame is attached to the far end of the nth link. Since the
manipulator has no (nC1)st link, the foregoing rules do not apply to the definition of
this frame. The analyst, thus, has the freedom to define this frame as it best suits the
task at hand. Notice that nC1 frames, F1, F2, : : :, FnC1, have been defined, whereas
links are numbered from 0 to n. In summary, a n-axis manipulator is composed of
nC1 links and nC1 coordinate frames. These rules are illustrated with an example
below.
</p>
<p>Consider the architecture depicted in Fig. 4.3, usually referred to as a Puma
robot, which shows seven links, numbered from 0 to 6, and seven coordinate frames,
numbered from 1 to 7. Note that the last frame is arbitrarily defined, but its origin is
placed at a specific point of the EE, namely, at the operation point P , which is used
to define the task at hand. Furthermore, three axes intersect at a point C , and hence,
all points of the last three links move on concentric spheres with respect to F4,
for which reason the subchain comprising these three links is known as a spherical
wrist, point C being its center. By the same token, the subchain composed of the
first four links is called the arm. Thus, the wrist is decoupled from the arm, and is
used for orientation purposes, the arm being used for the positioning of point C .</p>
<p/>
</div>
<div class="page"><p/>
<p>4.2 The Denavit&ndash;Hartenberg Notation 143
</p>
<p>Fig. 4.3 Coordinate frames of a Puma robot
</p>
<p>The arm is sometimes called the regional structure and the wrist the local structure,
the overall manipulator thus being of the decoupled type.
</p>
<p>In the foregoing discussion, if the i th pair is R, then all quantities involved in
those definitions are constant, except for �i , which is variable and is thus termed
the joint variable of the i th pair. The other quantities, i.e., ai , bi , and ˛i , are the
joint parameters of the same pair. If, alternatively, the i th pair is P, then bi is
variable, and the other quantities are constant. In this case, the joint variable is
bi , and the joint parameters are ai , ˛i , and �i . Notice that associated with each
joint there are exactly one joint variable and three constant parameters. Hence,
a n-axis manipulator has n joint variables&mdash;which are henceforth grouped in the
n-dimensional vector � , regardless of whether the joint variables are angular or
translational&mdash;and 3n constant parameters. The latter define the architecture of the
manipulator, while the former determine its configuration, or posture.
</p>
<p>Whereas the manipulator architecture is fully defined by its 3n Denavit&ndash;
Hartenberg (DH) parameters, its posture is fully defined by its n joint variables,
also called its joint coordinates, once the DH parameters are known. The relative
pose&mdash;position and orientation&mdash;between links is fully specified, then, from the
background of Chap. 2, by (a) the rotation matrix taking the Xi ; Yi ; Zi axes into a
configuration in which they are parallel pairwise to the XiC1; YiC1; ZiC1 axes, and
(b) the position vector of the origin of the latter in the former. The representations
of the foregoing items in coordinate frame Fi will be discussed presently. First, we
obtain the matrix representation of the rotation Qi carrying Fi into an orientation
coincident with that of FiC1, assuming, without loss of generality because we are
interested only in changes of orientation, that the two origins are coincident, as
depicted in Fig. 4.4. This matrix is most easily derived if the rotation of interest is
decomposed into two successive rotations, as indicated in Fig. 4.5. In that figure,
X 0i ; Y
</p>
<p>0
i ; Z
</p>
<p>0
i is an intermediate coordinate frame F
</p>
<p>0
i , obtained by rotating Fi about</p>
<p/>
</div>
<div class="page"><p/>
<p>144 4 Geometry of Decoupled Serial Robots
</p>
<p>Fig. 4.4 Relative orientation
of the i th and .i C 1/st
coordinate frames
</p>
<p>a b
</p>
<p>Fig. 4.5 (a) Rotation about axis Zi through an angle �i ; and (b) relative orientation of the i 0th
and the .i C 1/st coordinate frames
</p>
<p>the Zi axis through an angle �i . Then, the intermediate frame is rotated about Xi 0
through an angle ˛i , which takes it into a configuration coincident with FiC1. Let the
foregoing rotations be denoted by ŒCi &#141;i and Œƒi &#141;i 0 , respectively, which are readily
derived for they are in the canonical forms (2.56c) and (2.56a), respectively.
</p>
<p>Moreover, let
</p>
<p>�i � cos˛i ; �i � sin˛i (4.1a)
</p>
<p>One thus has, using subscripted brackets as introduced in Sect. 2.2,
</p>
<p>ŒCi &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>cos �i � sin �i 0
sin �i cos �i 0
0 0 1
</p>
<p>3
</p>
<p>5 ; Œƒi &#141;i 0 D
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 �i ��i
0 �i �i
</p>
<p>3
</p>
<p>5 (4.1b)</p>
<p/>
</div>
<div class="page"><p/>
<p>4.2 The Denavit&ndash;Hartenberg Notation 145
</p>
<p>and hence, the matrix sought is computed simply as
</p>
<p>ŒQi &#141;i D ŒCi &#141;i Œƒi &#141;i 0 (4.1c)
</p>
<p>Henceforth, we will use the abbreviations introduced below:
</p>
<p>Qi � ŒQi &#141;i ; Ci � ŒCi &#141;i ; ƒi � Œƒi &#141;i 0 (4.1d)
</p>
<p>thereby doing away with brackets, when these are self-understood. Thus,
</p>
<p>Qi � ŒQi &#141;i �
</p>
<p>2
</p>
<p>4
</p>
<p>cos �i ��i sin �i �i sin �i
sin �i �i cos �i ��i cos �i
0 �i �i
</p>
<p>3
</p>
<p>5 (4.1e)
</p>
<p>One more factoring of matrix Qi , which will be used in Chap. 9, is given below:
</p>
<p>Qi D ZiXi (4.2a)
</p>
<p>with Xi and Zi defined as two pure reflections, the former about the YiZi plane, the
latter about the XiYi plane, namely,
</p>
<p>Xi �
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 ��i �i
0 �i �i
</p>
<p>3
</p>
<p>5 ; Zi �
</p>
<p>2
</p>
<p>4
</p>
<p>cos �i sin �i 0
sin �i � cos �i 0
0 0 1
</p>
<p>3
</p>
<p>5 (4.2b)
</p>
<p>Note that both Xi and Zi are symmetric and self-inverse&mdash;see Sect. 2.2. In order
to derive an expression for the position vector ai connecting the originOi of Fi with
that of FiC1, OiC1, reference is made to Fig. 4.6, showing the relative positions of
the different origins and axes involved. From this figure, apparently,
</p>
<p>ai �
��!
OiO iC1 D
</p>
<p>���!
OiO
</p>
<p>0
i C
��!
O 0iO iC1 (4.3a)
</p>
<p>where obviously,
</p>
<p>Œ
���!
OiO
</p>
<p>0
i &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>bi
</p>
<p>3
</p>
<p>5 ; Œ
��!
O 0iO iC1 &#141;iC1 D
</p>
<p>2
</p>
<p>4
</p>
<p>ai
0
</p>
<p>0
</p>
<p>3
</p>
<p>5
</p>
<p>Now, in order to compute the sum appearing in Eq. (4.3a), the two foregoing
vectors should be expressed in the same coordinate frame, namely, Fi . Thus,
</p>
<p>Œ
��!
O 0iO iC1 &#141;i D ŒQi &#141;i Œ
</p>
<p>��!
O 0iO iC1 &#141;iC1 D
</p>
<p>2
</p>
<p>4
</p>
<p>ai cos �i
ai sin �i
0
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>146 4 Geometry of Decoupled Serial Robots
</p>
<p>and hence,
</p>
<p>Œ ai &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>ai cos �i
ai sin �i
bi
</p>
<p>3
</p>
<p>5 (4.3b)
</p>
<p>For brevity, we introduce one more definition:
</p>
<p>ai � Œ ai &#141;i (4.3c)
</p>
<p>Similar to the foregoing factoring of Qi , vector ai admits the factoring
</p>
<p>ai D Qibi (4.3d)
</p>
<p>where bi is given by
</p>
<p>bi �
</p>
<p>2
</p>
<p>4
</p>
<p>ai
bi�i
bi�i
</p>
<p>3
</p>
<p>5 (4.3e)
</p>
<p>with the definitions introduced in Eq. (4.1a). Hence, vector bi is constant for revolute
pairs. From the geometry of Fig. 4.6, it should be apparent that bi is nothing but ai
in FiC1, i.e.,
</p>
<p>bi D Œai &#141;iC1 :
</p>
<p>Matrices Qi can also be regarded as coordinate transformations. Indeed, let ii , ji ,
and ki be the unit vectors parallel to the Xi , Yi , and Zi axes, respectively, directed
in the positive direction of these axes. From Fig. 4.6, it is apparent that
</p>
<p>Œ iiC1 &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>cos �i
sin �i
0
</p>
<p>3
</p>
<p>5 ; ŒkiC1 &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>�i sin �i
��i cos �i
</p>
<p>�i
</p>
<p>3
</p>
<p>5
</p>
<p>whence
</p>
<p>Œ jiC1 &#141;i D ŒkiC1 � iiC1 &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>��i sin �i
�i cos �i
�i
</p>
<p>3
</p>
<p>5
</p>
<p>Therefore, the components of iiC1, jiC1, and kiC1 in Fi are nothing but the
first, second, and third columns of Qi . In general, then, any vector v in FiC1 is
transformed into Fi in the form</p>
<p/>
</div>
<div class="page"><p/>
<p>4.2 The Denavit&ndash;Hartenberg Notation 147
</p>
<p>Fig. 4.6 Layout of three successive coordinate frames
</p>
<p>Œ v &#141;i D ŒQi &#141;i Œ v &#141;iC1
</p>
<p>which is a similarity transformation, as defined in Eq. (2.118). Likewise, any matrix
M in FiC1 is transformed into Fi by the corresponding similarity transformation, as
given by Eq. (2.128):
</p>
<p>ŒM &#141;i D ŒQi &#141;i ŒM &#141;iC1ŒQTi &#141;i
</p>
<p>The inverse relations follow immediately in the form
</p>
<p>Œ v &#141;iC1 D ŒQTi &#141;i Œ v &#141;i ; ŒM &#141;iC1 D ŒQTi &#141;i ŒM &#141;i ŒQi &#141;i
</p>
<p>or, upon recalling the first of definitions (4.1d),
</p>
<p>Œ v &#141;i D Qi Œ v &#141;iC1; ŒM &#141;i D Qi ŒM &#141;iC1QTi (4.4a)
Œ v &#141;iC1 D QTi Œ v &#141;i ; ŒM &#141;iC1 D QTi ŒM &#141;iQi (4.4b)
</p>
<p>Moreover, if we have a chain of i frames, F1, F2, : : :, Fi , then the inward coordinate
transformation from Fi to F1 is given by
</p>
<p>Œ v &#141;1 D Q1Q2 � � �Qi�1Œ v &#141;i (4.5a)
ŒM &#141;1 D Q1Q2 � � �Qi�1ŒM &#141;i .Q1Q2 � � �Qi�1/T (4.5b)</p>
<p/>
</div>
<div class="page"><p/>
<p>148 4 Geometry of Decoupled Serial Robots
</p>
<p>109
</p>
<p>LR
M
</p>
<p>at
e
</p>
<p>80
</p>
<p>320
</p>
<p>75
</p>
<p>300
</p>
<p>330
</p>
<p>75
</p>
<p>123104
</p>
<p>251
</p>
<p>a b
</p>
<p>c
d
</p>
<p>Fig. 4.7 The data sheet of the FANUC LRMate 200iC robot, with all dimensions in mm: (a) top
view; (b) orthographic projection; (c) side view; and (d) front view
</p>
<p>Likewise, the outward coordinate transformation takes the form
</p>
<p>Œ v &#141;i D .Q1Q2 � � �Qi�1/T Œ v &#141;1 (4.6a)
ŒM &#141;i D .Q1Q2 � � �Qi�1/T ŒM &#141;1Q1Q2 � � �Qi�1 (4.6b)
</p>
<p>Example 4.2.1. The data sheet of the six-axis FANUC LR Mate 200iC robot is
displayed in Fig. 4.7. Define seven coordinate frames, according with the Denavit&ndash;
Hartenberg notation, with F1 fixed to the base and F7 to the EE. Then, produce a
table containing the 18 (constant) Denavit&ndash;Hartenberg parameters of the robot.
</p>
<p>Solution: First, the sevenZi -axes are identified. Going from the base upwards,Z1
is vertical, while Z2 and Z3 are horizontal, 300 mm apart, as per the side view, Z1</p>
<p/>
</div>
<div class="page"><p/>
<p>4.2 The Denavit&ndash;Hartenberg Notation 149
</p>
<p>a1
</p>
<p>a2
</p>
<p>a3
</p>
<p>b1
</p>
<p>b4
</p>
<p>b6
</p>
<p>O1
</p>
<p>O
1
</p>
<p>O2
</p>
<p>O
3
</p>
<p>O4,O5
</p>
<p>P , O
6
</p>
<p>X1
</p>
<p>X2
</p>
<p>X3
</p>
<p>X4
</p>
<p>X5
</p>
<p>X6
</p>
<p>X7
</p>
<p>Z1
</p>
<p>Z2
</p>
<p>Z3
</p>
<p>Z4
Z5
</p>
<p>Z6,Z7
</p>
<p>0
</p>
<p>1
</p>
<p>2
</p>
<p>3
</p>
<p>4
5
</p>
<p>6
</p>
<p>O7
</p>
<p>Fig. 4.8 The kinematic chain
of the FANUC LRMate
200iC robot at an arbitrary
posture
</p>
<p>lying 75 mm from the vertical plane defined byZ2 andZ3.Z4 appears horizontal in
Fig. 4.7, 75 mm above Z3, but it can attain other orientations. Moreover, Z5 is also
displayed horizontal in Fig. 4.7 parallel to Z2 and Z3; however, since Z4 turns the
link to which Z5 is fixed, the one with the robot name painted in the orthographic
projection, Z5, in general, is not parallel to the two forgoing axes, Furthermore, in
the same figure,Z6, the axis of symmetry of the end plate, to which the EE is rigidly
attached, is shown coincident with Z4, but in general, these two axes intersect,
together with Z5, at the point located in the side view 80 mm from the plane of the
end plate and .330C 300C 75 D/705mm from the plane of the base. The point at
which Z4, Z5 and Z6 intersect is the center C of the wrist. To ease the definition of
the DH parameters, the robot kinematic chain is displayed in Fig. 4.8 in an arbitrary
posture. With the Zi axes, for i D 1; : : : ; 6, identified, Z7 is defined as coinciding
with Z6 for simplicity, as this axis is not bound by the DH notation. Likewise, X1
can be defined arbitrarily, as long as it (a) is horizontal and (b) intersectsZ1. Finally,
X7 can also be defined arbitrarily, as long as it intersects Z7 at right angles. In the
next step, the Xi -axes are defined according with the DH notation. Once all 14 axes
are defined, the definition of the DH parameters is straightforward: the ai parameters
are simple, bi are less so, but their determination is eased once the O 0i intersections
have been identified. These parameters are listed in Table 4.1.</p>
<p/>
</div>
<div class="page"><p/>
<p>150 4 Geometry of Decoupled Serial Robots
</p>
<p>Table 4.1 The DH
parameters of the FANUC
LRMate 200iC robot
</p>
<p>i ai (mm) bi (mm) ˛i .ı/
</p>
<p>1 75 330 �90
2 300 0 0
3 75 0 �90
4 0 320 90
5 0 0 90
6 0 80 0
</p>
<p>4.3 The Geometric Model of Six-Revolute Manipulators
</p>
<p>The kinematics of serial manipulators begins with the study of the geometric
relations between joint variables and Cartesian variables. The former were defined
in Sect. 4.2 as those determining the posture of a given manipulator, with one such
variable per joint; a six-axis manipulator, like the one displayed in Fig. 4.9, thus has
six joint variables, �1, �2, : : :, �6. The Cartesian variables of a manipulator, in turn,
are those variables defining the pose of the EE; since six independent variables are
needed to define the pose of a rigid body, the manipulator of Fig. 4.9 thus involves
six Cartesian variables.
</p>
<p>The study outlined above pertains to the geometry of the manipulator, for it
involves one single pose of the EE. Besides geometry, the kinematics of manipu-
lators comprises the study of the relations between the time-rates of change of the
joint variables, referred to as the joint rates, and the twist of the EE. Additionally,
the relations between the second time-derivatives of the joint variables, referred to
as the joint accelerations, with the time-rate of change of the twist of the EE also
pertain to robot kinematics.
</p>
<p>In the balance of this chapter we study the geometry of manipulators, the
relations between joint rates, joint accelerations and their Cartesian counterparts,
twist and twist-rate, being the subject of Chap. 5. In this regard, we distinguish
two problems, commonly referred to as the direct and the inverse displacement
</p>
<p>Fig. 4.9 Serial six-axis manipulator</p>
<p/>
</div>
<div class="page"><p/>
<p>4.3 The Geometric Model of Six-Revolute Manipulators 151
</p>
<p>problems, or DDP and correspondingly, IDP, for brevity. In the DDP, the six joint
variables of a given six-axis manipulator are assumed to be known, the problem
consisting in finding the pose of the EE. In the IDP, on the contrary, the pose of the
EE is given, while the six joint variables that produce this pose are to be found.
</p>
<p>The DDP reduces to matrix and matrix-times-vector multiplications; as we shall
show presently, the DDP poses no major problem. The IDP, however, is more
challenging, for it involves intensive variable-elimination and nonlinear-equation
solving. Indeed, in the most general case, the IDP amounts to eliminating five out
of the six unknowns, with the aim of reducing the problem to a single monovariate
polynomial of 16th degree or lower. While finding the roots of a polynomial of
this degree is no longer an insurmountable task, reducing the underlying system
of nonlinear equations to a monovariate polynomial requires intensive computer-
algebra work that must be very carefully planned to avoid the introduction of
spurious roots and, with this, an increase in the degree of that polynomial. For this
reason, we limit this chapter to the study of the geometric IDP of decoupled six-axis
manipulators. The IDP of the most general six-revolute serial manipulator is studied
in Chap. 9.
</p>
<p>In studying the DDP of six-axis manipulators, we need not limit ourselves to
a particular architecture. We thus study here the DDP of manipulators such as the
one sketched in Fig. 4.9. This manipulator consists of seven rigid bodies, or links,
coupled by six revolute joints. Correspondingly, we have seven frames, F1, F2,
: : :, F7, the i th frame fixed to the .i � 1/st link, F1 being termed the base frame,
because it is fixed to the base of the manipulator. Manipulators with joints of the
prismatic type are simpler to study and can be treated using correspondingly simpler
procedures.
</p>
<p>A line Li is associated with the axis of the i th revolute joint, and a positive
direction along this line is defined arbitrarily through a unit vector ei . For a prismatic
pair, a line Li can be also defined, as a line having the direction of the pair but
whose location is undefined; the analyst, then, has the freedom to locate this axis
conveniently. Thus, a rotation of the i th link with respect to the .i � 1/st link or
correspondingly, of FiC1 with respect to Fi , is totally defined by the geometry of
the i th link, i.e., by the DH parameters ai , bi , and ˛i , plus ei and its associated
joint variable �i . Then, the DH parameters and the joint variables define uniquely
the posture of the manipulator. In particular, the relative position and orientation of
FiC1 with respect to Fi is given by matrix Qi and vector ai , respectively, which
were defined in Sect. 4.2 and are displayed below for quick reference:
</p>
<p>Qi D
</p>
<p>2
</p>
<p>4
</p>
<p>cos �i ��i sin �i �i sin �i
sin �i �i cos �i ��i cos �i
0 �i �i
</p>
<p>3
</p>
<p>5 ; ai D
</p>
<p>2
</p>
<p>4
</p>
<p>ai cos �i
ai sin �i
bi
</p>
<p>3
</p>
<p>5 (4.7)
</p>
<p>Thus, Qi and ai denote, respectively, the matrix rotating Fi into an orientation
coincident with that of FiC1 and the vector joining the origin of Fi with that of FiC1,
directed from the former to the latter. Moreover, Qi and ai , as given in Eq. (4.7),</p>
<p/>
</div>
<div class="page"><p/>
<p>152 4 Geometry of Decoupled Serial Robots
</p>
<p>are represented in Fi coordinates. The equations leading to the geometric model
under study are known as the displacement equations. It is noteworthy that the
problem under study is equivalent to the input&ndash;output analysis problem of a seven-
revolute linkage with one degree of freedom and one single kinematic loop (Duffy
1980). Because of this equivalence with a closed kinematic chain, sometimes the
displacement equations are also termed closure equations. These equations relate
the orientation of the EE, as produced by the joint coordinates, with the prescribed
orientation Q and the position vector p of the operation point P of the EE. That
is, the orientation Q of the EE is obtained as a result of the six individual rotations
fQi g61 about each revolute axis through an angle �i , in a sequential order, from 1 to
6. If, for example, the foregoing relations are expressed in F1, then
</p>
<p>ŒQ6 &#141;1ŒQ5 &#141;1ŒQ4 &#141;1ŒQ3 &#141;1ŒQ2 &#141;1ŒQ1 &#141;1 D ŒQ &#141;1 (4.8a)
Œ a1 &#141;1 C Œ a2 &#141;1 C Œ a3 &#141;1 C Œ a4 &#141;1 C Œ a5 &#141;1 C Œ a6 &#141;1 D Œp &#141;1 (4.8b)
</p>
<p>Notice that the above equations require that all vectors and matrices involved be
expressed in the same coordinate frame. However, we derived in Sect. 4.2 general
expressions for Qi and ai in Fi , Eqs. (4.1e) and (4.3b), respectively. It is hence
convenient to represent the foregoing relations in each individual frame, which can
be readily done by means of similarity transformations. Indeed, if we apply the
transformations (4.5a and b) to each of Œ ai &#141;1 and ŒQi &#141;1, respectively, we obtain ai
or, correspondingly, Qi in Fi . Therefore, Eq. (4.8a) becomes
</p>
<p>ŒQ1 &#141;1ŒQ2 &#141;2ŒQ3 &#141;3ŒQ4 &#141;4ŒQ5 &#141;5ŒQ6 &#141;6 D ŒQ &#141;1
</p>
<p>Now for compactness, let us represent ŒQ &#141;1 simply by Q and let us recall the
abbreviated notation introduced in Eq. (4.1d), where ŒQi &#141;i is denoted simply by
Qi , thereby obtaining
</p>
<p>Q1Q2Q3Q4Q5Q6 D Q (4.9a)
</p>
<p>Likewise, Eq. (4.8b) becomes
</p>
<p>a1 CQ1.a2 CQ2a3 CQ2Q3a4 CQ2Q3Q4a5 CQ2Q3Q4Q5a6/ D p (4.9b)
</p>
<p>in which both sides are given in base-frame coordinates. Equations (4.9a and b)
above can be cast in a more compact form if homogeneous transformations, as
defined in Sect. 2.5, are now introduced. Thus, if we let Ti � fTi gi be the 4 � 4
matrix transforming FiC1-coordinates into Fi -coordinates, the foregoing equations
can be written in 4 � 4 matrix form, namely,
</p>
<p>T1T2T3T4T5T6 D T (4.10)</p>
<p/>
</div>
<div class="page"><p/>
<p>4.3 The Geometric Model of Six-Revolute Manipulators 153
</p>
<p>with T denoting the transformation of coordinates from the end-effector frame to
the base frame. Thus, T contains the pose of the end-effector.
</p>
<p>In order to ease the discussion ahead, we introduce now a few definitions. A
scalar, vector, or matrix expression is said to be multilinear in a set of vectors f vi gN1
if each of those vectors appears only linearly in the same expression. This does not
prevent products of components of those vectors from occurring, as long as each
product contains only one component of the same vector. Alternatively, we can say
that the expression of interest is multilinear in the aforementioned set of vectors
if and only if the partial derivative of that expression with respect to vector vi is
independent of vi , for i D 1; : : : ; N . For example, every matrix Qi and every vector
ai , defined in Eqs. (4.1e) and (4.3b), respectively, is linear in vector xi , where xi is
defined as
</p>
<p>xi �
�
</p>
<p>cos �i
sin �i
</p>
<p>�
</p>
<p>(4.11)
</p>
<p>Moreover, the product Q1Q2Q3Q4Q5Q6 appearing in Eq. (4.9a) is hexalinear, or
simply, multilinear, in vectors f xi g61. Likewise, the sum appearing in Eq. (4.9b)
is multilinear in the same set of vectors. By the same token, a scalar, vector, or
matrix expression is said to be multiquadratic in the same set of vectors if those
vectors appear at most quadratically in the said expression. That is, the expression
of interest may contain products of the components of all those vectors, as long as
those products contain, in turn, a maximum of two components of the same vector,
including the same component squared. Qualifiers like multicubic, multiquartic,
etc., bear similar meanings.
</p>
<p>Further, we partition matrix Qi rowwise and columnwise, namely,
</p>
<p>Qi �
</p>
<p>2
</p>
<p>4
</p>
<p>mTi
nTi
oTi
</p>
<p>3
</p>
<p>5 �
�
</p>
<p>pi qi ui
�
</p>
<p>(4.12)
</p>
<p>It is noteworthy that the third row oTi of Qi is independent of �i , a fact that will be
found useful in the forthcoming derivations. Furthermore, note that according to the
DH notation, the unit vector ei in the direction of the i th joint axis in Fig. 4.9 has
Fi -components given by
</p>
<p>Œ ei &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5 � e (4.13)
</p>
<p>Henceforth, e is used to represent a three-dimensional array with its last component
equal to unity, its other components vanishing. Thus, we have
</p>
<p>Qioi � QTi ui D e (4.14a)</p>
<p/>
</div>
<div class="page"><p/>
<p>154 4 Geometry of Decoupled Serial Robots
</p>
<p>or
</p>
<p>ui D Qie; oi D QTi e (4.14b)
That is, if we regard e in the first of the foregoing relations as Œ eiC1 &#141;iC1, and as
Œ ei &#141;i in the second relation, then, from the coordinate transformations of Eqs. (4.4a
and b),
</p>
<p>ui D Œ eiC1 &#141;i ; and oi D Œ ei &#141;iC1 (4.15)
</p>
<p>4.4 The Inverse Displacement Analysis of Decoupled
</p>
<p>Manipulators
</p>
<p>Industrial manipulators are frequently supplied with a special architecture that
allows a decoupling of the positioning problem from the orientation problem. In
fact, a determinant design criterion in this regard has been that the manipulator
lend itself to a closed-form inverse displacement solution. Although the class of
manipulators with this feature is quite broad, we will focus on a special kind,
the most frequently encountered in commercial manipulators, that we have termed
decoupled. Decoupled manipulators were defined in Sect. 4.2 as those whose last
three joints have intersecting axes. These joints, then, constitute the wrist of the
manipulator, which is said to be spherical, because when the point of intersection
of the three wrist axes, C , is kept fixed, all the points of the wrist move on spheres
centered at C . In terms of the DH parameters of the manipulator, in a decoupled
manipulator a4 D a5 D b5 D 0, and thus, the origins of frames 5 and 6
are coincident. All other DH parameters can assume arbitrary values. A general
decoupled manipulator is shown in Fig. 4.10, where the wrist is represented as a
concatenation of three revolutes with intersecting axes.
</p>
<p>In the two subsections below, a procedure is derived for determining all the
inverse displacement solutions of decoupled manipulators. In view of the decoupled
architecture of these manipulators, we conduct their displacement analysis by
decoupling the positioning problem from the orientation problem.
</p>
<p>4.4.1 The Positioning Problem
</p>
<p>We solve first the positioning problem. Let C denote the intersection of axes 4, 5,
and 6, i.e., the center of the spherical wrist, and let c denote the position vector of
this point. Apparently, the position of C is independent of joint angles �4, �5, and
�6; hence, only the first three joints are to be considered for this analysis. The arm
structure depicted in Fig. 4.11 will then be analyzed. From that figure,
</p>
<p>a1 CQ1a2 CQ1Q2a3 CQ1Q2Q3a4 D c (4.16)</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 155
</p>
<p>Fig. 4.10 A general 6R manipulator with decoupled architecture
</p>
<p>where the two sides are expressed in F1-coordinates. This equation can be readily
rewritten in the form
</p>
<p>a2 CQ2a3 CQ2Q3a4 D QT1 .c � a1/
</p>
<p>or if we recall Eq. (4.3d),
</p>
<p>Q2.b2 CQ3b3 CQ3Q4b4/ D QT1 c � b1
</p>
<p>However, since we are dealing with a decoupled manipulator, we have, from
Fig. 4.10,
</p>
<p>a4 � Q4b4 �
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>b4
</p>
<p>3
</p>
<p>5 � b4e
</p>
<p>which has been rewritten as the product of constant b4 times the unit vector e defined
in Eq. (4.13).
</p>
<p>Thus, the product Q3Q4b4 reduces to
</p>
<p>Q3Q4b4 � b4Q3e � b4u3
</p>
<p>with ui defined in Eq. (4.14b). Hence, Eq. (4.16) leads to
</p>
<p>Q2.b2 CQ3b3 C b4u3/ D QT1 c � b1 (4.17)</p>
<p/>
</div>
<div class="page"><p/>
<p>156 4 Geometry of Decoupled Serial Robots
</p>
<p>Further, an expression for c can be derived in terms of p, the position vector of the
operation point of the EE, and Q, namely,
</p>
<p>c D p �Q1Q2Q3Q4a5 �Q1Q2Q3Q4Q5a6 (4.18a)
</p>
<p>Now, since a5 D b5 D 0, we have that a5 D 0, Eq. (4.18a) thus yielding
</p>
<p>c D p �QQT6 a6 � p �Qb6 (4.18b)
</p>
<p>Moreover, the base coordinates of P and C , and hence, the F1-components of their
position vectors p and c, are defined as
</p>
<p>Œp &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>x
</p>
<p>y
</p>
<p>z
</p>
<p>3
</p>
<p>5 ; Œ c &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>xC
yC
zC
</p>
<p>3
</p>
<p>5
</p>
<p>so that Eq. (4.18b) can be expanded in the form
2
</p>
<p>4
</p>
<p>xC
yC
zC
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>x � .q11a6 C q12b6�6 C q13b6�6/
y � .q21a6 C q22b6�6 C q23b6�6/
z � .q31a6 C q32b6�6 C q33b6�6/
</p>
<p>3
</p>
<p>5 (4.18c)
</p>
<p>where qij is the .i; j / entry of ŒQ&#141;1, and the positioning problem now becomes one
of finding the first three joint angles necessary to position point C at a point of base
coordinates xC , yC , and zC . We thus have three unknowns, but we also have three
equations at our disposal, namely, the three scalar equations of Eq. (4.17), and we
should be able to solve the problem at hand.
</p>
<p>In solving the foregoing system of equations, we first note that (a) the left-hand
side of Eq. (4.17) appears multiplied by Q2; and (b) �2 does not appear in the right-
hand side. This implies that (a) if the Euclidean norms of the two sides of that
equation are equated, the resulting equation will not contain �2; and (b) the third
scalar equation of the same equation is independent of �2, by virtue of the structure
of the Qi matrices displayed in Eq. (4.1e). Thus, we have two equations free of �2,
which allows us to calculate the two remaining unknowns �1 and �3.
</p>
<p>Let the Euclidean norm of the left-hand side of Eq. (4.17) be denoted by l , that
of its right-hand side by r . We then have
</p>
<p>l2 � a22 C b22 C a23 C b23 C b24 C 2bT2 Q3b3 C 2b4bT2 u3 C 2�3b3b4
r2 � kck2 C kb1k2 � 2bT1 QT1 c
</p>
<p>from which it is apparent that l2 is linear in x3 and r2 is linear in x1, for xi defined
in Eq. (4.11). Upon equating l2 with r2, then, an equation linear in x1 and x3&mdash;not
bilinear in these vectors&mdash;is readily derived, namely,
</p>
<p>Ac1 C Bs1 C Cc3 CDs3 CE D 0 (4.19a)</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 157
</p>
<p>Fig. 4.11 Three-axis, serial, positioning manipulator
</p>
<p>whose coefficients do not contain any unknown, i.e.,
</p>
<p>A D 2a1xC (4.19b)
B D 2a1yC (4.19c)
C D 2a2a3 � 2b2b4�2�3 (4.19d)
D D 2a3b2�2 C 2a2b4�3 (4.19e)
E D a22 C a23 C b22 C b23 C b24 � a21 � x2C � y2C � .zC � b1/2
</p>
<p>C2b2b3�2 C 2b2b4�2�3 C 2b3b4�3 (4.19f)
</p>
<p>Moreover, the third scalar equation of Eq. (4.17) takes the form
</p>
<p>Fc1 CGs1 CHc3 C I s3 C J D 0 (4.20a)
</p>
<p>whose coefficients, again, do not contain any unknown, as shown below:
</p>
<p>F D yC�1 (4.20b)
G D �xC�1 (4.20c)</p>
<p/>
</div>
<div class="page"><p/>
<p>158 4 Geometry of Decoupled Serial Robots
</p>
<p>H D �b4�2�3 (4.20d)
I D a3�2 (4.20e)
J D b2 C b3�2 C b4�2�3 � .zC � b1/�1 (4.20f)
</p>
<p>Thus, we have derived two nonlinear equations in �1 and �3 that are linear in c1,
s1, c3, and s3. Each of these equations thus defines a contour in the �1&ndash;�3 plane, their
intersections determining all real solutions to the problem at hand.
</p>
<p>Now, two well-known trigonometric identities are introduced, namely,
</p>
<p>c3 �
1 � �23
1C �23
</p>
<p>; s3 �
2�3
</p>
<p>1C �23
; where �3 � tan
</p>
<p>�
�3
</p>
<p>2
</p>
<p>�
</p>
<p>(4.21)
</p>
<p>Henceforth, the foregoing identities will be referred to as the tan-half-angle
identities. We will be resorting to them throughout the book. Note that if ci and
si are substituted for their equivalents in terms of tan.�i=2/, for i D 1; 3, then two
biquadratic polynomial equations in tan.�1=2/ and tan.�3=2/ are derived. Thus, one
can eliminate one of these variables from the foregoing equations, thereby reducing
the two equations to a single quartic polynomial equation in the other variable. The
quartic equation thus resulting is called the characteristic equation of the problem at
hand. Alternatively, the two above equations, Eqs. (4.19a) and (4.20a), can be solved
for, say, c1 and s1 in terms of the data and c3 and s3, namely,
</p>
<p>c1 D
�G.Cc3 CDs3 CE/C B.Hc3 C I s3 C J /
</p>
<p>&#129;1
(4.22a)
</p>
<p>s1 D
F.Cc3 CDs3 CE/ � A.Hc3 C I s3 C J /
</p>
<p>&#129;1
(4.22b)
</p>
<p>with &#129;1 defined as
</p>
<p>&#129;1 D AG � FB D �2a1�1.x2C C y2C / (4.22c)
</p>
<p>Note that in trajectory planning, to be studied in Chap. 6, &#129;1 can be computed
off-line, i.e., prior to setting the manipulator into operation, for it is a function solely
of the manipulator parameters and the Cartesian coordinates of a point lying on
the path to be tracked. Moreover, the above calculations are possible as long as &#129;1
does not vanish. Now, &#129;1 vanishes if and only if any of the factors a1, �1, and
x2C C y2C does. The first two conditions are architecture-dependent, whereas the
third is position-dependent. The former occur frequently in industrial manipulators,
although not both at the same time. If both parameters a1 and �1 vanished, then the
arm would be useless to position arbitrarily a point in space. The third condition,
i.e., the vanishing of x2C C y2C , means that point C lies on the Z1 axis. Now, even
if neither a1 nor �1 vanishes, the manipulator can be postured in a configuration
at which point C lies on the Z1 axis. Such a configuration is termed the first</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 159
</p>
<p>singularity. Note, however, that with point C being located on the Z1 axis, any
motion of the first joint, with the two other joints locked, does not change the
location of C . For the moment, it will be assumed that &#129;1 does not vanish, the
particular cases under which it does being studied presently. Next, both sides of
Eqs. (4.22a and b) are squared, the squares thus obtained are then added, and the
sum is equated to 1, which leads to a quadratic equation in x3, namely,
</p>
<p>Kc23 C Ls23 CMc3s3 CNc3 C Ps3 CQ D 0 (4.23)
</p>
<p>whose coefficients, after simplification, are given below:
</p>
<p>K D 4a21H 2 C �21C 2 (4.24a)
L D 4a21I 2 C �21D2 (4.24b)
M D 2.4a21HI C �21CD/ (4.24c)
N D 2.4a21HJ C �21CE/ (4.24d)
P D 2.4a21IJ C �21DE/ (4.24e)
Q D 4a21J 2 C �21E2 � 4a21�21�2 (4.24f)
</p>
<p>with �2 defined as
</p>
<p>�2 � x2C C y2C
</p>
<p>Upon substitution of the tan-half identities introduced in Eq. (4.21) into
Eq. (4.23), a quartic equation in �3 is obtained, i.e.,
</p>
<p>R�43 C S�33 C T �23 C U�3 C V D 0 (4.25)
</p>
<p>whose coefficients are all computable from the data. After some simplifications,
these coefficients take on the forms
</p>
<p>R D 4a21.J �H/2 C �21.E � C/2 � 4�2a21�21 (4.26a)
S D 4Œ4a21I.J �H/C �21D.E � C/&#141; (4.26b)
T D 2Œ4a21.J 2 �H 2 C 2I 2/C �21.E2 � C 2 C 2D2/
</p>
<p>�4�2a21�21&#141; (4.26c)
U D 4Œ4a21I.H C J /C �21D.C CE/&#141; (4.26d)
V D 4a21.J CH/2 C �21.E C C/2 � 4�2a21�21 (4.26e)
</p>
<p>Furthermore, let f .�3/i g41 be the four roots of Eq. (4.25). Thus, up to four possible
values of �3 can be obtained, namely,
</p>
<p>.�3/i D 2 arctanŒ.�3/i &#141;; i D 1; 2; 3; 4 (4.27)</p>
<p/>
</div>
<div class="page"><p/>
<p>160 4 Geometry of Decoupled Serial Robots
</p>
<p>Once the four values of �3 are available, each of these is substituted into
Eqs. (4.22a and b), which thus produce four different values of �1. For each value of
�1 and �3, then, one value of �2 can be computed from the first two scalar equations
of Eq. (4.17), which are displayed below:
</p>
<p>A11 cos �2 C A12 sin �2 D xC cos �1 C yC sin �1 � a1 (4.28a)
�A12 cos �2 C A11 sin �2 D �xC�1 sin �1 C yC�1 cos �1
</p>
<p>C .zC � b1/�1 (4.28b)
</p>
<p>where
</p>
<p>A11 � a2 C a3 cos �3 C b4�3 sin �3 (4.28c)
A12 � �a3�2 sin �3 C b3�2 C b4�2�3 cos �3 C b4�2�3 (4.28d)
</p>
<p>Thus, if A11 and A12 do not vanish simultaneously, angle �2 is readily computed
in terms of �1 and �3 from Eqs. (4.28a and b) as
</p>
<p>cos �2 D 1&#129;2 f A11.xC cos �1 C yC sin �1 � a1/
�A12Œ�xC�1 sin �1 C yC�1 cos �1
C .zC � b1/�1&#141;g (4.29a)
</p>
<p>sin �2 D 1&#129;2 f A12.xC cos �1 C yC sin �1 � a1/
CA11Œ�xC�1 sin �1 C yC�1 cos �1
C .zC � b1/�1&#141;g (4.29b)
</p>
<p>where &#129;2 is defined as
</p>
<p>&#129;2 � A211 C A212
� a22 C a23.cos2 �3 C �22 sin2 �3/C b24�23.sin2 �3 C �22 cos2 �3/
C 2a2a3 cos �3 C 2a2b4�3 sin �3
C 2�2�2.b3 C b4�3/.b4�3 cos �3 � a3 sin �3/
C2a3b4�22�3 sin �3 cos �3 C .b3 C �3b4/2�22 (4.29c)
</p>
<p>the case in which&#129;2 D 0, which leads to what is termed here the second singularity,
being discussed presently.
</p>
<p>Takano (1985) considered the solution of the positioning problem for all
possible combinations of prismatic and revolute pairs in the regional structure of
a manipulator. A sketch of an intermediate P joint in a kinematic chain is displayed
in Fig. 7.3. Takano found that:</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 161
</p>
<p>1. In the case of arms containing either three revolutes, or two revolutes and one
prismatic pair, with a general layout in all cases, a quartic equation in cos �3 is
obtained;
</p>
<p>2. in the case of one revolute and two prismatic pairs, the positioning problem was
reduced to a single quadratic equation, the problem at hand thus admitting two
solutions;
</p>
<p>3. finally, for three prismatic pairs, one single linear equation was derived, the
problem thus admitting a unique solution.
</p>
<p>The Vanishing of&#129;1
</p>
<p>In the above derivations we have assumed that neither �1 nor a1 vanishes. However,
if either �1 D 0 or a1 D 0, then one can readily show that Eq. (4.25) reduces to
a quadratic equation, and hence, this case differs essentially from the general one.
Note that one of these conditions can occur, and the second occurs indeed frequently,
but both together never occur, because their simultaneous occurrence would render
the axes of the first two revolutes coincident. The manipulator would thus be short
of one joint for the execution of three-dimensional tasks. We thus have two cases:
</p>
<p>1. �1 D 0; a1 &curren; 0. In this case,
</p>
<p>A; B &curren; 0; F D G D 0
</p>
<p>Under these conditions, Eq. (4.20a) and the tan-half-angle identities given in
Eq. (4.21) yield
</p>
<p>.J �H/�23 C 2I�3 C .J CH/ D 0
</p>
<p>which thus produces two values of �3, namely,
</p>
<p>.�3/1;2 D
�I ˙
</p>
<p>p
I 2 � J 2 CH 2
J �H (4.30a)
</p>
<p>Once two values of �3 have been determined according to the above equation, �1
can be found using Eq. (4.19a) and the tan-half-angle identities, thereby deriving
</p>
<p>.E 0 � A/�21 C 2B�1 C .E 0 C A/ D 0
</p>
<p>where
</p>
<p>E 0 D Cc3 CDs3 CE; �1 � tan
�
�1
</p>
<p>2
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>162 4 Geometry of Decoupled Serial Robots
</p>
<p>whose roots are
</p>
<p>.�1/1;2 D
�B ˙
</p>
<p>p
B2 �E 02 C A2
E 0 � A (4.30b)
</p>
<p>Thus, two values of �1 are found for each of the two values of �3, which results
in four positioning solutions. Values of �2 are obtained using Eqs. (4.29a and b).
</p>
<p>2. a1 D 0; �1 &curren; 0. In this case, one has an architecture similar to that of the robot
of Fig. 4.3. We have now
</p>
<p>A D B D 0; F; G &curren; 0
</p>
<p>Under the present conditions, Eq. (4.19a) reduces to
</p>
<p>.E � C/�23 C 2D�3 C .E C C/ D 0
</p>
<p>which produces two values of �3, namely,
</p>
<p>.�3/1;2 D
�D ˙
</p>
<p>p
D2 �E2 C C 2
E � C (4.31a)
</p>
<p>With the two values of �3 obtained, �1 can be found using Eq. (4.20a) and the
tan-half-angle identities to produce
</p>
<p>.J 0 � F /�21 C 2G�1 C .J 0 C F / D 0
</p>
<p>where
</p>
<p>J 0 D Hc3 C I s3 C J; �1 � tan
�
�1
</p>
<p>2
</p>
<p>�
</p>
<p>whose roots are
</p>
<p>.�1/1;2 D
�G ˙
</p>
<p>p
G2 � J 02 C F 2
J 0 � F (4.31b)
</p>
<p>Once again, the solution results in a cascade of two quadratic equations, one
for �3 and one for �1, which yields four positioning solutions. As above, �2 is
then determined using Eqs. (4.29a and b). Note that for the special case of the
manipulator of Fig. 4.3, we have
</p>
<p>a1 D b2 D 0; ˛1 D ˛3 D 90ı; ˛2 D 0ı</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 163
</p>
<p>a b
</p>
<p>c d
</p>
<p>Fig. 4.12 The four arm
configurations for the
positioning problem of the
Puma robot: (a, b) elbow
down; (a, c) shoulder fore; (c,
d) elbow up; (b, d) shoulder
aft
</p>
<p>and hence,
</p>
<p>H D I D 0; E D a22 C a23 C b23 C b24 �
�
</p>
<p>x2C C y2C C .zC � b1/2
�
</p>
<p>;
</p>
<p>C D 2a2a3; D D 2a2b4; F D yC ; G D �xC ; J D b3
</p>
<p>In this case, the foregoing solutions reduce to
</p>
<p>.�3/1;2 D
�D ˙
</p>
<p>p
C 2 CD2 �E2
E � C ; .�1/1;2 D
</p>
<p>xC ˙
q
</p>
<p>x2C C y2C � b23
b3 � yC
</p>
<p>A robot with the architecture studied here is the Puma, which is displayed in
Fig. 4.12 in its four distinct postures for the same location of its wrist center. Notice
that the orientation of the EE is kept constant in all four postures.</p>
<p/>
</div>
<div class="page"><p/>
<p>164 4 Geometry of Decoupled Serial Robots
</p>
<p>The Vanishing of&#129;2
</p>
<p>In some instances, &#129;2, as defined in Eq. (4.29c), may vanish at a certain posture,
thereby preventing the calculation of �2 from Eqs. (4.29a and b). This posture,
termed the second singularity, occurs if both coefficients A11 and A12 of Eqs. (4.28a
and b) vanish. Note that from their definitions, Eqs. (4.28c and d), these coefficients
are not only position- but also architecture-dependent. Thus, an arbitrary manip-
ulator cannot take on this configuration unless its geometric dimensions allow it.
This type of singularity will be termed architecture-dependent, to distinguish it from
others that are common to all robots, regardless of their particular architectures.
</p>
<p>We can now give a geometric interpretation of the singularity at hand: First, note
that the right-hand side of Eq. (4.17), from which Eqs. (4.28a and b) were derived,
is identical to QT1 .c � a1/, which means that this expression is nothing but the
F2-representation of the position vector of C . That is, the components of vector
</p>
<p>QT1 .c � a1/ are the F2-components of vector
���!
O2C . Therefore, the right-hand sides
</p>
<p>of Eqs. (4.28a and b) are, respectively, the X2- and Y2-components of vector
���!
O2C .
</p>
<p>Consequently, if A11 D A12 D 0, then the two foregoing components vanish and,
hence, point C lies on the Z2 axis. The first singularity thus occurs when point C
lies on the axis of the first revolute, while the second occurs when the same point
lies on the axis of the second revolute.
</p>
<p>Many industrial manipulators are designed with an orthogonal architecture,
which means that the angles between neighbor axes are multiples of 90ı. Moreover,
with the purpose of maximizing their workspace, orthogonal manipulators are
designed with their second and third links of equal lengths, thereby rendering them
vulnerable to this type of singularity. An architecture common to many manipulators
such as the Cincinnati&ndash;Milacron, ABB, Fanuc, and others, comprises a planar two-
axis layout with equal link lengths, which is capable of turning about an axis
orthogonal to these two axes. This layout allows for the architecture singularity
under discussion, as shown in Fig. 4.13a. The well-known Puma robot is similar
to the foregoing manipulators, except that it is supplied with what is called a
shoulder offset b3, as illustrated in Fig. 4.3. This offset, however, does not prevent
the Puma from attaining the same singularity, as depicted in Fig. 4.13b. Notice that
in the presence of this singularity, angle �2 is undetermined, but �1 and �3 are
determined in the case of the Puma robot. However, in the presence of the singularity
of Fig. 4.13a, neither �1 nor �2 are determined; only �3 of the arm structure is
determined.
</p>
<p>Example 4.4.1. A manipulator with a common orthogonal architecture is displayed
in Fig. 4.14 in an arbitrary configuration. The arm architecture of this manipulator
has the DH parameters shown below:
</p>
<p>a1 D a3 D 0; b1 D b2 D b3 D 0; ˛1 D 90ı; ˛2 D 0ı; ˛3 D 90ı
</p>
<p>Find its inverse kinematics solutions.</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 165
</p>
<p>a b
</p>
<p>Fig. 4.13 Architecture-dependent singularities of (a) the Cincinnati&ndash;Milacron and (b) the Puma
robots
</p>
<p>Fig. 4.14 An orthogonal decoupled manipulator
</p>
<p>Solution: A common feature of this architecture is that it comprises a2 D b4. In
the present discussion, however, the latter feature need not be included, and hence,
the result that follows applies even in its absence. In this case, coefficients C , D,
and E take on the forms
</p>
<p>C D 0; D D 2a2b4; E D a22 C b24 � kck2
</p>
<p>Hence,
</p>
<p>C D H D I D J D 0</p>
<p/>
</div>
<div class="page"><p/>
<p>166 4 Geometry of Decoupled Serial Robots
</p>
<p>and so
</p>
<p>J 0 D 0; F D yC ; G D �xC
</p>
<p>The radical of Eq. (4.31b) reduces to x2C C y2C . Thus,
</p>
<p>tan
</p>
<p>�
�1
</p>
<p>2
</p>
<p>�
</p>
<p>D
xC ˙
</p>
<p>q
</p>
<p>x2C C y2C
�yC
</p>
<p>� �1˙
p
</p>
<p>1C .yC =xC /2
yC =xC
</p>
<p>(4.32a)
</p>
<p>Now we recall the relation between tan.�1=2/ and tan �1, namely,
</p>
<p>tan
</p>
<p>�
�1
</p>
<p>2
</p>
<p>�
</p>
<p>� �1˙
p
</p>
<p>1C tan2 �1
tan �1
</p>
<p>(4.32b)
</p>
<p>Upon comparison of Eqs. (4.32a) and (4.32b), it is apparent that
</p>
<p>�1 D arctan
�
yC
</p>
<p>xC
</p>
<p>�
</p>
<p>a result that can be derived geometrically for this simple arm architecture. Given that
the arctan.�/ function is double-valued, its two values differing in 180ı, we obtain
here, again, two values for �1. On the other hand, �3 is calculated from Eq. (4.31a) as
</p>
<p>.�3/1;2 D
�2a2b4 ˙
</p>
<p>q
</p>
<p>4a22b
2
4 � .a22 C b24 � kck2/2
</p>
<p>a22 C b24 � kck2
</p>
<p>thereby obtaining two values of �3. As a consequence, the inverse positioning
problem of this arm architecture admits four solutions as well. These solutions give
rise to two pairs of arm postures that are usually referred to as elbow-up and elbow-
down.
</p>
<p>Example 4.4.2. Find all real inverse displacement solutions of the manipulator
shown in Fig. 4.15, when point C of its end-effector has the base coordinates
C.0; 2a; �a/.
Solution: The Denavit&ndash;Hartenberg parameters of this manipulator are derived
from Fig. 4.16, where the coordinate frames involved are indicated. In defining the
coordinate frames of that figure, the Denavit&ndash;Hartenberg notation was followed,
with Z4 defined, arbitrarily, as parallel to Z3. From Fig. 4.16, then, we have
</p>
<p>a1 D a2 D a3 D b2 D b3 D a; b1 D b4 D 0; ˛1 D ˛2 D 90ı; ˛3 D 0ı
</p>
<p>One inverse displacement solution can be readily inferred from the geometry of
Fig. 4.16. For illustration purposes, and in order to find all other inverse kinematic</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 167
</p>
<p>Fig. 4.15 An orthogonal RRR manipulator
</p>
<p>Fig. 4.16 The coordinate frames of the orthogonal RRR manipulator
</p>
<p>solutions, we will use the procedure derived above. To this end, we first proceed
to calculate the coefficients of the quartic polynomial equation, Eq. (4.25), which
are given, nevertheless, in terms of coefficients K, : : :, Q of Eqs. (4.24a&ndash;f). These</p>
<p/>
</div>
<div class="page"><p/>
<p>168 4 Geometry of Decoupled Serial Robots
</p>
<p>coefficients are given, in turn, in terms of coefficients A, : : :, J of Eqs. (4.19b&ndash;f)
and (4.20b&ndash;f). We then proceed to calculate all the necessary coefficients in the
proper order:
</p>
<p>A D 0; B D 4a2; C D D D �E D 2a2
</p>
<p>F D 2a; G D H D 0; I D J D a
</p>
<p>Moreover,
</p>
<p>K D 4a4; L D 8a4; M D 8a4; N D �8a4; P D 0; Q D �8a4;
</p>
<p>The set of coefficients sought thus reduces to
</p>
<p>R D K �N CQ D 4a4
</p>
<p>S D 2.P �M/ D �16a4
</p>
<p>T D 2.QC 2L �K/ D 8a4
</p>
<p>U D 2.M C P / D 16a4
</p>
<p>V D K CN CQ D �12a4
</p>
<p>which leads to a quartic equation, namely,
</p>
<p>�43 � 4�33 C 2�23 C 4�3 � 3 D 0
</p>
<p>with four real roots:
</p>
<p>.�3/1 D .�3/2 D 1; .�3/3 D �1; .�3/4 D 3
</p>
<p>These roots yield the �3 values that follow:
</p>
<p>.�3/1 D .�3/2 D 90ı; .�3/3 D �90ı; .�3/4 D 143:13ı
</p>
<p>The quartic polynomial thus admits one double root, which means that at the
configurations resulting from this root, two solutions meet, thereby producing a
singularity, an issue that is discussed in Sect. 5.4. Below, we calculate the remaining
angles for each solution: Angle �1 is computed from relations (4.22a&ndash;c), where
&#129;1 D �8a3.
</p>
<p>The first two roots, .�3/1 D .�3/2 D 90ı, yield c3 D 0 and s3 D 1. Hence,
Eqs. (4.22a and b) lead to
</p>
<p>c1 D
B.I C J /
</p>
<p>&#129;1
D 4a
</p>
<p>2.aC a/
�8a3 D �1
</p>
<p>s1 D
F.D CE/
</p>
<p>&#129;1
D 2a.2a
</p>
<p>2 � 2a2/
�8a3 D 0</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 169
</p>
<p>Fig. 4.17 Manipulator configuration for C.0; a; 0/
</p>
<p>and hence,
</p>
<p>.�1/1 D .�1/2 D 180ı
</p>
<p>With �1 known, �2 is computed from the first two of Eqs. (4.17), namely,
</p>
<p>c2 D 0; s2 D �1
</p>
<p>and hence,
</p>
<p>.�2/1 D .�2/2 D �90ı
</p>
<p>The remaining roots are treated likewise, thereby obtaining
</p>
<p>.�1/3 D 90ı; .�2/3 D 0; .�1/4 D 143:13ı; .�2/4 D 0
</p>
<p>It is noteworthy that the architecture of this manipulator does not allow for the
second singularity, associated with &#129;2 D 0.
Example 4.4.3. For the same manipulator of Example 4.4.2, find all real inverse
displacement solutions when point C of its end-effector has the base coordinates
C.0; a; 0/, as displayed in Fig. 4.17.</p>
<p/>
</div>
<div class="page"><p/>
<p>170 4 Geometry of Decoupled Serial Robots
</p>
<p>1
</p>
<p>2
</p>
<p>C2
</p>
<p>C1
</p>
<p>(deg)
</p>
<p>(deg)
</p>
<p>-150 -100 -50 0 50 100 150
</p>
<p>-150
</p>
<p>-100
</p>
<p>-50
</p>
<p>0
</p>
<p>50
</p>
<p>100
</p>
<p>150
</p>
<p>Fig. 4.18 Contours
producing the two real
solutions for Example 4.4.3
</p>
<p>Solution: In this case, one obtains, successively,
</p>
<p>A D 0; B D C D D D E D 2a2;
F D a; G D 0 H D 0; I D J D a
K D 4a4; L DM D N D 8a4; P D 16a4; Q D 4a4
</p>
<p>R D 0; S D 16a4; T D 32a4; U D 48a4; V D 16a4
</p>
<p>Moreover, for this case, the quartic Eq. (4.23) degenerates into a cubic equation,
namely,
</p>
<p>�33 C 2�23 C 3�3 C 1 D 0
</p>
<p>whose roots are readily found as
</p>
<p>.�3/1 D �0:43016; .�3/2;3 D �0:78492˙ j1:30714
</p>
<p>where j is the imaginary unit, i.e., j �
p
�1. That is, only one real solution
</p>
<p>is obtained, namely, .�3/1 D �46:551ı. However, shown in Fig. 4.17 is a quite
symmetric posture of this manipulator at the given position of point C of its end-
effector, which does not correspond to the real solution obtained above. In fact,
the solution yielding the posture of Fig. 4.17 disappeared because of the use of the
quartic polynomial equation in tan.�3=2/. Note that if the two contours derived from
Eqs. (4.19a) and (4.20a) are plotted, as in Fig. 4.18, their intersections yield the two
real roots, including the one leading to the posture of Fig. 4.17.</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 171
</p>
<p>The explanation of how the fourth root of the quartic equation disappeared is
given below: Let us write the quartic polynomial in full, with a &ldquo;small&rdquo; leading
coefficient �, namely,
</p>
<p>��43 C �33 C 2�23 C 3�3 C 1 D 0
</p>
<p>Upon dividing both sides of the foregoing equation by �43 , we obtain
</p>
<p>� C 1
�3
C 2
�23
C 3
�33
C 1
�43
D 0
</p>
<p>Apparently, the original equation is satisfied as � ! 0 if and only if �3 ! ˙1,
i.e, if �3 D 180ı. The missing root is, hence, .�3/4 D � . The remaining angles are
readily calculated as
</p>
<p>.�1/1 D �105:9ı; .�2/1 D �149:35ı; .�1/4 D 180ı; .�2/4 D �90ı
</p>
<p>4.4.2 The Orientation Problem
</p>
<p>Now the orientation inverse displacement problem is first formulated, then solved.
This problem consists in determining the wrist angles that will produce a prescribed
orientation of the end-effector. The orientation, in turn, is given in terms of the
rotation matrix Q taking the end-effector from its home attitude to its current one.
Alternatively, the orientation can be given by the natural invariants of the rotation
matrix, vector e and angle �. In any event, all nine components of matrix Q are
known in F1. It is convenient to assume a columnwise partitioning of ŒQ &#141;1 similar
to that of Qi (� ŒQi &#141;i ) displayed in Eq. (4.12), namely,
</p>
<p>ŒQ &#141;1 D
�
</p>
<p>p q u
�
</p>
<p>(4.33)
</p>
<p>Without loss of generality it can be assumed that Z7 is defined parallel to Z6&mdash;as
the chain is open, the analyst is free to define Z7 at will. From Definition 2.2.1, then
Œu&#141;1 D Œe7&#141;1 D Œe6&#141;1, and e6 included in Fig. 4.19. Moreover, since �1, �2, and �3
are available, Q1, Q2, and Q3 become data for this problem. One now has the general
layout of Fig. 4.19, where angles f �i g64 are to be determined from the problem data,
which are in this case the orientation of the end-effector and the architecture of the
wrist; the latter is defined by angles ˛4 and ˛5, neither of which can be either 0 or � .
</p>
<p>Now, since the orientation of the end-effector is given, the components of Œ e6 &#141;1
are known, but they will be needed in frame 4. A coordinate transformation from
frame 1 to frame 4 can be readily implemented by resorting to the transformation
given in Eq. (4.6a):
</p>
<p>Œ e6 &#141;4 D .Q1Q2Q3/T Œ e6 &#141;1 � .Q1Q2Q3/T Œu &#141;1 (4.34)</p>
<p/>
</div>
<div class="page"><p/>
<p>172 4 Geometry of Decoupled Serial Robots
</p>
<p>Fig. 4.19 General architecture of a spherical wrist
</p>
<p>Let the components of Œ e6 &#141;4, all of them known, be defined as
</p>
<p>Œ e6 &#141;4 D
</p>
<p>2
</p>
<p>4
</p>
<p>�
</p>
<p>�
</p>
<p>�
</p>
<p>3
</p>
<p>5 (4.35)
</p>
<p>Moreover, based on the first of Eqs. (4.15), the components of vector e5 in F4 are
nothing but the entries of the third column of matrix Q4, i.e.,
</p>
<p>Œ e5 &#141;4 D
</p>
<p>2
</p>
<p>4
</p>
<p>�4 sin �4
��4 cos �4
</p>
<p>�4
</p>
<p>3
</p>
<p>5 (4.36)
</p>
<p>Furthermore, vectors e5 and e6 make an angle ˛5, and hence,
</p>
<p>eT6 e5 D �5 or Œ e6 &#141;T4 Œ e5 &#141;4 D �5 (4.37)
</p>
<p>Upon substitution of Eqs. (4.35) and (4.36) into Eq. (4.37), we obtain
</p>
<p>��4 sin �4 � ��4 cos �4 C ��4 D �5 (4.38)</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 173
</p>
<p>which can be readily transformed, with the aid of the tan-half-angle identities, into
a quadratic equation in �4 � tan.�4=2/, namely,
</p>
<p>.�5 � ��4 � ��4/�24 � 2��4�4 C .�5 C ��4 � ��4/ D 0 (4.39)
</p>
<p>its two roots being given by
</p>
<p>�4 D
��4 ˙
</p>
<p>q
</p>
<p>.�2 C �2/�24 � .�5 � ��4/2
</p>
<p>�5 � ��4 � ��4
(4.40)
</p>
<p>Note that the two foregoing roots are real as long as the radical is positive, the two
roots merging into a single one when the radical vanishes. Thus, a negative radical
means an attitude of the EE that is not feasible with the wrist. It is noteworthy
that a three-revolute spherical wrist is kinematically equivalent to a spherical joint.
However, the spherical wrist differs essentially from a spherical joint in that the
latter has, kinematically, an unlimited workspace&mdash;a physical spherical joint, of
course, has a limited workspace by virtue of its mechanical construction&mdash;and
can orient a rigid body arbitrarily. Therefore, the workspace W of the wrist is not
unlimited, but rather defined by the set of values of � , �, and � that satisfy the two
relations shown below:
</p>
<p>�2 C �2 C �2 D 1 (4.41a)
f .�; �; �/ � .�2 C �2/�24 � .�5 � ��4/2 � 0 (4.41b)
</p>
<p>In view of condition (4.41a), however, relation (4.41b) simplifies to an inequality in
� alone, namely,
</p>
<p>F.�/ � �2 � 2�4�5� � .�24 � �25/ � 0 (4.42)
</p>
<p>As a consequence,
</p>
<p>1. W is a region of the unit sphere S centered at the origin of the three-dimensional
space;
</p>
<p>2. W is bounded by the two parallels given by the roots of F.�/ D 0 on the sphere;
3. the wrist attains its singular configurations along the two foregoing parallels.
</p>
<p>In order to gain more insight on the shape of the workspace W , let us look at the
boundary defined by F.�/ D 0. Upon setting F.�/ to zero, we obtain a quadratic
equation in �, whose two roots can be readily found to be
</p>
<p>�1;2 D �4�5 ˙ j�4�5j (4.43)
</p>
<p>which thus defines two planes, ˘1 and ˘2, parallel to the �&ndash;� plane of the three-
dimensional space, intersecting the �-axis at �1 and �2, respectively. Thus, the
workspace W of the spherical wrist at hand is that region of the surface of the unit</p>
<p/>
</div>
<div class="page"><p/>
<p>174 4 Geometry of Decoupled Serial Robots
</p>
<p>sphere S contained between the two parallels defined by˘1 and˘2. For example, a
common wrist design involves an orthogonal architecture, i.e., ˛4 D ˛5 D 90ı. For
such wrists,
</p>
<p>�1;2 D ˙1
</p>
<p>and hence, orthogonal wrists become singular when Œ e6 &#141;4 D Œ 0; 0; ˙1 &#141;T , i.e.,
when the fourth and the sixth axes are aligned. Thus, the workspace of orthogonal
spherical wrists is the whole surface of the unit sphere centered at the origin, the
singularity curve thus degenerating into two points, namely, the two intersections of
this sphere with the �-axis. If one views � D 0 as the equatorial plane, then the two
singularity points of the workspace are the poles.
</p>
<p>An alternative design is the so-called three-roll wrist of some Cincinnati-
Milacron robots, with ˛4 D ˛5 D 120ı, thereby leading to �4 D �5 D �1=2
and �4 D �5 D
</p>
<p>p
3=2. For this wrist, the two planes ˘1 and ˘2 are found below:
</p>
<p>First, we note that with the foregoing architecture,
</p>
<p>�1;2 D 1; �
1
</p>
<p>2
</p>
<p>and hence, the workspace of this wrist is the part of the surface of the unit sphere
S that lies between the planes ˘1 and ˘2 parallel to the �-� plane, intersecting the
�-axis at �1 D 1 and �2 D �1=2, respectively. Hence, if � D 0 is regarded as the
equatorial plane, then the points of the sphere S that are outside of the workspace
of this wrist are those lying at a latitude smaller than �30ı. The singularity points
are thus the north pole and those lying on the parallel of latitude �30ı.
</p>
<p>Once �4 is calculated from the two foregoing values of �4, if these are real, angle
�5 is obtained uniquely for each value of �4, as explained below: First, Eq. (4.9a)
is rewritten in a form in which the data are collected in the right-hand side, which
produces
</p>
<p>Q4Q5Q6 D R (4.44a)
</p>
<p>with R defined as
</p>
<p>R D QT3 QT2 QT1 Q (4.44b)
</p>
<p>Moreover, let the entries of R in the fourth coordinate frame be given as
</p>
<p>ŒR &#141;4 D
</p>
<p>2
</p>
<p>4
</p>
<p>r11 r12 r13
r21 r22 r23
r31 r32 r33
</p>
<p>3
</p>
<p>5
</p>
<p>Expressions for �5 and �6 can be readily derived by solving first for Q5 from
Eq. (4.44a), namely,
</p>
<p>Q5 D QT4 RQT6 (4.45)</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 175
</p>
<p>Now, by virtue of the form of the Qi matrices, as appearing in Eq. (4.1e), it is
apparent that the third row of Qi does not contain �i . Hence, the third column of
the matrix product of Eq. (4.45) is independent of �6. Thus, two equations for �5 are
obtained by equating the first two components of the third columns of that equation,
thereby obtaining
</p>
<p>�5s5 D .�6r12 C �6r13/c4 C .�6r22 C �6r23/s4
��5c5 D ��4.�6r12 C �6r13/s4 C �4.�6r22 C �6r23/c4 C �4.�6r32 C �6r33/
</p>
<p>which thus yield a unique value of �5 for every value of �4. Finally, with �4 and �5
known, it is a simple matter to calculate �6. This is done upon solving for Q6 from
Eq. (4.44a), i.e.,
</p>
<p>Q6 D QT5 QT4 R
</p>
<p>and if the partitioning (4.12) of Qi is now recalled, a useful vector equation is
derived, namely,
</p>
<p>p6 D QT5 QT4 r1 (4.46)
</p>
<p>where r1 is the first column of R. Let w denote the product QT4 r1, i.e.,
</p>
<p>w � QT4 r1 �
</p>
<p>2
</p>
<p>4
</p>
<p>r11c4 C r21s4
��4.r11s4 � r21c4/C �4r31
�4.r11s4 � r21c4/C �4r31
</p>
<p>3
</p>
<p>5
</p>
<p>Hence,
</p>
<p>QT5 Q
T
4 r1 �
</p>
<p>2
</p>
<p>4
</p>
<p>w1c5 C w2s5
�5.�w1s5 C w2c5/C w3�5
�5.w1s5 � w2c5/C w3�5
</p>
<p>3
</p>
<p>5
</p>
<p>in which wi denotes the i th component of w. Hence, c6 and s6 are determined from
the first two scalar equations of Eq. (4.46), namely,
</p>
<p>c6 D w1c5 C w2s5
s6 D �w1�5s5 C w2�5c5 C w3�5
</p>
<p>thereby deriving a unique value of �6 for every pair of values .�4; �5/. In summary,
then, two values of �4 have been determined, each value determining, in turn,
one single corresponding set of �5 and �6 values. Therefore, there are two sets of
solutions for the orientation problem under study, which lead to two corresponding</p>
<p/>
</div>
<div class="page"><p/>
<p>176 4 Geometry of Decoupled Serial Robots
</p>
<p>a b
</p>
<p>Fig. 4.20 The two configurations of a three-axis spherical wrist
</p>
<p>wrist postures. The two distinct postures of an orthogonal three-revolute spherical
wrist for a given orientation of its EE are displayed in Fig. 4.20.
</p>
<p>When combined with the four postures of a decoupled manipulator leading to
one and the same location of its wrist center&mdash;positioning problem&mdash;a maximum of
eight possible combinations of joint angles for a single pose of the end-effector of a
decoupled manipulator are found.
</p>
<p>Example 4.4.4. A three-roll wrist is mounted on the orthogonal manipulator of
Fig. 4.17, as this finds itself at the posture shown in the same figure, so that the center
of the wrist coincides with point C of the orthogonal manipulator. The assembly
is depicted in Fig. 4.21, which shows axis Z4 parallel to Z1. Moreover, the EE is
desired to attain the orientation given by matrix Q, defined below in F1-coordinates:
</p>
<p>Q D
</p>
<p>2
</p>
<p>4
</p>
<p>�1=3 �2=3 2=3
�2=3 �1=3 �2=3
2=3 �2=3 �1=3
</p>
<p>3
</p>
<p>5
</p>
<p>Find the inverse-displacement solutions of the wrist that corresponds to the fourth
solution found in Example 4.4.3 for the first three joint angles. Moreover, these
angles can also be found from Fig. 4.21 by inspection.
</p>
<p>Furthermore, to complete the DH parameters, Z7 is defined as passing through
C and P , in the directions from the former to the latter, which is assumed to yield
an angle ˛6 D 0. The three-roll wrist is illustrated in Fig. 4.22.
Solution: As the reader can readily verify, the arm inverse-displacement solution
displayed in Fig. 4.21 is
</p>
<p>�1 D �; �2 D �
�
</p>
<p>2
; �3 D �</p>
<p/>
</div>
<div class="page"><p/>
<p>4.4 The Inverse Displacement Analysis of Decoupled Manipulators 177
</p>
<p>Fig. 4.21 The coordinate frames of the orthogonal RRRR manipulator
</p>
<p>Fig. 4.22 A representation of the kinematic chain of the Cincinnati&ndash;Milacron three-roll wrist</p>
<p/>
</div>
<div class="page"><p/>
<p>178 4 Geometry of Decoupled Serial Robots
</p>
<p>Further, given the wrist architecture,
</p>
<p>�4 D �5 D �
1
</p>
<p>2
; �4 D �5 D
</p>
<p>p
3
</p>
<p>2
</p>
<p>and, in light of the value of ˛6 given above,
</p>
<p>�6 D 1; �6 D 0
</p>
<p>Now we need e5 and e6 in F4; we have Œ e5 &#141;4 displayed in Eq. (4.36), and hence,
Œ e5&#141;4 D Œ
</p>
<p>p
3s�4; �
</p>
<p>p
3c�4; �1 &#141;T =2. Moreover, Œ e6 &#141;1 is simply the third column of
</p>
<p>Q, namely, Œ e6 &#141;1 D Œ 2=3; �2=3; �1=3 &#141;T . In order to bring the components of e6
into F4, a coordinate transformation is needed. This transformation is implemented
by means of the transpose of the rotation matrix Q123 � Q1Q2Q3 that carries F1
into F4. This matrix is most simply found from Definition 2.2.1 as applied to the
foregoing frames, and upon inspection of Fig. 4.21. Therefore,
</p>
<p>Q123 D Q1Q2Q3 D
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 0
1 0 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>Hence,
</p>
<p>Œ e6 &#141;4 D Q1Q2QT3 Œ e6 &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>0 1 0
</p>
<p>�1 0 0
0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>2=3
</p>
<p>�2=3
�1=3
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>2=3
</p>
<p>2=3
</p>
<p>�1=3
</p>
<p>3
</p>
<p>5
</p>
<p>which thus leads to the equation for �4:
</p>
<p>2C
p
3 sin �4 �
</p>
<p>p
3 cos �4 D 0
</p>
<p>Upon application of the tan-half identities to the above equation, a quadratic
equation in �4 D tan.�4=2/ is derived, namely,
</p>
<p>2C 2 �42 C 2
p
3�4 C
</p>
<p>p
3C
p
3�4
</p>
<p>2 D 0
</p>
<p>whose two roots lead to the two values of �4 given below:
</p>
<p>�4;1 D �9:7356103370ı; �4;2 D 80:2643896700ı</p>
<p/>
</div>
<div class="page"><p/>
<p>4.5 Exercises 179
</p>
<p>Further, matrix R of Eq. (4.44b) is obtained as
</p>
<p>R D
</p>
<p>2
</p>
<p>4
</p>
<p>2=3 1=3 2=3
</p>
<p>�1=3 �2=3 2=3
2=3 �2=3 �1=3
</p>
<p>3
</p>
<p>5
</p>
<p>Upon substitution of the above expression into Eq. (4.45), expressions for c5 and s5
are obtained in terms of �4:
</p>
<p>c5 D
p
3
</p>
<p>9
</p>
<p>�
</p>
<p>�2 sin �4 C 2 cos �4 C
p
3
�
</p>
<p>and
</p>
<p>s5 D
4
p
3
</p>
<p>9
.cos �4 C sin �4/
</p>
<p>If now each of the two values obtained above for �4 is substituted in the above
equation, the corresponding values for �5 are obtained as
</p>
<p>�5;1 D 38:9424412300ı; �5;2 D �38:9424412600ı
</p>
<p>Finally, the product QT5 Q
T
4 R is computed, then equated to Q6. The .1; 1/ and
</p>
<p>.2; 1/ entries of the foregoing product yield cos �6 and sin �6, respectively, as per
Eq. (4.46). Two values are thus obtained for �6, one for each pair of .�4; �5/ values:
</p>
<p>�6;1 D �39:4804916600ı; �6;2 D �110:0092709000ı
</p>
<p>thereby completing the inverse-displacement solutions for the given orientation
problem.
</p>
<p>4.5 Exercises
</p>
<p>4.1 Shown in Fig. 10.3 is the kinematic chain of one of the six-dof legs of a flight
simulator, whose architecture is defined by the HD parameters of Table 10.1.
In the flight simulator, M is the moving platform, to which an aircraft cockpit
is rigidly attached. The six-dof motion of M is controlled by means of the six
hydraulic cylinders identical to that indicated in Fig. 10.3 as a prismatic joint.
Find all inverse displacement solutions of this manipulator, relating the pose
of M with all the joint variables.
</p>
<p>4.2 Modify the solution procedure of Sect. 4.4 to obtain all the postures of a PRR
manipulator that give the same EE pose, and show that this problem leads to a
quartic polynomial equation.
</p>
<p>4.3 Repeat Exercise 4.2 as pertaining to a PRP manipulator.</p>
<p/>
</div>
<div class="page"><p/>
<p>180 4 Geometry of Decoupled Serial Robots
</p>
<p>Fig. 4.23 A six-revolute robot holding a heavy tool
</p>
<p>Fig. 4.24 ABB-IRB 1000
robotic manipulator
</p>
<p>4.4 The manipulator appearing in Fig. 4.23 is of the orthogonal type, with a
decoupled, spherical wrist, and a regional structure consisting of two parallel
axes and one axis perpendicular to these two. Find all inverse kinematics
solutions for arbitrary poses of the EE of this manipulator.
</p>
<p>4.5 Similar to the manipulator of Fig. 4.23, that of Fig. 4.24 is of the orthogonal,
decoupled type, except that the latter has a prismatic pair. For an arbitrary pose
of its EE, find all inverse displacement solutions of this manipulator.
</p>
<p>4.6 Derive expressions for the angle of rotation and the unit vector parallel to the
axis of rotation of matrices Qi , as introduced in Sect. 4.2.</p>
<p/>
</div>
<div class="page"><p/>
<p>4.5 Exercises 181
</p>
<p>J4
(400&deg;)
</p>
<p>J3
(460&deg;
</p>
<p>J6
(900&deg;)
</p>
<p>J5
(280&deg;)
</p>
<p>J2
(250&deg;)
</p>
<p>J1
(340&deg;)
</p>
<p>)
</p>
<p>O1
</p>
<p>Z1
</p>
<p>Z2
</p>
<p>Z3
</p>
<p>Z4
</p>
<p>Z5
Z6, Z7 O
</p>
<p>7X7
</p>
<p>226170
</p>
<p>185
365
</p>
<p>170
</p>
<p>770
</p>
<p>525
</p>
<p>100
</p>
<p>150 740
</p>
<p>120
</p>
<p>100
</p>
<p>a b
</p>
<p>c d
</p>
<p>Fig. 4.25 Geometric information taken from the data sheet of an industrial robot: (a) the top view;
(b) an isometric view; (c) front view; and (d) side view</p>
<p/>
</div>
<div class="page"><p/>
<p>182 4 Geometry of Decoupled Serial Robots
</p>
<p>570
</p>
<p>450
</p>
<p>30
</p>
<p>150
640
</p>
<p>200
</p>
<p>110
</p>
<p>200
</p>
<p>300
</p>
<p>390
</p>
<p>1330
</p>
<p>100
</p>
<p>A
</p>
<p>B
</p>
<p>6
</p>
<p>&Oslash;42H7
</p>
<p>&Oslash;90h6
</p>
<p>6xM4, DP10
</p>
<p>&Oslash;6H7, DP6
</p>
<p>P.C.D.56
</p>
<p>30◦
</p>
<p>150
</p>
<p>260
</p>
<p>300
</p>
<p>390
</p>
<p>60
</p>
<p>300 260 60 216
</p>
<p>a
</p>
<p>b
</p>
<p>c
</p>
<p>d e
</p>
<p>Fig. 4.26 Motoman-EA1400N welding robot: (a) top view; (b) orthographic projection; (c) side
view; (d) view A, as per sideview; (e) view B, as per side view. All dimensions in mm
</p>
<p>4.7 An orthogonal spherical wrist has the architecture shown in Fig. 4.20, with the
DH parameters
</p>
<p>˛4 D 90ı; ˛5 D 90ı
</p>
<p>A frame F7 is attached to its EE so that Z7 coincides with Z6. Find the
(Cartesian) orientation that can be attained with two inverse displacement
solutions �I and �II , defining the two distinct postures, that lie the farthest
apart. Note that a distance between two manipulator postures can be defined</p>
<p/>
</div>
<div class="page"><p/>
<p>4.5 Exercises 183
</p>
<p>as the radical of the quadratic equation yielding the two inverse kinematic
solutions of the wrist, whenever the radical is positive. Those postures giving
the same EE orientation and lying farthest from each other are thus at the other
end of the spectrum from singularities, where the two postures merge into a
single one. Hence, the postures lying farthest from each other are singularity-
robust.
</p>
<p>4.8 Given an arbitrary three-revolute manipulator, as shown in Fig. 4.11, its
singular postures are characterized by the existence of a line passing through
its operation point about which the moments of its three axes vanish&mdash;see
Exercise 3.3. Note that this condition can be readily applied to manipulators
with a simple architecture, whereby two successive axes intersect at right
angles and two others are parallel. However, more complex architectures, like
that of the manipulator of Fig. 4.15, are more elusive in this regard. Find the
line passing through the operation point and intersecting the three axes of
the manipulator of Fig. 4.15 at a singularity. Hint: A singular posture of this
manipulator was found in Example 4.4.2.
</p>
<p>4.9 For the Fanuc Arc Mate 120iB robot displayed in Fig. 4.25, with the dimen-
sions in mm included therein,
</p>
<p>(a) Find its Denavit&ndash;Hartenberg parameters, using the Zi axes suggested in
Fig. 4.25b.
</p>
<p>(b) Apparently, the robot under study is of the decoupled type. Find all its
inverse-displacement solutions for an arbitrary pose of its end-effector,
assuming that the operation point is located at a point of F7 coordinates
Œ 0:0; 100:0; 100:0 &#141;T mm.
</p>
<p>4.10 Shown in Fig. 4.26 is the data sheet of the Motoman-EA1400N welding robot.
Under the assumption that the operation point of the robot is located along
the axis of the 6th joint, on the flange indicated in View A, produce a table
with the Denavit&ndash;Hartenberg parameters of the robot. N.B.: all lengths are
indicated in mm. It is strongly recommended to sketch the robot at an arbitrary
posture in order to ease the definition of the DH coordinate frames. Is this
robot decoupled?</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 5
</p>
<p>Kinetostatics of Serial Robots
</p>
<p>5.1 Introduction
</p>
<p>Kinetostatics is understood here as the study of the interplay between the feasible
twists of and the constraint wrenches acting on the various rigid bodies of a
mechanical system, when the system moves under static, conservative conditions.
The feasible twists of the various rigid bodies, or links, are those allowed by the
constraints imposed by the robot joints. The constraint wrenches are, in turn, the
reaction forces and moments exerted on a link by the links to which that link is
coupled by means of joints. The subject of this chapter is the kinetostatics of serial
robots, with focus on six-axis manipulators. By virtue of the duality between the
kinematic and the static relations in the mechanics of rigid bodies, as outlined in
Sect. 3.7, the derivation of the kinematic relations is discussed in detail, the static
relations following from the former.
</p>
<p>We derive first the relation between the twist of the robot EE and the set of
joint rates, which is given by a linear transformation induced by the robot Jacobian
matrix. Once the foregoing relation is established for a general six-joint robot, the
relation between the static wrench exerted by the environment on the EE and the
balancing joint torques is derived by duality. Special robotic architectures are given
due attention. Decoupled and planar architectures are treated as special cases of
six-joint robots. The fundamental problem of singularities arising from a singular
robot Jacobian in decoupled manipulators is given due attention as well. Two types
of singularities are discussed here for the regional structure of decoupled robots.
As a follow-up to the singularity analysis of this structure, its three-dimensional
workspace is derived. An algorithm is proposed for the display of this workspace as
pertaining to general regional structures whose inverse displacement analysis leads
to a quartic polynomial.
</p>
<p>Electronic supplementary material The online version of this article (doi: 10.1007/978-3-319-
01851-5_5) contains supplementary material, which is available to authorized users.
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__5,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>185</p>
<p/>
</div>
<div class="page"><p/>
<p>186 5 Kinetostatics of Serial Robots
</p>
<p>The chapter closes with a section on kinetostatic performance indices. The pur-
pose of these indices is twofold: They are needed in robot design to help the designer
best dimension the links of the robot in the early stages of the design process, prior to
the elastostatic and the elastodynamic design stages. These indices are also needed
in the control of a given robot to ensure an acceptable kinetostatic performance
under feedback control. One third, pragmatic application of these indices is the
comparison of various candidate robots when a robotic facility is being planned.
</p>
<p>Elastostatic design pertains to the structural design of a robot to ensure that the
links and the joint mechanical transmissions will be able to withstand the static loads
that arise when the robot is in operation. This aspect of design is usually conducted
under the assumption that all structural elements operate within the linearly elastic
range, and is valid at a specific robot posture. Elastodynamic design considers the
inertial load of the structural elements while accounting for link flexibility, which
gives rise to mechanical vibration. The main concern here is avoiding resonance
under linear dynamical conditions or limit cycles under nonlinear conditions. Both
elastostatics and elastodynamics lie beyond the scope of the book, and hence, will
not be considered here.
</p>
<p>5.2 Velocity Analysis of Serial Manipulators
</p>
<p>The relationships between the prescribed twist of the EE, also referred to as the
Cartesian velocity of the manipulator, and the corresponding joint-rates are derived
in this section. First, a serial n-axis manipulator containing only revolute pairs
is considered. Then, relations associated with prismatic pairs are introduced, and
finally, the joint rates of six-axis manipulators are calculated in terms of the EE
twist. Particular attention is given to decoupled manipulators, for which simplified
velocity relations are derived.
</p>
<p>We consider here the manipulator of Fig. 5.1, in which a joint coordinate �i ,
a joint rate P�i , and a unit vector ei are associated with each revolute axis. The
Xi ; Yi ; Zi coordinate frame, attached to the .i � 1/st link, is not shown, but its
</p>
<p>Fig. 5.1 General n-axis manipulator</p>
<p/>
</div>
<div class="page"><p/>
<p>5.2 Velocity Analysis of Serial Manipulators 187
</p>
<p>originOi is indicated. If the angular-velocity vector of the i th link is denoted by!i ,
then we have, from Fig. 5.1,
</p>
<p>!0 D 0
!1 D P�1e1
!2 D P�1e1 C P�2e2
</p>
<p>:::
</p>
<p>!n D P�1e1 C P�2e2 C � � � C P�nen (5.1)
</p>
<p>and if the angular velocity of the EE is denoted by !, then
</p>
<p>! � !n D P�1e1 C P�2e2 C � � � C P�nen D
n
X
</p>
<p>1
</p>
<p>P�iei
</p>
<p>Likewise, from Fig. 5.1, one readily derives
</p>
<p>p D a1 C a2 C � � � C an (5.2)
</p>
<p>where p denotes the position vector of point P of the EE. Moreover, notice that all
vectors of the above equation must be expressed in the same frame; otherwise, the
addition would not be possible&mdash;vector ai was defined as expressed in the i th frame
in Eq. (4.3c). Upon differentiating both sides of Eq. (5.2), we have
</p>
<p>Pp D Pa1 C Pa2 C � � � C Pan (5.3)
</p>
<p>Since vector ai is fixed to the i th link,
</p>
<p>Pai D !i � ai ; i D 1; 2; : : : ; n (5.4)
</p>
<p>Furthermore, substitution of Eqs. (5.1) and (5.4) into Eq. (5.3) yields
</p>
<p>Pp D P�1e1 � a1 C . P�1e1 C P�2e2/ � a2 C
:::
</p>
<p>C. P�1e1 C P�2e2 C � � � C P�nen/ � an (5.5)
</p>
<p>which can be readily rearranged as
</p>
<p>Pp D P�1e1 � .a1 C a2 C � � � C an/C P�2e2 � .a2 C a3 C � � � C an/
C � � � C P�nen � an</p>
<p/>
</div>
<div class="page"><p/>
<p>188 5 Kinetostatics of Serial Robots
</p>
<p>Now vector ri is defined as that joining Oi with P , directed from the former to
the latter, as depicted in Fig. 5.1, i.e.,
</p>
<p>ri � ai C aiC1 C � � � C an (5.6)
</p>
<p>and hence, Pp can be rewritten as
</p>
<p>Pp D
n
X
</p>
<p>1
</p>
<p>P�iei � ri
</p>
<p>Further, let A and B denote the 3 � n matrices defined as
</p>
<p>A �
�
</p>
<p>e1 e2 � � � en
�
</p>
<p>(5.7a)
</p>
<p>B �
�
</p>
<p>e1 � r1 e2 � r2 � � � en � rn
�
</p>
<p>(5.7b)
</p>
<p>the n-dimensional joint-rate vector P� being defined, in turn, as
</p>
<p>P� �
� P�1 P�2 � � � P�n
</p>
<p>�T
</p>
<p>Thus, ! and Pp can be expressed in a more compact form as
</p>
<p>! D A P�; Pp D B P�
</p>
<p>the twist of the EE being defined, in turn, as
</p>
<p>t �
�
</p>
<p>!
</p>
<p>Pp
</p>
<p>�
</p>
<p>(5.8)
</p>
<p>The EE twist is thus linearly related to the joint-rate vector P� , i.e.,
</p>
<p>J P� D t (5.9)
</p>
<p>where J is the Jacobian matrix, or Jacobian, for brevity, of the manipulator under
study, first introduced by Whitney (1972). The Jacobian is defined as the 6�nmatrix
shown below:
</p>
<p>J D
�
</p>
<p>A
</p>
<p>B
</p>
<p>�
</p>
<p>(5.10a)
</p>
<p>or
</p>
<p>J D
�
</p>
<p>e1 e2 � � � en
e1 � r1 e2 � r2 � � � en � rn
</p>
<p>�
</p>
<p>(5.10b)
</p>
<p>Apparently, an alternative definition of the foregoing Jacobian matrix can be
given as
</p>
<p>J D @t
@ P�</p>
<p/>
</div>
<div class="page"><p/>
<p>5.2 Velocity Analysis of Serial Manipulators 189
</p>
<p>Moreover, if ji denotes the i th column of J, one has
</p>
<p>ji D
�
</p>
<p>ei
</p>
<p>ei � ri
</p>
<p>�
</p>
<p>It is noteworthy that if the axis of the i th revolute is denoted by Ri , then ji is
nothing but the Pl&uuml;cker array of that line, with the moment of Ri being taken with
respect to the operation point P of the EE.
</p>
<p>On the other hand, if the i th pair is prismatic, then the .i � 1/st and the i th
links have the same angular velocity, for a prismatic pair does not allow any relative
rotation. However, vector ai joining the origins of the i th and .i C 1/st frames is no
longer of constant magnitude, but undergoes a change of magnitude along the axis
of the prismatic pair. This can be appreciated by looking at Fig. 4.6, with bi playing
the role of joint variable. Hence,
</p>
<p>!i D !i�1; Pai D !i�1 � ai C Pbiei
</p>
<p>One can readily prove, in this case, that
</p>
<p>! D P�1e1 C P�2e2 C � � � C P�i�1ei�1 C P�iC1eiC1 C � � � C P�nen
Pp D P�1e1 � r1 C P�2e2 � r2 C � � � C P�i�1ei�1 � ri�1 C Pbiei
C P�iC1eiC1 � riC1 C � � � C P�nen � an
</p>
<p>from which it is apparent that the relation between the twist of the EE and the joint-
rate vector is formally identical to that appearing in Eq. (5.9) if vector P� is now
defined as
</p>
<p>P� �
� P�1 P�2 � � � P�i�1 Pbi P�iC1 � � � P�n
</p>
<p>�T
</p>
<p>the i th column of J then changing to
</p>
<p>ji D
�
</p>
<p>0
</p>
<p>ei
</p>
<p>�
</p>
<p>(5.11)
</p>
<p>Note that the Pl&uuml;cker array of the axis of the i th joint, if prismatic, is that of a line
at infinity lying in a plane normal to the unit vector ei , as defined in Eq. (3.33).
</p>
<p>If, in general, JA denotes the Jacobian defined for a point A of the EE and JB
that defined for another point B , then the relation between JA and JB is
</p>
<p>JB D UJA (5.12a)
</p>
<p>where the 6 � 6 matrix U is defined as
</p>
<p>U �
�
</p>
<p>1 O
</p>
<p>A � B 1
</p>
<p>�
</p>
<p>(5.12b)</p>
<p/>
</div>
<div class="page"><p/>
<p>190 5 Kinetostatics of Serial Robots
</p>
<p>while A and B are now the cross-product matrices of the position vectors a and b
of points A and B , respectively. Moreover, this matrix U is identical to the matrix
defined under the same name in Eq. (3.29b), and hence, it belongs to the 6 � 6
unimodular group, i.e., the group of 6 � 6 matrices whose determinant is unity.
Thus,
</p>
<p>det.JB/ D det.JA/ (5.13)
</p>
<p>We have then proven the result below:
</p>
<p>Theorem 5.2.1. The determinant of the Jacobian matrix of a six-axis manipulator
</p>
<p>is not affected under a change of operation point of the EE.
</p>
<p>Note, however, that the Jacobian matrix itself changes under a change of
operation point. By analogy with the twist- and the wrench-transfer formulas,
Eq. (5.12a) can be called the Jacobian-transfer formula.
</p>
<p>In particular, for six-axis manipulators, J is a 6� 6 matrix. Whenever this matrix
is nonsingular, Eq. (5.9) can be solved for P� , namely,
</p>
<p>P� D J�1t (5.14)
</p>
<p>Equation (5.14) is only symbolic, for the inverse of the Jacobian matrix need
not be computed explicitly. Indeed, in the general case, matrix J cannot be
inverted symbolically, and hence, P� is computed using a numerical procedure,
the most suitable one being the Gauss-elimination algorithm, also known as LU
decomposition (Golub and Van Loan 1989). Gaussian elimination produces the
solution by recognizing that a system of linear equations is most easily solved
when it is in either upper- or lower-triangular form. To exploit this fact, matrix J
is decomposed into the unique L and U factors in the form:
</p>
<p>J D LU (5.15a)
</p>
<p>where L is lower- and U is upper-triangular. Moreover, they have the forms
</p>
<p>L D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>1 0 � � � 0
l21 1 � � � 0
:::
:::
: : :
</p>
<p>:::
</p>
<p>ln1 ln2 � � � 1
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(5.15b)
</p>
<p>U D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>u11 u12 � � � u1n
0 u22 � � � u2n
:::
</p>
<p>:::
: : :
</p>
<p>:::
</p>
<p>0 0 � � � unn
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(5.15c)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.2 Velocity Analysis of Serial Manipulators 191
</p>
<p>where in the particular case at hand, n D 6. Thus, the unknown vector of joint rates
can now be computed from two triangular systems, namely,
</p>
<p>Ly D t; U P� D y (5.16)
</p>
<p>The above equations are then solved, first for y and then for P� , by application of
only forward and backward substitutions, respectively. The LU decomposition of
a n � n matrix requires M 0n multiplications and A0n additions, whereas the forward
substitution needed in solving the lower-triangular system of Eq. (5.16) requiresM 00n
multiplications and A00n additions. Moreover, the backward substitution needed in
solving the upper-triangular system of Eq. (5.16) requires M 000n multiplications and
A000n additions. These figures are (Dahlquist and Bj&ouml;rck 1974)
</p>
<p>M 0n D
n3
</p>
<p>3
C n
</p>
<p>2
</p>
<p>2
C n
6
; A0n D
</p>
<p>n3
</p>
<p>3
� n
3
</p>
<p>(5.17a)
</p>
<p>M 00n D
n.n � 1/
</p>
<p>2
; A00n D
</p>
<p>n.n � 1/
2
</p>
<p>(5.17b)
</p>
<p>M 000n D
n.nC 1/
</p>
<p>2
; A000n D
</p>
<p>n.n � 1/
2
</p>
<p>(5.17c)
</p>
<p>Thus, the solution of a system of n linear equations in n unknowns, using the
LU-decomposition method, can be accomplished with Mn multiplications and An
additions, as given below (Dahlquist and Bj&ouml;rck 1974):
</p>
<p>Mn D
n
</p>
<p>6
.2n2 C 9nC 1/; An D
</p>
<p>n
</p>
<p>3
.n2 C 3n � 4/ (5.18a)
</p>
<p>Hence, the velocity resolution of a six-axis manipulator of arbitrary architecture
requires M6 multiplications and A6 additions, i.e.,
</p>
<p>M6 D 127; A6 D 100 (5.18b)
</p>
<p>5.2.1 Decoupled Manipulators
</p>
<p>Decoupled manipulators allow an even simpler velocity resolution. For manipula-
tors with this type of architecture, it is more convenient to deal with the velocity of
the center C of the wrist than with that of the operation point P . Thus, one has
</p>
<p>tC D J P�</p>
<p/>
</div>
<div class="page"><p/>
<p>192 5 Kinetostatics of Serial Robots
</p>
<p>where tC is defined as
</p>
<p>tC D
�
</p>
<p>!
</p>
<p>Pc
</p>
<p>�
</p>
<p>and can be obtained from tP � Œ!T ; PpT &#141;T using the twist-transfer formula given by
Eqs. (3.83a) and (3.83b) as
</p>
<p>tC D
�
</p>
<p>1 O
</p>
<p>P � C 1
</p>
<p>�
</p>
<p>tP
</p>
<p>with C and P defined as the cross-product matrices of the position vectors c and p,
respectively.
</p>
<p>Since C is on the last three joint axes, its velocity is not affected by the motion
of the last three joints, and hence, we can write
</p>
<p>Pc D P�1e1 � r1 C P�2e2 � r2 C P�3e3 � r3
</p>
<p>where, in the case of a decoupled manipulator, vector ri is defined as that directed
from Oi to C . On the other hand, we have
</p>
<p>! D P�1e1 C P�2e2 C P�3e3 C P�4e4 C P�5e5 C P�6e6
</p>
<p>and thus, the Jacobian takes on the following simple form
</p>
<p>J D
�
</p>
<p>J11 J12
</p>
<p>J21 O
</p>
<p>�
</p>
<p>(5.19)
</p>
<p>where O denotes the 3 � 3 zero matrix, the other 3 � 3 blocks being given below,
for manipulators with revolute pairs only, as
</p>
<p>J11 D
�
</p>
<p>e1 e2 e3
�
</p>
<p>(5.20a)
</p>
<p>J12 D
�
</p>
<p>e4 e5 e6
�
</p>
<p>(5.20b)
</p>
<p>J21 D
�
</p>
<p>e1 � r1 e2 � r2 e3 � r3
�
</p>
<p>(5.20c)
</p>
<p>Further, vector P� is partitioned accordingly:
</p>
<p>P� �
� P�a
P�w
</p>
<p>�
</p>
<p>where
</p>
<p>P�a �
</p>
<p>2
</p>
<p>4
</p>
<p>P�1
P�2
P�3
</p>
<p>3
</p>
<p>5 ; P�w �
</p>
<p>2
</p>
<p>4
</p>
<p>P�4
P�5
P�6
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>5.2 Velocity Analysis of Serial Manipulators 193
</p>
<p>Henceforth, the three components of P�a will be referred to as the arm rates, whereas
those of P�w will be called the wrist rates. Now Eqs. (5.9) can be written, for this
particular case, as
</p>
<p>J11 P�a C J12 P�w D ! (5.21a)
J21 P�a D Pc (5.21b)
</p>
<p>from which the solution is derived successively from the two systems of three
equations and three unknowns that follow:
</p>
<p>J21 P�a D Pc (5.22a)
J12 P�w D ! � J11 P�a (5.22b)
</p>
<p>From the general expressions (5.17), then, it is apparent that each of the foregoing
systems can be solved with the numbers of operations shown below:
</p>
<p>M3 D 23; A3 D 14
</p>
<p>Since the computation of the right-hand side of Eq. (5.22b) requires, additionally,
nine multiplications and nine additions, the total numbers of operations required to
perform one joint-rate resolution of a decoupled manipulator, Mv multiplications
and Av additions, are given by
</p>
<p>Mv D 55; Av D 37 (5.23)
</p>
<p>which are fairly low figures and can be performed in a matter of microseconds using
a modern processor.
</p>
<p>It is apparent from the foregoing kinematic relations that Eq. (5.22a) should be
first solved for P�a; with this value available, Eq. (5.22b) can then be solved for P�w.
We thus have, symbolically,
</p>
<p>P�a D J�121 Pc (5.24)
P�w D J�112 .! � J11 P�a/ (5.25)
</p>
<p>Now, if we recall the concept of reciprocal bases introduced in Sect. 2.7.1, the above
inverses can be represented explicitly. Indeed, let
</p>
<p>&#129;21 � det.J21/ D .e1 � r1/ � .e2 � r2/ � .e3 � r3/ (5.26)
&#129;12 � det.J12/ D e4 � e5 � e6 (5.27)</p>
<p/>
</div>
<div class="page"><p/>
<p>194 5 Kinetostatics of Serial Robots
</p>
<p>Then,
</p>
<p>J�121 D
1
</p>
<p>&#129;21
</p>
<p>2
</p>
<p>4
</p>
<p>Œ.e2 � r2/ � .e3 � r3/&#141;T
Œ.e3 � r3/ � .e1 � r1/&#141;T
Œ.e1 � r1/ � .e2 � r2/&#141;T
</p>
<p>3
</p>
<p>5 (5.28)
</p>
<p>J�112 D
1
</p>
<p>&#129;12
</p>
<p>2
</p>
<p>4
</p>
<p>.e5 � e6/T
</p>
<p>.e6 � e4/T
</p>
<p>.e4 � e5/T
</p>
<p>3
</p>
<p>5 (5.29)
</p>
<p>Therefore,
</p>
<p>P�a D
1
</p>
<p>&#129;21
</p>
<p>2
</p>
<p>4
</p>
<p>.e2 � r2/ � .e3 � r3/ � Pc
</p>
<p>.e3 � r3/ � .e1 � r1/ � Pc
</p>
<p>.e1 � r1/ � .e2 � r2/ � Pc
</p>
<p>3
</p>
<p>5 (5.30a)
</p>
<p>and, if we let1
</p>
<p>$ � ! � J11 P�a (5.30b)
</p>
<p>then
</p>
<p>P�w D
1
</p>
<p>&#129;12
</p>
<p>2
</p>
<p>4
</p>
<p>e5 � e6 �$
e6 � e4 �$
e4 � e5 �$
</p>
<p>3
</p>
<p>5 (5.30c)
</p>
<p>5.3 Jacobian Evaluation
</p>
<p>The evaluation of the Jacobian matrix of a manipulator with n revolutes is discussed
in this subsection, the presence of a prismatic pair leading to simplifications that
will be outlined. Our aim here is to devise algorithms requiring a minimum number
of operations, for these calculations are needed either in real-time or in off-line
applications when these require Jacobian evaluations at massive numbers of poses,
of the order of millions.2 We assume at the outset that all joint variables producing
the desired EE pose are available. We divide this section into two subsections, one
for the evaluation of the upper part of the Jacobian matrix and one for the evaluation
of its lower part.
</p>
<p>1$ is read varpi.
2One such application occurs in path planning for machining operations. Robotmaster offers a
feature that allows the display of maps of the Jacobian condition number, introduced in Sect. 5.8.</p>
<p/>
</div>
<div class="page"><p/>
<p>5.3 Jacobian Evaluation 195
</p>
<p>5.3.1 Evaluation of Submatrix A
</p>
<p>The upper part A of the Jacobian matrix is composed of the set f ei gn1 , our aim
here being the calculation of these unit vectors. Note, moreover, that vector Œ ei &#141;1
is nothing but the last column of Pi�1 � Q1 � � �Qi�1, our task then being the
calculation of these matrix products. According to the DH notation,
</p>
<p>Œ ei &#141;i D
�
</p>
<p>0 0 1
�T
</p>
<p>Hence, Œ e1 &#141;1 is available at no cost. However, each of the remaining Œ ei &#141;1 vectors,
for i D 2; : : : ; n, is obtained as the last column of matrices Pi�1. The recursive
calculation of these matrices is described below:
</p>
<p>P1 � Q1
P2 � P1Q2
</p>
<p>:::
</p>
<p>Pn � Pn�1Qn
</p>
<p>and hence, a simple algorithm follows:
</p>
<p>P1  Q1
For i D 2 to n do
</p>
<p>Pi  Pi�1Qi
enddo
</p>
<p>Now, since P1 is identical to Q1, the first product appearing in the do-loop, P1Q2,
is identical to Q1Q2, whose two factors have a special structure. The computation
of this product, then, requires special treatment, which warrants further discussion
because of its particular features. From the structure of matrices Qi , as displayed in
Eq. (4.1e), we have
</p>
<p>P2 �
</p>
<p>2
</p>
<p>4
</p>
<p>cos �1 ��1 sin �1 �1 sin �1
sin �1 �1 cos �1 ��1 cos �1
0 �1 �1
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>cos �2 ��2 sin �2 �2 sin �2
sin �2 �2 cos �2 ��2 cos �2
0 �2 �2
</p>
<p>3
</p>
<p>5
</p>
<p>The foregoing product is calculated now by first computing the products �1�2, �1�2,
�1�2, and �2�1, which involve only constant quantities, these terms thus being
posture-independent. Thus, in tracking a prescribed Cartesian trajectory, the manip-
ulator posture changes continuously, and hence, its joint variables also change.
However, its DH parameters, those defining its architecture, remain constant.</p>
<p/>
</div>
<div class="page"><p/>
<p>196 5 Kinetostatics of Serial Robots
</p>
<p>Therefore, the four above products remain constant as well and are computed prior
to tracking a trajectory, i.e., off-line. In computing these products, we store them as
</p>
<p>�12 � �1�2; �21 � �1�2; �12 � �1�2; �21 � �2�1
</p>
<p>Next, we perform the on-line computations. First, let3
</p>
<p>�  �1 sin �2
�  sin �1 cos �2
�  cos �1 cos �2
u  cos �1 sin �2 C �1�
v  sin �1 sin �2 � �1�
</p>
<p>and hence,
</p>
<p>P2 D
</p>
<p>2
</p>
<p>4
</p>
<p>� � � sin �1 ��2uC �12 sin �1 �2uC �21 sin �1
� C � cos �1 ��2v � �12 cos �1 �2v � �21 cos �1
�1 sin �2 �21 cos �2 C �21 ��12 cos �2 C �12
</p>
<p>3
</p>
<p>5
</p>
<p>As the reader can verify, the foregoing calculations consume 20 multiplications and
ten additions. Now, we proceed to compute the remaining products in the foregoing
do-loop.
</p>
<p>Here, notice that the product Pi�1Qi , for 3 � i � n, can be computed
recursively, as described below: Let Pi�1 and Pi be given as
</p>
<p>Pi�1 �
</p>
<p>2
</p>
<p>4
</p>
<p>p11 p12 p13
p21 p22 p23
p31 p32 p33
</p>
<p>3
</p>
<p>5
</p>
<p>Pi �
</p>
<p>2
</p>
<p>4
</p>
<p>p011 p
0
12 p
</p>
<p>0
13
</p>
<p>p021 p
0
22 p
</p>
<p>0
23
</p>
<p>p031 p
0
32 p
</p>
<p>0
33
</p>
<p>3
</p>
<p>5
</p>
<p>Now matrix Pi is computed by first defining
</p>
<p>ui D p11 sin �i � p12 cos �i
vi D p21 sin �i � p22 cos �i
wi D p31 sin �i � p32 cos �i (5.31a)
</p>
<p>3Although � and v look similar, they should not be confused with each other, the former being the
lowercase Greek letter upsilon. As a matter of fact, no confusion should arise, because upsilon is
used only once, and does not appear further in the book.</p>
<p/>
</div>
<div class="page"><p/>
<p>5.3 Jacobian Evaluation 197
</p>
<p>and
</p>
<p>p011 D p11 cos �i C p12 sin �i
p012 D �ui�i C p13�i
p013 D ui�i C p13�i
p021 D p21 cos �i C p22 sin �i
p022 D �vi�i C p23�i
p023 D vi�i C p23�i
p031 D p31 cos �i C p32 sin �i
p032 D �wi�i C p33�i
p033 D wi�i C p33�i (5.31b)
</p>
<p>Computing ui , vi , and wi requires six multiplications and three additions,
whereas each of the p0ij entries requires two multiplications and one addition.
Hence, the computation of each Pi matrix requires 24 multiplications and 12
additions, the total number of operations required to compute the n � 2 products
fPi gn�12 thus being 24.n�2/C20 D 24n�28multiplications and 12.n�2/C10 D
12n � 14 additions, for n � 2. Moreover, P1, i.e., Q1, requires four multiplications
and no additions, the total number of multiplicationsMA and additions AA required
to compute matrix A thus being
</p>
<p>MA D 24n � 24; AA D 12n � 14 (5.32)
</p>
<p>Before concluding this subsection, a remark is in order: The reader may realize
that Pn is nothing but Q, and hence, the same reader may wonder whether we could
not save some operations in the foregoing computations by stopping the above
recursive algorithm at n � 1, rather than at n. This is not a good idea, for the above
equality holds if and only if the manipulator is capable of tracking perfectly a given
trajectory. However, reality is quite different, and errors are always present when
tracking. As a matter of fact, the mismatch between Pn and Q is very useful in
estimating orientation errors, which are then used in a feedback-control scheme to
synthesize the corrective signals that are intended to correct those errors.
</p>
<p>5.3.2 Evaluation of Submatrix B
</p>
<p>The computation of submatrix B of the Jacobian is studied here. This submatrix
comprises the set of vectors f ei � ri gn1 . We thus proceed first to the computation
of vectors ri , for i D 1; : : : ; n, which is most efficiently done using a recursive
scheme, similar to that of Horner for polynomial evaluation (Henrici 1964), namely,</p>
<p/>
</div>
<div class="page"><p/>
<p>198 5 Kinetostatics of Serial Robots
</p>
<p>Œ r6 &#141;6  Œ a6 &#141;6
For i D 5 to 1 do
</p>
<p>Œ ri &#141;i  Œ ai &#141;i CQi Œ riC1 &#141;iC1
enddo
</p>
<p>In the foregoing algorithm, a simple scheme is introduced to perform the product
Qi Œ riC1 &#141;iC1 economically: if we let Œ riC1 &#141;iC1 D Œ r1; r2; r3 &#141;T , then
</p>
<p>Qi Œ riC1 &#141;iC1 D
</p>
<p>2
</p>
<p>4
</p>
<p>cos �i ��i sin �i �i sin �i
sin �i �i cos �i ��i cos �i
0 �i �i
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>r1
r2
r3
</p>
<p>3
</p>
<p>5
</p>
<p>D
</p>
<p>2
</p>
<p>4
</p>
<p>r1 cos �i � u sin �i
r1 sin �i C u cos �i
r2�i C r3�i
</p>
<p>3
</p>
<p>5 (5.33a)
</p>
<p>where
</p>
<p>u � r2�i � r3�i (5.33b)
</p>
<p>Therefore, the product of matrix Qi by an arbitrary vector consumes eight multipli-
cations and four additions.
</p>
<p>Furthermore, each vector Œ ai &#141;i , for i D 1; : : : ; n, requires two multiplications
and no additions, as made apparent from their definitions in Eq. (4.3b). Moreover,
from the foregoing evaluation of Qi Œ riC1 &#141;iC1, it is apparent that each vector ri ,
in frame Fi , is computed with ten multiplications and seven additions&mdash;two more
multiplications are needed to calculate each vector Œ ai &#141;i and three more additions
are required to add the latter to vector Qi Œ riC1 &#141;iC1&mdash;the whole set of vectors
f ri gn1 thus being computed, in Fi -coordinates, with 10.n � 1/ C 2 D 10n � 8
multiplications and 7.n�1/ additions, where one coordinate transformation, that of
r1, is not counted, since this vector is computed directly in F1.
</p>
<p>Now we turn to the transformation of the components of all the foregoing vectors
into F1-coordinates. First, note that we can proceed now in two ways: in the first,
we transform the individual vectors ei and ri from Fi - into F1-coordinates and then
compute their cross product; in the second, we first perform the cross products and
then transform each of these products into F1-coordinates. It is apparent that the
second approach is more efficient, which is why we choose it here.
</p>
<p>In order to calculate the products ei � ri in Fi -coordinates, we let Œ ri &#141;i D
Œ �1; �2; �3 &#141;
</p>
<p>T . Moreover, Œ ei &#141;i D Œ 0; 0; 1 &#141;T , and hence,
</p>
<p>Œ ei � ri &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>��2
�1
0
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>5.4 Singularity Analysis of Decoupled Manipulators 199
</p>
<p>which is thus obtained at no cost. Now, the transformation from Fi - into F1-
coordinates is simply
</p>
<p>Œ ei � ri &#141;1 D Pi�1Œ ei � ri &#141;i (5.34)
</p>
<p>In particular, Œ e1 � r1 &#141;1 needs no transformation, for its two factors are given
in F1-coordinates. The F1-components of the remaining cross products are com-
puted using the general transformation of Eq. (5.34). In the case at hand, this
transformation requires, for each i , six multiplications and three additions, for
this transformation involves the product of a full 3 � 3 matrix, Pi�1, by a three-
dimensional vector, ei �ri , whose third component vanishes. Thus, the computation
of matrix B requires MB multiplications and AB additions, as given below:
</p>
<p>MB D 16n � 14; AB D 10.n � 1/ (5.35)
</p>
<p>In total, then, the evaluation of the complete Jacobian requires MJ multiplica-
tions and AJ additions, namely,
</p>
<p>MJ D 40n � 38; AJ D 22n � 24 (5.36)
</p>
<p>In particular, for a six-revolute manipulator, these figures are 202 multiplications
and 108 additions.
</p>
<p>Now, if the manipulator contains some prismatic pairs, the foregoing figures
diminish correspondingly. Indeed, if the i th joint is prismatic, then the i th column
of the Jacobian matrix changes as indicated in Eq. (5.11). Hence, one cross-
product calculation is spared, along with the associated coordinate transformation.
As a matter of fact, as we saw above, the cross product is computed at no cost
in local coordinates, and so each prismatic pair of the manipulator reduces the
foregoing numbers of operations by only one coordinate transformation, i.e., by
ten multiplications and seven additions.
</p>
<p>5.4 Singularity Analysis of Decoupled Manipulators
</p>
<p>In performing the computation of the joint rates for a decoupled manipulator, it was
assumed that neither J12 nor J21 is singular. If the latter is singular, then none of
the joint rates can be evaluated, even if the former is nonsingular. However, if J21 is
nonsingular, then Eq. (5.21a) can be solved for the arm rates even if J12 is singular.
Each of these sub-Jacobians is analyzed for singularities below.
</p>
<p>We will start analyzing J21, whose singularity determines whether any joint-rate
resolution is possible at all. First, we note from Eq. (5.20c) that the columns of J21
are the three vectors e1�r1, e2�r2, and e3�r3. Hence, J21 becomes singular if either
these three vectors become coplanar or at least one of them vanishes. Furthermore,
neither the relative layout of these three vectors nor their magnitudes change if</p>
<p/>
</div>
<div class="page"><p/>
<p>200 5 Kinetostatics of Serial Robots
</p>
<p>the manipulator undergoes a motion about the first revolute axis while keeping
the second and the third revolute axes locked. This means that �1 does not affect
the singularity of the manipulator, a result that can also be derived from invariance
arguments&mdash;see Sect. 2.6&mdash;and by noticing that singularity is, indeed, an invariant
property. Hence, whether a configuration is singular or not is independent of the
viewpoint of the observer, a change in �1 being nothing but a change of viewpoint.
The same argument holds for b1 in cases where the first joint is prismatic.
</p>
<p>The singularity of a three-revolute arm for positioning tasks was analyzed by
Burdick (1995), upon recognizing that (a) given three arbitrary lines in space, the
three revolute axes in our case, it is always possible to find a set of lines that
intersects all three, and (b) the moments of the three lines about any point on the
intersecting line are all zero. As a matter of fact, the locus of those lines is a quadric
ruled surface, namely, a one-sheet hyperboloid&mdash;see Exercise 3.3. Therefore, if the
endpoint of the third moving link lies in this quadric, the manipulator is in a singular
posture, and velocities of C along the intersecting line cannot be produced. This
means that the manipulator has lost, to a first order, one degree of freedom. Here we
emphasize that this loss is meaningful only at a first order because, in fact, a motion
along that intersecting line may still be possible, provided that the full nonlinear
relations of Eq. (4.16) are considered. If such a motion is at all possible, however,
then it is so only in one direction, as we shall see in Case 2 below. Motions in the
opposite direction are not feasible because of the rigidity of the links.
</p>
<p>We will illustrate the foregoing concepts as pertaining to the most common types
of industrial manipulators, i.e., those of the orthogonal type. In these cases, two
consecutive axes either intersect at right angles or are parallel; most of the time, the
first two axes intersect at right angles and the last two are parallel. Below we study
each of these cases separately.
</p>
<p>Case 1: Two consecutive axes intersect and C lies in their plane. Here, the ruled
hyperboloid containing the lines that intersect all three axes degenerates into a
plane, namely, that of the two intersecting axes. For conciseness, let us assume
that the first two axes intersect, but the derivations are the same if the intersecting
axes are the last two. Moreover, let O12 be the intersection of the first two axes,
&hellip;12 being the plane of these axes and n12 its normal. If we recall the notation
adopted in Sect. 5.2, we have now that the vector directed from O12 to C can be
regarded as both r1 and r2. Furthermore, e1 � r1 and e2 � r2 (D e2 � r1) are both
parallel to n12. Hence, the first two axes can only produce velocities of C in the
direction of n12. As a consequence, velocities of C in &hellip;12 and perpendicular to
e3�r3 cannot be produced in the presence of this singularity. The set of unfeasible
velocities, then, lies in a line normal to n12 and e3 � r3, whose direction is the
geometric representation of the null space of JT21. Likewise, the manipulator can
withstand forces applied at C in the direction of the same line purely by reaction
wrenches, i.e., without any motor torques. The last issue falls into the realm of
manipulator statics, upon which we will elaborate in Sect. 5.6.
We illustrate this singularity, termed here shoulder singularity, in a manipulator
with the architecture of Fig. 4.3, as postured in Fig. 5.2. In this figure, the line</p>
<p/>
</div>
<div class="page"><p/>
<p>5.4 Singularity Analysis of Decoupled Manipulators 201
</p>
<p>Fig. 5.2 Shoulder singularity
of the Puma robot
</p>
<p>I
</p>
<p>,
</p>
<p>Fig. 5.3 Elbow singularity of the Puma robot
</p>
<p>intersecting all three arm axes is not as obvious and needs further explanation.
This line is indicated by L in that figure, and is parallel to the second and third
axes. It is apparent that this line intersects the first axis at right angles at a point
I . Now, if we take into account that all parallel lines intersect at infinity, then it
becomes apparent that L intersects the axes of the second and third revolutes as
well, and hence, L intersects all three axes.
</p>
<p>Case 2: Two consecutive axes are parallel and C lies in their plane, as shown
in Fig. 5.3. For conciseness, again, we assume that axes 2 and 3 are parallel, a
rather common case in industrial manipulators, but the derivations below are the
same if the parallel axes are the first two. We now let&hellip;23 be the plane of the last</p>
<p/>
</div>
<div class="page"><p/>
<p>202 5 Kinetostatics of Serial Robots
</p>
<p>two axes and n23 its normal. Furthermore, e3 D e2 and r2 D r1; moreover, the
intersection of O2C with L3 is point I of the same figure, while O3I D d ; then,
r3 D de3 C ˛r2 and e3 � r3 D ˛.e2 � r2), where
</p>
<p>˛ D
</p>
<p>q
</p>
<p>a23 C b24
</p>
<p>a2 C
q
</p>
<p>a23 C b24
</p>
<p>in terms of the Denavit&ndash;Hartenberg notation, thereby making apparent that
the last two columns of J21 are linearly dependent. Moreover, e2 � r2 and,
consequently, e3 � r3 are parallel to n23, the last two axes being capable of
producing velocities of C only in the direction of n23. Hence, velocities of C
in &hellip;23 that are normal to e1 � r1, i.e., along line L, cannot be produced in this
configuration, and the manipulator loses, again, to a first-order approximation,
one degree of freedom. The set of infeasible velocities, then, is parallel to the
line L of Fig. 5.3, whose direction is the geometric representation of the null
space of JT21. The singularity displayed in the foregoing figure, termed here the
elbow singularity, pertains also to a manipulator with the architecture of Fig. 4.3.
Notice that motions along L in the posture displayed in Fig. 5.3 are possible, but
only in one direction, from C to O2.
</p>
<p>With regard to the wrist singularities, these were already studied when solving
the orientation problem for the inverse displacement analysis of decoupled manip-
ulators. Here, we study the same in light of the sub-Jacobian J12 of Eq. (5.20b).
This sub-Jacobian obviously vanishes when the wrist is so configured that its three
revolute axes are coplanar, which thus leads to
</p>
<p>e4 � e5 � e6 D 0
</p>
<p>Note that when studying the orientation problem of decoupled manipulators, we
found that orthogonal wrists are singular when the sixth and fourth axes are aligned,
in full agreement with the foregoing condition. Indeed, if these two axes are aligned,
then e4 D �e6, and the above equation holds.
</p>
<p>5.4.1 Manipulator Workspace
</p>
<p>The workspace of spherical wrists for orientation tasks was discussed in Sect. 4.4.2.
Here we focus on the workspaces of three-axis positioning manipulators in light of
their singularities.
</p>
<p>In order to gain insight into the problem, we study first the workspace of
manipulators with the architecture of Fig. 4.3. Figures 5.2 and 5.3 show such a
manipulator with point C at the limit of its positioning capabilities in one direction,
i.e., at the boundary of its workspace. Moreover, with regard to the posture of</p>
<p/>
</div>
<div class="page"><p/>
<p>5.4 Singularity Analysis of Decoupled Manipulators 203
</p>
<p>a b
</p>
<p>c
</p>
<p>Fig. 5.4 Workspace of a Puma manipulator (a) top view; (b) cross-section; and (c) 3D view
</p>
<p>Fig. 5.2, it is apparent that the first singularity is preserved if (a) point C moves
on a line parallel to the first axis and intersecting the second axis; and (b) with the
second and third joints locked, the first joint goes through a full turn. Under the
second motion, the line of the first motion sweeps a circular cylinder whose axis
is the first manipulator axis and with radius equal to b3, the shoulder offset. This
cylinder constitutes a part of the workspace boundary, the other part consisting of a
spherical surface. Indeed, the second singularity is preserved if (a) with point C in
the plane of the second and third axes, the second joint makes a full turn, thereby
tracing a circle with center on L2, the plane of circle lying a distance b3 from the
</p>
<p>first axis, with the circle radius r D a2 C
q
</p>
<p>a23 C b24 ; and (b) with point C still
in the plane of the second and third joints, the first joint makes a full turn. Under
the second motion, the circle generated by the first motion describes a sphere of
</p>
<p>radius R D
q
</p>
<p>b23 C r2 because any point of that circle lies a distance R from the
intersection of the first two axes. The pointO1, that coincides withO2, thus becomes
the center of the sphere, which is the second part of the workspace, as shown in
Fig. 5.4.
</p>
<p>The determination of the workspace boundaries of more general manipulators
requires, obviously, more general approaches, like that proposed by Ceccarelli
(1996). By means of an alternative approach, Ranjbaran et al. (1992) found
the workspace boundary with the aid of the general characteristic equation of a
three-revolute manipulator. This equation is a quartic polynomial, as displayed in
Eq. (4.25). From the discussion of Sect. 4.4.1, it is apparent that at singularities, two</p>
<p/>
</div>
<div class="page"><p/>
<p>204 5 Kinetostatics of Serial Robots
</p>
<p>distinct roots of the IDP merge into a single one. This happens at points where the
plot of the characteristic polynomial of Eq. (4.25) is tangent to the �3 axis, which
occurs in turn at points where the derivative of this polynomial with respect to �3
vanishes. The condition for �3 to correspond to a point C on the boundary of the
workspace is, then, that both the characteristic polynomial and its derivative with
respect to �3 vanish concurrently. These two polynomials are displayed below:
</p>
<p>P.�3/ � R�43 C S�33 C T �23 C U�3 C V D 0 (5.37a)
P 0.�3/ � 4R�33 C 3S�23 C 2T �3 C U D 0 (5.37b)
</p>
<p>with coefficientsR, S , T , U , and V defined in Eqs. (4.26a&ndash;e). From these equations
and Eqs. (4.19d&ndash;f) and (4.20d&ndash;f), it is apparent that the foregoing coefficients
are solely functions of the manipulator architecture and the Cartesian coordinates
of point C . Moreover, from the same equations, it is apparent that the above
coefficients are all quadratic in �2 � x2C C y2C and quartic in zC . Thus, since
the Cartesian coordinates xC and yC do not appear in the foregoing coefficients
explicitly, the workspace is symmetric about the Z1 axis, a result to be expected
by virtue of the independence of singularities from angle �1. Hence, the workspace
boundary is given by a function f .�2; zC / D 0 that can be derived by eliminating
�3 from Eqs. (5.37a and b). This can be readily done by resorting to any elimination
procedure, the simplest one being dialytic elimination, as discussed below.
</p>
<p>In order to eliminate �3 from the above two equations, we proceed in two steps:
In the first step, six additional polynomial equations are derived from Eqs. (5.37a
and b) by multiplying the two sides of each of these equations by �3, �23 , and �
</p>
<p>3
3 ,
</p>
<p>thereby obtaining a total of eight polynomial equations in �3, namely,
</p>
<p>R�73 C S�63 C T �53 C U�43 C V �33 D 0
4R�63 C 3S�53 C 2T �43 C U�33 D 0
</p>
<p>R�63 C S�53 C T �43 C U�33 C V �23 D 0
4R�53 C 3S�43 C 2T �33 C U�23 D 0
</p>
<p>R�53 C S�43 C T �33 C U�23 C V �3 D 0
4R�43 C 3S�33 C 2T �23 C U�3 D 0
R�43 C S�33 C T �23 C U�3 C V D 0
</p>
<p>4R�33 C 3S�23 C 2T �3 C U D 0
</p>
<p>In the second elimination step we write the above eight equations in linear
homogeneous form, namely,
</p>
<p>M�3 D 0 (5.38a)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.4 Singularity Analysis of Decoupled Manipulators 205
</p>
<p>Fig. 5.5 The workspace of
the manipulator of
Figs. 4.15&ndash;4.17
</p>
<p>with the 8 � 8 matrix M and the eight-dimensional vector �3 defined as
</p>
<p>M �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>R S T U V 0 0 0
</p>
<p>0 4R 3S 2T U 0 0 0
</p>
<p>0 R S T U V 0 0
</p>
<p>0 0 4R 3S 2T U 0 0
</p>
<p>0 0 R S T U V 0
</p>
<p>0 0 0 4R 3S 2T U 0
</p>
<p>0 0 0 R S T U V
</p>
<p>0 0 0 0 4R 3S 2T U
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>; �3 D
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>�73
�63
�53
�43
�33
�23
�3
1
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>(5.38b)
</p>
<p>It is now apparent that any feasible solution of Eq. (5.38a) must be nontrivial, and
hence, M must be singular. The desired boundary equation is then derived from the
singularity condition on M, i.e.,
</p>
<p>f .�2; zC / � det.M/ D 0 (5.39)
</p>
<p>As a matter of fact, function f .�2; zC / of Eq. (5.39), known as the (polynomial)
resolvent of Eqs. (5.37a and b), can be computed using computer algebra, upon
invoking the procedure to obtain the discriminant of Eq. (5.37a).4
</p>
<p>We used the foregoing procedure, with the help of computer algebra, to obtain
a rendering of the workspace boundary of the manipulator of Figs. 4.15&ndash;4.17, the
workspace thus obtained being displayed in Fig. 5.5. For the record, the resolvent
</p>
<p>4Although a quartic polynomial has, properly speaking, four discriminants (Yang et al. 1996),
which are defined as the central minors of matrix M of Eq. (5.39) when P.�3/ is written in
monic form&mdash;with leading coefficient equal to unity&mdash;the resolvent is sometimes referred to as
the discriminant in question.</p>
<p/>
</div>
<div class="page"><p/>
<p>206 5 Kinetostatics of Serial Robots
</p>
<p>of this manipulator, given in Eq. (5.39), turned out to be a 16th-degree bivariate
polynomial in � and zC , involving only even powers. That is, the resolvent in
question turns out to be a bivariate octic polynomial in �2 and z2C . If we let � � �2
and � � z2C , then
</p>
<p>f .�; �/ D �8C.�2C�/�7C.7 �2�32 �C27/�6C.7 �3�54 �2C97 ��42/�5
</p>
<p>C.35 �4�400 �3C1210 �2�976 �C283/�4C.7 �5�110 �4C510 �3
</p>
<p>�684 �2C123 ��70/�3C.7 �6�144 �5C965 �4�2208 �3C705 �2
</p>
<p>�272 �C83/�2C8 .�2�4 ��1/.�5�22 �4C154 �3�328 �2
</p>
<p>�155 �C14/�C.�4�24 �3C190 �2�552 �C17/.�2�4 � � 1/2D0
</p>
<p>5.5 Acceleration Analysis of Serial Manipulators
</p>
<p>The subject of this section is the computation of vector R� of second joint-
variable derivatives, also called the joint accelerations. This vector is computed
from Cartesian position, velocity, and acceleration data. To this end, both sides of
Eq. (5.9) are differentiated with respect to time, thus obtaining
</p>
<p>J R� D Pt � PJ P� (5.40)
</p>
<p>and hence,
</p>
<p>R� D J�1.Pt � PJ P�/ (5.41)
</p>
<p>From Eq. (5.40), it is apparent that the joint-acceleration vector is computed in
exactly the same way as the joint-rate vector. In fact, the LU decomposition of J is
the same in this case and hence, need not be recomputed. All that is needed is the
solution of a lower- and an upper-triangular system, namely,
</p>
<p>Lz D Pt � PJ P�; U R� D z
</p>
<p>The two foregoing systems are solved first for z and then for R� by forward and
backward substitution, respectively. The first of the foregoing systems is solved with
M 00n multiplications and A
</p>
<p>00
n additions; the second with M
</p>
<p>000
n multiplications and A
</p>
<p>000
n
</p>
<p>additions. These figures appear in Eqs. (5.12b and c). Thus, the total numbers of
multiplications Mt and additions At that the forward and backward solutions of the
aforementioned systems require are
</p>
<p>Mt D n2; At D n.n � 1/ (5.42)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.5 Acceleration Analysis of Serial Manipulators 207
</p>
<p>In Eq. (5.40), the right-hand side comprises two terms, the first being the specified
time-rate of change of the twist of the EE, or twist-rate, for brevity, which is
readily available. The second term is not available and must be computed. This
term involves the product of the time-derivative of J times the previously computed
joint-rate vector. Hence, in order to evaluate the right-hand side of that equation, all
that is further required is PJ. From Eq. (5.10a), one has
</p>
<p>PJ D
� PA
PB
</p>
<p>�
</p>
<p>where, from Eqs. (5.7a and b),
</p>
<p>PA D
�
</p>
<p>Pe1 Pe2 � � � Pen
�
</p>
<p>(5.43a)
</p>
<p>PB D
�
</p>
<p>Pu1 Pu2 � � � Pun
�
</p>
<p>(5.43b)
</p>
<p>and ui denotes ei � ri , for i D 1; 2; : : : ; n. Moreover,
</p>
<p>Pe1 D !0 � e1 D 0 (5.44a)
Pei D !i�1 � ei � !i � ei ; i D 2; 3; : : : ; n (5.44b)
</p>
<p>and
</p>
<p>Pui D Pei � ri C ei � Pri ; i D 1; 2; : : : ; n (5.44c)
</p>
<p>Next, an expression for Pri is derived by time-differentiating both sides of Eq. (5.6),
which produces
</p>
<p>Pri D Pai C PaiC1 C � � � C Pan; i D 1; 2; : : : n
</p>
<p>Recalling Eq. (5.4), the above equation reduces to
</p>
<p>Pri D !i � ai C!iC1 � aiC1 C � � � C!n � an (5.45)
</p>
<p>Substitution of Eqs. (5.44) and (5.45) into Eqs. (5.43a and b) leads to
</p>
<p>PA D
�
</p>
<p>0 !1 � e2 � � � !n�1 � en
�
</p>
<p>PB D
�
</p>
<p>e1 � Pr1 !12 � r2 C e2 � Pr2 � � � !n�1;n � rn C en � Prn
�
</p>
<p>with Prk and !k;kC1 defined as
</p>
<p>Prk �
n
X
</p>
<p>k
</p>
<p>!i � ai ; k D 1; : : : ; n (5.46a)
</p>
<p>!k;kC1 � !k � ekC1; k D 1; : : : ; n � 1 (5.46b)</p>
<p/>
</div>
<div class="page"><p/>
<p>208 5 Kinetostatics of Serial Robots
</p>
<p>The foregoing expressions are invariant and hence, valid in any coordinate frame.
However, these expressions have to be incorporated into matrix PJ; then, the latter
is to be multiplied by vector P� , as indicated in Eq. (5.40). Thus, eventually all
columns of both PA and PB will have to be represented in the same coordinate frame.
Hence, coordinate transformations will have to be introduced in the foregoing matrix
columns in order to have all of these represented in the same coordinate frame, say,
the first one. We then have the expansion below:
</p>
<p>PJ P� D P�1
�
</p>
<p>0
</p>
<p>Pu1
</p>
<p>�
</p>
<p>C P�2
�
</p>
<p>Pe2
Pu2
</p>
<p>�
</p>
<p>C � � � C P�n
�
</p>
<p>Pen
Pun
</p>
<p>�
</p>
<p>(5.47)
</p>
<p>The right-hand side of Eq. (5.47) is computed recursively as described below in five
steps, the number of operations required being included at the end of each step.
</p>
<p>1. Compute f Œ!i &#141;i gn1 :
Œ!1 &#141;1  P�1Œ e1 &#141;1
For i D 1 to n � 1 do
</p>
<p>Œ!iC1 &#141;iC1  P�iC1Œ eiC1 &#141;iC1 CQTi Œ!i &#141;i
</p>
<p>enddo 8.n � 1/M &amp; 5.n � 1/A
2. Compute f Œ Pei &#141;i gn1 :
</p>
<p>Œ Pe1 &#141;1  Œ 0 &#141;1
For i D 2 to n do
</p>
<p>Œ Pei &#141;i  Œ!i � ei &#141;i
</p>
<p>enddo 0M &amp; 0A
3. Compute f Œ Pri &#141;i gn1 :
</p>
<p>Œ Prn &#141;n  Œ!n � an &#141;n
For i D n � 1 to 1 do
</p>
<p>Œ Pri &#141;i  Œ!i � ai &#141;i CQi Œ PriC1 &#141;iC1
</p>
<p>enddo .14n � 8/M &amp; .10n � 7/A
4. Compute f Œ Pui &#141;i gn1 using the expression appearing in Eq. (5.44c):
</p>
<p>Œ Pu1 &#141;1  Œ e1 � Pr1 &#141;1 For i D 2 to n do
</p>
<p>Œ Pui &#141;i  Œ Pei � ri C ei � Pri &#141;i
</p>
<p>enddo 4.n � 1/M &amp; 3.n � 1/A
5. Compute PJ P�:
</p>
<p>Let v � PJ P� , which is a six-dimensional vector. A coordinate transformation of
its two three-dimensional vector components will be implemented using the 6�6
matrices Ui , which are defined as</p>
<p/>
</div>
<div class="page"><p/>
<p>5.5 Acceleration Analysis of Serial Manipulators 209
</p>
<p>Ui �
�
</p>
<p>Qi O
</p>
<p>O Qi
</p>
<p>�
</p>
<p>where O stands for the 3 � 3 zero matrix. Thus, the foregoing 6 � 6 matrices are
block-diagonal, their diagonal blocks being simply the matrices Qi introduced in
Sect. 4.2. One then has the algorithm below:
</p>
<p>Œ v &#141;n  P�n
�
</p>
<p>Pen
Pun
</p>
<p>�
</p>
<p>n
For i D n � 1 to 1 do
</p>
<p>Œ v &#141;i  P�i
�
</p>
<p>Pei
Pui
</p>
<p>�
</p>
<p>i
</p>
<p>C Ui Œ v &#141;iC1
</p>
<p>enddo
PJ P�  Œ v &#141;1 21.n � 1/C 4M &amp; 13.n � 1/A
</p>
<p>thereby completing the computation of PJ P� .
The figures given above for the floating-point operations involved were obtained
</p>
<p>based on a few facts, namely,
</p>
<p>1. It is recalled that Œ ei &#141;i D Œ 0; 0; 1 &#141;T . Moreover, if we let Œw &#141;i D Œwx ; wy ; wz &#141;T
be an arbitrary three-dimensional vector, then
</p>
<p>Œ ei � w &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>�wy
wx
</p>
<p>0
</p>
<p>3
</p>
<p>5
</p>
<p>this product thus requiring zero multiplications and zero additions.
2. Œ Pei &#141;i , computed as in Eq. (5.44b), takes on the form Œ !y ; �!x ; 0 &#141;T , where !x
</p>
<p>and !y are the Xi and Yi components of !i . Moreover, let Œ ri &#141;i D Œ x; y; z &#141;T .
Then
</p>
<p>Œ Pei � ri &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>�z!x
�z!y
</p>
<p>x!x C y!y
</p>
<p>3
</p>
<p>5
</p>
<p>and this product is computed with four multiplications and one addition.
3. As found in Sect. 5.3, any coordinate transformation from Fi to FiC1, or vice
</p>
<p>versa, of any three-dimensional vector is computed with eight multiplications
and four additions.
</p>
<p>Thus, the total numbers of multiplications and additions required to compute PJ P�
in frame F1, denoted by MJ and AJ , respectively, are as shown below:
</p>
<p>MJ D 47n � 37; AJ D 31n � 28</p>
<p/>
</div>
<div class="page"><p/>
<p>210 5 Kinetostatics of Serial Robots
</p>
<p>Since the right-hand side of Eq. (5.40) involves the algebraic sum of two
six-dimensional vectors, then, the total numbers of multiplications and additions
needed to compute the aforementioned right-hand side, denoted by Mr and Ar , are
</p>
<p>Mr D 47n � 37; Ar D 31n � 22
</p>
<p>These figures yield 245 multiplications and 164 additions for a six-revolute manip-
ulator of arbitrary architecture. Finally, if the latter figures are added to those of
Eq. (5.42), one obtains the numbers of multiplications and additions required for an
acceleration resolution of a six-revolute manipulator of arbitrary architecture as
</p>
<p>Ma D 281; Aa D 194
</p>
<p>Furthermore, for six-axis, decoupled manipulators, the operation counts of
steps 1 and 2 above do not change. However, step 3 is reduced by 42 multiplications
and 30 additions, whereas step 4 by 12 multiplications and 9 additions. Moreover,
step 5 is reduced by 63 multiplications and 39 additions. With regard to the solution
of Eq. (5.40) for R� , an additional reduction of floating-point operations, or flops, is
obtained, for now we need only 18 multiplications and 12 additions to solve two
systems of three equations with three unknowns, thereby saving 18 multiplications
and 18 additions. Thus, the corresponding figures for such a manipulator, M 0a and
A0a, respectively, are
</p>
<p>M 0a D 146; A0a D 98
</p>
<p>5.6 Static Analysis of Serial Manipulators
</p>
<p>In this section, the static analysis of a serial n-axis manipulator is undertaken,
six-axis decoupled manipulators being treated as special cases. Let �i be either
the torque acting at the i th revolute or the force acting at the i th prismatic pair.
Moreover, let � be the n-dimensional vector of joint forces and torques, whose
i th component is �i , whereas w D ŒnT ; fT &#141;T denotes the wrench exerted by the
environment on the EE, with n denoting the resultant moment and f the resultant
force applied at point P of the end-effector of the manipulator of Fig. 5.1. Then, the
power exerted on the manipulator by all forces and moments acting on the EE is
</p>
<p>&hellip;E D wT t D nT!C fT Pp
</p>
<p>whereas the power &hellip;J exerted on the manipulator by all joint motors is
</p>
<p>&hellip;J D �T P� (5.48)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.6 Static Analysis of Serial Manipulators 211
</p>
<p>Under static, conservative conditions, there is neither power dissipation nor
change in the kinetic energy of the manipulator, and hence, the two foregoing
powers are equal, which is just a restatement of the First Law of Thermodynamics
or, equivalently, a form of the Principle of Virtual Work, i.e.,
</p>
<p>wT t D �T P� (5.49a)
</p>
<p>Upon substitution of Eq. (5.9) into Eq. (5.49a), we obtain
</p>
<p>wT J P� D �T P� (5.49b)
</p>
<p>which is a relation valid for arbitrary P� . Under these conditions, if J is not singular,
Eq. (5.49b) leads to
</p>
<p>JTw D � (5.50)
</p>
<p>This equation relates the wrench acting on the EE with the joint forces and torques
exerted by the actuators. Therefore, this equation finds applications in the sensing
of the wrench w acting on the EE by means of torque sensors located at the revolute
axes. These sensors measure the motor-supplied torques via the current flowing
through the motor armatures, the sensor readouts being the joint torques&mdash;or forces,
in the case of prismatic joints&mdash;f �k gn1 , grouped in vector �.
</p>
<p>For a six-axis manipulator, in the absence of singularities, the foregoing equation
can be readily solved for w in the form
</p>
<p>w D J�T �
</p>
<p>where J�T stands for the inverse of JT . Thus, using the figures recorded in
Eq. (5.18b), w can be computed from Eq. (5.50) with 127 multiplications and 100
additions for a manipulator of arbitrary architecture. However, if the manipulator is
of the decoupled type, the Jacobian takes on the form appearing in Eq. (5.19), and
hence, the foregoing computation can be performed in two steps, namely,
</p>
<p>JT12nw D �w
JT21f D �a � JT11nw
</p>
<p>where nw is the resultant moment acting on the end-effector when f is applied at the
center of the wrist, while � has been partitioned as
</p>
<p>� �
�
</p>
<p>�a
</p>
<p>�w
</p>
<p>�
</p>
<p>with �a and �w defined as the wrist and the arm torques, respectively. These two
vectors are given, in turn, as
</p>
<p>�a D
</p>
<p>2
</p>
<p>4
</p>
<p>�1
�2
�3
</p>
<p>3
</p>
<p>5 ; �w D
</p>
<p>2
</p>
<p>4
</p>
<p>�4
�5
�6
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>212 5 Kinetostatics of Serial Robots
</p>
<p>Hence, the foregoing calculations, as pertaining to a six-axis, decoupled manipula-
tor, are performed with 55 multiplications and 37 additions, which follows from a
result that was derived in Sect. 5.2 and is summarized in Eq. (5.23).
</p>
<p>In solving for the wrench acting on the EE from the above relations, the wrist
equilibrium equation is first solved for nw, thus obtaining
</p>
<p>nw D J�T12 �w (5.51)
</p>
<p>where J�T12 stands for the inverse of J
T
12, and is available in Eq. (5.29). Therefore,
</p>
<p>nw D
1
</p>
<p>&#129;12
</p>
<p>�
</p>
<p>.e5 � e6/ .e6 � e4/ .e4 � e5/
�
</p>
<p>�w
</p>
<p>D 1
&#129;12
</p>
<p>Œ �4.e5 � e6/C �5.e6 � e4/C �6.e4 � e5/ &#141; (5.52)
</p>
<p>Now, if we let
</p>
<p>�a � �a � JT11nw (5.53)
</p>
<p>we have, from Eq. (5.28),
</p>
<p>f D
�
</p>
<p>u2 � u3 u3 � u1 u1 � u2
� �a
</p>
<p>&#129;21
</p>
<p>where
</p>
<p>ui � ei � ri
</p>
<p>or
</p>
<p>f D 1
&#129;21
</p>
<p>Œ �1.u2 � u3/C �2.u3 � u1/C �3.u1 � u2/ &#141; (5.54)
</p>
<p>5.7 Planar Manipulators
</p>
<p>Shown in Fig. 5.6 is a three-axis planar manipulator. Note that in this case, the DH
parameters bi and ˛i vanish, for i D 1; 2; 3, the nonvanishing parameters ai being
indicated in the same figure. Below we proceed with the displacement, velocity,
acceleration, and static analyses of this manipulator. Here, we recall a few relations
of planar mechanics that will be found useful in the discussion below.
</p>
<p>A 2 � 2 matrix A can be partitioned either columnwise or rowwise, as shown
below:
</p>
<p>A �
�
</p>
<p>a b
�
</p>
<p>�
�
</p>
<p>cT
</p>
<p>dT
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>5.7 Planar Manipulators 213
</p>
<p>Fig. 5.6 Three-axis planar manipulator
</p>
<p>where a, b, c, and d are all two-dimensional column vectors. Furthermore, let E be
defined as an orthogonal matrix rotating two-dimensional vectors through an angle
of 90ı counterclockwise. Hence,
</p>
<p>E �
�
</p>
<p>0 �1
1 0
</p>
<p>�
</p>
<p>(5.55)
</p>
<p>We thus have
</p>
<p>Fact 5.7.1.
</p>
<p>E�1 D ET D �E
and hence,
</p>
<p>Fact 5.7.2.
</p>
<p>E2 D �1
</p>
<p>where 1 is the 2 � 2 identity matrix. Moreover,
Fact 5.7.3.
</p>
<p>det.A/ D �aTEb D bTEa D �cTEd D dTEc
and</p>
<p/>
</div>
<div class="page"><p/>
<p>214 5 Kinetostatics of Serial Robots
</p>
<p>Fact 5.7.4.
</p>
<p>A�1 D 1
det.A/
</p>
<p>�
</p>
<p>bT
</p>
<p>�aT
�
</p>
<p>E D 1
det.A/
</p>
<p>E
�
</p>
<p>�d c
�
</p>
<p>5.7.1 Displacement Analysis
</p>
<p>The inverse displacement analysis of the manipulator at hand now consists in
determining the values of angles �i , for i D 1; 2; 3, that will place the end-
effector so that its operation point P will be positioned at the prescribed Cartesian
coordinates x, y and be oriented at a given angle � with the X axis of Fig. 5.6.
Note that this manipulator can be considered as decoupled, for the end-effector can
be placed at the desired pose by first positioning point O3 with the aid of the first
two joints and then orienting it with the third joint only. We then solve for the joint
angles in two steps, one for positioning and one for orienting.
</p>
<p>We now have, from the geometry of Fig. 5.6,
</p>
<p>a1c1 C a2c12 D x
a1s1 C a2s12 D y
</p>
<p>where x and y denote the Cartesian coordinates of point O3, while c12 and s12
stand for cos.�1 C �2/ and sin.�1 C �2/, respectively. We have thus derived two
equations for the two unknown angles, from which we can determine these angles
in various ways. For example, we can solve the problem using a semigraphical
approach similar to that of Sect. 9.4.
</p>
<p>Indeed, from the two foregoing equations we can eliminate both c12 and s12 by
solving for the second terms of the left-hand sides of those equations, namely,
</p>
<p>a2c12 D x � a1c1 (5.56a)
a2s12 D y � a1s1 (5.56b)
</p>
<p>If both sides of the above two equations are now squared, then added, and the
ensuing sum is equated to a22, we obtain, after simplification, a linear equation in c1
and s1 that represents a line L in the c1-s1 plane:
</p>
<p>LW �a21 C a22 C 2a1xc1 C 2a1ys1 � .x2 C y2/ D 0 (5.57)
</p>
<p>Apparently, the two foregoing variables are constrained by a quadratic equation
defining a circle C in the same plane:
</p>
<p>CW c21 C s21 D 1</p>
<p/>
</div>
<div class="page"><p/>
<p>5.7 Planar Manipulators 215
</p>
<p>Fig. 5.7 The two real solutions of a planar manipulator
</p>
<p>Fig. 5.8 The two real values
of �1 giving the two postures
depicted in Fig. 5.7
</p>
<p>which has a unit radius and is centered at the origin of the c1-s1 plane. The real
roots of interest are then obtained as the intersections of L and C. Thus, the problem
can admit (a) two real and distinct roots, if the line and the circle intersect; (b) one
repeated root if the line is tangent to the circle; and (c) no real root if the line does
not intersect the circle (Fig. 5.7).
</p>
<p>With c1 and s1 known, angle �1 is fully determined. Note that the two real
intersections of L with C provide each one value of �1, as depicted in Fig. 5.8.
</p>
<p>Once �1 and �2 are available, �3 is readily derived from the geometry of Fig. 5.6,
namely,
</p>
<p>�3 D � � .�1 C �2/
</p>
<p>and hence, each pair of .�1; �2/ values yields one single value for �3. Since we have
two such pairs, the problem admits two real solutions.</p>
<p/>
</div>
<div class="page"><p/>
<p>216 5 Kinetostatics of Serial Robots
</p>
<p>5.7.2 Velocity Analysis
</p>
<p>Velocity analysis is most easily accomplished if the general velocity relations
derived in Sect. 5.2 are recalled and adapted to planar manipulators. Thus we have,
as in Eq. (5.9),
</p>
<p>J P� D t (5.58a)
</p>
<p>where now,
</p>
<p>J �
�
</p>
<p>e1 e2 e3
</p>
<p>e1 � r1 e2 � r2 e3 � r3
</p>
<p>�
</p>
<p>; P� �
</p>
<p>2
</p>
<p>4
</p>
<p>P�1
P�2
P�3
</p>
<p>3
</p>
<p>5 ; t �
�
</p>
<p>!
</p>
<p>Pp
</p>
<p>�
</p>
<p>(5.58b)
</p>
<p>and f ri g31 are defined as in Eq. (5.6), i.e., as the vectors directed from Oi to P . As
in the previous subsection, we assume here that the manipulator moves in the X&ndash;Y
plane, and hence, all revolute axes are parallel to the Z axis, vectors ei and ri , for
i D 1; 2; 3, thus taking on the forms
</p>
<p>e1 D e2 D e3 D e �
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; ri D
</p>
<p>2
</p>
<p>4
</p>
<p>xi
yi
0
</p>
<p>3
</p>
<p>5
</p>
<p>with t reducing to
</p>
<p>t D
�
</p>
<p>0 0 P� PxP PyP 0
�T
</p>
<p>(5.58c)
</p>
<p>in which PxP and PyP denote the components of the velocity of P . Thus,
</p>
<p>ei � ri D
</p>
<p>2
</p>
<p>4
</p>
<p>�yi
xi
0
</p>
<p>3
</p>
<p>5
</p>
<p>and hence, the foregoing cross product can be expressed as
</p>
<p>ei � ri D
�
</p>
<p>Esi
</p>
<p>0
</p>
<p>�
</p>
<p>where E was defined in Eq. (5.55) and si is the two-dimensional projection of ri
onto the X&ndash;Y plane of motion, i.e., si �
</p>
<p>�
</p>
<p>xi yi
�T
</p>
<p>. Equation (5.58a) thus reduces to
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>0 0 0
</p>
<p>1 1 1
</p>
<p>Es1 Es2 Es3
</p>
<p>0 0 0
</p>
<p>3
</p>
<p>7
7
5
P� D
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>0
P�
Pp
0
</p>
<p>3
</p>
<p>7
7
5
</p>
<p>(5.59)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.7 Planar Manipulators 217
</p>
<p>where 0 is the two-dimensional zero vector and Pp is now reduced to Pp � Œ Px; Py &#141;T .
In summary, then, by working only with the three nontrivial equations of Eq. (5.59),
we can represent the velocity relation using a 3 � 3 Jacobian in Eq. (5.58a). To this
end, we redefine J and t as
</p>
<p>J �
�
</p>
<p>1 1 1
</p>
<p>Es1 Es2 Es3
</p>
<p>�
</p>
<p>; t �
� P�
Pp
</p>
<p>�
</p>
<p>(5.60)
</p>
<p>The velocity resolution of this manipulator thus reduces to solving for the three joint
rates from Eq. (5.58a), with J and t defined as in Eq. (5.60), which thus leads to the
system below:
</p>
<p>�
</p>
<p>1 1 1
</p>
<p>Es1 Es2 Es3
</p>
<p>�
2
</p>
<p>4
</p>
<p>P�1
P�2
P�3
</p>
<p>3
</p>
<p>5 D
� P�
Pp
</p>
<p>�
</p>
<p>(5.61)
</p>
<p>Solving for f P�i g31 is readily done by first reducing the system of equations
appearing in Eq. (5.58a) to one of two equations in two unknowns by resorting to
Gaussian elimination. Indeed, if the first scalar equation of Eq. (5.61) is multiplied
by Es1 and the product is subtracted from the two-dimensional vector equation, we
obtain
</p>
<p>�
</p>
<p>1 1 1
</p>
<p>0 E.s2 � s1/ E.s3 � s1/
</p>
<p>�
2
</p>
<p>4
</p>
<p>P�1
P�2
P�3
</p>
<p>3
</p>
<p>5 D
� P�
Pp � P�Es1
</p>
<p>�
</p>
<p>(5.62)
</p>
<p>from which a reduced system of two equations in two unknowns is readily obtained,
namely,
</p>
<p>�
</p>
<p>E.s2 � s1/ E.s3 � s1/
�
� P�2
P�3
</p>
<p>�
</p>
<p>D Pp � P�Es1 (5.63)
</p>
<p>The system of equations (5.63) can be readily solved if Fact 5.7.4 is recalled,
namely,
</p>
<p>� P�2
P�3
</p>
<p>�
</p>
<p>D 1
&#129;
</p>
<p>�
</p>
<p>�.s3 � s1/TE
.s2 � s1/TE
</p>
<p>�
</p>
<p>E. Pp � P�Es1/
</p>
<p>D 1
&#129;
</p>
<p>�
</p>
<p>.s3 � s1/T . Pp � P�Es1/
�.s2 � s1/T . Pp � P�Es1/
</p>
<p>�
</p>
<p>where &#129; is the determinant of the 2 � 2 matrix coefficient of Eq. (5.63), i.e.,
</p>
<p>&#129; � det.
�
</p>
<p>E.s2 � s1/ E.s3 � s1/
�
</p>
<p>/ � �.s2 � s1/TE.s3 � s1/ (5.64)</p>
<p/>
</div>
<div class="page"><p/>
<p>218 5 Kinetostatics of Serial Robots
</p>
<p>We thus have
</p>
<p>P�2 D �
.s3 � s1/T . Pp � P�Es1/
.s2 � s1/TE.s3 � s1/
</p>
<p>(5.65a)
</p>
<p>P�3 D
.s2 � s1/T . Pp � P�Es1/
.s2 � s1/TE.s3 � s1/
</p>
<p>(5.65b)
</p>
<p>Further, P�1 is computed from the first scalar equation of Eq. (5.61), i.e.,
</p>
<p>P�1 D P� � . P�2 C P�3/ (5.65c)
</p>
<p>thereby completing the velocity analysis.
The foregoing calculations are summarized below in algorithmic form, with the
</p>
<p>corresponding numbers of multiplications and additions indicated at each stage.
In those numbers, we have taken into account that a multiplication of E by any two-
dimensional vector incurs no computational cost, but rather a simple rearrangement
of the entries of this vector, with a reversal of one sign.
</p>
<p>1. d21  s2 � s1 0M C 2A
2. d31  s3 � s1 0M C 2A
3. &#129; dT31Ed21 2M C 1A
4. u Pp � P�Es1 2M C 2A
5. u u=&#129; 2M C 0A
6. P�2  uT d31 2M C 1A
7. P�3  �uT d21 2M C 1A
8. P�1  P� � P�2 � P�3 0M C 2A
</p>
<p>The complete calculation of joint rates thus consumes only 10M and 11A,
which represents a savings of about 67% of the computations involved if Gaussian
elimination is applied without regarding the algebraic structure of the Jacobian J and
its kinematic and geometric significance. In fact, the solution of an arbitrary system
of three equations in three unknowns requires, from Eq. (5.18a), 28 additions and
23 multiplications. If the cost of calculating the right-hand side is added, namely,
4A and 6M , a total of 32A and 29M is required to solve for the joint rates if
straightforward Gaussian elimination is used.
</p>
<p>5.7.3 Acceleration Analysis
</p>
<p>The calculation of the joint accelerations needed to produce a given twist rate of
the EE is readily accomplished by differentiating both sides of Eq. (5.58a), with
definitions (5.60), i.e.,
</p>
<p>J R� C PJ P� D Pt</p>
<p/>
</div>
<div class="page"><p/>
<p>5.7 Planar Manipulators 219
</p>
<p>from which we readily derive a system of equations similar to Eq. (5.58a) with R� as
unknown, namely,
</p>
<p>J R� D Pt � PJ P�
</p>
<p>where
</p>
<p>PJ D
�
</p>
<p>0 0 0
</p>
<p>EPs1 EPs2 EPs3
</p>
<p>�
</p>
<p>; R� �
</p>
<p>2
</p>
<p>4
</p>
<p>R�1
R�2
R�3
</p>
<p>3
</p>
<p>5 ; Pt �
� R�
Rp
</p>
<p>�
</p>
<p>and
</p>
<p>Ps3 D . P�1 C P�2 C P�3/Ea3
Ps2 D Pa2 C Ps3 D . P�1 C P�2/Ea2 C Ps3
Ps1 D Pa1 C Ps2 D P�1Ea1 C Ps2
</p>
<p>Now we can proceed by Gaussian elimination to solve for the joint accelerations
in exactly the same manner as in Sect. 5.7.2, thereby obtaining the counterpart of
Eq. (5.63), namely,
</p>
<p>�
</p>
<p>E.s2 � s1/ E.s3 � s1/
�
� R�2
R�3
</p>
<p>�
</p>
<p>D w (5.66a)
</p>
<p>with w defined as
</p>
<p>w � Rp � E. P�1Ps1 C P�2Ps2 C P�3Ps3 C R�s1/ (5.66b)
</p>
<p>and hence, similar to Eqs. (5.65a&ndash;c), one has
</p>
<p>R�2 D
.s3 � s1/Tw
</p>
<p>&#129;
(5.67a)
</p>
<p>R�3 D �
.s2 � s1/Tw
</p>
<p>&#129;
(5.67b)
</p>
<p>R�1 D R� � . P�2 C P�3/ (5.67c)
</p>
<p>Below we summarize the foregoing calculations in algorithmic form, indicating
the numbers of operations required at each stage.
</p>
<p>1. Ps3  . P�1 C P�2 C P�3/Ea3 2M &amp; 2A
2. Ps2  . P�1 C P�2/Ea2 C Ps3 2M &amp; 3A
3. Ps1  P�1Ea1 C Ps2 2M &amp; 2A
4. w Rp � E. P�1Ps1 C P�2Ps2 C P�3Ps3 C R�s1/ 8M &amp; 8A
5. w w=&#129; 2M C 0A
6. R�2  wT d31 2M C 1A
7. R�3  �wT d21 2M C 1A
8. R�1  R� � . R�2 C R�3/ 0M C 2A</p>
<p/>
</div>
<div class="page"><p/>
<p>220 5 Kinetostatics of Serial Robots
</p>
<p>where d21, d31, and &#129; are available from velocity calculations. The joint accel-
erations thus require a total of 20 multiplications and 19 additions. These figures
represent substantial savings when compared with the numbers of operations
required if plain Gaussian elimination were used, namely, 33 multiplications and
35 additions.
</p>
<p>It is noteworthy that in the foregoing algorithm, we have replaced neither the sum
P�1C P�2C P�3 nor P�1E.s1C s2C s3/ by ! and correspondingly, by Pp, because in path
tracking, there is no perfect match between joint and Cartesian variables. In fact,
joint-rate and joint-acceleration calculations are needed in feedback control schemes
to estimate the position, velocity, and acceleration errors by proper corrective
actions.
</p>
<p>5.7.4 Static Analysis
</p>
<p>Here we assume that the environment exerts a planar wrench on the EE of the
manipulator appearing in Fig. 5.6. In accordance with the definition of the planar
twist in Sect. 5.7.2, Eq. (5.60), the planar wrench is now defined as
</p>
<p>w �
�
</p>
<p>n
</p>
<p>f
</p>
<p>�
</p>
<p>(5.68)
</p>
<p>where n is the scalar couple acting on the EE and f is the two-dimensional force
acting at the operation point P of the EE. If additionally, we denote by � the three-
dimensional vector of joint torques, the planar counterpart of Eq. (5.50) follows, i.e.,
</p>
<p>JTw D � (5.69)
</p>
<p>where
</p>
<p>JT D
</p>
<p>2
</p>
<p>4
</p>
<p>1 .Es1/
T
</p>
<p>1 .Es2/
T
</p>
<p>1 .Es3/
T
</p>
<p>3
</p>
<p>5
</p>
<p>Now, in order to solve for the wrench w acting on the end-effector, given the
joint torques � and the posture of the manipulator, we can still apply our compact
Gaussian-elimination scheme, as introduced in Sect. 5.7.2. To this end, we subtract
the first scalar equation from the second and the third scalar equations of Eq. (5.69),
which renders the foregoing system in the form
</p>
<p>2
</p>
<p>4
</p>
<p>1 .Es1/
T
</p>
<p>0 ŒE.s2 � s1/&#141;T
0 ŒE.s3 � s1/&#141;T
</p>
<p>3
</p>
<p>5
</p>
<p>�
</p>
<p>n
</p>
<p>f
</p>
<p>�
</p>
<p>D
</p>
<p>2
</p>
<p>4
</p>
<p>�1
�2 � �1
�3 � �1
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 221
</p>
<p>Thus, the last two equations have been decoupled from the first one, which allows
us to solve them separately, i.e., we have reduced the system to one of two equations
in two unknowns, namely,
</p>
<p>�
</p>
<p>ŒE.s2 � s1/&#141;T
ŒE.s3 � s1/&#141;T
</p>
<p>�
</p>
<p>f D
�
</p>
<p>�2 � �1
�3 � �1
</p>
<p>�
</p>
<p>(5.70)
</p>
<p>from which we readily obtain
</p>
<p>f D
�
</p>
<p>ŒE.s2 � s1/&#141;T
ŒE.s3 � s1/&#141;T
</p>
<p>��1 �
�2 � �1
�3 � �1
</p>
<p>�
</p>
<p>(5.71)
</p>
<p>and hence, upon expansion of the above inverse,
</p>
<p>f D 1
&#129;
Œ.�2 � �1/.s3 � s1/ � .�3 � �1/.s2 � s1/&#141; (5.72)
</p>
<p>where &#129; is exactly as defined in Eq. (5.64). Finally, the resultant moment n acting
on the end-effector is readily calculated from the first scalar equation of Eq. (5.69),
namely, as
</p>
<p>n D �1 C sT1 Ef
</p>
<p>thereby completing the static analysis of the manipulator under study. A quick
analysis of computational costs shows that the foregoing solution needs 8M and
6A, or a savings of about 70% if straightforward Gaussian elimination is applied.
</p>
<p>5.8 Kinetostatic Performance Indices
</p>
<p>Chapters 6 and 7 do not depend on this section, which can thus be skipped in an
introductory course based on the first half of the book. We have included this section
because (a) it is a simple matter to render the section self-contained, while introduc-
ing the concept of condition number and its relevance in robotics; (b) kinetostatic
performance can be studied with the background of the material included up to
this section; and (c) kinetostatic performance is becoming increasingly relevant as a
design criterion and as a figure of merit in robot control.
</p>
<p>A kinetostatic performance index of a robotic mechanical system is a scalar
quantity that measures how well the system behaves with regard to force and motion
transmission, the latter being understood in the differential sense, i.e., at the velocity
level. Now, a kinetostatic performance index, or kinetostatic index for brevity, may
be needed to assess the performance of a robot at the design stage, in which case
we need a posture-independent index. In this case, the index becomes a function of
the robot architecture only. If, on the other hand, we want to assess the performance</p>
<p/>
</div>
<div class="page"><p/>
<p>222 5 Kinetostatics of Serial Robots
</p>
<p>of a given robot while performing a task, what we need is a posture-dependent
index. This difference is often overlooked in the robotics literature, although it is
extremely important. Moreover, while performance indices can be defined for all
kinds of robotic mechanical systems, we focus here on those associated with serial
manipulators, which are the ones studied most intensively.
</p>
<p>Among the various performance indices that have been proposed, one can cite
the concept of service angle, first introduced by Vinogradov et al. (1971), and
the conditioning of robotic manipulators, as proposed by Yang and Lai (1985).
Yoshikawa (1985), in turn, introduced the concept of manipulability, which is
defined as the square root of the determinant of the product of the manipulator
Jacobian by its transpose. Paul and Stevenson (1983) used the absolute value of
the determinant of the Jacobian to assess the kinematic performance of spherical
wrists. Note that Yoshikawa&rsquo;s manipulability is identical to the absolute value of
the determinant of the Jacobian, and hence, the latter coincides with Paul and
Stevenson&rsquo;s performance index. It should be pointed out that these indices were
defined for control purposes and hence, are posture-dependent. Germane to these
concepts is that of dextrous workspace, introduced by Kumar and Waldron (1981),
and used for geometric optimization by Vijaykumar et al. (1986). Although the
concepts of service angle and manipulability are apparently different, they touch
upon a common underlying issue, namely, the kinematic, or alternatively, the static
performance of a manipulator from an accuracy viewpoint. For this reason, we refer
to these indices generically as kinetostatic.
</p>
<p>What is at stake when discussing the manipulability of a robotic manipulator is a
measure of the invertibility of the associated Jacobian matrix, since this is required
for velocity and force-feedback control. One further performance index is based on
the condition number of the Jacobian, which was first used by Salisbury and Craig
(1982) to design mechanical fingers. Here, we shall use this concept to define the
kinetostatic conditioning index of the manipulator. For the sake of brevity, we devote
the discussion below to only two indices, namely, manipulability and conditioning.
Prior to discussing these indices, we recall a few facts from linear algebra.
</p>
<p>Although the concepts discussed here are equally applicable to square and
rectangular matrices, we shall focus on the former. First, we give a geometric
interpretation of the mapping induced by a n� n matrix A. Here, we do not assume
any particular structure of A, which can thus be totally arbitrary. However, by
invoking the polar-decomposition theorem (Strang 1988), we can factor A as
</p>
<p>A � RU � VR (5.73)
</p>
<p>where R is orthogonal, although not necessarily proper, while U and V are both at
least positive-semidefinite. Moreover, if A is nonsingular, then U and V are both
positive-definite, and R is unique. Apparently,
</p>
<p>ATA D U2 or AAT D V2 (5.74)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 223
</p>
<p>and hence, U .V/ can be readily determined as the positive-semidefinite or
correspondingly, positive-definite square root of the product ATA .AAT /, which
is necessarily positive-semidefinite at least; it is, in fact, positive-definite if A is
nonsingular. We recall here that the square root of arbitrary matrices was briefly
discussed in Sect. 2.3.6. The square root of a positive-semidefinite matrix can
be most easily understood if that matrix is assumed to be in diagonal form,
which is possible because such a matrix is necessarily symmetric, and every
symmetric matrix is diagonalizable. The matrix at hand being positive-semidefinite,
its eigenvalues are nonnegative, and hence, their square roots are all real. The
positive-semidefinite square root of interest is, then, readily obtained as the diagonal
matrix whose nontrivial entries are the nonnegative square roots of the above-
mentioned eigenvalues. With U or V determined, R can be found uniquely only if A
is nonsingular, in which case U and V are positive-definite. If this is the case, then
we have
</p>
<p>R D AU�1 D V�1A (5.75a)
</p>
<p>It is a simple matter to show that U and V are related by a similarity transformation,
namely,
</p>
<p>V D RURT (5.75b)
</p>
<p>Now, as a consequence of the above relation between U and V, both matrices share
the same set of nonnegative eigenvalues f�ign1 , which are termed the singular values
of the given matrix A. Furthermore, if the eigenvectors of U are denoted by fuign1
and those of V by fvign1 , then the two sets are related by a similarity transformation
as well:
</p>
<p>vi D Rui ; i D 1; : : : ; n (5.76)
</p>
<p>Now, let vector x be mapped by A into z, i.e.,
</p>
<p>z D Ax � RUx (5.77a)
</p>
<p>Moreover, let
</p>
<p>y � Ux (5.77b)
</p>
<p>and hence, we have a concatenation of mappings: U maps x into y, while R maps
y into z. Thus, by virtue of the nature of matrices R and U, the latter maps the unit
n-dimensional ball into a n-axis ellipsoid whose semiaxis lengths bear the ratios
of the eigenvalues of U. Moreover, R maps this ellipsoid into another one with
identical semiaxes, except that it is rotated about its center or reflected, depending
upon whether R is proper or improper orthogonal. The eigenvalues of U or, for that
matter, those of V, are thus nothing but the singular values of A. Yoshikawa (1985)</p>
<p/>
</div>
<div class="page"><p/>
<p>224 5 Kinetostatics of Serial Robots
</p>
<p>Fig. 5.9 Geometric representation of mapping induced by matrix A
</p>
<p>explained the foregoing relations resorting to the singular-value decomposition
theorem. We prefer to invoke the polar-decomposition theorem instead, because of
the geometric nature of the latter, as opposed to the former, which is of an algebraic
nature&mdash;it is based on a diagonalization of either U or V, which is really not needed.
</p>
<p>We illustrate the two mappings U and R in Fig. 5.9, where we orient the X ,
Y , and Z axes along the three eigenvectors of U. Therefore, the semiaxes of the
ellipsoid are oriented as the eigenvectors of U as well. If A is singular, then the
ellipsoid degenerates into one with at least one vanishing semiaxis. On the other
hand, if matrix A is isotropic, i.e., if all its singular values are identical, then it maps
the unit ball into another ball, either enlarged or shrunken.
</p>
<p>For our purposes, we can regard the Jacobian of a serial manipulator as mapping
the unit ball in the space of joint rates into a rotated or reflected ellipsoid in the space
of Cartesian velocities, or twists. Now, let us assume that the polar decomposition of
J is given by R and U, the manipulability � of the robot under study thus becoming
</p>
<p>� � jdet.J/j � jdet.R/jjdet.U/j (5.78a)
</p>
<p>Since R is orthogonal, the absolute value of its determinant is unity. Additionally,
the determinant of U is nonnegative, and hence,
</p>
<p>� D det.U/ (5.78b)
</p>
<p>which shows that the manipulability is the product of the eigenvalues of U or
equivalently, of the singular values of J. Now, the product of those singular values,
in the geometric interpretation of the mapping induced by J, is proportional to the
volume of the ellipsoid at hand, and hence, � can be interpreted as a measure of the
volume of that ellipsoid. It is apparent that the manipulability defined in Eq. (5.78b)
is posture-dependent. For example, if J is singular, at least one of the semiaxes of the
ellipsoid vanishes, and so does its volume. Manipulators at singular configurations
thus have a manipulability of zero.</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 225
</p>
<p>Now, if we want to use the concept of manipulability to define a posture-
independent kinetostatic index, we have to define this index in a global sense. This
can be done in the same way as the magnitude of a vector is defined, namely, as
the sum of the squares of its components. In this way, the global manipulability
can be defined as the integral of a certain power of the manipulability over the
whole workspace of the manipulator, which would amount to defining the index
as a norm of the manipulability in a space of functions.5 For example, we can use
the maximum manipulability attained over the whole workspace, thereby ending up
with what would be like a Chebyshev norm6; alternatively, we can use the root-mean
square (rms) value of the manipulability, thereby ending up with a measure similar
to the Euclidean norm.
</p>
<p>The condition number of a square matrix is a measure of the relative roundoff-
error amplification of the computed results upon solving a linear system of equations
associated with that matrix, with respect to the relative roundoff error of the data
(Dahlquist and Bj&ouml;rck 1974; Golub and Van Loan 1989). Based on the condition
number of the Jacobian, a posture-independent kinetostatic conditioning index of
robotic manipulators can be defined as a global measure of the condition number.
</p>
<p>The definition of the condition number (Golub and Van Loan 1989) requires that
all the entries of the matrix at hand bear the same physical units, which we assume
first, in order to introduce the concept. The more frequent case of disparate units
will be treated in the sequel. The condition number of a dimensionally homogeneous
Jacobian J is defined as
</p>
<p>�.J/ D kJkkJ�1k (5.79)
</p>
<p>where k � k stands for a matrix norm (Golub and Van Loan 1989). While any norm
can be used in the above definition, the one that is most convenient for our purposes
is the Frobenius norm k � kF , defined as7
</p>
<p>kJkF D
r
</p>
<p>1
</p>
<p>n
tr.JJT / D
</p>
<p>r
</p>
<p>1
</p>
<p>n
tr.V2/ (5.80a)
</p>
<p>where we have assumed that J is of n� n. Moreover, from the polar-decomposition
theorem and Theorem 2.6.4, one can readily verify that
</p>
<p>5Lack of familiarity with the mathematics of functions regarded as elements of vector spaces, what
is called functional analysis, should not discourage the reader from continuing, for the balance of
the book does not depend on these concepts.
6A norm is a generalization of the absolute value of real numbers, but applicable to arrays. In the
same way that a vector norm is a measure of the &ldquo;size&rdquo; of the vector components, a matrix norm
is a measure of the &ldquo;size&rdquo; of the matrix entries. In this vein, the Chebyshev norm of a given vector
(matrix) is the largest absolute value of its components (entries).
7Actually, the definition of Eq. (5.80a) yields what is known as the weighted Frobenius norm,
which gives a unit norm for the n� n identity matrix, regardless of the value of n.</p>
<p/>
</div>
<div class="page"><p/>
<p>226 5 Kinetostatics of Serial Robots
</p>
<p>kJkF D
r
</p>
<p>1
</p>
<p>n
tr.JT J/ D
</p>
<p>r
</p>
<p>1
</p>
<p>n
tr.U2/ (5.80b)
</p>
<p>Now, since the trace of a matrix is nothing but the sum of the matrix eigenvalues,
it is apparent that the Frobenius norm is identical with the rms value of the set of
singular values of the given matrix. Likewise,
</p>
<p>kJ�1kF D
r
</p>
<p>1
</p>
<p>n
tr.J�1J�T / D
</p>
<p>r
</p>
<p>1
</p>
<p>n
trŒ.JT J/�1&#141; D
</p>
<p>r
</p>
<p>1
</p>
<p>n
trŒ.JJT /�1&#141; (5.81)
</p>
<p>and hence, computing the Frobenius norm of J�1 requires the inversion not of
J itself, but rather that of JT J, or of JJT for that matter. Furthermore, while J
is not frame-invariant under a change of Cartesian-coordinate frame, JJT is. As
a consequence, the latter lends itself better to a symbolic inversion than J itself.
Hence, the Frobenius condition number �F is derived as
</p>
<p>�F D
1
</p>
<p>n
</p>
<p>p
</p>
<p>tr.U2/tr.U�2/ D 1
n
</p>
<p>p
</p>
<p>tr.V2/tr.V�2/ (5.82)
</p>
<p>Furthermore, if the matrix 2-norm is used in definition (5.79), then
</p>
<p>kJk2 D max
i
f�ig � �M ; kJ�1k2 � max
</p>
<p>i
</p>
<p>�
1
</p>
<p>�i
</p>
<p>�
</p>
<p>D 1
�m
</p>
<p>(5.83a)
</p>
<p>where
</p>
<p>�m � min
i
f�ig (5.83b)
</p>
<p>It is noteworthy that both the Frobenius norm and the 2-norm are given in terms of
the matrix singular values. As a consequence, these two norms are frame-invariant.
The 2-norm condition number �2.J/ is thus given by
</p>
<p>�2.J/ �
�M
</p>
<p>�m
(5.84)
</p>
<p>Now we can state a fundamental result:
</p>
<p>Theorem 5.8.1. The condition number based on either the 2-norm or the Frobenius
</p>
<p>norm of the robot Jacobian is invariant to changes of frame. In this light, the
</p>
<p>said condition numbers are immutable under a change of b1, which amounts to
</p>
<p>a translation of frame F1, or of �1, which amounts to looking at the robot from
</p>
<p>a frame rotated by this angle about Z1. Moreover, angle ˛n not depending on the
</p>
<p>robot architecture, but on the location of the task frame, neither influences the same
</p>
<p>condition numbers.</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 227
</p>
<p>Note that, regardless of the norm adopted, the condition number can attain values
from unity to infinity. Apparently, the condition number attains its minimum value
of unity for matrices with identical singular values; such matrices map the unit
ball into another ball, although of a different size, and are, thus, called isotropic.
By extension, isotropic manipulators are those whose Jacobian matrix can attain
isotropic values. On the other side of the spectrum, singular matrices have a smallest
singular value that vanishes, and hence, their condition number is infinite. The
condition number of J can be thought of as indicating the distortion of the unit ball
in the space of joint-variables. The larger this distortion, the greater the condition
number, the worst-conditioned Jacobians being those that are singular. For these,
one of the semiaxes of the ellipsoid vanishes and the ellipsoid degenerates into what
would amount to an elliptical disk in the three-dimensional space.
</p>
<p>Now, if the entries of J have different units, its condition number is undefined,
for we would face a problem of either adding or ordering from largest to smallest
singular values of different units. Staffetti et al. (2002) called kinetostatic per-
formance indices of manipulators with such a Jacobian matrix &ldquo;non-invariant&rdquo; to
changes of norms. The same authors went on to claim that, because of this feature,
such performance indices&mdash;Staffetti et al. refer to these indices as &ldquo;manipulability
indices&rdquo;&mdash;-are not natural. We will leave aside the discussion of whether the indices
at stake are invariant or not, to focus instead on means to cope with the problem
at hand. We resolve the inconsistency of physical units by defining a characteristic
length, by which we divide the Jacobian entries that have units of length, thereby
producing a new Jacobian that is dimensionally homogeneous. We shall therefore
divide our study into (a) manipulators for only positioning tasks, (b) manipulators
for only orientation tasks, and (c) manipulators for both positioning and orientation
tasks. The characteristic length will be introduced when studying the third category.
</p>
<p>In the sequel, we will need an important property of isotropic matrices that is
recalled below. First note that if A is isotropic, all its singular values are identical,
say equal to � , and hence, matrices U and V are proportional to the n � n identity
matrix, i.e.,
</p>
<p>U D V D �1 (5.85)
</p>
<p>In this case, then,
</p>
<p>A D �R (5.86a)
</p>
<p>which means that isotropic square matrices are proportional to orthogonal matrices.
As a consequence, then,
</p>
<p>ATA D AAT D �21 (5.86b)
</p>
<p>Given an arbitrary manipulator of the serial type with a Jacobian matrix whose
entries all have the same units, we can calculate its condition number and use
a global measure of this to define a posture-independent kinetostatic index. Let</p>
<p/>
</div>
<div class="page"><p/>
<p>228 5 Kinetostatics of Serial Robots
</p>
<p>�m be the minimum value attained by the condition number of the dimensionally
homogeneous Jacobian over the whole workspace, regardless of the norm adopted.
Note that 1=�m can be regarded as a Chebyshev norm8 of the reciprocal of the condi-
tion number, because now 1=�m represents the maximum value of this reciprocal in
the whole workspace. We then introduce a posture-independent performance index,
the kinetostatic conditioning index, or KCI for brevity, defined as
</p>
<p>KCI D 1
�m
� 100% (5.87)
</p>
<p>Notice that since the condition number is bounded from below, the KCI is
bounded from above by a value of 100%. Manipulators with a KCI of 100% are
those identified above as isotropic.
</p>
<p>5.8.1 Positioning Manipulators
</p>
<p>Here, again, we shall distinguish between planar and spatial manipulators. These
are studied separately.
</p>
<p>Planar Manipulators
</p>
<p>If the manipulator of Fig. 5.6 is limited to positioning tasks, we can dispense with its
third axis, the manipulator thus reducing to the one shown in Fig. 5.7; its Jacobian
reduces correspondingly to
</p>
<p>J D
�
</p>
<p>Es1 Es2
�
</p>
<p>with si denoting the two-dimensional versions of vectors ri of the Denavit&ndash;
Hartenberg notation, as introduced in Fig. 5.1. Now, if we want to design this
manipulator for maximum manipulability, we resort to Eq. (5.78a), whence � D
jdet.J/j. First, notice that
</p>
<p>det.J/ D det.E
�
</p>
<p>s1 s2
�
</p>
<p>/ D det.E/det.
�
</p>
<p>s1 s2
�
</p>
<p>/
</p>
<p>and since matrix E is orthogonal, its determinant equals unity. Thus, the determinant
of interest is now calculated using Fact 5.7.3 of Sect. 5.7, namely,
</p>
<p>det.J/ D �sT1 Es2 (5.88)
</p>
<p>8In a space of functions.</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 229
</p>
<p>Fig. 5.10 A planar, two-axis
positioning manipulator, with
�1 D 0
</p>
<p>Therefore,
</p>
<p>� D jsT1 Es2j � ks1kks2kj sin.s1; s2/j
</p>
<p>where .s1; s2/ stands for the angle between the two vectors inside the parentheses.
Now let us denote the manipulator reach with R, i.e., R D a1 C a2, and let ak D
R�k , where �k , for k D 1; 2, is a dimensionless number. As illustrated in Fig. 5.10,
ks2k j sin.s1; s2/j D h, the height of triangle O1O2P of base O1P , and hence, �
turns out to be twice the area of the same triangle, with the notation adopted at the
outset.
</p>
<p>Moreover, in terms of the base O1O2 D a1 and the height a2j sin �2j, the area of
the triangle becomes a1a2j sin �2j=2, and hence,
</p>
<p>� D a1a2j sin �2j D R2�1�2j sin �2j (5.89a)
</p>
<p>with �1 and �2 subject to
</p>
<p>�1 C �2 D 1 (5.89b)
</p>
<p>The design task at hand, i.e., finding a1 and a2, can then be formulated as an
optimization problem aimed at maximizing � as given in Eq. (5.89a) over �1 and �2,
subject to the constraint (5.89b). This optimization problem can be readily solved
using, for example, Lagrange multipliers, thereby obtaining
</p>
<p>�1 D �2 D
1
</p>
<p>2
; �2 D ˙
</p>
<p>�
</p>
<p>2
</p>
<p>the absolute value of sin �2 attaining its maximum value when �2 D ˙90ı. The
maximum manipulability thus becomes
</p>
<p>�max D
R2
</p>
<p>4
(5.90)
</p>
<p>Incidentally, the equal-length condition maximizes the workspace volume as well.</p>
<p/>
</div>
<div class="page"><p/>
<p>230 5 Kinetostatics of Serial Robots
</p>
<p>Fig. 5.11 A two-axis isotropic manipulator
</p>
<p>On the other hand, if we want to minimize the condition number of J, we
should aim at rendering J isotropic, which means that the product JT J should be
proportional to the identity matrix, and so,
</p>
<p>�
</p>
<p>sT1 s1 s
T
1 s2
</p>
<p>sT1 s2 s
T
2 s2
</p>
<p>�
</p>
<p>D
�
</p>
<p>�2 0
</p>
<p>0 �2
</p>
<p>�
</p>
<p>where � is the repeated singular value of J. Hence, for J to be isotropic, all we need
is that the two vectors s1 and s2 have the same norm and that they lie at right angles.
The solution is a manipulator with link lengths observing a ratio of
</p>
<p>p
2=2, i.e., with
</p>
<p>a2=a1 D
p
2=2, and the two link axes at an angle of 135ı, as depicted in Fig. 5.11.
</p>
<p>Manipulators of the above type, used as mechanical fingers, were investigated by
Salisbury and Craig (1982), who found that these manipulators can be rendered
isotropic if given the foregoing dimensions and configured as shown in Fig. 5.11.
</p>
<p>Spatial Manipulators
</p>
<p>Now we have a manipulator like that depicted in Fig. 4.11, its Jacobian matrix taking
on the form
</p>
<p>J D
�
</p>
<p>e1 � r1 e2 � r2 e3 � r3
�
</p>
<p>(5.91)
</p>
<p>The condition for isotropy of this kind of manipulator takes on the form of
Eq. (5.86b), which thus leads to
</p>
<p>2
</p>
<p>4
</p>
<p>ke1 � r1k2 .e1 � r1/T .e2 � r2/ .e1 � r1/T .e3 � r3/
.e1 � r1/T .e2 � r2/ ke2 � r2k2 .e2 � r2/T .e3 � r3/
.e1 � r1/T .e3 � r3/ .e2 � r2/T .e3 � r3/ ke3 � r3k2
</p>
<p>3
</p>
<p>5 D �21 (5.92)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 231
</p>
<p>Fig. 5.12 An isotropic manipulator for three-dimensional positioning tasks
</p>
<p>Hence, the manipulator under study can be postured so as to attain isotropy if its
dimensions are chosen so that its three columns have the same Euclidean norm
and are mutually orthogonal. These conditions can be attained by various designs,
one example being the manipulator of Fig. 4.17. Another isotropic manipulator for
three-dimensional positioning tasks is displayed in Fig. 5.12.
</p>
<p>Note that the manipulator of Fig. 5.12 has an orthogonal architecture, the ratio
of its last link length to the length of the intermediate link being, as in the two-
dimensional case,
</p>
<p>p
2=2. Since the first axis does not affect singularities, neither
</p>
<p>does it affect isotropy, and hence, not only does one location of the operation point
exist that renders the manipulator isotropic, but a whole locus, namely, the circle
known as the isotropy circle, indicated in the same figure. By the same token, the
manipulator of Fig. 5.11 has an isotropy circle centered at the center of the first joint,
with a radius of .
</p>
<p>p
2=2/a1.
</p>
<p>5.8.2 Orienting Manipulators
</p>
<p>We now have a three-revolute manipulator like that depicted in Fig. 4.19, its
Jacobian taking on the simple form
</p>
<p>J D
�
</p>
<p>e1 e2 e3
�
</p>
<p>(5.93)</p>
<p/>
</div>
<div class="page"><p/>
<p>232 5 Kinetostatics of Serial Robots
</p>
<p>and hence, the first isotropy condition of eq. (5.86b) leads to
</p>
<p>JT J D
</p>
<p>2
</p>
<p>4
</p>
<p>eT1 e1 e
T
1 e2 e
</p>
<p>T
1 e3
</p>
<p>eT2 e2 e
T
2 e2 e
</p>
<p>T
2 e3
</p>
<p>eT3 e1 e
T
3 e2 e
</p>
<p>T
3 e3
</p>
<p>3
</p>
<p>5 D �21 (5.94)
</p>
<p>What the foregoing condition states is that a spherical wrist for orienting tasks
is isotropic if its three unit vectors fekg31 are so laid out that they are mutually
orthogonal, which thus yields J D 1, the 3 � 3 identity matrix. Since the three
singular values of 1 are all equal to unity, i.e., � D 1; JT J D JJT D 1 as well. This
is the case in orthogonal wrists when the two planes defined by the corresponding
pairs of neighboring axes are at right angles. In summary, then, orthogonal wrists,
which are rather frequent among industrial manipulators, are isotropic. Here we
have an example of engineering insight leading to an optimum design, for such
wrists existed long before isotropy was introduced as a manipulator design criterion.
Moreover, notice that from the results of Sect. 4.4.2, spherical manipulators with
an orthogonal architecture have a maximum workspace volume. That is, isotropic
manipulators of the spherical type have two optimality properties: they have both a
maximum workspace volume and a maximum KCI. Apparently, the manipulability
of orthogonal spherical wrists is also optimal, as the reader is invited to verify, when
the wrist is postured so that its three axes are mutually orthogonal. In this posture,
the manipulability of the wrist is unity.
</p>
<p>5.8.3 Positioning and Orienting Manipulators
</p>
<p>We saw already in Sect. 5.8.1 that the optimization of the two indices studied here&mdash;
the Jacobian condition number and manipulability&mdash;leads to different manipulators.
In fact, the two indices entail even deeper differences, as we shall see presently.
First and foremost, as we shall prove for both planar and spatial manipulators,
the manipulability � is independent of the operation point P of the end-effector,
while the condition number is not. One more fundamental difference is that while
calculating the manipulability of manipulators intended for both positioning and
orienting tasks poses no problem, the condition number cannot be calculated, at least
directly, for this kind of manipulator. Indeed, in order to determine the condition
number of the Jacobian matrix, we must either add or order from largest to smallest
its singular values. However, in the presence of positioning and orienting tasks, three
of these singular values, those associated with orientation, are dimensionless, while
those associated with positioning have units of length, thereby making impossible
such an ordering. We resolve this dimensional inhomogeneity by introducing a
normalizing characteristic length. Upon dividing the three positioning rows, i.e., the
bottom rows, of the Jacobian by this length, a nondimensional Jacobian is obtained
whose singular values are nondimensional as well. The characteristic length is</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 233
</p>
<p>then defined as the normalizing length that renders the condition number of the
Jacobian matrix a minimum. While this definition does not bear a direct geometric
interpretation, in general, we shall see that such an interpretation is possible for
isotropic manipulators. Below we shall determine the characteristic length for
isotropic manipulators; determining the same for nonisotropic manipulators requires
solving a minimization problem that calls for numerical techniques, as illustrated
with examples.
</p>
<p>Planar Manipulators
</p>
<p>In the sequel, we will need the planar counterpart of the twist-transfer formula
of Sect. 3.4.2. First, we denote by tA the three-dimensional twist of a rigid body
undergoing planar motion&mdash;introduced in Eq. (5.60)&mdash;when defined at a point A;
when defined at point B , the corresponding twist is denoted by tB , i.e.,
</p>
<p>tA �
�
</p>
<p>!
</p>
<p>Pa
</p>
<p>�
</p>
<p>; tB �
�
</p>
<p>!
Pb
</p>
<p>�
</p>
<p>(5.95)
</p>
<p>The relation between the two twists, or the planar twist-transfer formula, is given
by a linear transformation U as
</p>
<p>tB D UtA (5.96a)
</p>
<p>where U is now defined as a 3 � 3 matrix, namely,
</p>
<p>U D
�
</p>
<p>1 0T
</p>
<p>E.b � a/ 12
</p>
<p>�
</p>
<p>(5.96b)
</p>
<p>with a and b representing the position vectors of points A and B , and 12 standing
for the 2� 2 identity matrix. Moreover, U is, not surprisingly, a member of the 3� 3
unimodular group, i.e.,
</p>
<p>det.U/ D 1
</p>
<p>Because of the planar twist-transfer formula, the Jacobian defined at an operation
point B is related to that defined at an operation point A of the same end-effector
by the same linear transformation U, i.e., if we denote the two Jacobians by JA and
JB , then
</p>
<p>JB D UJA (5.97)
</p>
<p>and if we denote by �A and �B the manipulability calculated at points A and B ,
respectively, then
</p>
<p>�B D jdet.JB/j D jdet.U/jjdet.JA/j D jdet.JA/j D �A (5.98)</p>
<p/>
</div>
<div class="page"><p/>
<p>234 5 Kinetostatics of Serial Robots
</p>
<p>thereby proving that the manipulability is insensitive to a change of operation point,
or to a change of end-effector, for that matter. Note that a similar analysis for the
condition number cannot be completed at this stage because, as pointed out earlier,
the condition number of these Jacobian matrices cannot even be calculated directly.
</p>
<p>In order to resolve the foregoing dimensional inhomogeneity, we introduce
the characteristic length L, which will be defined as that rendering the Jacobian
dimensionally homogeneous and optimally conditioned, i.e., with a minimum
condition number. We thus introduce the normalized Jacobian matrix as
</p>
<p>J �
�
</p>
<p>1 1 1
1
L
</p>
<p>Es1
1
L
</p>
<p>Es2
1
L
</p>
<p>Es3
</p>
<p>�
</p>
<p>(5.99)
</p>
<p>Now, if we want to size the manipulator at hand by properly choosing its geometric
parameters so as to render it isotropic, we must observe the isotropy condition, e.g.,
the second of Eq. (5.86b), which readily leads to
</p>
<p>2
</p>
<p>4
3 1
</p>
<p>L
</p>
<p>�
P3
</p>
<p>1 s
T
k
</p>
<p>�
</p>
<p>ET
</p>
<p>1
L
</p>
<p>E
P3
</p>
<p>1 sk
1
L2
</p>
<p>E
h
P3
</p>
<p>1
</p>
<p>�
</p>
<p>sks
T
k
</p>
<p>&#13;i
</p>
<p>ET
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>�2 0 0
</p>
<p>0 �2 0
</p>
<p>0 0 �2
</p>
<p>3
</p>
<p>5 (5.100)
</p>
<p>and hence,
</p>
<p>�2 D 3 (5.101a)
 
</p>
<p>3
X
</p>
<p>1
</p>
<p>sTk
</p>
<p>!
</p>
<p>ET or
3
X
</p>
<p>1
</p>
<p>sk D 0 (5.101b)
</p>
<p>1
</p>
<p>L2
E
</p>
<p> 
3
X
</p>
<p>1
</p>
<p>.sks
T
k /
</p>
<p>!
</p>
<p>ET D �212 (5.101c)
</p>
<p>What Eq. (5.101a) states is simply that the triple singular value of the isotropic J
is
p
3; Eq. (5.101b) states, in turn, that the operation point is the centroid of the
</p>
<p>centers of all manipulator joints if its Jacobian matrix is isotropic. Now, in order to
gain insight into Eq. (5.101c), we note that since E is orthogonal and �2 D 3, this
equation can be rewritten in a simpler form, namely,
</p>
<p>1
</p>
<p>L2
</p>
<p> 
3
X
</p>
<p>1
</p>
<p>.sks
T
k /
</p>
<p>!
</p>
<p>D .3/12 (5.102)
</p>
<p>Further, if we recall the definition of the moment of inertia of a rigid body, we can
immediately realize that the moment of inertia IP of a set of particles of unit mass
located at the centers of the manipulator joints, with respect to the operation point
P , is given by
</p>
<p>IP �
3
X
</p>
<p>1
</p>
<p>�
</p>
<p>kskk212 � sksTk
&#13;
</p>
<p>(5.103)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 235
</p>
<p>from which it is apparent that the moment of inertia of the set comprises two parts,
the first being isotropic&mdash;it is a multiple of the 2 � 2 identity matrix&mdash;the second
not necessarily so. However, the second part has the form of the left-hand side of
Eq. (5.102). Hence, Eq. (5.102) states that if the manipulator under study is isotropic,
then its joint centers are located, at the isotropic configuration, at the corners of a
triangle that has circular inertial symmetry. What we mean by this is that the 2 � 2
moment of inertia of the set of particles, with entries Ixx , Ixy , and Iyy , is similar
to that of a circle, i.e., with Ixx D Iyy and Ixy D 0. An obvious candidate is
an equilateral triangle, the operation point thus coinciding with the center of the
triangle. Since the corners of an equilateral triangle are at equal distances d from
the center, and these distances are nothing but kskk, the condition below is readily
derived for isotropy:
</p>
<p>kskk2 D d 2; k D 1; 2; 3 (5.104)
</p>
<p>In order to compute the characteristic length of the manipulator under study, let us
take the trace of both sides of Eq. (5.102), thereby obtaining
</p>
<p>1
</p>
<p>L2
</p>
<p>3
X
</p>
<p>1
</p>
<p>kskk2 D 6
</p>
<p>and hence, upon substituting Eq. (5.104) into the foregoing relation, an expression
for the characteristic length, as pertaining to planar isotropic manipulators, is
readily derived:
</p>
<p>L D
p
2
</p>
<p>2
d (5.105)
</p>
<p>It is now a simple matter to show that the three link lengths of this isotropic
manipulator are a1 D a2 D
</p>
<p>p
3d and a3 D d . Such a manipulator is sketched
</p>
<p>at an isotropic posture in Fig. 5.13.
We now can give a geometric interpretation of the characteristic length for the
</p>
<p>case at hand: To this end, we look at the manipulator of Fig. 5.13 from an arbitrary
viewpoint outside of the manipulator plane, as depicted in Fig. 5.4. Let this plane be
X&ndash;Y , with origin atO1, andX -axis directed towardsO2. Next, we look at a pointO
on the normal to the X&ndash;Y plane passing through the operation point P , a distance
h from P (Fig. 5.14).
</p>
<p>Further, we define vectors fri g31 as
</p>
<p>ri D
��!
OO i ; i D 1; 2; 3
</p>
<p>Upon imposing the condition that the set frig31 be orthogonal, we find h as
</p>
<p>h D
p
2
</p>
<p>2
D L (5.106)</p>
<p/>
</div>
<div class="page"><p/>
<p>236 5 Kinetostatics of Serial Robots
</p>
<p>Fig. 5.13 The planar 3-R
isotropic manipulator
</p>
<p>Fig. 5.14 A geometric interpretation of the characteristic length of the planar 3R isotropic
manipulator
</p>
<p>Therefore, the characteristic length L renders matrix LJ isotropic. In fact, this
matrix becomes
</p>
<p>LJ D
�
</p>
<p>L L L
</p>
<p>Es1 Es2 Es3
</p>
<p>�
</p>
<p>(5.107)
</p>
<p>for fsig31 valued at the isotropic posture of Fig. 5.13. Notice that the difference
between the Jacobian matrix defined in Eq. (5.60) and matrix LJ lies only in their
first row. Obviously, the former is not dimensionally homogeneous; the latter is.</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 237
</p>
<p>Spatial Manipulators
</p>
<p>The entries of the Jacobian of a six-axis manipulator intended for both positioning
and orienting tasks are dimensionally inhomogeneous as well. Indeed, as discussed
in Sect. 5.2, the i th column of J is composed of the Pl&uuml;cker coordinates of the i th
axis of the manipulator, namely,
</p>
<p>J D
�
</p>
<p>e1 e2 e3 e4 e5 e6
</p>
<p>e1 � r1 e2 � r2 e3 � r3 e4 � r4 e5 � r5 e6 � r6
</p>
<p>�
</p>
<p>(5.108)
</p>
<p>Now it is apparent that the first three rows of J are dimensionless, whereas
the remaining three, corresponding to the moments of the axes with respect to
the operation point of the end-effector, have units of length. This dimensional
inhomogeneity is resolved in the same way as in the case of planar manipulators
for both positioning and orienting tasks, i.e., by means of a characteristic length.
This length is defined, again, as the one that minimizes the condition number of the
dimensionless Jacobian thus obtained. We then define the corresponding normalized
Jacobian as
</p>
<p>J �
�
</p>
<p>e1 e2 e3 e4 e5 e6
1
L
</p>
<p>e1 � r1 1Le2 � r2
1
L
</p>
<p>e3 � r3 1Le4 � r4
1
L
</p>
<p>e5 � r5 1Le6 � r6
</p>
<p>�
</p>
<p>(5.109)
</p>
<p>and hence, the second isotropy condition of Eq. (5.86b) leads to
</p>
<p>6
X
</p>
<p>1
</p>
<p>eke
T
k D �21 (5.110a)
</p>
<p>6
X
</p>
<p>1
</p>
<p>ek.ek � rk/T D O (5.110b)
</p>
<p>1
</p>
<p>L2
</p>
<p>6
X
</p>
<p>1
</p>
<p>.ek � rk/.ek � rk/T D �21 (5.110c)
</p>
<p>where 1 is the 3� 3 identity matrix, and O is the 3� 3 zero matrix. Now, if we take
the trace of both sides of Eq. (5.110a), we obtain
</p>
<p>�2 D 2 or � D
p
2
</p>
<p>Furthermore, we take the trace of both sides of Eq. (5.110c), which yields
</p>
<p>1
</p>
<p>L2
</p>
<p>6
X
</p>
<p>1
</p>
<p>kek � rkk2 D 3�2</p>
<p/>
</div>
<div class="page"><p/>
<p>238 5 Kinetostatics of Serial Robots
</p>
<p>But kek � rkk2 is nothing but the square of the distance dk of the kth revolute axis
to the operation point, the foregoing equation thus yielding
</p>
<p>L D
</p>
<p>v
u
u
t
1
</p>
<p>6
</p>
<p>6
X
</p>
<p>1
</p>
<p>d 2k
</p>
<p>i.e., the characteristic length of a spatial six-revolute isotropic manipulator is the
root-mean square of the distances of the revolute axes to the operation point when
</p>
<p>the robot finds itself at the posture of minimum condition number.
</p>
<p>Furthermore, Eq. (5.110a) states that if f ek g61 is regarded as the set of position
vectors of points fPk g61 on the surface of the unit sphere, then the moment-of-inertia
matrix of the set of equal masses located at these points has spherical symmetry.
What the latter means is that any direction of the three-dimensional space is a
principal axis of inertia of the foregoing set. Likewise, Eq. (5.110c) states that if
f ek � rk g61 is regarded as the set of position vectors of points fQk g in the three-
dimensional Euclidean space, then the moment-of-inertia matrix of the set of equal
masses located at these points has spherical symmetry as well.
</p>
<p>Now, in order to gain insight into Eq. (5.110b), let us take the axial vector of both
sides of that equation, thus obtaining
</p>
<p>6
X
</p>
<p>1
</p>
<p>ek � .ek � rk/ D 0 (5.111)
</p>
<p>with 0 denoting the three-dimensional zero vector. Furthermore, let us denote by Ek
the cross-product matrix of ek , the foregoing equation thus taking the form
</p>
<p>6
X
</p>
<p>1
</p>
<p>E2krk D 0
</p>
<p>However,
</p>
<p>E2k D �1C ekeTk
for every k, and hence, Eq. (5.111) leads to
</p>
<p>6
X
</p>
<p>1
</p>
<p>.1 � ekeTk /rk D 0
</p>
<p>Moreover, .1 � ekeTk /rk is nothing but the normal component of rk with respect to
ek , as defined in Sect. 2.2. Let us denote this component by r?k , thereby obtaining
an alternative expression for the foregoing equation, namely,
</p>
<p>6
X
</p>
<p>1
</p>
<p>r?k D 0 (5.112)</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 239
</p>
<p>Fig. 5.15 DIESTRO, a six-axis isotropic manipulator in two postures: (a) with the arm extended
upwards; (b) with the arm down, showing the orthogonality of the neighboring axes
</p>
<p>Table 5.1 DH parameters of
DIESTRO i ai (mm) bi (mm) ˛i �i
</p>
<p>1 50 50 90ı �1
2 50 50 �90ı �2
3 50 50 90ı �3
4 50 50 �90ı �4
5 50 50 90ı �5
6 50 50 �90ı �6
</p>
<p>The geometric interpretation of the above equation is now apparent: Let O 0k be the
foot of the perpendicular to the kth revolute axis from the operation point P ; then,
rk is the vector directed fromO 0k to P . Therefore, the operation point of an isotropic
manipulator, configured at the isotropic posture, is the centroid of the set fO 0k g61 of
perpendicular feet from the operation point.
</p>
<p>An axis layout that satisfies the foregoing isotropy conditions is obtained when
the six axes are laid out along the diagonals of the faces of a cube. If the side of
the cube has a length a, then all distances dk from the cube centroid to the axes are
identical: dk D a=2, for k D 1; : : : ; 6.
</p>
<p>A six-axis manipulator designed with an isotropic architecture, DIESTRO, is
displayed in Fig. 5.15. The Denavit&ndash;Hartenberg parameters of this manipulator are
given in Table 5.1. DIESTRO is characterized by identical link lengths a and offsets
identical with this common link length, besides twist angles of 90ı between all pairs
of neighboring axes. Not surprisingly, the characteristic length of this manipulator
is a.</p>
<p/>
</div>
<div class="page"><p/>
<p>240 5 Kinetostatics of Serial Robots
</p>
<p>Fig. 5.16 Equilateral,
three-revolute planar robot
</p>
<p>5.8.4 Computation of the Characteristic Length: Applications
</p>
<p>to Performance Evaluation
</p>
<p>We elaborate further on the concept of characteristic length. In order to provide a
better grasp of the concept, we focus on its computation as pertaining to a given
robot, that need not be isotropic. To do this, we include two examples, one planar
and one spatial, industrial robot. Once a numerical value of the characteristic length
is available, we can compute the minimum value of the condition number of the
robot Jacobian, with which we can assess the robot kinetostatic performance by
means of the KCI.
</p>
<p>Example 5.8.1 (A Planar, Equilateral, Three-Revolute Robot). Compute the char-
acteristic length of the robot of Fig. 5.16, depicting a posture in which �1 has been
set equal to zero. What is the KCI of this robot?
</p>
<p>Solution: We have a1 D a2 D a3 D a for the robot under study. In order to
compute its length, we have to minimize the Jacobian condition number by a proper
choice of the characteristic length L and the joint variables �2 and �3. We thus start
by deriving an expression for the Jacobian:
</p>
<p>J D
�
</p>
<p>1 1 1
</p>
<p>Es1 Es2 Es3
</p>
<p>�
</p>
<p>Now, we render J dimensionally homogeneous by introducing the characteristic
length L, thus obtaining the normalized Jacobian J:
</p>
<p>J D
�
</p>
<p>1 1 1
</p>
<p>.1=L/Es1 .1=L/Es2 .1=L/Es3
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 241
</p>
<p>From the manipulator geometry, we have,
</p>
<p>Es1 D a
�
</p>
<p>�.s1 C s12 C s123/
c1 C c12 C c123
</p>
<p>�
</p>
<p>; Es2 D a
�
</p>
<p>�.s12 C s123/
c12 C c123
</p>
<p>�
</p>
<p>; Es3 D a
�
</p>
<p>�s123
c123
</p>
<p>�
</p>
<p>with
</p>
<p>c1 � cos �1; c2 � sin �2; c12 � cos.�1 C �2/; c123 D cos.�1 C �2 C �3/
s1 � sin �1; s2 � sin �2; s12 � sin.�1 C �2/; s123 D sin.�1 C �2 C �3/
</p>
<p>Since we set �1 D 0, because the first joint does not affect the condition number, the
normalized Jacobian becomes
</p>
<p>J D
</p>
<p>2
</p>
<p>4
</p>
<p>1 1 1
</p>
<p>�r.s2 C s23/ �r.s2 C s23/ �rs23
r.1C c2 C c23/ r.c2 C c23/ rc23
</p>
<p>3
</p>
<p>5 ; r � a
L
</p>
<p>the inverse of J, as derived with computer algebra, being
</p>
<p>J
�1 D
</p>
<p>2
</p>
<p>4
</p>
<p>s3=s2 c2=.rs2/ 1=r
</p>
<p>�.s3 C s23/=s2 �.1C c2/=.rs2/ �1=r
.s2 C s23/=s2 1=.rs2/ 0
</p>
<p>3
</p>
<p>5
</p>
<p>The square of the Frobenius-norm condition number of J is now computed as
</p>
<p>�2F D fg
</p>
<p>with f and g defined as the square of the weighted Frobenius norms of J and J
�1
</p>
<p>,
respectively, i.e.,
</p>
<p>f � kJk2F D
1
</p>
<p>3
tr.J
</p>
<p>T
J/ D 1C
</p>
<p>�
</p>
<p>2C 2
3
c2 C
</p>
<p>4
</p>
<p>3
c3 C
</p>
<p>2
</p>
<p>3
c23
</p>
<p>�
</p>
<p>r2
</p>
<p>and
</p>
<p>g � kJ �1k2F D
.s2 C s23/2 C .s3 C s23/2 C s23
</p>
<p>3s22
C 2
3
</p>
<p>2C c2
r2s22
</p>
<p>which can be rewritten as
</p>
<p>f D 1C Ar2</p>
<p/>
</div>
<div class="page"><p/>
<p>242 5 Kinetostatics of Serial Robots
</p>
<p>and
</p>
<p>g D 1
3
</p>
<p>D CE=r2
s22
</p>
<p>with coefficients A, D and E independent of r , namely,
</p>
<p>A � 2
3
.3C c2 C 2c3 C c23/
</p>
<p>D � .s2 C s23/2 C .s3 C s23/2 C s23
E � 2.2C c2/
</p>
<p>We now have a classical minimization problem:
</p>
<p>�2F � fg �
1
</p>
<p>3
.1C Ar2/D CE=r
</p>
<p>2
</p>
<p>s22
! min
</p>
<p>r;�2;�3
</p>
<p>where the characteristic length is implicit in r . While the foregoing problem is well
posed, we should not forget that �F is unbounded from above. In order to gain
better insight into the problem at hand, it is preferable to treat the problem as one
of maximization of 1=�F , or of its square, for that matter. As well, we can dispense
with the constant factor 1=3 in �2F , which thus leads to the maximization problem
below:
</p>
<p>z � Q
P
</p>
<p>! max
r;�2;�3
</p>
<p>with P and Q defined as
</p>
<p>P � ADr4 C .AE CD/r2 CE; Q � r2s22
</p>
<p>In order to obtain the optimum values of the three design variables r , �2, and
�3, we need to set up the normality conditions of the problem at hand. These are
readily obtained upon zeroing the gradient of �2F with respect to the vector of design
</p>
<p>variables, defined as x �
�
</p>
<p>r �2 �3
�T
</p>
<p>. The said conditions are, thus,
</p>
<p>@z
</p>
<p>@x
� @
@x
</p>
<p>�
Q
</p>
<p>P
</p>
<p>�
</p>
<p>D 03
</p>
<p>The three components of the above gradient, @z=@r , @z=@�2, and @z=@�3, are then
derived using the general formula for the derivative of a rational expression:
</p>
<p>@
</p>
<p>@xi
</p>
<p>�
Q
</p>
<p>P
</p>
<p>�
</p>
<p>D 1
P 2
</p>
<p>.QiP �QPi /</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 243
</p>
<p>where Qi and Pi stand for @Q=@xi and @P=@xi , with xi taking values of r , �2,
and �3, for i D 1; 2; 3, respectively. We thus have, using a similar notation for the
partial derivatives of coefficients A, D and E:
</p>
<p>P1 D 4ADr3 C 2.AE CD/r; Q1 D 2rs22
P2 D .A2D C AD2/r4 C .A2E C AE2 CD2/r2 CE2; Q2 D 2r2s2c2
P3 D .A3D C AD3/r4 C .A3E C AE3 CD3/r2 CE3; Q3 D 0
</p>
<p>Apparently, E3 D 0, the normality conditions thus simplifying to
</p>
<p>@z
</p>
<p>@r
� �2rs
</p>
<p>2
2
</p>
<p>P 2
</p>
<p>�
</p>
<p>�ADr4 CE
&#13;
</p>
<p>D 0
</p>
<p>@z
</p>
<p>@�2
� r
</p>
<p>2s22
P 2
</p>
<p>˚
</p>
<p>Œ2ADc2 � .A2D C AD2/s2&#141;r4 C Œ2.AE CD/c2
</p>
<p>�.A2E C AE2 CD2/s2&#141; r2 C 2Ec2 �E2s2g D 0
@z
</p>
<p>@�3
� �r
</p>
<p>4s22
P 2
</p>
<p>�
</p>
<p>.A3D C AD3/r2 C .A3E CD3/
�
</p>
<p>D 0
</p>
<p>thereby obtaining a system of three nonlinear equations in three unknowns, namely,
the three design variables. Apparently, all three normality conditions are satisfied
for either r D 0 or s2 D 0, which just confirms that the normality conditions are
sufficient for a point in the design space to be stationary; such a point can be a local
minimum, a local maximum or a saddle point. The vanishing of the product rs2 thus
yields a minimum of z, which indicates �F ! 1, r D 0 giving an architecture
singularity, s2 D 0 a posture singularity. We are not interested, for our purposes, on
such a minimum, for which reason we assume henceforth that rs2 &curren; 0. Under this
condition, the normality conditions thus yield the reduced system of equations
</p>
<p>�1 � �ADr4CED0
�2 � Œ2ADc2�.A2DCAD2/s2&#141;r4CŒ2.AECD/c2�.A2ECAE2CD2/s2&#141;r2
</p>
<p>C2Ec2 �E2s2 D 0
�3 � .A3D C AD3/r2 C .A3E CD3/ D 0
</p>
<p>The problem at hand is thus solved by finding the roots of the foregoing system.
We can do this by means of the Newton&ndash;Raphson method, for example, which (a)
requires the 3 � 3 Jacobian matrix of the three foregoing equations, i.e., further
differentiation, and (b) yields only one root, out of many, for one given initial guess,
when the method converges at all. Moreover, given the local nature of the method,
Newton&ndash;Raphson cannot tell whether one has found all possible roots of the system
of equations.</p>
<p/>
</div>
<div class="page"><p/>
<p>244 5 Kinetostatics of Serial Robots
</p>
<p>An alternative, semigraphical approach, was introduced in Example 4.4.3. This
approach consists in reducing the problem to finding the roots of two nonlinear
equations in two unknowns; each equation, then, defines one contour in the plane
of the two unknowns, the intersection points of the two contours yielding all
possible real roots of the system at hand. In order to apply this approach to the
above system, we have to eliminate one of the three unknowns from the system,
the obvious candidate being r . We can do this by dialytic elimination, as introduced
in Sect. 5.4.1. Given the special structure of the three given equations, it is simpler
to eliminate r following a straightforward approach: First, we solve for r4 from the
first equation and for r2 from the third, which yields:
</p>
<p>r4 D E
AD
</p>
<p>; r2 D � A3E CD3
A3D C AD3
</p>
<p>Upon equating the above expression of r4 with the square of its counterpart
expression for r2, we obtain
</p>
<p>F.�2; �3/ � .AE �D/.AD23 � A23DE/ D 0
</p>
<p>Further, upon substituting the same expressions for r2 and r4 into equation �2 D 0,
we obtain
</p>
<p>G.�2; �3/ � .AE �D/Œ.AA3DE2 C A2A3DE � AD2D3/ sin �2
�2AD.A3E �D3/ cos �2&#141; D 0
</p>
<p>thereby obtaining a reduced system of two equations in two unknowns only, �2 and
�3. The foregoing system admits further simplifications. Indeed, the common factor
AE � D turns out to be positive-definite, i.e., AE � D &gt; 0 for any values of �2
and �3. While it is not obvious that the factor in question is positive-definite, its
sign-definiteness was verified with the aid of computer algebra. To visualize this
property, we include a three-dimensional rendering of the function as a surface in
Fig. 5.17a and a side view of the same in Fig. 5.17b. Given that the factor in question
is positive-definite, we can safely divide both sides of the two foregoing equations
by this factor, which thus leads to two nonlinear equations in �2 and �3 defining
contours C1 and C2 in the �2&ndash;�3 plane, namely,
</p>
<p>C1 W AD23 � A23DE D 0
C2 W .AA3DE2 C A2A3DE � AD2D3/ sin �2 � 2AD.A3E �D3/ cos �2 D 0
</p>
<p>The two above contours are plotted in the �2&ndash;�3 plane in Fig. 5.18.
Apparently, to any optimum posture with joint center O3 above line O1O2
</p>
<p>corresponds a symmetrically located posture of the robot with O3 below the above
line. This means that all solutions .�2; �3/ expected should be symmetric about the
origin of the �2&ndash;�3 plane, which they are, as illustrated in Fig. 5.18a. That is, if a</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 245
</p>
<p>a b
</p>
<p>Fig. 5.17 A 3D rendering of the function ˆ D AE �D vs. �2 and �3: (a) an isometric view; and
(b) a view in the �2&ndash;ˆ plane
</p>
<p>-3 -2 -1 0 1 2 3
</p>
<p>-3
</p>
<p>-2
</p>
<p>-1
</p>
<p>0
</p>
<p>1
</p>
<p>2
</p>
<p>3
</p>
<p>C1
</p>
<p>C2
</p>
<p>0 0.5 1 1.5 2 2.5 3
</p>
<p>0
</p>
<p>0.5
</p>
<p>1
</p>
<p>1.5
</p>
<p>2
</p>
<p>2.5
</p>
<p>3
</p>
<p>C1
</p>
<p>C2
</p>
<p>a b
</p>
<p>Fig. 5.18 Contours C1 and C2 in the �2&ndash;�3 plane: (a) in the �� � �2 � � , �� � �3 � � range;
(b) a zoom-in in the 0 � �2 � � , 0 � �3 � � range
</p>
<p>pair of numerical values .�2; �3/ verifies the normality conditions, then so does the
pair .��2; ��3/. By the same token, if we set �1 D � in the Jacobian expression,
a similar set of normality conditions should be obtained, with the corresponding
symmetry.
</p>
<p>In light of the symmetry of the plots of Fig. 5.18a, we can focus on the first
quadrant of the �2&ndash;�3 plane, and plot the zoom-in of Fig. 5.18a, showing only this
quadrant. Moreover, it is apparent that contour C1 exhibits two double points, one
at (0.9, 2.9), the other at (2.1, 2.6). Double points are likely to produce spurious</p>
<p/>
</div>
<div class="page"><p/>
<p>246 5 Kinetostatics of Serial Robots
</p>
<p>solutions9; hence, we discard those two double points, thereby leaving only five
intersections of interest. As it turns out, the intersection detected by inspection at,
roughly, �2 D 1:69 rad, �3 D 2:61 rad produces a maximum of 1=�F . These rough
values of the design variables were then refined using the Newton&ndash;Raphson method,
with the foregoing rough values as initial guess.10 The Newton&ndash;Raphson method,
as implemented with Matlab code, yielded the refined solution displayed below in
eight iterations:
</p>
<p>�2 D 1:68910726900188 rad D 96:77871763ı;
�3 D 2:61287852677543 rad D 149:7069120ı;
r D 2:040896177 ) L D a=r D 0:4899808287 m
</p>
<p>where we have recalled that a was specified as 1 m. The normalized Jacobian J at
the optimum posture is, moreover,
</p>
<p>J D
</p>
<p>2
</p>
<p>4
</p>
<p>1 1 1
</p>
<p>�0:1552 �0:1552 1:8715
0:9858 �1:0552 �0:8143
</p>
<p>3
</p>
<p>5
</p>
<p>with �F D 1:1832. Hence,
</p>
<p>KCI D 84:52%
</p>
<p>Note that, if we use the 2-norm to define the condition number, i.e., if we minimize
</p>
<p>�2.r; �2; �3/ D
�M
</p>
<p>�m
</p>
<p>then we cannot find expressions for the gradient of 1=�22 with respect to the design
variables because the objective function now is not analytic11 in the design variables.
That is, unlike the minimization of �F , now we do not have normality conditions.
Nevertheless, �2 can still be minimized using a direct-search method, i.e., an
</p>
<p>9A spurious solution is a set of numerical values of the roots of a system of equations that, although
computed from a sound elimination procedure, does not verify the equations. Example 9.7.3
includes a case of a double point in a contour that yields spurious solutions.
10It is well known (Dahlquist and Bj&ouml;rck 1974) that, close to a root, the Newton&ndash;Raphson method
converges quadratically, i.e., the approximation to the root gains, roughly, two digits of accuracy
at each iteration. Hence, the Newton&ndash;Raphson procedure will likely converge to the root closest to
the given estimate.
11A real-valued function of a real argument is said to be analytic at one value of its argument if the
function admits a series expansion at this value. To be true, the exception to the rule is the case of
2� 2 matrices, which have an analytic �2.</p>
<p/>
</div>
<div class="page"><p/>
<p>5.8 Kinetostatic Performance Indices 247
</p>
<p>Fig. 5.19 Optimum
configuration for a
minimum �F
</p>
<p>optimization method not relying on gradients, but only on objective-function evalu-
ation. The objective function is that whose minimum, or maximum for that matter,
is searched. In our case, the objective function to minimize is �2. Direct-search
minimization methods are available in scientific software. Matlab, for example, uses
the Nelder&ndash;Mead simplex method, as implemented in its fminsearch function.
A local minimum value of �2 was found by fminsearch with the initial guess
</p>
<p>r D 1:0; �2 D 6:0ı; �3 D 18:0ı
</p>
<p>after 148 iterations, as
</p>
<p>�2 D 1:9070
</p>
<p>This value is attained at the values of the design variables given below:
</p>
<p>r D 2:1650; �2 D 98:9785ı; �3 D 145:193ı
</p>
<p>which yield L D 0:4619 m and a nondimensional Jacobian
</p>
<p>J D
</p>
<p>2
</p>
<p>4
</p>
<p>1 1 1
</p>
<p>�0:1898 �0:1898 1:9488
0:8839 �1:2813 �0:9433
</p>
<p>3
</p>
<p>5
</p>
<p>Shown in Fig. 5.19 is the given manipulator at the optimum posture under the
condition number calculated using the Frobenius norm, the posture corresponding to
the minimum condition number based on the 2-norm being indistinguishable from
this one.
</p>
<p>Example 5.8.2. Find the KCI and the characteristic length of the Fanuc Robot Arc
Mate S series manipulator of 1990, whose DH parameters are given in Table 5.2.
</p>
<p>Solution: We need the minimum value that the condition number �F of the
normalized robot Jacobian can attain, in order to calculate its KCI as indicated</p>
<p/>
</div>
<div class="page"><p/>
<p>248 5 Kinetostatics of Serial Robots
</p>
<p>Table 5.2 DH parameters of
the Fanuc Arc Mate S series
manipulator of 1990
</p>
<p>i ai (mm) bi (mm) ˛i �i
1 200 810 90ı �1
2 600 0 0ı �2
3 130 �30 90ı �3
4 0 550 90ı �4
5 0 100 90ı �5
6 0 100 0ı �6
</p>
<p>in Eq. (5.87). Now, the Fanuc Robot Arc Mate S series of 1990 is a six-revolute
manipulator for positioning and orienting tasks. Hence, its Jacobian matrix has to
be first recast in nondimensional form, as in Eq. (5.109). Next, we find L along with
the joint variables that determine the posture of minimum condition number via
an optimization procedure. Prior to the formulation of the underlying optimization
problem, however, we recall Theorem 5.8.1, under which the first joint, accounting
for motions of the manipulator as a single rigid body, does not affect its Jacobian
condition number. By the same token, we align axes Z6 and Z7. As a consequence,
�6 does not affect the Jacobian condition number either. We thus define the design
vector x of the optimization problem at hand as a five-dimensional array, namely,
</p>
<p>x �
�
</p>
<p>�2 �3 �4 �5 L
�T
</p>
<p>and set up the optimization problem as
</p>
<p>min
x
�F .J/
</p>
<p>Now, given the architecture of the robot at hand, a symbolic expression for J�1, or
</p>
<p>its dimensionless counterpart J
�1
</p>
<p>, not to speak of �F itself, is elusive, and hence,
an approach like that of Example 5.8.1 appears rather unfeasible. We thus resort to
a direct-search&mdash;as opposed to a gradient-based&mdash;procedure to solve the foregoing
optimization problem. There are various methods of this kind at our disposal; the
one we chose is, again, the Nelder&ndash;Mead simplex method, as implemented in Matlab
within the fminsearch function, which was provided with the initial guess
</p>
<p>xinit D
�
</p>
<p>26ı �56ı 195ı 107ı 341:738
�T
</p>
<p>The results reported by Matlab are displayed below:
</p>
<p>xopt D
�
</p>
<p>22:60ı �51:13ı �159:93ı 88ı 351:23
�T
</p>
<p>whose last entry, the characteristic length of the robot, is in mm, i.e.,
</p>
<p>L D 351:23 mm</p>
<p/>
</div>
<div class="page"><p/>
<p>5.9 Exercises 249
</p>
<p>Furthermore, the minimum condition number attained at the foregoing posture, with
the characteristic length found above, is
</p>
<p>�F D 1:2717
</p>
<p>Therefore, the KCI of the Fanuc Robot Arc Mate S series manipulator of 1990 is
</p>
<p>KCI D 78:63%
</p>
<p>To be sure, the KCI of this manipulator can still be improved dramatically by noting
that the condition number is highly dependent on the location of the operation point
of the end-effector. The robot DH parameters given in Table 5.2 do not account for
the geometry of the EE.
</p>
<p>5.9 Exercises
</p>
<p>N.B.: Exercises 5.14&ndash;5.18 pertain to Sect. 5.8. They are thus to be assigned only
</p>
<p>if this section was covered in class.
</p>
<p>5.1 Shown in Fig. 5.20 is a computer-generated model of DIESTRO, the robot
displayed in Fig. 5.15, with a slightly modified EE. The Denavit&ndash;Hartenberg
parameters of this robot are given in Table 5.3. Find the Jacobian matrix of the
manipulator at the above configuration.
</p>
<p>Fig. 5.20 A six-revolute
manipulator</p>
<p/>
</div>
<div class="page"><p/>
<p>250 5 Kinetostatics of Serial Robots
</p>
<p>Table 5.3 DH parameters of
the modified DIESTRO i ai (mm) bi (mm) ˛i �i
</p>
<p>1 50 50 90ı 90ı
</p>
<p>2 50 50 �90ı �90ı
3 50 50 90ı 90ı
</p>
<p>4 50 50 �90ı �90ı
5 50 50 90ı 90ı
</p>
<p>6 0 50 �90ı �90ı
</p>
<p>Fig. 5.21 A planar three-axis
manipulator
</p>
<p>5.2 The robotic manipulator of Fig. 4.23 is instrumented with sensors measuring
the torque applied by the motors at the joints. Two readouts are taken of the
sensors for the robot in the configuration indicated in the figure. In the first
readout, the gripper is empty; in the second, it holds a tool. If the first readout
is subtracted from the second, the vector difference &#129;� is obtained as
</p>
<p>&#129;� D
�
</p>
<p>0 2 1 0 1 0
�T
</p>
<p>Nm
</p>
<p>With the foregoing information, determine the weight w of the tool and the
distance d of its mass center from C , the center of the spherical wrist.
</p>
<p>5.3 A planar three-axis manipulator is shown in Fig. 5.21, with a1 D a2 D a3 D
1 m. When a wrench acts onto the EE of this manipulator, the joint motors
exert torques that keep the manipulator under static equilibrium. Readouts of
these joint torques are recorded when the manipulator is in the posture �1 D
�2 D �3 D 45ı, namely,
</p>
<p>�1 D �
p
2 Nm; �2 D �
</p>
<p>p
2 Nm; �3 D 1 �
</p>
<p>p
2 Nm
</p>
<p>Calculate the above-mentioned wrench.</p>
<p/>
</div>
<div class="page"><p/>
<p>5.9 Exercises 251
</p>
<p>5.4 For the two postures found in Exercise 4.8, the EE is to move with an angular
velocity ! D Œ!1; !2; !3&#141;T s�1. Show that if k!k remains constant, then so
does k P�k, for P� defined as the joint-rate vector of the wrist.
</p>
<p>5.5 Point C of the manipulator of Fig. 4.17 is to move with a velocity v in the
posture displayed in that figure. Show that as long as kvk remains constant,
so does k P�k, for P� defined as the joint-rate vector. Moreover, let us assume
that in the same posture, point C is to attain a given acceleration a. In general,
however, k R�k, where R� denotes the corresponding joint-acceleration vector,
does not necessarily remain constant under a constant kak. Under which
conditions does kak remain constant for a constant k R�k?
</p>
<p>5.6 A load f is applied to the manipulator of Fig. 4.17 in the posture displayed in
that figure. Torque cells at the joints are calibrated to supply torque readouts
resulting from this load only, and not from the dead load&mdash;its own weight&mdash;of
the manipulator. Show that under a constant-magnitude load, the magnitude
of the joint-torque vector remains constant as well.
</p>
<p>5.7 Shown in Fig. 4.24 is the kinematic chain of an industrial robot, like the ABB-
IRB 1000, which contains five revolutes and one prismatic pair.
</p>
<p>(a) Determine the manipulator Jacobian in the X1; Y1; Z1 coordinate frame
fixed to the base.
</p>
<p>(b) Determine the twist of the end-effector, defined in terms of the velocity of
point P , for unit values of all joint-rates, and the posture displayed in the
same figure.
</p>
<p>(c) Determine the joint accelerations that will produce a vanishing accelera-
tion of the point of intersection, C , of the three wrist axes and a vanishing
angular acceleration of the gripper, for the unit joint rates given above.
</p>
<p>5.8 The robot in Fig. 4.24 is now used for a deburring task. When the robot is in
the configuration shown in that figure, a static force f and no moment acts on
point P of the deburring tool. This force is sensed by torque sensors placed at
the joints of the robot. Assume that the distance between the operating point
P and the wrist center is 500 mm and that the readings of the arm joints are
�1 D 0, �2 D 100 N m, and �3 D 50 N m.
(a) Find the force f acting at P .
(b) Find the readings of the torque sensors placed at the wrist joints.
</p>
<p>5.9 A decoupled manipulator is shown in Fig. 10.3 with the DH parameters of
Table 10.1 at arbitrary posture.
</p>
<p>(a) Find the Jacobian matrix of this manipulator at a posture with axis X1
vertical and pointing downwards, whileZ2 and Y1 make an angle of 180ı.
Moreover, in this particular posture, Z3 and Z4 are vertical and pointing
upwards, while Z7 makes an angle of 180ı with Y1.
</p>
<p>(b) At the posture described in item (a), compute the joint-rates that will
produce the twist</p>
<p/>
</div>
<div class="page"><p/>
<p>252 5 Kinetostatics of Serial Robots
</p>
<p>Œ! &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5!; Œ Pp &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5 v
</p>
<p>(c) A wrench given by a moment n and a force f applied at point P acts on
the EE of the same manipulator at the posture described in item (a) above.
Calculate the joint torques or moments required to balance this wrench,
which is given by
</p>
<p>Œn &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5T; Œ f &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5F
</p>
<p>5.10 A robot of the Puma type has the architecture displayed in Fig. 4.3, with the
numerical values a2 D 0:432m, a3 D 0:020m, b3 D 0:149m, b4 D 0:432m.
Find its maximum reach R as well as the link length a of the manipulator of
Fig. 4.17 with the same reach R.
</p>
<p>5.11 Dialytic elimination. The characteristic polynomial of decoupled manipula-
tors for positioning tasks can be derived alternatively via dialytic elimination,
as introduced in Sect. 5.4.1. It is recalled here that dialytic elimination consists
in eliminating one unknown from a system of polynomial equations by
expressing this system in linear homogeneous form, whereby each equation
is a linear combination of various successive powers of the unknown to be
eliminated, including the zeroth power. This elimination can be achieved as
outlined below: In Eqs. (4.19a) and (4.20a), express cos �1 and sin �1 in terms
of tan.�1=2/ � t1, thereby obtaining
</p>
<p>.�AC C c3 CD s3 CE/ t21 C 2B t1 C .C c3 CD s3 CE C A/ D 0
.H c3 C I s3 C J / t21 C .2G � F / t1 C .H c3 C I s3 C J C F / D 0
</p>
<p>which can be further expressed as
</p>
<p>m t21 C 2B t1 C n D 0
p t21 C .2G � F / t1 C q D 0
</p>
<p>with obvious definitions for coefficients m, n, p, and q. Next, both sides of
the two foregoing equations are multiplied by t1, thereby producing
</p>
<p>m t31 C 2B t21 C n t1 D 0
p t31 C .2G � F / t21 C q t1 D 0
</p>
<p>Now, the last four equations can be regarded as a system of linear homoge-
neous equations, namely,
</p>
<p>Mt1 D 0</p>
<p/>
</div>
<div class="page"><p/>
<p>5.9 Exercises 253
</p>
<p>where 0 is the four-dimensional zero vector, while M is a 4 � 4 matrix, and t1
is a four-dimensional vector. These arrays are defined as
</p>
<p>M �
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>0 m 2B n
</p>
<p>0 p 2G � F q
m 2B n 0
</p>
<p>p 2G � F q 0
</p>
<p>3
</p>
<p>7
7
5
; t1 �
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>t31
t21
t1
1
</p>
<p>3
</p>
<p>7
7
5
</p>
<p>Apparently, t1 &curren; 0, and hence, M must be singular. The characteristic
polynomial sought can then be derived from the condition
</p>
<p>det.M/ D 0
</p>
<p>Show that the last equation is quadratic in cos �3 and sin �3. Hence, the
foregoing equation should lead to a quartic equation in tan.�3=2/. Derive the
quartic equation involved. Hint: Do not do this by hand, for it may be too
time-consuming and could quickly lead to algebraic mistakes. Use software
</p>
<p>for symbolic computations instead.
5.12 Compute the workspace volume of the manipulator of Fig. 4.3. Here, you
</p>
<p>can exploit the axial symmetry of the workspace by recalling the Pappus&ndash;
Guldinus Theorems&mdash;see any book on multivariable calculus&mdash;that yield the
volume as 2�q, with q defined as the first moment of the cross-section, which
is displayed in Fig. 5.4b, with respect to the axis of symmetry,Z1. To this end,
you will need the first moment of a semicircle with respect to its diameter. This
information is tabulated in books on elementary mechanics or multivariable
calculus, a.k.a. advanced calculus.
</p>
<p>5.13 Compute the workspace volume of the manipulator of Fig. 4.17, whose
workspace is sketched in Fig. 5.5. Here, you can also use the Pappus&ndash;Guldinus
Theorem, as suggested in Exercise 5.12. However, the first moment of the
cross-section has to be determined numerically, for the area properties of
the curve that generates the three-dimensional workspace are not tabulated.
Now, for two manipulators, the Puma-type and the one under discussion, with
the same reach, determine which one has the larger workspace. Note: This
exercise is not more difficult than others, but it requires the use of suitable
</p>
<p>software for the calculation of area properties of planar regions bounded by
</p>
<p>arbitrary curves. Unless you have access to such software, do not attempt this
</p>
<p>exercise.
</p>
<p>5.14 Show that the maximum manipulability � D
p
</p>
<p>det.JJT / of an orthogonal
spherical wrist is attained when all three of its axes are mutually orthogonal.
Find that maximum value.
</p>
<p>5.15 Find an expression for the condition number of a three-revolute spherical
wrist of twist angles ˛4 and ˛5, and show that this number depends only on
˛4, ˛5, and the intermediate joint angle, �5. Moreover, find values of these
variables that minimize the condition number of the manipulator. Hint: To
find the required expression, the use of the condition number based on the</p>
<p/>
</div>
<div class="page"><p/>
<p>254 5 Kinetostatics of Serial Robots
</p>
<p>Frobenius norm is strongly recommended. However, rendering the Jacobian
</p>
<p>matrix isotropic can be done by inspection.
</p>
<p>5.16 Manipulability of decoupled manipulators. Let �a and �w represent the
manipulability of the arm and the wrist of a decoupled manipulator, i.e.,
</p>
<p>�a �
q
</p>
<p>det.J21JT21/; �w �
q
</p>
<p>det.J12JT12/
</p>
<p>with J12 and J21 defined in Sect. 5.2. Show that the manipulability � of the
overall manipulator is the product of the two manipulabilities given above,
i.e.,
</p>
<p>� D �a�w
</p>
<p>5.17 Consider a planar two-revolute manipulator with link lengths a1 and a2. Find
an expression of the form �.r; �2/ for the condition number of its Jacobian,
with r D a2=a1, and establish values of r and �2 that minimize �, which
reaches a minimum value of unity.
</p>
<p>5.18 Shown in Fig. 5.12 is an orthogonal three-revolute manipulator with an
isotropic Jacobian. Find the volume of its workspace. Now consider a second
manipulator with a similar orthogonal architecture, but with more common
dimensions, i.e., with links of equal length �. If the two manipulators have the
same reach, that is, if
</p>
<p>� D 1C
p
2
</p>
<p>2
l
</p>
<p>find the volume of the workspace of the second manipulator. Finally, deter-
mine the KCI&mdash;see Sect. 5.8 for a definition of this term&mdash;of the second
manipulator. Draw some conclusions with regard to the performance of the
two manipulators.</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 6
</p>
<p>Trajectory Planning: Pick-and-Place Operations
</p>
<p>6.1 Introduction
</p>
<p>The motions undergone by robotic mechanical systems should be, as a rule, as
smooth as possible; i.e., abrupt changes in position, velocity, and acceleration should
be avoided. Indeed, abrupt motions require unlimited amounts of power to be
implemented, which the motors cannot supply because of their physical limitations.
On the other hand, abrupt motion changes arise when the robot collides with an
object, a situation that should also be avoided. While smooth motions can be
planned with simple techniques, as described below, these are no guarantees that no
abrupt motion changes will occur. In fact, if the work environment is cluttered with
objects, whether stationary or mobile, collisions may occur. Under ideal conditions,
a flexible manufacturing cell is a work environment in which all objects, machines
and workpieces alike, move with preprogrammed motions that by their nature,
can be predicted at any instant. Actual situations, however, are far from being
ideal, and system failures are unavoidable. Unpredictable situations should thus be
accounted for when designing a robotic system, which can be done by supplying
the system with sensors for the automatic detection of unexpected events or by
providing for human monitoring. Nevertheless, robotic systems find applications
not only in the well-structured environments of flexible manufacturing cells, but also
in unstructured environments such as exploration of unknown terrains and systems
in which humans are present. The planning of robot motions in the latter case is
obviously much more challenging than in the former. Robot motion planning in
unstructured environments calls for techniques beyond the scope of those studied in
this book, involving such areas as pattern recognition and artificial intelligence. For
this reason, we have devoted this book to the planning of robot motions in structured
environments only.
</p>
<p>Electronic supplementary material The online version of this article (doi: 10.1007/978-3-319-
01851-5_6) contains supplementary material, which is available to authorized users.
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__6,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>255</p>
<p/>
</div>
<div class="page"><p/>
<p>256 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>Two typical tasks call for trajectory planning techniques, namely,
</p>
<p>&bull; pick-and-place operations (PPO), and
&bull; continuous paths (CP).
</p>
<p>We will study PPO in this chapter, with Chap. 11 devoted to CP. Moreover,
we will focus on simple robotic manipulators of the serial type, although these
techniques can be directly applied to other, more advanced, robotic mechanical
systems.
</p>
<p>6.2 Background on PPO
</p>
<p>In PPO, a robotic manipulator is meant to take a workpiece from a given initial
pose, specified by the position of one of its points and its orientation with respect to a
certain coordinate frame, to a final pose, specified likewise. However, how the object
moves from its initial to its final pose is immaterial, as long as the motion is smooth
and no collisions occur. Pick-and-place operations are executed in elementary
manufacturing operations such as loading and unloading of belt conveyors, tool
changes in machine tools, and simple assembly operations such as putting roller
bearings on a shaft. The common denominator of these tasks is material handling,
which usually requires the presence of conventional machines whose motion is very
simple and is usually characterized by a uniform velocity. In some instances, such
as in packing operations, a set of workpieces, e.g., in a magazine, is to be relocated
in a prescribed pattern in a container, which constitutes an operation known as
palletizing. Although palletizing is a more elaborate operation than simple pick-
and-place, it can be readily decomposed into a sequence of the latter operations.
</p>
<p>It should be noted that although the initial and the final poses in a PPO are
prescribed in the Cartesian space, robot motions are implemented in the joint space.
Hence, the planning of PPO will be conducted in the latter space, which brings
about the need of mapping the motion thus planned into the Cartesian space, in
order to ensure that the robot will not collide with other objects in its surroundings.
The latter task is far from being that simple, since it involves the rendering of
the motion of all the moving links of the robot, each of which has a particular
geometry. An approach to path planning first proposed by Lozano-P&eacute;rez (1981)
consists of mapping the obstacles in the joint space, thus producing obstacles in the
joint space in the form of regions that the joint-space trajectory should avoid. The
idea can be readily implemented for simple planar motions and simple geometries
of the obstacles. However, for general 3-D motions and arbitrary geometries, the
computational requirements make the procedure impractical. A more pragmatic
approach would consist of two steps, namely, (a) planning a preliminary trajectory
in the joint space, disregarding the obstacles, and (b) visually verifying if collisions
occur with the aid of a graphics system rendering the animation of the robot motion
in the presence of obstacles. The availability of powerful graphics hardware enables
the fast animation of robot motions within a highly realistic environment. Shown in
Fig. 6.1 is a still image of the animation produced by RVS, the McGill University</p>
<p/>
</div>
<div class="page"><p/>
<p>6.2 Background on PPO 257
</p>
<p>Fig. 6.1 Still image of the animation of a palletizing operation
</p>
<p>Robot-Visualization System, of the motion of a robot performing a palletizing
operation. Commercial software for robot-motion rendering is available.
</p>
<p>By inspection of the kinematic closure equations of robotic manipulators&mdash;see
Eqs. (4.5a and b)&mdash;it is apparent that in the absence of singularities, the mapping
of joint to Cartesian variables, and vice versa, is continuous. Hence, a smooth
trajectory planned in the joint space is guaranteed to be smooth in the Cartesian
space, and the other way around, as long as the trajectory does not encounter a
singularity.
</p>
<p>In order to proceed to synthesize the joint trajectory, we must then start by
mapping the initial and final poses of the workpiece, which is assumed to be rigidly
attached to the EE of the manipulator, into manipulator configurations described in
the joint space. This is readily done with the methods described in Chap. 4. Let the
vector of joint variables at the initial and final robot configurations be denoted by �I
and �F , respectively. Moreover, the initial pose in the Cartesian space is defined by
the position vector pI of the operation point P of the EE and a rotation matrix QI .
Likewise, the final pose in the Cartesian space is defined by the position vector pF of
P and the rotation matrix QF . Moreover, let PpI and RpI denote the velocity and accel-
eration of P , while !I and P!I denote the angular velocity and angular acceleration
of the workpiece, all of these at the initial pose. These variables at the final pose are
denoted likewise, with the subscript I changed to F . Furthermore, we assume that
time is counted from the initial pose, i.e., at this pose, t D 0. If the operation takes</p>
<p/>
</div>
<div class="page"><p/>
<p>258 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>place in time T , then at the final pose, t D T . We have thus the set of conditions
that define a smooth motion between the initial and the final poses, namely,
</p>
<p>p.0/ D pI Pp.0/ D 0 Rp.0/ D 0 (6.1a)
Q.0/ D QI !.0/ D 0 P!.0/ D 0 (6.1b)
p.T / D pF Pp.T / D 0 Rp.T / D 0 (6.1c)
Q.T / D QF !.T / D 0 P!.T / D 0 (6.1d)
</p>
<p>In the absence of singularities, then, the conditions of zero velocity and acceleration
imply zero joint velocity and acceleration, and hence,
</p>
<p>�.0/ D �I P�.0/ D 0 R�.0/ D 0 (6.2a)
�.T / D �F P�.T / D 0 R�.T / D 0 (6.2b)
</p>
<p>6.3 Polynomial Interpolation
</p>
<p>A simple inspection of conditions (6.2a) and (6.2b) reveals that a linear interpolation
between initial and final configurations will not work here, and neither will a
quadratic interpolation, for its slope vanishes only at a single point. Hence, a higher-
order interpolation is needed. On the other hand, these conditions imply, in turn,
six conditions for every joint trajectory, which means that if a polynomial is to be
employed to represent the motion of every joint, then this polynomial should be at
least of the fifth degree. We thus start by studying trajectory planning with the aid
of a 5th-degree polynomial.
</p>
<p>6.3.1 A 3-4-5 Interpolating Polynomial
</p>
<p>In order to represent each joint motion, we use here a fifth-order polynomial s.�/,
namely,
</p>
<p>s.�/ D a�5 C b�4 C c�3 C d�2 C e� C f (6.3)
</p>
<p>such that
</p>
<p>0 � s � 1; 0 � � � 1 (6.4)
</p>
<p>and
</p>
<p>� D t
T
</p>
<p>(6.5)</p>
<p/>
</div>
<div class="page"><p/>
<p>6.3 Polynomial Interpolation 259
</p>
<p>We will thus aim at a normal polynomial that, upon scaling both its argument and the
polynomial itself, will allow us to represent each of the joint variables �j throughout
its range of motion, so that
</p>
<p>�j .t/ D � Ij C .�Fj � � Ij /s.�/ (6.6a)
</p>
<p>where � Ij and �
F
j are the given initial and final values of the j th joint variable. In
</p>
<p>vector form, Eq. (6.6a) becomes
</p>
<p>�.t/ D �I C .�F � �I /s.�/ (6.6b)
</p>
<p>and hence,
</p>
<p>P�.t/ D .�F � �I /s0.�/ P�.t/ D .�F � �I /
1
</p>
<p>T
s0.�/ (6.6c)
</p>
<p>Likewise,
</p>
<p>R�.t/ D 1
T 2
.�F � �I /s00.�/ (6.6d)
</p>
<p>and
</p>
<p>:::
�.t/ D 1
</p>
<p>T 3
.�F � �I /s000.�/ (6.6e)
</p>
<p>What we now need are the values of the coefficients of s.�/ that appear in Eq. (6.3).
These are readily found by recalling conditions (6.2a and b), upon consideration of
Eqs. (6.6b&ndash;d). We thus obtain the end conditions for s.�/, namely,
</p>
<p>s.0/ D 0; s0.0/ D 0; s00.0/ D 0; s.1/ D 1; s0.1/ D 0; s00.1/ D 0 (6.7)
</p>
<p>The derivatives of s.�/ appearing above are readily derived from Eq. (6.3), i.e.,
</p>
<p>s0.�/ D 5a�4 C 4b�3 C 3c�2 C 2d� C e (6.8)
</p>
<p>and
</p>
<p>s00.�/ D 20a�3 C 12b�2 C 6c� C 2d (6.9)
</p>
<p>Thus, the first three conditions of Eq. (6.7) lead to
</p>
<p>f D e D d D 0 (6.10)</p>
<p/>
</div>
<div class="page"><p/>
<p>260 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;1
</p>
<p>&minus;0.8
</p>
<p>&minus;0.6
</p>
<p>&minus;0.4
</p>
<p>&minus;0.2
</p>
<p>0
</p>
<p>0.2
</p>
<p>0.4
</p>
<p>0.6
</p>
<p>0.8
</p>
<p>1
</p>
<p>s
</p>
<p>s smax
</p>
<p>s s
</p>
<p>s
</p>
<p>max
</p>
<p>s
max
</p>
<p>Fig. 6.2 3-4-5 interpolation polynomial and its derivatives
</p>
<p>while the last three conditions yield three linear equations in a, b, and c, namely,
</p>
<p>aC b C c D 1 (6.11a)
5aC 4b C 3c D 0 (6.11b)
</p>
<p>20aC 12b C 6c D 0 (6.11c)
</p>
<p>Upon solving the three foregoing equations for the three aforementioned unknowns,
we obtain
</p>
<p>a D 6; b D �15; c D 10 (6.12)
</p>
<p>and hence, the normal polynomial sought is
</p>
<p>s.�/ D 6�5 � 15�4 C 10�3 (6.13)
</p>
<p>which is called a 3-4-5 polynomial.
This polynomial and its first three derivatives, all normalized to fall within the
</p>
<p>.�1; 1/ range, are shown in Fig. 6.2. Note that the smoothness conditions imposed at
the outset are respected and that the curve thus obtained is a monotonically growing
function of � , a rather convenient property for the problem at hand.
</p>
<p>It is thus possible to determine the evolution of each joint variable if we know
both its end values and the time T required to complete the motion. If no extra
conditions are imposed, we then have the freedom to perform the desired motion
in as short a time T as possible. Note, however, that this time cannot be given an
arbitrarily small value, for we must respect the motor specifications on maximum</p>
<p/>
</div>
<div class="page"><p/>
<p>6.3 Polynomial Interpolation 261
</p>
<p>velocity and maximum torque, the latter being the subject of Chap. 7. In order to
ease the discussion, we limit ourselves to specifications of maximum joint velocity
and acceleration rather than maximum torque. From the form of function �j .t/
of Eq. (6.6a), it is apparent that this function takes on extreme values at points
corresponding to those at which the normal polynomial attains its extrema. In order
to find the values of � at which the first and second derivatives of s.�/ attain
maximum values, we need to zero its second and third derivatives. These derivatives
are displayed below:
</p>
<p>s0.�/ D 30�4 � 60�3 C 30�2 (6.14a)
s00.�/ D 120�3 � 180�2 C 60� (6.14b)
s000.�/ D 360�2 � 360� C 60 (6.14c)
</p>
<p>from which it is apparent that the second derivative vanishes at the two ends of the
interval 0 � � � 1. Additionally, the same derivative vanishes at the midpoint of the
same interval, i.e., at � D 1=2. Hence, the maximum value of s0.�/, s0max, is readily
found as
</p>
<p>s0max D s0
�
1
</p>
<p>2
</p>
<p>�
</p>
<p>D 15
8
</p>
<p>(6.15)
</p>
<p>and hence, the maximum value of the j th joint rate takes on the value
</p>
<p>. P�j /max D
15.�Fj � � Ij /
</p>
<p>8T
(6.16)
</p>
<p>which becomes negative, and hence, a local minimum, if the difference in the
numerator is negative. The values of � at which the second derivative attains
its extreme values are likewise determined. The third derivative vanishes at two
intermediate points �1 and �2 of the interval 0 � � � 1, namely, at
</p>
<p>�1;2 D
1
</p>
<p>2
˙
p
3
</p>
<p>6
(6.17)
</p>
<p>and hence, the maximum value of s00.�/ is readily found as
</p>
<p>s00max D s00
 
</p>
<p>1
</p>
<p>2
�
p
3
</p>
<p>6
</p>
<p>!
</p>
<p>D 10
p
3
</p>
<p>3
(6.18)
</p>
<p>while the minimum is given as
</p>
<p>s00min D s00
 
</p>
<p>1
</p>
<p>2
C
p
3
</p>
<p>6
</p>
<p>!
</p>
<p>D �10
p
3
</p>
<p>3
(6.19)</p>
<p/>
</div>
<div class="page"><p/>
<p>262 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>Therefore, the maximum value of the joint acceleration is as shown below:
</p>
<p>. R�j /max D
10
p
3
</p>
<p>3
</p>
<p>.�Fj � � Ij /
T 2
</p>
<p>(6.20)
</p>
<p>Likewise,
</p>
<p>s000max D s000.0/ D s000.1/ D 60
</p>
<p>and hence,
</p>
<p>.
:::
� j /max D 60
</p>
<p>�FJ � � Ij
T 3
</p>
<p>(6.21)
</p>
<p>Thus, Eqs. (6.16) and (6.20) allow us to determine T for each joint so that the joint
rates and accelerations lie within the allowed limits. Obviously, since the motors of
different joints are different, the minimum values of T allowed by the joints will be,
in general, different. Of those various values of T , we will, of course, choose the
largest one.
</p>
<p>6.3.2 A 4-5-6-7 Interpolating Polynomial
</p>
<p>Now, from Eq. (6.14c), it is apparent that the third derivative of the normal
polynomial does not vanish at the end points of the interval of interest. This implies
that the third time derivative of �j .t/, also known as the joint jerk, does not vanish
at those ends either. It is desirable to have this derivative as smooth as the first two,
but this requires us to increase the order of the normal polynomial. In order to attain
the desired smoothness, we will then impose two more conditions, namely,
</p>
<p>s000.0/ D 0; s000.1/ D 0 (6.22)
</p>
<p>We now have eight conditions on the normal polynomial, which means that the
polynomial degree should be increased to seven, namely,
</p>
<p>s.�/ D a�7 C b�6 C c�5 C d�4 C e�3 C f �2 C g� C h (6.23a)
</p>
<p>whose derivatives are readily determined as shown below:
</p>
<p>s0.�/ D 7a�6 C 6b�5 C 5c�4 C 4d�3 C 3e�2 C 2f � C g (6.23b)
s00.�/ D 42a�5 C 30b�4 C 20c�3 C 12d�2 C 6e� C 2f (6.23c)
s000.�/ D 210a�4 C 120b�3 C 60c�2 C 24d� C 6e (6.23d)</p>
<p/>
</div>
<div class="page"><p/>
<p>6.3 Polynomial Interpolation 263
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;1
</p>
<p>&minus;0.8
</p>
<p>&minus;0.6
</p>
<p>&minus;0.4
</p>
<p>&minus;0.2
</p>
<p>0
</p>
<p>0.2
</p>
<p>0.4
</p>
<p>0.6
</p>
<p>0.8
</p>
<p>1
</p>
<p>s
</p>
<p>s s
</p>
<p>s
</p>
<p>s
</p>
<p>max
</p>
<p>s
max
</p>
<p>s max
</p>
<p>Fig. 6.3 4-5-6-7 interpolating polynomial and its derivatives
</p>
<p>The first three conditions of Eq. (6.7) and the first condition of Eq. (6.22) readily
lead to
</p>
<p>e D f D g D h D 0 (6.24)
</p>
<p>Furthermore, the last three conditions of Eq. (6.7) and the second condition of
Eq. (6.22) lead to four linear equations in four unknowns, namely,
</p>
<p>aC b C c C d D 1 (6.25a)
7aC 6b C 5c C 4d D 0 (6.25b)
</p>
<p>42aC 30b C 20c C 12d D 0 (6.25c)
210aC 120b C 60c C 24d D 0 (6.25d)
</p>
<p>and hence, we obtain the solution
</p>
<p>a D �20; b D 70; c D �84; d D 35 (6.26)
</p>
<p>the desired polynomial thus being
</p>
<p>s.�/ D �20�7 C 70�6 � 84�5 C 35�4 (6.27)
</p>
<p>which is a 4-5-6-7 polynomial. This polynomial and its first three derivatives,
normalized to fall within the range .�1; 1/, are plotted in Fig. 6.3. Note that the
4-5-6-7 polynomial is similar to that of Fig. 6.2, except that the third derivative of
the former vanishes at the extremes of the interval of interest. As we will presently
show, this smoothness has been obtained at the expense of higher maximum values
of the first and second derivatives.</p>
<p/>
</div>
<div class="page"><p/>
<p>264 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>We now determine the maximum values of the velocity and acceleration
produced with this motion. To this end, we display below the first three derivatives,
namely,
</p>
<p>s0.�/ D �140�6 C 420�5 � 420�4 C 140�3 (6.28a)
s00.�/ D �840�5 C 2100�4 � 1680�3 C 420�2 (6.28b)
s000.�/ D �4200�4 C 8400�3 � 5040�2 C 840� (6.28c)
</p>
<p>The first derivative attains its extreme values at points where the second derivative
vanishes. Upon zeroing the latter, we obtain
</p>
<p>�2.�2�3 C 5�2 � 4� C 1/ D 0 (6.29)
</p>
<p>which clearly contains a double root at � D 0. Moreover, the cubic polynomial
in the parentheses above admits one real root, namely, � D 1=2, which yields the
maximum value of s0.�/, i.e.,
</p>
<p>s0max D s0
�
1
</p>
<p>2
</p>
<p>�
</p>
<p>D 35
16
</p>
<p>(6.30)
</p>
<p>whence the maximum value of the j th joint rate is found as
</p>
<p>. P�j /max D
35.�Fj � � Ij /
</p>
<p>16T
(6.31)
</p>
<p>Likewise, the points of maximum joint acceleration are found upon zeroing the
third derivative of s.�/, namely,
</p>
<p>s000.�/ D �4200�4 C 8400�3 � 5040�2 C 840� D 0 (6.32)
</p>
<p>or
</p>
<p>�.� � 1/.5�2 � 5� C 1/ D 0 (6.33)
</p>
<p>which yields, in addition to the two end points, two intermediate extreme points,
namely,
</p>
<p>�1;2 D
1
</p>
<p>2
˙
p
5
</p>
<p>10
(6.34)
</p>
<p>and hence, the maximum value of acceleration is found to be
</p>
<p>s00max D s00.�1/ D
84
p
5
</p>
<p>25
(6.35)</p>
<p/>
</div>
<div class="page"><p/>
<p>6.4 Cycloidal Motion 265
</p>
<p>the minimum occurring at � D �2, with s00min D �s00max. The maximum value of the
j th joint acceleration is thus
</p>
<p>. R�j /max D
84
p
5
</p>
<p>25
</p>
<p> 
</p>
<p>�Fj � � Ij
T 2
</p>
<p>!
</p>
<p>(6.36)
</p>
<p>which becomes a minimum if the difference in the numerator is negative. Likewise,
the zeroing of the fourth derivative leads to
</p>
<p>�20�3 C 30�2 � 12� C 1 D 0
</p>
<p>whose three roots are
</p>
<p>�1 D
1 �
</p>
<p>p
</p>
<p>3=5
</p>
<p>2
; �2 D
</p>
<p>1
</p>
<p>2
; �1 D
</p>
<p>1C
p
</p>
<p>3=5
</p>
<p>2
</p>
<p>and hence,
</p>
<p>s000max D s000
 
</p>
<p>1˙
p
</p>
<p>3=5
</p>
<p>2
</p>
<p>!
</p>
<p>D 42; s000min D s000.0:5/ D �
105
</p>
<p>2
</p>
<p>i.e.,
</p>
<p>max
�
fjs000.�/jg D 105
</p>
<p>2
� s000M (6.37)
</p>
<p>As in the case of the fifth-order polynomial, it is possible to use the foregoing
relations to determine the minimum time T during which it is possible to perform a
given PPO while observing the physical limitations of the motors.
</p>
<p>6.4 Cycloidal Motion
</p>
<p>An alternative motion that produces zero velocity and acceleration at the ends of a
finite interval is the cycloidal motion. In normal form, this motion is given by
</p>
<p>s.�/ D � � 1
2�
</p>
<p>sin 2�� (6.38a)
</p>
<p>its derivatives being readily derived as
</p>
<p>s0.�/ D 1 � cos 2�� (6.38b)
s00.�/ D 2� sin 2�� (6.38c)
s000.�/ D 4�2 cos 2�� (6.38d)</p>
<p/>
</div>
<div class="page"><p/>
<p>266 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;1
</p>
<p>&minus;0.8
</p>
<p>&minus;0.6
</p>
<p>&minus;0.4
</p>
<p>&minus;0.2
</p>
<p>0
</p>
<p>0.2
</p>
<p>0.4
</p>
<p>0.6
</p>
<p>0.8
</p>
<p>1
</p>
<p>s
</p>
<p>s  s
max
</p>
<p>s  smax
</p>
<p>s  s
max
</p>
<p>Fig. 6.4 The normal cycloidal motion and its time derivatives
</p>
<p>The cycloidal motion and its first three time-derivatives, normalized to fall within
the range .�1; 1/, are shown in Fig. 6.4. Note that while this motion, indeed, has zero
velocity and acceleration at the ends of the interval 0 � � � 1, its jerk is nonzero at
these points and hence, exhibits jump discontinuities at the ends of that interval.
</p>
<p>When implementing the cycloidal motion in PPO, we have, for the j th joint,
</p>
<p>�j .t/ D � Ij C .�Fj � � Ij /s.�/ (6.39a)
</p>
<p>P�j .t/ D
�Fj � � Ij
T
</p>
<p>s0.�/ (6.39b)
</p>
<p>R�j .t/ D
�Fj � � Ij
T 2
</p>
<p>s00.�/ (6.39c)
</p>
<p>Moreover, as the reader can readily verify, under the assumption that �Fj &gt; �
I
j , this
</p>
<p>motion attains its maximum velocity at the center of the interval, i.e., at � D 0:5,
the maximum being
</p>
<p>s0max D s0.0:5/ D 2
</p>
<p>and hence,
</p>
<p>. P�j /max D
2
</p>
<p>T
.�Fj � � Ij / (6.40a)
</p>
<p>Likewise, the j th joint acceleration attains its maximum and minimum values at
� D 0:25 and � D 0:75, respectively, i.e.,
</p>
<p>s00max D s00.0:25/ D s00.0:75/ D 2� (6.40b)</p>
<p/>
</div>
<div class="page"><p/>
<p>6.5 Trajectories with via Poses 267
</p>
<p>and hence,
</p>
<p>. R�j /max D
2�
</p>
<p>T 2
.�Fj � � Ij /; . R�j /min D �
</p>
<p>2�
</p>
<p>T 2
.�Fj � � Ij / (6.40c)
</p>
<p>Moreover, s000.�/ attains its extrema at the ends of the interval, i.e.,
</p>
<p>s000max D s000.0/ D s000.1/ D 4�2 (6.41)
</p>
<p>and hence,
</p>
<p>.
:::
� j /max D
</p>
<p>4�2
</p>
<p>T 3
.�Fj � � Ij / (6.42)
</p>
<p>Thus, if motion is constrained by the maximum speed delivered by the motors,
the minimum time Tj for the j th joint to produce the given PPO can be readily
determined from Eq. (6.40a) as
</p>
<p>Tj D
2.�Fj � � Ij /
. P�j /max
</p>
<p>(6.43)
</p>
<p>and hence, the minimum time in which the operation can take place can be readily
found as
</p>
<p>Tmin D 2max
j
</p>
<p>(
</p>
<p>�Fj � � Ij
. P�j /max
</p>
<p>)
</p>
<p>(6.44)
</p>
<p>If joint-acceleration constraints are imposed, then a similar procedure can be
followed to find the minimum time in which the operation can be realized. As a
matter of fact, rather than maximum joint accelerations, maximum joint torques are
to be respected. How to determine these torques is studied in detail in Chap. 7.
</p>
<p>6.5 Trajectories with via Poses
</p>
<p>The polynomial trajectories discussed above do not allow the specification of
intermediate Cartesian poses of the EE. All they guarantee is that the Cartesian
trajectories prescribed at the initial and final instants are met. One way of verifying
the feasibility of the Cartesian trajectories thus synthesized was outlined above
and consists of using a graphics system, preferably with animation capabilities, to
produce an animated rendering of the robot motion, thereby allowing for verification
of collisions. If the latter occur, we can either try alternative branches of the inverse
kinematics solutions computed at the end poses or modify the trajectory so as to
eliminate collisions. We discuss below the second approach. This is done with what</p>
<p/>
</div>
<div class="page"><p/>
<p>268 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>are called via poses, i.e., poses of the EE in the Cartesian space that lie between the
initial and the final poses, and are determined so as to avoid collisions (Gosselin and
Hadj-Messaoud 1993). For example, if upon approaching the final pose of the PPO,
the manipulator is detected to interfere with the surface on which the workpiece is
to be placed, a via pose is selected close to the final point so that at this pose, the
workpiece is far enough from the surface. From inverse kinematics, values of the
joint variables can be determined that correspond to the aforementioned via poses.
These values can now be regarded as points on the joint-space trajectory and are
hence called via points. Obviously, upon plotting each joint variable vs. time, via
points appear as points on those plots as well.
</p>
<p>The introduction of via points in the joint-space trajectories amounts to an
increase in the number of conditions to be satisfied by the desired trajectory. For
example, in the case of the polynomial trajectory synthesized for continuity up to
second derivatives, we can introduce two via points by requiring that
</p>
<p>s.�1/ D s1; s.�2/ D s2 (6.45)
</p>
<p>where �1, �2, s1, and s2 depend on the via poses prescribed and the instants at which
these poses are desired to occur. Hence, s1 and s2 differ from joint to joint, although
the occurrence instants �1 and �2 are the same for all joints. Thus, we will have to
determine one normal polynomial for each joint. Furthermore, the ordinate values s1
and s2 of the normal polynomial at via points are determined from the corresponding
values of the joint variable determined, in turn, from given via poses through inverse
kinematics. Once the via values of the joint variables are known, the ordinate values
of the via points of the normal polynomial are found from Eq. (6.6a). Since we
have now eight conditions to satisfy, namely, the six conditions (6.7) plus the two
conditions (6.45), we need a seventh-order polynomial, i.e.,
</p>
<p>s.�/ D a�7 C b�6 C c�5 C d�4 C e�3 C f �2 C g� C h (6.46)
</p>
<p>Again, the first three conditions of Eq. (6.7) lead to the vanishing of the last three
coefficients, i.e.,
</p>
<p>f D g D h D 0 (6.47)
</p>
<p>Further, the five remaining conditions are now introduced, which leads to a system
of five linear equations in five unknowns, namely,
</p>
<p>aC b C c C d C e D 1 (6.48a)
7aC 6b C 5c C 4d C 3e D 0 (6.48b)
</p>
<p>42aC 30b C 20c C 12d C 6e D 0 (6.48c)
�71aC �61b C �51 c C �41d C �31 e D s1 (6.48d)
�72aC �62b C �52 c C �42d C �32 e D s2 (6.48e)</p>
<p/>
</div>
<div class="page"><p/>
<p>6.6 Synthesis of PPO Using Cubic Splines 269
</p>
<p>where �1, �2, s1, and s2 are all data. For example, if the via poses occur at 10 and
90% of T , we have
</p>
<p>�1 D 1=10; �2 D 9=10 (6.48f)
</p>
<p>the polynomial coefficients being found as
</p>
<p>a D 100.12286C 12500s1 � 12500s2/=729 (6.49a)
b D 100.�38001 � 48750s1 C 38750s2/=729 (6.49b)
c D .1344358C 2375000s1 � 1375000s2/=243 (6.49c)
d D .�1582435 � 4625000s1 C 1625000s2/=729 (6.49d)
e D 10.12159C 112500s1 � 12500s2/=729 (6.49e)
</p>
<p>The shape of each joint trajectory thus depends on the values of s1 and s2 found
from Eq. (6.6a) for that trajectory.
</p>
<p>6.6 Synthesis of PPO Using Cubic Splines
</p>
<p>When the number of via poses increases, the foregoing approach may become
impractical, or even unreliable. Indeed, forcing a trajectory to pass through a
number of via points and meet endpoint conditions is equivalent to interpolation.
We have seen that an increase in the number of conditions to be met by the normal
polynomial amounts to an increase in the degree of this polynomial. Now, finding
the coefficients of the interpolating polynomial requires solving a system of linear
equations. As we saw in Sect. 5.8, the computed solution, when solving a system
of linear equations, is corrupted with a relative roundoff error that is roughly equal
to the relative roundoff error of the data multiplied by an amplification factor that
is known as the condition number of the system matrix. As we increase the order
of the interpolating polynomial, the associated condition number rapidly increases,
a fact that numerical analysts discovered some time ago (Kahaner et al. 1989).
In order to cope with this problem, orthogonal polynomials, such as those bearing
the names of Chebyshev, Laguerre, Legendre, and so on, have been proposed. While
orthogonal polynomials alleviate the problem of a large condition number, they do
this only up to a certain extent. As an alternative to higher-order polynomials, spline
functions have been found to offer more robust interpolation schemes (Dierckx
1993). Spline functions, or splines, for brevity, are piecewise polynomials with
continuity properties imposed at the supporting points. The latter are those points at
which two neighboring polynomials join.
</p>
<p>The attractive feature of splines is that they are defined as a set of rather lower-
degree polynomials joined at a number of supporting points. Moreover, the matrices
that arise from an interpolation problem associated with a spline function are such</p>
<p/>
</div>
<div class="page"><p/>
<p>270 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>that their condition number is only slightly dependent on the number of supporting
points, and hence, splines offer the possibility of interpolating over a virtually
unlimited number of points without producing serious numerical conditioning
problems.
</p>
<p>Below we expand on periodic cubic splines, for these will be shown to be
specially suited for path planning in robotics.
</p>
<p>A cubic spline function s.x/ connecting N points Pk .xk; yk/, for k D
1; 2; : : : ; N , is a function defined piecewise by N � 1 cubic polynomials joined at
the points Pk , such that s.xk/ D yk . Furthermore, the spline function thus defined
is twice differentiable everywhere in x1 � x � xN . Hence, cubic splines are said to
be C 2 functions, i.e., to have continuous derivatives up to the second order.
</p>
<p>Cubic splines are optimal in the sense that they minimize a functional, i.e., an
integral defined as
</p>
<p>F D
Z T
</p>
<p>0
</p>
<p>s002.x/ dx
</p>
<p>subject to the constraints
</p>
<p>s.xk/ D yk ; k D 1; : : : ; N
</p>
<p>where xk and yk are given. The aforementioned optimality property has a simple
kinematic interpretation: Among all functions defining a motion so that the plot of
this function passes through a set of points P1.x1; s1/, P2.x2; s2/, : : : , PN .xN ; sN /
in the x&ndash;s plane, the cubic spline is the one containing the minimum acceleration
magnitude. In fact, F , as given above, is the square of the Euclidean norm (Halmos
1974) of s00.x/, i.e., F turns out to be a measure of the magnitude of the acceleration
of a displacement program given by s.x/, if we interpret s as displacement and x as
time.
</p>
<p>Let Pk.xk; yk/ and PkC1.xkC1; ykC1/ be two consecutive supporting points.
The kth cubic polynomial sk.x/ between those points is assumed to be given by
</p>
<p>sk.x/ D Ak .x � xk/3 C Bk .x � xk/2 C Ck .x � xk/CDk (6.50a)
</p>
<p>for xk � x � xkC1. Thus, for the spline s.x/, 4.N �1/ coefficients Ak , Bk , Ck ,Dk ,
for k D 1; : : : ; N � 1, are to be determined. These coefficients will be computed
presently in terms of the given function values fskgN1 and the second derivatives of
the spline at the supporting points, fs00k .xk/gN1 , as explained below:
</p>
<p>We will need the first and second derivatives of sk.x/ as given above, namely,
</p>
<p>s0k.x/ D 3Ak.x � xk/2 C 2Bk.x � xk/C Ck (6.50b)
s00k .x/ D 6Ak.x � xk/C 2Bk (6.50c)</p>
<p/>
</div>
<div class="page"><p/>
<p>6.6 Synthesis of PPO Using Cubic Splines 271
</p>
<p>whence the relations below follow immediately:
</p>
<p>Bk D
1
</p>
<p>2
s00k (6.51a)
</p>
<p>Ck D s0k (6.51b)
Dk D sk (6.51c)
</p>
<p>where we have used the abbreviations
</p>
<p>sk � s.xk/; s0k � s0.xk/; s00k � s00.xk/ (6.52)
</p>
<p>Furthermore, let
</p>
<p>&#129;xk � xkC1 � xk (6.53)
</p>
<p>From the above relations, we have expressions for coefficients Bk and Dk in terms
of s00k and sk , respectively, but the expression for Ck is given in terms of s
</p>
<p>0
k . What
</p>
<p>we would like to have are similar expressions for Ak and Ck , i.e., in terms of sk
and s00k . The relations sought will be found by imposing the continuity conditions
on the spline function and its first and second derivatives with respect to x at the
supporting points. These conditions are, then, for k D 1; 2; : : : ; N � 1,
</p>
<p>sk.xkC1/ D skC1 (6.54a)
s0k.xkC1/ D s0kC1 (6.54b)
s00k .xkC1/ D s00kC1 (6.54c)
</p>
<p>Upon substituting s00k .xkC1/, as given by Eq. (6.50c), into Eq. (6.54c), we obtain
</p>
<p>6Ak&#129;xk C 2Bk D 2BkC1
</p>
<p>but from Eq. (6.51a), we have already an expression for Bk , and hence, one for
BkC1 as well. Substituting these two expressions in the above equation, we obtain
an expression for Ak , namely,
</p>
<p>Ak D
1
</p>
<p>6&#129;xk
.s00kC1 � s00k / (6.54d)
</p>
<p>Furthermore, if we substitute sk.xkC1/, as given by Eq. (6.50a), into Eq. (6.54a), we
obtain
</p>
<p>Ak.&#129;xk/
3 C Bk.&#129;xk/2 C Ck&#129;xk CDk D skC1</p>
<p/>
</div>
<div class="page"><p/>
<p>272 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>But we already have values for Ak , Bk and Dk from Eqs. (6.54d), (6.51a),
and (6.51c), respectively. Upon substituting these values in the foregoing equation,
we obtain the desired expression for Ck in terms of function and second-derivative
values, i.e.,
</p>
<p>Ck D
&#129;sk
</p>
<p>&#129;xk
� 1
6
&#129;xk .s
</p>
<p>00
kC1 C 2s00k / (6.54e)
</p>
<p>In summary, then, we now have expressions for all four coefficients of the kth
polynomial in terms of function and second-derivative values at the supporting
points, namely,
</p>
<p>Ak D
1
</p>
<p>6&#129;xk
.s00kC1 � s00k / (6.55a)
</p>
<p>Bk D
1
</p>
<p>2
s00k (6.55b)
</p>
<p>Ck D
&#129;sk
</p>
<p>&#129;xk
� 1
6
&#129;xk .s
</p>
<p>00
kC1 C 2s00k / (6.55c)
</p>
<p>Dk D sk (6.55d)
</p>
<p>with
</p>
<p>&#129;sk � skC1 � sk (6.55e)
</p>
<p>Therefore, in order to find the above coefficients, all we need is the set of
values of the second derivatives fs00k gN1 at the supporting points. To compute these
values, we impose the continuity condition on the first derivative, Eq. (6.54b), after
substitution of Eq. (6.50b), which yields
</p>
<p>3Ak.&#129;xk/
2 C 2Bk&#129;xk C Ck D CkC1
</p>
<p>or, if we shift to the previous polynomial,
</p>
<p>3Ak�1.&#129;xk�1/
2 C 2Bk�1&#129;xk�1 C Ck�1 D Ck
</p>
<p>Now, if we substitute expressions (6.55a&ndash;c) in the above equation, a linear system
of N � 2 simultaneous equations for the N unknowns fs00k gN1 is obtained, namely,
</p>
<p>.&#129; xk/s
00
kC1 C 2.&#129;xk�1 C&#129;xk/s00k C .&#129;xk�1/s00k�1
</p>
<p>D 6
�
&#129;sk
</p>
<p>&#129;xk
� &#129;sk�1
&#129;xk�1
</p>
<p>�
</p>
<p>; for k D 2; : : : ; N � 1 : (6.56)</p>
<p/>
</div>
<div class="page"><p/>
<p>6.6 Synthesis of PPO Using Cubic Splines 273
</p>
<p>Further, let s be the N -dimensional vector whose kth component is sk , with
vector s00 being defined likewise, i.e.,
</p>
<p>s D Œ s1; � � � ; sN &#141;T ; s00 D
�
</p>
<p>s001 ; � � � ; s00N
�T
</p>
<p>(6.57)
</p>
<p>The relationship between s and s00 of Eq. (6.56) can then be written in vector
form as
</p>
<p>A s00 D 6C s (6.58a)
</p>
<p>where A and C are .N � 2/ �N matrices defined as:
</p>
<p>A D
</p>
<p>2
</p>
<p>6
6
6
6
6
4
</p>
<p>˛1 2˛1;2 ˛2 0 � � � 0 0
0 ˛2 2˛2;3 ˛3 � � � 0 0
:::
</p>
<p>:::
: : :
</p>
<p>: : :
: : :
</p>
<p>:::
:::
</p>
<p>0 0 : : : ˛N 000 2˛N 000;N 00 ˛N 00 0
</p>
<p>0 0 0 � � � ˛N 00 2˛N 00;N 0 ˛N 0
</p>
<p>3
</p>
<p>7
7
7
7
7
5
</p>
<p>(6.58b)
</p>
<p>and
</p>
<p>C D
</p>
<p>2
</p>
<p>6
6
6
6
6
4
</p>
<p>ˇ1 �ˇ1;2 ˇ2 0 � � � 0 0
0 ˇ2 �ˇ2;3 ˇ3 � � � 0 0
:::
</p>
<p>:::
: : :
</p>
<p>: : :
: : :
</p>
<p>:::
:::
</p>
<p>0 0 � � � ˇN 000 �ˇN 000;N 00 ˇN 00 0
0 0 0 � � � ˇN 00 �ˇN 00;N 0 ˇN 0
</p>
<p>3
</p>
<p>7
7
7
7
7
5
</p>
<p>(6.58c)
</p>
<p>while for i; j; k D 1; : : : ; N � 1,
</p>
<p>˛k � &#129;xk ; ˛i;j � ˛i C ˛j ; (6.58d)
ˇk � 1=˛k ; ˇi;j � ˇi C ˇj (6.58e)
</p>
<p>and
</p>
<p>N 0 � N � 1; N 00 � N � 2; N 000 � N � 3 (6.58f)
</p>
<p>Thus, two additional equations are needed to render Eq. (6.58a) a determined
system. The additional equations are derived, in turn, depending upon the class of
functions one is dealing with, which thus gives rise to various types of splines. For
example, if s001 and s
</p>
<p>00
N are defined as zero, then one obtains natural cubic splines,
</p>
<p>the name arising by an analogy with beam analysis. Indeed, in beam theory, the
boundary conditions of a simply-supported beam establish the vanishing of the
bending moments at the ends. From beam theory, moreover, the bending moment</p>
<p/>
</div>
<div class="page"><p/>
<p>274 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>is proportional to the second derivative of the elastica, or neutral axis, of the beam
with respect to the abscissa along the beam axis in the undeformed configuration.
In this case, vector s00 becomes of dimension N � 2, and hence, matrix A becomes,
correspondingly, of .N � 2/ � .N � 2/, namely,
</p>
<p>A D
</p>
<p>2
</p>
<p>6
6
6
6
6
4
</p>
<p>2˛1;2 ˛2 0 � � � 0
˛2 2˛2;3 ˛3 � � � 0
:::
</p>
<p>: : :
: : :
</p>
<p>: : :
:::
</p>
<p>0 : : : ˛N 000 2˛N 000;N 00 ˛N 00
</p>
<p>0 0 � � � ˛N 00 2˛N 00;N 0
</p>
<p>3
</p>
<p>7
7
7
7
7
5
</p>
<p>(6.59)
</p>
<p>On the other hand, if one is interested in periodic functions, which is often the
case when synthesizing pick-and-place motions, then the conditions s1 D sN , s01 D
s0N , s
</p>
<p>00
1 D s00N are imposed, thereby producing periodic cubic splines. The last of
</p>
<p>these conditions is used to eliminate one unknown in Eq. (6.58a), while the second
condition, namely the continuity of the first derivative, is used to add an equation.
We have, then,
</p>
<p>s01 D s0N (6.60)
</p>
<p>which can be written, using Eq. (6.54b), as
</p>
<p>s01 D s0N�1.xN / (6.61)
</p>
<p>Upon substituting s0N�1.xN /, as given by Eq. (6.50b), into the above equation,
we obtain
</p>
<p>s01 D 3AN�1&#129;x2N�1 C 2BN�1&#129;xN�1 C CN�1 (6.62)
</p>
<p>Now we use Eqs. (6.55a&ndash;c) and simplify the expression thus resulting, which
leads to
</p>
<p>2.&#129;x1 C&#129;xN�1/s001 C&#129;x1s002 C&#129;xN�1s00N�1 D 6
�
&#129;s1
</p>
<p>&#129;x1
� &#129;sN�1
&#129;xN�1
</p>
<p>�
</p>
<p>(6.63)
</p>
<p>thereby obtaining the last equation required to solve the system of equations given
by Eqs. (6.58a&ndash;c). We thus have .N � 1/ independent equations to solve for
.N � 1/ unknowns, namely, s00k , for k D 1; : : : ; N � 1, s00N being equal to s001 .
Expressions for matrices A and C, as applicable to periodic cubic splines, are given
in Eqs. (11.59a and b).
</p>
<p>While we focused in the above discussion on cubic splines, other types of splines
could have been used. For example, Thompson and Patel (1987) used B-splines in
robotics trajectory planning.</p>
<p/>
</div>
<div class="page"><p/>
<p>6.6 Synthesis of PPO Using Cubic Splines 275
</p>
<p>Example 6.6.1 (Approximation of a 4-5-6-7 Polynomial with a Cubic Spline). Find
the cubic spline that interpolates the 4-5-6-7 polynomial of Fig. 6.3 with N C 1
equally-spaced supporting points and plot the interpolation error for N D 3 and
N D 10.
Solution: Let us use a natural spline, in which case the second derivative at the end
points vanishes, with vector s00 thus losing two components. That is, we now have
only N � 2 unknowns f s00k gN�12 to determine. Correspondingly, matrix A then loses
its first and last columns and hence, becomes a square .N � 2/ � .N � 2/ matrix.
Moreover,
</p>
<p>&#129;xk D
1
</p>
<p>N
; k D 1; : : : ; N
</p>
<p>and matrices A and C become, correspondingly,
</p>
<p>A D 1
N
</p>
<p>2
</p>
<p>6
6
6
6
6
4
</p>
<p>4 1 0 � � � 0
1 4 1 � � � 0
:::
: : :
</p>
<p>: : :
: : :
</p>
<p>:::
</p>
<p>0 : : : 1 4 1
</p>
<p>0 0 � � � 1 4
</p>
<p>3
</p>
<p>7
7
7
7
7
5
</p>
<p>and
</p>
<p>C D N
</p>
<p>2
</p>
<p>6
6
6
6
6
4
</p>
<p>1 �2 1 0 � � � 0 0
0 1 �2 1 � � � 0 0
:::
:::
: : :
</p>
<p>: : :
: : :
</p>
<p>:::
:::
</p>
<p>0 0 � � � 1 �2 1 0
0 0 0 � � � 1 �2 1
</p>
<p>3
</p>
<p>7
7
7
7
7
5
</p>
<p>the vector of second derivatives at the supporting points, s00, then being readily
obtained as
</p>
<p>s00 D 6A�1Cs
</p>
<p>With the values of the second derivatives at the supporting points known, the
calculation of the spline coefficients Ak , Bk , Ck , and Dk , for k D 1; : : : ; N , is now
straightforward. Let the interpolation error, e.x/, be defined as e.x/ � s.x/�p.x/,
where s.x/ is the interpolating spline and p.x/ is the given polynomial. This error
and its derivatives e0.x/, e00.x/, and e000.x/ are plotted in Figs. 6.5 and 6.6 forN D 3
and N D 10, respectively. What we observe is an increase of more than one order
of magnitude in the error as we increase the order of the derivative by one. Thus,
the order of magnitude of acceleration errors is usually higher than two orders of
magnitude above the displacement errors, a fact that should not be overlooked in
applications.</p>
<p/>
</div>
<div class="page"><p/>
<p>276 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
&minus;0.01
</p>
<p>0
</p>
<p>0.01
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;0.1
</p>
<p>0
</p>
<p>0.1
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;2
</p>
<p>0
</p>
<p>2
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;50
</p>
<p>0
</p>
<p>50
</p>
<p>e
</p>
<p>e
</p>
<p>e
</p>
<p>e
</p>
<p>x
</p>
<p>x
</p>
<p>x
</p>
<p>x
</p>
<p>Fig. 6.5 Errors in the approximation of a 4-5-6-7 polynomial with a natural cubic spline, using
four supporting points
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;5
</p>
<p>0
</p>
<p>5
x 10
</p>
<p>&minus;4
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;0.02
</p>
<p>0
</p>
<p>0.02
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;0.5
</p>
<p>0
</p>
<p>0.5
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>&minus;20
</p>
<p>0
</p>
<p>20
</p>
<p>e
</p>
<p>e
</p>
<p>e
</p>
<p>e
</p>
<p>x
</p>
<p>x
</p>
<p>x
</p>
<p>x
</p>
<p>Fig. 6.6 Errors in the approximation of a 4-5-6-7 polynomial with a natural cubic spline, using
eleven supporting points</p>
<p/>
</div>
<div class="page"><p/>
<p>6.7 Exercises 277
</p>
<p>6.7 Exercises
</p>
<p>6.1 A common joint-rate program for pick-and-place operations is the trapezoidal
profile of Fig. 6.7, whereby we plot s0.�/ vs. � , using the notation introduced in
Chap. 7, i.e., with s.�/ and � defined as dimensionless variables. Here, s0.�/
starts and ends at 0. From its start to a value �1, s0.�/ grows linearly, until
reaching a maximum s0max; then, this function remains constant until a value
�2 is reached, after which the function decreases linearly to zero at the end of
the interval.
</p>
<p>Clearly, this profile has a discontinuous acceleration and hence, is bound
to produce shock and vibration. However, the profile can be smoothed with a
spline interpolation as indicated below.
</p>
<p>(a) Find the value of s0max in terms of �1 and �2 so that s.0/ D 0 and s.1/ D 1.
(b) Plot s.�/with the value of s0max found above and decompose it into a linear
</p>
<p>part sl .�/ and a periodic part sp.�/.
(c) Sample s.�/ with N equally spaced points and find the periodic spline
</p>
<p>that interpolates sp.�/, for �1 D 0:2 and �2 D 0:9. Try various values
of N and choose the one that (a) is the smallest possible, (b) gives
a &ldquo;good&rdquo; approximation of the original s.�/, and (c) yields the best-
behaved acceleration program, i.e., an acceleration profile that is smooth
and within reasonable bounds. Discuss how you would go about defining
a reasonable bound.
</p>
<p>6.2 An alternative approach to the solution of the foregoing smoothing problem
consists in solving an inverse interpolation problem: Plot the acceleration
program of the foregoing joint-rate plot, s00.�/. Now, sample a set ofN equally
spaced points of s00.�/ and store them in anN -dimensional array s00. Next, find
the ordinates of the supporting points of the interpolating periodic spline and
store them in an array s of suitable dimension. Note that s00 does not contain
information on the linear part of s.�/. You will have to modify suitably your
</p>
<p>Fig. 6.7 A trapezoidal joint-rate profile</p>
<p/>
</div>
<div class="page"><p/>
<p>278 6 Trajectory Planning: Pick-and-Place Operations
</p>
<p>array s so that it will produce the correct abscissa values of the interpolated
curve s.�/, with s.0/ D 0 and s.1/ D 1. Moreover, s.�/ must be monotonic.
Try various values ofN and choose the smallest one that gives a well-behaved
acceleration program, as described in Exercise 6.1.
</p>
<p>6.3 One more approach to smoothing the joint-rate profile of Fig. 6.7 is to
use cycloidal motions. To this end, define a segment of a cycloidal-motion
function between � D 0 and � D �1, so that s0.�1/ D s0max, for s0max as
indicated in the same figure. Further, define a similar segment between � D �2
and � D 1 so that s0.�2/ D s0max and s0.1/ D 0. Then, join the two segments
with a line of slope s0max. Plot the displacement, velocity, and acceleration
of the smoothed motion. Note that the smoothed profile must meet the end
conditions s.0/ D 0 and s.1/ D 1, and that you may have to introduce a
change of variable to shrink the corresponding s0.�/ segment to meet these
conditions.
</p>
<p>6.4 A pick-and-place operation involves picking objects from a magazine supplied
with an indexing mechanism that presents the objects with a known pose and
zero twist, at equal time-intervals T , to a robot, which is to place the objects
on a belt conveyor running at a constant speed v0. Find 5th- and 7th-degree
polynomials that can be suitably used to produce the necessary joint-variable
time-histories.
</p>
<p>6.5 Repeat Exercise 6.4, but now the objects are to be picked up by the robot from
a belt conveyor traveling at a constant velocity v1 and placed on a second belt
conveyor traveling at a constant velocity v2. Moreover, let p1 and p2 designate
the position vectors of the points at the pick- and the place poses, respectively.
Furthermore, the belts lie in horizontal, parallel planes. Finally, the objects
must observe the same attitude with respect to the belt orientation in both the
pick- and the place poses.
</p>
<p>6.6 Approximate the cycloidal function of Sect. 6.4 using a periodic cubic spline
with N subintervals of the same lengths, for various values of N between 5
and 100. Tabulate the approximation error eN vs. N , with eN defined as
</p>
<p>eN � max
i
feigN1
</p>
<p>and
</p>
<p>ei � max
�
js.�/ � c.�/j; �i � � � �iC1
</p>
<p>in which s.�/ denotes the spline approximation and c.�/ the cycloidal
function. Note: the cycloidal function can be decomposed into a linear and
a periodic part.
</p>
<p>6.7 From inspection of the plot of the 3-4-5 polynomial and its derivatives
displayed in Fig. 6.2, it is apparent that the polynomial can be regarded as
the superposition of a linear and a periodic function in the interval 0 � � � 1.
Approximate the underlying periodic function with a periodic cubic spline
by subdividing the above-mentioned interval into N equal subintervals, while</p>
<p/>
</div>
<div class="page"><p/>
<p>6.7 Exercises 279
</p>
<p>finding the value of N that will yield a maximum absolute value of less than
10�4 in the error in
</p>
<p>(a) the function values;
(b) the values of the first derivative; and
(c) the values of the second derivative.
</p>
<p>6.8 Repeat Exercise 6.7 for the 4-5-6-7 polynomial of Fig. 6.3.
6.9 A pick-and-place operation is being planned that should observe manufac-
</p>
<p>turer&rsquo;s bounds on the maximum joint rates delivered by the motors of a given
robot. To this end, we have the following choices: (a) a 4-5-6-7 polynomial;
(b) a symmetric trapezoidal speed profile like that of Fig. 6.7, with �1 D 0:20;
and (c) a cycloidal motion. Which of these motions produces the minimum
time in which the operation can be performed?
</p>
<p>6.10 The maximum speed of a cycloidal motion was found to be 2. By noticing that
the cycloidal motion is the superposition of a linear and a periodic function,
find a cubic-spline motion that will yield a maximum speed of 1.5, with the
characteristics of the cycloidal motion at its end points.
</p>
<p>6.11 The acceleration of a certain motion s.�/, for 0 � � � 1, is given at a sample
of instants f �k gN1 in the form
</p>
<p>s00.�k/ D A sin.2��k/
</p>
<p>Find the cubic spline interpolating the given motion so that its second time-
derivative will attain those given values, while finding A such that s.0/ D
0 and s.1/ D 1. Hint: A combination of a linear function and a periodic
spline can yield this motion. In order to find the function values of the periodic
</p>
<p>spline, exploit the linear relation between the function values and its second
</p>
<p>derivatives at the spline supporting points, as discussed in Sect. 6.6.
</p>
<p>6.12 A robotic joint has been found to require to move, within a time-interval
T , with a set of speed values f P�k gN1 at equally spaced instants. Find the
natural cubic spline that interpolates the underlying motion so that the angular
displacement undergone from beginning to end is a given &#129;� . Hint: You will
need to establish the linear relation between the spline function values and
</p>
<p>those of its first derivative.</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 7
</p>
<p>Dynamics of Serial Robotic Manipulators
</p>
<p>7.1 Introduction
</p>
<p>The main objectives of this chapter are (a) to devise an algorithm for the real-time
computed-torque control and (b) to derive the system of second-order ordinary
differential equations (ODE) governing the motion of an n-axis manipulator. We
will focus on serial manipulators, the dynamics of a much broader class of robotic
mechanical systems, namely, parallel manipulators and mobile robots, being the
subject of Chap. 12. Moreover, we will study mechanical systems with rigid links
and rigid joints and will put aside systems with flexible elements, which pertain to
a more specialized realm.
</p>
<p>7.2 Inverse vs. Forward Dynamics
</p>
<p>The two basic problems associated with the dynamics of robotic mechanical
systems, namely, the inverse and the forward problems, are thoroughly discussed
in this chapter. The relevance of these problems cannot be overstated: the former is
essential for the computed-torque control of robotic manipulators, while the latter is
required for the simulation and the real-time feedback control of the same systems.
Because the inverse problem is purely algebraic, it is conceptually simpler to grasp
than the forward problem, and hence, the inverse problem will be discussed first.
Moreover, the inverse problem is also computationally simpler than the forward
problem. In the inverse problem, a time-history of either the Cartesian or the joint
coordinates is given, and from knowledge of these histories and the architecture and
inertial parameters of the system at hand, the torque or force requirements at the
different actuated joints are determined as time-histories as well. In the forward
problem, current values of the joint coordinates and their first time-derivatives
are known at a given instant, the time-histories of the applied torques or forces
being also known, along with the architecture and the inertial parameters of the
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__7,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>281</p>
<p/>
</div>
<div class="page"><p/>
<p>282 7 Dynamics of Serial Robotic Manipulators
</p>
<p>manipulator at hand. With these data, the values of the joint coordinates and their
time-derivatives are computed at a later sampling instant by integration of the
underlying system of nonlinear ordinary differential equations.
</p>
<p>The study of the dynamics of systems of multiple rigid bodies is classical, but
up until the advent of the computer, it was limited only to theoretical results and
a reduced number of bodies. First Uicker (1965) and then Kahn (1969) produced
a method based on the Euler&ndash;Lagrange equations of mechanical systems of rigid
bodies that they used to simulate the dynamical behavior of such systems. A break-
through in the development of algorithms for dynamics computations was reported
by Luh et al. (1980), who proposed a recursive formulation of multibody dynamics
that is applicable to systems with serial kinematic chains. This formulation, based
on the Newton&ndash;Euler equations of rigid bodies, allowed the calculation of the
joint torques of a six-revolute manipulator with only 800 multiplications and 595
additions, a tremendous gain if we consider that the straightforward calculation of
the Euler&ndash;Lagrange equations for the same type of manipulator involves 66,271
multiplications and 51,548 additions, as pointed out by Hollerbach (1980). In
the foregoing reference, a recursive derivation of the Euler&ndash;Lagrange equations
was proposed, whereby the computational complexity was reduced to only 2,195
multiplications and 1,719 additions.
</p>
<p>The foregoing results provoked a discussion on the merits and demerits of
each of the Euler&ndash;Lagrange and the Newton&ndash;Euler formulations. Silver (1982)
pointed out that since both formulations are equivalent, they should lead to the
same computational complexity. In fact, Silver showed how to derive the Euler&ndash;
Lagrange equations from the Newton&ndash;Euler formulation by following an approach
first introduced by Kane (1961) in connection with nonholonomic systems. Kane
and Levinson (1983) then showed how Kane&rsquo;s equations can be applied to particular
robotic manipulators and arrived at lower computational complexities. They applied
the said equations to the Stanford Arm (Paul 1981) and computed its inverse
dynamics with 646 multiplications and 394 additions. Thereafter, Khalil et al.
(1986) proposed a condensed recursive Newton&ndash;Euler method that reduced the
computational complexity to 538 multiplications and 478 additions, for arbitrary
architectures. Further developments in this area were reported by Balafoutis and
Patel (1991), who showed that the underlying computational complexity can be
reduced to 489 multiplications and 420 additions for the most general case of a six-
revolute manipulator, i.e., without exploiting particular features of the manipulator
geometry. Balafoutis and Patel based their algorithm on tensor analysis, whereby
tensor identities are exploited to their fullest extent in order to reduce the number
of operations involved. Li and Sankar (1992), in turn, reported further savings that
allowed them to bring down those numbers to 459 multiplications and 390 additions.
</p>
<p>In this chapter, the inverse dynamics problem is solved with the well-known
recursive Newton&ndash;Euler algorithm, while the forward dynamics problem is handled
with a novel approach, based on the reciprocity relations between the constraint
wrenches and the feasible twists of a manipulator. This technique is developed with
the aid of a modeling tool known as the natural orthogonal complement, thoroughly
discussed in Sect. 7.5.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Fundamentals of Multibody System Dynamics 283
</p>
<p>Throughout the chapter, we will follow a multibody system approach, which
requires a review of the underlying fundamentals.
</p>
<p>7.3 Fundamentals of Multibody System Dynamics
</p>
<p>7.3.1 On Nomenclature and Basic Definitions
</p>
<p>We consider here a mechanical system composed of r rigid bodies and denote by
Mi the 6 � 6 inertia dyad&mdash;see Sect. 3.8&mdash;of the i th body. Moreover, we let Wi ,
already introduced in Eq. (3.140), be the 6 � 6 angular-velocity dyad of the same
body. As pertaining to the case at hand, the said matrices are displayed below:
</p>
<p>Mi �
�
</p>
<p>Ii O
</p>
<p>O mi1
</p>
<p>�
</p>
<p>; Wi �
�
</p>
<p>&#127;i O
</p>
<p>O O
</p>
<p>�
</p>
<p>; i D 1; : : : ; r (7.1)
</p>
<p>where 1 and O denote the 3 � 3 identity and zero matrices, respectively, while &#127;i
and Ii are the angular-velocity and the inertia matrices of the i th body, this last
being defined with respect to the center of mass Ci of this body. Moreover, the
mass of this body is denoted by mi , whereas ci and Pci denote the position and the
velocity vectors of Ci in an inertial frame. Furthermore, let ti denote the twist of
the same body, the latter being defined in terms of the angular velocity vector !i ,
the vector of &#127;i , and the velocity of Ci . The six-dimensional momentum screw �i
is defined likewise. Furthermore, wWi and w
</p>
<p>C
i are defined as the working wrench
</p>
<p>and the nonworking constraint wrench exerted on the i th body by its neighbors, in
which forces are assumed to be applied at Ci . We thus have, for i D 1; : : : ; r ,
</p>
<p>ti D
�
</p>
<p>!i
</p>
<p>Pci
</p>
<p>�
</p>
<p>; �i D
�
</p>
<p>Ii!i
</p>
<p>mi Pci
</p>
<p>�
</p>
<p>; wWi D
�
</p>
<p>nWi
fWi
</p>
<p>�
</p>
<p>; wCi D
�
</p>
<p>nCi
fCi
</p>
<p>�
</p>
<p>(7.2)
</p>
<p>where superscripted ni and fi stand, respectively, for the moment and the force
acting on the i th body, the force being applied at the mass center Ci . Thus, whereas
wWi accounts for forces and moments exerted by both the environment and the
actuators, including driving forces as well as dissipative effects, wCi , whose sole
function is to keep the links together, accounts for those forces and moments exerted
by the neighboring links, which do not produce any mechanical work. Therefore,
friction wrenches applied by the .i � 1/st and the .i C 1/st links onto the i th link
are not included in wCi ; rather, they are included in w
</p>
<p>W
i .
</p>
<p>Clearly, from the definitions of Mi , �i , and ti , we have
</p>
<p>�i DMi ti (7.3)</p>
<p/>
</div>
<div class="page"><p/>
<p>284 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Moreover, from Eq. (3.143),1
</p>
<p>P�i DMi Pti CWi�i DMi Pti CWiMi ti (7.4)
</p>
<p>We now recall the Newton&ndash;Euler equations for a rigid body, namely,
</p>
<p>Ii P!i D �!i � Ii!i C nWi C nCi (7.5a)
mi Rci D fWi C fCi (7.5b)
</p>
<p>which can be written in compact form using the foregoing six-dimensional twist and
wrench arrays as well as the 6�6 inertia and angular-velocity dyads. We thus obtain
the Newton&ndash;Euler equations of the i th body in the form
</p>
<p>Mi Pti D �WiMi ti C wWi C wCi (7.5c)
</p>
<p>7.3.2 The Euler&ndash;Lagrange Equations of Serial Manipulators
</p>
<p>The Euler&ndash;Lagrange dynamical equations of a mechanical system are now recalled,
as pertaining to serial manipulators. Thus, the mechanical system at hand has n
degrees of freedom, its n independent generalized coordinates being the n joint
variables, which are stored in the n-dimensional vector � . We thus have
</p>
<p>d
</p>
<p>dt
</p>
<p>�
@T
</p>
<p>@ P�
</p>
<p>�
</p>
<p>� @T
@�
D � (7.6)
</p>
<p>where T is a scalar function denoting the kinetic energy of the system and � is the
n-dimensional vector of generalized force. If some forces on the right-hand side
stem from a potential V , we can, then decompose � into two parts, �p and �p , the
former arising from V and termed the conservative force of the system; the latter is
the nonconservative force. That is,
</p>
<p>�p � �
@V
</p>
<p>@�
(7.7)
</p>
<p>the above Euler&ndash;Lagrange equations thus becoming
</p>
<p>d
</p>
<p>dt
</p>
<p>�
@L
</p>
<p>@ P�
</p>
<p>�
</p>
<p>� @L
@�
D �p (7.8)
</p>
<p>where L is the Lagrangian of the system, defined as
</p>
<p>L � T � V (7.9)
</p>
<p>1See Exercise 7.1 for an extension of this relation to a system of n rigid bodies.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Fundamentals of Multibody System Dynamics 285
</p>
<p>Moreover, the kinetic energy of the system is simply the sum of the kinetic energies
of all the r links. Recalling Eq. (3.145), which gives the kinetic energy of a rigid
body in terms of six-dimensional arrays, one has
</p>
<p>T D
r
X
</p>
<p>1
</p>
<p>Ti D
r
X
</p>
<p>1
</p>
<p>1
</p>
<p>2
tTi Mi ti (7.10)
</p>
<p>whereas the vector of nonconservative generalized forces is given by
</p>
<p>�p �
@&hellip;A
</p>
<p>@ P�
� @&#129;
@ P�
</p>
<p>(7.11)
</p>
<p>in which &hellip;A and &#129; denote the power supplied to the system and the Rayleigh
dissipation function, or for brevity, the dissipation function of the system.
</p>
<p>The first of these items is discussed below; the latter is only outlined in this
section but is discussed extensively in Sect. 7.8. First, the wrench wWi is decomposed
into two parts, wAi and w
</p>
<p>D
i , the former being the wrench supplied by the actuators
</p>
<p>and the latter being the wrench that arises from viscous and Coulomb friction, the
gravity wrench being not needed here because gravity effects are considered in the
potential V.�/. We thus call wAi the active wrench and w
</p>
<p>D
i the dissipative wrench.
</p>
<p>Here, the wrenches supplied by the actuators are assumed to be prescribed functions
of time. Moreover, these wrenches are supplied by single-dof actuators in the form
of forces along a line of action or moments in a given direction, both line and
direction being fixed to the two bodies that are coupled by an active joint. Hence,
the actuator-supplied wrenches are dependent on the posture of the manipulator
as well, but not on its twist. That is, the actuator wrenches are functions of both
the vector of generalized coordinates, or joint variables, and time, but not of the
generalized speeds, or joint-rates. Forces dependent on the latter to be considered
here are assumed to be all dissipative. As a consequence, they can be readily
incorporated into the mathematical model at hand via the dissipation function, to
be discussed in Sect. 7.8. Note that feedback control schemes require actuator forces
that are functions not only of the generalized coordinates, but also of the generalized
speeds. These forces or moments are most easily incorporated into the underlying
mathematical model, once this model is derived in the state-variable space, i.e., in
the space of generalized coordinates and generalized speeds.
</p>
<p>Thus, the power supplied to the i th link, &hellip;Ai , is readily computed as
</p>
<p>&hellip;Ai D .wAi /T ti (7.12a)
</p>
<p>Similar to the kinetic energy, then, the power supplied to the overall system is
simply the sum of the individual powers supplied to each link, and expressed as in
Eq. (7.12a), i.e.,
</p>
<p>&hellip;A �
r
X
</p>
<p>1
</p>
<p>&hellip;Ai (7.12b)</p>
<p/>
</div>
<div class="page"><p/>
<p>286 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Further definitions are now introduced. These are the 6n-dimensional vectors of
manipulator twist, t; manipulator momentum, �; manipulator constraint wrench,
wC ; manipulator active wrench, wA; and manipulator dissipative wrench, wD .
Additionally, the 6n � 6n matrices of manipulator mass, M, and manipulator
angular velocity, W, are also introduced below:
</p>
<p>t D
</p>
<p>2
</p>
<p>6
4
</p>
<p>t1
:::
</p>
<p>tn
</p>
<p>3
</p>
<p>7
5 ; � D
</p>
<p>2
</p>
<p>6
4
</p>
<p>�1
:::
</p>
<p>�n
</p>
<p>3
</p>
<p>7
5 ; (7.13a)
</p>
<p>wC D
</p>
<p>2
</p>
<p>6
4
</p>
<p>wC1
:::
</p>
<p>wCn
</p>
<p>3
</p>
<p>7
5 ; w
</p>
<p>A D
</p>
<p>2
</p>
<p>6
4
</p>
<p>wA1
:::
</p>
<p>wAn
</p>
<p>3
</p>
<p>7
5 ; w
</p>
<p>D D
</p>
<p>2
</p>
<p>6
4
</p>
<p>wD1
:::
</p>
<p>wDn
</p>
<p>3
</p>
<p>7
5 (7.13b)
</p>
<p>M D diag .M1; : : : ; Mn /; W D diag .W1; : : : ; Wn / (7.13c)
</p>
<p>It is now apparent that, from definitions (7.13b and 7.13c) and relation (7.3), we
have
</p>
<p>� DMt (7.14)
</p>
<p>Moreover, from definitions (7.1) and (7.2),
</p>
<p>P� DMPtCWMt (7.15)
</p>
<p>With the foregoing definitions, then, the kinetic energy of the manipulator takes a
simple form, namely,
</p>
<p>T D 1
2
</p>
<p>tTMt � 1
2
</p>
<p>tT� (7.16)
</p>
<p>which is a quadratic form in the system twist. Since the twist, on the other hand, is
a linear function of the vector P� of joint rates, the kinetic energy turns out to be a
quadratic form in the vector of joint rates. Moreover, we will assume that this form
is homogeneous in P� , i.e.,
</p>
<p>T D 1
2
P�
T
</p>
<p>I.�/ P� (7.17)
</p>
<p>Notice that the above assumption implies that the base of the robot is fixed to an
inertial base, and hence, when all joints are locked, the kinetic energy of the robot
vanishes, which would not be the case if, for example, the robot were mounted on
the International Space Station. If this were the case, then the kinetic energy would
not vanish even if all robot joints were locked, which means that the foregoing</p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Fundamentals of Multibody System Dynamics 287
</p>
<p>kinetic-energy expression would include a linear term in P� and a term independent
of the joint-rates. In any event, it is apparent that
</p>
<p>I.�/ D @
2
</p>
<p>@ P�2
.T / (7.18)
</p>
<p>which means that the n � n generalized inertia matrix is the Hessian matrix of the
kinetic energy with respect to the vector of generalized speed.
</p>
<p>Furthermore, the Euler&ndash;Lagrange equations can be written in the form
</p>
<p>d
</p>
<p>dt
</p>
<p>�
@T
</p>
<p>@ P�
</p>
<p>�
</p>
<p>� @T
@�
C @V
@�
D �n (7.19a)
</p>
<p>Now, from the form of T given in Eq. (7.17), the partial derivatives appearing in the
foregoing equation take the forms derived below:
</p>
<p>@T
</p>
<p>@ P�
D I.�/ P�
</p>
<p>and hence,
</p>
<p>d
</p>
<p>dt
</p>
<p>�
@T
</p>
<p>@ P�
</p>
<p>�
</p>
<p>D I.�/ R� C PI.�; P�/ P� (7.19b)
</p>
<p>Moreover, in order to calculate the second term of the left-hand side of Eq. (7.19a),
we express the kinetic energy in the form
</p>
<p>T D 1
2
</p>
<p>p.�; P�/T P� (7.19c)
</p>
<p>where p.�; P�/ is the generalized momentum of the manipulator, defined as
</p>
<p>p.�; P�/ � I.�/ P� (7.19d)
</p>
<p>Hence,
</p>
<p>@T
</p>
<p>@�
D 1
2
</p>
<p>�
@p
</p>
<p>@�
</p>
<p>�T
</p>
<p>P� (7.19e)
</p>
<p>or
</p>
<p>@T
</p>
<p>@�
D 1
2
</p>
<p>"
</p>
<p>@.I P�/
</p>
<p>@�
</p>
<p>#T
</p>
<p>P� (7.19f)
</p>
<p>the Euler&ndash;Lagrange equations thus taking on the alternative form</p>
<p/>
</div>
<div class="page"><p/>
<p>288 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Fig. 7.1 A planar
manipulator
</p>
<p>I.�/ R� C PI.�; P�/ P� � 1
2
</p>
<p>"
</p>
<p>@.I P�/
</p>
<p>@�
</p>
<p>#T
</p>
<p>P� C @V
@�
D �n (7.20)
</p>
<p>Example 7.3.1 (Euler&ndash;Lagrange Equations of a Planar Robot). Consider the
manipulator of Fig. 7.1, with links designed so that their centers of mass, C1,
C2, and C3, are located at the midpoints of segments O1O2, O2O3, and O3P ,
respectively. Moreover, the i th link has a mass mi and a centroidal moment of
inertia in a direction normal to the plane of motion Ii , while the joints are actuated
by motors delivering torques �1, �2, and �3, the lubricant of the joints producing
dissipative torques that we will neglect in this model. Under the assumption that
gravity acts in the direction of �Y , find the associated Euler&ndash;Lagrange equations.
</p>
<p>Solution: Here we recall the kinematic analysis of Sect. 5.7 and the definitions
introduced therein for the analysis of planar motion. In this light, all vectors
introduced below are two-dimensional, the scalar angular velocities of the links,
!i , for i D 1, 2, 3, being
</p>
<p>!1 D P�1; !2 D P�1 C P�2; !3 D P�1 C P�2 C P�3
</p>
<p>Moreover, the velocities of the centers of mass are</p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Fundamentals of Multibody System Dynamics 289
</p>
<p>Pc1 D
1
</p>
<p>2
P�1Ea1
</p>
<p>Pc2 D P�1Ea1 C
1
</p>
<p>2
. P�1 C P�2/Ea2
</p>
<p>Pc3 D P�1Ea1 C . P�1 C P�2/Ea2 C
1
</p>
<p>2
. P�1 C P�2 C P�3/Ea3
</p>
<p>the kinetic energy then becoming
</p>
<p>T D 1
2
</p>
<p>3
X
</p>
<p>1
</p>
<p>.mikPcik2 C Ii!2i /
</p>
<p>The squared magnitudes of the mass-center velocities are now computed using the
expressions derived above. After simplifications, these yield
</p>
<p>kPc1k2 D
1
</p>
<p>4
a21
P�21
</p>
<p>kPc2k2 D a21 P�21 C
1
</p>
<p>4
a22.
P�21 C 2 P�1 P�2 C P�22 /C a1a2 cos �2. P�21 C P�1 P�2/
</p>
<p>kPc3k2 D a21 P�21 C a22. P�21 C 2 P�1 P�2 C P�22 /
</p>
<p>C1
4
a23.
P�21 C P�22 C P�23 C 2 P�1 P�2 C 2 P�1 P�3 C 2 P�2 P�3/
</p>
<p>C2a1a2 cos �2. P�21 C P�1 P�2/C a1a3 cos.�2 C �3/. P�21 C P�1 P�2 C P�1 P�3/
</p>
<p>Ca2a3 cos �3. P�21 C P�22 C 2 P�1 P�2 C P�1 P�3 C P�2 P�3/
</p>
<p>The kinetic energy of the whole manipulator thus becomes
</p>
<p>T D 1
2
.I11 P�21 C 2I12 P�1 P�2 C 2I23 P�2 P�3 C I22 P�22 C 2I13 P�1 P�3 C I33 P�23 /
</p>
<p>with coefficients Iij , for i D 1, 2, 3, and j D i to 3 being the distinct entries of the
3 � 3 matrix of generalized inertia of the system. These entries are given below:
</p>
<p>I11 � I1 C I2 C I3 C
1
</p>
<p>4
m1a
</p>
<p>2
1 Cm2
</p>
<p>�
</p>
<p>a21 C
1
</p>
<p>4
a22 C a1a2c2
</p>
<p>�
</p>
<p>Cm3
�
</p>
<p>a21 C a22 C
1
</p>
<p>4
a23 C 2a1a2c2 C a1a3c23 C a2a3c3
</p>
<p>�
</p>
<p>I12 � I2 C I3 C
1
</p>
<p>2
</p>
<p>�
</p>
<p>m2
</p>
<p>�
1
</p>
<p>2
a22 C a1a2c2
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>290 7 Dynamics of Serial Robotic Manipulators
</p>
<p>C m3
�
</p>
<p>2a22 C
1
</p>
<p>2
a23 C 2a1a2c2 C a1a3c23 C 2a2a3c3
</p>
<p>��
</p>
<p>I13 � I3 C
1
</p>
<p>2
m3
</p>
<p>�
1
</p>
<p>2
a23 C a1a3c23 C a2a3c3
</p>
<p>�
</p>
<p>I22 � I2 C I3 C
1
</p>
<p>4
m2a
</p>
<p>2
2 Cm3
</p>
<p>�
</p>
<p>a22 C
1
</p>
<p>4
a23 C a2a3c3
</p>
<p>�
</p>
<p>I23 � I3 C
1
</p>
<p>2
m3
</p>
<p>�
1
</p>
<p>2
a23 C a2a3c3
</p>
<p>�
</p>
<p>I33 � I3 C
1
</p>
<p>4
m3a
</p>
<p>2
3
</p>
<p>where ci and cij stand for cos �i and cos.�i C �j /, respectively. From the foregoing
expressions, it is apparent that the generalized inertia matrix is not a function of �1,
which is only natural, for if the second and third joints are locked while leaving the
first one free, the whole manipulator becomes a single rigid body pivoting about
point O1. Now, the polar moment of inertia of a rigid body in planar motion about
a fixed point is constant, and hence, the first joint variable should not affect the
generalized inertia matrix.
</p>
<p>Furthermore, the potential energy of the manipulator is computed as the sum of
the individual link potential energies, i.e.,
</p>
<p>V D 1
2
m1ga1 sin �1 Cm2g
</p>
<p>�
</p>
<p>a1 sin �1 C
1
</p>
<p>2
a2 sin.�1 C �2/
</p>
<p>�
</p>
<p>Cm3g
�
</p>
<p>a1 sin �1 C a2 sin.�1 C �2/C
1
</p>
<p>2
a3 sin.�1 C �2 C �3/
</p>
<p>�
</p>
<p>while the total power delivered to the manipulator takes the form
</p>
<p>&hellip; D �1 P�1 C �2 P�2 C �3 P�3
</p>
<p>We now proceed to compute the various terms in Eq. (7.20). We already have
I.�/, but we do not have, as yet, its time-derivative. However, the entries of PI are
merely the time-derivatives of the entries of I. From the above expressions for these
entries, their time-rates of change are readily calculated, namely,
</p>
<p>PI11 D �m2a1a2s2 P�2 �m3Œ2a1a2s2 P�2 C a1a3s23. P�2 C P�3/C a2a3s3 P�3&#141;
</p>
<p>PI12 D
1
</p>
<p>2
f�m2a1a2s2 P�2 �m3Œ2a1a2s2 P�2 C a1a3s23. P�2 C P�3/C 2a2a3s3 P�3&#141;g
</p>
<p>PI13 D �
1
</p>
<p>2
m3Œa1a3s23. P�2 C P�3/C a2a3s3 P�3&#141;</p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Fundamentals of Multibody System Dynamics 291
</p>
<p>PI22 D �m3a2a3s3 P�3
</p>
<p>PI23 D �
1
</p>
<p>2
m3a2a3s3 P�3
</p>
<p>PI33 D 0
</p>
<p>with sij defined as sin.�i C �j /. It should now be apparent that the time-rate of
change of the generalized inertia matrix is independent of P�1, as one should have
expected, for this matrix is independent of �1. That is, if all joints but the first one
are frozen, no matter how fast the first joint rotates, the manipulator moves as a
single rigid body whose polar moment of inertia about O1, the center of the first
joint, is constant. As a matter of fact, I33 is constant for the same reason and PI33
hence vanishes. We have, then,2
</p>
<p>PI P� � � D
</p>
<p>2
</p>
<p>4
</p>
<p>PI11 P�1 C PI12 P�2 C PI13 P�3
PI12 P�1 C PI22 P�2 C PI23 P�3
PI13 P�1 C PI23 P�2
</p>
<p>3
</p>
<p>5
</p>
<p>whose components, �i , for i D 1, 2, 3, are readily calculated as
</p>
<p>�1 D �Œm2a1a2s2 Cm3a1.2a2s2 C a3s23/&#141; P�1 P�2 �m3a3.a1s23 C a2s3/ P�1 P�3
</p>
<p>�1
2
Œm2a1a2s2 Cm3a1.2a2s2 C a3s23/&#141; P�22 �m3a3.a1s23 C a2s3/ P�2 P�3
</p>
<p>�1
2
m3a3.a1s23 C a2s3/ P�23
</p>
<p>�2 D �
1
</p>
<p>2
Œm2a1a2s2 Cm3a1.2a2s2 C a3s23/&#141; P�1 P�2
</p>
<p>�1
2
m3a3.a1s23 C a2s3/ P�1 P�3 �m3a2a3s3 P�2 P�3 �
</p>
<p>1
</p>
<p>2
m3a2a3s3 P�23
</p>
<p>�3 D �
1
</p>
<p>2
m3a1a3s23 P�1 P�2 �
</p>
<p>1
</p>
<p>2
m3a3.a1s23 C a2s3/ P�1 P�3 �
</p>
<p>1
</p>
<p>2
m3a2a3s3 P�2 P�3
</p>
<p>The next term in the right-hand side of Eq. (7.20) now requires the calculation
of the partial derivatives of vector I P� with respect to the joint variables, which are
computed below. Let
</p>
<p>@.I P�/
@�
</p>
<p>� I0
</p>
<p>2� is the Greek letter iota and denotes a vector; according to our notation, its components are �1, �2,
and �3.</p>
<p/>
</div>
<div class="page"><p/>
<p>292 7 Dynamics of Serial Robotic Manipulators
</p>
<p>its entries being denoted by I 0ij . This matrix, in component form, is given by
</p>
<p>I0 D
</p>
<p>2
</p>
<p>4
</p>
<p>0 I11;2 P�1 C I12;2 P�2 C I13;2 P�3 I11;3 P�1 C I12;3 P�2 C I13;3 P�3
0 I12;2 P�1 C I22;2 P�2 C I23;2 P�3 I12;3 P�1 C I22;3 P�2 C I23;3 P�3
0 I13;2 P�1 C I23;2 P�2 C I33;2 P�3 I13;3 P�1 C I23;3 P�2 C I33;3 P�3
</p>
<p>3
</p>
<p>5
</p>
<p>with the shorthand notation Iij;k indicating the partial derivative of Iij with respect
to �k . As the reader can verify, these entries are given as
</p>
<p>I 011 D 0
</p>
<p>I 012 D �Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�1
</p>
<p>�1
2
Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�2 �
</p>
<p>1
</p>
<p>2
m3a1a3s23 P�3
</p>
<p>I 013 D �m3.a1a3s23 C a2a3s3/ P�1 �
1
</p>
<p>2
m3.a1a3s23 C 2a2a3s3/ P�2
</p>
<p>�1
2
m3.a1a3s23 C a2a3s3/ P�3
</p>
<p>I 021 D 0
</p>
<p>I 022 D �
1
</p>
<p>2
Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�1
</p>
<p>I 023 D �
1
</p>
<p>2
m3.a1a3s23 C 2a2a3s3/ P�1 �m3a2a3s3 P�2 �
</p>
<p>1
</p>
<p>2
m3a2a3s3 P�3
</p>
<p>I 031 D 0
</p>
<p>I 032 D �
1
</p>
<p>2
m3a1a3s23 P�1
</p>
<p>I 033 D �
1
</p>
<p>2
m3.a1a3s23 C a2a3s3/ P�1 �
</p>
<p>1
</p>
<p>2
m3a2a3s3 P�2
</p>
<p>Now, we define the three-dimensional vector &#13; below:
</p>
<p>&#13; �
"
</p>
<p>@.I P�/
@�
</p>
<p>#T
</p>
<p>P�
</p>
<p>its three components, &#13;i , for i D 1, 2, 3, being
</p>
<p>&#13;1 D 0
&#13;2 D �Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�21
</p>
<p>�Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�1 P�2</p>
<p/>
</div>
<div class="page"><p/>
<p>7.3 Fundamentals of Multibody System Dynamics 293
</p>
<p>�m3a1a3s23 P�1 P�3
&#13;3 D �m3.a1a3s23 C a2a3s3/ P�21 �m3.a1a3s23 C 2a2a3s3/ P�1 P�2
</p>
<p>�m3.a1a3s23 C a2a3s3/ P�1 P�3 �m3a2a3s3 P�23 �m3a2a3s3 P�2 P�3
</p>
<p>We now turn to the computation of the partial derivatives of the potential energy:
</p>
<p>@V
</p>
<p>@�1
D 1
2
m1ga1c1 Cm2g
</p>
<p>�
</p>
<p>a1c1 C
1
</p>
<p>2
a2c12
</p>
<p>�
</p>
<p>Cm3g
�
</p>
<p>a1c1 C a2c12 C
1
</p>
<p>2
a3c123
</p>
<p>�
</p>
<p>@V
</p>
<p>@�2
D 1
2
m2ga2c12 Cm3g
</p>
<p>�
</p>
<p>a2c12 C
1
</p>
<p>2
a3c123
</p>
<p>�
</p>
<p>@V
</p>
<p>@�3
D 1
2
m3ga3c123
</p>
<p>The Euler&ndash;Lagrange equations thus reduce to
</p>
<p>I11 R�1 C I12 R�2 C I13 R�3 C �1 �
1
</p>
<p>2
&#13;1 C
</p>
<p>1
</p>
<p>2
m1ga1c1
</p>
<p>Cm2g.a1c1 C
1
</p>
<p>2
a2c12/Cm3g.a1c1 C a2c12 C
</p>
<p>1
</p>
<p>2
a3c123/ D �1
</p>
<p>I12 R�1 C I22 R�2 C I23 R�3 C �2 �
1
</p>
<p>2
&#13;2 C
</p>
<p>1
</p>
<p>2
m2ga2c12
</p>
<p>Cm3g.a2c12 C
1
</p>
<p>2
a3c123/ D �2
</p>
<p>I13 R�1 C I23 R�2 C I33 R�3 C �3 �
1
</p>
<p>2
&#13;3 C
</p>
<p>1
</p>
<p>2
m3ga3c123 D �3
</p>
<p>With this example, it becomes apparent that a straightforward differentiation
procedure to derive the Euler&ndash;Lagrange equations of a robotic manipulator, or
for that matter, of a mechanical system at large, is not practical. For example,
these equations do not seem to lend themselves to symbolic manipulations for
a six-axis manipulator of arbitrary architecture, given that they become quite
cumbersome even for a three-axis planar manipulator with an architecture that is not
so general. For this reason, procedures have been devised that lend themselves to an
algorithmic treatment. We will study a procedure based on the natural orthogonal
complement whereby the underlying equations are derived using matrix-times-
vector multiplications.
</p>
<p>7.3.3 Kane&rsquo;s Equations
</p>
<p>Kane&rsquo;s equations (Kane and Levinson 1983), sometimes referred to as D&rsquo;Alembert&rsquo;s
equations in Lagrangian form are also useful in robot dynamics (Angeles et al. 1989).</p>
<p/>
</div>
<div class="page"><p/>
<p>294 7 Dynamics of Serial Robotic Manipulators
</p>
<p>A feature of Kane&rsquo;s equations is that they are derived from the free-body diagrams
of the various rigid bodies constituting the multibody system at hand. Upon
introducing generalized coordinates &agrave; la Lagrange, the mathematical model of the
system is derived, which is equivalent to the underlying Euler&ndash;Lagrange equations.
Kane&rsquo;s equations take a rather simple form, for an n-dof mechanical system, namely,
</p>
<p>�C �� D 0
</p>
<p>where� and�� are the n-dimensional vectors of generalized active force and inertia
force, respectively. With the notation introduced above, these vectors are given by
</p>
<p>� D
r
X
</p>
<p>iD1
</p>
<p>"
�
@Pci
@ Pq
</p>
<p>�T
</p>
<p>fi C
�
@!i
</p>
<p>@ Pq
</p>
<p>�T
</p>
<p>ni
</p>
<p>#
</p>
<p>(7.21a)
</p>
<p>and
</p>
<p>�� D �
r
X
</p>
<p>iD1
</p>
<p>"
�
@Pci
@ Pq
</p>
<p>�T
</p>
<p>mi Rci C
�
@!i
</p>
<p>@ Pq
</p>
<p>�T
</p>
<p>.Ii P!i C!i � Ii!i /
#
</p>
<p>: (7.21b)
</p>
<p>In the above expressions, Pq D dq=dt is the n-dimensional vector of generalized
speeds in Kane&rsquo;s terminology, while the n � 3 matrices @Pci=@ Pq and @!i=@ Pq are the
partial rates of change of mass-center velocity and angular velocity of the i th rigid
body.
</p>
<p>7.4 Recursive Inverse Dynamics
</p>
<p>The inverse dynamics problem associated with serial manipulators is studied here.
We assume at the outset that the manipulator under study is of the serial type with
nC1 links including the base link and n joints of either the revolute or the prismatic
type.
</p>
<p>The underlying algorithm consists of two steps: (a) kinematic computations,
required to determine the twists of all the links and their time derivatives in terms
of � , P� , and R�; and (b) dynamic computations, required to determine both the
constraint and the external wrenches. Each of these steps is described below, the
aim here being to calculate the desired variables with as few computations as
possible, for one purpose of inverse dynamics is to permit the real-time model-
based control of the manipulator. Real-time performance requires, obviously, a low
number of computations. For the sake of simplicity, we decided against discussing
the algorithms with the lowest computational cost, mainly because these algorithms,
fully discussed by Balafoutis and Patel (1991), rely heavily on tensor calculus,
which we have not studied here. With the notation introduced in Chap. 4, revolute
joints are referred to as R, prismatic joints as P.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.4 Recursive Inverse Dynamics 295
</p>
<p>7.4.1 Kinematics Computations: Outward Recursions
</p>
<p>We will use the Denavit&ndash;Hartenberg (DH) notation introduced in Sect. 4.2 and hence
will refer to Fig. 4.9 for the basic notation required for the kinematic analysis to be
described first. Note that the calculation of each Qi matrix, as given by Eq. (4.1e),
requires four multiplications and zero additions.
</p>
<p>Moreover, every three-dimensional vector-component transfer from the Fi frame
to the FiC1 frame requires a multiplication by QTi . Likewise, every component
transfer from the FiC1 frame to the Fi frame requires a multiplication by Qi .
Therefore, we will need to account for the aforementioned component transfers,
which we will generically term coordinate transformations between successive
coordinate frames. We derive below the number of operations required for such
transformations. If we have Œ r &#141;i � Œ r1; r2; r3 &#141;T and we need Œ r &#141;iC1, then we
proceed as follows:
</p>
<p>Œ r &#141;iC1 D QTi Œ r &#141;i (7.22)
</p>
<p>and if we recall the form of Qi from Eq. (4.1e), we then have
</p>
<p>Œ r &#141;iC1 D
</p>
<p>2
</p>
<p>4
</p>
<p>cos �i sin �i 0
��i sin �i �i cos �i �i
�i sin �i ��i cos �i �i
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>r1
r2
r3
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>r1 cos �i C r2 sin �i
��ir C �ir3
�ir C �ir3
</p>
<p>3
</p>
<p>5 (7.23a)
</p>
<p>where �i � cos˛i and �i � sin˛i , while
</p>
<p>r � r1 sin �i � r2 cos �i (7.23b)
</p>
<p>Likewise, if we have Œ v &#141;iC1 � Œ v1; v2; v3 &#141;T and we need Œ v &#141;i , we use the
component transformation given below:
</p>
<p>Œ v &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>cos �i ��i sin �i �i sin �i
sin �i �i cos �i ��i cos �i
0 �i �i
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>v1
v2
v3
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>v1 cos �i � v sin �i
v1 sin �i C v cos �i
v2�i C v3�i
</p>
<p>3
</p>
<p>5 (7.24a)
</p>
<p>where
</p>
<p>v � v2�i � v3�i (7.24b)
</p>
<p>It is now apparent that every coordinate transformation between successive
frames, whether forward or backward, requires eight multiplications and four
</p>
<p>additions. Here, as in Chap. 5, we indicate the units of multiplications and additions
with M and A, respectively.</p>
<p/>
</div>
<div class="page"><p/>
<p>296 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Fig. 7.2 A revolute joint
</p>
<p>The angular velocity and acceleration of the i th link are computed recursively as
follows:
</p>
<p>!i D
(
</p>
<p>!i�1 C P�iei ; if the i th joint is R
!i�1; if the i th joint is P
</p>
<p>(7.25a)
</p>
<p>P!i D
(
</p>
<p>P!i�1 C!i�1 � P�iei C R�iei ; if the i th joint is R
P!i�1; if the i th joint is P
</p>
<p>(7.25b)
</p>
<p>for i D 1; 2; : : : ; n, where !0 and P!0 are the angular velocity and angular
acceleration of the base link. Note that Eqs. (7.25a and b) are frame-invariant;
i.e., they are valid in any coordinate frame, as long as the same frame is used to
represent all quantities involved. Below we derive the equivalent relations applicable
when taking into account that quantities with a subscript i are available in FiC1-
coordinates. Hence, operations involving quantities with different subscripts require
a change of coordinates, which is taken care of by the corresponding rotation
matrices.
</p>
<p>In order to reduce the numerical complexity of the algorithm developed here,
all vector and matrix quantities of the i th link will be expressed in FiC1. Note,
however, that the two vectors ei and eiC1 are fixed to the i th link, which is a potential
source of confusion. Now, since ei has an extremely simple form in Fi , namely,
Œ 0; 0; 1 &#141;T , this will be regarded as a vector of the .i � 1/st link, which is fixed
to Fi&mdash;see, e.g., Fig. 7.2. Therefore, this vector, or multiples of it, will be added
to vectors bearing the .i � 1/st subscript without any coordinate transformation.
Moreover, subscripted brackets, as introduced in Sect. 2.2, can be avoided if all</p>
<p/>
</div>
<div class="page"><p/>
<p>7.4 Recursive Inverse Dynamics 297
</p>
<p>vector and matrix quantities subscripted with i , except for vector ei , are assumed
to be expressed in FiC1. Furthermore, in view of the serial type of the underlying
kinematic chain, only additions of quantities with two successive subscripts will
appear in the relations below.
</p>
<p>Quantities given in two successive frames can be added if both are expressed
in the same frame, the obvious frame of choice being the frame of one of the two
quantities. Hence, all we need to add two quantities with successive subscripts is
to multiply one of these by a suitable orthogonal matrix. Additionally, in view of
the outwards recursive nature of the foregoing kinematic relations, it is apparent
that a transfer from Fi - to FiC1-coordinates is needed, which can be accomplished
by multiplying either ei or any other vector with the .i � 1/ subscript by matrix
QTi . Hence, the angular velocities and accelerations are computed recursively, as
indicated below:
</p>
<p>!i D
(
</p>
<p>QTi .!i�1 C P�iei /; if the i th joint is R
QTi !i�1; if the i th joint is P
</p>
<p>(7.26a)
</p>
<p>P!i D
(
</p>
<p>QTi . P!i�1 C!i�1 � P�iei C R�iei /; if the i th joint is R
QTi P!i�1; if the i th joint is P
</p>
<p>(7.26b)
</p>
<p>If the base link is an inertial frame, then
</p>
<p>!0 D 0; P!0 D 0 (7.27)
</p>
<p>Thus, calculating each !i vector in FiC1 when !i�1 is given in Fi requires 8M
and 5A if the i th joint is R; if it is P, the said calculation reduces to 8M and 4A.
Here, note that P�iei D Œ 0; 0; P�i &#141;T in Fi -coordinates, and hence, the vector addition
of the upper right-hand side of Eq. (7.26a) requires only 1A. Furthermore, in order
to determine the number of operations required to calculate P!i in FiC1 when P!i�1
is available in Fi , we note that
</p>
<p>Œ ei &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5 (7.28)
</p>
<p>Moreover, we let
</p>
<p>Œ!i�1 &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>!x
!y
!z
</p>
<p>3
</p>
<p>5 (7.29)
</p>
<p>Hence,</p>
<p/>
</div>
<div class="page"><p/>
<p>298 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Fig. 7.3 A prismatic joint
</p>
<p>Œ!i�1 � P�iei &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>P�i !y
� P�i !x
0
</p>
<p>3
</p>
<p>5 (7.30)
</p>
<p>Furthermore, we note that
</p>
<p>Œ R�iei &#141;i D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
R�i
</p>
<p>3
</p>
<p>5 (7.31)
</p>
<p>and hence, the calculation of P!i in FiC1 when P!i�1 is given in Fi requires 10M
and 7A if the i th joint is R; if it is P, the same calculation requires 8M and 4A.
</p>
<p>Furthermore, let ci be the position vector of Ci , the center of mass of the i th
link, �i being the vector directed from Oi to Ci , as shown in Figs. 7.2 and 7.3. The
position vectors of two successive centers of mass thus observe the relationships
</p>
<p>(a) if the i th joint is R, then from Fig. 7.2,
</p>
<p>ıi�1 � ai�1 � �i�1 (7.32a)
ci D ci�1 C ıi�1 C �i (7.32b)
</p>
<p>(b) if the i th joint is P, then from Fig. 7.3,
</p>
<p>ıi�1 � di�1 � �i�1 (7.32c)
ci D ci�1 C ıi�1 C biei C �i (7.32d)</p>
<p/>
</div>
<div class="page"><p/>
<p>7.4 Recursive Inverse Dynamics 299
</p>
<p>where point Oi , in this case, is a point of the .i � 1/st link conveniently defined,
as dictated by the particular geometry of the manipulator at hand. The foregoing
freedom in the choice of Oi is a consequence of prismatic pairs having only a
defined direction but no axis, properly speaking.
</p>
<p>Notice that in the presence of a revolute pair at the i th joint, the difference
ai�1 � �i�1 is constant in Fi . Likewise, in the presence of a prismatic pair at the
same joint, the difference di�1��i�1 is constant in Fi . Therefore, these differences
are computed off-line, their evaluation not counting toward the computational
complexity of the algorithm.
</p>
<p>Upon differentiation of both sides of Eqs. (7.32b and d) with respect to time, we
derive the corresponding relations between the velocities and accelerations of the
centers of mass links i � 1 and i , namely,
(a) if the i th joint is R,
</p>
<p>Pci D Pci�1 C!i�1 � ıi�1 C!i � �i (7.33a)
</p>
<p>Rci D Rci�1 C P!i�1 � ıi�1 C!i�1 � .!i�1 � ıi�1/C P!i � �i C
!i � .!i � �i / (7.33b)
</p>
<p>(b) if the i th joint is P,3
</p>
<p>!i D !i�1 (7.34a)
</p>
<p>P!i D P!i�1 (7.34b)
</p>
<p>ui � ıi�1 C biei C �i (7.34c)
</p>
<p>vi � !i � ui (7.34d)
</p>
<p>Pci D Pci�1 C vi C Pbiei (7.34e)
</p>
<p>Rci D Rci�1 C P!i � ui C!i � .vi C 2 Pbiei /C Rbiei (7.34f)
</p>
<p>for i D 1; 2; : : : ; n, where Pc0 and Rc0 are the velocity and acceleration of the
center of mass the base link. If the latter is an inertial frame, then
</p>
<p>!0 D 0; P!0 D 0; Pc0 D 0; Rc0 D 0 (7.35)
</p>
<p>Expressions (7.32b)&ndash;(7.34f) are invariant, i.e., they hold in any coordinate
frame, as long as all vectors involved are expressed in that frame. However,
we have vectors that are naturally expressed in the Fi frame added to vectors
</p>
<p>3The relations below are made apparent with the aid of Fig. 4.6.</p>
<p/>
</div>
<div class="page"><p/>
<p>300 7 Dynamics of Serial Robotic Manipulators
</p>
<p>expressed in the FiC1 frame, and hence, a coordinate transformation is needed.
This coordinate transformation is taken into account in Algorithm 7.4.1,
whereby the logical variable R is true if the i th joint is R; otherwise it is
false.
</p>
<p>In performing the foregoing calculations, we need the cross product of a vector
w times ei in Fi coordinates, the latter being simply Œ ei &#141;i D Œ 0; 0; 1 &#141;T , and hence,
this cross product reduces to Œw2; �w1; 0 &#141;T , whereby wk , for k D 1; 2; 3, are the x,
y, and z Fi -components of w. This cross product, then, requires no multiplications
and no additions. Likewise, vectors biei , Pbiei , and Rbiei take the simple forms
Œ 0; 0; bi &#141;
</p>
<p>T , Œ 0; 0; Pbi &#141;T , and Œ 0; 0; Rbi &#141;T in Fi . Adding any of these vectors to any
other vector in Fi then requires one single addition.
</p>
<p>Algorithm 7.4.1 (Outward Recursions):
</p>
<p>read fQi gn�10 ; c0; !0; Pc0; P!0; Rc0; f�ign1 ; fıign�10
For i D 1 to n step 1 do
</p>
<p>update Qi
if R then
</p>
<p>ci  QTi .ci�1 C ıi�1/C �i
!i  QTi .!i�1 C P�iei )
ui�1 !i�1 � ıi�1
vi  !i � �i
Pci  QTi .Pci�1 C ui�1/C vi
P!i  QTi . P!i�1 C!i�1 � P�iei C R�iei )
Rci  QTi .Rci�1 C P!i�1 � ıi�1 C!i�1 � ui�1/
</p>
<p>C P!i � �i C!i � vi
else
</p>
<p>ui  QTi ıi�1 C �i C biei
ci  QTi ci�1 C ui
!i  QTi !i�1
vi  !i � ui
wi  Pbiei
Pci  QTi Pci�1 C vi C wi
P!i  QTi P!i�1
Rci  QTi Rci�1 C P!i � ui C!i � .vi C wi C wi /C Rbiei
</p>
<p>endif
</p>
<p>enddo
</p>
<p>If, moreover, we take into account that the cross product of two arbitrary vectors
requires 6M and 3A, we then have the operation counts given below:
</p>
<p>(a) If the i th joint is R,
Qi requires 4M and 0A
ci requires 8M and 10A
!i requires 8M and 5A</p>
<p/>
</div>
<div class="page"><p/>
<p>7.4 Recursive Inverse Dynamics 301
</p>
<p>Table 7.1 Complexity of the
kinematics computations
</p>
<p>Item M A
</p>
<p>fQign1 4n 0
f!ign1 8n 5n
fPcign1 20n 16n
f P!ign1 10n 7n
fRcign1 32n 28n
Total 82n 66n
</p>
<p>Pci requires 20M and 16A
P!i requires 10M and 7A
Rci requires 32M and 28A
</p>
<p>(b) If the i th joint is P,
Qi requires 4M and 0A
ci requires 16M and 15A
!i requires 8M and 4A
Pci requires 14M and 11A
P!i requires 8M and 4A
Rci requires 20M and 19A
</p>
<p>The computational complexity for the forward recursions of the kinematics cal-
culations for an n-revolute manipulator, as pertaining to various algorithms, are
summarized in Table 7.1. Note that if some joints are P, then these figures become
lower.
</p>
<p>7.4.2 Dynamics Computations: Inward Recursions
</p>
<p>The free-body diagram of an intermediate link appears in Fig. 7.4, that of the end-
effector, or nth link, appearing in Fig. 7.5. Note that the EE is acted upon by a non-
working constraint wrench, exerted through the nth pair, and a working wrench; the
latter involves both active and dissipative forces and moments. Although dissipative
forces and moments are difficult to model because of dry friction and striction, they
can be readily incorporated into the dynamics model, once a suitable constitutive
model for these items is available. Since these forces and moments depend only on
joint variables and joint rates, they can be calculated once the kinematic variables
are known. For the sake of simplicity, dissipative wrenches are not included here,
their discussion being the subject of Sect. 7.8. Hence, the force and the moment that
the .i�1/st link exerts on the i th link through the i th joint only produce nonworking
constraint and active wrenches. That is, for a revolute pair, one has
</p>
<p>nPi D
</p>
<p>2
</p>
<p>4
</p>
<p>nxi
n
y
i
</p>
<p>�i
</p>
<p>3
</p>
<p>5 ; fPi D
</p>
<p>2
</p>
<p>4
</p>
<p>f xi
f
y
i
</p>
<p>f zi
</p>
<p>3
</p>
<p>5 (7.36)</p>
<p/>
</div>
<div class="page"><p/>
<p>302 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Fig. 7.4 Free-body diagram of the i th link
</p>
<p>Fig. 7.5 Free-body diagram of the end-effector
</p>
<p>in which nxi and n
y
i are the nonzero Fi -components of the nonworking constraint
</p>
<p>moment exerted by the .i � 1/st link on the i th link; obviously, this moment lies in
a plane perpendicular to Zi , whereas �i is the active torque applied by the motor at
the said joint. Vector fPi contains only nonworking constraint forces.
</p>
<p>For a prismatic pair, one has
</p>
<p>nP D
</p>
<p>2
</p>
<p>4
</p>
<p>nxi
n
y
i
</p>
<p>nzi
</p>
<p>3
</p>
<p>5 ; fP D
</p>
<p>2
</p>
<p>4
</p>
<p>f xi
f
y
i
</p>
<p>�i
</p>
<p>3
</p>
<p>5 (7.37)</p>
<p/>
</div>
<div class="page"><p/>
<p>7.4 Recursive Inverse Dynamics 303
</p>
<p>where vector nPi contains only nonworking constraint torques, while �i is now the
active force exerted by the i th motor in the Zi direction, f xi and f
</p>
<p>y
i being the
</p>
<p>nonzero Fi -components of the nonworking constraint force exerted by the i th joint
on the i th link, which is perpendicular to the Zi axis.
</p>
<p>In the algorithm below, the driving torques or forces f �i gn1 , are computed via
vectors nPi and f
</p>
<p>P
i . In fact, in the case of a revolute pair, �i is simply the third
</p>
<p>component of nPi ; in the case of a prismatic pair, �i is, accordingly, the third
component of fPi . From Fig. 7.5, the Newton&ndash;Euler equations of the end-effector are
</p>
<p>fPn D mn Rcn � f (7.38a)
nPn D In P!n C!n � In!n � nC �n � fPn (7.38b)
</p>
<p>where f and n are the external force and moment, the former being applied at the
center of mass the end-effector. The Newton&ndash;Euler equations for the remaining
links are derived based on the free-body diagram of Fig. 7.4, namely,
</p>
<p>fPi D mi Rci C fPiC1 (7.38c)
</p>
<p>nPi D Ii P!i C!i � Ii!i C nPiC1 C ıi � fPiC1 C �i � fPi (7.38d)
</p>
<p>with ıi defined as the difference ai � �i in Eqs. (7.32a and c).
Once the nPi and f
</p>
<p>P
i vectors are available, the actuator torques and forces, denoted
</p>
<p>by �i , are readily computed. In fact, if the i th joint is a revolute, then
</p>
<p>�i D eTi nPi (7.39)
</p>
<p>which does not require any further operations, for �i reduces, in this case, to
the Zi component of vector nPi . Similarly, if the i th joint is prismatic, then the
corresponding actuator force reduces to
</p>
<p>�i D eTi fPi (7.40)
</p>
<p>Again, the foregoing relations are written in invariant form. In order to perform
the computations involved, transformations that transfer coordinates between two
successive frames are required. Here, we have to keep in mind that the components
of a vector expressed in the .i C 1/st frame can be transferred to the i th frame by
multiplying the vector array in .i C 1/st coordinates by matrix Qi . In taking these
coordinate transformations into account, we derive the Newton&ndash;Euler algorithm
from the above equations, namely,</p>
<p/>
</div>
<div class="page"><p/>
<p>304 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Table 7.2 Complexity of
dynamics computations
</p>
<p>Row # M A
</p>
<p>1 3 3
2 30 27
5 8.n� 1/ 4.n� 1/
6 3.n� 1/ 3.n� 1/
7 44.n� 1/ 37.n� 1/
Total 55n� 22 44n� 14
</p>
<p>Algorithm 7.4.2 (Inward Recursions):
</p>
<p>fPn  mn Rcn � f
nPn  In P!n C!n � In!n � nC �n � fPn
If R then
</p>
<p>�n  .QnnPn /z
else
</p>
<p>�n  .QnfPn /z
For i=n-1 to 1 step �1 do
</p>
<p>�iC1  QiC1fPiC1
fPi  mi Rci C �iC1
nPi  Ii P!i C!i � Ii!i C �i � fPi CQiC1nPiC1 C ıi � �iC1
</p>
<p>If R then
</p>
<p>�i  .QinPi /z
else
</p>
<p>�i  .Qi fPi /z enddo
</p>
<p>Note that, within the do-loop of the foregoing algorithm, the vectors to the left
of the arrow are expressed in the i th frame, while fPiC1 and n
</p>
<p>P
iC1, to the right of the
</p>
<p>arrow, are expressed in the .i C 1/st frame.
In calculating the computational complexity of this algorithm, note that the ai��i
</p>
<p>term is constant in the .i C 1/st frame, and hence, it is computed off-line. Thus, its
computation need not be accounted for. A summary of computational costs is given
in Table 7.2 for an n-revolute manipulator, with the row number4 indicating the step
in Algorithm 7.4.2.
</p>
<p>The total numbers of multiplications Md and additions Ad required by the
foregoing algorithm are readily obtained, with the result shown below:
</p>
<p>Md D 55n � 22; Ad D 44n � 14 (7.41)
</p>
<p>In particular, for a six-revolute manipulator, one has
</p>
<p>n D 6; Md D 308; Ad D 250 (7.42)
</p>
<p>4Only rows involving floating-point operations are counted here.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.4 Recursive Inverse Dynamics 305
</p>
<p>Table 7.3 Complexity of different algorithms for inverse dynamics
</p>
<p>Author(s) Methods Multiplications Additions
</p>
<p>Hollerbach (1980) E&ndash;L 412n� 277 320n� 201
Luh et al. (1980) N&ndash;E 150n� 48 131n� 48
Walker and Orin (1982) N&ndash;E 137n� 22 101n� 11
Khalil et al. (1986) N&ndash;E 105n� 92 94n� 86
Angeles et al. (1989) Kane 105n� 109 90n� 105
Balafoutis and Patel (1991) Tensor 93n� 69 81n� 65
Li and Sankar (1992) E&ndash;L 88n� 69 76n� 66
</p>
<p>If the kinematics computations are accounted for, then the Newton&ndash;Euler
algorithm given above for the inverse dynamics of n-revolute manipulators requires
M multiplications and A additions, as given below:
</p>
<p>M D 137n � 22; A D 110n � 14 (7.43)
</p>
<p>The foregoing number of multiplications is identical to that reported by Walker and
Orin (1982); however, the number of additions is slightly higher than Walker and
Orin&rsquo;s figure, namely, 101n � 11.
</p>
<p>Thus, the inverse dynamics of a six-revolute manipulator requires 800 multi-
plications and 646 additions. These computations can be performed in a few
microseconds using a modern processor. Clearly, if the aforementioned algorithms
are tailored to suit particular architectures, then they can be further simplified. Note
that, in the presence of a prismatic pair in the j th joint, the foregoing complexity
is reduced. In fact, if this is the case, the Newton&ndash;Euler equations for the j th link
remain as in Eqs. (7.38c and d) for the i th link, the only difference appearing in
the implementing algorithm, which is simplified, in light of the results derived in
discussing the kinematics calculations.
</p>
<p>The incorporation of gravity in the Newton&ndash;Euler algorithm is done most
economically by following the idea proposed by Luh et al. (1980), namely, by
declaring that the inertial base undergoes an acceleration �g, where g denotes the
acceleration of gravity. That is
</p>
<p>Rc0 D �g (7.44)
</p>
<p>the gravitational accelerations thus propagating forward to the EE. A comparison
of various algorithms with regard to their computational complexity is displayed
in Table 7.3 for an n-revolute manipulator. For n D 6, the corresponding figures
appear in Table 7.4.</p>
<p/>
</div>
<div class="page"><p/>
<p>306 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Table 7.4 Complexity of different algorithms for inverse dynamics, for
n D 6
</p>
<p>Multiplications Additions
Author(s) Methods (n D 6) (n D 6)
Hollerbach (1980) E&ndash;L 2195 1719
Luh et al. (1980) N&ndash;E 852 738
Walker and Orin (1982) N&ndash;E 800 595
Hollerbach and Sahar (1983) N&ndash;E 688 558
Kane and Levinson (1983) Kane 646 394
Khalil et al. (1986) N&ndash;E 538 478
Angeles et al. (1989) Kane 521 435
Balafoutis and Patel (1991) Tensor 489 420
Li and Sankar (1992) E&ndash;L 459 390
</p>
<p>7.5 The Natural Orthogonal Complement
</p>
<p>In simulation studies, we need to integrate the system of ordinary differential
equations (ODE) describing the dynamics of a robotic mechanical system. This
system is known as the mathematical model of the system at hand. Note that the
Newton&ndash;Euler equations derived above for a serial manipulator do not constitute the
mathematical model because we cannot use the recursive relations derived therein
to set up the underlying ODE directly. What we need is a model relating the state of
the system with its external generalized forces, of the form
</p>
<p>Px D f.x;u/; x.t0/ D x0 (7.45)
</p>
<p>where x is the state vector, u is the input or control vector, x0 is the state vector
at a certain time t0, and f.x;u/ is a nonlinear function of x and u, derived from the
dynamics of the system. The state of a dynamical system is defined, in turn, as the
set of variables that separate the past from the future of the system (Bryson and
Ho 1975). Thus, if we take t0 as the present time, we can predict from Eqs. (7.45)
the future states of the system upon integration of the initial-value problem at hand,
even if we do not know the complete past history of the system in full detail. Now,
if we regard the vector � of independent joint variables and its time-rate of change,
P� , as the vectors of generalized coordinates and generalized speeds, then an obvious
definition of x is
</p>
<p>x �
h
</p>
<p>�T P�T
iT
</p>
<p>(7.46)
</p>
<p>The n generalized coordinates, then, define the configuration of the system, while
their time-derivatives determine its generalized momentum, a concept defined in
Eq. (7.19d). Hence, knowing � and P� at t0, we can predict the future values of these
variables, at t &gt; t0, with the aid of Eqs. (7.45).</p>
<p/>
</div>
<div class="page"><p/>
<p>7.5 The Natural Orthogonal Complement 307
</p>
<p>Below we will derive the mathematical model, Eq. (7.45), explicitly, as pertaining
to serial manipulators, in terms of the kinematic structure of the system and its
inertial properties, i.e., the mass, center of mass coordinates, and inertia matrix of
each of its bodies. To this end, we first write the underlying system of uncoupled
Newton&ndash;Euler equations for each link. We have n C 1 links numbered from 0 to
n, which are coupled by n kinematic pairs. Moreover, the base link 0 need not
be an inertial frame; if it is noninertial, then the force and moment exerted by the
environment upon it must be known. For ease of presentation, we will assume in
this section that the base frame is inertial, the modifications needed to handle a
noninertial base frame to be introduced in Sect. 7.5.2.
</p>
<p>We now recall the Newton&ndash;Euler equations of the i th body in six-dimensional
form, Eqs. (7.5c), which we reproduce below for quick reference:
</p>
<p>Mi Pti D �WiMi ti C wWi C wCi ; i D 1; : : : ; n (7.47)
</p>
<p>Furthermore, the definitions of Eqs. (7.13b and c) are recalled. Apparently, M and
W are now 6n � 6n matrices, while t, wC , wA, and wD are all 6n-dimensional
vectors. Then, the foregoing 6n scalar equations for the n moving links take the
simple form
</p>
<p>MPt D �WMtC wA C wG C wD C wC (7.48)
</p>
<p>in which wW has been decomposed into its active, gravitational, and dissipative
parts wA, wG , and wD , respectively. Now, since gravity acts at the center of mass of
a body, the gravity wrench wGi acting on the i th link takes the form
</p>
<p>wGi D
�
</p>
<p>0
</p>
<p>mig
</p>
<p>�
</p>
<p>(7.49)
</p>
<p>The mathematical model displayed in Eq. (7.48) represents the 6n uncoupled
Newton&ndash;Euler equations of the overall manipulator. The following step of this
derivation consists in reducing the uncoupled system of equations to a set of
n coupled equations of motion. To this end, the coupling between every two
consecutive links is represented as a linear homogeneous system of algebraic
equations on the link twists. Moreover, we note that all kinematic pairs allow a
relative one-degree-of-freedom motion between the coupled bodies. We can then
express the kinematic constraints of the system in linear homogeneous form in the
6n-dimensional vector of manipulator twist, namely,
</p>
<p>Kt D 0 (7.50)
</p>
<p>with K being a 6n�6nmatrix, to be derived in Sect. 7.5.1. What is important to note
at the moment is that the kinematic constraint equations, or constraint equations,
for brevity, Eqs. (7.50), consist of a system of 6n scalar equations, i.e., six scalar</p>
<p/>
</div>
<div class="page"><p/>
<p>308 7 Dynamics of Serial Robotic Manipulators
</p>
<p>equations for each joint, for the manipulator at hand has n joints. Moreover, when
the system is in motion, t is different from zero, and hence, matrix K is bound to be
singular. In fact, the dimension of the null space of K, termed its nullity, is exactly
equal to n, the degree of freedom of the manipulator. That is, not every possible 6n-
dimensional twist is feasible; to be so, a twist must lie in the null space of matrix K.
Furthermore, since the nonworking constraint wrench wC produces no work on the
manipulator, its sole function being to keep the links together, the power developed
by this wrench on t, for any feasible motion of the manipulator, is zero, i.e.,
</p>
<p>tTwC D 0 (7.51)
</p>
<p>On the other hand, if the two sides of Eq. (7.50) are transposed and then multiplied
by a 6n-dimensional vector �, one has
</p>
<p>tTKT� D 0 (7.52)
</p>
<p>Upon comparing Eqs. (7.51) and (7.52), it is apparent that wC is of the form
</p>
<p>wC D KT� (7.53)
</p>
<p>More formally, the scalar product of wC and t, as stated by Eq. (7.51), vanishes, and
hence, t lies in the null space of K, as stated by Eq. (7.50). This means that wC lies
in the range of KT , as stated in Eq. (7.53). The following step will be to represent t
as a linear transformation of the independent generalized speeds, i.e., as
</p>
<p>t D T P� (7.54)
</p>
<p>with T defined as a 6n�nmatrix that can be fairly termed the twist-shaping matrix.
Moreover, the above mapping will be referred to as the twist&ndash;shape relations.
The derivation of expressions for matrices K and T will be described in detail in
Sect. 7.5.1 below. Now, upon substitution of Eq. (7.54) into Eq. (7.50), we obtain
</p>
<p>KT P� D 0 (7.55a)
</p>
<p>Furthermore, since the degree of freedom of the manipulator is n, the n
generalized speeds f P�i gn1 can be assigned arbitrarily. However, while doing this,
Eq. (7.55a) has to hold. Thus, the only possibility for this to happen is that the
product KT vanish, i.e.,
</p>
<p>KT D O (7.55b)
</p>
<p>where O denotes the 6n � n zero matrix. The above equation states that T is
an orthogonal complement of K. Because of the particular form of choosing this
complement&mdash;see Eq. (7.54)&mdash;we refer to T as the natural orthogonal complement
of K (Angeles and Lee 1988).</p>
<p/>
</div>
<div class="page"><p/>
<p>7.5 The Natural Orthogonal Complement 309
</p>
<p>In the final step of this method, Pt of Eq. (7.48) is obtained from Eq. (7.54),
namely,
</p>
<p>Pt D T R� C PT P� (7.56)
</p>
<p>Further, both sides of the uncoupled equations (7.48) are multiplied from the left by
TT , the effect being that the term wC is eliminated. Indeed, if wC is expressed as
appearing in Eq. (7.53), we have
</p>
<p>TTwC D TTKT� � .KT/T�
</p>
<p>However, by virtue of Eq. (7.55b), the matrix coefficient of � in the foregoing
expression vanishes, thereby obtaining n independent equations free of nonworking
constraint wrenches. These are nothing but the governing equations of the manipu-
lator, namely,
</p>
<p>I R� D �TT .M PTCWMT/ P� C TT .wA C wD C wG/ (7.57)
</p>
<p>where I, the positive definite n� n generalized inertia matrix of the manipulator, is
defined as
</p>
<p>I � TTMT (7.58)
</p>
<p>which is identical to the inertia matrix derived using the Euler&ndash;Lagrange equations,
with � as the vector of generalized coordinates. Now, we let � and ı denote the
n-dimensional vectors of active and dissipative generalized force. Moreover, we let
C.�; P�/ P� be the n-dimensional vector of quadratic terms of inertia force. These
items are defined as
</p>
<p>� � TTwA; ı � TTwD; &#13; D TTwG ;
C.�; P�/ � TTM PTC TTWMT (7.59)
</p>
<p>Clearly, the sum � C ı produces �p , the generalized force defined in Eq. (7.11).
Thus, the Euler&ndash;Lagrange equations of the system take the form
</p>
<p>I R� D �C P� C � C ı C &#13; (7.60)
</p>
<p>If, moreover, a static wrench wW acts onto the end-effector, with the force applied
at the operation point, then its effect onto the above model is taken into account as
indicated in Eq. (5.50). Thus, a term JTwW is added to the right-hand side of the
above model:
</p>
<p>I R� D �C P� C � C ı C &#13; C JTwW (7.61)</p>
<p/>
</div>
<div class="page"><p/>
<p>310 7 Dynamics of Serial Robotic Manipulators
</p>
<p>As a matter of fact, ı is defined in Eq. (7.59) only for conceptual reasons.
In practice, this term is most readily calculated once a dissipation function in terms
of the generalized coordinates and generalized speeds is available, as described in
Sect. 7.8. Thus, ı is computed as
</p>
<p>ı D �@&#129;
@ P�
</p>
<p>(7.62)
</p>
<p>It is pointed out that the first term of the right-hand side of Eq. (7.60) is quadratic
in P� because matrix C, defined in Eq. (7.59), is linear in P� . In fact, the first term of
that expression is linear in a factor PT that is, in turn, linear in P� . Moreover, the second
term of the same expression is linear in W, which is linear in P� as well. However, C
is nonlinear in � . Because of the quadratic nature of that term, it is popularly known
as the vector of Coriolis and centrifugal forces, whereas the left-hand side of that
equation is given the name of vector of inertia forces. Properly speaking, both the
left-hand side and the first term of the right-hand side of Eq. (7.60) arise from inertia
forces.
</p>
<p>Example 7.5.1 (A Minimum-Time Trajectory). A pick-and-place operation is to be
performed with a n-axis manipulator in the shortest possible time. Moreover, the
maneuver is defined so that the n-dimensional vector of joint variables is given by a
common shape function s.x/, with 0 � x � 1 and 0 � s � 1, which is prescribed.
Thus, for a fixed n-dimensional vector �0, the time-history of the joint-variable
vector, �.t/, is given by
</p>
<p>�.t/ D �0 C s
�
t
</p>
<p>T
</p>
<p>�
</p>
<p>&#129;�; 0 � t � T
</p>
<p>with T defined as the time taken by the maneuver, while �0 and �0 C &#129;� are
the values of the joint-variable vector at the pick- and the place-postures of the
manipulator, respectively. These vectors are computed upon solving the inverse-
displacement problem, as explained in Chap. 4. Furthermore, the load-carrying
capacity of the manipulator is specified in terms of the maximum torques delivered
by the motors, namely,
</p>
<p>j�i j � � i ; for i D 1; : : : ; n
</p>
<p>where the constant values � i are to be found from data supplied by the manufacturer.
In order to keep the analysis simple, we neglect power loses in this example. Find
the minimum time in which the maneuver can take place.
</p>
<p>Solution: Let us first calculate the vector of joint-rates and its time-derivative:
</p>
<p>P�.t/ D 1
T
s0.x/&#129;�; R�.t/ D 1
</p>
<p>T 2
s00.x/&#129;�; x � t
</p>
<p>T</p>
<p/>
</div>
<div class="page"><p/>
<p>7.5 The Natural Orthogonal Complement 311
</p>
<p>Now we substitute the above values into the mathematical model of Eq. (7.60), with
ı.t/ D 0 and &#13;.t/ D 0, thereby obtaining
</p>
<p>� D I.�/ R� C C.�; P�/ P� D 1
T 2
Œs00.x/I.x/&#129;� C s02.x/C.x;&#129;�/&#129;�&#141; � 1
</p>
<p>T 2
f.x/
</p>
<p>with f.x/ defined, of course, as
</p>
<p>f.x/ � ŒI.x/s00.x/C C.x/s02.x/&#141;&#129;�
</p>
<p>the 1=T 2 factor in the term of Coriolis and centrifugal forces stemming from the
quadratic nature of the C.�; P�/ P� term. What we now have is the vector of motor
torques, �, expressed as a function of the scalar argument x. Now, let fi .x/ be the
i th component of vector f.x/, and
</p>
<p>Fi � max
x
fjfi .x/jg; for i D 1; : : : ; n
</p>
<p>We would then like to have each value Fi produce the maximum available torque
� i , namely,
</p>
<p>� i D
Fi
</p>
<p>T 2
; i D 1; : : : n
</p>
<p>and hence, for each joint we have a value Ti of T given by
</p>
<p>T 2i �
Fi
</p>
<p>� i
; i D 1; : : : n
</p>
<p>Obviously, the minimum value sought, Tmin, is nothing but the maximum of the
foregoing values, i.e.,
</p>
<p>Tmin D max
i
fTign1
</p>
<p>thereby completing the solution.
</p>
<p>7.5.1 Derivation of Constraint Equations and Twist&ndash;Shape
</p>
<p>Relations
</p>
<p>In order to illustrate the general ideas behind the method of the natural orthogonal
complement, we derive below the underlying kinematic constraint equations and
the twist&ndash;shape relations. We first note, from Eq. (7.25a), that the relative angular
velocity of the i th link with respect to the .i � 1/st link, !i �!i�1, is P�iei . Thus, if</p>
<p/>
</div>
<div class="page"><p/>
<p>312 7 Dynamics of Serial Robotic Manipulators
</p>
<p>matrix Ei is defined as the cross-product matrix of vector ei , then, the angular
velocities of two successive links obey a simple relation, namely,
</p>
<p>Ei .!i �!i�1/ D 0 (7.63)
</p>
<p>Furthermore, we rewrite now Eq. (7.33a) in the form
</p>
<p>Pci � Pci�1 C Ri!i C Di�1!i�1 D 0 (7.64)
</p>
<p>where Di and Ri are defined as the cross-product matrices of vectors ıi , defined in
Sect. 7.4.1 as ai��i , and �i , respectively. In particular, when the first link is inertial,
Eqs. (7.63 and b), as pertaining to the first link, reduce to
</p>
<p>E1!1 D 0 (7.65a)
Pc1 C R1!1 D 0 (7.65b)
</p>
<p>Now, Eqs. (7.63) and (7.64), as well as their counterparts for i D 1, Eqs. (7.65a
and b), are further expressed in terms of the link twists, thereby producing the
constraints below:
</p>
<p>K11t1 D 0 (7.66a)
Ki;i�1ti�1 CKi i ti D 0; i D 1; : : : ; n (7.66b)
</p>
<p>with K11 and Kij , for i D 2; : : : ; n and j D i � 1; i , defined as
</p>
<p>K11 �
�
</p>
<p>E1 O
</p>
<p>R1 1
</p>
<p>�
</p>
<p>(7.67a)
</p>
<p>Ki;i�1 �
�
</p>
<p>�Ei O
Di�1 �1
</p>
<p>�
</p>
<p>(7.67b)
</p>
<p>Ki i �
�
</p>
<p>Ei O
</p>
<p>Ri 1
</p>
<p>�
</p>
<p>(7.67c)
</p>
<p>where 1 and O denote the 3�3 identity and zero matrices, respectively. Furthermore,
from Eqs. (7.66a and b) and (7.67a&ndash;c), it is apparent that matrix K appearing in
Eq. (7.55b) takes on the form
</p>
<p>K D
</p>
<p>2
</p>
<p>6
6
6
6
6
4
</p>
<p>K11 O6 O6 � � � O6 O6
K21 K22 O6 � � � O6 O6
:::
</p>
<p>:::
:::
: : :
</p>
<p>:::
:::
</p>
<p>O6 O6 O6 � � � Kn�1;n�1 O6
O6 O6 O6 � � � Kn;n�1 Knn
</p>
<p>3
</p>
<p>7
7
7
7
7
5
</p>
<p>(7.68)
</p>
<p>with O6 denoting the 6 � 6 zero matrix.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.5 The Natural Orthogonal Complement 313
</p>
<p>Fig. 7.6 Kinematic subchain comprising links j; j C 1 : : : ; i
</p>
<p>Further, the link-twists are expressed as linear combinations of the joint-rate
vector P� . To this end, we define the 6�n partial Jacobian Ji as the matrix mapping
the joint-rate vector P� into the twist ti of that link, i.e.,
</p>
<p>Ji P� D ti (7.69)
</p>
<p>whose j th column, tij , is given, for i; j D 1; 2; : : : ; n, by
</p>
<p>tij D
</p>
<p>8
</p>
<p>ˆ̂
ˆ̂
&lt;
</p>
<p>ˆ̂
ˆ̂
:
</p>
<p>"
</p>
<p>ej
</p>
<p>ej � rij
</p>
<p>#
</p>
<p>; if j � i I
"
</p>
<p>0
</p>
<p>0
</p>
<p>#
</p>
<p>; otherwise:
</p>
<p>(7.70)
</p>
<p>with rij illustrated in Fig. 7.6 and defined, for i; j D 1; : : : ; n, as
</p>
<p>rij �
</p>
<p>8
</p>
<p>ˆ̂
&lt;
</p>
<p>ˆ̂
:
</p>
<p>aj C ajC1 C � � � C ai�1 C �i ; if j &lt; i I
�i ; if j D i I
0; otherwise:
</p>
<p>(7.71)
</p>
<p>It is noteworthy that, for a given i and a given j � i , a submanipulator of i�.j �
1/ axes is obtained. The frij gijD1 vectors are the counterparts of the frign1 vectors of
Sect. 5.2
</p>
<p>We can thus readily express the twist ti of the i th link as a linear combination of
the first i joint rates, namely,
</p>
<p>ti D P�1ti1 C P�2ti2 C � � � C P�i ti i ; i D 1; : : : ; n (7.72)</p>
<p/>
</div>
<div class="page"><p/>
<p>314 7 Dynamics of Serial Robotic Manipulators
</p>
<p>and hence, matrix T of Eq. (7.54) takes the form
</p>
<p>T �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>t11 0 � � � 0
t21 t22 � � � 0
:::
:::
: : :
</p>
<p>:::
</p>
<p>tn1 tn2 � � � tnn
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(7.73)
</p>
<p>As a matter of verification, one can readily prove that the product of matrix T,
as given by Eq. (7.73), by matrix K, as given by Eq. (7.68), vanishes, and hence,
relation (7.55b) holds.
</p>
<p>The kinematic constraint equations on the twists, for the case in which the i th
joint is prismatic, are derived likewise. In this case, we use Eqs. (7.34a and e), with
the latter rewritten more conveniently for our purposes, namely,
</p>
<p>!i D !i�1 (7.74a)
Pci D Pci�1 C!i�1 � .ıi�1 C �i C biei /C Pbiei (7.74b)
</p>
<p>We now introduce one further definition:
</p>
<p>R0i � D0i�1 C Ri (7.75)
</p>
<p>where D0i�1 is the cross-product matrix of vector ıi�1, defined in Sect. 7.4.1 as
di�1 � �i�1, while Ri is the cross-product matrix of �i C biei . Hence, Eq. (7.74b)
can be rewritten as
</p>
<p>Pci � Pci�1 C R0i!i � Pbiei D 0 (7.76)
</p>
<p>Upon multiplication of both sides of Eq. (7.76) by Ei , the term in Pbi cancels, and we
obtain
</p>
<p>Ei .Pci � Pci�1 C R0i!i / D 0 (7.77)
</p>
<p>Hence, Eqs. (7.74a) and (7.77) can now be regrouped in a single six-dimensional
linear homogeneous equation in the twists, namely,
</p>
<p>K0i;i�1ti�1 CK0i i ti D 0 (7.78)
</p>
<p>the associated matrices being defined below:
</p>
<p>K0i;i�1 �
�
</p>
<p>�1 O
O �Ei
</p>
<p>�
</p>
<p>(7.79a)
</p>
<p>K0i i �
�
</p>
<p>1 O
</p>
<p>EiR
0
i Ei
</p>
<p>�
</p>
<p>(7.79b)</p>
<p/>
</div>
<div class="page"><p/>
<p>7.5 The Natural Orthogonal Complement 315
</p>
<p>with 1 and O defined already as the 3 � 3 identity and zero matrices, respectively.
If the first joint is prismatic, then the corresponding constraint equation takes on the
form
</p>
<p>K011t1 D 0 (7.80)
</p>
<p>with K011 defined as
</p>
<p>K011 �
�
</p>
<p>1 O
</p>
<p>O E1
</p>
<p>�
</p>
<p>(7.81)
</p>
<p>Furthermore, if the kth pair is prismatic and 1 � k � i , then the twist ti of the
i th link changes to
</p>
<p>ti D P�1ti1 C � � � C Pbkt0ik C � � � C P�i ti i ; i D 1; : : : ; n (7.82)
</p>
<p>where t0ik is defined as
</p>
<p>t0ik �
�
</p>
<p>0
</p>
<p>ek
</p>
<p>�
</p>
<p>(7.83)
</p>
<p>In order to set up Eq. (7.60), then all we now need is PT, which is computed
below. Two cases will be distinguished again, namely, whether the joint at hand is a
revolute or a prismatic pair. In the first case, from Eq. (7.70) one readily derives, for
i; j D 1; 2; : : : ; n,
</p>
<p>Ptij D
</p>
<p>8
</p>
<p>ˆ̂
ˆ̂
&lt;
</p>
<p>ˆ̂
ˆ̂
:
</p>
<p>"
</p>
<p>!j � ej
.!j � ej / � rij C ej � Prij
</p>
<p>#
</p>
<p>; if j � i I
"
</p>
<p>0
</p>
<p>0
</p>
<p>#
</p>
<p>; otherwise
</p>
<p>(7.84)
</p>
<p>where, from Eq. (7.71),
</p>
<p>Prij D !j � aj C � � � C!i�1 � ai�1 C!i � �i (7.85)
</p>
<p>On the other hand, if the kth pair is prismatic and 1 � k � i , then from
Eq. (7.83), the time-rate of change of t0ik becomes
</p>
<p>Pt0ik D
�
</p>
<p>0
</p>
<p>!k � ek
</p>
<p>�
</p>
<p>(7.86)
</p>
<p>thereby completing the desired derivations.</p>
<p/>
</div>
<div class="page"><p/>
<p>316 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Note that the natural orthogonal complement can also be used for the inverse
dynamics calculations. In this case, if the manipulator is subjected to a gravity
field, then the twist-rate of the first link will have to be modified by adding a
nonhomogeneous term to it, thereby accounting for the gravity-acceleration terms.
This issue is discussed in Sect. 7.7.
</p>
<p>7.5.2 Noninertial Base Link
</p>
<p>Noninertial bases occur in space applications, e.g., in the case of a manipulator
mounted on a space platform or on the space shuttle. A noninertial base can be
readily handled with the use of the natural orthogonal complement, as discussed in
this subsection. Since the base is free of attachments to an inertial frame, we have
to add its six degrees of freedom (dof) to the n dof of the rest of the manipulator.
Correspondingly, t, wC , wA, and wD now become 6.nC 1/-dimensional vectors. In
particular, t takes the form
</p>
<p>t D
�
</p>
<p>tT0 t
T
1 : : : t
</p>
<p>T
n
</p>
<p>�T
(7.87)
</p>
<p>with t0 defined as the twist of the base. Furthermore, the vector of independent
generalized speeds, P� , is now of dimension nC6, its first six components being those
of t0, the other n remaining as in the previous case. Thus, P� has the components
shown below:
</p>
<p>P� �
�
</p>
<p>tT0
P�1 : : : P�n
</p>
<p>�T
(7.88)
</p>
<p>Correspondingly, T becomes a 6.nC 1/ � .nC 6/ matrix, namely,
</p>
<p>T �
�
</p>
<p>1 O
</p>
<p>O0 T0
</p>
<p>�
</p>
<p>(7.89)
</p>
<p>where 1 is the 6 � 6 identity matrix, O denotes the 6 � n zero matrix, O0 represents
the 6n � 6 zero matrix, and T0 is the 6n � n matrix defined in Eq. (7.73) as T.
Otherwise, the model remains as in the case of an inertial base.
</p>
<p>A word of caution is in order here. Because of the presence of the twist vector t0
in the definition of the vector of generalized speeds above, the latter cannot, properly
speaking, be regarded as a time-derivative. Indeed, as studied in Chap. 3, the angular
velocity appearing in the twist vector is not a time-derivative. Hence, the vector of
independent generalized speeds defined in Eq. (7.88) is represented instead by v,
which does not imply a time-derivative, namely,
</p>
<p>v D
�
</p>
<p>tT0
P�1 � � � P�n
</p>
<p>�T
(7.90)</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 317
</p>
<p>7.6 Manipulator Forward Dynamics
</p>
<p>Forward dynamics is needed either for purposes of simulation or for the model-
based control of manipulators (Craig 1989), and hence, a fast calculation of the
joint-variable time-histories �.t/ is needed. These time-histories are calculated from
the model displayed in Eq. (7.61), reproduced below for quick reference, in terms
of vector �.t/, i.e.,
</p>
<p>I R� D �C.�; P�/ P� C �.t/C ı.�; P�/C &#13;.�/C JTwW (7.91)
</p>
<p>Clearly, what is at stake here is the calculation of R� from the foregoing model.
Indeed, the right-hand side of Eq. (7.91) can be calculated with the aid of the
Newton&ndash;Euler recursive algorithm, as we will describe below, and needs no further
discussion for the time being. Now, the calculation of R� from Eq. (7.91) is similar to
the calculation of P� from the relation between the joint-rates and the twist, derived
in Sect. 5.2. From the discussion in that section, such calculations take a number
of floating-point operations, or flops, that is proportional to n3, and is thus said to
have a complexity of O.n3/&mdash;read &ldquo;order n3.&rdquo; In real-time calculations, we would
like to have a computational scheme ofO.n/. In attempting to derive such schemes,
Walker and Orin (1982) proposed a procedure that they called the composite rigid-
body method, whereby the number of flops is minimized by cleverly calculating
I.�/ and the right-hand side of Eq. (7.91) by means of the recursive Newton&ndash;
Euler algorithm. In their effort, they produced an O.n2/ algorithm to calculate R� .
Thereafter, Featherstone (1983) proposed anO.n/ algorithm that is based, however,
on the assumption that Coriolis and centrifugal forces are negligible. The same
author reported an improvement to the aforementioned algorithm, namely, the
articulated-body method, that takes into account Coriolis and centrifugal forces
(Featherstone 1987.) The outcome, for a n-revolute manipulator, is an algorithm
requiring 300n � 267 multiplications and 279n � 259 additions. For n D 6, these
figures yield 1,533 multiplications and 1,415 additions. Li (1989) reported anO.n2/
algorithm leading to 783 multiplications and 670 additions.
</p>
<p>In this subsection, we illustrate the application of the method of the natural
orthogonal complement to the modeling of an n-axis serial manipulator for purposes
of simulation. While this algorithm gives an O.n3/ complexity, its derivation
is straightforward and gives, for a six-axis manipulator, a computational cost
similar to that of Featherstone&rsquo;s, namely, 1,596 multiplications and 1,263 additions.
Moreover, a clever definition of coordinate frames leads to even lower figures, i.e.,
1,353 multiplications and 1,165 additions, as reported by Angeles (1988). Further
developments on robot dynamics using the natural orthogonal complement have
been reported by Saha (1997, 1999, 2008), who proposed the decoupled natural
orthogonal complement as a means to enable the real-time inversion of the mass
matrix.
</p>
<p>The manipulator at hand is assumed to be constituted by n moving links coupled
by n kinematic pairs of the revolute or prismatic types. Again, for brevity, the</p>
<p/>
</div>
<div class="page"><p/>
<p>318 7 Dynamics of Serial Robotic Manipulators
</p>
<p>base link is assumed to be inertial, noninertial bases being readily incorporated as
described in Sect. 7.5.2. For the sake of conciseness, we will henceforth consider
only manipulators mounted on an inertial base. Moreover, we assume that the
generalized coordinates � and the generalized speeds P� are known at an instant
tk , along with the driving torque �.t/, for t � tk , and of course, the DH and
the inertial parameters of the manipulator are assumed to be known as well.
Based on the foregoing information, then, R� is evaluated at tk and, with a suitable
integration scheme, the values of � and P� are determined at instant tkC1. Obviously,
the governing equation (7.60) enables us to solve for R�.tk/. This requires, of
course, the inversion of the n � n matrix of generalized inertia I. Since the said
matrix is positive-definite, solving for R� from Eq. (7.60) can be done economically
using the Cholesky-decomposition algorithm (Dahlquist and Bj&ouml;rck 1974). The sole
remaining task is, then, the computation of I, the quadratic inertia term C P� , and
the dissipative torque ı. The last of these is dependent on the manipulator and the
constitutive model adopted for the representation of viscous and Coulomb friction
forces and will not be considered at this stage. Models for dissipative forces will be
studied in Sect. 7.8. Thus, the discussion below will focus on the computation of I
and C P� appearing in the mathematical model of Eq. (7.91).
</p>
<p>Next, the 6n � 6n matrix M is factored as
</p>
<p>M D HTH (7.92)
</p>
<p>which is possible because M is at least positive-semidefinite. In particular, for
manipulators of the type at hand, M is positive-definite if no link-mass is neglected.
Moreover, due to the diagonal-block structure of this matrix, its factoring is
straightforward. In fact, H is given simply by
</p>
<p>H D diag.H1; : : : ;Hn/ (7.93)
</p>
<p>each 6 � 6 block Hi of Eq. (7.93) being given, in turn, as
</p>
<p>Hi D
�
</p>
<p>Ni O
</p>
<p>O ni1
</p>
<p>�
</p>
<p>(7.94)
</p>
<p>with 1 and O defined as the 3 � 3 identity and zero matrices, respectively. We thus
have
</p>
<p>Mi D HTi Hi (7.95)
</p>
<p>Furthermore, Ni can be obtained from the Cholesky decomposition of Ii , while ni
is the positive square root of mi , i.e.,
</p>
<p>Ii D NTi Ni ; mi D n2i (7.96)</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 319
</p>
<p>Now, since each 6 � 6 Mi block is constant in body-fixed coordinates, the above
factoring can be done off-line. From the foregoing definitions, then, the n�nmatrix
of generalized inertia I can now be expressed as
</p>
<p>I D PTP (7.97)
</p>
<p>where P is defined, in turn, as the 6n � n matrix given below:
</p>
<p>P � HT (7.98)
</p>
<p>The computation of P is now discussed. If we recall the structure of T from
Eq. (7.73) and that of H from Eq. (7.93), along with the definition of P, Eq. (7.98),
we readily obtain
</p>
<p>P D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>H1t11 0 � � � 0
H2t21 H2t22 � � � 0
:::
</p>
<p>:::
: : :
</p>
<p>:::
</p>
<p>Hntn1 Hntn2 � � � Hntnn
</p>
<p>3
</p>
<p>7
7
7
5
�
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>p11 0 � � � 0
p21 p22 � � � 0
:::
</p>
<p>:::
: : :
</p>
<p>:::
</p>
<p>pn1 pn2 � � � pnn
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(7.99)
</p>
<p>with 0 denoting the six-dimensional zero vector. Moreover, each of the above
nontrivial six-dimensional arrays pij is given as
</p>
<p>pij � Hi tij D
</p>
<p>8
</p>
<p>ˆ̂
ˆ̂
</p>
<p>&lt;̂
</p>
<p>ˆ̂
ˆ̂
</p>
<p>:̂
</p>
<p>"
</p>
<p>Niej
</p>
<p>niej � rij
</p>
<p>#
</p>
<p>if the j th joint is R
</p>
<p>�
</p>
<p>0
</p>
<p>niej
</p>
<p>�
</p>
<p>if the j th joint is P
</p>
<p>(7.100)
</p>
<p>Thus, the .i; j / entry of I is computed as the sum of the inner products of the
.k; i/ and the .k; j / blocks of P, for k D j; : : : ; n, i.e.,
</p>
<p>Iij D Ij i D
n
X
</p>
<p>kDj
pTkipkj (7.101)
</p>
<p>with both pki and pkj expressed in FkC1-coordinates, i.e., in kth-link coordinates.
Now, the Cholesky decomposition of I can be expressed as
</p>
<p>I D LTL (7.102)
</p>
<p>where L is an n�n lower-triangular matrix with positive diagonal entries. Moreover,
Eq. (7.91) is now rewritten as
</p>
<p>LTL R� D �.C P� � JTwW � &#13;/C ı C � (7.103)</p>
<p/>
</div>
<div class="page"><p/>
<p>320 7 Dynamics of Serial Robotic Manipulators
</p>
<p>If we now recall Eq. (7.91), it is apparent that the term inside the parentheses in the
right-hand side of the above equation is nothing but the torque required to produce
the motion prescribed by the current values of � and P� , in the absence of dissipative
wrenches and with zero joint accelerations, when the manipulator is acted upon by a
static wrench wW . That is, if we call � the torque � of Eq. (7.91) under the foregoing
conditions, then
</p>
<p>C P� � JTwW � &#13; D �jwDD0; R�D0 � � (7.104)
</p>
<p>which is most efficiently computed from inverse dynamics, using the recursive
Newton&ndash;Euler algorithm, as described in Sect. 7.4. Now Eq. (7.102) is solved for
R� in two steps, namely,
</p>
<p>LT x D �� C � C ı (7.105a)
L R� D x (7.105b)
</p>
<p>In the above equations, then, x is first computed from Eq. (7.105a) by backward
substitution. With x known, R� is computed from Eq. (7.105b) by forward substi-
tution, thereby completing the computation of R� . The complexity of the foregoing
algorithm is discussed in Sect. 7.6.2.
</p>
<p>Alternatively, R� can be calculated in two steps from two linear systems of
equations, the first one underdetermined, the second overdetermined. Indeed, if we
let the product P R� be denoted by y, then the dynamics model of the manipulator,
Eq. (7.60), along with the factoring of Eq. (7.97), leads to
</p>
<p>PT y D �� C � C ı (7.106a)
P R� D y (7.106b)
</p>
<p>Thus, in the above equations, y is calculated first as the minimum-norm solution
of Eq. (7.106a); then, the desired value of R� is calculated as the least-square approx-
imation of Eq. (7.106b). These two solutions are computed most efficiently using an
orthogonalization algorithm that reduces matrix P to upper-triangular form (Golub
and Van Loan 1989). A straightforward calculation based on the explicit calculation
of the generalized inverses involved is not recommended, because of the frequent
numerical ill-conditioning incurred. Two orthogonalization procedures, one based
on Householder reflections, the other on the Gram&ndash;Schmidt procedure, for the
computation of both the least-square approximation of an overdetermined system
of equations and the minimum-norm solution of its underdetermined counterpart
are outlined in Appendix B.
</p>
<p>The complexity of the foregoing calculations is discussed in Sect. 7.6.2, based
on the Cholesky decomposition of the generalized inertia matrix, details on the
alternative approach being available elsewhere (Angeles and Ma 1988).</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 321
</p>
<p>Fig. 7.7 Mass-center
locations of the robot of
Fig. 4.23
</p>
<p>Example 7.6.1 (Dynamics of a Spatial Three-Revolute Robot). The robot of
Fig. 4.17 is reproduced in Fig. 7.7, in a form that is kinematically equivalent to
the sketch of that figure, but more suitable for the purposes of this example. For
this robot, (a) find its inertia matrix at the configuration depicted in that figure;
(b) find the time-rate of change of the inertia matrix under a maneuver whereby
P�1 D P�2 D P�3 D p s�1 and R�1 D R�2 D R�3 D 0; and (i i i ) under the same maneuver,
find the centrifugal and Coriolis terms of its governing equation. Furthermore,
assume that all links are identical and dynamically isotropic. What we mean by
&ldquo;dynamically isotropic&rdquo; is that the moment of inertia of all three links about their
centers of mass are proportional to the 3 � 3 identity matrix, the proportionality
factor being I . Moreover, all three links are designed so that the center of mass of
each is located as shown in Fig. 7.7.
</p>
<p>Solution:
</p>
<p>(a) Henceforth, we represent all vectors and matrices with respect to the F1-frame
of Fig. 7.7, while denoting by i, j, and k the unit vectors parallel to the X1, Y1,
and Z1 axes, respectively. Under these conditions, we have, for the unit vectors
parallel to the revolute axes,
</p>
<p>e1 D k; e2 D j; e3 D i
</p>
<p>while vector ai is directed from the origin of Fi to that of FiC1, for i D 1; 2; 3.
Hence,
</p>
<p>a1 D �ai; a2 D a.j � k/; a3 D a.iC k/</p>
<p/>
</div>
<div class="page"><p/>
<p>322 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Likewise, the position vectors of the centers of mass, �i , for i D 1, 2, and 3,
with respect to the origins of their respective frames, are given by
</p>
<p>�1 D
1
</p>
<p>2
a.�iC j/
</p>
<p>�2 D
1
</p>
<p>2
a.iC 2j � k/
</p>
<p>�3 D
1
</p>
<p>2
a.2iC k/
</p>
<p>We can now calculate the various six-dimensional arrays tij , for i D 1, 2, 3,
and j D 1 till i , i.e.,
</p>
<p>t11 D
�
</p>
<p>e1
</p>
<p>e1 � �1
</p>
<p>�
</p>
<p>D
�
</p>
<p>k
</p>
<p>�.a=2/.iC j/
</p>
<p>�
</p>
<p>t21 D
�
</p>
<p>e1
</p>
<p>e1 � .a1 C �2/
</p>
<p>�
</p>
<p>D
�
</p>
<p>k
</p>
<p>�.a=2/.2iC j/
</p>
<p>�
</p>
<p>t22 D
�
</p>
<p>e2
</p>
<p>e2 � �2
</p>
<p>�
</p>
<p>D
�
</p>
<p>j
</p>
<p>�.a=2/.iC k/
</p>
<p>�
</p>
<p>t31 D
�
</p>
<p>e1
</p>
<p>e1 � .a1 C a2 C �3/
</p>
<p>�
</p>
<p>D
�
</p>
<p>k
</p>
<p>�ai
</p>
<p>�
</p>
<p>t32 D
�
</p>
<p>e2
</p>
<p>e2 � .a2 C �3/
</p>
<p>�
</p>
<p>D
�
</p>
<p>j
</p>
<p>�.a=2/.iC 2k/
</p>
<p>�
</p>
<p>t33 D
�
</p>
<p>e3
</p>
<p>e3 � �3
</p>
<p>�
</p>
<p>D
�
</p>
<p>i
</p>
<p>�.a=2/j
</p>
<p>�
</p>
<p>and so, the 18 � 3 matrix T is given by
</p>
<p>T D
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
4
</p>
<p>k 0 0
</p>
<p>�.a=2/.iC j/ 0 0
k j 0
</p>
<p>�.a=2/.2iC j/ �.a=2/.iC k/ 0
k j i
</p>
<p>�ai �.a=2/.iC 2k/ �.a=2/j
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
5
</p>
<p>Moreover, the 6 � 6 inertia dyad of the i th link takes the form
</p>
<p>Mi D
�
</p>
<p>I1 O
</p>
<p>O m1
</p>
<p>�
</p>
<p>; i D 1; 2; 3</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 323
</p>
<p>with 1 and O denoting the 3 � 3 identity and zero matrices, respectively. Thus,
the 18 � 18 system mass matrix is given as
</p>
<p>M D diag.M1; M2; M3/
</p>
<p>and the 3 � 3 generalized inertia matrix I of the manipulator is
</p>
<p>I D TTMT
</p>
<p>whose entries are given by
</p>
<p>I11 D tT11M1t11 C tT21M2t21 C tT31M3t31
I12 D tT21M2t22 C tT31M3t32 D I21
I13 D tT31M3t33 D I31
I22 D tT22M2t22 C tT32M3t32
I23 D tT32M3t33 D I32
I33 D tT33M3t33
</p>
<p>Upon expansion, the foregoing expressions yield
</p>
<p>I D 1
4
ma2
</p>
<p>2
</p>
<p>4
</p>
<p>11 4 0
</p>
<p>4 7 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5C I
</p>
<p>2
</p>
<p>4
</p>
<p>3 0 0
</p>
<p>0 2 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>(b) Now, the time-rate of change of I, PI, is calculated as
</p>
<p>PI D TTM PTC PTTMTC TT .WM �MW/T
</p>
<p>We proceed first to compute PT. This time-derivative is nothing but the 18 � 3
matrix whose entries are the time-derivatives of the entries of T, namely, Ptij , as
given in Eq. (7.84), which is reproduced below for quick reference:
</p>
<p>Ptij D
�
</p>
<p>!j � ej
.!j � ej / � rij C ej � Prij
</p>
<p>�
</p>
<p>where Prij is given, in turn, by
</p>
<p>Prij D !j � aj C : : :C!i�1 � ai�1 C!i � �i
</p>
<p>Hence, we will need vectors!i , for i D 1, 2, and 3. These are calculated below:
</p>
<p>!1 D P�1e1 D pk</p>
<p/>
</div>
<div class="page"><p/>
<p>324 7 Dynamics of Serial Robotic Manipulators
</p>
<p>!2 D P�1e1 C P�2e2 D p.jC k/
!3 D P�1e1 C P�2e2 C P�3e3 D p.iC jC k/
</p>
<p>We have, therefore,
</p>
<p>Pt11 D
�
</p>
<p>Pe1
Pe1s � �1 C e1 � P�1
</p>
<p>�
</p>
<p>D
�
</p>
<p>0
</p>
<p>e1 � .!1 � �1/
</p>
<p>�
</p>
<p>D p
�
</p>
<p>0
</p>
<p>.1=2/a.i � j/
</p>
<p>�
</p>
<p>Pt21 D
�
</p>
<p>Pe1
Pe1 � .a1 C �2/C e1 � .Pa1 C P�2/
</p>
<p>�
</p>
<p>D
�
</p>
<p>0
</p>
<p>e1 � .!1 � a1 C!2 � �2/
</p>
<p>�
</p>
<p>D p
�
</p>
<p>0
</p>
<p>.1=2/aj
</p>
<p>�
</p>
<p>Pt22 D
�
</p>
<p>Pe2
Pe2 � �2 C e2 � P�2
</p>
<p>�
</p>
<p>D
�
</p>
<p>pe1 � e2
.pe1 � e2/ � �2 C e2 � Œp.e1 C e2/ � �2&#141;
</p>
<p>�
</p>
<p>D p
�
</p>
<p>�i
�.1=2/a.iC j � k/
</p>
<p>�
</p>
<p>Pt31 D
�
</p>
<p>Pe1
Pe1 � .a1 C a2 C �3/C e1 � .Pa1 C Pa2 C P�3/
</p>
<p>�
</p>
<p>D
�
</p>
<p>0
</p>
<p>e1 � .!1 � a1 C!2 � a2 C!3 � �3/
</p>
<p>�
</p>
<p>D
�
</p>
<p>0
</p>
<p>e1 � Œpe1 � a1 C p.e1 C e2/ � a2 C p.e1 C e2 C e3/ � �3&#141;
</p>
<p>�
</p>
<p>D p
�
</p>
<p>0
</p>
<p>�aj
</p>
<p>�
</p>
<p>Pt32 D
�
</p>
<p>Pe2
Pe2 � .a2 C �3/C e2 � .Pa2 C P�3/
</p>
<p>�
</p>
<p>D
�
</p>
<p>pe1 � e2
.pe1 � e2/ � .a2 C �3/C pe2 � Œ.e1 C e2/ � .a2 C �3/&#141;
</p>
<p>�
</p>
<p>D p
�
</p>
<p>�i
�.1=2/a.2iC j � k/
</p>
<p>�
</p>
<p>Pt33 D
�
</p>
<p>Pe3
Pe3 � �3 C e3 � P�3
</p>
<p>�
</p>
<p>D
�
</p>
<p>!2 � e3
.!2 � e3/ � �3 C e3 � .!3 � �3/
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 325
</p>
<p>D
�
</p>
<p>p.e1 C e2/ � e3
pŒ.e1 C e2/ � e3&#141; � �3 C pe3 � Œ.e1 C e2 C e3/ � �3&#141;
</p>
<p>�
</p>
<p>Pt33 D
�
</p>
<p>p.e2 � e1/
p.e2 � e1/ � �3 C pŒ.e3 � �3/.e1 C e2 C e3/ � �3&#141;
</p>
<p>�
</p>
<p>D p
�
</p>
<p>j � k
.1=2/a.i � k/
</p>
<p>�
</p>
<p>Now, let
</p>
<p>P � TTM PT
</p>
<p>whose entries are displayed below:
</p>
<p>p11 D tT11M1Pt11 C tT21M2Pt21 C tT31M3Pt31
p12 D tT21M2Pt22 C tT31M3Pt32
p13 D tT31M3Pt33
p21 D tT22M2Pt21 C tT32M3Pt31
p22 D tT22M2Pt22 C tT32M3Pt32
p23 D tT32M3Pt33
p31 D tT33M3Pt31
p32 D tT33M3Pt32
p33 D tT33M3Pt33
</p>
<p>Upon performing the foregoing operations, we end up with
</p>
<p>TTM PT D p
</p>
<p>2
</p>
<p>4
</p>
<p>�.1=4/a2m .7=4/a2m �.1=2/a2m � I
�.1=2/a2m 0 .1=4/a2mC I
.1=2/a2m .1=4/a2m � I 0
</p>
<p>3
</p>
<p>5 � P
</p>
<p>the second term of the above expression for PI simply being PT . In order to
compute the third term, we need the products WM and MW. However, it is
apparent that the latter is the negative of the transpose of the former, and so, all
we need is one of the two terms. Furthermore, note that since both matrices M
and W are block-diagonal, their product is block-diagonal as well, namely,
</p>
<p>WM D diag.W1M1; W2M2; W3M3/
</p>
<p>where for i D 1, 2, and 3,</p>
<p/>
</div>
<div class="page"><p/>
<p>326 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Wi D
�
</p>
<p>&#127;i O
</p>
<p>O O
</p>
<p>�
</p>
<p>with O denoting the 3 � 3 zero matrix, while &#127;i is the cross-product matrix of
vector !i . Moreover,
</p>
<p>WiMi D
�
</p>
<p>I&#127;i O
</p>
<p>O O
</p>
<p>�
</p>
<p>Therefore, WiMi is skew-symmetric; as a consequence, WM is also skew-
symmetric, and the difference WM �MW vanishes. Hence, in this particular
case, PI reduces to
</p>
<p>PI D PC PT
</p>
<p>That is,
</p>
<p>PI D p
</p>
<p>2
</p>
<p>4
</p>
<p>�.1=2/a2m .5=4/a2m �I
.5=4/a2m 0 a2mC I
�I .1=2/a2m 0
</p>
<p>3
</p>
<p>5
</p>
<p>(c) Now, the term of Coriolis and centrifugal forces can be computed in two ways,
namely, (a) as .TTM PT C TTWMT/ P� , and (b) by using the Newton&ndash;Euler
algorithm with R�i D 0, for i D 1, 2, and 3. We proceed in these two ways
in order to verify the correctness of our results.
</p>
<p>In proceeding with the first alternative, we already have the first term in the
foregoing parentheses; the second term is now computed. First, we note that
</p>
<p>WMT D
</p>
<p>2
</p>
<p>4
</p>
<p>W1M1t11 0 0
</p>
<p>W2M2t21 W2M2t22 0
</p>
<p>W3M3t31 W3M3t32 W3M3t33
</p>
<p>3
</p>
<p>5
</p>
<p>with 0 defined as the six-dimensional zero vector. The foregoing nontrivial six-
dimensional arrays are computed below:
</p>
<p>W1M1t11 D
�
</p>
<p>I&#127;1 O
</p>
<p>O O
</p>
<p>� �
</p>
<p>k
</p>
<p>�.a=2/.iC j/
</p>
<p>�
</p>
<p>D
�
</p>
<p>I&#127;1k
</p>
<p>0
</p>
<p>�
</p>
<p>D
�
</p>
<p>0
</p>
<p>0
</p>
<p>�
</p>
<p>W2M2t21 D
�
</p>
<p>I&#127;2 O
</p>
<p>O O
</p>
<p>� �
</p>
<p>k
</p>
<p>�.a=2/.2iC j/
</p>
<p>�
</p>
<p>D
�
</p>
<p>I&#127;2k
</p>
<p>0
</p>
<p>�
</p>
<p>D pI
�
</p>
<p>i
</p>
<p>0
</p>
<p>�
</p>
<p>W2M2t22 D
�
</p>
<p>I&#127;2 O
</p>
<p>O O
</p>
<p>� �
</p>
<p>j
</p>
<p>�.a=2/.iC k/
</p>
<p>�
</p>
<p>D
�
</p>
<p>I&#127;2j
</p>
<p>0
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 327
</p>
<p>D
�
</p>
<p>pI.jC k/ � j
0
</p>
<p>�
</p>
<p>D pI
�
</p>
<p>�i
0
</p>
<p>�
</p>
<p>W3M3t31 D
�
</p>
<p>I&#127;3 O
</p>
<p>O O
</p>
<p>� �
</p>
<p>k
</p>
<p>�ai
</p>
<p>�
</p>
<p>D
�
</p>
<p>I&#127;3k
</p>
<p>0
</p>
<p>�
</p>
<p>D
�
</p>
<p>pI.iC jC k/ � k
0
</p>
<p>�
</p>
<p>D pI
�
</p>
<p>i � j
0
</p>
<p>�
</p>
<p>W3M3t32 D
�
</p>
<p>I&#127;3 O
</p>
<p>O O
</p>
<p>� �
</p>
<p>j
</p>
<p>�.a=2/.iC 2k/
</p>
<p>�
</p>
<p>D
�
</p>
<p>I&#127;3j
</p>
<p>0
</p>
<p>�
</p>
<p>D
�
</p>
<p>pI.iC jC k/ � j
0
</p>
<p>�
</p>
<p>D pI
�
</p>
<p>�iC k
0
</p>
<p>�
</p>
<p>W3M3t33 D
�
</p>
<p>I&#127;3 O
</p>
<p>O O
</p>
<p>� �
</p>
<p>i
</p>
<p>�.a=2/j
</p>
<p>�
</p>
<p>D
�
</p>
<p>I&#127;3i
</p>
<p>0
</p>
<p>�
</p>
<p>D
�
</p>
<p>pI.iC jC k/ � i
0
</p>
<p>�
</p>
<p>D pI
�
</p>
<p>j � k
0
</p>
<p>�
</p>
<p>where 0 now denotes the three-dimensional zero vector. Therefore,
</p>
<p>WMT D pI
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
4
</p>
<p>0 0 0
</p>
<p>0 0 0
</p>
<p>i �i 0
0 0 0
</p>
<p>i � j �iC k j � k
0 0 0
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
5
</p>
<p>and hence,
</p>
<p>TTWMT D pI
</p>
<p>2
</p>
<p>4
</p>
<p>0 1 �1
�1 0 1
1 �1 0
</p>
<p>3
</p>
<p>5
</p>
<p>which turns out to be skew-symmetric. Notice, however, that this will not
always be the case. The reason why the above product turned out to be skew-
symmetric in this example is that the individual matrices Wi and Mi commute,
a consequence of the assumed inertial isotropy, which leads to the isotropy of
matrices Ii , for i D 1, 2, and 3. Now, we have
</p>
<p>TTM PTC TTWMT D pA
</p>
<p>with A defined as</p>
<p/>
</div>
<div class="page"><p/>
<p>328 7 Dynamics of Serial Robotic Manipulators
</p>
<p>A �
</p>
<p>2
</p>
<p>4
</p>
<p>�.3=4/a2m .7=4/a2mC I �.1=2/a2m � 2I
�.1=2/a2m � I 0 .1=4/a2mC 2I
.3=4/a2mC I .1=4/a2m � 2I 0
</p>
<p>3
</p>
<p>5
</p>
<p>Hence, the term of Coriolis and centrifugal forces is
</p>
<p>.TTM PTC TTWMT/ P� D p2
2
</p>
<p>4
</p>
<p>.1=2/a2m � I
�.1=4/a2mC I
</p>
<p>a2m � I
</p>
<p>3
</p>
<p>5
</p>
<p>thereby completing the desired calculations.
</p>
<p>Now, in order to verify the correctness of the above results, we will compute
the same term using the Newton&ndash;Euler algorithm. To this end, we set R�i D 0, for
i D 1, 2, and 3, in that algorithm, and calculate the desired expression as the torque
required to produce the joint rates given above.
</p>
<p>Since we have already calculated the angular velocities, we will skip these calcu-
lations here and limit ourselves to center-of-mass velocities, angular accelerations,
and center-of-mass accelerations. We thus have
</p>
<p>Pc1 D !1 � �1 D pk �
�
</p>
<p>�1
2
a
</p>
<p>�
</p>
<p>.i � j/ D �1
2
ap.iC j/
</p>
<p>Pc2 D Pc1 C!1 � .a1 � �1/C!2 � �2
</p>
<p>D 1
2
apŒ�i � j � k � .iC j/C .jC k/ � .iC j � k/&#141; D �1
</p>
<p>2
ap.3iC jC k/
</p>
<p>Pc3 D Pc2 C!2 � .a2 � �2/C!3 � �3
</p>
<p>D �1
2
apŒ3iC jC kC .jC k/ � .iC k/ � .iC jC k/ � .2iC k/&#141;
</p>
<p>D �1
2
ap.3iC jC 2k/
</p>
<p>Now, the acceleration calculations are implemented recursively, which yields
</p>
<p>P!1 D R�1e1 D 0
P!2 D P!1 C!1 � P�2e2 D p2k � j D �p2i
P!3 D P!2 C!2 � P�3e3 D �p2iC p2.jC k/ � i D �p2.i � jC k/
</p>
<p>Rc1 D P!1 � �1 C!1 � .!1 � �1/ D ap2k �
�
</p>
<p>k � 1
2
.�iC j/
</p>
<p>�
</p>
<p>D 1
2
ap2.i � j/
</p>
<p>Rc2 D Rc1 C P!1 � .a1 � �1/C!1 � Œ!1 � .a1 � �1/&#141;C P!2 � �2
</p>
<p>C!2 � .!2 � �2/ D
1
</p>
<p>2
ap2.i � j/C 0C 1
</p>
<p>2
ap2.iC j/</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 329
</p>
<p>�1
2
ap2.jC 2k/C 1
</p>
<p>2
ap2.�2i � 3jC 3k/ D 1
</p>
<p>2
ap2.�4jC k/
</p>
<p>Rc3 D Rc2 C P!2 � .a2 � �2/C!2 � Œ!2 � .a2 � �2/&#141;C P!3 � �3
</p>
<p>D C!3 � .!3 � �3/ D
1
</p>
<p>2
ap2.�4jC k/ � 1
</p>
<p>2
ap2jC 1
</p>
<p>2
ap2.2i � jC k/
</p>
<p>C 1
2
ap2.i � j � 2k/C 1
</p>
<p>2
ap2.�3iC 3j/ D �2ap2j
</p>
<p>With the foregoing values, we can now implement the inward Newton&ndash;Euler
recursions, namely,
</p>
<p>fP3 D m3 Rc3 � f D �m.2ap2j/ � 0 D �2amp2j
nP3 D I3 P!3 C!3 � I3!3 � nC �3 � fP3
D �Ip2.i � jC k/C 0 � 0 � a2mp2.�iC 2k/
D �Ip2.i � jC k/C a2mp2.i � 2k/
</p>
<p>fP2 D m2 Rc2 C fP3 D
1
</p>
<p>2
amp2.�4jC k/ � amp2j D 1
</p>
<p>2
amp2.�6jC k/
</p>
<p>nP2 D I2 P!2 C!2 � I2!2 C nP3 C .a2 � �2/ � fP3 C �2 � fP2
</p>
<p>D �p2I iC 0 � Ip2.i � jC k/C 1
2
a2mp2.i � 2k/C a2mp2i
</p>
<p>C 1
4
a2mp2.�4i � j � 6k/ D �Ip2.2i � jC k/C 1
</p>
<p>4
a2mp2.2i � j � 10k/
</p>
<p>fP1 D m1 Rc1 C fP2 D
1
</p>
<p>2
amp2.i � j/C 1
</p>
<p>2
amp2.�6jC k/
</p>
<p>D 1
2
amp2.i � 7jC k/
</p>
<p>nP1 D I1 P!1 C!1 � I1!1 C nP2 C .a1 � �1/ � fP2 C �1 � fP1
</p>
<p>D 0C 0 � p2I.2i � jC k/C 1
4
a2mp2.2i � j � 10k/
</p>
<p>�1
4
a2mp2.i � j � 6k/C 1
</p>
<p>4
a2mp2.iC j � 6k/
</p>
<p>D �Ip2.2i � jC k/C 1
4
a2mp2.2iC jC 2k/
</p>
<p>and hence,
</p>
<p>�3 D nP3 � e3 D �Ip2 C a2mp2</p>
<p/>
</div>
<div class="page"><p/>
<p>330 7 Dynamics of Serial Robotic Manipulators
</p>
<p>�2 D nP2 � e2 D Ip2 �
1
</p>
<p>4
a2mp2
</p>
<p>�1 D nP1 � e1 D �Ip2 C
1
</p>
<p>2
a2mp2
</p>
<p>thereby completing the calculation of the term containing Coriolis and centrifugal
forces, i.e.,
</p>
<p>C.�; P�/ P� D
</p>
<p>2
</p>
<p>4
</p>
<p>�Ip2 C .1=2/a2mp2
Ip2 � .1=4/a2mp2
�Ip2 C a2mp2
</p>
<p>3
</p>
<p>5
</p>
<p>As the reader can verify, the natural orthogonal complement and the Newton&ndash;Euler
algorithm produce the same result. In the process, the reader may have realized that
when performing calculations by hand, the Newton&ndash;Euler algorithm is more prone
to errors than the natural orthogonal complement, which is more systematic, for it
is based on matrix&ndash;times&ndash;vector multiplications.
</p>
<p>7.6.1 Planar Manipulators
</p>
<p>The application of the natural orthogonal complement to planar manipulators is
straightforward. Here, we assume that the manipulator at hand is composed of
n links coupled by n joints of the revolute or the prismatic type. Moreover,
for conciseness, we assume that the first link, labeled the base, is fixed to an
inertial frame. We now adopt the planar representation of the twists and wrenches
introduced in Sect. 5.7; that is, we define the twist of the i th link and the wrench
acting on it as three-dimensional arrays, namely,
</p>
<p>ti �
�
</p>
<p>!i
Pci
</p>
<p>�
</p>
<p>; wi �
�
</p>
<p>ni
fi
</p>
<p>�
</p>
<p>(7.107)
</p>
<p>where!i is the scalar angular velocity of this link; Pci is the two-dimensional velocity
of its center of mass, Ci ; ni is the scalar moment acting on the link; and fi is the
two-dimensional force acting at Ci . Moreover, the inertia dyad is now a 3�3matrix,
i.e.,
</p>
<p>Mi �
�
</p>
<p>Ii 0
T
</p>
<p>0 mi1
</p>
<p>�
</p>
<p>(7.108)
</p>
<p>with Ii defined as the scalar moment of inertia of the i th link about an axis passing
through its center of mass, in the direction normal to the plane of motion, while 0 is
the two-dimensional zero vector and 1 is the 2 � 2 identity matrix.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 331
</p>
<p>Furthermore, the Newton&ndash;Euler equations of the i th link take on the forms
</p>
<p>ni D Ii P!i (7.109a)
fi D mi Rci (7.109b)
</p>
<p>and so, these equations can now be cast in the form
</p>
<p>Mi Pti D wWi C wCi ; i D 1; : : : ; n (7.110)
</p>
<p>where we have decomposed the total wrench acting on the i th link into its working
component wWi , supplied by the environment and accounting for motor and joint
dissipative torques, and wCi , the nonworking constraint wrench, supplied by the
neighboring links via the coupling joints. The latter, it is recalled, develop no power,
their sole role being to keep the links together. An essential difference from the
general six-dimensional counterpart of the foregoing equation, namely, Eq. (7.48),
is the lack of a quadratic term in !i in Eq. (7.109a) and consequently, the lack of a
WiMi ti term in Eq. (7.110).
</p>
<p>Upon assembling the foregoing 3n equations of motion, we obtain a system of
3n uncoupled equations in the form
</p>
<p>MPt D wW C wC
</p>
<p>Now, the wrench wW accounts for active forces and moments exerted on the
manipulator, and so we can decompose this wrench into an actuator-supplied wrench
wA and a gravity wrench wG .
</p>
<p>In the next step of the formulation, we set up the kinematic constraints in linear
homogeneous form, as in Eq. (7.50), with the difference that now, in the presence
of n kinematic pairs of the revolute or the prismatic type, K is a 3n � 3n matrix.
Moreover, we set up the twist&ndash;shape relations in the form of Eq. (7.56), except
that now, T is a 3n � n matrix. The derivation of the Euler&ndash;Lagrange equations
for planar motion using the natural orthogonal complement, then, parallels that of
general three-dimensional motion, the model sought taking the form
</p>
<p>I.�/ R� C C.�; P�/ P� D � C &#13; C ı (7.111a)
</p>
<p>with the definitions
</p>
<p>I.�/ � TTMT; C.�; P�/ � TTM PT; (7.111b)
� � TTwA; &#13; � TTwG ; ı � TTwD (7.111c)
</p>
<p>We can illustrate best this formulation with the aid of the example below.</p>
<p/>
</div>
<div class="page"><p/>
<p>332 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Example 7.6.2 (Dynamics of a Planar Three-Revolute Robot). Derive the model of
the robot of Fig. 7.1, under the assumptions of Example 7.3.1, but now using the
natural orthogonal complement.
</p>
<p>Solution: We start by deriving all kinematics-related variables, and thus,
</p>
<p>!1 D P�1; !2 D P�1 C P�2; !3 D P�1 C P�2 C P�3
</p>
<p>Furthermore,
</p>
<p>t1 D P�1t11
t2 D P�1t21 C P�2t22
t3 D P�1t31 C P�2t32 C P�3t33
</p>
<p>where
</p>
<p>t11 D
�
</p>
<p>1
</p>
<p>Es11
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>E�1
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>.1=2/Ea1
</p>
<p>�
</p>
<p>t21 D
�
</p>
<p>1
</p>
<p>Es21
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>E.a1 C �2/
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>E.a1 C .1=2/a2/
</p>
<p>�
</p>
<p>t22 D
�
</p>
<p>1
</p>
<p>Es22
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>E�2
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>.1=2/Ea2
</p>
<p>�
</p>
<p>t31 D
�
</p>
<p>1
</p>
<p>Es31
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>E.a1 C a2 C �3/
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>E.a1 C a2 C .1=2/a3/
</p>
<p>�
</p>
<p>t32 D
�
</p>
<p>1
</p>
<p>Es32
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>E.a2 C �3/
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>E.a2 C .1=2/a3/
</p>
<p>�
</p>
<p>t33 D
�
</p>
<p>1
</p>
<p>E�3
</p>
<p>�
</p>
<p>D
�
</p>
<p>1
</p>
<p>.1=2/Ea3
</p>
<p>�
</p>
<p>and hence, the 9 � 3 twist-shaping matrix T becomes
</p>
<p>T D
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
4
</p>
<p>1 0 0
</p>
<p>.1=2/Ea1 0 0
</p>
<p>1 1 0
</p>
<p>E.a1 C .1=2/a2/ .1=2/Ea2 0
1 1 1
</p>
<p>E.a1 C a2 C .1=2/a3/ E.a2 C .1=2/a3/ .1=2/Ea3
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
5
</p>
<p>The 9 � 9 matrix of inertia dyads of this manipulator now takes the form
</p>
<p>M D diag.M1; M2; M3/</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 333
</p>
<p>with each 3 � 3 Mi matrix defined as
</p>
<p>Mi �
�
</p>
<p>Ii 0
T
</p>
<p>0 mi1
</p>
<p>�
</p>
<p>Now, the 3 � 3 generalized inertia matrix is readily derived as
</p>
<p>I � TTMT
</p>
<p>whose entries are given below:
</p>
<p>I11 D tT11M1t11 C tT21M2t21 C tT31M3t31
I12 D tT21M2t22 C tT31M3t32 D I21
I13 D tT31M3t33 D I31
I22 D tT22M2t22 C tT32M3t32
I23 D tT32M3t33 D I32
I33 D tT33M3t33
</p>
<p>Upon expansion, the above entries result in exactly the same expressions as those
derived in Example 7.3.1, thereby confirming the correctness of the two derivations.
Furthermore, the next term in the Euler&ndash;Lagrange equations is derived below. Here,
we will need PT, which is readily derived from the above expression for T. In deriving
this time-derivative, we note that in general, for i D 1; 2; 3,
</p>
<p>Pai D !iEai ; E2ai D �ai
</p>
<p>and hence,
</p>
<p>PT D �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
4
</p>
<p>0 0 0
</p>
<p>.1=2/ P�1a1 0 0
0 0 0
</p>
<p>P�1a1 C .1=2/ P�12a2 .1=2/ P�12a2 0
0 0 0
</p>
<p>P�1a1 C P�12a2 C .1=2/ P�123a3 P�12a2 C .1=2/ P�123a3 .1=2/ P�123a3
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
5
</p>
<p>where P�12 and P�123 stand for P�1 C P�2 and P�1 C P�2 C P�3, respectively.
We now can perform the product TTM PT, whose .i; j / entry will be represented
</p>
<p>as �ij . Below we display the expressions for these entries:
</p>
<p>�11 D �
1
</p>
<p>2
Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�2 �
</p>
<p>m3
</p>
<p>2
.a1a3s23 C a2a3s3/ P�3
</p>
<p>�12 D �
1
</p>
<p>2
Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141;. P�1 C P�2/</p>
<p/>
</div>
<div class="page"><p/>
<p>334 7 Dynamics of Serial Robotic Manipulators
</p>
<p>�1
2
m3.a1a3s23 C a2a3s3/ P�3
</p>
<p>�13 D �
1
</p>
<p>2
m3.a1a3s23 C a2a3s3/. P�1 C P�2 C P�3/
</p>
<p>�21 D
1
</p>
<p>2
Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�1 �
</p>
<p>1
</p>
<p>2
m3a2a3s3 P�3
</p>
<p>�22 D �
1
</p>
<p>2
m3a2a3s3 P�3
</p>
<p>�23 D �
1
</p>
<p>2
m3a2a3s3. P�1 C P�2 C P�3/
</p>
<p>�31 D
1
</p>
<p>2
m3Œ.a1a3s23 C a2a3s3/ P�1 C a2a3s3 P�2&#141;
</p>
<p>�32 D
1
</p>
<p>2
m3a2a3s3. P�1 C P�2/
</p>
<p>�33 D 0
</p>
<p>Now, let us define
</p>
<p>� � TTM PT P�
</p>
<p>whose three components are given below:
</p>
<p>�1 D �Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�1 P�2 �m3.a1a3s23 C a2a3s3/ P�1 P�3
</p>
<p>�1
2
Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�22
</p>
<p>�m3.a1a3s23 C a2a3s3/ P�2 P�3 �
1
</p>
<p>2
m3.a1a3s23 C a2a3s3/ P�23
</p>
<p>�2 D
1
</p>
<p>2
Œm2a1a2s2 Cm3.2a1a2s2 C a1a3s23/&#141; P�21 �m3a2a3s3 P�1 P�3
</p>
<p>�m3a2a3s3 P�2 P�3 �
1
</p>
<p>2
m3a2a3s3 P�23
</p>
<p>�3 D
1
</p>
<p>2
m3.a1a3s23 C a2a3s3/ P�21 Cm3a2a3s3 P�1 P�2 C
</p>
<p>1
</p>
<p>2
m3a2a3s3 P�23
</p>
<p>The mathematical model sought, thus, takes the form
</p>
<p>I.�/ R� C �.�; P�/ D � C &#13;
</p>
<p>where ı D 0 because we have not included dissipation. Moreover, &#13; is derived as
described below: Let wGi be the gravity wrench acting on the i th link, w
</p>
<p>G then being</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 335
</p>
<p>wG D
</p>
<p>2
</p>
<p>4
</p>
<p>wG1
wG2
wG3
</p>
<p>3
</p>
<p>5
</p>
<p>and
</p>
<p>wG1 D
�
</p>
<p>0
</p>
<p>�m1gj
</p>
<p>�
</p>
<p>; wG2 D
�
</p>
<p>0
</p>
<p>�m2gj
</p>
<p>�
</p>
<p>; wG3 D
�
</p>
<p>0
</p>
<p>�m3gj
</p>
<p>�
</p>
<p>Therefore,
</p>
<p>&#13; D TTwG
</p>
<p>i.e.,
</p>
<p>&#13; D g
2
</p>
<p>2
</p>
<p>4
</p>
<p>m1a
T
1 EjCm2.2a1 C a2/TEjCm3Œ2.a1 C a2/C a3/TEj
</p>
<p>m2a
T
1 EjCm3.2a2 C a3/TEj
</p>
<p>m3a
T
3 Ej
</p>
<p>3
</p>
<p>5
</p>
<p>But
</p>
<p>aT1 Ej D �aT1 i D �a1 cos �1
aT2 Ej D �aT2 i D �a2 cos.�1 C �2/
aT3 Ej D �aT3 i D �a3 cos.�1 C �2 C �3/
</p>
<p>Hence,
</p>
<p>&#13; D g
2
</p>
<p>2
</p>
<p>4
</p>
<p>�m1a1c1 � 2m2.a1c1 C a2c12/ � 2m3.a1c1 C a2c12 C a3c123/
�m2a2c12 � 2m3.a2c12 C a3c123/
</p>
<p>�m3a3c123
</p>
<p>3
</p>
<p>5
</p>
<p>with the definitions for c1, c12, and c123 introduced in Example 7.3.1. As the reader
can verify, the foregoing model is identical to the model derived with the Euler&ndash;
Lagrange equations in that example.
</p>
<p>7.6.2 Algorithm Complexity
</p>
<p>The complexity of this algorithm is analyzed with regard to the three items involved,
namely, (a) the evaluation of L, (b) the solution of systems (7.105a and b), and (c)
the computation of �.</p>
<p/>
</div>
<div class="page"><p/>
<p>336 7 Dynamics of Serial Robotic Manipulators
</p>
<p>The evaluation of L involves, in turn, the three following steps: (a) the computa-
tion of P; (b) the computation of I; and (c) the Cholesky decomposition of I into the
product LTL.
</p>
<p>Algorithm 7.6.1:
</p>
<p>For j=1 to n step 1 do
</p>
<p>rjj  Œ�j &#141;jC1
</p>
<p>pjj  
�
</p>
<p>Nj ej
</p>
<p>nj ej � rjj
</p>
<p>�
</p>
<p>jC1
</p>
<p>For i=j+1 to n step 1 do
</p>
<p>ej  QTi Œ ej &#141;i
</p>
<p>if R then
</p>
<p>rij  QTi Œ ri�1;j C ıi�1 &#141;i C Œ�i &#141;iC1
</p>
<p>pij  
�
</p>
<p>Niej
</p>
<p>niej � rij
</p>
<p>�
</p>
<p>iC1
else
</p>
<p>pij  
�
</p>
<p>0
</p>
<p>niej
</p>
<p>�
</p>
<p>iC1
endif
</p>
<p>enddo
</p>
<p>enddo
</p>
<p>(i.a) In the computation of P, it is recalled that Hi , ai , and �i , and consequently,
ıi � ai � �i , are constant in FiC1, which is the frame fixed to the i th link.
Moreover, at each step of the algorithm, both revolute and prismatic pairs are
considered. If the j th joint is a revolute, then the logical variable R is true;
if this joint is prismatic, then R is false. Additionally, it is recalled that eiC1,
in Fi -coordinates, is simply the last column of Qi . The columnwise evaluation
of P, with each pij array in FiC1-coordinates, is described in Algorithm 7.6.1.
Note that in this algorithm, rij is calculated recursively from ri�1;j . To do this,
we use the relation between these two vectors, as displayed in Fig. 7.8.
</p>
<p>(i.b) Now we go on to the computation of I, as described in Algorithm 7.6.2. In
that algorithm, the subscripted brackets indicate that the vectors inside these
brackets are represented in FkC1 coordinates.
</p>
<p>(i.c) Because the Cholesky decomposition of a positive-definite matrix is a standard
item, it is not discussed here. This step completes the computation of L.
</p>
<p>(ii) The solution of systems (7.105a and 7.105b) is a standard issue as well, and
hence, needs no further discussion.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 337
</p>
<p>Fig. 7.8 Recursive calculation of vectors rij
</p>
<p>(iii) The term � is computed using the recursive Newton&ndash;Euler formulation, as
discussed in Sect. 7.4. To do this, we calculate � by setting R� D 0 in that
procedure, which introduces a slight simplification of the complexity of the
inverse-dynamics algorithm.
</p>
<p>Algorithm 7.6.2:
</p>
<p>For j=1 to n step 1 do
</p>
<p>Ijj  
Pn
</p>
<p>kDj Œp
T
kjpkj &#141;kC1
</p>
<p>For i=j+1 to n step 1 do
</p>
<p>Iij  Ij i  
Pn
</p>
<p>kDi Œp
T
kipkj &#141;kC1
</p>
<p>enddo
</p>
<p>enddo
</p>
<p>Below we determine the computational complexity of each of the foregoing
steps.
</p>
<p>(i.a) This step includes Algorithm 7.6.1, which involves two nested do-loops. The
first statement of the outermost loop involves no floating-point operations;
the second statement involves (a) one multiplication of a matrix by a vector,
(b) one cross product, and (c) one multiplication of a scalar, nj .D pmj /,
by a vector, Œ ej &#141;jC1, which, according to Eq. (4.15), equals oj , the third
row of Qj . In light of Eq. (4.7), this vector involves only two nonzero
components, the product nj Œ ej &#141;jC1 thus consuming only two multiplications</p>
<p/>
</div>
<div class="page"><p/>
<p>338 7 Dynamics of Serial Robotic Manipulators
</p>
<p>and zero additions. Of the last three items, (a) is done off-line, for the matrix
and the vector factors are both constant in FjC1-coordinates, and so, this
operation is not counted. Moreover, item (b) is nothing but the cross product
of vector Œ ej &#141;jC1 � Œ 0; 0; 1 &#141;T by vector rjj . A similar operation was
already discussed in connection with Algorithm 4.1 and was found to involve
zero floating-point operations, for the result is, simply, Œ ej � rjj &#141;jC1 D
Œ�y; x; 0 &#141;T , with x and y denoting the XjC1 and YjC1 components of rjj .
Hence, item (b) requires no floating-point operations, while item (c) requires
2n multiplications and zero additions.
</p>
<p>The innermost do-loop, as pertaining to revolute manipulators, involves two
coordinate transformations between two consecutive coordinate frames, from
Fi - to FiC1-coordinates, plus one vector sum, which consumes 16.n � i/
multiplications and 11.n � i/ additions; this loop also consumes one matrix-
times-vector multiplication, one cross product and one scalar-times-vector
multiplication, which requires 18.n�i/multiplications and 9.n�i/ additions.
Thus, the total numbers of operations required by this step, for an n-revolute
manipulator, are Mia multiplications and Aia additions, as given below:
</p>
<p>Mia D 2nC
n
X
</p>
<p>iD1
34.n � i/ D 17n2 � 15n (7.112a)
</p>
<p>Aia D
n
X
</p>
<p>iD1
20.n � i/ D 10n2 � 10n (7.112b)
</p>
<p>the presence of prismatic pairs reducing the above figures.
(i.b) This step, summarized in Algorithm 7.6.2, is also composed of two do-loops,
</p>
<p>each containing the inner product of two six-dimensional arrays, and hence,
requires six multiplications and five additions. Moreover, in the outermost
do-loop, this operation is performed n times, whereas in the innermost loop,
Pn
</p>
<p>iD1.n � i/ times, i.e., n.n � 1/=2 times. Thus, the step requires Mib
multiplications and Aib additions, as given below:
</p>
<p>Mib D 3n2 C 3n; Aib D
5
</p>
<p>2
n2 C 5
</p>
<p>2
n (7.113)
</p>
<p>(i.c) This step performs the Cholesky decomposition of a n � n symmetric and
positive-definite matrix, a standard operation that requiresMic multiplications
and Aic additions (Dahlquist and Bj&ouml;rck 1974), namely,
</p>
<p>Mic D
1
</p>
<p>6
n3 C 1
</p>
<p>2
n2 C 1
</p>
<p>3
n; Aic D
</p>
<p>1
</p>
<p>6
n3 C 1
</p>
<p>2
n2 C 1
</p>
<p>3
n (7.114)
</p>
<p>(ii) In this step, the two triangular systems of equations, Eqs. (7.105a and b),
are solved first for x and then for R� . The numbers of operations it takes to
solve each of the two systems, as derived by Dahlquist and Bj&ouml;rck (1974),</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 339
</p>
<p>are repeated below for quick reference; these are labelled Mi i and Ai i ,
respectively, i.e.,
</p>
<p>Mi i D n2; Ai i D n2 � n (7.115)
</p>
<p>(iii) In this step, � is computed from inverse dynamics, with wD D 0 and R� D 0.
If this calculation is done with the Newton&ndash;Euler formulation, we then have
the computational costs given in Eq. (7.43), and reproduced below for quick
reference:
</p>
<p>Mi i i D 137n � 22; Ai i i D 110n � 14 (7.116)
</p>
<p>Because of the simplifications introduced by setting the joint accelerations equal
to zero, the foregoing figures are, in fact, slightly lower than those required by the
general recursive Newton&ndash;Euler algorithm.
</p>
<p>Thus, the total numbers of multiplications and additions required for the forward
dynamics of a n-revolute, serial manipulator are
</p>
<p>Mf D
1
</p>
<p>6
n3 C 37
</p>
<p>2
n2 C 367
</p>
<p>3
n � 22; Af D
</p>
<p>1
</p>
<p>6
n3 C 23
</p>
<p>2
n2 C 298
</p>
<p>3
n � 14 (7.117)
</p>
<p>In particular, for a six-revolute manipulator, one obtains
</p>
<p>Mf D 1; 450; Af D 1; 068 (7.118)
</p>
<p>Upon introducing a modified Denavit&ndash;Hartenberg labeling of coordinate frames and
a very careful management of the computations involved the number of floating-
point operations became 1,353 multiplications and 1,165 additions (Angeles and
Ma 1988). Nevertheless, the total number of operations, 2,518, remained the same.
</p>
<p>7.6.3 Simulation
</p>
<p>The purpose of the algorithm introduced above is to enable us to predict the behavior
of a given manipulator under given initial conditions, applied torques, and applied
loads. The ability of predicting this behavior is important for several reasons: for
example, in design, we want to know whether with a given selection of motors,
the manipulator will be able to perform a certain typical task in a given time
frame; in devising feedback control schemes, where stability is a major concern,
the control engineer cannot risk a valuable piece of equipment by exposing it to
untested control strategies. Hence, a facility capable of predicting the behavior of a
robotic manipulator, or of a system at large, for that matter, becomes imperative.
</p>
<p>The procedure whereby the motion of the manipulator is determined from initial
conditions and applied torques and loads is known as simulation. Since we start</p>
<p/>
</div>
<div class="page"><p/>
<p>340 7 Dynamics of Serial Robotic Manipulators
</p>
<p>with a second-order n-dimensional system of ODE in the joint variables of the
manipulator, we have to integrate this system in order to determine the time-histories
of all joint variables, which are grouped in vector � . With current software available,
this task has become routine work, the user being freed from the quite demanding
task of writing code for integrating systems of ODE. Below we discuss a few issues
pertaining to the implementation of the simulation-related algorithms available in
commercial software packages.
</p>
<p>As a rule, simulation code requires that the user supply a state-variable model of
the form of Eq. (7.45), with the state-variable vector, or state-vector for brevity, x,
and the input or control vector u defined as
</p>
<p>x �
�
</p>
<p>�
P�
</p>
<p>�
</p>
<p>�
�
</p>
<p>�
</p>
<p> 
</p>
<p>�
</p>
<p>; u.t/ D �.t/ (7.119)
</p>
<p>With the above definitions, then we can write the state-variable equations, or state
equations for brevity, in the form of Eq. (7.45), with f.x; �/ given by
</p>
<p>f.x; �/ �
�
</p>
<p> 
</p>
<p>�I.�/�1ŒC.�; / � ı.�; / � &#13;.�/&#141;C I.�/�1�.t/
</p>
<p>�
</p>
<p>(7.120)
</p>
<p>thereby obtaining a system of 2n first-order ODE in the state-variable vector x
defined above. Various methods are available to solve the ensuing initial-value
problem, all of them being based on a discretization of the time variable. That is, if
the behavior of the system is desired in the interval t0 � t � tF , then the software
implementing these methods provides approximations f yk gN1 to the state-variable
vector at a discrete set of instants, f tk gN0 , with tN � tF .
</p>
<p>The variety of methods available to solve the underlying initial-value problem
can be classified into two main categories, explicit methods and implicit methods.
The former provide ykC1 explicitly in terms of previously computed values. On the
contrary, implicit methods provide ykC1 in terms of previously computed values yk ,
yk�1, : : :, etc., and ykC1 itself. For example, in the simplest of implicit methods,
namely, the backward Euler method, we can approximate the integral of f in the
interval tk � t � tkC1 by resorting to the trapezoidal rule (Kahaner et al. 1989),
which leads to the expression
</p>
<p>ykC1 D yk C hkf.tkC1; ykC1/ (7.121)
</p>
<p>In Eq. (7.121), hk is the current time-step tkC1 � tk and f.tkC1; ykC1/ can be an
arbitrary function of ykC1. If this function is nonlinear in the said variable, then,
a direct&mdash;as opposed to iterative&mdash;computation of ykC1 is very unlikely. Hence,
most likely an iterative scheme must be implemented at every integration stage of
an implicit method. While this feature might render implicit schemes unattractive,
they offer interesting advantages. Indeed, the iterative procedure mentioned above
requires a tolerance to decide when and whether the procedure has converged. The</p>
<p/>
</div>
<div class="page"><p/>
<p>7.6 Manipulator Forward Dynamics 341
</p>
<p>convergence criterion imposed thus brings about a self-correcting effect that helps
keep the unavoidable truncation error under control. This error is incurred when
approximating both the time derivative Px and the integral of f by floating-point
operations.
</p>
<p>Current software provides routines for both implicit and explicit methods, the
user having to decide which method to invoke. Of the explicit methods in use,
by far the most common ones are the Runge&ndash;Kutta methods. Of these, there are
several versions, depending on the number of evaluations of the function f.ti ; yi /,
for various values of i , that they require. A two-stage Runge&ndash;Kutta method, for
example, requires two function evaluations, while a four-stage Runge&ndash;Kutta method
requires four. The self-correcting feature of implicit methods, not present in Runge&ndash;
Kutta methods&mdash;to be sure, implicit Runge&ndash;Kutta methods also exist (Gear 1971),
but these are less common than their explicit counterparts&mdash;is compensated for by a
clever strategy that consists in computing ykC1 using two Runge&ndash;Kutta schemes of
different numbers of stages. What is at stake here is the magnitude of the local error
in computing ykC1, under the assumption that yk is error-free. Here, the magnitude
of the error is of order hp , where p is the order of the method in use. In Runge&ndash;Kutta
methods, the order of the method is identical to its number of stages. In general, a
method is said to be of order p if it is capable of computing exactly the integral of
an ordinary differential equation, provided that the solution is known to be a pth-
degree polynomial. Now, upon computing ykC1 using two Runge&ndash;Kutta schemes
with N and N C 1 stages, we can compare the two computed values reported by
each method, namely, yNkC1 and y
</p>
<p>NC1
kC1 . If a norm of the difference of these two values
</p>
<p>is smaller than a user-prescribed tolerance, then the step size in use is acceptable. If
not, then the step size is halved, and the process is repeated until the foregoing norm
is within the said tolerance. The most common Runge&ndash;Kutta methods are those
combining two and three stages and those combining four and five.
</p>
<p>A drawback of Runge&ndash;Kutta methods is their inability to deal with what are
known as stiff systems, first identified by Gear (1971). As defined by Shampine
and Gear (1979), a system of ordinary differential equations is said to be stiff if
it is not unstable and its linear part&mdash;i.e., the linear part of the series expansion
of f, evaluated at the current instant&mdash;comprises a coefficient matrix that has an
eigenvalue with a negative real part whose absolute value is much greater than that
of the other eigenvalues. In other words, stiff systems of ODE are stable systems
with very different time scales. Thus, stiff systems are not inherently difficult to
integrate, but they require a special treatment. Gear&rsquo;s method, which is implicit,
provides exactly the means to handle stiff systems. However, methods like Runge&ndash;
Kutta&rsquo;s, with excellent performance for nonstiff systems, perform rather poorly for
stiff systems, and the other way around. The mathematical models that arise in
robotic mechanical systems are likely to be stiff because of the various orders of
magnitude of the physical parameters involved. For example, robotic manipulators
are provided, usually, with links close to the base that are heavy and with links far
from the base that are light. As a consequence, when simulating robotic mechanical
systems, a provision must be made for numerical stiffness.</p>
<p/>
</div>
<div class="page"><p/>
<p>342 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Commercial software for scientific computations offers Runge&ndash;Kutta methods
of various orders, with combinations thereof. For example, IMSL offers excellent
FORTRAN routines, like IVPRK, for the implementation of Runge&ndash;Kutta methods,
while Matlab&rsquo;s Simulink toolbox offers the C functions ode23 and ode45 for the
implementation of second-and-third and fourth-and-fifth-order Runge&ndash;Kutta meth-
ods. With regard to stiff systems, IMSL offers a subroutine, IVPAG, implementing
both Adams&rsquo;s and Gear&rsquo;s methods, while Simulink offers the adams and gear
functions for the implementation of either of these. Since Matlab is written in C,
communication between Matlab and FORTRAN programs is not as direct as when
using IMSL, which may be disappointing to FORTRAN users. Details on linking
FORTRAN code with Matlab and other related issues are discussed in the pertinent
literature (Etter 1997). Moreover, the FORTRAN SDRIV2 subroutine (Kahaner
et al. 1989) comprises features that allow it to handle both stiff and nonstiff systems.
</p>
<p>7.7 Incorporation of Gravity into the Dynamics Equations
</p>
<p>Manipulators subjected to gravity fields have been discussed in Sect. 7.4 in connec-
tion with the Newton&ndash;Euler algorithm and with Kane&rsquo;s equations. As found in that
section, gravitational forces can be incorporated into the underlying models without
introducing any major modifications that would increase the computational load
if the method of Luh et al. (1980) is adopted. Within this approach, gravitational
forces are taken into account by defining the acceleration of the center of mass of
the 0th link, the base link, as equal to �g, the negative of the gravity-acceleration
vector. The effect of this approach is to propagate the gravity effect into all the links
composing the manipulator. Thus, the kinematics algorithm of Sect. 7.4 need not be
modified in order to include gravity forces, for all that is needed is to declare
</p>
<p>Œ Rc0 &#141;1  Œ�g &#141;1 (7.122)
</p>
<p>If inverse dynamics is computed with the natural orthogonal complement, then the
twist-rate of the first link will have to be modified by adding a nonhomogeneous
term to it, thereby accounting for the gravity-acceleration terms. That is,
</p>
<p>Pt1  R�1t11 C P�1Pt11 C
�
</p>
<p>0
</p>
<p>�g
</p>
<p>�
</p>
<p>(7.123)
</p>
<p>Otherwise, the foregoing algorithms require no modifications. Furthermore, with
regard to simulation, it is pointed out that the � term defined in Eq. (7.104), and
appearing in the right-hand side of Eq. (7.105a), is computed from inverse dynamics
with zero frictional forces and zero joint accelerations.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.8 The Modeling of Dissipative Forces 343
</p>
<p>7.8 The Modeling of Dissipative Forces
</p>
<p>Broadly speaking, frictional forces are of two basic types, namely, (a) viscous forces
and (b) Coulomb, or dry-friction, forces. The latter occur when contact between
two solids takes place directly, the former when contact between the solids takes
place via a viscous fluid, e.g., a lubricant. In the analysis of viscous fluids, a basic
assumption is that the relative velocity between the fluid and the solid vanishes
at the fluid&ndash;solid interface, i.e., at the solid boundary confining the fluid. Hence,
a velocity gradient appears within the fluid, which is responsible for the power
dissipation inside it. In fact, not all the velocity gradient within the fluid, but only its
symmetric part, is responsible for power dissipation; the skew-symmetric part of the
velocity gradient accounts for a rigid-body rotation of a small fluid element. Thus,
if a velocity field v.r; t / is defined within a region R occupied by a viscous fluid,
for a point of the fluid of position vector r at a time t , then, the velocity gradient
grad.v/ � @v=@r, can be decomposed as
</p>
<p>grad.v/ D DCW (7.124)
</p>
<p>where D and W are the symmetric and the skew-symmetric parts of the velocity
gradient, i.e.,
</p>
<p>D � 1
2
Œ grad.v/C gradT .v/ &#141;; W � 1
</p>
<p>2
Œ grad.v/ � gradT .v/ &#141; (7.125)
</p>
<p>The kinematic interpretation of D and W is given below: The former accounts for
a distorsion of an infinitesimally small spherical element of fluid into a three-axis
ellipsoid, the ratios of the time rates of change of the lengths of the three axes being
identical to the ratios of the real eigenvalues of D; the latter accounts for the angular
velocity of the ellipsoid as a rigid-body. Clearly, both D and W change from point
to point within the fluid and also from time to time, i.e.,
</p>
<p>D D D.r; t /; W DW.r; t / (7.126)
</p>
<p>Since the skew-symmetric matrix W accounts only for the rotation of a dif-
ferential element of fluid as a rigid body, it cannot be responsible for any energy
dissipation, and hence, the only part that is responsible for this is D. In fact, for a
linearly viscous, incompressible fluid of viscosity coefficient�, the power dissipated
within R is given by
</p>
<p>&hellip;D D
Z
</p>
<p>R
</p>
<p>�tr.D2/dR (7.127)
</p>
<p>Now, if the motion of the lubricant separating the two cylindrical surfaces of a
revolute pair is modeled as a purely tangential velocity field (Currie 1993), which
assumes that the two cylinders remain concentric, then the foregoing expression for
&hellip;D leads to the dissipation function</p>
<p/>
</div>
<div class="page"><p/>
<p>344 7 Dynamics of Serial Robotic Manipulators
</p>
<p>&#129; D 1
2
ˇ P�2 (7.128)
</p>
<p>where P� is the relative angular speed between the two cylinders and the coefficient
ˇ is a function of the lubricant viscosity and the geometry of the kinematic pair at
hand. If the kinematic pair under study is prismatic, then we can model the motion
of the lubricant between the two prismatic surfaces as a Couette flow between a
pair of parallel surfaces of the sides of the prism. Under these conditions, then, the
associated dissipation function&#129; takes on the same form of that given for a revolute
pair in Eq. (7.128), in which the sole difference is that P� changes to Pb, the time rate
of change of the associated joint variable. Of course, Pb is the relative speed between
the two prismatic surfaces. Thus in any event, the dissipation function of the i th
joint due to linearly viscous effects can be written as
</p>
<p>&#129;i D
1
</p>
<p>2
ˇi P�2i (7.129)
</p>
<p>where P�i changes to Pbi if the i th pair is prismatic. The dissipation function thus
arising then reduces to
</p>
<p>&#129; D
n
X
</p>
<p>1
</p>
<p>&#129;i D
1
</p>
<p>2
P�TB P� (7.130)
</p>
<p>where the constant n � n matrix B is given by
</p>
<p>B D diag.ˇ1; ˇ2 ; : : : ; ˇn/ (7.131)
</p>
<p>and hence, the generalized force ıV associated with linearly viscous effects is linear
in the vector of joint rates, P� , i.e.,
</p>
<p>ıV � �@&#129;
@ P�
D �B P� (7.132)
</p>
<p>and so, &#129; D �.1=2/&hellip;D .
Coulomb, or dry friction, is much more difficult to model. If ıCi denotes either
</p>
<p>the dissipative torque produced by Coulomb friction at a revolute or the dissipative
force produced by Coulomb friction at a prismatic joint, and P�i the associated joint
rate, then, the simplest model for the resulting generalized Coulomb-friction force is
</p>
<p>ıCi D ��Ci sgn. P�i / (7.133)
</p>
<p>where sgn.�/ denotes the signum function, which is defined asC1 or �1, depending
on whether its argument is positive or negative, and �Ci is a positive constant
representing a torque for revolute joints or a force for prismatic joints. The numerical</p>
<p/>
</div>
<div class="page"><p/>
<p>7.8 The Modeling of Dissipative Forces 345
</p>
<p>value of this constant is to be determined experimentally. The foregoing model leads
to a simple expression for the associated dissipation function, namely,
</p>
<p>&#129;Ci D �Ci j P�i j (7.134)
</p>
<p>The Coulomb dissipation function for the overall manipulator is, then,
</p>
<p>&#129;C D
n
X
</p>
<p>1
</p>
<p>�Ci j P�i j (7.135)
</p>
<p>The foregoing simplified model of Coulomb friction forces is applicable when
the relative speed between the two surfaces in contact is high. However, at low
relative speed, that model becomes inaccurate. In robotics applications, where
typical end-effector maximum speeds are of the order of 1 m/s, relative speeds
are obviously low, and hence, a more accurate model should be introduced. Such
a model should account for the empirical observation that Coulomb frictional forces
are higher at low relative speeds and become constant at very high relative speeds.
A model taking this fact into account has the form
</p>
<p>ıCi D �.�Ci C �ie�&#13;i j
P�i j/sgn. P�i / (7.136)
</p>
<p>where &#13;i , and �i are constants associated with the i th joint and are to be determined
experimentally. The foregoing expression readily leads to the dissipation function
associated with the same joint, namely,
</p>
<p>&#129;Ci D �Ci j P�i j C
�i
</p>
<p>&#13;i
.1 � e�&#13;i j P�i j/ (7.137)
</p>
<p>and hence, the Coulomb dissipation function of the overall manipulator becomes
</p>
<p>&#129;C D
n
X
</p>
<p>1
</p>
<p>�
</p>
<p>�Ci j P�i j C
�i
</p>
<p>&#13;i
.1 � e�&#13;i j P�i j/
</p>
<p>�
</p>
<p>(7.138)
</p>
<p>Dissipation functions are very useful. On the one hand, they allow us to obtain
associated generalized frictional forces when these are difficult, if not impossible,
to express in formula form. On the other hand, since dissipation functions represent
nonrecoverable forms of power, their integrals over time yield the dissipated energy.
Moreover, the energy dissipated into unrecoverable heat can be estimated from an
energy balance, and hence, the parameters associated with that dissipation function
can be estimated with suitable identification techniques, once a suitable model for
a dissipation function is available. Furthermore, the said parameters appear in the
generalized frictional forces as well. For this reason, knowing these parameters is
essential for the modeling of the corresponding generalized frictional forces.</p>
<p/>
</div>
<div class="page"><p/>
<p>346 7 Dynamics of Serial Robotic Manipulators
</p>
<p>7.9 Exercises
</p>
<p>7.1 Show that:
</p>
<p>(a) the 6n-dimensional manipulator twist lies in the null space of the 6n� 6n
manipulator angular velocity matrix W;
</p>
<p>(b) the time-derivative of the 6n� 6nmanipulator mass matrix M is given by
</p>
<p>PM DWM �MW
</p>
<p>(c)
</p>
<p>d�
</p>
<p>dt
DMPtCWMt
</p>
<p>thereby verifying Eq. (7.15).
</p>
<p>7.2 In order to gain insight into the meaning of vector &#13; , as defined in Exam-
ple 7.3.1, we define a similar vector � as
</p>
<p>� D @.I
P�/
</p>
<p>@�
P�
</p>
<p>Compute � for that example and compare the result with &#13; .
7.3 The decoupled robot of Fig. 4.23 is to undergo a maneuver, at the posture dis-
</p>
<p>played in that figure, that involves the velocity and acceleration specifications
given below, in base coordinates:
</p>
<p>Pc D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5 m=s; ! D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>1
</p>
<p>0
</p>
<p>3
</p>
<p>5 rad=s;
</p>
<p>Rc D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>1
</p>
<p>0
</p>
<p>3
</p>
<p>5 m=s2; P! D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5 rad=s2
</p>
<p>Compute the joint torques required to drive the robot through the desired
maneuver, if the robot is known to have the inertial parameters given below:
</p>
<p>m1 D 10:521; m2 D 15:781; m3 D 8:767;
m4 D 1:052; m5 D 1:052; m6 D 0:351</p>
<p/>
</div>
<div class="page"><p/>
<p>7.9 Exercises 347
</p>
<p>a b c
</p>
<p>Fig. 7.9 Three different pairs of coupled bodies
</p>
<p>�1 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>�0:054
0
</p>
<p>3
</p>
<p>5 ; �2 D
</p>
<p>2
</p>
<p>4
</p>
<p>0:140
</p>
<p>0
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; �3 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>�0:197
0
</p>
<p>3
</p>
<p>5
</p>
<p>�4 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>�0:057
</p>
<p>3
</p>
<p>5 ; �5 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>�0:007
0
</p>
<p>3
</p>
<p>5 ; �6 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>�0:019
</p>
<p>3
</p>
<p>5
</p>
<p>I1 D diag
�
</p>
<p>1:6120 0:5091 1:6120
�
</p>
<p>I2 D diag
�
</p>
<p>0:4898 8:0783 8:2672
�
</p>
<p>I3 D diag
�
</p>
<p>3:3768 0:3009 3:3768
�
</p>
<p>I4 D diag
�
</p>
<p>0:1810 0:1810 0:1273
�
</p>
<p>I5 D diag
�
</p>
<p>0:0735 0:0735 0:1273
�
</p>
<p>I6 D diag
�
</p>
<p>0:0071 0:0071 0:0141
�
</p>
<p>where mi , �i , and Ii are given in units of kg, m and kg m
2, respectively, with
</p>
<p>the position vectors of the centers of mass and the moment-of-inertia matrices
given in link-fixed coordinates. Note: Assume that Z7 is perpendicular to Z5
and Z6, with O7 located at the OP of the EE.
</p>
<p>7.4 Derive homogeneous, linear constraint equations on the twists of the pairs of
coupled bodies appearing in Fig. 7.9, namely,
</p>
<p>(a) two rigid pulleys coupled by an inextensible belt, under no slip;
(b) the bevel pinion-and-gear train with axes intersecting at an arbitrary
</p>
<p>angle ˛;</p>
<p/>
</div>
<div class="page"><p/>
<p>348 7 Dynamics of Serial Robotic Manipulators
</p>
<p>Fig. 7.10 A three-revolute spherical wrist
</p>
<p>(c) the cam-and-follower mechanism whose cam disk is an eccentric circular
disk.
</p>
<p>Notice that the constraint equations sought should have the form:
</p>
<p>At1 C Bt2 D 0
</p>
<p>with t1 and t2 denoting the twists of bodies 1 and 2, respectively.
</p>
<p>7.5 Use the expressions derived in Example 7.6.2 with the aid of the natural
orthogonal complement, as pertaining to the planar manipulator of Fig. 7.1,
to obtain an expression for the time-derivative of the inertia matrix of this
manipulator. Compare the expression thus obtained with that derived in
Example 7.3.1, and verify that the difference PI � 2C is skew-symmetric&mdash;
see Exercise 12.2&mdash;where C is the matrix coefficient of the Coriolis and
centrifugal terms.
</p>
<p>7.6 A three-revolute spherical wrist with an orthogonal architecture, i.e., with
neighboring joint axes at right angles, is shown in Fig. 7.10. Assume that
the moments of inertia of its three links with respect to O , the point of
concurrency of the three axes, are given by constant diagonal matrices, in link-
fixed coordinates, as
</p>
<p>I4 D diag.J1; J2; J3/
I5 D diag.K1; K2; K3/
I6 D diag.L1; L2; L3/</p>
<p/>
</div>
<div class="page"><p/>
<p>7.9 Exercises 349
</p>
<p>Fig. 7.11 A two-revolute pointing manipulator
</p>
<p>while the potential energy of the wrist is
</p>
<p>V D �m6ga cos �5
</p>
<p>Moreover, the motors produce torques �4; �5, and �6, respectively, whereas the
power losses can be accounted for via a dissipation function of the form
</p>
<p>&#129; D
6
X
</p>
<p>4
</p>
<p>�
1
</p>
<p>2
bi P�2i C �Ci j P�i j
</p>
<p>�
</p>
<p>where bi and �Ci , for i D 4; 5; 6, are constants.
(a) Derive an expression for the matrix of generalized inertia of the wrist.
(b) Derive an expression for the term of Coriolis and centrifugal forces.
(c) Derive the dynamical model of the wrist. Hint: The kinetic energy T of a
</p>
<p>rigid body rotating about a fixed point O with angular velocity ! can be
</p>
<p>written as T D 1
2
!T IO!, where IO is the moment-of-inertia matrix of the
</p>
<p>body with respect to O .
</p>
<p>7.7 Shown in Fig. 7.11 is a two-revolute pointing manipulator. The centroidal
inertia matrices of the links are denoted by I1 and I2. These are given, in
link-fixed coordinates, by:
</p>
<p>I1 D
</p>
<p>2
</p>
<p>4
</p>
<p>I11 I12 I13
I12 I22 I23
I13 I23 I33
</p>
<p>3
</p>
<p>5 ; I2 D
</p>
<p>2
</p>
<p>4
</p>
<p>J11 J12 J13
J12 J22 J23
J13 J23 J33
</p>
<p>3
</p>
<p>5
</p>
<p>Moreover, the centers of mass of the links are denoted by C1 and C2,
respectively, and are shown in the same figure, the masses being denoted by
m1 and m2.</p>
<p/>
</div>
<div class="page"><p/>
<p>350 7 Dynamics of Serial Robotic Manipulators
</p>
<p>(a) Determine the kinetic energy of the manipulator as a quadratic function
of P�1 and P�2.
</p>
<p>(b) Determine the 2 � 2 matrix of generalized inertia.
(c) Find an expression for the time-rate of change of the matrix of generalized
</p>
<p>inertia by straightforward differentiation of the expression found in
item (b).
</p>
<p>(d) Repeat item (c), but now by differentiation of the three factors of I, as
given in
</p>
<p>I D TTMT
</p>
<p>7.8 The twist ti of the i th link of an n-dof serial manipulator can be expressed as
</p>
<p>ti D Ti P�
</p>
<p>where Ti is a 6�n link-twist-shaping matrix and P� is the n-dimensional vector
of actuated joint rates. Moreover, let Mi and Wi be the 6� 6 matrices defined
in Sect. 7.3. Show that if the link is constrained to undergo planar motion, then
the product TTi WiMiTi vanishes.
</p>
<p>7.9 Devise a recursive algorithm to compute the joint torques required to balance
a wrench w acting at the EE of a six-revolute manipulator of arbitrary archi-
tecture. Then, derive the number of floating-point operations (multiplications
and additions) required to compute these torques, and compare your result
with the number of floating point operations required to compute the same by
matrix&ndash;times&ndash;vector multiplications, using the transpose Jacobian.
</p>
<p>7.10 Establish the computational cost incurred in computing the term of Coriolis
and centrifugal forces of an n-revolute serial manipulator, when the Newton&ndash;
Euler algorithm is used for this purpose.
</p>
<p>7.11 Shown in Fig. 7.12 is an RRP manipulator, whose DH parameters are dis-
played in Table 7.5. The masses of its three moving links are denoted by m1,
m2, andm3, and the center of mass of each of links 1 and 2 coincides withO1,
while the center of mass of link 3 is located at P . Moreover, the centroidal
moments of inertia of these links are, in link-fixed coordinates,
</p>
<p>Œ I1 &#141;2 D A1; Œ I2 &#141;3 D B1; Œ I3 &#141;4 D C1
</p>
<p>where 1 denotes the 3 � 3 identity matrix.
(a) Derive the Euler&ndash;Lagrange equations of the manipulator under the
</p>
<p>assumption that gravity acts in the direction of X1.
(b) Find the generalized inertia matrix of the manipulator.
</p>
<p>7.12 A link is said to be inertially isotropic if its three principal moments of inertia
are identical.</p>
<p/>
</div>
<div class="page"><p/>
<p>7.9 Exercises 351
</p>
<p>Fig. 7.12 An RRP spatial manipulator
</p>
<p>Table 7.5 DH parameters of
the RRP manipulator
</p>
<p>i ai bi ˛i
</p>
<p>1 0 0 90ı
</p>
<p>2 0 0 90ı
</p>
<p>3 0 b3 0ı
</p>
<p>(a) Show that any direction is a principal axis of inertia of an inertially
isotropic link.
</p>
<p>(b) Explore the advantages of a manipulator with inertially isotropic links
with regard to its real-time control, i.e., find the savings in floating-point
operations required to compute the recursive Newton&ndash;Euler algorithm of
such a manipulator.
</p>
<p>7.13 Devise an algorithm similar to Algorithm 7.6.1, but applicable to planar
manipulators, and determine the computational costs involved in its imple-
mentation.
</p>
<p>7.14 Write a piece of code to evaluate numerically the inertia matrix of an n-
axis manipulator and test it with the manipulator of Example 7.6.2. For this
purpose, assume that I D ma2.
</p>
<p>7.15 With reference to the mathematical model of a n-dof serial manipulator of
Eq. (7.60), show that the matrix difference &#129; � PI � 2C is skew-symmetric.
This result is important, because it leads to the stabilization of the manipulator
with the aid of a simple proportional-derivative (PD) controller (Spong et al.
2006).</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 8
</p>
<p>Special Topics in Rigid-Body Kinematics
</p>
<p>8.1 Introduction
</p>
<p>The motivation for this chapter is twofold. On the one hand, the determination of
the angular velocity and angular acceleration of a rigid body from point-velocity
measurements is a fundamental problem in kinematics. On the other hand, the
solution of this problem is becoming increasingly relevant in the kinematics of
parallel manipulators, to be studied in Chap. 10. Moreover, the estimation of the
attitude of a rigid body from knowledge of the Cartesian coordinates of some of its
points is sometimes accomplished by time-integration of the velocity data. Likewise,
the use of accelerometers in the area of motion control readily leads to estimates of
the acceleration of a sample of points of a rigid body, which can be used to estimate
the angular acceleration of the body, and hence, to better control its motion.
</p>
<p>In order to keep the discussion at the level of fundamentals, we assume
throughout this chapter that the information available on point velocity and point
acceleration is error-free, a rather daring assumption, but useful for understanding
the underlying concepts at this level. Once the fundamentals are well understood,
devising algorithms that yield the best estimates of angular velocity and acceleration
in the presence of noisy measurements becomes an easier task. For the sake of
conciseness, the problem of motion estimation will not be discussed in this book.
</p>
<p>8.2 Computation of Angular Velocity from Point-Velocity
</p>
<p>Data
</p>
<p>The twist of a rigid body, as introduced in Eq. (3.72), defines completely the velocity
field of a rigid body under arbitrary motion. Notice that the twist involves two vector
quantities, the angular velocity and the velocity of a point of the rigid body. Since
we are assuming that point-velocity data are available, the only item to be computed
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__8,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>353</p>
<p/>
</div>
<div class="page"><p/>
<p>354 8 Special Topics in Rigid-Body Kinematics
</p>
<p>is the angular velocity of the body under study, which is the subject of this section.
Once the angular velocity is known and the velocities of a set of body points are
available, other relevant motion parameters, such as the location of the ISA&mdash;see
Sect. 3.4&mdash;-can be readily determined.
</p>
<p>If the twist of a rigid body is known, the computation of the velocity of an
arbitrary point of the body, of a given position vector, is straightforward. However,
the inverse problem, namely, the computation of the twist of the motion under study
given the velocities of a set of points of known position vectors, is a more difficult
task. A solution to this problem is now outlined.
</p>
<p>First and foremost, we acknowledge that the velocities of a minimum of three
noncollinear points are needed in order to determine the angular velocity of the rigid
body under study. Indeed, if the velocity of a single body point is known, we have
no information on the angular motion of the body; if the velocities of two points are
known, we can calculate two components of the angular-velocity vector of the body,
namely, those that are orthogonal to the line joining the two given points, thereby
leaving one component indeterminate, the one along that line. Therefore, in order to
know the angular velocity of a rigid body in motion, we need at least the velocities
of three noncollinear points of the body&mdash;obviously, knowing only the velocities of
any number of points along one line yields no more information than knowing only
the velocities of two points along that line. We thus assume henceforth that we have
three noncollinear points and that we know perfectly their velocities.
</p>
<p>Let the three noncollinear points of the body under study be denoted by fPi g31
and let fpi g31 be their corresponding position vectors. The centroid C of the
foregoing set has a position vector c that is the mean value of the three given position
vectors, namely,
</p>
<p>c � 1
3
</p>
<p>3
X
</p>
<p>1
</p>
<p>pi (8.1)
</p>
<p>Likewise, if the velocities of the three points are denoted by Ppi , and that of their
centroid by Pc, one has
</p>
<p>Pc � 1
3
</p>
<p>3
X
</p>
<p>1
</p>
<p>Ppi (8.2)
</p>
<p>From Eq. (3.49), the velocity of the three given points can be expressed as
</p>
<p>Ppi D PcC&#127;.pi � c/; i D 1; 2; 3 (8.3a)
</p>
<p>or
</p>
<p>Ppi � Pc D &#127;.pi � c/; i D 1; 2; 3 (8.3b)</p>
<p/>
</div>
<div class="page"><p/>
<p>8.2 Computation of Angular Velocity from Point-Velocity Data 355
</p>
<p>Now, we define a 3 � 3 matrix P as
</p>
<p>P �
�
</p>
<p>p1 � c p2 � c p3 � c
�
</p>
<p>(8.4)
</p>
<p>Upon differentiation of both sides of Eq. (8.4) with respect to time, one has
</p>
<p>PP �
�
</p>
<p>Pp1 � Pc Pp2 � Pc Pp3 � Pc
�
</p>
<p>(8.5)
</p>
<p>It is noteworthy that P and PP are immutable under a pure translation of the coordinate
frame of reference. However, under a pure rotation of the frame, given by a proper
orthogonal matrix Q, both P and PP transform as QP and Q PP, respectively. As a
consequence, P and PP are not frame invariant.
</p>
<p>Further, Eqs. (8.3b) can be written in matrix form as
</p>
<p>PP D &#127;P (8.6)
</p>
<p>from which we want to solve for &#127;, or equivalently, for !. This cannot be done by
simply multiplying by the inverse of P, because the latter is a singular matrix. In
fact, as the reader can readily verify, any vector having three identical components
lies in the null space of P, thereby showing that P is singular, its null space being
spanned by that vector. Furthermore, notice that from Eq. (8.3b), it is apparent that
</p>
<p>. Ppi � Pc/T! D 0; i D 1; 2; 3 (8.7a)
</p>
<p>Upon assembling all three scalar equations above in one single vector equation, we
obtain
</p>
<p>PPT! D 0 (8.7b)
</p>
<p>a result that is summarized below:
</p>
<p>Theorem 8.2.1. The angular-velocity vector lies in the null space of matrix PPT ,
with PP defined in Eq. (8.5).
</p>
<p>In order to find the desired expression for ! from the above equation, we recall
Theorem A.1, which is proven in Appendix A: Let S be a skew-symmetric 3 � 3
matrix and A be an arbitrary 3 � 3 matrix. Then,
</p>
<p>vect.SA/ D 1
2
Œtr.A/1 � A&#141; vect.S/ (8.8)
</p>
<p>Upon application of the foregoing result, Eq. (8.6) leads to
</p>
<p>D! D vect. PP/ (8.9)</p>
<p/>
</div>
<div class="page"><p/>
<p>356 8 Special Topics in Rigid-Body Kinematics
</p>
<p>where D is defined below and vect.&#127;/ is nothing but !:
</p>
<p>D � 1
2
Œtr.P/1 � P&#141; (8.10)
</p>
<p>Thus, Eq. (8.9) can be solved for ! as long as D is invertible. It is to be expected
that, if the three points are collinear, then D is invertible, but, given that P is not
frame-invariant, neither is tr.P/. Hence, it is not apparent from Eq. (8.10) that D is
singular when the three given points are collinear. We will discuss this singularity
presently.
</p>
<p>Now, if tr.P/ vanishes, D becomes just one-half the negative of P, which, as we
saw above, is singular. Moreover, if the three given points are noncollinear and we
assume that the trace of P does not vanish, then the inverse of D can be proven to be
</p>
<p>D�1 D ˛1 � ˇP2 (8.11)
</p>
<p>where coefficients ˛ and ˇ are given below:
</p>
<p>˛ � 2
tr.P/
</p>
<p>; ˇ � 4
tr.P/Œtr.P2/ � tr2.P/&#141; (8.12)
</p>
<p>From expressions (8.12) it is apparent that D fails to be invertible not only when
tr.P/ vanishes, but also when the term in brackets in the denominator of ˇ does. In
Exercise 8.3, the reader is asked to prove that the foregoing term vanishes whenever
the three points are collinear.
</p>
<p>From the foregoing discussion, it is apparent that given the velocities and the
position vectors of three noncollinear points of a rigid body, the angular velocity
of the body can always be determined. However, the data, i.e., the velocities of
the three given points, cannot be arbitrary, for they must conform to Eq. (8.6) or,
equivalently, to Theorem 8.2.1. Equation (8.6) states that the columns of matrix PP
must lie in the range of&#127;, while Theorem 8.2.1 states that! lies in the null space of
PP. However, prior to the computation of !, or equivalently, of &#127;, it is not possible
to verify this condition. An alternative approach to verifying the compatibility of the
data follows: Since lines PiC belong to a rigid body, vectors pi � c must remain of
the same magnitude throughout a rigid-body motion. Moreover, the angles between
any two of the said lines must be preserved throughout the motion as well. This
means that the conditions below must hold:
</p>
<p>.pi � c/T .pj � c/ D cij ; i; j D 1; 2; 3 (8.13)
</p>
<p>or in compact form,
</p>
<p>PTP D C (8.14)</p>
<p/>
</div>
<div class="page"><p/>
<p>8.2 Computation of Angular Velocity from Point-Velocity Data 357
</p>
<p>where the .i; j / entry of the constant matrix C is cij , as defined in Eq. (8.13) above.
Upon differentiation of both sides of Eq. (8.14) with respect to time, we obtain:
</p>
<p>Theorem 8.2.2 (Velocity Compatibility). The velocities of three points of a rigid
</p>
<p>body satisfy the compatibility condition:
</p>
<p>PPTPC PT PP D O (8.15)
</p>
<p>with matrices P and PP defined in Eqs. (8.4) and (8.5) and O denoting the 3 � 3 zero
matrix.
</p>
<p>The above equation, then, states that for the given velocities of three points of a
rigid body to be compatible, the product PT PP must be skew-symmetric. Note that
the above matrix compatibility equation represents six independent scalar equations
that the data of the problem at hand must satisfy. There is a tendency to neglect
the foregoing six independent scalar compatibility conditions and to focus only on
the three scalar conditions drawn from the diagonal entries of the above matrix
equation. This is, however, a mistake, for these three conditions do not suffice to
guarantee data compatibility in this context; all these three conditions guarantee is
that the distance between any pair of points of the set remains constant, but they say
nothing about the angles between the pairs of lines formed by each pair of points.
</p>
<p>Note, on the other hand, that the product PPT has no direct geometric interpre-
tation, although the difference tr.PPT /1 � PPT does, as discussed in Exercise 8.9.
Furthermore, while Theorem 8.2.2 states that matrix PT PP is skew-symmetric, it says
nothing about the product P PPT . All we can say about this product is stated in the
result below:
</p>
<p>Theorem 8.2.3. With matrices P and PP defined in Eqs. (8.4) and (8.5), the product
P PPT obeys the constraint
</p>
<p>tr.P PPT / D 0 (8.16)
</p>
<p>If m � n matrices are regarded as forming a vector space, then an inner product of
two such matrices A and B, denoted by .A; B/, can be defined as
</p>
<p>.A; B/ � tr.ABT / (8.17)
</p>
<p>the two matrices being said to be orthogonal when the foregoing inner product
vanishes. We thus have that Theorem 8.2.3 states that matrices PP and P are
orthogonal, a result that parallels that about the orthogonality of the relative velocity
of two points and the line joining them, as stated in Eq. (3.51) and summarized in
the ensuing theorem. The proof of Theorem 8.2.3 is left as an exercise.
</p>
<p>Example 8.2.1. The rigid cube shown in Fig. 8.1 moves in such a way that vertices
P1, P2, and P3 undergo the velocities shown in that figure, for three different
possible motions. The length of the sides of the cube is 1, and the velocities all have
magnitude
</p>
<p>p
2 in Fig. 8.1a, c; these velocities are of unit magnitude in Fig. 8.1b.</p>
<p/>
</div>
<div class="page"><p/>
<p>358 8 Special Topics in Rigid-Body Kinematics
</p>
<p>a b c
</p>
<p>Fig. 8.1 A rigid cube undergoing a motion determined by the velocities of three of its points
</p>
<p>Furthermore, in the motion depicted in Fig. 8.1c, the velocity of P3 is parallel to
line P4P3, whereas that of P2 is parallel to line P1P3. Out of the three different
motions, it is known that at least one is compatible. Identify the compatible motion
and compute its angular velocity.
</p>
<p>Solution: Let Ppi denote the velocity of Pi , of position vector pi . Each proposed
motion is then analyzed: (a) The projection of Pp1 onto P1P2 is 1, but that of Pp2 onto
the same line is 0, and hence, this motion is incompatible; (b) Again, the projection
of Pp1 onto P1P2 is 1, but that of Pp2 onto the same line vanishes, and hence, this
motion is also incompatible. Thus, the only possibility is (c), which is now analyzed
more formally: Use a dextrous&mdash;right-handed&mdash;rectangular coordinate frame with
origin at P1, axis Y along P1P2, and axis Z parallel to P2P3. All vectors and
matrices are now represented in this coordinate frame, and hence,
</p>
<p>p1 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; p2 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>1
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; p3 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>Pp1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; Pp2 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; Pp3 D
</p>
<p>2
</p>
<p>4
</p>
<p>�1
0
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>Thus,
</p>
<p>c D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>2
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; Pc D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>2
</p>
<p>2
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>8.2 Computation of Angular Velocity from Point-Velocity Data 359
</p>
<p>Now matrices P and PP are constructed:
</p>
<p>P D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 0
</p>
<p>�2 1 1
�1 �1 2
</p>
<p>3
</p>
<p>5 ; PP D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>3 0 �3
1 1 �2
�2 1 1
</p>
<p>3
</p>
<p>5
</p>
<p>Furthermore,
</p>
<p>PT PP D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 1
1 0 �1
�1 1 0
</p>
<p>3
</p>
<p>5
</p>
<p>which is skew-symmetric, and hence, the motion is compatible. Now, matrix D is
computed:
</p>
<p>D � 1
2
Œ 1tr.P/ � P&#141; D 1
</p>
<p>6
</p>
<p>2
</p>
<p>4
</p>
<p>3 0 0
</p>
<p>2 2 �1
1 1 1
</p>
<p>3
</p>
<p>5
</p>
<p>The angular velocity ! is computed as the solution to
</p>
<p>D! D vect. PP/
</p>
<p>where
</p>
<p>vect. PP/ D 1
6
</p>
<p>2
</p>
<p>4
</p>
<p>3
</p>
<p>�1
1
</p>
<p>3
</p>
<p>5
</p>
<p>Equations (8.9) are thus
</p>
<p>3!1 D 3
2!1 C 2!2 � !3 D �1
!1 C !2 C !3 D 1
</p>
<p>The first of the foregoing equations leads to
</p>
<p>!1 D 1
</p>
<p>whereas the second and the third lead to
</p>
<p>2!2 � !3 D �3
!2 C !3 D 0</p>
<p/>
</div>
<div class="page"><p/>
<p>360 8 Special Topics in Rigid-Body Kinematics
</p>
<p>and hence,
</p>
<p>!2 D �1; !3 D 1
</p>
<p>Now, as a verification, ! should be normal to the three columns of PP as defined
in Eq. (8.7b); in other words, ! should lie in the null space of PPT . But this is so,
because
</p>
<p>PPT! D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>3 1 �2
0 1 1
</p>
<p>�3 �2 1
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>�1
1
</p>
<p>3
</p>
<p>5 D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>0
</p>
<p>3
</p>
<p>5
</p>
<p>thereby verifying that ! lies, in fact, in the null space of PPT.
</p>
<p>8.2.1 A Robust Formulation
</p>
<p>The foregoing formulation fails when matrix D of Eq. (8.10) becomes singular.
While it is not surprising that the matrix becomes singular in the presence of three
collinear points, it is a bit frustrating that, even if the points are noncollinear,
D becomes singular when tr.P/ D 0. Moreover, in light of the lack of frame-
invariance of P, it is not possible to predict geometrically under which conditions
tr.P/ vanishes. It is thus imperative to look for an alternative, robust approach, which
is the aim of this subsection.
</p>
<p>Upon multiplying both sides of Eq. (8.6) by PT from the right, we obtain
</p>
<p>PPPT D &#127;R; R � PPT (8.18)
</p>
<p>Further, if we take the vector of both sides of Eq. (8.18), we obtain
</p>
<p>1
</p>
<p>2
J! D vect. PPPT / (8.19a)
</p>
<p>where, by application of Theorem A.1, as done above, J is defined as
</p>
<p>J � tr.R/1 � R (8.19b)
</p>
<p>which, as the reader is invited to prove in Exercise 8.9, is nothing but the inertia
tensor of a system of three unit-mass particles located at points fPi g31 with respect
to their mass center, which coincides with the centroid C of the three given points.
As such, matrix J is, in general, positive-definite, becoming semidefinite only in
the special case in which the three masses are collinear. Hence, the formulation
singularity brought about by the vanishing of tr.P/ is eliminated, which is the reason</p>
<p/>
</div>
<div class="page"><p/>
<p>8.2 Computation of Angular Velocity from Point-Velocity Data 361
</p>
<p>why this formulation is billed as robust. Hence, as long as the three given points are
noncollinear, Eq. (8.19a) can always be solved for !, thus obtaining
</p>
<p>! D 2J�1vect. PPPT / (8.20)
</p>
<p>Example 8.2.2. Solve Example 8.2.1 with the robust formulation introduced above.
</p>
<p>Solution: We need both matrix J and the right-hand side of Eq. (8.19a). To this
end, we compute first
</p>
<p>R D PPT D 1
3
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 0
</p>
<p>0 2 1
</p>
<p>0 1 2
</p>
<p>3
</p>
<p>5
</p>
<p>which is apparently a simple, positive-semidefinite matrix.1 Hence,
</p>
<p>J D 1
6
</p>
<p>2
</p>
<p>4
</p>
<p>4 0 0
</p>
<p>0 2 �1
0 �1 2
</p>
<p>3
</p>
<p>5
</p>
<p>whose inverse is readily calculated as
</p>
<p>J�1 D 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>3 0 0
</p>
<p>0 8 4
</p>
<p>0 4 8
</p>
<p>3
</p>
<p>5
</p>
<p>Further,
</p>
<p>vect. PPPT / D vect
</p>
<p>0
</p>
<p>@
1
</p>
<p>3
</p>
<p>2
</p>
<p>4
</p>
<p>0 �3 �3
0 �1 �2
0 2 1
</p>
<p>3
</p>
<p>5
</p>
<p>1
</p>
<p>A D 1
6
</p>
<p>2
</p>
<p>4
</p>
<p>4
</p>
<p>�3
3
</p>
<p>3
</p>
<p>5
</p>
<p>Therefore,
</p>
<p>! D 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>3 0 0
</p>
<p>0 8 4
</p>
<p>0 4 8
</p>
<p>3
</p>
<p>5
1
</p>
<p>6
</p>
<p>2
</p>
<p>4
</p>
<p>4
</p>
<p>�3
3
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>�1
1
</p>
<p>3
</p>
<p>5
</p>
<p>thereby completing the calculations, and verifying the result obtained with the non-
robust formulation.
</p>
<p>1R is apparently singular because it has one row and one column of zeros; it has two positive
eigenvalues because its trace is 4=3 &gt; 0 and the determinant of its 2 � 2 lower-right block is
1=3 &gt; 0.</p>
<p/>
</div>
<div class="page"><p/>
<p>362 8 Special Topics in Rigid-Body Kinematics
</p>
<p>8.3 Computation of Angular Acceleration
</p>
<p>from Point-Acceleration Data
</p>
<p>The angular acceleration of a rigid body under general motion is determined in this
section from knowledge of the position, velocity, and acceleration vectors of three
noncollinear points of the body. The underlying procedure parallels that of Sect. 8.2.
Indeed, recalling the notation introduced in that section, and letting vectors Rpi , for
i D 1; 2; 3, denote the acceleration of the given points, one can rewrite Eq. (3.85)
for each point in the form
</p>
<p>Rpi D RcC . P&#127;C&#127;2/.pi � c/; i D 1; 2; 3 (8.21a)
</p>
<p>or
</p>
<p>Rpi � Rc D . P&#127;C&#127;2/.pi � c/; i D 1; 2; 3 (8.21b)
</p>
<p>where c was defined in Eq. (8.1), and Rc is the acceleration of the centroid, i.e.,
</p>
<p>Rc � 1
3
</p>
<p>3
X
</p>
<p>1
</p>
<p>Rpi (8.21c)
</p>
<p>Furthermore, matrix RP is defined as
</p>
<p>RP �
�
</p>
<p>Rp1 � Rc Rp2 � Rc Rp3 � Rc
�
</p>
<p>(8.22)
</p>
<p>Thus, Eqs. (8.21b) can be written in compact form as
</p>
<p>RP D . P&#127;C&#127;2/P (8.23)
</p>
<p>from which one is interested in computing P&#127;, or correspondingly, P!. To this end,
Eq. (8.23) is rewritten as
</p>
<p>P&#127;P DW (8.24a)
</p>
<p>with matrix W defined as
</p>
<p>W � RP �&#127;2P (8.24b)
</p>
<p>The counterpart of Theorem 8.2.1 is now derived from Eqs. (8.21b). First, these
equations are cast in the form
</p>
<p>Rpi � Rc �&#127;2.pi � c/ D P! � .pi � c/; i D 1; 2; 3</p>
<p/>
</div>
<div class="page"><p/>
<p>8.3 Computation of Angular Acceleration from Point-Acceleration Data 363
</p>
<p>It is now apparent that if we dot-multiply the above equations by P!, we obtain
</p>
<p>Œ Rpi � Rc �&#127;2.pi � c/&#141; � P! D 0; i D 1; 2; 3 (8.25a)
</p>
<p>Upon assembling the three foregoing equations in one single vector equation, we
derive the counterpart of Eq. (8.7b), namely,
</p>
<p>. RP �&#127;2P/T P! D 0 (8.25b)
</p>
<p>a result that is summarized below in theorem form:
</p>
<p>Theorem 8.3.1. The angular-acceleration vector P! lies in the null space of matrix
WT , withW defined in Eq. (8.24b).
</p>
<p>Just as we did in Sect. 8.2 when solving for ! from Eq. (8.9), we apply the result
already invoked in connection with Eq. (8.9), thereby deriving an alternative form
of Eq. (8.24a), namely,
</p>
<p>D P! D vect. RP �&#127;2P/ (8.26)
</p>
<p>where D is defined as in Eq. (8.10). Thus,
</p>
<p>P! D D�1vect. RP �&#127;2P/ (8.27)
</p>
<p>with D�1 given as in Eqs. (8.11) and (8.12). As in Sect. 8.2, then, given the position,
velocity, and acceleration vectors of three noncollinear points of a rigid body, it
is always possible to compute the associated angular acceleration. However, as
discussed in that section, the data cannot be given arbitrarily, for they must comply
with Eq. (8.24a), or correspondingly, with Eq. (8.25b). The former implies that the
three columns of matrix W lie in the range of matrix P&#127;; alternatively, Eq. (8.25b)
implies that P&#127; lies in the null space of WT . Again, prior to the determination of P&#127;,
it is impossible to verify this condition, for which reason an alternative approach
is taken to verifying compatibility. The obvious one is to differentiate both sides of
Eq. (8.15), which produces
</p>
<p>RPTPC 2 PPT PPC PT RP D 0 (8.28)
</p>
<p>thereby deriving the compatibility conditions that the acceleration measurements
should satisfy.
</p>
<p>Finally, upon differentiation of both sides of Eq. (8.16) with respect to time, and
while doing this, resorting to Lemma A.2 of Appendix A, we have
</p>
<p>tr.P RPT C PP PPT / D 0 (8.29)
</p>
<p>which is the counterpart of Eq. (8.16 ).</p>
<p/>
</div>
<div class="page"><p/>
<p>364 8 Special Topics in Rigid-Body Kinematics
</p>
<p>Fig. 8.2 A rigid triangular
plate undergoing a motion
given by the velocity and
acceleration of its vertices
</p>
<p>Example 8.3.1. The three vertices of the equilateral triangular plate of Fig. 8.2,
which lies in the X&ndash;Y plane, are labeled P1, P2, and P3, their position vectors
being p1, p2, and p3. Moreover, the velocities of the foregoing points are denoted by
Ppi , for i D 1; 2; 3. The origin of the coordinate frameX; Y; Z lies at the centroid C
of the triangle, the velocities of the vertices, in this coordinate frame, being given as
</p>
<p>Pp1 D
4 �
p
2
</p>
<p>4
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; Pp2 D
4 �
p
3
</p>
<p>4
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; Pp3 D
4C
p
2
</p>
<p>4
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>Likewise, Rp1, Rp2; and Rp3 denote the accelerations of the three vertices of the plate,
given below in the same coordinate frame:
</p>
<p>Rp1 D
1
</p>
<p>24
</p>
<p>2
</p>
<p>4
</p>
<p>�6C 4
p
3
</p>
<p>12 � 3
p
2
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; Rp2 D �
1
</p>
<p>24
</p>
<p>2
</p>
<p>4
</p>
<p>8
p
3C 3
</p>
<p>p
6
</p>
<p>3
p
3
</p>
<p>0
</p>
<p>3
</p>
<p>5 ;
</p>
<p>Rp3 D
1
</p>
<p>24
</p>
<p>2
</p>
<p>4
</p>
<p>6C 4
p
3
</p>
<p>�12C 3
p
2
</p>
<p>0
</p>
<p>3
</p>
<p>5
</p>
<p>With the foregoing information,
</p>
<p>(a) show that the three given velocities are compatible;
(b) compute the angular velocity of the plate;
(c) determine the set of points of the plate that undergo a velocity of minimum
</p>
<p>magnitude;
(d) show that the given accelerations are compatible;
(e) compute the angular acceleration of the plate.</p>
<p/>
</div>
<div class="page"><p/>
<p>8.3 Computation of Angular Acceleration from Point-Acceleration Data 365
</p>
<p>Solution:
</p>
<p>(a) Since the centroid of the triangle coincides with that of the three given points,
we have c D 0. Moreover,
</p>
<p>p1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1=2
</p>
<p>�
p
3=6
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; p2 D
</p>
<p>2
</p>
<p>4
</p>
<p>0p
3=3
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; p3 D
</p>
<p>2
</p>
<p>4
</p>
<p>�1=2
�
p
3=6
</p>
<p>0
</p>
<p>3
</p>
<p>5
</p>
<p>Thus,
</p>
<p>P D 1
6
</p>
<p>2
</p>
<p>4
</p>
<p>3 0 �3
�
p
3 2
p
3 �
p
3
</p>
<p>0 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>Furthermore,
</p>
<p>Pc D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>.12 �
p
3/=12
</p>
<p>3
</p>
<p>5
</p>
<p>and hence,
</p>
<p>PP D 1
12
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 0
</p>
<p>0 0 0p
3 � 3
</p>
<p>p
2 �2
p
3
p
3C 3
</p>
<p>p
2
</p>
<p>3
</p>
<p>5
</p>
<p>We can readily show from the above results that
</p>
<p>PT PP D O
</p>
<p>with O denoting the 3 � 3 zero matrix. Hence, matrix PT PP is skew-symmetric
and the velocities are compatible
</p>
<p>(b) Next, we have
</p>
<p>D � 1
2
Œtr.P/1 � P&#141; � 1
</p>
<p>12
</p>
<p>2
</p>
<p>4
</p>
<p>2
p
3 0 3p
3 3
</p>
<p>p
3
</p>
<p>0 0 3C 2
p
3
</p>
<p>3
</p>
<p>5
</p>
<p>and
</p>
<p>vect. PP/ D 1
24
</p>
<p>2
</p>
<p>4
</p>
<p>�2
p
3
</p>
<p>�
p
3C 3
</p>
<p>p
2
</p>
<p>0
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>366 8 Special Topics in Rigid-Body Kinematics
</p>
<p>Hence, if the components of ! in the given coordinate frame are denoted by !i ,
for i D 1; 2; 3, then we obtain
</p>
<p>2
p
3!1 C 3!3 D �
</p>
<p>p
3
</p>
<p>p
3!1 C 3!2 C
</p>
<p>p
3!3 D
</p>
<p>�
p
3C 3
</p>
<p>p
2
</p>
<p>2
</p>
<p>.3C 2
p
3/!3 D 0
</p>
<p>From the third equation,
</p>
<p>!3 D 0
</p>
<p>Substitution of the foregoing value into the first of the above equations yields
!1 D �1=2. Further, upon substitution of the values of !1 and !3 into the
second of the above equations, we obtain !2 D
</p>
<p>p
2=2 and hence,
</p>
<p>! D 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>�1p
2
</p>
<p>0
</p>
<p>3
</p>
<p>5
</p>
<p>(c) Let p00 be the position vector of the point P
0
0 on the instantaneous screw axis
</p>
<p>lying closest to the origin. Now, in order to find p00, we can resort to Eq. (3.70),
using point C as a reference, i.e., with c and Pc playing the roles of a and Pa in
that equation. Moreover, since c D 0, the expression for p00 reduces to
</p>
<p>p00 D
1
</p>
<p>k!k2&#127;Pc
</p>
<p>where from item (b),
</p>
<p>k!k2 D 3
4
</p>
<p>while
</p>
<p>&#127;Pc D 12 �
p
3
</p>
<p>24
</p>
<p>2
</p>
<p>4
</p>
<p>p
2
</p>
<p>1
</p>
<p>0
</p>
<p>3
</p>
<p>5
</p>
<p>and hence,
</p>
<p>p00 D
12 �
</p>
<p>p
3
</p>
<p>18
</p>
<p>2
</p>
<p>4
</p>
<p>p
2
</p>
<p>1
</p>
<p>0
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>8.3 Computation of Angular Acceleration from Point-Acceleration Data 367
</p>
<p>As a verification, p00 should be perpendicular to the ISA, as it is, for the product
!T p00 to vanish. Next, the vector representing the direction of the screw axis is
obtained simply as
</p>
<p>e D !k!k D
p
3
</p>
<p>3
</p>
<p>�
</p>
<p>�1
p
2 0
�T
</p>
<p>thereby defining completely the instant screw axis.
(d) The acceleration of the centroid of the three given points is given as follows:
</p>
<p>Rc D Œ�
p
6
</p>
<p>24
; �
p
3
</p>
<p>24
; 0&#141;T
</p>
<p>Then, matrices RP, PT RP, RPTP, and PPT PP are readily computed as
</p>
<p>RP D 1
24
</p>
<p>2
</p>
<p>4
</p>
<p>�6C 4
p
3C
p
6 �8
p
3 � 2
</p>
<p>p
6 6C 4
</p>
<p>p
3C
p
6
</p>
<p>12 � 3
p
2C
p
3 �2
</p>
<p>p
3 �12C 3
</p>
<p>p
2C
p
3
</p>
<p>0 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>PT RP D 1
144
</p>
<p>2
</p>
<p>4
</p>
<p>�21C 6
p
6 6 � 24
</p>
<p>p
3 � 6
</p>
<p>p
6 15C 24
</p>
<p>p
3
</p>
<p>6C 24
p
3 � 6
</p>
<p>p
6 �12 6 � 24
</p>
<p>p
3C 6
</p>
<p>p
6
</p>
<p>15 � 24
p
3 6C 24
</p>
<p>p
3C 6
</p>
<p>p
6 �21 � 6
</p>
<p>p
6
</p>
<p>3
</p>
<p>5
</p>
<p>RPTP D 1
144
</p>
<p>2
</p>
<p>4
</p>
<p>�21C 6
p
6 6C 24
</p>
<p>p
3 � 6
</p>
<p>p
6 15 � 24
</p>
<p>p
3
</p>
<p>6 � 24
p
3 � 6
</p>
<p>p
6 �12 6C 24
</p>
<p>p
3C 6
</p>
<p>p
6
</p>
<p>15C 24
p
3 6 � 24
</p>
<p>p
3C 6
</p>
<p>p
6 �21 � 6
</p>
<p>p
6
</p>
<p>3
</p>
<p>5
</p>
<p>PPT PP D 1
144
</p>
<p>2
</p>
<p>4
</p>
<p>21 � 6
p
6 �6C 6
</p>
<p>p
6 �15
</p>
<p>�6C 6
p
6 12 �6 � 6
</p>
<p>p
6
</p>
<p>�15 �6 � 6
p
6 21C 6
</p>
<p>p
6
</p>
<p>3
</p>
<p>5
</p>
<p>Now, it is a simple matter to verify that
</p>
<p>RPTPC 2 PPT PPC PT RP D O
</p>
<p>and hence, the given accelerations are compatible.
(e) &#127; is defined as the unique skew-symmetric matrix whose vector is !, the latter
</p>
<p>having been computed in item (b). Thus,
</p>
<p>&#127; D 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>0 0
p
2
</p>
<p>0 0 1
</p>
<p>�
p
2 �1 0
</p>
<p>3
</p>
<p>5 ; &#127;2 D 1
4
</p>
<p>2
</p>
<p>4
</p>
<p>�2 �
p
2 0
</p>
<p>�
p
2 �1 0
</p>
<p>0 0 �3
</p>
<p>3
</p>
<p>5 ;</p>
<p/>
</div>
<div class="page"><p/>
<p>368 8 Special Topics in Rigid-Body Kinematics
</p>
<p>&#127;2P D 1
24
</p>
<p>2
</p>
<p>4
</p>
<p>�6C
p
6 �2
</p>
<p>p
6 6C
</p>
<p>p
6
</p>
<p>�3
p
2C
p
3 �2
p
3 3
p
2C
p
3
</p>
<p>0 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>Hence,
</p>
<p>RP �&#127;2P D 1
24
</p>
<p>2
</p>
<p>4
</p>
<p>4
p
3 �8
p
3 4
p
3
</p>
<p>12 0 �12
0 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>The angular-acceleration vector is thus computed from
</p>
<p>D P! D vect. RP �&#127;2P/
</p>
<p>where D was computed in item (b), while
</p>
<p>vect. RP �&#127;2P/ D 1
12
</p>
<p>2
</p>
<p>4
</p>
<p>3p
3
</p>
<p>3C 2
p
3
</p>
<p>3
</p>
<p>5
</p>
<p>and hence, letting P!i denote the i th component of P! in the given coordinate
frame, we obtain
</p>
<p>1
</p>
<p>12
.2
p
3 P!1 C 3 P!3/ D
</p>
<p>1
</p>
<p>4
</p>
<p>1
</p>
<p>12
.
p
3 P!1 C 3 P!2 C
</p>
<p>p
3 P!3/ D
</p>
<p>p
3
</p>
<p>12
</p>
<p>1
</p>
<p>12
.3C 2
</p>
<p>p
3/ P!3 D
</p>
<p>3C 2
p
3
</p>
<p>12
</p>
<p>which yields
</p>
<p>P! D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>thereby completing the solution. Note that P! lies, in fact, in the null space of
matrix . RP �&#127;2 PP/T .</p>
<p/>
</div>
<div class="page"><p/>
<p>8.3 Computation of Angular Acceleration from Point-Acceleration Data 369
</p>
<p>8.3.1 A Robust Formulation
</p>
<p>In computing the angular acceleration vector from point-velocity and -acceleration
data, we face exactly the same singularity we faced when computing the angular-
velocity vector. We thus follow the same robust approach introduced in Sect. 8.2.1.
To this end, we multiply both sides of Eq. (8.24a) by PT from the right, thereby
obtaining
</p>
<p>P&#127;R DWPT (8.30)
</p>
<p>with R defined already in Eq. (8.18). Moreover, from Eq. (8.24b),
</p>
<p>WPT D RPPT �&#127;2R (8.31)
</p>
<p>Now, the angular-acceleration vector is computed from Eq. (8.30) upon taking the
vector of both sides of this equation, namely,
</p>
<p>1
</p>
<p>2
J P! D vect. RPPT �&#127;2R/ (8.32)
</p>
<p>whence, as long as the three given points are not collinear, P! is computed as
</p>
<p>P! D 2J�1vect. RPPT �&#127;2R/ (8.33)
</p>
<p>thereby completing the intended computation.
</p>
<p>Example 8.3.2. Using the foregoing robust approach, compute the angular-
acceleration vector of the motion undergone by the plate of Fig. 8.2, for the
point-velocity and -acceleration data given in Example 8.3.1. Use the value of
! computed in that example.
</p>
<p>Solution: All we need now is J and the right-hand side of Eq. (8.32). We thus have
</p>
<p>R D PPT D 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 1 0
</p>
<p>0 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>whence tr.R/ D 1; therefore,
</p>
<p>J D 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 1 0
</p>
<p>0 0 2
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>370 8 Special Topics in Rigid-Body Kinematics
</p>
<p>Furthermore,
</p>
<p>RPPT D 1
8
</p>
<p>2
</p>
<p>4
</p>
<p>�2 �4 �
p
2 0
</p>
<p>4 �
p
2 �1 0
</p>
<p>0 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>while&#127; is obtained simply as CPM.!/, i.e.,
</p>
<p>&#127; D 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>0 0
p
2
</p>
<p>0 0 1
</p>
<p>�
p
2 �1 0
</p>
<p>3
</p>
<p>5
</p>
<p>and hence,
</p>
<p>&#127;2R D 1
8
</p>
<p>2
</p>
<p>4
</p>
<p>2
p
2 0p
</p>
<p>2 1 0
</p>
<p>0 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>thereby obtaining
</p>
<p>RPPT �&#127;2R D 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 0
1 0 0
</p>
<p>0 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>whence,
</p>
<p>vect. RPPT �&#127;2R/ D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1=2
</p>
<p>3
</p>
<p>5
</p>
<p>which thus yields
</p>
<p>P! D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>thereby completing the required computation.
</p>
<p>8.4 Exercises
</p>
<p>8.1 The regular tetrahedron of Fig. 3.10, of unit-length edges, moves in such a
way that vertex P1 has a velocity of unit magnitude directed from P1 to P4,</p>
<p/>
</div>
<div class="page"><p/>
<p>8.4 Exercises 371
</p>
<p>whereas the velocity of P2 is parallel to edge P2P3. Define a coordinate frame
X; Y; Z with origin at P1, Y axis directed from P1 to the midpoint M of
P2P3, and X axis in the plane of P1; P2; P3, as shown in that figure. With the
above information,
</p>
<p>(a) find the velocity of P2;
(b) show that the velocity of P3 cannot be zero;
(c) if the velocity of P3 lies in the P1P2P3 plane, find that velocity;
(d) find the angular velocity of the tetrahedron;
(e) find the set of points of the tetrahedron undergoing a velocity of minimum
</p>
<p>magnitude.
</p>
<p>8.2 The position vectors of three points of a rigid body, p1, p2, and p3, as well as
their velocities, Pp1, Pp2, and Pp3, are given below:
</p>
<p>p1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; p2 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>�1
1
</p>
<p>3
</p>
<p>5 ; p3 D
</p>
<p>2
</p>
<p>4
</p>
<p>�1
1
</p>
<p>�1
</p>
<p>3
</p>
<p>5
</p>
<p>Pp1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; Pp2 D
</p>
<p>2
</p>
<p>4
</p>
<p>3
</p>
<p>1
</p>
<p>�1
</p>
<p>3
</p>
<p>5 ; Pp3 D
</p>
<p>2
</p>
<p>4
</p>
<p>�1
1
</p>
<p>3
</p>
<p>3
</p>
<p>5
</p>
<p>(a) Is the motion possible?
(b) If the motion is possible, find its angular velocity.
</p>
<p>8.3 For matrix P defined as in Eq. (8.4), i.e., as
</p>
<p>P �
�
</p>
<p>p1 � c p2 � c p3 � c
�
</p>
<p>where fpk g31 are the position vectors of three points of a rigid body, while c
is that of their centroid, prove that tr.P2/ D tr2.P/ whenever the three given
points are collinear. Is the converse true?
</p>
<p>8.4 With matrix P defined as in Exercise 8.3 above, prove Theorem 8.2.3. That is,
prove that
</p>
<p>tr.P PPT / D 0
</p>
<p>8.5 With the notation of Sect. 8.3, prove that
</p>
<p>vect.&#127;2P/ D PD!
</p>
<p>8.6 Derive the velocity and acceleration compatibility conditions for a body that
is known to undergo spherical motion, i.e., a motion under which one point of
the body remains fixed.</p>
<p/>
</div>
<div class="page"><p/>
<p>372 8 Special Topics in Rigid-Body Kinematics
</p>
<p>8.7 The position vectors of three points of a rigid body, p1, p2, and p3, are given
as in Exercise 8.2, and repeated below for quick reference:
</p>
<p>p1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; p2 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>�1
1
</p>
<p>3
</p>
<p>5 ; p3 D
</p>
<p>2
</p>
<p>4
</p>
<p>�1
1
</p>
<p>�1
</p>
<p>3
</p>
<p>5
</p>
<p>Now, the velocities of these points are all zero, while their accelerations are
given as
</p>
<p>Rp1 D
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>1
</p>
<p>1
</p>
<p>3
</p>
<p>5 ; Rp2 D
</p>
<p>2
</p>
<p>4
</p>
<p>3
</p>
<p>1
</p>
<p>�1
</p>
<p>3
</p>
<p>5 ; Rp3 D
</p>
<p>2
</p>
<p>4
</p>
<p>�1
1
</p>
<p>3
</p>
<p>3
</p>
<p>5
</p>
<p>(a) Show that the motion is compatible.
(b) Find the angular acceleration of the body.
</p>
<p>8.8 With reference to Example 8.2.1, compute the angular acceleration of the cube
of Fig. 8.1c if Rpi D 0, for i D 1; 2; 3.
</p>
<p>8.9 With the notation of Sect. 8.2, let
</p>
<p>R � PPT
</p>
<p>(a) Show that the moment of inertia J of the three given points, which is
identical to that of a system of unit masses located at these points, with
respect to the centroid C of the given points, is
</p>
<p>J D tr.R/1 � R
</p>
<p>(b) Show that if the three given points move as points of a rigid body
undergoing an angular velocity ! whose cross-product matrix is&#127;, then
</p>
<p>PJ D R&#127; �&#127;R
</p>
<p>(c) Furthermore, show that if under the conditions of item (b) above, the set
of points undergoes an angular acceleration P! of cross-product matrix P&#127;,
then
</p>
<p>RJ D R P&#127; � P&#127;R �&#127;2R � R&#127;2 C 2&#127;R&#127;
</p>
<p>8.10 A wrench of unknown force f is applied to a rigid body. In order to find this
force, its moment with respect to a set of points fPk g31, of position vectors
fpk g31, is measured and stored in the set fnk g31. Show that f can be calculated
from the relation</p>
<p/>
</div>
<div class="page"><p/>
<p>8.4 Exercises 373
</p>
<p>Df D �vect.M/
</p>
<p>with D defined as in Sect. 8.2, i.e., as
</p>
<p>D � 1
2
Œtr.P/1 � P&#141;
</p>
<p>and M given by
</p>
<p>M D
�
</p>
<p>n1 � n n2 � n n3 � n
�
</p>
<p>; n � 1
3
</p>
<p>3
X
</p>
<p>1
</p>
<p>nk
</p>
<p>Note that P is defined in Exercise 8.3.
8.11 A wrench is applied to the tetrahedron of Fig. 3.10. When the force of this
</p>
<p>wrench acts at point Pk , the resulting moment is nk , for k D 1; 2; 3. For the
data displayed below, in frame F of that figure, find the resultant force f, as
well as the line of action of this force that will lead to a moment of minimum
magnitude. Determine this moment.
</p>
<p>n1 D �
p
2
</p>
<p>4
</p>
<p>2
</p>
<p>4
</p>
<p>1
</p>
<p>0
</p>
<p>0
</p>
<p>3
</p>
<p>5 ; n2 D
1
</p>
<p>12
</p>
<p>2
</p>
<p>4
</p>
<p>3
p
2
</p>
<p>�2
p
6
</p>
<p>2
p
3
</p>
<p>3
</p>
<p>5 ; n3 D
1
</p>
<p>12
</p>
<p>2
</p>
<p>4
</p>
<p>3
p
2
</p>
<p>2
p
6
</p>
<p>�2
p
3
</p>
<p>3
</p>
<p>5
</p>
<p>8.12 Matrix D, as defined from Eq. (8.6) and displayed in Eq. (8.10), was found to
involve frequent singularities, even in the presence of noncollinear points. This
weakness stems from its lack of frame-invariance, and can be readily fixed if
both sides of Eq. (8.6) are multiplied by PT from the right. Show that, under
these conditions, an equation similar to (8.9) is derived, but with D replaced by
.1=2/J, with J defined as in Exercise 8.9. Now show that J is frame-invariant
in the sense of Sect. 2.7, and becomes singular if and only if the three given
points are collinear.
</p>
<p>8.13 A ball-wheel is used to drive a mobile robot. For feedback control, its angular
velocity must be estimated using information on the velocities of two of its
points, P1 and P2, under the assumption that the ball rolls without slipping on
a horizontal, rigid floor. The radius of the wheel is 30 mm, and the two above
points lie on a horizontal diameter. Now, define a coordinate frame with origin
at the contact point, its Y -axis in the direction from P1 to P2 and its Z-axis
vertical, as sketched in Fig. 8.3. Off-board sensors provide reliable estimates,
in mm/s, of Pp1 and Pp2 as displayed below.
</p>
<p>Pp1 D
</p>
<p>2
</p>
<p>4
</p>
<p>120
</p>
<p>�60
�60
</p>
<p>3
</p>
<p>5 ; Pp2 D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>�60
60
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>374 8 Special Topics in Rigid-Body Kinematics
</p>
<p>Fig. 8.3 A ball-wheel
</p>
<p>(a) Show that the given estimates of Pp1 and Pp2 are compatible.
(b) Find the angular velocity of the ball.</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 9
</p>
<p>Geometry of General Serial Robots
</p>
<p>9.1 Introduction
</p>
<p>Current serial robots, encountered not only in research laboratories but also in
production or construction environments, include features that deserve a chapter
apart. We will call here general serial robots all non-redundant serial robots that do
not fall in the category of those studied in Chap. 4. Thus, the chapter is devoted to
manipulators of the serial type that do not allow a decoupling of the positioning and
the orientation problems. The focus of the chapter is, thus, the inverse displacement
problem (IDP) of general six-revolute robots. While redundant manipulators of the
serial type fall within this category as well, we will leave these aside, for their
redundancy resolution calls for a more specialized background than what we have
either assumed or given here.
</p>
<p>A special feature of serial manipulators of the kind studied here is that they can
admit up to sixteen inverse displacement solutions. Such manipulators are now
in operation in industry, an example of which is the TELBOT System, shown
in Fig. 9.1, which features all its six motors on its base, the motion and force
transmission taking place via concentric tubes and bevel gears. This special feature
allows TELBOT to have unlimited angular displacements at its joints, no cables
traveling through its structure and no deadload on its links by virtue of the motors
(W&auml;lischmiller and Li 1996).
</p>
<p>9.2 The IDP of General Six-Revolute Manipulators
</p>
<p>As shown in Chap. 4, the IDP of six-revolute manipulators of the most general type
leads to a system of six independent equations in six unknowns. This is a highly
</p>
<p>Electronic supplementary material The online version of this article (doi: 10.1007/978-3-319-
01851-5_9) contains supplementary material, which is available to authorized users.
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__9,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>375</p>
<p/>
</div>
<div class="page"><p/>
<p>376 9 Geometry of General Serial Robots
</p>
<p>Fig. 9.1 The TELBOT
System (courtesy of
W&auml;lischmiller GmbH,
Meersburg, Germany)
</p>
<p>nonlinear algebraic system whose solution posed a challenge to kinematicians for
about two decades and that was not considered essentially solved until the late
eighties. Below we give a short historical account of this problem.
</p>
<p>Pieper (1968) reported what is probably the earliest attempt to formulate
the inverse displacement problem of six-axis serial manipulators in a univariate
polynomial form. He showed that decoupled manipulators, studied in Sect. 4.4, and
a few others, allow a closed-form solution of the inverse displacement problem
associated with them. However, apart from the simple architectures identified by
Pieper, and others that have been identified more recently (Mavroidis and Roth
1992), a six-axis manipulator does not admit a closed-form solution. Attempts to
derive the minimal characteristic polynomial for this manipulator were reported by
Duffy and Derby (1979), Duffy and Crane (1980), Albala (1982), and Alizade et al.
(1983), who derived a 32nd-degree polynomial, but suspected that this polynomial
was not minimal, in the sense that the manipulator at hand might not be able
to admit up to 32 postures for a given end-effector (EE) pose. Tsai and Morgan
(1985) used a technique known as polynomial continuation (Morgan 1987) to solve
numerically the nonlinear displacement equations, cast in the form of a system of
quadratic equations. These researchers found that no more than 16 solutions were to
be expected. Briefly stated, polynomial continuation consists basically of two stages,
namely, reducing first the given problem to a system of polynomial equations; in
the second stage, a continuous path, also known as a homotopy in mathematics, is
defined with a real parameter t that can be regarded as time. The continuous path
takes the system of equations from a given initial state to a final one. The initial state
is so chosen that all solutions to the nonlinear system in this state are either apparent
or much easier to find numerically than those of the originally proposed system. The</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 The IDP of General Six-Revolute Manipulators 377
</p>
<p>final state of the system is the actual system to be solved. The initial system is thus
deformed continuously into the final state upon varying its set of parameters, as t
varies from 0 to 1. At each continuation step, a set of initial guesses for each of
the solutions already exists, for it is simply the solution to the previous continuation
step. Moreover, finding the solutions at the current continuation step is done using a
standard Newton method (Dahlquist and Bj&ouml;rck 1974).
</p>
<p>Primrose (1986) proved conclusively that the problem under discussion admits at
most 16 solutions, while Lee and Liang (1988) showed that the same problem leads
to a 16th-degree univariate polynomial. Using different elimination procedures, as
described in Sect. 9.3, Li1 (1990) and Raghavan and Roth (1990, 1993) devised
different procedures for the computation of the coefficients of the univariate
polynomial. While the inverse displacement problem can be considered basically
solved, research on finding all its solutions safely and quickly still continued into
the nineties (Angeles et al. 1993). Below we describe two approaches to solving
this problem: (a) the methods of Raghavan and Roth (1990, 1993) and of Li (1990),
aimed at reducing the displacement relations to a single univariate polynomial; and
(b) the bivariate-equation approach, introduced in (Angeles and Etemadi Zanganeh
1992).
</p>
<p>It will become apparent, however, that a streamlined algorithm guaranteeing the
reduction of the system of 14 fundamental equations, as derived in Sect. 9.2.2, to a
lower number of equations in only one or two unknowns, is still lacking. A step in
this direction is a method based on the concept of kinematic mapping, as reported
by Husty et al. (2007). Within their method, the authors split the six-revolute
kinematic chain into two three-revolute subchains, which allows the computation
of the 16 inverse-displacement solutions using advanced geometric concepts. Once
these solutions are available, the 16 possible values of a joint angle are known,
the balance five joint angles are then computed by linear-equation solving, as in the
case of the algorithms described here.
</p>
<p>9.2.1 Preliminaries
</p>
<p>We start by recalling a few definitions that were introduced in Chap. 4. In Sect. 4.2
we defined the matrices Qi and the vectors ai associated with the coordinate
transformations from frame FiC1 to frame Fi or, equivalently, the displacement of
the latter to the former. The 4�4 homogeneous matrix&mdash;see Sect. 2.5&mdash;transforming
coordinates in FiC1 to coordinates in Fi is given by
</p>
<p>Ai D
�
</p>
<p>Qi ai
</p>
<p>0T 1
</p>
<p>�
</p>
<p>(9.1)
</p>
<p>1N.B. Lee and Li of the references in this chapter are one and the same person, namely,
Dr.-Ing. Hongyou Lee (a.k.a. Dr.-Ing. Hongyou Li).</p>
<p/>
</div>
<div class="page"><p/>
<p>378 9 Geometry of General Serial Robots
</p>
<p>where 0 is the three-dimensional zero vector, while the 3� 3 rotation matrix Qi and
the three-dimensional vector ai were defined in Chap. 4 as
</p>
<p>Qi �
</p>
<p>2
</p>
<p>4
</p>
<p>ci ��i si �isi
si �ici ��ici
0 �i �i
</p>
<p>3
</p>
<p>5 ; ai �
</p>
<p>2
</p>
<p>4
</p>
<p>aici
ai si
bi
</p>
<p>3
</p>
<p>5 (9.2)
</p>
<p>In the above definitions we used the Denavit&ndash;Hartenberg notation, whereby ai is the
distance&mdash;and hence, ai � 0&mdash;between the Zi - and the ZiC1-axes, while bi is the
offset&mdash;�1 &lt; bi &lt; C1&mdash;between the Xi - and XiC1-axes, as measured along
the positive direction of the Zi -axis. Moreover,
</p>
<p>ci � cos �i ; si � sin �i ; �i � cos˛i ; �i � sin˛i
</p>
<p>where �i is the i th joint angle, measured fromXi toXiC1 in the positive direction of
Zi , and ˛i denotes the twist angle fromZi toZiC1 in the positive direction ofXiC1,
for i D 1; : : : ; 6. Furthermore, the factoring of matrix Qi , introduced in Eq. (4.2a),
is reproduced below for quick reference:
</p>
<p>Qi D ZiXi (9.3)
</p>
<p>with Xi and Zi denoting two pure reflections, namely,
</p>
<p>Xi �
</p>
<p>2
</p>
<p>4
</p>
<p>1 0 0
</p>
<p>0 ��i �i
0 �i �i
</p>
<p>3
</p>
<p>5 ; Zi �
</p>
<p>2
</p>
<p>4
</p>
<p>ci si 0
</p>
<p>si �ci 0
0 0 1
</p>
<p>3
</p>
<p>5 (9.4a)
</p>
<p>XTi D Xi D X�1i ZTi D Zi D Z�1i (9.4b)
</p>
<p>the foregoing reflections thus being both symmetric and self-inverse&mdash;see Sect. 2.4.
As a consequence,
</p>
<p>QTi D XiZi
</p>
<p>We will also use the partitionings of Qi displayed in Eq. (4.12), namely,
</p>
<p>Qi �
�
</p>
<p>pi qi ui
�
</p>
<p>D
</p>
<p>2
</p>
<p>4
</p>
<p>mTi
nTi
oTi
</p>
<p>3
</p>
<p>5 (9.5)
</p>
<p>A quick comparison between Eqs. (9.2) and (9.5) leads to the relations below:
</p>
<p>mi D
</p>
<p>2
</p>
<p>4
</p>
<p>ci
��i si
�isi
</p>
<p>3
</p>
<p>5 ; ni D
</p>
<p>2
</p>
<p>4
</p>
<p>si
�ici
��ici
</p>
<p>3
</p>
<p>5 ; oi D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>�i
�i
</p>
<p>3
</p>
<p>5 (9.6)</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 The IDP of General Six-Revolute Manipulators 379
</p>
<p>Further, let us recall the definition introduced in Eq. (4.13), e �
�
</p>
<p>0 0 1
�T
</p>
<p>, along
with that in Eq. (4.3d), ai D Qibi , which readily leads to bi D QTi ai . Hence,
</p>
<p>ui � Qie D
</p>
<p>2
</p>
<p>4
</p>
<p>�isi
��ici
�i
</p>
<p>3
</p>
<p>5 and bi �
</p>
<p>2
</p>
<p>4
</p>
<p>ai
bi�i
bi�i
</p>
<p>3
</p>
<p>5 (9.7)
</p>
<p>where we have reproduced Eq. (4.3e) for quick reference. Moreover, since ei D
Œei &#141;i D ŒeiC1&#141;iC1, the above expression for ui leads to
</p>
<p>ui D Qi ŒeiC1&#141;iC1 D ŒeiC1&#141;i (9.8a)
</p>
<p>which means that ui represents eiC1 in Fi . Likewise,
</p>
<p>oi D QTi Œei &#141;i D Œei &#141;iC1 (9.8b)
</p>
<p>Now, using Eqs. (9.4a) and the second of Eq. (9.7), we introduce the definitions
</p>
<p>&#13; i � Ziai D Xibi D
�
</p>
<p>ai 0 bi
�T
</p>
<p>(9.9)
</p>
<p>whence
</p>
<p>bi D Xi&#13; i (9.10)
</p>
<p>Furthermore, vector xi of Eq. (4.11) is reproduced below for quick reference as well:
</p>
<p>xi �
�
</p>
<p>cos �i
sin �i
</p>
<p>�
</p>
<p>(9.11)
</p>
<p>A useful concept in this context is that of bilinear form: An algebraic expression
of the form Auv, where u and v are two given scalar variables and A is independent
of u and v, is said to be bilinear in u and v. Likewise, an expression of the form
Au2v2 is said to be biquadratic in u and v, with similar definitions for bicubic,
trilinear, and multilinear forms. Moreover, the same definitions apply to vector and
matrix expressions, as pertaining to their components and, correspondingly, their
scalar entries.
</p>
<p>In light of the definition of xi , additionally, we shall refer to an expression of
the form
</p>
<p>E1 � A cos �i C B sin �i C C (9.12)
</p>
<p>in which coefficients A, B and C are independent of �i , as being linear in xi .
Likewise, an expression of the form
</p>
<p>E2 � A cos �i cos �jCB cos �i sin �jCC sin �i cos �jCD sin �i sin �jCF (9.13)</p>
<p/>
</div>
<div class="page"><p/>
<p>380 9 Geometry of General Serial Robots
</p>
<p>with coefficients A, B , : : :, F independent of both �i and �j , will be termed bilinear
in xi and xj . In fact, such an expression may also involve terms linear in xi and
xj alone. More generally, an expression involving terms with products such as
cos2 �i cos2 �j and other terms with similar products of the same or lower degree
will be termed biquadratic in xi and xj . Now we have
</p>
<p>Lemma 9.2.1. Let matrix A be skew-symmetric and B be defined as the similarity
</p>
<p>transformation of A given below:
</p>
<p>B � QiAQTi (9.14)
</p>
<p>where Qi was recalled in Eq. (9.2) and A is assumed to be independent of �i . Then,
</p>
<p>B is linear in xi .
</p>
<p>Proof. This result follows from relation (2.139). Indeed, as the reader can readily
verify, B is skew-symmetric, and the product Bv, for any three-dimensional vector
v, can be expressed in terms of b, defined as vect.B/&mdash;see Sect. 2.3.3. That is,
</p>
<p>Bv D b � v
</p>
<p>If a denotes vect.A/, then a and b, by virtue of Eq. (9.14) and the results of Sect. 2.6,
obey the relation
</p>
<p>b D Qia
</p>
<p>Hence,
</p>
<p>Bv D .Qia/ � v
</p>
<p>thereby showing that the resulting product is linear in xi , q.e.d.
</p>
<p>Moreover, let
</p>
<p>�i � tan
�
�i
</p>
<p>2
</p>
<p>�
</p>
<p>(9.15a)
</p>
<p>which allows us to write the identities below, as suggested by Li (1990):
</p>
<p>si � �ici � �i ; �i si C ci � 1 (9.15b)
</p>
<p>We now define p as the vector directed from the origin of F1 to the operation point
(OP) P of Fig. 9.2. Moreover, we let l � Œ lx ; ly ; lz &#141;T , m � Œ mx ; my ; mz &#141;T , and
n � Œ nx ; ny ; nz &#141;T represent the three mutually perpendicular unit vectors parallel
to theX7, Y7 andZ7 axes, respectively, of F7, which has its origin at P&mdash;a layout of
these axes is depicted in Fig. 4.3 for a decoupled manipulator. Hence, the pose of the
EE is described in the base frame F1 by means of the homogeneous transformation
A given as
</p>
<p>A D
�
</p>
<p>Q p
</p>
<p>0T 1
</p>
<p>�
</p>
<p>; Q �
�
</p>
<p>l m n
�
</p>
<p>D
</p>
<p>2
</p>
<p>4
</p>
<p>lx mx nx
ly my ny
lz mz nz
</p>
<p>3
</p>
<p>5</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 The IDP of General Six-Revolute Manipulators 381
</p>
<p>Fig. 9.2 Partitioning of the manipulator loop into two subloops
</p>
<p>In the next step, we derive a set of scalar equations in five unknowns, upon
eliminating one of these, that is fundamental in computing the solution of the
problem at hand.
</p>
<p>9.2.2 Derivation of the Fundamental Closure Equations
</p>
<p>Given the geometric parameters of the manipulator and the pose of the EE with
respect to the base frame, we derive the manipulator displacement equations, a.k.a.
the loop-closure equations, from which all unknown angles are to be computed.
We start by recalling the (matrix) rotation and (vector) translation equations of
the general six-axis manipulator, as displayed in Eqs. (4.9a and b), and reproduced
below for quick reference:
</p>
<p>Q1Q2Q3Q4Q5Q6 D Q (9.16a)
a1 CQ1a2 CQ1Q2a3 C : : :CQ1Q2Q3Q4Q5a6 D p (9.16b)
</p>
<p>The use of 4 � 4 homogeneous transformations in the ensuing preparatory work
will ease the suitable recasting of the foregoing equations. Thus, by using the
matrices Ai of Eq. (9.1) in the above rotation and translation equations, we end
up with a 4 � 4 matrix equation, namely,
</p>
<p>A1A2A3A4A5A6 D A (9.17)</p>
<p/>
</div>
<div class="page"><p/>
<p>382 9 Geometry of General Serial Robots
</p>
<p>The unknown variables in the above equations are the joint angles f�ig61; the
IDP thus consists in solving the closure equations (9.16a and b) or, equivalently,
Eq. (9.17), for these unknowns. The said equations comprise 12 scalar equations
and four identities; however, among these equations, only six are independent, for
the columns (or the rows) of a rotation matrix must form an orthonormal&mdash;mutually
orthogonal and of unit magnitude&mdash;set of vectors. The orthonormality property of
the columns or rows of a rotation matrix, thus, brings about six scalar constraints.
</p>
<p>The basic approach to solving the IDP resorts to disassembling the kinematic
chain of the manipulator at two joints, e.g., joints 3 and 6, to obtain two subchains or
subloops (Li et al. 1991). The first subchain, as suggested in the foregoing reference,
and depicted in Fig. 9.2, goes from joint 3 to joint 6 via joints 4 and 5, while
the second subchain goes from joint 6 to joint 3 via the EE and joints 1 and 2.
Algebraically, this is equivalent to rewriting Eq. (9.17) in the form
</p>
<p>A3A4A5 D A�12 A�11 AA�16 (9.18a)
</p>
<p>Note that each side of Eq. (9.18a) bears a specific structure. Indeed, if we denote by
Ls and Rs the left- and right-hand sides of Eq. (9.18a), we have
</p>
<p>Ls �
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>l11.�3; �4; �5/ l12.�3; �4; �5/ l13.�3; �4; �5/ l14.�3; �4; �5/
</p>
<p>l21.�3; �4; �5/ l22.�3; �4; �5/ l23.�3; �4; �5/ l24.�3; �4; �5/
</p>
<p>l31.�4; �5/ l32.�4; �5/ l33.�4; �5/ l34.�4; �5/
</p>
<p>0 0 0 1
</p>
<p>3
</p>
<p>7
7
5
</p>
<p>(9.18b)
</p>
<p>Rs �
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>r11.�1; �2; �6/ r12.�1; �2; �6/ r13.�1; �2/ r14.�1; �2/
</p>
<p>r21.�1; �2; �6/ r22.�1; �2; �6/ r23.�1; �2/ r24.�1; �2/
</p>
<p>r31.�1; �2; �6/ r32.�1; �2; �6/ r33.�1; �2/ r34.�1; �2/
</p>
<p>0 0 0 1
</p>
<p>3
</p>
<p>7
7
5
</p>
<p>(9.18c)
</p>
<p>where lij and rij denote nontrivial components of the left- and the right-hand
sides, respectively, of Eq. (9.18a). Note that, because of the forms of matrices Qi ,
whose third rows are independent of �i , the third row of Ls , as made apparent in
Eq. (9.18b), is free of �3. Likewise, the third and fourth columns of Rs , as made
apparent in Eq. (9.18c), are free of �6.
</p>
<p>It should be apparent that other pairs of joints can be used to disassemble
the kinematic chain of the manipulator into two subchains; what matters is that
none of the two subchains contains more than three joints; else, the entries of the
homogeneous matrices become unnecessarily complex on one side of the matrix
equation, while the entries of the other side become unnecessarily simple.
</p>
<p>Now we extract one rotation and one translation equation from the 4 � 4 matrix
equation (9.18a), namely,
</p>
<p>Q3Q4Q5 D QT2 QT1 QQT6 (9.19a)
Q3.b3 CQ4b4 CQ4Q5b5/ D QT2 QT1 .p �Qb6/ � .b2 CQT2 b1/ (9.19b)</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 The IDP of General Six-Revolute Manipulators 383
</p>
<p>which are kinematically equivalent to Eqs. (9.16a and b), but algebraically much
simpler. Note that, in Eq. (9.19b), we used the second Eq. (9.7) to substitute ai by
Qibi . In the sequel, we will need the two products below:
</p>
<p>Q5e � Q5Œe6&#141;6 D Œe6&#141;5 (9.20a)
QT6 e � QT6 Œe6&#141;6 D o6 D Œe6&#141;7 (9.20b)
</p>
<p>where we have recalled relations (9.8a and b); whence,
</p>
<p>QQT6 e � QŒe6&#141;7 D Œe6&#141;1 � � 6 (9.20c)
</p>
<p>Further, we equate the product of each of the two sides of Eq. (9.19a) by e from the
right, to obtain, in light of Eqs. (9.20a and c),
</p>
<p>Q3Q4Œe6&#141;5 D QT2 QT1 Œe6&#141;1 (9.21a)
</p>
<p>Both sides of Eq. (9.21a) thus represent the unit vector e6 in frame F3; the difference
between the two sides should be apparent: while the left-hand side is obtained by
transforming Œe6&#141;5 into Œe6&#141;3, the right-hand side by transforming Œe6&#141;1 likewise. On
the other hand, Eq. (9.19b) can be cast in the form
</p>
<p>Q3.b3 CQ4b4 CQ4Q5b5/ D QT2 QT1 � � .b2 CQT2 b1/ (9.21b)
</p>
<p>where � � p � Qb6 D Œp � a6&#141;1. Hence, the left- and the right-hand sides of
Eq. (9.21b) represent vector a3 C a4 C a5 in frame F3, the difference being that the
left-hand side is obtained by carrying the F4-representation of the vector into F3,
while the right-hand side does so from the F1-representation of the same vector.
</p>
<p>Further, let the left- and the right-hand sides of Eq. (9.21a) be denoted by h and
i, respectively, while the counterparts of Eq. (9.21b) by f and g, i.e.,
</p>
<p>h � h.�3; �4; �5/ D Q3Q4u5 (9.22a)
i � i.�1; �2/ D QT2 QT1 � 6 (9.22b)
f � f.�3; �4; �5/ D Q3.b3 CQ4b4 CQ4Q5b5/ (9.22c)
g � g.�1; �2/ D QT2 QT1 � � .b2 CQT2 b1/ D QT2 .QT1 � � b1/ � b2 (9.22d)
</p>
<p>Further, notice that arrays f and g represent, in fact, the first three entries of the
fourth columns of the matrices of Eqs. (9.18b) and (9.18c), respectively. Likewise,
arrays h and i represent the third columns of the same matrices. Vectors g and i are
thus free of �6.</p>
<p/>
</div>
<div class="page"><p/>
<p>384 9 Geometry of General Serial Robots
</p>
<p>Now, the six scalar equations (9.21b) and (9.21a) reduce, correspondingly, to
</p>
<p>f D g or
</p>
<p>2
</p>
<p>4
</p>
<p>fx.�3; �4; �5/
</p>
<p>fy.�3; �4; �5/
</p>
<p>fz.�4; �5/
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>gx.�1; �2/
</p>
<p>gy.�1; �2/
</p>
<p>gz.�1; �2/
</p>
<p>3
</p>
<p>5 (9.23a)
</p>
<p>h D i or
</p>
<p>2
</p>
<p>4
</p>
<p>hx.�3; �4; �5/
</p>
<p>hy.�3; �4; �5/
</p>
<p>hz.�4; �5/
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>ix.�1; �2/
</p>
<p>iy.�1; �2/
</p>
<p>iz.�1; �2/
</p>
<p>3
</p>
<p>5 (9.23b)
</p>
<p>It should be noted that h and i are both unit vectors. Thus, each side of Eq. (9.23b)
is subjected to a quadratic constraint, i.e.,
</p>
<p>h � h D 1; i � i D 1
</p>
<p>and hence, out of the above six scalar equations, only five are independent. However,
the number of unknowns in these six equations is also five. Therefore, Eqs. (9.23a)
and (9.23b) suffice to determine the five unknown joint angles contained therein.
</p>
<p>Although we already have one redundant equation to compute the six unknown
angles, it will prove convenient to derive eight additional equations with the same
power products2 as f, g, h and i, namely,
</p>
<p>f � f D g � g (9.23c)
f � h D g � i (9.23d)
</p>
<p>f � h D g � i (9.23e)
.f � f/h � 2.f � h/f D .g � g/i � 2.g � i/g (9.23f)
</p>
<p>It is noteworthy that Eq. (9.23f) is derived by first equating the reflection3 of vector
h onto a plane normal to f with its counterpart, the reflection of vector i onto a plane
normal to g. The final form of Eq. (9.23f) is obtained upon clearing denominators in
the foregoing reflection equation.
</p>
<p>Equations (9.23a&ndash;9.23f) amount to 14 scalar equations in five unknown joint
variables f�ig51. These are the fundamental closure equations sought. Some facts
pertaining to the degree of the two sides of Eqs. (9.23c-f) are proven below:
</p>
<p>Fact 9.2.1. The inner products f �f and f �h are both free of x3 and bilinear in f xi g54,
while their counterparts g � g and g � i are bilinear in x1 and x2.
</p>
<p>2By power product we mean terms with their coefficients deleted; for example, the power products
of the polynomial 5x2y C 3xzC 9y2 C 4z D 0 are the terms x2y, xz, y2 and z.
3Neither Li nor Raghavan and Roth disclosed the geometric interpretation of this fourth equation,
first proposed by Lee and Liang (1988).</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 The IDP of General Six-Revolute Manipulators 385
</p>
<p>Proof.
</p>
<p>f � f � kQ3.b3 CQ4b4 CQ4Q5b5/k2
</p>
<p>� kb3 CQ4b4 CQ4Q5b5k2
</p>
<p>�
5
X
</p>
<p>3
</p>
<p>kbik2 C 2bT3 Q4.b4 CQ5b5/C 2bT4 Q5b5
</p>
<p>whose rightmost-hand side is clearly free of x3 and is bilinear in f xi g54. Similarly,
</p>
<p>f � h � .b3 CQ4b4 CQ4Q5b5/TQT3 Q3Q4u5
� bT3 Q4u5 C bT4 u5 C bT5 QT5 u5
</p>
<p>whose rightmost-hand side is apparently bilinear in x4 and x5, except for the last
term, which contains two factors that are linear in x5, and hence, can be suspected
to be quadratic. However, Q5b5 is, in fact, a5, while u5 is the last column of Q5, the
suspicious term thus reducing to a constant, namely, b5 cos˛5. Similar proofs for
g � g and g � i will be given presently. Moreover, ut
Fact 9.2.2. Vector f�h is trilinear in f xi g53, while its counterpart, g� i, is bilinear
in f xi g21.
Proof. If we want the cross product of two vectors in frame A but have these vectors
in frame B, then we can proceed in two ways: either (a) transform each of the two
vectors into A-coordinates and perform the cross product of the two transformed
vectors; or (b) perform the product of the two vectors in B-coordinates and then
transform the product vector into A-coordinates. Obviously, the two products will
be the same, which allows us to write
</p>
<p>f � h � Q3 Œb3 � .Q4u5/C .Q4b4/ � .Q4u5/C .Q4Q5b5/ � .Q4u5/&#141;
� Q3fb3 � .Q4u5/CQ4.b4 � u5/CQ4 Œ.Q5b5/ � u5/&#141;g
</p>
<p>whose rightmost-hand side is apparently trilinear in f xi g53, except for the term in
brackets, which looks quadratic in x5. A quick calculation, however, reveals that this
term is, in fact, linear in x5 as well. Indeed, from the definitions given in Eqs. (4.3c
and d) and (9.5) we have
</p>
<p>.Q5b5/ � u5 � a5 � u5 �
</p>
<p>2
</p>
<p>4
</p>
<p>a5�5s5 C b5�5c5
�a5�5c5 C b5�5s5
</p>
<p>�a5�5
</p>
<p>3
</p>
<p>5
</p>
<p>which is obviously linear in x5. The proof for the counterpart product, g�i, parallels
the foregoing proof, and will be given below. ut
Fact 9.2.3. Vector .f � f/h� 2.f � h/f is trilinear in f xi g53, its counterpart, .g � g/i�
2.g � i/g, being bilinear in f xi g21.</p>
<p/>
</div>
<div class="page"><p/>
<p>386 9 Geometry of General Serial Robots
</p>
<p>Proof. First, we write the (elongated or contracted) reflection of vector h in the form
</p>
<p>.f � f/h � 2.f � h/f � Q3v
</p>
<p>where
</p>
<p>v �
 
</p>
<p>5
X
</p>
<p>3
</p>
<p>kbik2
!
</p>
<p>Q4u5 � 2Œ.uT5 Q4b3/b3 C .uT5 b4/b3 C .uT5 b4/Q4b4
</p>
<p>C .uT5 Q5b5/b3 C .uT5 Q5b5/Q4b4 C .uT5 Q5b5/Q4Q5b5&#141;C 2w
</p>
<p>D
 
</p>
<p>5
X
</p>
<p>3
</p>
<p>kbik2
!
</p>
<p>Q4u5 � 2ŒuT5 b4.b3 C b3 CQ4b4/
</p>
<p>CuT5 Q5b5.b3 CQ4b4 CQ4Q5b5/C 2w
</p>
<p>with all terms on the right-hand side, except for w, which will be defined presently,
clearly bilinear in x4 and x5. Vector w is defined as
</p>
<p>w � Œ &#141;1 C Œ &#141;2 C Œ &#141;3
</p>
<p>each of the foregoing brackets being expanded below:
</p>
<p>Œ &#141;1 �
�
</p>
<p>.bT3 Q4b4/Q4u5 � .uT5 QT4 b3/Q4b4
�
</p>
<p>� Q4.u5bT4 QT4 � b4uT5 QT4 /b3
� Q4.u5bT4 � b4uT5 /QT4 b3
</p>
<p>which thus reduces to a product including a factor of the form QiAQTi , with A
being the term in parentheses in the rightmost-hand side of the last equation. This is
obviously a skew-symmetric matrix, and Lemma 9.2.1 applies, i.e., the rightmost-
hand side of the last equation is linear in x4. This term is, hence, bilinear in x4
and x5. Furthermore,
</p>
<p>Œ &#141;2 �
�
</p>
<p>.bT4 Q5b5/Q4u5 � .uT5 b4/Q4Q5b5
�
</p>
<p>� Q4
�
</p>
<p>.bT5 Q
T
5 b4/u5 � .uT5 b4/Q5b5
</p>
<p>�
</p>
<p>� Q4.u5bT5 QT5 �Q5b5uT5 /b4
</p>
<p>which is apparently linear in x4, but it is not obvious that it is also linear in x5.
To show that the second linearity also holds, we can proceed in two ways. First,
note that the term in parentheses is the skew-symmetric matrix u5aT5 � a5uT5 ,
whose vector, a5 � u5, was already proven to be linear in x5. Since the vector</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 The IDP of General Six-Revolute Manipulators 387
</p>
<p>of a skew-symmetric matrix fully defines that matrix&mdash;see Sect. 2.3&mdash;the linearity
of the foregoing term in x5 follows immediately. Alternatively, we can expand the
aforementioned difference, thereby deriving
</p>
<p>u5a
T
5 � a5uT5 D
</p>
<p>2
</p>
<p>4
</p>
<p>0 a5�5 �a5�5c5 C b5�5s5
�a5�5 0 �a5�5s5 � b5�5c5
</p>
<p>a5�5c5 � b5�5s5 a5�5s5 C b5�5c5 0
</p>
<p>3
</p>
<p>5
</p>
<p>which is clearly linear in x5. Moreover, its vector can be readily identified as a5�u5,
as calculated above. Finally,
</p>
<p>Œ &#141;3 �
�
</p>
<p>.bT3 Q4Q5b5/Q4u5 � .uT5 QT4 b3/Q4Q5b5
�
</p>
<p>� Q4.u5bT5 QT5 �Q5b5uT5 /QT4 b3
� Q4.u5aT5 � a5uT5 /QT4 b3
</p>
<p>this bracket thus reducing to a product including the factor QiAQTi , with A
skew-symmetric. Hence, the foregoing expression is linear in x4, according to
Lemma 9.2.1. Moreover, the matrix in parentheses was already proven to be linear
in x5, thereby completing the proof for vector .f � f/h�2.f �h/f. The proof for vector
.g � g/i � 2.g � i/g parallels the foregoing proof and will be given presently. ut
</p>
<p>Finally, we have one more useful result:
</p>
<p>Fact 9.2.4. If a scalar, vector, or matrix equation is linear in xi , then upon
</p>
<p>substitution of ci and si by their equivalent forms in terms of �i � tan.�i=2/, the
foregoing equation becomes quadratic in �i after clearing denominators.
</p>
<p>Proof. We shall show that this result holds for a scalar equation, with the extension
to vector and matrix equations following directly. The scalar equation under
discussion takes the general form
</p>
<p>Aci C Bsi C C D 0
</p>
<p>where the coefficients A, B , and C do not contain �i . Upon substituting ci and si in
terms of �i � tan.�i=2/, and multiplying both sides of that equation by 1C �2i , we
obtain
</p>
<p>A.1 � �2i /C 2B�i C C.1C �2i / D 0
</p>
<p>which is clearly quadratic in �i , q.e.d.
</p>
<p>Moreover, if a scalar, vector, or matrix equation is of degree k in xi , upon
introducing the same trigonometric substitution, the said equation becomes of
degree 2k in �i .</p>
<p/>
</div>
<div class="page"><p/>
<p>388 9 Geometry of General Serial Robots
</p>
<p>Expressions for the right-hand sides of Eqs. (9.23c&ndash;d) are given below:
</p>
<p>g � g D
2
X
</p>
<p>1
</p>
<p>kbik2 C k�k2 � 2�TQ1.Q2b2 C b1/C 2bT1 Q2b2 (9.24a)
</p>
<p>g � i D � T6 .� �Q1Q2b2 �Q1b1/ (9.24b)
g � i D QT2 QT1 .� � � 6/ � b2 �QT2 QT1 � 6 �QT2 .b1 �QT1 � 6/ (9.24c)
</p>
<p>and
</p>
<p>.g � g/i � 2.g � i/g D
 
</p>
<p>2
X
</p>
<p>1
</p>
<p>kbik2 C k�k2
!
</p>
<p>QT2 Q
T
1 � 6
</p>
<p>�2Œ.� T6 �/.QT2 QT1 � � b2 �QT2 b1/C .� T6 Q1Q2b2/b2
C.� T6 Q1b1/b2 C .� T6 Q1b1/QT2 b2&#141;C 2w0 (9.24d)
</p>
<p>In deriving and simplifying the above relations, we use the invariance relations&mdash;see
Sect. 2.7&mdash;of the dot and cross products, i.e., for any arbitrary vectors u and v, we
have
</p>
<p>.Qiu/
T .Qiv/ D uT v
</p>
<p>.Qiu/ � .Qiv/ D Qi .u � v/
</p>
<p>All the terms on the right-hand sides of Eqs. (9.24a&ndash;d), except for w0, are apparently
bilinear in x1 and x2. This bilinearity also holds for the last term in Eq. (9.24d), i.e.,
w0, which can be expressed in the form
</p>
<p>w0 � Œ &#141;01 C Œ &#141;02 C Œ &#141;03 (9.25)
</p>
<p>Each of the above brackets is given as
</p>
<p>Œ &#141;01 � Œ.� T6 Q1Q2b2/QT2 QT1 � � .�TQ1Q2b2/QT2 QT1 � 6&#141;
D .QT2 QT1 /.�� T6 � � 6�T /.Q2Q1/b2 (9.26a)
</p>
<p>Œ &#141;02 � Œ.bT1 Q2b2/QT2 QT1 � 6 � .� T6 Q1Q2b2/QT2 b1&#141;
D QT2 Œ.QT1 � 6/b1 � b1.QT1 � 6/T &#141;Q2b2 (9.26b)
</p>
<p>Œ &#141;03 � Œ.� T6 Q1b1/QT2 QT1 � � .�TQ1b1/QT2 QT1 � 6&#141;
D QT2 ŒQT1 .�� T6 � � 6�T /Q1&#141;b1 (9.26c)
</p>
<p>According to Lemma 9.2.1, the terms in the right-hand sides of relations (9.26a&ndash;c)
are all bilinear in x1 and x2.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.2 The IDP of General Six-Revolute Manipulators 389
</p>
<p>It is noteworthy that the third components of vectors f� h and .f � f/h� 2.f � h/f,
as well as f � f and f � h, are all free of �3. Hence, among the 14 scalar equations, i.e.,
Eqs. (9.23a&ndash;f), six are free of �3. Casting all 14 equations in vector form results in
the fundamental closure equations:
</p>
<p>Px45 D Rx12 (9.27)
</p>
<p>where P and R are 14�9 and 14�8matrices, respectively. Moreover, the entries of
P are linear in x3, while those of R are independent of the joint angles. In addition,
the nine- and eight-dimensional vectors x45 and x12 are defined as
</p>
<p>x45 �
�
</p>
<p>s4s5 s4c5 c4s5 c4c5 s4 c4 s5 c5 1
�T
</p>
<p>(9.28a)
</p>
<p>x12 �
�
</p>
<p>s1s2 s1c2 c1s2 c1c2 s1 c1 s2 c2
�T
</p>
<p>(9.28b)
</p>
<p>Various approaches have been reported to solve the fundamental closure equa-
tions for the unknown joint angles, but all methods fall into two categories: (a)
purely numerical approaches, whereby no attempt is made to reduce the number
of unknowns (Angeles 1985), or the reduction is rather limited, from six to four
unknowns (Tsai and Morgan 1985); and (b) elimination approaches, whereby
unknowns are eliminated algebraically, as opposed to numerically, until a reduced
number of equations in a reduced number of unknowns is derived.
</p>
<p>We focus here only on the second category. Of these, we have essentially
two classes: (a) the univariate-polynomial approach and (b) the bivariate-equation
approach. As the names indicate, the former aims at reducing the fundamental
equations to one single equation in one unknown. Moreover, that single equation,
being polynomial in form, is termed the characteristic polynomial of the problem at
hand. The polynomial is derived upon substituting the cosine and sine functions of
the unknown angle, say �x , by .1�T 2/=.1CT 2/ and 2T=.1CT 2/, respectively, with
T � tan.�x=2/. This transformation is well known as the tan-half trigonometric
identities. The second approach, in turn, aims at reducing all fundamental closure
equations to a smaller system of trigonometric, as opposed to polynomial, equations
in only two unknowns.
</p>
<p>The transformation of the original problem given in terms of trigonometric
functions of the unknown angles into a polynomial equation in T is essential from a
conceptual viewpoint, for this transformation makes apparent that the problem under
study admits a finite number of solutions, namely, the degree of the characteristic
polynomial. On the other hand, the same transformation is not trouble-free. Indeed,
the mapping from �x into T apparently includes a singularity at �x D � , whereby
T ! 1. The outcome is that, if one of the solutions is �x D � , then the
characteristic polynomial admits at least one solution at infinity, which is reflected
in a deflation of the polynomial. This phenomenon, called polynomial deflation, was
made apparent in Example 4.4.3, where a quartic characteristic polynomial appeared
as cubic because of one solution at infinity. The beginner may thus be misled to
believing that, in the presence of a solution at infinity, the system at hand admits a</p>
<p/>
</div>
<div class="page"><p/>
<p>390 9 Geometry of General Serial Robots
</p>
<p>smaller number of solutions than it actually does. Furthermore, in the neighborhood
of �x D � , one of the solutions is extremely large in absolute value, which thus
gives rise to numerical inaccuracies, generically referred to as ill-conditioning. As a
matter of fact, the problem of polynomial-root finding has been identified as ill-
conditioned by numerical analysts for some time (Forsythe 1970).
</p>
<p>In order to cope with the foregoing shortcomings of the tan-half identities, the
author and his team devised an alternative means, the bivariate-equation approach,
to solving the problem at hand and other similar ones in computational kinematics
(Angeles and Etemadi Zanganeh 1992a,b). In this approach, the 14 equations are
reduced to a system of bivariate trigonometric equations in the sines and cosines of
two of the unknown angles. These equations are then plotted in the plane of the two
unknowns, thus obtaining four contours, whose intersections yield the real values
of the two unknowns. As a matter of fact, only two such equations would suffice;
however, it turns out that the underlying reduction cannot be accomplished without
the introduction of either extra equations or spurious roots, which must be detected
in order to discard them. Notice that, for an intersection point to qualify as a solution,
all contours must meet at that point. As illustrated with one example, even the use
of extra contours does not guarantee a legitimate solution. Spurious solutions fail to
allow for the computation of the remaining four joint angles.
</p>
<p>9.3 The Univariate-Polynomial Approach
</p>
<p>We describe here two procedures leading to one single univariate 16th-degree
polynomial equation, which is the characteristic polynomial of the system at hand.
The two procedures bear many similarities, but they also involve remarkable
differences that warrant separate discussions.
</p>
<p>9.3.1 The Raghavan&ndash;Roth Procedure
</p>
<p>A sophisticated elimination procedure was proposed by Raghavan and Roth (1990,
1993). Their procedure is based on Eqs. (9.23a&ndash;f), but their 14 closure equations are
different, as explained below.
</p>
<p>At the outset, Raghavan and Roth define four vectors that will play a key role in
the ensuing derivations, namely,
</p>
<p>Qf � Qf.�4; �5/ D
</p>
<p>2
</p>
<p>4
</p>
<p>f1
f2
f3
</p>
<p>3
</p>
<p>5 D Z3f D X3.b3 CQ4b4 CQ4Q5b5/ (9.29a)
</p>
<p>Qh � Qh.�1/ D
</p>
<p>2
</p>
<p>4
</p>
<p>h1
h2
h3
</p>
<p>3
</p>
<p>5 D Q2gC a2 D QT1 � � b1 (9.29b)</p>
<p/>
</div>
<div class="page"><p/>
<p>9.3 The Univariate-Polynomial Approach 391
</p>
<p>Table 9.1 Expressions for the components of vectors Qf, Qh, Qr, and Qn
Item Expression Item Expression
</p>
<p>f1 c4�1 C s4�2 C a3 r1 c4m1 C s4m2
f2 ��3.s4�1 � c4�2/ r2 ��3.s4m1 � c4m2/
</p>
<p>C�3�3 C�3m3
f3 �3.s4�1 � c4�2/ r3 �3.s4m1 � c4m2/
</p>
<p>C�3�3 C b3 C�3m3
�1 c5a5 C a4 m1 s5�5
�2 �s5�4a5 C �4b5 m2 c5�4�5 C �4�5
�3 s5�4a5 C �4b5 C b4 m3 �c5�4�5 C �4�5
h1 c1pC s1q � a1 n1 c1uC s1v
h2 ��1.s1p � c1q/ n2 ��1.s1u� c1v/
</p>
<p>C�1.r � b1/ C�1w
h3 �1.s1p � c1q/ n3 �1.s1u� c1v/
</p>
<p>C�1.r � b1/ C�1w
p �lxa6 � .mx�6 C nx�6/b6 u mx�6 C nx�6
</p>
<p>Cpx
q �lya6 � .my�6 C qny�6/b6 v my�6 C ny�6
</p>
<p>Cpy
r �lza6 � .mz�6 C nz�6/b6 w mz�6 C nz�6
</p>
<p>Cpz
</p>
<p>Qr � Qr.�4; �5/ D
</p>
<p>2
</p>
<p>4
</p>
<p>r1
r2
r3
</p>
<p>3
</p>
<p>5 D Z3h D X3Q4u5 (9.29c)
</p>
<p>Qn � Qn.�1/ D
</p>
<p>2
</p>
<p>4
</p>
<p>n1
n2
n3
</p>
<p>3
</p>
<p>5 D Q2i D QT1 � 6 (9.29d)
</p>
<p>Expressions for the components of the above four vectors are given in Table 9.1,
where �i .i D 1; 2; 3/; p; q; r; u; v; and w are auxiliary variables. Using
Eqs. (9.29a&ndash;d), (9.3), (9.4b), (9.10), and (9.9), we can rewrite Eqs. (9.21a and b)
in terms of the foregoing vectors, namely,
</p>
<p>Z3 Qr.�4; �5/ D X2Z2 Qn.�1/ (9.30a)
Z3Qf.�4; �5/ D X2ŒZ2 Qh.�1/ � &#13;2&#141; (9.30b)
</p>
<p>where we have recalled definitions (9.9) for i D 2. These six scalar equations play a
key role in deriving the Raghavan&ndash;Roth equations in five unknowns that are needed
to solve the problem at hand.
</p>
<p>Next, both sides of Eqs. (9.30a and b) are multiplied from the left by X�12 �
XT2 � X2; then, the two equations thus resulting are rearranged in the forms
</p>
<p>X2Z3QfC &#13;2 D Z2 Qh (9.31)
X2Z3 Qr D Z2 Qn (9.32)</p>
<p/>
</div>
<div class="page"><p/>
<p>392 9 Geometry of General Serial Robots
</p>
<p>Now, four new vectors, the counterparts of those introduced in Eq. (9.22a&ndash;d), are
defined as
</p>
<p>f � X2Z3QfC &#13;2 D X2.Z3QfC b2/ (9.33a)
g � Z2 Qh (9.33b)
h � X2Z3 Qr (9.33c)
ı � Z2 Qn (9.33d)
</p>
<p>Note that f and h are trilinear4 in x3, x4, and x5, while the first two components
of g and ı are bilinear in x1 and x2, their third components being linear in x1 and
free of �2. Similar to Eqs. (9.23a and b), six scalar equations are obtained:
</p>
<p>f D g (9.34a)
h D ı (9.34b)
</p>
<p>Moreover, eight more scalar equations are obtained in the forms
</p>
<p>f � f D g � g (9.34c)
f � h D g � ı (9.34d)
</p>
<p>f � h D g � ı (9.34e)
.f � f/h � 2.f � h/f D .g � g/ı � 2.g � ı/g (9.34f)
</p>
<p>The fourteen scalar equations (9.34a&ndash;f) are henceforth termed the Raghavan&ndash;Roth
(RR) equations.
</p>
<p>The third components of the two vectors on the right-hand sides of Eqs. (9.34e
and f), and the terms on the right-hand sides of Eqs. (9.34c and d) are free of �2
and linear in x1. As proven by Raghavan and Roth in the above references, the eight
foregoing equations have the same power products as f, h, g, and ı. Now, the 14 RR
equations (9.34a&ndash;f) are cast in the form
</p>
<p>Px45 D Rx12 (9.35)
</p>
<p>where P and R are 14 � 9 and 14 � 8 matrices, respectively. Moreover, the entries
of P are linear in x3, while those of R are independent of the joint angles; moreover,
R has the structure:
</p>
<p>4while the last row of Z3 is free of �3, the last row of X2Z3 is Œ�2s3; ��2c3; �2&#141;.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.3 The Univariate-Polynomial Approach 393
</p>
<p>R �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>� � � � 0 0 � �
� � � � 0 0 � �
0 0 0 0 � � 0 0
� � � � 0 0 � 0
� � � � 0 0 0 �
0 0 0 0 � � 0 0
0 0 0 0 � � 0 0
0 0 0 0 � � 0 0
� � � � 0 0 � 0
� � � � 0 0 0 �
0 0 0 0 � � 0 0
� � � � 0 0 � �
� � � � 0 0 � �
0 0 0 0 � � 0 0
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>(9.36)
</p>
<p>In the above display, all nonzero entries are denoted by � and rows are written
according to the order of appearance in Eqs. (9.34a&ndash;f). This special structure of
matrix R is then exploited to eliminate the joint angles �1 and �2 in an efficient way.
</p>
<p>Based on the structure of R, two groups of six and eight equations are defined:
</p>
<p>Pux45 D Cx1 (9.37a)
Plx45 D AQx12 (9.37b)
</p>
<p>where C is a 6 � 2 constant matrix that is formed by the nonzero entries in rows
3, 6, 7, 8, 11, and 14 of matrix R. A is, in turn, an 8 � 6 matrix whose entries are
all functions of the data, while x1 and x45 were defined in Eqs. (9.11) and (9.28a),
respectively; Qx12 is, in turn, the six-dimensional vector defined as
</p>
<p>Qx12 �
�
</p>
<p>s1s2 s1c2 c1s2 c1c2 s2 c2
�T
</p>
<p>(9.38)
</p>
<p>Furthermore, Pu comprises the third, sixth, seventh, eighth, 11th and 14th rows of P,
Pl comprising the remaining eight rows. Notice that Pu and Pl are both linear in x3.
</p>
<p>Any two of the six scalar equations in Eq. (9.37a) can now be used to solve for
x1, the resulting expression then being substituted into the remaining four equations
of the same group. This is done by first partitioning the six scalar equations as
</p>
<p>Cux1 D du (9.39a)
Clx1 D dl (9.39b)
</p>
<p>where Cu and Cl are 2 � 2 and 4 � 2 submatrices of C, respectively, with du and dl
being the corresponding two- and four-dimensional vectors that result from Pux45;</p>
<p/>
</div>
<div class="page"><p/>
<p>394 9 Geometry of General Serial Robots
</p>
<p>these two vectors are trilinear in x3; x4 and x5. If Eq. (9.39a) is solved for x1 and
the result is substituted into Eq. (9.39b), we obtain four equations free of �1 and �2,
namely,
</p>
<p>&#128;4x45 � ClC�1u du � dl D 04 ; &#128;4 � ClC�1u .Pu/2 � .Pu/4 (9.40a)
</p>
<p>in which &#128;4 is a 4 � 9 matrix whose entries are linear in x3, while .Pu/2 and .Pu/4
are 2�9 and 4�9 submatrices of matrix Pu, respectively. The above set of equations
is now cast in the form
</p>
<p>D1y3 D 04 (9.40b)
</p>
<p>with D1 defined as a 4 � 3 matrix whose entries are bilinear in x4 and x5, while 04
is the four-dimensional zero vector, and y3 is defined as
</p>
<p>y3 �
�
</p>
<p>c3 s3 1
�T
</p>
<p>(9.41)
</p>
<p>If Cu is chosen with nonzero entries in the third and sixth rows of matrix R, then
we have
</p>
<p>Cu D
�
</p>
<p>�1p ��1q
�1u ��1v
</p>
<p>�
</p>
<p>(9.42a)
</p>
<p>with p; q; u, and v listed in Table 9.1. If Cu is nonsingular, C�1u is readily
obtained as
</p>
<p>C�1u D
1
</p>
<p>�1.uq � pv/
</p>
<p>�
</p>
<p>�v q
�u p
</p>
<p>�
</p>
<p>(9.42b)
</p>
<p>However, if Cu turns out to be singular, then a different pair of Eqs. (9.37a), of the
set associated with rows 3, 6, 7, 8, 11 and 14, should be selected.
</p>
<p>Additional equations free of �1 and �2 can be derived from any six of the
eight equations in Eq. (9.37b). Indeed, these six equations is all that is needed to
solve for Qx12 in terms of �3, �4 and �5; the expressions thus resulting would then
be substituted into the remaining two equations of the same set, to obtain two
additional equations free of �1 and �2. However, this elimination process is not
suitable for symbolic computations. Instead, Raghavan and Roth (1990) derived the
two additional equations in a terser form. This is done by finding two independent
linear combinations of the eight equations (9.37b) that render identically zero all
terms in �1 and �2. The left-hand sides of these equations are given as
</p>
<p>�1.�3; �4; �5/ �
�21
2a1
</p>
<p>Œ.f � f/hx � 2.f � h/f x &#141; �
�21
2a1
</p>
<p>ı1hx C
�21
a1
ı2f x
</p>
<p>��1�1.f � h/x C �1wf y � �1.r � b1/hy (9.43a)</p>
<p/>
</div>
<div class="page"><p/>
<p>9.3 The Univariate-Polynomial Approach 395
</p>
<p>�2.�3; �4; �5/ �
�21
2a1
</p>
<p>Œ.f � f/hy � 2.f � h/f y &#141; � �1�1.f � h/y
</p>
<p>��1wf x C �1.r � b1/hx C
�21
a1
ı2f y �
</p>
<p>�21
2a1
</p>
<p>ı1hy (9.43b)
</p>
<p>while the right-hand sides are
</p>
<p> 1 �
�21
2a1
</p>
<p>Œ.g � g/{x � 2.g � ı/gx &#141; �
�21
2a1
</p>
<p>ı1{x C
�21
a1
ı2gx
</p>
<p>��1�1.g � ı/x C �1wgy � �1.r � b1/{y (9.43c)
</p>
<p> 2 �
�21
2a1
</p>
<p>Œ.g � g/{y � 2.g � ı/gy &#141; � �1�1.g � ı/y
</p>
<p>��1wgx C �1.r � b1/{x C
�21
a1
ı2gy �
</p>
<p>�21
2a1
</p>
<p>ı1{y (9.43d)
</p>
<p>On the other hand, hx , {x , f x and gx represent the first components of vectors h,
ı, f, and g, respectively, the other components being defined likewise. Furthermore,
ı1 and ı2 are defined as
</p>
<p>ı1 � p2 C q2 C .r � b1/2 � a21
ı2 � puC qv C .r � b1/w
</p>
<p>Upon substitution of g and ı, as given by Eqs. (9.33b and d), respectively, into
Eqs. (9.43c and d), and introduction of the definitions given in Table 9.1, it turns
out that both  1 and  2 vanish identically, i.e.,
</p>
<p> 1 D 0 and  2 D 0
</p>
<p>Also note that, in deriving expressions (9.43a and b) and (9.43c and d), we
assume that a1 &curren; 0. However, a1 vanishes in many industrial robots, those having
their first two axes intersecting&mdash;usually at right angles&mdash;the foregoing procedure
thus becoming inapplicable. One way of coping with this case is to go one step
behind Raghavan and Roth&rsquo;s procedure and redefine, for k D 1; 2,
</p>
<p>�k.�3; �4; �5/ � a1�k.�3; �4; �5/I
</p>
<p>and
</p>
<p> k  � a1 k</p>
<p/>
</div>
<div class="page"><p/>
<p>396 9 Geometry of General Serial Robots
</p>
<p>i.e.,
</p>
<p>�1.�3; �4; �5/ �
�21
2
Œ.f � f/hx � 2.f � h/f x &#141; �
</p>
<p>�21
2
ı1hx C �21ı2f x
</p>
<p>�a1�1�1.f � h/x C a1�1wf y � a1�1.r � b1/hy (9.44a)
</p>
<p>�2.�3; �4; �5/ �
�21
2
Œ.f � f/hy � 2.f � h/f y &#141; � a1�1�1.f � h/y � a1�1wf x
</p>
<p>C a1�1.r � b1/hx C �21ı2f y �
�21
2
ı1hy (9.44b)
</p>
<p> 1 �
�21
2
Œ.g � g/{x � 2.g � ı/gx &#141; �
</p>
<p>�21
2
ı1{x C �21ı2gx
</p>
<p>�a1�1�1.g � ı/x C a1�1wgy � a1�1.r � b1/{y (9.45a)
</p>
<p> 2 �
�21
2
Œ.g � g/{y � 2.g � ı/gy &#141; � a1�1�1.g � ı/y
</p>
<p>�a1�1wgx C a1�1.r � b1/{x C �21ı2gy �
�21
2
ı1{y (9.45b)
</p>
<p>Under their new definitions, apparently,  1 and  2 also vanish. Once �1 and �2 are
equated to zero, two equations are obtained that can be cast in the form
</p>
<p>&#128;2x45 D 02 (9.46)
</p>
<p>or equivalently,
</p>
<p>D2y3 D 02 (9.47)
</p>
<p>where 02 is the two-dimensional zero vector, &#128;2 is a 2 � 9 matrix whose entries are
linear in x3, D2 is a 2 � 3 matrix whose entries are bilinear in x4 and x5, and y3 was
introduced in Eq. (9.41).
</p>
<p>The two Eqs. (9.40a) and (9.46) thus involve a total of six scalar equations free
of �1 and �2, and can be combined to yield a system of six equations trilinear in x3,
x4, and x5, namely,
</p>
<p>&dagger;x45 D 06 (9.48a)
</p>
<p>where &dagger; is a 6 � 9 matrix whose entries are linear in x3, and 06 is the six-
dimensional zero vector. Now, the tan-half trigonometric identities relating si and ci
with �i � tan.�i=2/, for i D 4; 5, are substituted into Eq. (9.48a). Upon multiplying
the two sides of the equation thus resulting by .1C �24 /.1C �25 /, Raghavan and Roth
obtained
</p>
<p>&dagger;0x045 D 06 (9.48b)</p>
<p/>
</div>
<div class="page"><p/>
<p>9.3 The Univariate-Polynomial Approach 397
</p>
<p>where &dagger;0 is a 6 � 9 matrix that is linear in x3, while x045 is defined as
</p>
<p>x045 �
�
</p>
<p>�24 �
2
5 �
</p>
<p>2
4 �5 �
</p>
<p>2
4 �4�
</p>
<p>2
5 �4�5 �4 �
</p>
<p>2
5 �5 1
</p>
<p>�T
</p>
<p>If the same trigonometric identities, for i D 3, are now substituted into
Eq. (9.48b), and then the first four scalar equations of this set are multiplied by
.1C �23 / to clear denominators, the equation thus resulting takes the form
</p>
<p>&dagger;00x045 D 06 (9.48c)
</p>
<p>In the above equations, &dagger;00 is a 6 � 9 matrix whose first four rows are quadratic
in �3, while its last two rows are apparently rational functions of �3. However,
as reported by Raghavan and Roth, the determinant of any 6 � 6 submatrix of
&dagger;00 is, in fact, an 8th-degree polynomial in �3 and not a rational function of the
same. Moreover, in order to eliminate �4 and �5, they resort to dialytic elimination
(Salmon 1964), introduced in this book in Sect. 5.4.1 and in Exercise 5.11. Dialytic
elimination is further discussed in Sect. 9.3, in connection with the Li, Woernle, and
Hiller method, and in Sect. 10.2 in connection with parallel manipulators.
</p>
<p>In applying dialytic elimination, the two sides of the system of equations
appearing in Eq. (9.48c) are first multiplied by �4; then, the system of equations
thus obtained is adjoined to the original system, thereby deriving a system of 12
linear homogeneous equations in Qx45, namely,
</p>
<p>SQx45 D 012 (9.48d)
</p>
<p>where 012 is the 12-dimensional zero vector, while the 12-dimensional vector Qx45 is
defined as
</p>
<p>Qx45 � Œ �34 �25 �34 �5 �34 �24 �25 �24 �5 �24
</p>
<p>�4�
2
5 �4�5 �4 �
</p>
<p>2
5 �5 1 &#141;
</p>
<p>T
</p>
<p>(9.48e)
</p>
<p>Furthermore, the 12 � 12 matrix S is defined as
</p>
<p>S �
�
</p>
<p>G
</p>
<p>K
</p>
<p>�
</p>
<p>its 6 � 12 blocks G and K taking on the forms
</p>
<p>G �
�
</p>
<p>&dagger;00 O63
�
</p>
<p>; K �
�
</p>
<p>O63 &dagger;
00�
</p>
<p>with O63 defined as the 6 � 3 zero matrix.</p>
<p/>
</div>
<div class="page"><p/>
<p>398 9 Geometry of General Serial Robots
</p>
<p>Now, in order for Eq. (9.48d) to admit a nontrivial solution, the determinant of
its coefficient matrix must vanish, i.e.,
</p>
<p>det.S/ D 0 (9.49)
</p>
<p>which is the characteristic equation sought. The foregoing determinant turns out to
be a 16th-degree polynomial in �3. Moreover, the roots of this polynomial give the
values of �3 corresponding to the 16 solutions of the IDP. It should be noted that,
using the same procedure, one can also derive this polynomial in terms of either
�4 or �5 if the associated vector in Eq. (9.48d) is written as x35 or x34, respectively.
Consequently, the entries of matrix &dagger; would be linear in either x4 or x5.
</p>
<p>9.3.2 The Li&ndash;Woernle&ndash;Hiller Procedure
</p>
<p>At the outset, the factoring of Qi given in Eq. (4.1c) and the identities first used by
Li (1990), namely, Eqs. (9.15b), are recalled. Additionally, Li defines a matrix Ti as
</p>
<p>Ti �
</p>
<p>2
</p>
<p>4
</p>
<p>��i 1 0
1 �i 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>Hence,
</p>
<p>TiCi � Ui D
</p>
<p>2
</p>
<p>4
</p>
<p>�i 1 0
</p>
<p>1 ��i 0
0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>with Ci defined in Eq. (4.1b). Furthermore, we note that the left-hand sides of the
four vector equations (9.23a, b, e and f) are of the form Q3v, where v is a three-
dimensional vector independent of �3. Upon multiplication of the above-mentioned
equations from the left by matrix T3, Li and co-authors obtained a new set of
equations, namely,
</p>
<p>U3Of D T3g (9.50a)
U3 Or D T3i (9.50b)
</p>
<p>U3.Of � Or/ D T3.g � i/ (9.50c)
</p>
<p>U3
</p>
<p>h
</p>
<p>.f � f/Or � 2.f � h/Of
i
</p>
<p>D T3 Œ.g � g/i � 2.g � i/g&#141; (9.50d)</p>
<p/>
</div>
<div class="page"><p/>
<p>9.3 The Univariate-Polynomial Approach 399
</p>
<p>where Of and Or are defined as
</p>
<p>Of � ƒ3.b3 CQ4b4 CQ4Q5b5/ (9.51)
Or � ƒ3.Q4u5/ (9.52)
</p>
<p>with ƒi defined, in turn, in Eq. (4.1c).
Because of the form of matrices T3 and U3, the third of each of the four vector
</p>
<p>equations (9.50a&ndash;d) is identical to its counterpart appearing in Eqs. (9.34a, b, e
and f). That is, if we denote by either vi or .v/i the i th component of any three-
dimensional vector v, the unchanged equations are
</p>
<p>Of3 D g3 (9.53a)
Or3 D i3 (9.53b)
</p>
<p>.Of � Or/3 D .g � i/3 (9.53c)
</p>
<p>.f � f/ Or3 � 2.f � h/ Of3 D .g � g/i3 � 2.g � i/g3 (9.53d)
</p>
<p>all of which are free of �3. Furthermore, six additional equations linear in �3 will be
derived by multiplying both sides of Eqs. (9.53a&ndash;d) and of (9.23c and d) by �3, i.e.,
</p>
<p>�3 Of3 D �3g3 (9.54a)
�3 Or3 D �3i3 (9.54b)
</p>
<p>�3.Of � Or/3 D �3.g � i/3 (9.54c)
</p>
<p>�3Œ.f � f/ Or3 � 2.f � h/ Of3&#141;3 D �3Œ.g � g/i3 � 2.g � i/g3&#141;3 (9.54d)
�3.f � f/ D �3.g � g/ (9.54e)
�3.f � h/ D �3.g � i/ (9.54f)
</p>
<p>We now have 20 scalar equations that are linear in �3, namely, the 12
Eqs. (9.50a&ndash;d) plus the six equations (9.54a&ndash;f) and the two scalar equations (9.23c
and d). Moreover, the left-hand sides of the foregoing 20 equations are trilinear in
�3, x4, and x5, while their right-hand sides are trilinear in �3, x1, and x2. These 20
equations can thus be written in the form
</p>
<p>Ax D ˇ (9.55a)
</p>
<p>where the 20� 16 matrix A is a function of the data only, while the 20-dimensional
vector ˇ is trilinear in �3, x1, and x2, the 16-dimensional vector x being defined, in
turn, as
</p>
<p>x � Œ�3c4c5 �3c4s5 �3s4c5 �3s4s5 �3c4 �3s4 �3c5 �3s5
c4c5 c4s5 s4c5 s4s5 c4 s4 c5 s5&#141;
</p>
<p>T (9.55b)</p>
<p/>
</div>
<div class="page"><p/>
<p>400 9 Geometry of General Serial Robots
</p>
<p>Next, matrix A and vector ˇ are partitioned as
</p>
<p>A �
�
</p>
<p>AU
</p>
<p>AL
</p>
<p>�
</p>
<p>; ˇ �
�
</p>
<p>ˇU
ˇL
</p>
<p>�
</p>
<p>(9.56)
</p>
<p>where AU is a nonsingular 16 � 16 matrix, AL is a 4 � 16 matrix, vector ˇU
is 16-dimensional, and vector ˇL is 4-dimensional. Moreover, the two foregoing
matrices are functions of the data only. Thus, we can solve for x from the first 16
equations of Eq. (9.55a) in the form
</p>
<p>x D A�1U ˇU
</p>
<p>Upon substituting the foregoing value of x into the four remaining equations of
Eq. (9.55a), we derive four equations free of x, namely,
</p>
<p>ALA
�1
U ˇU D ˇL (9.57)
</p>
<p>In Eq. (9.57) the two matrices involved are functions of the data only, while the
two vectors are trilinear in �3, x1, and x2. These equations are now cast in the form
</p>
<p>.Aic2 C Bi s2 C Ci /�3 CDic2 CEis2 C Fi D 0; i D 1; 2; 3; 4 (9.58a)
</p>
<p>where all coefficients Ai ; : : : ; Fi are linear in x1. Next, Li and co-authors substitute
c2 and s2 in the foregoing equations by their equivalents in terms of �2 � tan.�2=2/,
thereby obtaining, for i D 1; 2; 3; 4,
</p>
<p>Ci i�
2
2 �3 C 2Bi�2�3 C Ai i�3 C Fi i�22 C 2Ei�2 CDi i D 0 (9.58b)
</p>
<p>with the definitions
</p>
<p>Ai i � Ai C Ci (9.58c)
Ci i � Ci � Ai (9.58d)
Di i � Di C Fi (9.58e)
Fi i � Fi �Di (9.58f)
</p>
<p>Further, �2 and �3 are both eliminated dialytically from the four equations (9.58a).
To this end, both sides of all four equations (9.58b) are multiplied by �2, which
yields
</p>
<p>Ci i�
3
2 �3 C 2Bi�22 �3 C Ai i�2�3 C Fi i�32 C 2Ei�22 CDi i�2 D 0 (9.58g)
</p>
<p>We have now eight equations that are linear homogeneous in the eight-
dimensional nonzero vector z defined as
</p>
<p>z �
�
</p>
<p>�32 �3 �
2
2 �3 �
</p>
<p>3
2 �2�3 �
</p>
<p>2
2 �3 �2 1
</p>
<p>�T
(9.58h)</p>
<p/>
</div>
<div class="page"><p/>
<p>9.4 The Bivariate-Equation Approach 401
</p>
<p>and hence, the foregoing eight-dimensional system of equations takes the form
</p>
<p>Mz D 0 (9.59)
</p>
<p>where the 8 � 8 matrix M is simply
</p>
<p>M �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>0 C11 0 2B1 F11 A11 2E1 D11
0 C22 0 2B2 F22 A22 2E2 D22
0 C33 0 2B3 F33 A33 2E3 D33
0 C44 0 2B4 F44 A44 2E4 D44
C11 2B1 F11 A11 2E1 0 D11 0
</p>
<p>C22 2B2 F22 A22 2E2 0 D22 0
</p>
<p>C33 2B3 F33 A33 2E3 0 D33 0
</p>
<p>C44 2B4 F44 A44 2E4 0 D44 0
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>Now, since z is necessarily nonzero, Eq. (9.59) should admit nontrivial solutions,
and hence, matrix M should be singular, which leads to the condition below:
</p>
<p>det.M/ D 0 (9.60)
</p>
<p>Thus, considering that all entries of M are linear in x1, det.M/ is octic in x1, and
hence, Eq. (9.60) is equally octic in x1. By virtue of Fact 9.2.2, then, Eq. (9.60) is of
16th degree in �1; this equation takes the form
</p>
<p>16
X
</p>
<p>0
</p>
<p>ak�
k
1 D 0 (9.61)
</p>
<p>which is the characteristic equation sought, its roots providing up to 16 real values
of �1 for the IDP at hand.
</p>
<p>9.4 The Bivariate-Equation Approach
</p>
<p>The difference between this approach and those leading to the univariate polyno-
mial, as outlined in Sect. 9.3, lies in three aspects: (a) only four, out of the six
original unknowns, are eliminated; (b) the tan-half identities are avoided, in order to
avoid polynomial deflation at or around values of � , and to allow for finding all real
roots; and (c) direct polynomial-root finding is avoided, rough estimates of all roots
being found, first, by inspection, then refined by means of a Newton procedure.
</p>
<p>Now, to derive the bivariate equations, we have to eliminate three of the five
unknowns from the 14 fundamental closure equations. To this end, we resort
to Eqs. (9.40b), which are trilinear in fxig53. Furthermore, from definition (9.41),</p>
<p/>
</div>
<div class="page"><p/>
<p>402 9 Geometry of General Serial Robots
</p>
<p>y3 &curren; 0, and hence, the 4 � 3 matrix D1 of Eq. (9.40b) must be rank-deficient,
which means that every one of its four&mdash;the number of combinations of four objects
taking three at a time&mdash;3 � 3 determinants, obtained by deleting one of its four
rows, should vanish. We need, in principle, only two of these determinants to obtain
two independent equations in �4 and �5. To be on the safe side regarding spurious
roots and formulation singularities,5 we impose the vanishing of all four possible
determinants, which yields, correspondingly, four contours in the �4&ndash;�5 plane; the
intersections of all contours then yield the real .�4; �5/ pairs of values which render
D1 rank-deficient. Each of the four equations thus derived describes a contour Ci ,
for i D 1; 2; 3; 4, in the �4&ndash;�5 plane:
</p>
<p>Ci W Fi .�4; �5/ D 0; i D 1; 2; 3; 4: (9.62)
</p>
<p>Note that, by plotting the four contours in a square of the �4&ndash;�5 plane, of side 2� ,
we ensure that no real solutions will be missed.
</p>
<p>The intersection points can be detected visually by the user or, automatically,
by a suitable graphical user interface (GUI).6 Regardless of the detection method,
numerical code can be employed to refine each pair .�4; �5/ of intersection
coordinates to the desired accuracy. The well-known Newton&ndash;Raphson method
for nonlinear-equation solving, outlined in Sect. B.3, can be used here. However,
this method works for solving systems of as many equations as unknowns. In our
case, we end up with four nonlinear equations in only two unknowns. While, in
principle, any two of those four equations can be used to solve for the two unknowns,
numerical roundoff error and the numerical conditioning of the problem at hand,
to be discussed in Sect. 9.4.1, will invariably lead to different numerical solutions
for different choices of those two equations. The question then is which of the
four distinct solutions to pick up. In order to avoid this quandary, we suggest here
to regard all four equations as independent, entailing possible contradictions&mdash;
roundoff errors may render the four equations independent, which they aren&rsquo;t.
With this approach, then, rather than one solution to the four equations, what
we seek is their least-square approximation, which can be done using a method
known as Newton&ndash;Gauss (Dahlquist and Bj&ouml;rck 1974), as outlined in Sect. B.4.
Alternatively, Matlab&rsquo;s function lsqnonlin can be used to find the same least-
square approximation. In any event, the problem is solved iteratively. Within the
Newton&ndash;Gauss method, a linear overdetermined system of equations is solved at
each iteration, using one of the methods of Sect. B.1.
</p>
<p>5Formulation singularities occur when, in the absence of a kinematic singularity&mdash;characterized
by the vanishing of det.J/, for J defined as in Eq. (5.10b)&mdash;two or three contours Ci are tangent at
an intersection. When this is the case, and a pair of functions (9.62) is chosen to find their roots,
whose contours are tangent, the numerical computation of the coordinates of the intersection point
becomes impossible.
6The intersection points appearing in Figs. 9.3 and 9.4 were obtained using the Matlab GUI
developed by Dr. Stephane Caro, a postdoctoral fellow at McGill University&rsquo;s Robotic Mechanical
Systems Laboratory. The GUI is available in the CD accompanying this edition</p>
<p/>
</div>
<div class="page"><p/>
<p>9.4 The Bivariate-Equation Approach 403
</p>
<p>In this way, two of the unknown joint angles, �4 and �5, are computed accurately,
the remaining four unknowns being determined uniquely, as described in Sect. 9.6.
Notice, however, that spurious solutions to the IDP are likely to occur. These
are intersections of the four contours which, although verifying the four equa-
tions (9.62), fail to produce a full set of solutions f �i g61. The computation of all
remaining joint variables, �1, �2, �3 and �6, once �4 and �5 are available, is the
subject of Sect. 9.6.3.
</p>
<p>9.4.1 Numerical Conditioning of the Solutions
</p>
<p>We recall here the concept of condition number of a square matrix (Golub and Van
Loan 1989), as introduced in Sect. 5.8. In this subsection we stress the relevance
of the concept in connection with the accuracy of the computed solutions of the
general IDP.
</p>
<p>The concept of condition number of a square matrix is of the utmost importance
because it measures the roundoff-error amplification upon solving a system of linear
equations having that matrix as coefficient. The condition number of a matrix,
discussed in Sect. 5.8, can be computed in many possible ways. For the purpose
at hand, it will prove convenient to work with the condition number defined in terms
of the Frobenius norm, as given in Eqs. (5.80a and b).
</p>
<p>In the context of the bivariate-equation approach, we can intuitively argue that
the accuracy in the computation of a solution is dictated by the angle at which two
contours giving a solution intersect. Thus, the solutions computed most accurately
are those determined by contours intersecting at right angles. On the contrary, the
solutions computed least accurately are those obtained by tangent contours. We shall
formalize this observation in the discussion below.
</p>
<p>We distinguish between the condition number of a matrix and the conditioning of
a solution of a nonlinear system of equations. We define the latter as the condition
number of the Jacobian matrix of the system, evaluated at that particular solution.
More concretely, let
</p>
<p>f1.x1; x2/ D 0
f2.x1; x2/ D 0
</p>
<p>be a system of two nonlinear equations in the two unknowns x1 and x2. Moreover,
the Jacobian matrix of this system is defined as
</p>
<p>F �
�
</p>
<p>.rf1/T
</p>
<p>.rf2/T
�
</p>
<p>(9.63)
</p>
<p>where rfk denotes the gradient of function fk.x1; x2/, defined in turn as
</p>
<p>rfk �
�
</p>
<p>@fk=@x1
@fk=@x2
</p>
<p>�
</p>
<p>(9.64)</p>
<p/>
</div>
<div class="page"><p/>
<p>404 9 Geometry of General Serial Robots
</p>
<p>It is to be noted that multiplying each of the two given equations by a scalar
other than zero does not affect its solutions, each Jacobian row being, then,
correspondingly multiplied by the same scaling factor. To ease matters, we will
assume henceforth that each of the above equations has been properly scaled so
as to render its gradient a unit vector in the plane of the two unknowns. In order
to calculate the condition number of F, which determines the conditioning of the
solutions, we calculate first FFT and its inverse, namely,
</p>
<p>FFT D
�
</p>
<p>1 rf1 � rf2
rf1 � rf2 1
</p>
<p>�
</p>
<p>�
�
</p>
<p>1 cos &#13;
cos &#13; 1
</p>
<p>�
</p>
<p>and
</p>
<p>�
</p>
<p>FFT
&#13;�1 D 1
</p>
<p>sin2 &#13;
</p>
<p>�
</p>
<p>1 � cos &#13;
� cos &#13; 1
</p>
<p>�
</p>
<p>where &#13; is the angle at which the contours intersect. The condition number �F of F,
based on the Frobenius norm, can then be computed as
</p>
<p>�F D
1
</p>
<p>j sin &#13; j � � � &#13; � � (9.65)
</p>
<p>which means that for the best possible solutions from the numerical conditioning
viewpoint, the two contours cross each other at right angles, whereas at singular
configurations, the contours are tangent to each other. The reader may have
experienced that, when solving a system of two linear equations in two unknowns
with the aid of drafting instruments,7 the solution becomes fuzzier as the two lines
representing those equations become closer to parallel.
</p>
<p>9.5 Implementation of the Solution Method
</p>
<p>Whatever method is chosen to solve the IDP, the solution procedure will eventually
require numerical computations. Indeed, both the univariate-polynomial and the
bivariate-equation approaches ultimately resort to a numerical procedure to find
either the roots of a polynomial equation that can be of up to 16th degree
or, correspondingly, the solutions of a system of trigonometric equations. Now,
formulas for the roots of polynomial equations are available only for the quadratic,
the cubic and the quartic polynomials8; those for the cubic and quartic equations are
</p>
<p>7Graphical methods of mechanism analysis rely on this form of linear-equation solving.
8The Italian mathematicians Niccol&ograve; Tartaglia&mdash;meaning the &ldquo;stammerer,&rdquo; his real name believed
to have been Fontana&mdash;(1535) and Girolamo Cardano (1545), independently, or so each claimed,
found the formula for the three roots of the cubic equation, now known as Cardan&rsquo;s formula.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.5 Implementation of the Solution Method 405
</p>
<p>so cumbersome that in practice they are seldom applied. The Italian mathematician
Ruffini gave a sketch of a proof in 1799 showing that formulas for the roots of
polynomials of fifth or higher degree are not possible in general (Wells 1986). Then,
the Norwegian mathematician Abel, in 1826, provided a more rigorous proof of
the same result. It was the genius of the French Evariste Galois (1811&ndash;1832) that,
aided by Galois&rsquo; own theory of groups (Livio 2005), led to an elegant theory on the
solvability of polynomial equations that closed an important chapter in the history
of mathematics.
</p>
<p>Now, when numerically solving the equations involved, whether polynomial or
trigonometric, intermediate computations can yield coefficients with absolute values
of disparate orders of magnitude, which is prone to numerical instabilities&mdash;ill-
conditioning. These occur naturally in the neighborhood of singularities, and cannot
be avoided. Another source of ill-conditioning lies in the data themselves. When
working with two different sets of equations, one representing point displacements,
the other angular displacements, we end up with a mixture of equations with
physical units of length and equations that are dimensionless. Such a mixture is
a source of ill-conditioning, which can be avoided without too much effort: we
recommend to start by rendering the point-displacement equations dimensionless,
which can be done by dividing the DH parameters f ai ; bi g61 introduced in Sect. 4.2
and the position vector p of the EE operation point by the characteristic length L
introduced in Sect. 5.8. This stage, which can be termed normalization, is done in
the numerical examples included in Sect. 9.7.
</p>
<p>Furthermore, when refining the rough estimates of the contour intersections,
as occurring in the implementation of the bivariate-equation approach, we are
confronted with computing the least-square approximation to an overdetermined
system of nonlinear equations. This is a well-researched problem in the realm of
numerical analysis (Dahlquist and Bj&ouml;rck 1974). While effective methods exist that
solve the problem without resorting to gradients, we have used in the solutions
an in-house developed package of C routines and Matlab functions, ODA, for a
broad class of problems occurring in mathematical programming.9 In this library, we
have a routine, LSSNLS, that implements the Newton&ndash;Gauss algorithm described
in Sect. B.4. LSSNLS requires an initial guess x0 for the unknown vector x as well
as information on the dimensions n of x, the number of unknowns, and of f.x/, the
number of equations, m &gt; n. Then, LSSNLS returns an optimum value x� that best
approximates the overdetermined system of equations f.x/ D 0 in the least-square
sense, and that is dependent on x0. In the absence of ill-conditioning, x� is the local
optimum of the problem closest to the initial guess x0. However, the Matlab GUI that
was developed by Dr. Caro&mdash;see footnote 6&mdash;to automate the refining of the visual
</p>
<p>Ferrari&rsquo;s formula&mdash;so named after the Italian mathematician Ludovico Ferrari, a disciple of
Cardano&rsquo;s&mdash;provides the four roots of a quartic polynomial.
9The ODA library is available on www.mcgill.ca/~/rmsl/Angeles_html/courses/MECH577/.</p>
<p/>
<div class="annotation"><a href="www.mcgill.ca/~/rmsl/Angeles_html/courses/MECH577/">www.mcgill.ca/~/rmsl/Angeles_html/courses/MECH577/</a></div>
</div>
<div class="page"><p/>
<p>406 9 Geometry of General Serial Robots
</p>
<p>estimates relies on Matlab&rsquo;s lsqnonlin function. The method implemented in this
function is direct, in that it is based solely on function evaluations, thus obviating
gradient computations.
</p>
<p>9.6 Computation of the Remaining Joint Angles
</p>
<p>So far we have reduced the system of displacement equations to either one single
univariate polynomial in the tangent of half one of the joint angles&mdash;the univariate-
polynomial approach&mdash;or a system of bivariate trigonometric equations in the sines
and cosines of two joint angles&mdash;the bivariate-equation approach. In either case, we
still need a procedure to compute the remaining joint angles, which is the subject of
the balance of this section.
</p>
<p>9.6.1 The Raghavan&ndash;Roth Procedure
</p>
<p>The most straightforward means of computing �4 and �5 in this procedure is
Eq. (9.48d), which can be interpreted as an eigenvalue problem associated with
the 12 � 12 matrix S, and has one known eigenvalue, namely, 0, for its sole
variable, �3, was computed so as to render S singular. Now, every scientific package
offers eigenvalue calculations, whereby the eigenvectors are usually produced in
a normalized form, i.e., with all eigenvectors computed as unit vectors. Let, for
example, � be the 12-dimensional eigenvector of S corresponding to the zero
eigenvalue. In this case, k�k D 1, but Qx45, the solution sought, is obviously of
magnitude greater than unity, for its 12th component, �12, is exactly 1, according
to its definition, Eq. (9.48e). In order to produce Qx45 from � , then, all we need
is a suitable scaling of this vector that will yield .Qx45/12 D 1. We thus have that
�12 &curren; 0&mdash;otherwise, Eqs. (9.48d) would be inconsistent&mdash;and hence,
</p>
<p>Qx45 D
1
</p>
<p>�12
�
</p>
<p>The outcome will be a set of unique values of �4 and �5 for each of the 16 possible
values of �3.
</p>
<p>Next, �1 and �2 are computed from Eq. (9.35), which is rewritten below in a more
suitable form:
</p>
<p>Rx12 D x345 (9.66a)
</p>
<p>with the 14-dimensional vector x345 defined as
</p>
<p>x345 � Px45 (9.66b)</p>
<p/>
</div>
<div class="page"><p/>
<p>9.6 Computation of the Remaining Joint Angles 407
</p>
<p>Since R is a 14 � 8 matrix, Eq. (9.66a) comprises 14 linear equations in the
eight unknown components of x12. Although any eight of the 14 equations (9.66a)
suffice, in principle, to determine x12, we should not forget that these computations
will most likely be performed with finite precision, and hence, roundoff-error
amplification is bound to occur. In order to keep roundoff errors as low as possible,
we recommend to use all the foregoing 14 equations and calculate x12 as the least-
square approximation of the overdetermined system (9.66a). This approximation
will be, in fact, the solution of the given system because all 14 equations are
compatible. The least-square solution of this system yields, symbolically,
</p>
<p>x12 D .R
T
</p>
<p>R/�1R
T
</p>
<p>x345 (9.66c)
</p>
<p>In practice, the foregoing least-square approximation is computed using an orthog-
onalization procedure (Golub and Van Loan 1989), the explicit or the numerical
inversion of the product HTH being advised against because of its frequent
ill-conditioning. Appendix B outlines the robust numerical computation of the
least-square approximation of an overdetermined system of equations using orthog-
onalization procedures. The only remaining unknown is �6, which is computed
below: This unknown is readily computed from Eq. (4.9a). Indeed, the first of the
three vector equations represented by this matrix equation yields
</p>
<p>Q1Q2Q3Q4Q5p6 D q (9.67a)
</p>
<p>where q denotes the first column of Q, while, according to Eq. (9.5), p6 denotes the
first column of matrix Q6, i.e.,
</p>
<p>p6 �
</p>
<p>2
</p>
<p>4
</p>
<p>cos �6
sin �6
0
</p>
<p>3
</p>
<p>5 ; q �
</p>
<p>2
</p>
<p>4
</p>
<p>q11
q21
q31
</p>
<p>3
</p>
<p>5 (9.67b)
</p>
<p>Thus, Eq. (9.67a) can be readily solved for p6, i.e.,
</p>
<p>p6 D QT5 QT4 QT3 QT2 QT1 q (9.68)
</p>
<p>thereby obtaining a unique value for �6 for every set of values of f �k g51. This
completes the solution of the IDP under study.
</p>
<p>9.6.2 The Li&ndash;Woernle&ndash;Hiller Procedure
</p>
<p>Once �1 is available, the remaining angles are computed from linear equations:
Equations (9.59) are first rearranged in nonhomogeneous form, namely,
</p>
<p>Nz0 D n (9.69)</p>
<p/>
</div>
<div class="page"><p/>
<p>408 9 Geometry of General Serial Robots
</p>
<p>with the 8 � 7 matrix N and the seven- and eight-dimensional vectors z0 and n
defined as
</p>
<p>N �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>0 C11 0 2B1 F11 A11 2E1
0 C22 0 2B2 F22 A22 2E2
0 C33 0 2B3 F33 A33 2E3
0 C44 0 2B4 F44 A44 2E4
C11 2B1 F11 A11 2E1 0 D11
C22 2B2 F22 A22 2E2 0 D22
C33 2B3 F33 A33 2E3 0 D33
C44 2B4 F44 A44 2E4 0 D44
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>and
</p>
<p>z0 � �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
4
</p>
<p>�32 �3
�22 �3
�32
�2�3
�22
�3
�2
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
5
</p>
<p>; n �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>D11
D22
D33
D44
0
</p>
<p>0
</p>
<p>0
</p>
<p>0
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>Now, Eq. (9.69) represents an overdetermined linear algebraic system of eight
equations, but only seven unknowns. Again, we recommend here a least-square
approach to cope with ill-conditioning. In this way, the solution of Eq. (9.69) can
be expressed symbolically in the form
</p>
<p>z0 D .NTN/�1NT n
</p>
<p>With z0 known, both �2 and �3, and hence, �2 and �3, are known uniquely. Further,
with �1, �2, and �3 known, the right-hand side of Eq. (9.55a), ˇ, is known. Since the
coefficient matrix A of that equation is independent of the joint angles, A is known,
and that equation can be solved for vector x uniquely. Once x is known, the two
angles �4 and �5 are uniquely determined, with �6 the sole remaining unknown;
this can be readily determined, also uniquely, as discussed in connection with the
Raghavan&ndash;Roth method.
</p>
<p>9.6.3 The Bivariate-Equation Approach
</p>
<p>After all common intersections of the four foregoing contours have been determined,
we have already two of the unknowns, �4 and �5, the remaining four unknowns being</p>
<p/>
</div>
<div class="page"><p/>
<p>9.6 Computation of the Remaining Joint Angles 409
</p>
<p>calculated uniquely as described presently. First, we calculate one of the remaining
joint variables, �3, using Eq. (9.40b). For this purpose, we evaluate matrix D1 for all
intersection points. Then, we rewrite the same equation in the form
</p>
<p>Hx3 D � (9.70a)
</p>
<p>the 4 � 2 matrix H being obtained from D1 by excluding its last column, which
is denoted by ��. Moreover, matrix H and the four-dimensional vector � are both
bilinear in x4 and x5 and hence, known. Again, we use all four equations (9.70a)
at our disposal to compute the two-dimensional vector x3 using a least-square
approach. If H is of full rank&mdash;its two columns are linearly independent&mdash;then the
solution can be expressed symbolically in the form
</p>
<p>x3 D .HTH/�1HT � (9.70b)
</p>
<p>However, if H is rank-deficient, i.e., if its two columns are linearly dependent, then
the inverse appearing in Eq. (9.70b) cannot be computed, the solution .�4; �5/ being
spurious. In fact, even if H is of full rank, the computed x3 may fail to be a unit
vector, as required by its definition. The outcome here is that
</p>
<p>cos2 �3 C sin2 �3 &curren; 1
</p>
<p>which means that the value of x3 computed from Eq. (9.70a) will yield a complex
value of �3. In this case, the intersection .�4; �5/ at stake is spurious as well.
</p>
<p>When H is of full rank and the computed x3 is of unit Euclidean norm, Eq. (9.70b)
determines �3 uniquely for the given values of �4 and �5.
</p>
<p>With �3, �4 and �5 known, we can now calculate �1 and �2 simultaneously from
Eq. (9.27), which we reproduce below in a more suitable form
</p>
<p>Rx12 D x345 (9.71)
</p>
<p>where R is a 14�8matrix depending only on the problem data, while x345, defined as
</p>
<p>x345 � Px45 (9.72)
</p>
<p>is a 14-dimensional vector trilinear in x3, x4, and x5, and is hence, known. Moreover,
matrices P and R as well as vectors x12 and x45 were defined in Eqs. (9.27)
and (9.28a and b). Again, we have an overdetermined system, of 14 equations,
in eight unknowns this time, which can best be solved for x12 using a least-
square approach with an orthogonalization procedure. The unique solution of the
overdetermined system at hand can thus be expressed as
</p>
<p>x12 D .RTR/�1RT x345 (9.73)
</p>
<p>Note that the solution thus obtained determines x1 and x2 uniquely, the only
remaining unknown being �6, which is computed as in Eq. (9.68).</p>
<p/>
</div>
<div class="page"><p/>
<p>410 9 Geometry of General Serial Robots
</p>
<p>9.7 Examples
</p>
<p>We solve the examples below using the bivariate-equation approach with the
purpose of both helping the reader visualize the real solutions and avoiding the
formulation singularities brought about by the tan-half identities.10
</p>
<p>Example 9.7.1. Find all inverse-displacement solutions of the Fanuc Arc Mate S
series manipulator of 1990 for the end-effector pose given below:
</p>
<p>Q D
</p>
<p>2
</p>
<p>4
</p>
<p>0 1 0
</p>
<p>0 0 1
</p>
<p>1 0 0
</p>
<p>3
</p>
<p>5 ; p D
</p>
<p>2
</p>
<p>4
</p>
<p>130
</p>
<p>850
</p>
<p>1540
</p>
<p>3
</p>
<p>5
</p>
<p>in which p is given in mm, the DH parameters of the robot being given in Table 5.2.
</p>
<p>Solution: For starters, we divide the DH parameters fai ; big61 and vector p by
L D 351:23mm, the characteristic length of this manipulator found in Sect. 5.8.
In following the bivariate-equation approach, we plot the four contours in the �4&ndash;�5
plane guaranteeing that matrix D1 of Eq. (9.40b) is rank-deficient. The four contours
are superimposed in Fig. 9.3, where, apparently, we can detect eight intersections.
</p>
<p>1
</p>
<p>2
</p>
<p>34
</p>
<p>5
</p>
<p>6
</p>
<p>7
8
</p>
<p>-3 -2 -1 0 1 2 3
</p>
<p>-3
</p>
<p>-2
</p>
<p>-1
</p>
<p>0
</p>
<p>1
</p>
<p>2
</p>
<p>3
</p>
<p>C1
</p>
<p>C2
</p>
<p>C3
</p>
<p>C4
</p>
<p>Fig. 9.3 Contours C1, C2, C3, and C4 for the Fanuc Arc Mate S series manipulator of 1990
</p>
<p>10The accompanying CD includes a GUI allowing the user to automate the computation of accurate
values of the joint variables by clicking at the visual estimates of the intersections of all four
contours.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.7 Examples 411
</p>
<p>Table 9.2 Rough estimates of the coordinates of the intersection points of the Fanuc
Arc Mate S series manipulator of 1990
</p>
<p>Sol&rsquo;n no.
</p>
<p>1 2 3 4 5 6 7 8
</p>
<p>�4 (rad) 2.38 1.57 0.34 �1:57 �3:06 �2:39 �1:57 1.57
�5(rad) �2:97 �1:57 �1:79 �1:57 1.75 2.97 1.57 1.57
</p>
<p>Table 9.3 Refined estimates
of the coordinates of the eight
intersection points of Fig. 9.3
</p>
<p>Inters&rsquo;n no. �4 (rad) �5 (rad)
</p>
<p>1 2:381637539 �2:973100582
2 1:570796327 �1:570796327
3 0:344592933 �1:797513978
4 �1:570796327 �1:570796327
5 �3:060229795 1:755742649
6 �2:397512950 2:972311705
7 �1:570796327 1:570796327
8 1:570796327 1:570796327
</p>
<p>Table 9.4 Legitimate solutions of the inverse displacement of the
Fanuc Arc Mate S series manipulator of 1990 at the given pose
</p>
<p>Sol&rsquo;n no. 1 3 5 6
</p>
<p>�4 136:457
ı 19:743ı �175:338ı �137:367ı
</p>
<p>�5 �170:346ı �102:989ı 100:596ı 170:300ı
</p>
<p>The coordinates .�4; �5/ of each intersection point are first estimated by inspection,
as listed in Table 9.2. Further, we submit each of these eight values as an initial guess
to the Newton&ndash;Gauss procedure&mdash;or Matlab&rsquo;s function lsqnonlin&mdash;to find the
least-square approximation of the overdetermined system of four equations in two
unknowns of Eq. (9.62). The eight solutions thus found are then used to compute x3
of Eq. (9.70a). As it turned out, solutions 2, 4, 7 and 8 led to a rank-deficient H, and
were, thus, discarded as spurious. For the record, we include all eight least-square
solutions found in radians, in Table 9.3.
</p>
<p>The legitimate solutions are displayed in Table 9.4, in degrees for easier
visualization. The robot thus admits four real inverse displacement solutions at the
given pose.
</p>
<p>The values of the remaining angles are recorded in Table 9.5.
</p>
<p>Example 9.7.2. Here we include an example of a manipulator admitting 16 real
inverse displacement solutions. This manipulator was proposed by Li (1990), its
Denavit&ndash;Hartenberg parameters appearing in Table 9.6.
</p>
<p>Solution: The foregoing procedure was applied to this manipulator for an end-
effector pose given as</p>
<p/>
</div>
<div class="page"><p/>
<p>412 9 Geometry of General Serial Robots
</p>
<p>Table 9.5 Remaining angles
corresponding to the
solutions of Table 9.4
</p>
<p>Sol&rsquo;n no. �1 �2 �3 �6
1 83:366ı 90:974ı �8:004ı 43:134ı
3 70:781ı 15:151ı 151:077ı 175:387ı
</p>
<p>5 85:417ı 16:156ı 153:212ı �0:859ı
6 83:447ı 87:898ı 9:268ı �42:221ı
</p>
<p>Table 9.6 DH parameters of
Li&rsquo;s manipulator
</p>
<p>i ai (m) bi (m) ˛i �i
1 0:12 0 �57ı �1
2 1:76 0:89 35ı �2
3 0:07 0:25 95ı �3
4 0:88 �0:43 79ı �4
5 0:39 0:50 �75ı �5
6 0:93 �1:34 �90ı �6
</p>
<p>&minus;3 &minus;2 &minus;1 0 1 2 3
</p>
<p>&minus;3
</p>
<p>&minus;2
</p>
<p>&minus;1
</p>
<p>0
</p>
<p>1
</p>
<p>2
</p>
<p>3
</p>
<p>12
</p>
<p>3
</p>
<p>4
</p>
<p>5
</p>
<p>6
</p>
<p>7 8
</p>
<p>9
</p>
<p>10
</p>
<p>11
</p>
<p>12
</p>
<p>13
</p>
<p>14
</p>
<p>15
</p>
<p>16
</p>
<p>17
</p>
<p>18
</p>
<p>C1
</p>
<p>C2
</p>
<p>C3
</p>
<p>C4
</p>
<p>Fig. 9.4 Contours C1, C2, C3,
and C4 for the Li manipulator
</p>
<p>Q D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:357279 �0:850000 0:387106
0:915644 �0:237000 0:324694
�0:184246 0:470458 0:862973
</p>
<p>3
</p>
<p>5 ; p D
</p>
<p>2
</p>
<p>4
</p>
<p>0:798811
</p>
<p>�0:000331
1:200658
</p>
<p>3
</p>
<p>5
</p>
<p>where p is given in meters. Again, we start by dividing fai ; big61 and vector p by the
characteristic length L, that was found to be L D 890:1mm.
</p>
<p>The four contours obtained with the bivariate-equation approach are superim-
posed in Fig. 9.4, where, apparently, we can detect 18 intersections. This means that
at least two are spurious, for the number of inverse-displacement solutions can be, at
most, 16. In this figure, intersections 12 and 13 appear as one single point. A zoom-
in revealed two neighboring solutions in a region around the said single point.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.7 Examples 413
</p>
<p>Table 9.7 Rough estimates of the coordinates of the intersection points of Li&rsquo;s manipulator
</p>
<p>Sol&rsquo;n no. 1 2 3 4 5 6 7 8 9
</p>
<p>�4 (rad) �0:56 �1:88 �2:09 �2:59 �3:07 �1:62 �0:72 2:09 2:75
�5 (rad) �3:01 �2:71 �2:54 �2:25 0:21 1:75 2:86 3:08 2:5
Sol&rsquo;n no. 10 11 12 13 14 15 16 17 18
</p>
<p>�4 (rad) 2:54 2:36 0:08 0:11 �1:22 �2:16 �0:36 1:17 0:44
�5 (rad) 2:37 �0:89 �2:23 �2:25 �2:51 �0:50 �0:70 �0:18 �0:12
</p>
<p>Table 9.8 Refined estimates, to 14 digits, of the coordinates of the 18
intersection points of Fig. 9.4
</p>
<p>Inters&rsquo;n no. �4 (rad) �5 (rad)
</p>
<p>1 �0:5656865073441 �3:0127341939867
2 �1:8817916819320 �2:7181441928227
3 �2:0982054358488 �2:5458222487325
4 �2:5943879129109 �2:2563308501840
5 �3:0760703821644 0:2173802902678
6 �1:6227073591253 1:7564609766664
7 �0:7268312801527 2:8637219341062
8 2:0991093946626 3:0822214487834
9 2:7591234998160 2:5875200635823
10 2:5458806726888 2:3797734576690
11 2:3681644908739 �0:8961886662259
12 0:0834264321499 �2:2306893314165
13 0:1144843294210 �2:2536422392721
14 �1:2262527241259 �2:5145351139614
15 �2:1620940322382 �0:5098897084087
16 �0:3665297041826 �0:7057880105554
17 1:1793192137176 �0:1889758121252
18 0:4440232934648 �0:1282084013846
</p>
<p>The coordinates .�4; �5/ of each intersection point are first estimated by inspection,
as listed in Table 9.7. Further, we submit each of these 18 values as the initial guess
for the Newton&ndash;Gauss procedure&mdash;or Matlab&rsquo;s function lsqnonlin&mdash;to find the
least-square approximation of the overdetermined system of four equations in two
unknowns of Eqs. (9.62). We used ODA to compute the least-square approximation
sought, and verified the result with lsqnonlin. For the record, we include all
18 solutions found, with 14 digits, in radians, in Table 9.8. The 18 solutions thus
found were then used to compute x3 of Eq. (9.70a). As it turned out, solutions 6
and 14 led to values of Eucledian norm of vector x3 greater than unity, and were,
thus, discarded as spurious. The robot thus admits 16 real inverse displacement
solutions at the given pose. The legitimate solutions are displayed in Table 9.9, the
values of the remaining angles being displayed in Table 9.10, in degrees for easier
visualization.</p>
<p/>
</div>
<div class="page"><p/>
<p>414 9 Geometry of General Serial Robots
</p>
<p>Table 9.9 Legitimate solutions of the inverse displacement of Li&rsquo;s manipulator at the given pose
</p>
<p>Sol&rsquo;n no. �4 �5 Sol&rsquo;n no. �4 �5
1 �107:81ı �155:73ı 9 �21:00ı �40:43ı
2 120:25ı 176:59ı 10 6:55ı �129:12ı
3 4:77ı �127:80ı 11 135:68ı 135:68ı
4 158:09ı 148:26ı 12 25:44ı �7:34ı
5 �4:16ı 164:07ı 13 �176:07ı 11:57ı
6 �120:21ı �145:86ı 14 67:57ı �10:82ı
7 �32:41ı �172:61ı 15 �123:87ı �29:21ı
8 145:86ı 136:35ı 16 �148:64ı �148:64ı
</p>
<p>Table 9.10 Remaining angles corresponding to the solutions of Table 9.9
</p>
<p>Sol&rsquo;n no. �1 �2 �3 �6
1 174:083ı �163:302ı �164:791ı 141:281ı
2 �159:859ı �159:324ı �111:347ı 21:654ı
3 164:800ı �154:290ı �85:341ı �101:359ı
4 �148:749ı �179:740ı �78:505ı 55:719ı
5 �16:480ı �10:747ı �58:894ı 5:677ı
6 �46:014ı �19:256ı �46:988ı �114:768ı
7 �22:260ı �22:431ı �32:024ı �17:155ı
8 �53:176ı 26:165ı 9:103ı 127:978ı
9 �173:928ı 150:697ı 47:811ı �92:284ı
10 �41:684ı �29:130ı 52:360ı 25:091ı
11 �137:195ı �156:920ı 68:306ı 147:446ı
12 �139:059ı 128:112ı 96:052ı �119:837ı
13 �22:696ı 29:214ı 98:631ı 170:303ı
14 �83:094ı 57:022ı 130:976ı �110:981ı
15 1:227ı �7:353ı 142:697ı 149:208ı
16 177:538ı �148:178ı 159:429ı 110:984ı
</p>
<p>Example 9.7.3. In this example, we discuss the IDP of DIESTRO, the isotropic
six-axis orthogonal manipulator shown in Fig. 5.15 (Williams et al. 1993). For a
meaning of kinematic isotropy, we refer the reader to Sect. 5.8. This manipulator
has the DH parameters given in Table 5.1. The pose of the end-effector leading to
an isotropic posture, i.e., one whose Jacobian matrix is isotropic, is defined by the
orthogonal matrix Q and the position vector p displayed below:
</p>
<p>Q D
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 0
0 0 �1
1 0 0
</p>
<p>3
</p>
<p>5 ; p D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>�50
50
</p>
<p>3
</p>
<p>5
</p>
<p>with p given in mm. Compute all real inverse displacement solutions at the given
pose.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.7 Examples 415
</p>
<p>Solution: The characteristic length of DIESTRO was found in Sect. 5.8 to be equal
to the common value ai D bi D 50mm, for i D 1; : : : ; 6. This manipulator, at the
given pose of the EE, exhibits a self-motion, proper of redundant manipulators, but
not expected in a six-revolute robot. A self-motion occurs when a manipulator has
the ability to move all its joints while keeping its EE fixed at one given pose. This
feature makes the procedure of Sect. 9.4 difficult to apply.11 We resort, hence, to
an alternative approach: We go back to Eq. (9.27) and partition it into two sets of
equations:
</p>
<p>Pux45 D Rux12 (9.74a)
Plx45 D Rlx12 (9.74b)
</p>
<p>where Pu and Pl are 6 � 9 and 8 � 9 submatrices of P. Likewise, Ru and Rl are
the corresponding 6 � 8 and 8 � 8 submatrices of R. In the above partitioning, the
equations must be grouped such that Rl be nonsingular. Using Eqs. (9.74a and b),
six scalar equations free of �1 and �2 can be derived, namely,
</p>
<p>&#128;x45 D 06 ; &#128; � Pu � Ru.R�1l Pl / (9.75)
</p>
<p>where 06 is the six-dimensional zero vector. Since the entries of the 6 � 9 matrix &#128;
are all linear in x3, the entry in the i th row and j th column of the foregoing matrix,
&#13;ij , can be expressed in the form
</p>
<p>&#13;ij D aij c3 C bij s3 C cij I i D 1; : : : ; 6 I j D 1; : : : ; 9 (9.76)
</p>
<p>In the above expression, coefficients aij , bij , and cij are independent of the joint
variables. Using Eq. (9.76), we can expand Eq. (9.75) and then rearrange the terms
in the i th equation, thus obtaining
</p>
<p>Aic3 C Bi s3 C Ci D 0 I i D 1; : : : ; 6 (9.77a)
</p>
<p>where, for i D 1; : : : ; 6, we have
</p>
<p>Ai � ai1s4s5 C ai2s4c5 C ai3c4s5 C ai4c4c5 C ai5s4 C ai6c4
Cai7s5 C ai8c5 C ai9 (9.77b)
</p>
<p>Bi � bi1s4s5 C bi2s4c5 C bi3c4s5 C bi4c4c5 C bi5s4 C bi6c4
Cbi7s5 C bi8c5 C bi9 (9.77c)
</p>
<p>Ci � ci1s4s5 C ci2s4c5 C ci3c4s5 C ci4c4c5 C ci5s4 C ci6c4
Cci7s5 C ci8c5 C ci9 (9.77d)
</p>
<p>11The self-motion is not readily detected by contour-intersection using this procedure.</p>
<p/>
</div>
<div class="page"><p/>
<p>416 9 Geometry of General Serial Robots
</p>
<p>Now the six scalar equations (9.77a) are cast in vector form as
</p>
<p>Dy3 D 06 (9.78)
</p>
<p>In the above equation, D is a 6 � 3 matrix whose entries are bilinear in x4 and x5,
while y3 was defined in Eq. (9.41). Now, to eliminate �3, we realize that, from its
definition, y3 &curren; 0, and hence, D must be rank-deficient. This means that every one
of its 20 3 � 3 determinants, obtained by picking up three of its six rows at a time,
should vanish&mdash;the number of combinations of six objects taking three at a time is
20. We need, in principle, only two of these determinants to obtain two independent
equations in �4 and �5. Actually, to be on the safe side, we should impose the
vanishing of all 20 possible determinants, which would yield, correspondingly,
20 contours in the �4&ndash;�5 plane; the intersections of all contours would then yield
the real .�4; �5/ pairs of values which render D rank-deficient. Nevertheless, the
visualization of the intersections of all 20 contours would be physically impossible,
and so, we have to compromise with a smaller number. As we have experienced,
only two of the above determinants are prone to yield spurious solutions, for which
reason we pick up a reduced number of determinants and derive three equations in
�4 and �5.
</p>
<p>We produce the three desired equations by first partitioning the 6� 3matrix D of
Eq. (9.78) into two 3� 3 blocks, Du being the upper, Dl the lower block, which thus
yields
</p>
<p>&#129;1 D det.Du/; &#129;2 D det.Dl /
</p>
<p>Now, since the determinant is not additive, i.e., det.DuCDl / &curren; det.Du/C det.Dl /,
we choose &#129;3 as
</p>
<p>&#129;3 � det.Du C Dl /
</p>
<p>which is apparently independent of &#129;1 and &#129;2, thereby obtaining three determi-
nants,12 which, when equated to zero, yield three independent equations in �4 and
�5. Each of these equations describes a contour Ci , for i D 1; 2; 3, in the �4&ndash;�5
plane, i.e.,
</p>
<p>Ci W Fi .�4; �5/ D 0; i D 1; 2; 3 (9.79)
</p>
<p>Note that, by plotting the three contours in the �� � �i � � region, for i D 4; 5,
we ensure that no real solutions will be missed.
</p>
<p>12This idea was proposed by Dr. Kourosh Etemadi Zanganeh, CANMET (Nepean, Ontario,
Canada).</p>
<p/>
</div>
<div class="page"><p/>
<p>9.7 Examples 417
</p>
<p>2
</p>
<p>1
</p>
<p>C1
</p>
<p>C2 &larr; C3
</p>
<p>(SS) &rarr;
</p>
<p>(SS) &rarr;
</p>
<p>θ5 (rad)
</p>
<p>θ4 (rad)
</p>
<p>-3 -2 -1 0 1 2 3
</p>
<p>-3
</p>
<p>-2
</p>
<p>-1
</p>
<p>0
</p>
<p>1
</p>
<p>2
</p>
<p>3
Fig. 9.5 Contours C1, C2, and
C3 for the DIESTRO
manipulator at given pose
</p>
<p>Table 9.11 Inverse displacement solutions of the DIESTRO manipulator
</p>
<p>Solution no. �1 �2 �3 �4 �5 �6
1 0ı 90ı �90ı 90ı �90ı 180ı
2 180ı �90ı 90ı �90ı 90ı 0ı
</p>
<p>The three contours thus obtained are plotted in Fig. 9.5a. As this figure shows,
the three contours intersect at two isolated points, those labeled 1 and 2. The
contours also intersect along a curve labeled SS in the same figure, which thus
represents a manifold of singular solutions; this means that DIESTRO admits a
set of self-motions. These motions can be explained by noticing that when the
end-effector is located at the given pose and the manipulator is postured at joint-
variable values determined by any point on the SS curve, the six links form a
Bricard mechanism (Bricard 1927). The degree of freedom of a Bricard mechanism
cannot be determined from the well-known Chebyshev&ndash;Gr&uuml;bler-Kutzbach formula
(Angeles 2005), which yields a dof D 0. Here, the single-dof motion of the
mechanism occurs because the six revolute axes are laid out in such a way that
if they are grouped in two alternating triads, then these triads intersect.
</p>
<p>Furthermore, contours C1 and C2 intersect at right angles at solution 1, which
corresponds to the isotropic posture of the robot. The numerical values of the joint
variables for the isolated solutions are given in Table 9.11.
</p>
<p>This example shows interesting features of the manipulator IDP which are not
present in manipulators with simpler architectures, such as those with intersecting
or parallel consecutive axes.
</p>
<p>Moreover, the point of coordinates �4 D �5 D �=2 of Fig. 9.5 appears to be
an intersection of the three contours, and hence, a solution of the IDP at hand.
A close-up of this point, as displayed in Fig. 9.6a, shows that this point is indeed an</p>
<p/>
</div>
<div class="page"><p/>
<p>418 9 Geometry of General Serial Robots
</p>
<p>Fig. 9.6 A close-up of: (a) the apparent contour intersection at the point of coordinates �4 D �5 D
�=2 .90ı/; and (b) the apparent contour intersection southwest of solution 2
</p>
<p>intersection of all three contours, but this point is, in fact, a double point, i.e., a point
at which each contour crosses itself; this gives the point a special character: When
verifying whether this point is a solution of the problem under study, we tried to
solve for x3 from eq. (9.70a), but then found that matrix H of that equation vanishes,
and hence, does not allow for the calculation of x3. An alternative approach to testing
the foregoing values of �4 and �5 is described in Exercise 9.5. In following this
approach, it was found that these values do not yield a solution, and hence, the
intersection point is discarded.
</p>
<p>One more point that appears as an intersection of the three contours is that
southwest of solution 2. A close-up of this point, as shown in Fig. 9.6b, reveals that
the three contours do not intersect in that region. In summary, then, the manipulator
at hand admits two isolated inverse-displacement solutions at the given pose and an
infinity of solutions along the curve SS.
</p>
<p>9.8 Exercises
</p>
<p>9.1 Show that the left-hand side of Eq. (9.23f) represents a pure reflection of vector
h about a plane of unit normal f=kfk, if multiplied by kfk2. Also show that the
right-hand side of the same equation represents a pure reflection of vector i
about a plane of unit normal g=kgk, if multiplied by kgk2.
</p>
<p>9.2 Show that  1 and  2, as defined in Eqs. (9.43c and d) both vanish.
9.3 In this exercise, we will try to gain insight into the consequence of the double
</p>
<p>point at �4 D �5 D �=2 of Fig. 9.5 of Example 9.7.3. To this end, show
that, for this combination of values, matrix H of Eq. (9.70a) becomes zero,
and hence, x3 cannot be computed from this equation. As a result, none of the
remaining angles can be computed recursively.</p>
<p/>
</div>
<div class="page"><p/>
<p>9.8 Exercises 419
</p>
<p>9.4 As an alternative approach to the 14 fundamental equations derived in
Sect. 9.2, we recall Eqs. (9.16a and b), if written in a more convenient form, so
as to have a minimum number of matrix multiplications, namely,
</p>
<p>Q3Q4Q5 D QT2 QT1 QQT6
QT2 Q
</p>
<p>T
1 .a1 � p/CQT2 a2 C a3 CQ3a4
</p>
<p>CQ3Q4a5 CQ3Q4Q5a6 D 0
</p>
<p>Now equate the four linear invariants of the two sides of the first of the
two foregoing equations. The result is a set of four scalar equations. When
the translational equations are expanded, and appended to the first four
equations, a system of seven trigonometric equations in the six unknown
angles is derived. Obtain that system of seven equations and comment on their
suitability to solve the IDP.
</p>
<p>9.5 In Sect. 9.6 we realized that, upon applying the Raghavan&ndash;Roth elimination
method, and once �3 is computed, �4 and �5 can be computed at once by
finding the eigenvector of S associated with its zero eigenvalue. While this
calculation can be performed with the eigenvalue-computation module of any
scientific package, computing the eigenvalues of a 12 � 12 matrix like S
requires an iterative procedure, which can be time-consuming, especially if
this computation is only a part of a more complex procedure.
</p>
<p>In order to find Qx45, and hence, �4 and �5, from Eq. (9.48d), we need
not resort to a full eigenvalue problem. Instead, a vector v can be computed
directly, as opposed to iteratively, that spans the null space of S, for a given
computed value of �3, if a change of variables is introduced that will yield S
in upper-triangular form. In fact, since S is a fortiori singular, its last row is
bound to have zero entries in that form. Devise an algorithm that will render S
in upper-triangular form and hence, compute vector Qx45 under the conditions
that this vector (a) lie in the null space of S and (b) its 12th entry be unity.
Hint: Apply an orthogonalization procedure, as described in Appendix B.
</p>
<p>9.6 With reference to Example 9.7.3, keep the EE of DIESTRO fixed to the
manipulator base at the given pose, thereby forming a 6R closed kinematic
chain. Find the singularity locus SS of Fig. 9.5 by means of a kinematic input&ndash;
output analysis of the closed chain, which turns out to be a Bricard mechanism.
</p>
<p>9.7 Using the rough estimates displayed in Table 9.2, Example 9.7.1, compute
refined estimates of the coordinates of intersection point 4 upon solving the
four equations (9.62) pairwise by means of the Newton&ndash;Raphson method.
Compute the condition number of each solution based on the Frobenius norm
of the 2 � 2 Jacobian F of Eq. (9.63). Comment on your result.
</p>
<p>9.8 Write a procedure to compute matrix S of the Raghavan&ndash;Roth method. Then,
evaluate this matrix at solutions 7 and 8 of Example 9.7.1.
</p>
<p>9.9 Derive expressions for vectors f, g, h and ı of Eqs. (9.33a&ndash;d).
9.10 Derive an expression for &#128;4, and hence, one for &#128;4x45 of Eq. (9.40a).</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 10
</p>
<p>Kinematics of Alternative Robotic Mechanical
Systems
</p>
<p>10.1 Introduction
</p>
<p>The study of robotic mechanical systems has focused, so far, on serial manipulators.
These are the most common systems of their kind, but nowadays by no means
the majority. In recent years, other kinds of robotic mechanical systems have been
developed, as outlined in Chap. 1. Under alternative robotic mechanical systems we
understand here: (a) parallel robots; (b) multifingered hands; (c) walking machines;
and (d) rolling robots. A class that is increasingly receiving attention, humanoids,
portrays an architecture inspired from the human musculo-skeletal system. This
class deserves a study on its own because of the host of control problems that it poses
to the roboticist; its kinematics, however, can be studied with the tools developed
in this chapter for the first three kinds of systems listed above. For this reason, a
section on humanoids is not included here.
</p>
<p>Moreover, under the general heading of kinematics, we study in this chapter the
geometry and velocity relations between the sets of joint and Cartesian variables.
For the sake of brevity, however, we leave aside the statics of these systems. The
reader should be able to derive these relations from the duality between kinematics
and statics, as outlined in Chaps. 3 and 5. Some exercises in this regard are included
in this chapter.
</p>
<p>10.2 Kinematics of Parallel Manipulators
</p>
<p>Unlike serial manipulators, their parallel counterparts are composed of kinematic
chains with closed subchains. A fairly general parallel manipulator is shown in
Fig. 10.1, in which one can distinguish two platforms, one fixed to the ground,
B, and one capable of moving arbitrarily within its workspace, M. The moving
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__10,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>421</p>
<p/>
</div>
<div class="page"><p/>
<p>422 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Fig. 10.1 A general six-dof parallel manipulator
</p>
<p>a b
</p>
<p>Fig. 10.2 A six-dof flight simulator: (a) general layout; (b) geometry of its two platforms
</p>
<p>platform is connected to the fixed platform through six legs, each being regarded
as a six-axis serial manipulator whose base is B and whose end-effector is M. The
whole leg is composed of six links coupled through six revolutes.
</p>
<p>The robotic architecture shown in Fig. 10.1 is, in fact, too general, and of little
use as such. A simpler and more practical parallel architecture, which is used as
a flight simulator, is sketched in Fig. 10.2a. In this figure, the fixed platform B
is a regular hexagon, while the moving platform M is an equilateral triangle, as
depicted in Fig. 10.2b. Moreover, B is connected to M by means of six serial chains,</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 423
</p>
<p>Fig. 10.3 A layout of a leg of the manipulator of Fig. 10.2
</p>
<p>each comprising five revolutes and one prismatic pair. Three of the revolutes bear
concurrent axes, and hence, constitute a spherical joint, similar to the wrists studied
in Sect. 4.4, while two more have axes intersecting at right angles, thus constituting
a universal joint. Of the six foregoing joints, only one, the prismatic pair, is actuated.
</p>
<p>It is to be noted that although each leg of the manipulator of Fig. 10.2a has a
spherical joint at only one end and a universal joint at the other end, we represent
each leg in that figure with a spherical joint at each end. Kinematically, the leg
depicted in Fig. 10.2a is equivalent to the actual one, the only difference being that
the former appears to have a redundant joint. We use the model of Fig. 10.2a only
to make the drawing simpler. A more accurate display of the leg architecture of this
manipulator appears in Fig. 10.3.
</p>
<p>Because the kinematics and statics of parallel manipulators at large are beyond
the scope of this book, we will limit the discussion to parallel manipulators of the
simplest type.
</p>
<p>With regard to the manipulators under study, we can also distinguish between
the inverse and the direct kinematics problems in exactly the same way as these
problems were defined for serial manipulators. The inverse kinematics of the general
manipulator of Fig. 10.1 is identical to that of the general serial manipulator studied
in Sect. 9.2. In fact, each leg can be studied separately for this purpose, the problem
thus becoming the same as in that section. For the particular architecture of the
manipulator of Fig. 10.2a, in which the actuated joint variables are displacements
measured along the leg axes, the inverse kinematics simplifies substantially and</p>
<p/>
</div>
<div class="page"><p/>
<p>424 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>allows for a simple closed-form solution. However, the direct kinematics of the
same manipulator is as challenging as that of the general serial manipulator
of Sect. 9.2. With regard to the direct kinematics of manipulators of the type
depicted in Fig. 10.2a, Charentus and Renaud (1989) and Nanua et al. (1990)
showed independently that like the inverse kinematics of general six-axis serial
manipulators, the direct kinematics of this manipulator reduces to a 16th-degree
polynomial. Note, however, that the direct kinematics of a manipulator similar to
that of Fig. 10.2a, but with arbitrary locations of the attachment points of each
leg to the moving and fixed platforms, termed the general platform manipulator,
has been the subject of intensive research (Merlet 2006). A breakthrough in the
solution of the direct kinematics of platform manipulators of the general type
was reported by Raghavan (1993), who resorted to polynomial continuation, a
technique already mentioned in Sect. 9.2, for computing up to 40 poses of M
for given leg lengths of a parallel manipulator with legs of the type depicted in
Fig. 10.3, but with attachment points at both M and B with an arbitrary layout.
What Raghavan did not derive is the characteristic 40th-degree polynomial of the
general platform manipulator. Independently, Wampler (1996) and Husty (1996)
devised procedures to derive this polynomial, although Wampler did not pursue
the univariate polynomial approach and preferred to cast the problem in a form
suitable for its solution by means of polynomial continuation. Husty did derive
the 40th-degree polynomial for several examples. In the process, he showed that
this polynomial is the underlying characteristic polynomial for all manipulators
of the platform type, which simplifies to a lower-degree polynomial for simpler
architectures. As a matter of fact, Lee and Roth (1993) solved the direct kinematics
of platform manipulators for which the attachment points at the base and the moving
platforms are located at the vertices of planar, similar hexagons. These researchers
showed that the problem here reduces to a cascade of quadratic and linear equations.
In the particular case in which both polygons are regular, however, the manipulator
degenerates into a movable structure, upon fixing the leg lengths, and hence, the
solution set becomes a continuum. Lazard and Merlet (1994), in turn, showed that
the platform manipulator originally proposed by Stewart (1965), and known as the
Stewart&ndash;Gough platform, has a 12th-degree characteristic polynomial. Interestingly,
these mechanical systems were first introduced by Gough (1956&ndash;1957) for testing
tires; Stewart (1965) suggested their use as flight simulators, an application that is
now well established.
</p>
<p>Husty, however, did not show that his 40th-degree polynomial is minimal in
that manipulator architectures are possible that exhibit up to 40 actual solutions.
Dietmaier (1998) did this, by devising an algorithm that would iteratively increase
the number of real solutions of a given architecture. With this paper, Dietmaier
proved conclusively that Husty&rsquo;s 40th-degree polynomial is, in fact, minimal. This
was rather surprising, for virtually everybody working in the field expected a
minimal polynomial of a degree of the form 2n, with n being a positive integer.
Notice that, in the cases of the most general serial six-revolute manipulator and of
the flight simulator, the minimal polynomial is of a degree of this form, with n D 4.</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 425
</p>
<p>Table 10.1 DH parameters
of the leg of Fig. 10.3
</p>
<p>i ai bi ˛i
</p>
<p>1 0 0 90ı
</p>
<p>2 0 0 90ı
</p>
<p>3 0 b3 0ı
</p>
<p>4 0 b4 (const) 90ı
</p>
<p>5 0 0 90ı
</p>
<p>6 0 b6 (const) 0ı
</p>
<p>Below we analyze the inverse kinematics of one leg of the manipulator of
Fig. 10.2a, as depicted in Fig. 10.3. The Denavit&ndash;Hartenberg parameters of the leg
shown in this figure are given in Table 10.1. It is apparent that the leg under study is a
decoupled manipulator. Its inverse kinematics can be derived by properly modifying
the scheme introduced in Sect. 4.4, for we now have a prismatic joint, which is, in
fact, the only active joint of this manipulator. Moreover, by virtue of the underlying
design, the active joint variable, b3, can take on only positive values.
</p>
<p>In view of the DH parameters of this manipulator, Eq. (4.16) reduces to
</p>
<p>Q1Q2.a3 C a4/ D c (10.1)
</p>
<p>where c denotes the position vector of the center C of the spherical wrist and, since
frames F3 and F4 of the DH notation are related by a pure translation, Q3 D 1.
Upon equating the squares of the Euclidean norms of both sides of the foregoing
equation, we obtain
</p>
<p>ka3 C a4k2 D kck2 (10.2)
</p>
<p>where, by virtue of the DH parameters of Table 10.1,
</p>
<p>ka3 C a4k2 D .b3 C b4/2
</p>
<p>Now, since both b3 and b4 are positive by construction, Eq. (10.2) readily leads to
the desired inverse kinematics solution, namely,
</p>
<p>b3 D kck � b4 &gt; 0 (10.3)
</p>
<p>a result that could have been derived by inspection of Fig. 10.3.
Note that the remaining five joint variables of the leg under study are not
</p>
<p>needed for purposes of inverse kinematics, and hence, their calculation could be
skipped. However, in studying the differential kinematics of these manipulators,
these variables will be needed; it is thus convenient to solve for them now. This
is straightforward, as shown below: Upon expansion of Eq. (10.1), we derive three
scalar equations in two unknowns, �1 and �2, namely,</p>
<p/>
</div>
<div class="page"><p/>
<p>426 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>.b3 C b4/s2 D xC c1 C yC s1 (10.4a)
�.b3 C b4/c2 D zC (10.4b)
</p>
<p>0 D xC s1 � yC c1 (10.4c)
</p>
<p>in which ci and si stand for cos �i and sin �i , respectively, while b3, occurring in the
above equations, is available in Eq. (10.3). From Eq. (10.4c), �1 is derived as
</p>
<p>�1 D tan�1
�
yC
</p>
<p>xC
</p>
<p>�
</p>
<p>(10.5a)
</p>
<p>which yields a unique value of �1 rather than the two lying � radians apart, for
the two coordinates xC and yC determine the quadrant in which �1 lies. Once �1 is
known, �2 is derived uniquely from the remaining two equations through its cosine
and sine functions, i.e.,
</p>
<p>c2 D �
zC
</p>
<p>b3 C b4
; s2 D
</p>
<p>xC c1 C yC s1
b3 C b4
</p>
<p>(10.5b)
</p>
<p>With the first three joint variables of this leg known, the remaining ones, i.e., those
of the &ldquo;wrist,&rdquo; are calculated as described in Sect. 4.4.2. Therefore, the inverse
kinematics of each leg admits two solutions, one for the first three variables and
two for the last three. Moreover, since the only actuated joint is one of the first
three, which of the two wrist solutions is chosen does not affect the value of b3, and
hence, each manipulator leg admits only one inverse kinematics solution.
</p>
<p>While the inverse kinematics of this leg is quite straightforward, its direct
kinematics is not. Below we give an outline of the solution procedure for the
manipulator under study that follows the procedure proposed by Nanua et al. (1990).
</p>
<p>In Fig. 10.2a, consider the triangles AiSiBi , for i D 1; 2; 3, where the subscript i
stands for the i th pair of legs. When the lengths of the six legs are fixed and plate M
is removed, triangle AiSiBi can only rotate about the axis AiBi . Therefore, we can
replace the pair of legs of lengths qia and qib by a single leg of length li , connected to
the base plate B by a revolute joint with its axis alongAiBi . The resulting simplified
structure, as shown in Fig. 10.4, is kinematically equivalent to the original structure
in Fig. 10.2a.
</p>
<p>Now we introduce the coordinate frame Fi , with origin at the attachment point
Oi of the i th leg with the base plate B, according with the geometry of Fig. 10.4 and
the notation below:
For i D 1; 2; 3,
Xi is directed from Ai to Bi ;
Yi is chosen such that Zi is perpendicular to the plane of the hexagonal base and
</p>
<p>points upwards.
Oi is set at the intersection of Xi and Yi , and is designated the center of the revolute
</p>
<p>joint;</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 427
</p>
<p>Fig. 10.4 Equivalent simplified mechanism
</p>
<p>Fig. 10.5 Replacing each
pair of legs with a single leg
</p>
<p>Next, we locate the three vertices S1, S2, and S3 of the triangular plate with
position vectors stemming from the center O of the hexagon. Furthermore, we need
to determine li andOi . Referring to Figs. 10.4 and 10.5, and letting ai and bi denote
the position vectors of points Ai and Bi , respectively, we have
</p>
<p>di D kbi � aik
</p>
<p>ri D
d 2i C q2ia � q2ib
</p>
<p>2di
</p>
<p>li D
q
</p>
<p>q2ia � r2i
</p>
<p>ui D
bi � ai
di</p>
<p/>
</div>
<div class="page"><p/>
<p>428 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Fig. 10.6 Relation between
frames F0 and Fi
</p>
<p>for i D 1; 2; 3, and hence, ui is the unit vector directed from Ai to Bi . Moreover,
the position of the origin Oi is given by vector oi , as indicated below:
</p>
<p>oi D ai C riui ; for i D 1; 2; 3: (10.6)
</p>
<p>Furthermore, let si be the position vector of Si in frame Fi .Oi ; Xi ; Yi ; Zi /. Then
</p>
<p>si D
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>�li cos�i
li sin�i
</p>
<p>3
</p>
<p>5 ; for i D 1; 2; 3 (10.7)
</p>
<p>Now a frame F0 .O; X; Y; Z/ is defined with origin at O and axes X and Y
in the plane of the base hexagon, and related to Xi and Yi as depicted in Fig. 10.6.
When expressed in frame F0, si takes on the form
</p>
<p>Œ si &#141;0 D Œ oi &#141;0 C ŒRi &#141;0si ; for i D 1; 2; 3 (10.8)
</p>
<p>where ŒRi &#141;0 is the matrix that rotates frame F0 to frame Fi , expressed in F0, and is
given as
</p>
<p>ŒRi &#141;0 D
</p>
<p>2
</p>
<p>4
</p>
<p>cos˛i � sin˛i 0
sin˛i cos˛i 0
0 0 1
</p>
<p>3
</p>
<p>5 ; for i D 1; 2; 3 (10.9)
</p>
<p>Referring to Fig. 10.6,
</p>
<p>cos˛i D ui � i D uix (10.10)
sin˛i D ui � j D uiy (10.11)</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 429
</p>
<p>After substitution of Eqs. (10.9)&ndash;(10.11) into Eq. (10.8), we obtain
</p>
<p>Œ si &#141;0 D Œ oi &#141;0 C li
</p>
<p>2
</p>
<p>4
</p>
<p>uiy cos�i
�uix cos�i
</p>
<p>sin�i
</p>
<p>3
</p>
<p>5 ; for i D 1; 2; 3 (10.12)
</p>
<p>where oi is given by Eq. (10.6).
Since the distances between the three vertices of the triangular plate are fixed,
</p>
<p>the position vectors s1; s2, and s3 must satisfy the constraints below:
</p>
<p>ks2 � s1k2 D a21 (10.13a)
ks3 � s2k2 D a22 (10.13b)
ks1 � s3k2 D a23 (10.13c)
</p>
<p>After expansion, Eqs. (10.13a&ndash;c) take the forms:
</p>
<p>D1c�1 CD2c�2 CD3c�1c�2 CD4s�1s�2 CD5 D 0 (10.14a)
E1c�2 CE2c�3 CE3c�2c�3 CE4s�2s�3 CE5 D 0 (10.14b)
F1c�1 C F2c�3 C F3c�1c�3 C F4s�1s�3 C F5 D 0 (10.14c)
</p>
<p>where c.�/ and s.�/ stand for cos.�/ and sin.�/, respectively, while coefficients
fDi ; Ei ; Fig51 are functions of the data only and bear the forms shown below1:
</p>
<p>D1 D 2l1.o2 � o1/TEu1
D2 D �2l2.o2 � o1/TEu2
D3 D �2l1l2uT2 u1
D4 D �2l1l2
D5 D ko2k2 C ko1k2 � 2oT1 o2 C l21 C l22 � a21
</p>
<p>E1 D 2l2.o3 � o2/TEu2
E2 D �2l3.o3 � o2/TEu3
E3 D �2l2l3uT3 u2
E4 D �2l2l3
E5 D ko3k2 C ko2k2 � 2oT3 o2 C l22 C l23 � a22
</p>
<p>1Since all vectors in the 15 coefficients of interest are coplanar, they are regarded as two-
dimensional vectors in the display of the 15 coefficients.</p>
<p/>
</div>
<div class="page"><p/>
<p>430 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>F1 D 2l1.o1 � o3/TEu1
F2 D �2l3.o1 � o3/TEu3
F3 D �2l1l3uT3 u1
F4 D �2l1l3
F5 D ko3k2 C ko1k2 � 2oT3 o1 C l21 C l23 � a23
</p>
<p>In the above relations the 2� 2 matrix E is defined as in Eq. (5.55), and the frame in
which the vectors are expressed is immaterial, as long as all vectors appearing in
the same scalar product are expressed in the same frame. Since expressions for
these vectors in F0 have already been derived, it is just simpler to perform those
computations in this frame.
</p>
<p>Our next step is to reduce the foregoing system of three equations in three
unknowns to two equations in two unknowns, and hence, obtain two contours in
the plane of two of the three unknowns, the desired solutions being determined as
the intersections of the two contours. Since Eq. (10.14a) is already free of �3, all
we have to do is eliminate �3 from equations (10.14b) and (10.14c). To do this, we
resort to the usual trigonometric identities relating c�3 and s�3 with tan.�3=2/, in
Eqs. (10.14b) and (10.14c). After we have cleared the denominators by multiplying
the two foregoing equations by .1 C �23 /, the equations thus resulting take on
the forms
</p>
<p>k1�
2
3 C k2�3 C k3 D 0 (10.15a)
</p>
<p>m1�
2
3 Cm2�3 Cm3 D 0 (10.15b)
</p>
<p>where k1, k2, and k3 are linear combinations of s�2, c�2, and 1. Likewise, m1, m2,
and m3 are linear combinations of s�1, c�1, and 1, namely,
</p>
<p>k1 D E1c�2 �E2 �E3c�2 CE5
k2 D 2E4s�2
k3 D E1c�2 CE2 CE3c�2 CE5
m1 D F1c�1 � F2 � F3c�1 C F5
m2 D 2F4s�1
m3 D F1c�1 C F2 C F3c�1 C F5
</p>
<p>Next, we eliminate �3 from the above equations dialytically, as we did in
Sect. 5.4.1 to find the workspace of a three-axis serial manipulator. We proceed now
by multiplying each of the above equations by �3 to obtain two more equations,
namely,
</p>
<p>k1�
3
3 C k2�23 C k3�3 D 0 (10.15c)
</p>
<p>m1�
3
3 Cm2�23 Cm3�3 D 0 (10.15d)</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 431
</p>
<p>Further, we write Eqs. (10.15a)&ndash;(10.15d) in homogeneous form:
</p>
<p>ˆ�3 D 0 (10.16a)
</p>
<p>with the 4 � 4 matrix ˆ and the four-dimensional vector �3 defined as
</p>
<p>ˆ �
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>k1 k2 k3 0
</p>
<p>m1 m2 m3 0
</p>
<p>0 k1 k2 k3
0 m1 m2 m3
</p>
<p>3
</p>
<p>7
7
5
; �3 �
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>�33
�23
�3
1
</p>
<p>3
</p>
<p>7
7
5
</p>
<p>(10.16b)
</p>
<p>Equation (10.16a) constitutes a linear homogeneous system. Moreover, in view
of the form of vector �3, we are interested only in nontrivial solutions, which exist
only if det.ˆ/ vanishes. We thus have the condition
</p>
<p>det.ˆ/ D 0 (10.16c)
</p>
<p>Equations (10.14a) and (10.16c) form a system of two equations in two
unknowns, �1 and �2. These two equations can be further reduced to a single
16th-degree polynomial equation (Nanua et al. 1990), as discussed later on.
</p>
<p>In the spirit of the contour method introduced earlier, we plot these two equations
as two contours in the �1&ndash;�2 plane and determine the desired solutions at points
where the two contours intersect. Once a pair of .�1; �2/ values is found, �3 can
be uniquely determined from Eqs. (10.14b and c). Indeed, these equations can be
arranged in the form:
</p>
<p>�
</p>
<p>E4s�2 E2 CE3c�2
F4s�1 F2 C F3c�1
</p>
<p>� �
</p>
<p>s�3
c�3
</p>
<p>�
</p>
<p>D
�
</p>
<p>�E1c�2 �E5
�F1c�1 � F5
</p>
<p>�
</p>
<p>From the above equation, both c�3 and s�3 can be found uniquely; with the
foregoing unique values, �3 is determined uniquely as well.
</p>
<p>Knowing the angles �1, �2, and �3 allows us to determine the position vectors
of the three vertices of the mobile plate, s1, s2, and s3, whose expressions are given
by Eq. (10.12). Since three points define a plane, the pose of the end-effector is
uniquely determined by the positions of its three vertices. We illustrate the foregoing
procedure with a numerical example below:
</p>
<p>Example 10.2.1 (A Contour-Intersection Approach). We derive the direct kinemat-
ics of a manipulator analyzed by Nanua et al. (1990). This is a platform manipulator
whose base plate has six vertices with coordinates expressed with respect to the
fixed reference frame F0 as given below, with all data given in meters:
</p>
<p>A1 D .�2:9;�0:9/ ; B1 D .�1:2; 3:0/
A2 D . 2:5; 4:1/ ; B2 D . 3:2; 1:0/
A3 D . 1:3;�2:3/ ; B3 D .�1:2;�3:7/</p>
<p/>
</div>
<div class="page"><p/>
<p>432 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>1
2
</p>
<p>3
4
</p>
<p>C2
</p>
<p>C2
</p>
<p>C1
</p>
<p>C1
</p>
<p>-3 -2 -1 0 1 2 3
</p>
<p>-3
</p>
<p>-2
</p>
<p>-1
</p>
<p>0
</p>
<p>1
</p>
<p>2
</p>
<p>3
Fig. 10.7 Contours C1 and C2
for Nanua et al.&rsquo;s example
</p>
<p>The dimensions of the movable triangular plate are, in turn,
</p>
<p>a1 D 2:0; a2 D 2:0; a3 D 3:0
</p>
<p>Determine all possible poses of the moving plate for the six leg-lengths given as
</p>
<p>q1a D 5:0; q2a D 5:5; q3a D 5:7;
q1b D 4:5; q2b D 5:0; q3b D 5:5
</p>
<p>Solution: After substitution of the given numerical values, Eqs. (10.14a)
and (10.16c) become, with ci and si standing for cos�i and sin�i , respectively,
</p>
<p>C1W 61:848 � 36:9561c1 � 47:2376c2 C 33:603c1c2 � 41:6822s1s2 D 0
C2W �28:5721C 48:6506c1 � 20:7097c21 C 68:7942c2 � 100:811c1c2
C35:9634c21c2 � 41:4096c22 C 50:8539c1c22 � 15:613c21c22 � 52:9789s21
</p>
<p>C67:6522c2s21 � 13:2765c22s21 C 74:1623s1s2 � 25:6617c1s1s2
�67:953c2s1s2 C 33:9241c1c2s1s2 � 13:202s22
</p>
<p>�3:75189c1s22 C 6:13542c21s22 D 0
</p>
<p>The foregoing equations determine contours C1 and C2 in the �1&ndash;�2 plane, which
are plotted in Fig. 10.7. Four real solutions are found by superimposing C1 and C2,
as shown in this figure. The numerical values of the solutions, listed in Table 10.2,
agree with the published results. Solutions 1 and 2 represent two poses of the</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 433
</p>
<p>Table 10.2 Solutions for
Nanua et al.&rsquo;s example
</p>
<p>No. �1 (rad) �2 (rad) �3 (rad)
</p>
<p>1 0.8335 0.5399 0.8528
2 1.5344 0.5107 0.2712
3 �0:8335 �0:5399 �0:8528
4 �1:5344 �0:5107 �0:2712
</p>
<p>triangular plate over the base, while solutions 3 and 4 are just the reflections of
solutions 1 and 2 with respect to the plane of the base plate. Hence, the geometric
symmetry gives rise to an algebraic symmetry of the solutions.
</p>
<p>Example 10.2.2 (The Univariate Polynomial Approach). Reduce the two equations
found in Example 10.2.1, Eqs. (10.14a) and (10.16c), to a single monovariate
polynomial equation.
</p>
<p>Solution: We first substitute the trigonometric identities relating c�i and s�i with
�i � tan.�i=2/, for i D 1; 2, into Eqs. (10.14a) and (10.16c). Upon clearing the
denominators by multiplying those equations by .1 C �21 /.1 C �22 /, we obtain two
polynomial equations in �1, namely,
</p>
<p>G1�
4
1 CG2�31 CG3�21 CG4�1 CG5 D 0 (10.17)
</p>
<p>H1�
2
1 CH2�1 CH3 D 0 (10.18)
</p>
<p>where
</p>
<p>G1 D K1�42 CK2�22 CK3
G2 D K4�32 CK5�2
G3 D K6�42 CK7�22 CK8
G4 D K9�32 CK10�2
G5 D K11�42 CK12�22 CK13
</p>
<p>and
</p>
<p>H1 D L1�22 C L2
H2 D L3�2
H3 D L4�22 C L5
</p>
<p>In the above relations, fKig131 and fLig51 are all functions of the data. We now
eliminate �1 from Eqs. (10.17) and (10.18), following Bezout&rsquo;s method, as given in
(Salmon 1964). To do this, we multiply Eq. (10.17) by H1 and Eq. (10.18) by G1�21 ,
and subtract the two equations thus resulting, which leads to a cubic equation in �1,
namely,
</p>
<p>.G2H1 �G1H2/�31 C .G3H1 �G1H3/�21 CG4H1�1 CG5H1 D 0 (10.19a)</p>
<p/>
</div>
<div class="page"><p/>
<p>434 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Likewise, if Eq. (10.17) is multiplied byH1�1CH2 and Eq. (10.18) byG1�31CG2�21
and the equations thus resulting are subtracted from each other, one more cubic
equation in �1 is obtained, namely,
</p>
<p>.G1H3 �G3H1/�31 C .G4H1 CG3H2 �G2H3/�21
C.G5H1 CG4H2/�1 CG5H2 D 0 (10.19b)
</p>
<p>Moreover, if we multiply Eq. (10.18) by �1, a third cubic equation in �1 can be
derived, i.e.,
</p>
<p>H1�
3
1 CH2�21 CH3�1 D 0 (10.19c)
</p>
<p>Now, Eqs. (10.18) and (10.19a&ndash;c) constitute a homogeneous linear system of four
equations in the first four powers of �1, which can be cast in the form
</p>
<p>H�1 D 0 (10.20)
</p>
<p>where �1 �
�
</p>
<p>�31 �
2
1 �1 1
</p>
<p>�T
and
</p>
<p>H �
</p>
<p>2
</p>
<p>6
6
4
</p>
<p>G2H1 �G1H2 G3H1 �G1H3 G4H1 G5H1
G3H1 �G1H3 G3H2 �G2H3 CG4H1 G4H2 CG5H1 G5H2
</p>
<p>H1 H2 H3 0
</p>
<p>0 H1 H2 H3
</p>
<p>3
</p>
<p>7
7
5
</p>
<p>In order for Eq. (10.20) to admit a nontrivial solution, the determinant of its
coefficient matrix must vanish, i.e.,
</p>
<p>det.H/ D 0 (10.21)
</p>
<p>Given the definitions of fGkg51 and fHkg31, it is apparent that G1, G3, and G5 are
quartic, while G2 and G4 are cubic polynomials in �2. Likewise, H1 and H3 are
quadratic, while H2 is linear in �2 as well. As a result, the highest-degree entries of
the first and second rows of H are sextic, while those of its third and fourth rows are
quadratic. The outcome is that det.H/ is of degree 6C6C2C2 D 16, i.e., det.H/ is
a 16th-degree polynomial in �2. This equation, in general, admits up to 16 different
solutions. Furthermore, the roots of the polynomial appear in the form of either
complex conjugate pairs or real pairs. In the latter case, each pair represents two
symmetric positions of the mobile platform with respect to the base, i.e., for each
solution found above the base, another, mirror-imaged, solution exists below it. This
symmetry exists, in general, as long as the six base attachment points are coplanar.
</p>
<p>Other parallel manipulators are the planar and spherical counterparts of that stud-
ied above, and sketched in Figs. 10.8 and 10.9. The direct kinematics of the manip-
ulator of Fig. 10.8 was found to admit up to six real solutions (Gosselin et al. 1992),</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 435
</p>
<p>Fig. 10.8 A planar parallel manipulator
</p>
<p>Fig. 10.9 A spherical parallel manipulator
</p>
<p>while the spherical manipulator of Fig. 10.9 has been found to admit up to eight
direct kinematic solutions (Gosselin et al. 1994a,b). A comprehensive account of the
simulation and design of three-dof spherical parallel manipulators, which includes
workspace analysis as well, is included in (Gosselin et al. 1995).</p>
<p/>
</div>
<div class="page"><p/>
<p>436 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>10.2.1 Velocity and Acceleration Analyses
</p>
<p>of Parallel Manipulators
</p>
<p>Now we proceed to the velocity analysis of the manipulator of Fig. 10.2a. The
inverse velocity analysis of this manipulator consists in determining the six rates
of the active joints, f Pbk g61, given the twist t of the moving platform. The velocity
analysis of a typical leg leads to a relation of the form of Eq. (5.9), namely,
</p>
<p>JJ P�J D tJ ; J D I; II; : : : ; VI (10.22a)
</p>
<p>where JJ is the Jacobian of the J th leg, P�J is the six-dimensional joint-rate vector
of the same leg, and tJ is the twist of the moving platform M, with its operation
point defined as the point CJ of concurrency of the three revolutes composing the
spherical joint of attachment of the leg to the moving platform M, and shown in
Fig. 10.3 as C , subscript J indicating that point C of that figure is different for
different legs. We thus have
</p>
<p>JJ �
�
</p>
<p>e1 e2 0 e4 e5 e6
</p>
<p>b34e1 � e3 b34e2 � e3 e3 0 0 0
</p>
<p>�
</p>
<p>J
</p>
<p>(10.22b)
</p>
<p>tJ D
�
</p>
<p>!
</p>
<p>PcJ
</p>
<p>�
</p>
<p>; b34 � b3 C b4 (10.22c)
</p>
<p>where the leg geometry has been taken into account.
Furthermore, from Fig. 10.3, it is apparent that
</p>
<p>PcJ D Pp �! � rJ (10.23)
</p>
<p>with rJ defined as the vector directed from CJ to the operation point P of the
moving platform.
</p>
<p>Now, we regard the axes of the five revolute joints of the six-joint leg of Fig. 10.3
as a set of five zero-pitch screws S D fs1; s2; s4; s5; s6g. The line passing throughO1
and C is a zero-pitch screw s3 reciprocal to S , as shown below:
</p>
<p>Since s3 passes through O1, its moment with respect to this point vanishes, and
hence,
</p>
<p>s3 D
�
</p>
<p>e3
</p>
<p>0
</p>
<p>�
</p>
<p>Now it is simple matter to show that
</p>
<p>sT3 &#128;sk D .&#128;s3/T sk D 0 for k D 1; 2; 4; 5; 6 (10.24)
</p>
<p>and &#128; given in Eq. (3.112), q.e.d.</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 437
</p>
<p>Notice that, for the J th leg,
</p>
<p>&#128;s3 D
�
</p>
<p>0
</p>
<p>e3
</p>
<p>�
</p>
<p>J
</p>
<p>� lJ
</p>
<p>and hence, on the one hand,
</p>
<p>lTJ JJ
P�J D . Pb3/J
</p>
<p>where the subscript J reminds us that Pb3 is different for each leg. In order to ease
the notation, and since we have a single variable b3 per leg, we define henceforth
</p>
<p>bJ � .b3/J (10.25a)
</p>
<p>and hence, the above relation between tJ and the actuated joint rate of the J th leg
takes the form
</p>
<p>lTJ JJ
P�J D PbJ (10.25b)
</p>
<p>On the other hand,
</p>
<p>lTJ tJ D .eT3 /J PcJ
</p>
<p>Likewise, we define
</p>
<p>.e3/J � eJ (10.26a)
</p>
<p>the foregoing relation thus yielding
</p>
<p>lTJ tJ � eTJ PcJ (10.26b)
</p>
<p>Note that vectors eJ and rJ define uniquely the line along the two attachment points
of the J th leg. Henceforth, this line will be termed the axis of the J th leg.
</p>
<p>Upon equating the right-hand sides of Eqs. (10.25b) and (10.26b), the desired
expression for the actuated joint rate is derived, namely,
</p>
<p>PbJ D eTJ PcJ ; J D I; II; : : : ; VI (10.27a)
</p>
<p>That is, the J th joint rate is nothing but the projection onto the J th leg axis of the
velocity of point CJ . Furthermore, upon substituting Eq. (10.23) into Eq. (10.27a)
above, we obtain the relations between the actuated joint rates and the twist of the
moving platform, namely,
</p>
<p>PbJ D
�
</p>
<p>.eJ � rJ /T eTJ
�
�
</p>
<p>!
</p>
<p>Pp
</p>
<p>�
</p>
<p>� kTJ t (10.27b)</p>
<p/>
</div>
<div class="page"><p/>
<p>438 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>for J D I; II; : : : ; VI . Upon assembling all six leg-equations of Eq. (10.27b), we
obtain the desired relation between the vector of actuated joint rates and the twist of
the moving platform, namely,
</p>
<p>Pb D Kt (10.28a)
</p>
<p>with the six-dimensional vectors b and t defined as the vector of joint variables and
the twist of the platform at the operation point, respectively. Moreover, the 6 � 6
matrix K is the Jacobian of the manipulator at hand. These quantities are displayed
below:
</p>
<p>b �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>bI
bII
:::
</p>
<p>bVI
</p>
<p>3
</p>
<p>7
7
7
5
; t �
</p>
<p>�
</p>
<p>!
</p>
<p>Pp
</p>
<p>�
</p>
<p>; K �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>.eI � rI /T eTI
.eII � rII /T eTII
</p>
<p>:::
</p>
<p>.eVI � rVI /T eTVI
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(10.28b)
</p>
<p>From the above display, it is apparent that each row of K is the transpose of the
Pl&uuml;cker array of the corresponding leg axis, although in axis coordinates, as opposed
to the Jacobian matrix J of serial manipulators, whose columns are the Pl&uuml;cker
coordinates of the corresponding joint axis in ray coordinates. Moreover, in these
coordinates, the moment of the leg-axis is taken with respect to the operation point
P of M. One more difference between the velocity analysis of serial and parallel
manipulators is the role played by the actuator joint rates in the underlying forward
and direct kinematics. In the case of parallel manipulators, this role is changed, for
now we have that the actuator joint rates are given by explicit formulas in terms
of the twist of the moving platform, along with the manipulator architecture and
configuration. Finding the platform twist requires inverting matrix K. Moreover,
the significance of singularities also changes: When K becomes singular, some
instantaneous motions of the platform are possible even if all actuated joints are
kept locked. That is, a singularity of K is to be interpreted now as the inability of
the manipulator to withstand a certain static wrench. An extensive analysis of the
singularities of parallel manipulators using line geometry in a form that is known as
Grassmann geometry was reported by Merlet (1989).
</p>
<p>Now, the acceleration analysis of the same leg is straightforward. Indeed, upon
differentiation of both sides of Eq. (10.28a) with respect to time, one obtains
</p>
<p>Rb D KPtC PKt (10.29a)
</p>
<p>where PK takes the form
</p>
<p>PK D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>PuTI PeTI
PuTII PeTI
:::
</p>
<p>PuTVI PeTVI
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(10.29b)</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 439
</p>
<p>and uJ is defined as
</p>
<p>uJ � eJ � rJ (10.29c)
</p>
<p>Therefore,
</p>
<p>PuJ D PeJ � rJ C eJ � PrJ (10.29d)
</p>
<p>Now, since vectors rJ are fixed to the moving platform, their time-derivatives are
simply given by
</p>
<p>PrJ D ! � rJ (10.29e)
</p>
<p>On the other hand, vector eJ is directed along the leg axis, and so, its time-derivative
is given by
</p>
<p>PeJ D !J � eJ
</p>
<p>with !J defined as the angular velocity of the third leg link, i.e.,
</p>
<p>!J D . P�1e1 C P�2e2/J
</p>
<p>the subscript J of the above parentheses reminding us that this angular velocity
differs from leg to leg. Clearly, we need expressions for the rates of the first two
joints of each leg. Below we derive the corresponding expressions. In order to
simplify the notation, we start by defining
</p>
<p>fJ � .e1/J ; gJ � .e2/J (10.29f)
</p>
<p>Now we write the second vector equation of Eq. (10.22a) using the foregoing
definitions, which yields
</p>
<p>. P�1/J fJ � .bJ C b4/eJ C . P�2/J gJ � .bJ C b4/eJ C PbJ eJ D PcJ
</p>
<p>where b4 is the same for all legs, since all have identical architectures. Now we can
eliminate . P�2/J from the foregoing equation by dot-multiplying its two sides by gJ ,
thereby producing
</p>
<p>. P�1/J gJ � fJ � .bJ C b4/eJ C gTJ .eJ eTJ /PcJ D gT PcJ
</p>
<p>where an obvious exchange of the cross and the dot in the above equation has taken
place, and expression (10.27a) for PbJ has been recalled. Now it is a simple matter
to solve for . P�1/J from the above equation, which yields
</p>
<p>. P�1/J D �
gTJ .1 � eJ eTJ /PcJ
</p>
<p>&#129;J</p>
<p/>
</div>
<div class="page"><p/>
<p>440 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>with &#129;J defined as
</p>
<p>&#129;J � .bJ C b4/eJ � fJ � gJ (10.30)
</p>
<p>Moreover, we can obtain the above expression for . P�1/J in terms of the platform
twist by recalling Eq. (10.23), which is reproduced below in a more suitable form
for quick reference:
</p>
<p>PcJ D CJ t
</p>
<p>where t is the twist of the platform, the 3 � 6 matrix CJ being defined as
</p>
<p>CJ �
�
</p>
<p>RJ 1
�
</p>
<p>in which RJ is the cross-product matrix of rJ and 1 is the 3 � 3 identity matrix.
Therefore, the expression sought for . P�1/J takes the form
</p>
<p>. P�1/J D �
1
</p>
<p>&#129;J
gTJ .1 � eJ eTJ /CJ t; J D I; II; : : : ; VI (10.31a)
</p>
<p>A similar procedure can be followed to find . P�2/J , the final result being
</p>
<p>. P�2/J D
1
</p>
<p>&#129;J
fTJ .1 � eJ eTJ /CJ t; J D I; II; : : : ; VI (10.31b)
</p>
<p>thereby completing the calculations required to obtain the rates of all unactuated
joints. Note that the unit vectors involved in those calculations, eJ , fJ , and gJ , are
computed from the leg inverse kinematics, as discussed above.
</p>
<p>Planar and Spherical Manipulators
</p>
<p>The velocity analysis of the planar and spherical parallel manipulators of Figs. 10.8
and 10.9 are outlined below: Using the results of Sect. 5.7.2, the velocity relations
of the J th leg of the planar manipulator take the form
</p>
<p>JJ P�J D t; J D I; II; III (10.32)
</p>
<p>where JJ is the Jacobian matrix of this leg, as given by Eq. (5.60), while P�J is the
three-dimensional vector of joint rates of this leg, i.e.,
</p>
<p>JJ �
�
</p>
<p>1 1 1
</p>
<p>ErJ1 ErJ2 ErJ3
</p>
<p>�
</p>
<p>; P�J �
</p>
<p>2
</p>
<p>4
</p>
<p>P�J1
P�J2
P�J3
</p>
<p>3
</p>
<p>5 ; J D I; II; III</p>
<p/>
</div>
<div class="page"><p/>
<p>10.2 Kinematics of Parallel Manipulators 441
</p>
<p>For purposes of kinematic velocity control, however, we are interested only in
the first joint rate of each leg; i.e., all we need to determine in order to produce a
desired twist of the end-effector is not all of the foregoing nine joint rates, but only
P�I1, P�II1, and P�III1. Thus, we want to eliminate from Eq. (10.32) the unactuated joint
rates P�J2 and P�J3, which can be readily done if we multiply both sides of the said
equation by a three-dimensional vector nJ perpendicular to the second and the third
columns of JJ . This vector can be most easily determined as the cross product of
those two columns, namely, as
</p>
<p>n � jJ2 � jJ3 D
�
</p>
<p>�rTJ2ErJ3
rJ2 � rJ3
</p>
<p>�
</p>
<p>Upon multiplication of both sides of Eq. (10.32) by nTJ , we obtain
</p>
<p>�
</p>
<p>�rTJ2ErJ3 C .rJ2 � rJ3/TErJ1
� P�J1 D �.rTJ2ErJ3/! C .rJ2 � rJ3/T Pc (10.33)
</p>
<p>and hence, we can solve directly for P�J1 from the foregoing equation, thereby
deriving
</p>
<p>P�J1 D
�.rTJ2ErJ3/! C .rJ2 � rJ3/T Pc
�rTJ2ErJ3 C .rJ2 � rJ3/TErJ1
</p>
<p>(10.34a)
</p>
<p>Note that Eq. (10.33) can be written in the form
</p>
<p>jJ P�J1 D kTJ t; J D I; II; III (10.34b)
</p>
<p>with jJ and kJ defined, for J D I; II; III , as
</p>
<p>jJ � .rJ2 � rJ3/TErJ1 � rTJ2ErJ3;
</p>
<p>kJ �
�
</p>
<p>rTJ2ErJ3 �.rJ2 � rJ3/T
�T
</p>
<p>If we further define
</p>
<p>P� �
� P�I1 P�II2 P�III3
</p>
<p>�T
</p>
<p>and assemble all three foregoing joint-rate-twist relations, we obtain
</p>
<p>J P� D Kt (10.35)
</p>
<p>where J and K are the two manipulator Jacobians defined as
</p>
<p>J � diag.jI ; jII ; jIII /; K �
</p>
<p>2
</p>
<p>4
</p>
<p>kTI
kTII
kTIII
</p>
<p>3
</p>
<p>5 (10.36)
</p>
<p>Expressions for the joint accelerations can be readily derived by differentiation of
the foregoing expressions with respect to time.</p>
<p/>
</div>
<div class="page"><p/>
<p>442 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>The velocity analysis of the spherical parallel manipulator of Fig. 10.9 can be
accomplished similarly. Thus, the velocity relations of the J th leg take on the form
</p>
<p>JJ P�J D !; J D I; II; III (10.37)
</p>
<p>where the Jacobian of the J th leg, JJ , is defined as
</p>
<p>JJ �
�
</p>
<p>eJ1 eJ2 eJ3
�
</p>
<p>while the joint-rate vector of the J th leg, P�J , is defined exactly as in the planar case
analyzed above. Again, for kinematic velocity control purposes, we are interested
only in the actuated joint rates, namely, P�I1, P�II1, and P�III1. As in the planar case,
we can eliminate P�J2 and P�J3 upon multiplication of both sides of Eq. (10.37) by
a vector nJ perpendicular to the second and the third columns of JJ . An obvious
definition of this vector is, then,
</p>
<p>nJ � eJ2 � eJ3
</p>
<p>The desired joint-rate relation is thus readily derived as
</p>
<p>jJ P�J1 D kTJ!; J D I; II; III (10.38)
</p>
<p>where jJ and kJ are now defined as
</p>
<p>jJ � eJ1 � eJ2 � eJ3 (10.39a)
kJ � eJ2 � eJ3 (10.39b)
</p>
<p>The accelerations of the actuated joints can be derived, again, by differentiation of
the foregoing expressions.
</p>
<p>We can then say that in general, parallel manipulators, as opposed to serial ones,
have two Jacobian matrices.
</p>
<p>10.3 Multifingered Hands
</p>
<p>Shown in Fig. 10.10 is a three-fingered hand with fingers A, B, and C, each supplied
with three revolute joints. Furthermore, each finger carries two revolutes of parallel
axes that are normal to the axis of the third one. Thus, each finger comprises three
links, the one closest to the palm P being of virtually zero length and coupled to P
via a revolute joint. Of the other two, that in contact with the object O is the distal
phalanx, the other being the proximal phalanx. Moreover, the fingers can be either
hard or soft; if the latter, then contact takes place over a finite area; if the former, then
contact takes place over a point, and hence, hard fingers can exert only force and no</p>
<p/>
</div>
<div class="page"><p/>
<p>10.3 Multifingered Hands 443
</p>
<p>Fig. 10.10 A three-fingered hand
</p>
<p>moment on the manipulated object. Soft fingers can exert both force and moment.
For the sake of conciseness, we will deal only with hard fingers here. Let the contact
points of fingers A, B, and C with O be denoted by AO , BO , and CO , respectively.
The purpose of the hand is to manipulate O with respect to P . The motion of O,
moreover, can be specified through its pose, given in turn by the position vector o of
one of its points, O , and its orientation matrix Q with respect to a frame fixed to P .
Now, in order to manipulate O six degrees of freedom are needed. When the three
fingers are in contact with O, the hand-object system forms a parallel manipulator
with three &ldquo;legs&rdquo; of theRRS type, with S standing for spherical joint. As the reader
can verify, the system has six-dof, which means that manipulations are possible with
only two actuated revolutes per finger. Many designs involve only two motors per
finger, one of the revolute joints being provided with springs to guarantee contact.
</p>
<p>Thus, the location of the three contact points is fully determined if the pose of
P and the locations of AO , BO , and CO in O are given. Once the position vectors
of the three contact points are known, determining the joint-variable values needed
to take O to the desired pose reduces to solving a three-dimensional positioning
problem for each finger, with three revolute joints&mdash;a problem already discussed
in Sect. 4.4.1. The joint rates and accelerations are then determined as in Sects. 4.4
and 5.5.
</p>
<p>While the mechanics of grasping is quite elaborate, due to the deformation of
both fingers and object, some assumptions will be introduced here to produce a
simple model. One such assumption is rigidity; a second is smoothness, under
which each finger is capable of exerting only normal force on the object. Moreover,
this force is unidirectional, for the finger cannot exert a pull on the object. The
smoothness and rigidity assumptions bring about limitations, for they require a
rather large number of fingers to exert an arbitrary wrench on the grasped object,
as shown below.</p>
<p/>
</div>
<div class="page"><p/>
<p>444 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Fig. 10.11 Geometry of
grasped object O
</p>
<p>We assume that we have a rigid object O bounded by a surface S that is smooth
almost everywhere, i.e., it has a well-defined normal n everywhere except at either
isolated points or isolated curves on S . Below we show that in order to exert an
arbitrary wrench w onto O, a hand with rigid, smooth fingers should have more
than six fingers. Assume that the n contact points on S are fPign1 and that we want
to find n pressure values f�ign1 at the contact points that will produce the desired
wrench w onto O.
</p>
<p>Moreover, let the unit normal at Pi be denoted by ni and the vector directed from
O to Pi be denoted by pi , as shown in Fig. 10.11.
</p>
<p>The wrench wi exerted by each finger onto O at Pi is apparently
</p>
<p>wi D �i
�
</p>
<p>pi � .�ni /
�ni
</p>
<p>�
</p>
<p>; �i � 0
</p>
<p>Upon equating the resultant wrench with the desired wrench, we obtain
</p>
<p>n
X
</p>
<p>1
</p>
<p>�
</p>
<p>�pi � ni
�ni
</p>
<p>�
</p>
<p>�i D w
</p>
<p>or in compact form, as
</p>
<p>G� D �w (10.40a)
</p>
<p>where G is the 6� n grasping matrix and � is the n-dimensional vector of pressure
values, i.e.,
</p>
<p>G �
�
</p>
<p>p1 � n1 � � � pn � nn
n1 � � � nn
</p>
<p>�
</p>
<p>; � �
</p>
<p>2
</p>
<p>6
4
</p>
<p>�1
:::
</p>
<p>�n
</p>
<p>3
</p>
<p>7
5 (10.40b)
</p>
<p>Note that the i th column of the grasping matrix is nothing but the array of Pl&uuml;cker
coordinates of the line of action of the force exerted by the i th finger on the object,
in ray coordinates&mdash;see Sect. 3.2.2.</p>
<p/>
</div>
<div class="page"><p/>
<p>10.3 Multifingered Hands 445
</p>
<p>Thus, for n D 6, a unique pressure vector � is obtained as long as G is
nonsingular. However, negative values of f�ign1 are not allowed, and since nothing
prevents these values from becoming negative, six fingers of the type considered
here are not enough. We must thus have more than six such fingers in order to
be able to apply an arbitrary wrench onto the body. For n &gt; 6 and a full-rank
6�n grasping matrix, nonnegative values of f�ign1 can be generated, but only under
certain conditions, as explained below: Let u be a vector lying in the null space of
G, i.e., such that Gu D 0. Then an arbitrary � can be expressed as
</p>
<p>� D �0 C u
</p>
<p>where �0 is a particular solution of Eq. (10.40a). For example, if �0 is chosen as
the minimum-norm solution of Eq. (10.40a), then we have, explicitly,
</p>
<p>�0 D �G&#142;w
</p>
<p>where G&#142; is the generalized inverse of G, defined as
</p>
<p>G&#142; � GT .GGT /�1
</p>
<p>The numerical computation of the minimum norm solution of an undetermined
system of linear equations is discussed in Appendix B.
</p>
<p>Note that the 6 � 6 product GGT has the general form
</p>
<p>GGT D
�Pn
</p>
<p>1.pi � ni /.pi � ni /T
Pn
</p>
<p>1.pi � ni /nTiPn
1 ni .pi � ni /T ninTi
</p>
<p>�
</p>
<p>Although a symbolic expression for the inverse H of GGT is not possible in the
general case, we can always express this inverse in block form, with all blocks of
3 � 3, namely,
</p>
<p>H � .GGT /�1 D
�
</p>
<p>H11 H12
</p>
<p>HT12 H22
</p>
<p>�
</p>
<p>where consistently, H11 has units of meter�2, H12 has units of meter�1, and H22 is
dimensionless. Moreover, we can partition G into two 3 � n blocks, i.e.,
</p>
<p>G �
�
</p>
<p>A
</p>
<p>B
</p>
<p>�
</p>
<p>in which A has units of meter, while B is dimensionless. Hence, the product GTH
takes on the form
</p>
<p>GTH D
�
</p>
<p>ATH11 C BTHT12 ATH12 C BTH22
�</p>
<p/>
</div>
<div class="page"><p/>
<p>446 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>and hence, the left-hand block of the foregoing product has units of meter�1, while
the right-hand block is dimensionless. Upon multiplying the desired wrench w from
the left by this product, the result, �0, has consistently units of Newton.
</p>
<p>Now, to find u, several numerical methods are available that do not require
any matrix inversion (Golub and Van Loan 1989). A simple way of expressing u,
although by no means the way to compute it, is given by
</p>
<p>u D Pv; P � 1 �G&#142;G
</p>
<p>where v is an n-dimensional vector and P is a matrix projecting v onto the null space
of G, and 1 defined as the n � n identity matrix. Now we are left with the task of
finding v so that
</p>
<p>�i D �0i C ui � 0; i D 1; : : : ; n
</p>
<p>Hence, our policy to determine u is simply, for i D 1; : : : ; n,
</p>
<p>ui D
�
</p>
<p>0; if �0i � 0I
��0i ; otherwise:
</p>
<p>Further, v is found upon solving
</p>
<p>Pv D u
</p>
<p>However, P is singular&mdash;its rank is n � 6, as the reader is invited to prove&mdash;and the
above equation may or may not admit a solution. For a solution to be possible, u
must lie in the null space of G.
</p>
<p>A more general approach to solving the grasping problem relies on linear
programming, but this topic lies beyond the scope of the book. The interested reader
is directed to the specialized literature on the subject (Hillier and Lieberman 1995).
</p>
<p>In the presence of soft fingers, however, fewer than six fingers suffice to grasp an
object. Moreover, in the presence of friction, the force transmitted by a finger has,
in addition to its normal component, a tangential component that, hence, gives rise
to a contact force making a nonzero angle with the normal ni to the object surface at
the i th contact point. Therefore, by virtue of the linear relation between the normal
and the tangential components of the transmitted force, given by the coefficient of
friction �, this force is constrained to lie within the friction cone. This cone has its
apex at the contact point Pi , its elements making an angle ˛ with the normal, that
is given by ˛ D arctan.�/. Furthermore, by virtue of the fundamental assumption
of Coulomb friction analysis, � lies between 0 and 1, and hence, ˛ is constrained to
lie between 0ı and 45ı.
</p>
<p>Shown in Fig. 10.12 is an example of a three-fingered hand. This hand was
developed at the Katholieke Universiteit Leuven (Van Brussel et al. 1989).</p>
<p/>
</div>
<div class="page"><p/>
<p>10.4 Walking Machines 447
</p>
<p>Fig. 10.12 A prototype of
the KU Leuven three-fingered
hand (courtesy of Prof. H.
Van Brussel)
</p>
<p>The literature on multifingered hands and the problem of grasping is far richer
than we can afford to describe here. Extensive studies on these subjects have been
reported by Reynaerts (1995) and Teichmann (1995).
</p>
<p>10.4 Walking Machines
</p>
<p>Besides the walking machines introduced in Chap. 1, namely, the OSU Adaptive
Suspension Vehicle and the TUM Hexapod, other legged machines or leg designs
are emerging with special features. For example, CARL, shown in Fig. 10.13,
is a compliant articulated robot leg that was designed at McGill University&rsquo;s
Centre for Intelligent Machines (CIM) by Prof. Buehler and his team (Menitto and
Buehler 1996). This leg contains an actuation package with a high load-carrying
capacity (ATLAS) and an antagonistic pair of concentric translational-to-angular
displacement devices. The leg has four degrees of freedom, of which two are
actuated by ATLAS and one by a harmonic drive motor, while one is unactuated.
This leg design is intended to provide locomotion to a quadruped.
</p>
<p>As nature shows in mammals, four legs are necessary to guarantee the static
equilibrium of the body while one leg is in the swing phase. Static equilibrium is
achieved as long as the horizontal projection of the mass center of the overall body-
legs system lies within the triangle defined by the contact points of the three legs
that are in the stance phase. More than four legs would allow for greater mobility.
For purposes of symmetry, some walking machines are designed as hexapods, so as
to allow for an equal number of legs in the swing and the stance phases.</p>
<p/>
</div>
<div class="page"><p/>
<p>448 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Fig. 10.13 The compliant
articulated robot leg (courtesy
of Prof. M. Buehler)
</p>
<p>Fig. 10.14 A general hexapod
</p>
<p>The kinematic analysis of walking machines is possible using the hexapod
displayed in Fig. 10.14.
</p>
<p>Furthermore, contact with the ground is assumed to take place such that the
ground can exert only a &ldquo;pushing&rdquo; force on each leg but no moment. Thus, while
we can model the contact between leg and ground as a spherical joint, care must be
taken so that no pulls of the ground on the leg are required for a given gait.</p>
<p/>
</div>
<div class="page"><p/>
<p>10.4 Walking Machines 449
</p>
<p>Fig. 10.15 One of the legs of a walking machine with three actuated revolutes
</p>
<p>Fig. 10.16 One of the six
identical legs of the TU
Munich Hexapod (courtesy of
Prof. F. Pfeiffer. Reproduced
with permission of TSI
Enterprises, Inc.)
</p>
<p>Additionally, we shall assume that the leg is actuated by three revolutes, namely,
those with variables �4, �5, and �6 in Fig. 10.15, where G denotes the ground and
B the machine body. A photograph of one of the six identical legs of the walking
machine developed at the Technical University of Munich, introduced in Fig. 1.11, is
included in Fig. 10.16. The Denavit&ndash;Hartenberg parameters of this leg, proceeding
from the ground upwards, are displayed in Table 10.3. Note that the architecture of
this leg is simply that of a three-revolute manipulator carrying a spherical joint at
its end-effector, similar to that of the decoupled manipulators studied in Sect. 4.4.</p>
<p/>
</div>
<div class="page"><p/>
<p>450 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Table 10.3 DH parameters
of the leg of the TU-Munich
walking machine
</p>
<p>i ai (mm) bi (mm) ˛i
1 17 0 90ı
</p>
<p>2 123 0 180ı
</p>
<p>3 116 0 0ı
</p>
<p>4 0 0 90ı
</p>
<p>5 0 0 90ı
</p>
<p>6 0 0 0ı
</p>
<p>The spherical joint accounts for the coupling of the leg with the ground. We are thus
assuming that when a leg is in contact with the ground, the contact point of the leg
is immobile. At the same time, the motion of the body B is prescribed through the
motion of a point on the axis of the revolute coupled to the body. Such a point is
indicated by PJ for the J th leg. Moreover, the point of the J th leg in contact with
the ground will be denoted by OJ . Thus, when prescribing the motion of the body
through that of each of the six points PI , PII , : : :, PVI , the rigid-body compatibility
conditions of Eqs. (8.14), (8.15), and (8.28) must be observed. The pose of the body
B is thus specified by the position of a point C of the body and the orientation
matrix Q of the body with respect to a frame fixed to the ground, the position vector
of C in that frame being denoted by c. The specification of points PI to PVI thus
follows from the knowledge of c and Q, thereby guaranteeing compliance with the
above-mentioned constraints.
</p>
<p>Furthermore, a maneuver of B, given by a prescribed pose, can be achieved by
suitable values of the actuated-joint variables, which thus leads to a problem of
parallel-manipulator inverse kinematics.
</p>
<p>The mechanical system that results from the kinematic coupling of the machine
legs with the ground is thus equivalent to a parallel manipulator. The essential
difference between a walking machine and a parallel manipulator is that the former
usually involves more actuators than degrees of freedom. This feature is known as
redundant actuation and will not be pursued here.
</p>
<p>10.5 Rolling Robots
</p>
<p>Probably the rolling robot that has received most media attention is NASA&rsquo;s
Sojourner, of the Pathfinder mission, which explored a spot of the Martian
landscape for several months in 1997. It is noteworthy that the Sojourner was
designed, built, and commissioned with a shoestring budget for NASA standards.
The Sojourner is a paradigm of rolling robots for autonomous operation on rough
terrain. We focus here on the simplest robots of this class, i.e., robots intended
for tasks on horizontal surfaces, and so, their platforms undergo planar motion,
which greatly simplifies their kinematics. One special feature of rolling robots is
their nonholonomic nature. What this means is that the minimum number m of
generalized coordinates defining uniquely a posture of the system is greater than</p>
<p/>
</div>
<div class="page"><p/>
<p>10.5 Rolling Robots 451
</p>
<p>a b
</p>
<p>Fig. 10.17 A two-dof rolling robot: (a) its general layout; and (b) a detail of its actuated wheels
</p>
<p>the number n of their independent generalized speeds, i.e., m &gt; n. In the case
of serial and parallel manipulators, paradigms of holonomic systems, m D n.
In nonholonomic systems, then, we must distinguish between their posture, or
configuration degree of freedom and their mobility, or velocity degree of freedom.
For the sake of conciseness, we will refer to the latter whenever we mention the
degree of freedom of a rolling robot.
</p>
<p>Rolling robots are basically of two kinds, depending on whether they are
supplied with conventional or with omnidirectional wheels. The simplest robots
with conventional wheels are capable only of two-dof motions, and hence, are
kinematically equivalent to conventional terrestrial vehicles. However, robots with
omnidirectional wheels (ODWs) are capable of three-dof motions, which increases
substantially their maneuverability. Below we outline the kinematics of the two
kinds of robots.
</p>
<p>10.5.1 Robots with Conventional Wheels
</p>
<p>We begin with robots rolling on conventional wheels. Since these have two degrees
of freedom, they need only two actuators, the various designs available varying
essentially in where these actuators are located. The basic architecture of this kind
of robot is displayed in Fig. 10.17a, in which we distinguish a chassis, or robot body,
depicted as a triangular plate in that figure: two coaxial wheels that are coupled to
the chassis by means of revolutes of axes passing through points O1 and O2; and a
third wheel mounted on a bracket.</p>
<p/>
</div>
<div class="page"><p/>
<p>452 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Now, the two actuators can be placed in two essentially different arrays. In the
first array, not shown in the figure, one actuator is used for propulsion and the other
for steering, the former being used to provide locomotion power to the common two-
wheel axle via a differential gear train. This train is required to allow for different
angular velocities of the two coaxial wheels. Moreover, the orientation of the mid-
plane of the steering wheel, defined by angle  , is controlled with the second
actuator. This design has some drawbacks, namely, (a) the two motors serving two
essentially different tasks call for essentially different operational characteristics,
to the point that both may not be available from the same manufacturer; (b) the
propulsion motor calls for velocity control, the steering motor for position control,
thereby giving rise to two independent control systems that may end up by operating
in an uncoordinated fashion; and finally, (c) the use of a differential gear train
increases cost, weight, and brings about the inherent backlash of gears.
</p>
<p>In the second actuation array, shown in Fig. 10.17b, the two coaxial wheels
are powered independently, thereby doing away with the differential train and
its undesirable side effects, the third wheel being an idle caster. Moreover, the
orientation of the latter is determined by friction and constraint forces, thereby
making unnecessary the steering control system of the first array. Below we analyze
the kinematics of a robot with this form of actuation.
</p>
<p>Let pointC of the platform be the operation point, its projection onto a horizontal
plane H containing the common axis of the two actuated wheels being C 0, as
indicated in Fig. 10.17b. Let, moreover, the position vector of C 0 in a frame fixed
to the ground, with origin lying in H, be denoted by c. Additionally, let ! be the
scalar angular velocity of the platform about a vertical axis. By virtue of the two-dof
motion of this robot, we can control either the velocity Pc of C&mdash;or of C 0 for that
matter&mdash;or a combination of ! and a scalar function of Pc by properly specifying the
two joint rates P�1 and P�2. However, we cannot control the two components of Pc and
! simultaneously.
</p>
<p>In order to proceed with the kinematic analysis of the system at hand, we
define an orthonormal triad of vectors whose orientation is fixed with respect to
the chassis. Let this triad be denoted by f i; j; k g, with k pointing in the upward
vertical direction. Thus, the velocities Poi of points Oi , for i D 1; 2, are given by
</p>
<p>Poi D r P�i j; i D 1; 2 (10.41a)
</p>
<p>Furthermore, the velocity of C can now be written in two-dimensional form as
</p>
<p>Pc D Poi C !E.c � oi /; i D 1; 2 (10.41b)
</p>
<p>with E defined as in Eq. (5.55). Thus, all vectors of Eq. (10.41b) are two-
dimensional. Substituting Eq. (10.41a) into Eq. (10.41b) and subtracting sidewise
Eq. (10.41b) for i D 1 and for i D 2, we derive
</p>
<p>Œr. P�1 � P�2/ � !l&#141; j D 02</p>
<p/>
</div>
<div class="page"><p/>
<p>10.5 Rolling Robots 453
</p>
<p>Hence, the angular velocity ! of line O1O2 in planar motion, which is the same as
that of the platform, can be readily expressed as
</p>
<p>! D r
l
. P�1 � P�2/ (10.41c)
</p>
<p>its positive direction being that of k. Upon substitution of Eqs. (10.41a and b) into
Eq. (10.41b), we obtain expressions for Pc in terms of the joint rates, similar to
Eqs. (10.41b), for i D 1; 2. Furthermore, upon adding sidewise the two expressions
thus resulting, we obtain Pc in the desired form, namely,
</p>
<p>Pc D ar
l
. P�1 � P�2/iC
</p>
<p>r
</p>
<p>2
. P�1 C P�2/j (10.41d)
</p>
<p>Equations (10.41c and d) express now the differential direct kinematics relations
of the robot under study. In compact form, these relations become
</p>
<p>t D L P�a (10.41e)
</p>
<p>with the 3 � 2 matrix L defined as
</p>
<p>L �
�
</p>
<p>r=l �r=l
.ar=l/iC .r=2/j �.ar=l/iC .r=2/j
</p>
<p>�
</p>
<p>(10.41f)
</p>
<p>Moreover, the planar twist t of the platform and the two-dimensional vector P�a of
actuated joint rates are defined as
</p>
<p>t �
�
</p>
<p>!
</p>
<p>Pc
</p>
<p>�
</p>
<p>; P�a �
� P�1
P�2
</p>
<p>�
</p>
<p>(10.41g)
</p>
<p>Computing the joint rates from the foregoing equations, i.e., solving the asso-
ciated inverse kinematics problem, is now a trivial task. The inverse kinematics
relations are computed below by noticing that Eq. (10.41c) provides a relation for
the joint-rate difference. Thus, all we need now is a second equation for the joint-
rate sum. By inspection of Eq. (10.41d), it is apparent that we can derive this relation
by dot-multiplying both sides of this equation by j, thereby obtaining
</p>
<p>Pc � j D r
2
. P�1 C P�2/ (10.42)
</p>
<p>The two equations (10.41c) and (10.42) can now be cast into the usual form
</p>
<p>J P�a D Kt (10.43a)</p>
<p/>
</div>
<div class="page"><p/>
<p>454 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>where the two robot Jacobians J and K are given below:
</p>
<p>J �
�
</p>
<p>1 �1
1 1
</p>
<p>�
</p>
<p>; K �
�
</p>
<p>.l=r/ 0T
</p>
<p>0 .2=r/jT
</p>
<p>�
</p>
<p>(10.43b)
</p>
<p>Note that J is a 2 � 2 matrix, but K is a 2 � 3 matrix.
The inverse kinematics relations are readily derived from Eq. (10.43a), namely,
</p>
<p>P�1 D
1
</p>
<p>2
</p>
<p>�
l
</p>
<p>r
! C 2
</p>
<p>r
Py
�
</p>
<p>P�2 D �
1
</p>
<p>2
</p>
<p>�
l
</p>
<p>r
! � 2
</p>
<p>r
Py
�
</p>
<p>where Py � Pc � j.
Now, in order to complete the kinematic analysis of the robot at hand, we
</p>
<p>calculate the rates of the unactuated joints, P�3 and P . To this end, let !i , for
i D 1; 2; 3, and Po3 denote the three-dimensional angular velocity vector of the i th
wheel and the three-dimensional velocity vector of the center of the caster wheel.
Likewise, !4 denotes the scalar angular velocity of the bracket.
</p>
<p>We thus have, for the angular velocity vectors of the two actuated wheels,
</p>
<p>!1 D � P�1iC !k D � P�1iC
r
</p>
<p>l
. P�1 � P�2/k
</p>
<p>D
�
</p>
<p>�iC .r=l/k �.r=l/k
�
� P�1
P�2
</p>
<p>�
</p>
<p>(10.44a)
</p>
<p>!2 D � P�2iC !k D � P�2iC
r
</p>
<p>l
. P�1 � P�2/k
</p>
<p>D
�
</p>
<p>.r=l/k �i � .r=l/k
�
� P�1
P�2
</p>
<p>�
</p>
<p>(10.44b)
</p>
<p>In the ensuing derivations, we will need the velocities of the centers of the two
actuated wheels, which were derived in Eq. (10.41a). Moreover, the angular velocity
of the caster wheel can be readily written in the frame fixed to the bracket,
f e3; f3; k g, namely,
</p>
<p>!3 D P�3e3 C .! C P /k (10.45)
</p>
<p>with  denoting the angle between vectors j and e3 of Fig. 10.17a, measured in the
positive direction of k, as indicated in the layout of Fig. 10.18.
</p>
<p>Note that vector e3 is parallel to the axis of rolling of the caster wheel, while f3 is
a horizontal vector perpendicular to e3. These two sets of unit vectors are related by
</p>
<p>e3 D � sin iC cos j (10.46a)
f3 D � cos i � sin j (10.46b)</p>
<p/>
</div>
<div class="page"><p/>
<p>10.5 Rolling Robots 455
</p>
<p>Fig. 10.18 Layout of the unit
vectors fixed to the platform
and to the bracket
</p>
<p>their inverse relations being
</p>
<p>i D � sin e3 � cos f3 (10.46c)
j D cos e3 � sin f3 (10.46d)
</p>
<p>Furthermore, the velocity of the center of the caster wheel is derived as
</p>
<p>Po3 D !3 � rk D �r P�3f3
</p>
<p>while the scalar angular velocity of the bracket, !4, is given by
</p>
<p>!4 D ! C P D
r
</p>
<p>l
. P�1 � P�2/C P (10.47)
</p>
<p>In Chap. 12 we shall need Pc in bracket coordinates. Such an expression is obtained
from Eqs. (10.41d) and (10.46c and d), namely,
</p>
<p>Pc D Œ�ar
l
. P�1 � P�2/ sin C
</p>
<p>r
</p>
<p>2
. P�1 C P�2/ cos &#141;e3
</p>
<p>�Œa r
l
. P�1 � P�2/ cos C
</p>
<p>r
</p>
<p>2
. P�1 C P�2/ sin &#141;f3 (10.48)
</p>
<p>Expressions for the dependent rates in terms of the independent ones, P�1 and P�2,
are readily derived. To this end, we express the velocity of P in two independent
forms, one in terms of the velocity of O3 and the other in terms of the velocity of
C , i.e.,
</p>
<p>Pp D Po3 C !4k � .p � o3/ (10.49a)
Pp D PcC !k � .�bj/ (10.49b)</p>
<p/>
</div>
<div class="page"><p/>
<p>456 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Upon equating the right-hand sides of the above equations, we obtain a three-
dimensional vector equation relating dependent with independent rates, namely,
</p>
<p>�r P�3f3 C .! C P /k � .p � o3/ D PcC b!i
</p>
<p>where we have recalled the expressions derived above for Po3 and !4. Further, we
rewrite the foregoing equation with the unknown rates, P�3 and P , on the left-hand
side, i.e.,
</p>
<p>� r P�3f3 C P k � .p � o3/ D PcC b!i � !k � .p � o3/ (10.50)
</p>
<p>Moreover, we note that, from Fig. 10.17,
</p>
<p>p � o3 D �d f3 C .h � r/k
</p>
<p>and hence,
</p>
<p>k � .p � o3/ D de3
</p>
<p>Equation (10.50) thus becoming
</p>
<p>� r P�3f3 C P de3 D PcC !.bi � de3/ (10.51)
</p>
<p>Now it is a simple matter to solve for P�3 and P from Eq. (10.51). Indeed, we solve
for P�3 by dot-multiplying both sides of the above equation by f3. Likewise, we solve
for P by dot-multiplying both sides of the same equation by e3, thus obtaining
</p>
<p>� r P�3 D Pc � f3 C !bi � f3
d P D Pc � e3 C !.bi � e3 � d/
</p>
<p>Now, by recalling the expressions derived above for ! and Pc, we obtain
</p>
<p>Pc � f3 D �a
r
</p>
<p>l
. P�1 � P�2/ cos �
</p>
<p>r
</p>
<p>2
. P�1 C P�2/ sin 
</p>
<p>Pc � e3 D �a
r
</p>
<p>l
. P�1 � P�2/ sin C
</p>
<p>r
</p>
<p>2
. P�1 C P�2/ cos 
</p>
<p>i � f3 D � cos ; i � e3 D � sin 
</p>
<p>Therefore,
</p>
<p>P�3 D ˛ cos . P�1 � P�2/C
1
</p>
<p>2
.sin /. P�1 C P�2/ (10.52a)
</p>
<p>P D �
�
</p>
<p>�.˛ sin C ı/. P�1 � P�2/C
1
</p>
<p>2
.cos /. P�1 C P�2/
</p>
<p>�
</p>
<p>(10.52b)</p>
<p/>
</div>
<div class="page"><p/>
<p>10.5 Rolling Robots 457
</p>
<p>a b
</p>
<p>Fig. 10.19 (a) The Mekanum Wheel; (b) its side view
</p>
<p>with the definitions given below:
</p>
<p>˛ � aC b
l
</p>
<p>; ı � d
l
; � � r
</p>
<p>d
(10.53)
</p>
<p>Hence, if we let P�u � Œ P�3 P &#141;T be the vector of unactuated joint rates, then
we have
</p>
<p>P�u D &sbquo; P�a (10.54a)
</p>
<p>with&sbquo; defined as
</p>
<p>&sbquo; �
�
</p>
<p>˛ cos C .sin /=2 �˛ cos C .sin /=2
�Œ�˛ sin C .cos /=2 � ı&#141; �Œ˛ sin C .cos /=2C ı&#141;
</p>
<p>�
</p>
<p>(10.54b)
</p>
<p>thereby completing the intended kinematic analysis.
</p>
<p>10.5.2 Robots with Omnidirectional Wheels
</p>
<p>In general, omnidirectional wheels (ODWs) allow for two independent translational
motions on the supporting floor and one independent rotational motion about a
vertical axis. Based on the shapes of the wheels, moreover, ODWs can be classified
into spherical wheels and Mekanum wheels, the latter also being known as ilonators.
Spherical wheels have been extensively investigated in the literature (West and
Asada 1995). We focus here on ODWs of the Mekanum type and assume that the
robot of interest is equipped with n of these.
</p>
<p>The Mekanum wheel bears a set of rollers mounted along the periphery of the
wheel hub at a given angle, as shown in Fig. 10.19a. Furthermore, the rollers are
shaped so that the wheel appears as circular on its side view, as shown in Fig. 10.19b,</p>
<p/>
</div>
<div class="page"><p/>
<p>458 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Fig. 10.20 The active roller
of the i th wheel
</p>
<p>in order to ensure a smooth motion. Pairwise orthogonal unit vectors ei , fi and gi ,
hi are defined on the middle horizontal planes of the wheel hub and of the roller
in contact with the floor, respectively. This roller is termed active in the discussion
below. Now we aim at finding the kinematic relation between the wheel joint rates
f P�i gn1 and the Cartesian velocity variables of the robot, namely, the scalar angular
velocity ! and the two-dimensional velocity vector Pc of the platform centroid. To
this end, we express the velocity Poi of the centroid Oi of the i th wheel in two
different forms: first we look at this velocity from the active roller up to the centroid
Oi ; then, from the platform centroid C to Oi .
</p>
<p>If we relate the velocity of Oi with that of the contact point of the active roller
with the ground, then we can write, with the aid of Fig. 10.20,
</p>
<p>Poi D Ppi C vi (10.55)
</p>
<p>with vi defined as the relative velocity of Oi with respect to Pi . Now let !h and !r
denote the angular-velocity vectors of the hub and the roller, respectively, i.e.,
</p>
<p>!h D !kC P�iei ; !r D !h C P�igi
</p>
<p>We thus have
</p>
<p>Ppi D !r �
���!
QiPi D .!kC P�iei C P�igi / � bk
</p>
<p>where b is the radius of the rollers at the contact point with ground. In addition, P�i
denotes the rate of the wheel hub, while P�i denotes that of the active roller, which
are positive in the directions of vectors ei and gi , respectively. Hence,
</p>
<p>Ppi D �b. P�i fi C P�ihi / (10.56)</p>
<p/>
</div>
<div class="page"><p/>
<p>10.5 Rolling Robots 459
</p>
<p>Fig. 10.21 The layout of the
i th wheel with respect to the
robot platform
</p>
<p>Moreover,
</p>
<p>vi D !h �
���!
PiOi D .!kC P�iei / � .a � b/k
</p>
<p>a denoting the height of the axis of the wheel hub, as shown in Fig. 10.19b. Thus,
</p>
<p>vi D � P�i .a � b/fi (10.57)
</p>
<p>thereby obtaining the desired expression for Poi , namely,
</p>
<p>Poi D �a P�i fi � b P�ihi (10.58)
</p>
<p>A general layout of the i th ODW with roller axes at an angle ˛i with respect
to the normal ei to the middle vertical plane of the corresponding hub is shown in
Fig. 10.21. The subscript i is associated with both the i th wheel and its active roller.
Moreover, the velocity Poi of the i th wheel can be expressed in terms of the Cartesian
velocity variables, Pc and !, as
</p>
<p>Poi D PcC !Edi (10.59)
</p>
<p>where we have used a two-dimensional vector representation, with di defined as
the vector directed from point C to the centroid Oi of the hub and E defined as
in Eq. (5.55). Furthermore, since all rollers are unactuated and they rotate idly, the
value of P�i is immaterial to our study. Hence, we eliminate this variable from the
foregoing equations, which is done by dot-multiplying both sides of Eq. (10.58) by
gi , normal to hi , thereby deriving
</p>
<p>gTi Poi D �a P�igTi fi
</p>
<p>But
</p>
<p>gTi fi D sin˛i</p>
<p/>
</div>
<div class="page"><p/>
<p>460 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>Therefore,
</p>
<p>gTi Poi D �a.sin˛i / P�i (10.60)
</p>
<p>The same multiplication performed on Eq. (10.59) yields
</p>
<p>gTi Poi D .gTi Edi /! C gTi Pc (10.61)
</p>
<p>Upon equating the right-hand sides of Eqs. (10.60) and (10.61), we derive the
desired relation, namely,
</p>
<p>� a.sin˛i / P�i D kTi t; i D 1; : : : ; n (10.62)
</p>
<p>where the three-dimensional vector ki is defined as
</p>
<p>ki D
�
</p>
<p>gTi Edi
</p>
<p>gi
</p>
<p>�
</p>
<p>and the twist vector t is as defined in Eq. (10.41g). We now define the vector of
wheel rates P� in the form
</p>
<p>P� �
� P�1 P�2 � � � P�n
</p>
<p>�T
(10.63)
</p>
<p>If the n equations of Eq. (10.62) are now assembled, we obtain
</p>
<p>J P� D Kt (10.64)
</p>
<p>where, if we assume that all angles ˛i are identical and labeled ˛, then the n � n
Jacobian J and the n � 3 Jacobian K take the forms
</p>
<p>J � �a sin˛1 (10.65a)
</p>
<p>K �
</p>
<p>2
</p>
<p>6
4
</p>
<p>gT1 Ed1 g
T
1
</p>
<p>:::
:::
</p>
<p>gTn Edn g
T
n
</p>
<p>3
</p>
<p>7
5 (10.65b)
</p>
<p>with 1 denoting the n � n identity matrix.
Given Eqs. (10.65a) and (10.65b), the differential inverse kinematics can be
</p>
<p>resolved as
</p>
<p>P� D � 1
a sin˛
</p>
<p>Kt (10.66)</p>
<p/>
</div>
<div class="page"><p/>
<p>10.6 Exercises 461
</p>
<p>whence it is apparent that sin˛ must be different from zero, i.e., the axes of the
rollers must not be parallel to the axis of the hub. If these axes are parallel, then the
ODWs reduce to conventional wheels.
</p>
<p>10.6 Exercises
</p>
<p>10.1 For the parallel manipulator of Fig. 10.2, find the matrix mapping joint forces
into wrenches acting on the moving platform, if actuation is supplied through
the prismatic joints.
</p>
<p>10.2 Show that, if det.H/ of Eq. (10.21) is expanded in the form
</p>
<p>det.H/ D H1&#129;1 �H2&#129;2 CH3&#129;3
</p>
<p>then &#129;1; &#129;2, and &#129;3 are 14th-, 13th-, and 12th-degree polynomials in �2,
respectively.
</p>
<p>10.3 What is the counterpart of a decoupled serial manipulator, as described
in Sect. 4.4, of a six-dof parallel manipulator with an architecture similar
to that of Fig. 10.2? What is the degree of the characteristic polynomial
of that parallel manipulator? Compare this answer with the characteristic
polynomial derived in Sect. 4.4.
</p>
<p>10.4 We refer to the rolling robot with conventional wheels introduced in
Sect. 10.5.1. We would like to study the equivalent concept of manipulability,
which here we can call maneuverability. This concept refers to the numerical
conditioning of the two underlying Jacobian matrices, J and K, as defined in
Eqs. (10.43a and b). Clearly, J is isotropic and hence, optimally conditioned.
In attempting to determine the condition number of K, however, we need to
order its singular values from smallest to largest.
</p>
<p>(a) Show that the two singular values of K are �1 D l=r and �2 D 2=r .
Obviously, an ordering from smallest to largest is impossible because of
the lack of dimensional homogeneity.
</p>
<p>(b) In order to cope with the dimensional inhomogeneity of matrix K, we
introduce the characteristic length L, which we define below. First, we
redefine the Jacobian K in dimensionless form as
</p>
<p>K 
�
</p>
<p>.l=r/ 0 0
</p>
<p>0 0 2L=r
</p>
<p>�
</p>
<p>Now, L is the value that minimizes the condition number of the
dimensionless K. Show that this value is l=2 and that it produces a
condition number of unity.</p>
<p/>
</div>
<div class="page"><p/>
<p>462 10 Kinematics of Alternative Robotic Mechanical Systems
</p>
<p>10.5 With reference to the robot of Fig 10.17, assume that the motors are
placed rather on the joints associated with variables  and �3. Under these
conditions,
</p>
<p>(a) Find the matrix &permil; mapping array Œ P�3 P &#141;T into array Œ P�1 P�2&#141;T .
(b) Is it possible to find values of  , ˛, ı, and � that will render&permil; isotropic?
</p>
<p>If so, which are these values?
</p>
<p>10.6 Find an expression for the angular velocity P�i of the active roller of the i th
wheel of the robot with Mekanum wheels introduced in Sect. 10.5.2.
</p>
<p>10.7 We refer again to the robot with Mekanum wheels introduced in Sect. 10.5.2.
For the case of a three-wheeled robot of this kind, we consider here a
design whereby the wheels are equally spaced in a &#129;-array. In this array,
the centers of the hubs, Oi , lie at the corners of an equilateral triangle of
side a; moreover, we assume that ˛i D 90ı, for i D 1; 2; 3. Under these
conditions, find the characteristic length L of the robot that renders K, as
defined in the above-mentioned subsection, dimensionless and of a minimum
condition number. Find this minimum as well.
</p>
<p>10.8 Find the value of  at which the rolling robot of Fig. 10.17 attains a singular
configuration. Here, a singularity is understood as a loss of maneuverability
in the sense of not being able to drive the unactuated joints by means of
the actuated ones. Discuss whether under reasonable values of the geometric
parameters, this singularity can occur.
</p>
<p>10.9 Determine the architecture and the &ldquo;posture&rdquo;, i.e., the values of the relevant
joint variables of the rolling robot of Fig. 10.17 that will render matrix
&sbquo; isotropic, where &sbquo; represents the mapping of actuated joint rates into
unactuated ones. Is kinematic isotropy, in this sense, kinematically possible?
</p>
<p>10.10 Find a relation among the geometric parameters of the robot of Fig. 10.17 that
will allow the steering of the robot along a straight course with the highest
possible maneuverability in the sense defined in Exercise 10.8. That is, find a
relation among the geometric parameters of this robot that will render �.&sbquo;/
a minimum along a straight course.
</p>
<p>10.11 Find the value of  under which the robot of Fig. 10.17 performs a maneuver
that leaves the midpoint of segment O1O2 stationary. Under this maneuver,
state a relationship among the geometric parameters of the robot that
minimizes �.&sbquo;/.
</p>
<p>10.12 Upon inversion, Eq. (10.54a) yields
</p>
<p>P�a D U P�u
</p>
<p>(a) Find U.
(b) The above equation can be written as
</p>
<p>P�1 D u13 P�3 C u1 P � uT1 P�u
P�2 D u23 P�3 C u2 P � uT2 P�u</p>
<p/>
</div>
<div class="page"><p/>
<p>10.6 Exercises 463
</p>
<p>The first of the above equations can be integrated if u1, which is an
implicit function of �3 and  , is the gradient with respect to �u �
Œ �3  &#141;
</p>
<p>T of a scalar function U1.�3;  /. Likewise, the second of the
above equations can be integrated if a function U2.�3;  / exists, whose
gradient with respect to �u is u2. Further, upon recalling Schwartz&rsquo;s
Theorem of multivariable calculus, ui is such a gradient if and only if
rui , i.e., the Hessian matrix of Ui with respect to �u, is symmetric, for
i D 1; 2.
</p>
<p>Show that the above-mentioned Hessians, for the case at hand, are
nonsymmetric, and hence, none of the above differential expressions is
integrable. Such expressions are called nonholonomic.
</p>
<p>Note: To be sure, the above condition is sufficient, but not necessary.
It is possible that some individual equations of a system of differential
expressions, also called Pfaffian forms, are not integrable while the
overall system is. An examination of necessary and sufficient conditions
for integrability falls beyond the scope of this book. Such conditions are
best understood with the aid of the Frobenius Theorem (De Luca and
Oriolo 1995) and its analog, the Holonomy Theorem (Ostrovskaya and
Angeles 1998).
</p>
<p>10.13 For the rolling robot with omnidirectional wheels introduced in Sect. 10.5.2,
with a&#129;-array, as described in Exercise 10.7, show that the equation yielding
the angular velocity of the platform in terms of the wheel rates is integrable,
but the equations yielding the velocity of the operation point are not.
</p>
<p>10.14 A holonomic rolling robot. The robot described in Exercise 10.13 can be
rendered holonomic at the expense of one degree of freedom. Show that if
the three wheel rates are coordinated, either mechanically or electronically
so that
</p>
<p>P�1 C P�2 C P�3 D 0
</p>
<p>then the platform is constrained to move under pure translation. When
operating in this mode, the robot is holonomic. Find an explicit expression
for the position vector c of the operation point in terms of the wheel angles.</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 11
</p>
<p>Trajectory Planning: Continuous-Path
Operations
</p>
<p>11.1 Introduction
</p>
<p>As a follow-up to Chap. 6, where we studied trajectory planning for pick-and-place
operations (PPO), we study in this chapter continuous-path operations. In PPO,
the pose, twist, and twist-rate of the EE are specified only at the two ends of
the trajectory, the purpose of trajectory planning then being to blend the two end
poses with a smooth motion. When this blending is done in the joint-variable space,
the problem is straightforward, as demonstrated in Chap. 6. There are instances in
which the blending must be made in Cartesian space, in which advanced notions
of interpolation in what is known as the image space of spatial displacements, as
introduced by Ravani and Roth (1984), are needed. The image space of spatial
displacements is a projective space with three dual dimensions, which means that a
point of this space is specified by four coordinates&mdash;similar to the homogeneous
coordinates introduced in Sect. 2.5&mdash;of the form xi C ��i , for i D 1; 2; 3; 4,
where � is the dual unity, which has the property that �2 D 0. The foregoing
coordinates are thus dual numbers, their purpose being to represent both rotation
and translation in one single quantity. In following Ravani and Roth&rsquo;s work, Ge and
Kang (1995) proposed an interpolation scheme that produces curves in the image
space with second-order geometric continuity, which are referred to as G2 curves.
These interpolation techniques lie beyond the scope of the book and will be left
aside. The interested reader will find a comprehensive and up-to-date review of these
techniques in (Srinivasan and Ge 1997).
</p>
<p>The purpose of this chapter is to develop motion interpolation techniques in
Cartesian space that produce smooth motions in both Cartesian and joint spaces.
Motion interpolation in joint space was discussed in Chap. 6, the present chapter
being devoted to motion interpolation in Cartesian space. To this end, we resort to
basic notions of differential geometry.
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__11,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>465</p>
<p/>
</div>
<div class="page"><p/>
<p>466 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>11.2 Curve Geometry
</p>
<p>Continuous-path robotics applications appear in operations such as arc-welding,
flame-cutting, deburring, and routing. In these operations, a tool is rigidly attached
to the end-effector of a robotic manipulator, the tool being meant to trace a
continuous and smooth trajectory in a six-dimensional configuration space. Three
dimensions of this space describe the spatial path followed by the operation point
of the EE, while the remaining three describe the orientation of the EE. Some
applications require that this task take place along a warped curve, such as those
encountered at the intersections of warped surfaces, e.g., in aircraft fuselages,
while the path is to be traversed as a prescribed function of time. This function,
moreover, is task-dependent; e.g., in arc-welding, the electrode must traverse the
path at a constant speed, if no compensation for gravity is taken into account.
If gravity compensation is warranted, then the speed varies with the orientation of
the path with respect to the vertical. Below we will define this orientation as that of
the Frenet&ndash;Serret frame associated with every point of the path where the path is
smooth.
</p>
<p>Moreover, for functional reasons, the orientation of the EE is given as a rotation
matrix that is, in turn, a prescribed smooth function of time. In arc-welding, for
example, the orientation of the electrode with respect to the curve must be constant.
The trajectory planning of the configuration subspace associated with the warped
path is more or less straightforward, but the planning of the trajectory associated
with the orientation subspace is less so.
</p>
<p>While most methods of trajectory planning at the Cartesian-coordinate level
focus on the path followed by the operation point, the underlying inverse kinematics
of a six-axis robotic manipulator requires the specification of the orientation of the
EE as well. In the presence of simple manipulators with a spherical wrist, as those
studied in Sect. 4.4.2, the positioning and the orientation tasks are readily separable,
and hence, the planning of the two tasks can be done one at a time. In other instances,
e.g., in most arc-welding robots, such a separation is not possible, and both tasks
must be planned concurrently, which is the focus of our discussion below. Here, we
follow the technique presented in Angeles et al. (1988).
</p>
<p>Crucial to our discussion is the concept of path orientation. Let � be a warped
curve in three-dimensional space that is smooth in a certain interval of interest
for our discussion. Under these conditions, we can associate with every point of
this interval an orthonormal triad of vectors, i.e., a set of unit vectors that are
mutually orthogonal, namely, the tangent, the normal, and the binormal vectors
of � . Therefore, when this set of vectors is properly arranged in a 3 � 3 array,
a rotation matrix is obtained. This matrix thus represents the orientation of � .
In order to parameterize these vectors, let s be the arc length measured along �
from a certain reference point on this curve. Below we review the basic differential-
geometric concepts pertaining to our discussion.
</p>
<p>The tangent, normal, and binormal unit vectors, et , en, and eb , respectively,
associated with every point of � where this curve is smooth, are generically termed
here the Frenet&ndash;Serret vectors. These vectors are defined as</p>
<p/>
</div>
<div class="page"><p/>
<p>11.2 Curve Geometry 467
</p>
<p>et � r0 (11.1a)
</p>
<p>eb �
r0 � r00
kr0 � r00k (11.1b)
</p>
<p>en � eb � et (11.1c)
</p>
<p>where r0 stands for dr=ds and r00 for d 2r=ds2. Now the Frenet&ndash;Serret relations
among the three foregoing unit vectors and the curvature � and torsion � of � are
recalled (Brand 1965):
</p>
<p>det
</p>
<p>ds
D �en (11.2a)
</p>
<p>den
</p>
<p>ds
D ��et C �eb (11.2b)
</p>
<p>deb
</p>
<p>ds
D ��en (11.2c)
</p>
<p>Moreover, the curvature and torsion can be calculated with the aid of the formulas
</p>
<p>� D kr0 � r00k (11.3a)
</p>
<p>� D r
0 � r00 � r000
�2
</p>
<p>(11.3b)
</p>
<p>where r000 stands for d 3r=ds3. Furthermore, differentiation of � and � , as given
above, with respect to s, yields
</p>
<p>�0.s/ D .r0 � r00/ � .r
0 � r000/
�
</p>
<p>(11.4a)
</p>
<p>� 0.s/ D r
0 � r00 � r.iv/ � 2�.r0 � r00/ � .r0 � r000/
</p>
<p>�2
(11.4b)
</p>
<p>where r.iv/ stands for d 4r=ds4. The geometric interpretation of the curvature is the
rate of change of orientation of the tangent vector with respect to the arc length; that
of the torsion is the rate at which the curve quits the plane of the tangent and normal
vectors. Thus, at points where the curvature vanishes, the curve approximates a line
to a second order, i.e., up to second-order derivatives, whereas at points where the
torsion vanishes, the curve approximates a planar curve to a third order&mdash;Notice that
the torsion involves third-order derivatives. Now, from the Frenet&ndash;Serret formulas
and the chain rule, we can derive the time-rate of change of the Frenet&ndash;Serret
vectors, namely,
</p>
<p>Pet � detds Ps D Ps�en (11.5a)
</p>
<p>Pen � dends Ps D �Ps�et C Ps�eb (11.5b)
</p>
<p>Peb � debds Ps D �Ps�en (11.5c)</p>
<p/>
</div>
<div class="page"><p/>
<p>468 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>Furthermore, let! be the angular velocity of the Frenet&ndash;Serret frame. Then, clearly,
</p>
<p>Pet � ! � et (11.6a)
Pen � ! � en (11.6b)
Peb � ! � eb (11.6c)
</p>
<p>Upon equating pairwise the right-hand sides of Eqs. (11.5a&ndash;c) and Eqs. (11.6a&ndash;c),
we obtain three vector equations determining !, namely,
</p>
<p>� Et! D Ps�en (11.7a)
�En! D �Ps�et C Ps�eb (11.7b)
�Eb! D �Ps�en (11.7c)
</p>
<p>where we have introduced the cross-product matrices Et , En, and Eb of vectors et ,
en, and eb , respectively, thereby obtaining a system of nine scalar equations in the
three unknown components of !, i.e.,
</p>
<p>A! D b (11.8a)
</p>
<p>with A defined as the 9 � 3 matrix and b as the nine-dimensional vector displayed
below:
</p>
<p>A � �
</p>
<p>2
</p>
<p>4
</p>
<p>Et
</p>
<p>En
</p>
<p>Eb
</p>
<p>3
</p>
<p>5 ; b �
</p>
<p>2
</p>
<p>4
</p>
<p>Ps�en
Ps.��et C �eb/
�Ps�en
</p>
<p>3
</p>
<p>5 (11.8b)
</p>
<p>Although the foregoing system is overdetermined, it is consistent, and hence it
comprises exactly three linearly independent equations, the remaining six being
dependent on the former. One way to reduce system (11.8a) to only three equations
consists in multiplying both sides of this equation by AT . Now, the product ATA
greatly simplifies because matrix A turns out to be isotropic, as per the discussion
of Sect. 5.8, i.e., its three columns are mutually orthogonal and all have the same
magnitude. This fact can become apparent if we realize that the three 3 � 3 blocks
of A are cross-product matrices of three orthonormal vectors. Thus,
</p>
<p>ATA D ETt Et C ETn En C ETb Eb
</p>
<p>If we now recall Theorem 2.3.4, the foregoing products take on quite simple forms,
namely,
</p>
<p>ETt Et D �E2t D �.�1C eteTt /
ETn En D �E2n D �.�1C eneTn /
ETb Eb D �E2b D �.�1C ebeTb /</p>
<p/>
</div>
<div class="page"><p/>
<p>11.2 Curve Geometry 469
</p>
<p>Moreover, for any three-dimensional vector v, we have
</p>
<p>.ete
T
t C eneTn C ebeTb /v � v
</p>
<p>and hence, the above sum in parentheses reduces to the identity matrix, i.e.,
</p>
<p>ete
T
t C eneTn C ebeTb � 1
</p>
<p>the product ATA thus reducing to
</p>
<p>ATA D .2/1
</p>
<p>Therefore, ! takes on the form
</p>
<p>! D 1
2
</p>
<p>�
</p>
<p>Et En Eb
�
</p>
<p>2
</p>
<p>4
</p>
<p>Ps�en
Ps.��et C �eb/
�Ps�en
</p>
<p>3
</p>
<p>5
</p>
<p>or upon expansion,
</p>
<p>! D Ps
2
Œ�et � en C en � .�eb � �et / � �eb � en&#141; (11.10)
</p>
<p>However, since the Frenet&ndash;Serret triad is orthonormal, we have
</p>
<p>et � en D eb; en � eb D et ; eb � et D en (11.11)
</p>
<p>Upon substitution of expressions (11.11) into the expression for ! given in
Eq. (11.10), we obtain
</p>
<p>! D Psı (11.12)
</p>
<p>where ı is the Darboux vector, defined as
</p>
<p>ı D �et C �eb (11.13)
</p>
<p>Expressions for the curvature and torsion in terms of the time-derivatives of the
position vector are readily derived using the chain rule, which leads to
</p>
<p>� D kPr � RrkkPrk3 (11.14a)
</p>
<p>� D Pr � Rr�
:::
r
</p>
<p>kPr � Rrk2 (11.14b)</p>
<p/>
</div>
<div class="page"><p/>
<p>470 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>Upon differentiation of both sides of Eq. (11.12), the angular acceleration P! is
derived as
</p>
<p>P! D Rsı C Ps Pı (11.15)
</p>
<p>where the time-derivative of the Darboux vector is given, in turn, as
</p>
<p>Pı D P�et C P�eb (11.16)
</p>
<p>in which Eqs. (11.5a&ndash;c) have contributed to the simplification of the above
expression. The time-derivatives of the curvature and torsion are readily derived
by application of the chain rule, thereby obtaining
</p>
<p>P� � Ps�0.s/ D Ps
�
.r0 � r000/ � .r0 � r00/ (11.17a)
</p>
<p>P� � Ps� 0.s/ D Ps
�2
Œr0 � r00 � r.iv/ � 2�.r0 � r000/ � .r0 � r00/&#141; (11.17b)
</p>
<p>The time-derivative of the Darboux vector thus reduces to
</p>
<p>Pı D Ps.Aet C Beb/ (11.18a)
</p>
<p>where scalars A and B are computed as
</p>
<p>A � r
0 � r00 � r.iv/ � 2�.r0 � r000/ � .r0 � r00/
</p>
<p>�2
(11.18b)
</p>
<p>B � .r
0 � r000/ � .r0 � r00/
</p>
<p>�
(11.18c)
</p>
<p>and hence, the angular acceleration reduces to
</p>
<p>P! D Rsı C Ps2.Aet C Beb/ (11.19)
</p>
<p>From the relations derived above, it is apparent that the angular velocity is a
bilinear function of the Darboux vector and Ps, while the angular acceleration is
linear in Rs and quadratic in Ps. The computational costs involved in the calculation
of the angular velocity and its time-derivative amount to 31 multiplications and
13 additions for the former, and 28 multiplications with 14 additions for the latter
(Angeles et al. 1988). Notice that the angular velocity requires, additionally, one
square root.
</p>
<p>In the above discussion, it is assumed that explicit formulas for the two time-
derivatives of the arc length s are available. This is often not the case, as we show
with the examples below, whereby an intermediate parameter, which is easier to
handle, is introduced. What we will need are, in fact, alternative expressions for the</p>
<p/>
</div>
<div class="page"><p/>
<p>11.2 Curve Geometry 471
</p>
<p>quantities involved, in terms of kinematic variables; i.e., we need time-derivatives
of the position vector r rather than derivatives of this vector with respect to the arc
length s. Below we derive these expressions.
</p>
<p>First, note that et can be obtained by simply normalizing the velocity vector Pr,
namely, as
</p>
<p>et D
Pr
kPrk (11.20)
</p>
<p>where it is not difficult to realize that
</p>
<p>Ps D kPrk (11.21)
</p>
<p>Moreover, the binormal vector eb can be derived by application of the chain rule to
vector r0, namely,
</p>
<p>r00 D dr
0
</p>
<p>ds
� dr
</p>
<p>0=dt
</p>
<p>ds=dt
� 1Ps
</p>
<p>d
</p>
<p>dt
.r0/ (11.22a)
</p>
<p>But
</p>
<p>r0.s/ � dr
ds
� PrPs (11.22b)
</p>
<p>and hence,
</p>
<p>r00 D 1Ps
</p>
<p>�
d
</p>
<p>dt
</p>
<p>� Pr
Ps
</p>
<p>��
</p>
<p>D Ps Rr � Rs PrPs3 (11.22c)
</p>
<p>Now, upon substitution of expressions (11.22b and c) into Eq. (11.1b), an alternative
expression for eb is derived, in terms of time-derivatives of the position vector,
namely,
</p>
<p>eb D
Pr � Rr
kPr � Rrk (11.23)
</p>
<p>Finally, en can be readily computed as the cross product of the first two vectors of
the Frenet&ndash;Serret triad, namely,
</p>
<p>en � eb � et D
.Pr � Rr/ � Pr
kPr � RrkkPrk (11.24)
</p>
<p>The time-derivatives of the Frenet&ndash;Serret vectors can be computed by direct
differentiation of the expressions given above, namely, Eqs. (11.20), (11.23), and
(11.24).</p>
<p/>
</div>
<div class="page"><p/>
<p>472 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>11.3 Parametric Path Representation
</p>
<p>Only seldom is an explicit representation of the position vector r of a geometric
curve possible in terms of the arc length. In most practical cases, alternative
representations should be used. The representation of the position vector in terms
of a parameter � , whatever its geometric interpretation may be, whether length or
angle, will henceforth be termed a parametric representation of the curve at hand.
The choice of � is problem-dependent, as we illustrate with examples.
</p>
<p>Below we derive expressions for (a) the Frenet&ndash;Serret triad; (b) the curvature
and torsion; and (c) the derivatives of the latter with respect to the arc length. All
these expressions, moreover, will be given in terms of derivatives with respect to the
working parameter � . The key relation that we will use is based on the chain rule,
already recalled several times earlier. Thus, for any vector v.�/,
</p>
<p>dv
</p>
<p>ds
D dv
d�
</p>
<p>d�
</p>
<p>ds
</p>
<p>However, the foregoing relation is not very useful because we do not have an explicit
representation of parameter � in terms of the arc length. Nevertheless, we will
assume that these two variables, s and � , obey a monotonic relation. What this
means is that
</p>
<p>d�
</p>
<p>ds
&gt; 0 (11.25)
</p>
<p>which is normally the case. Under this assumption, moreover, we can write the
derivative of v as
</p>
<p>dv
</p>
<p>ds
D dv=d�
ds=d�
</p>
<p>where, apparently,
</p>
<p>ds
</p>
<p>d�
D
&#13;
&#13;
&#13;
&#13;
</p>
<p>dr
</p>
<p>d�
</p>
<p>&#13;
&#13;
&#13;
&#13;
D kr0.�/k
</p>
<p>Therefore, the derivative sought takes the form
</p>
<p>dv
</p>
<p>ds
D v
</p>
<p>0.�/
</p>
<p>kr0.�/k (11.26a)
</p>
<p>It goes without saying that the same relation holds for scalars, i.e.,
</p>
<p>dv
</p>
<p>ds
D v
</p>
<p>0.�/
</p>
<p>kr0.�/k (11.26b)</p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Parametric Path Representation 473
</p>
<p>Expressions for the Frenet&ndash;Serret triad now follow immediately, i.e.,
</p>
<p>et D
r0.�/
</p>
<p>kr0.�/k (11.27a)
</p>
<p>eb D
r0.�/ � r00.�/
kr0.�/ � r00.�/k (11.27b)
</p>
<p>en D eb � et D
Œr0.�/ � r00.�/&#141; � r0.�/
kr0.�/ � r00.�/kkr0.�/k (11.27c)
</p>
<p>Now, paraphrasing relations (11.14a and b), we have
</p>
<p>� D kr
0.�/ � r00.�/k
kr0.�/k3 (11.28a)
</p>
<p>� D r
0.�/ � r00.�/ � r000
kr0.�/ � r00.�/k2 (11.28b)
</p>
<p>the partial derivatives of the curvature and torsion with respect to the arc length
being computed in terms of the corresponding partial derivatives with respect to the
parameter � , which is done with the aid of the chain rule, i.e.,
</p>
<p>�0.s/ D �
0.�/
</p>
<p>kr0.�/k ; �
0.s/ D �
</p>
<p>0.�/
</p>
<p>kr0.�/k (11.29)
</p>
<p>Expressions for �0.�/ and � 0.�/, in turn, are derived by a straightforward differ-
entiation of the expressions for � and � in terms of � , as given in Eqs. (11.28a
and b). To this end, we first recall a useful expression for the derivative of a rational
expression q.x/ whose numerator and denominator are denoted by N.x/ andD.x/,
respectively. This expression is
</p>
<p>q0.x/ D 1
D.x/
</p>
<p>ŒN 0.x/ � q.x/D0.x/&#141; (11.30a)
</p>
<p>Note that nothing prevents the numerator of the foregoing rational expression from
being a vector, and hence, a similar formula can be applied to vector ratios as well.
Consider the vector rational function q.x/ D n.x/=D.x/. Hence,
</p>
<p>q0.x/ D 1
D.x/
</p>
<p>Œn0.x/ � q.x/D0.x/&#141; (11.30b)
</p>
<p>As a matter of fact, the above relation can be extended to matrix numerators. Not
only is this possible, but the argument can likewise be a vector or a matrix variable,
and similar formulas would apply correspondingly.</p>
<p/>
</div>
<div class="page"><p/>
<p>474 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>We thus have, for the derivative of the curvature,
</p>
<p>�0.�/ D 1kr0.�/k3
�
d
</p>
<p>d�
kr0.�/ � r00.�/k � � d
</p>
<p>d�
kr0.�/k3
</p>
<p>�
</p>
<p>(11.31)
</p>
<p>Now we find the first term inside the brackets of the foregoing expression from the
relation
</p>
<p>d
</p>
<p>d�
kr0.�/ � r00.�/k2 D 2kr0 � r00k d
</p>
<p>d�
kr0 � r00k
</p>
<p>which yields
</p>
<p>d
</p>
<p>d�
kr0 � r00k D 1
</p>
<p>2kr0 � r00k
d
</p>
<p>d�
kr0.�/ � r00.�/k2
</p>
<p>But
</p>
<p>d
</p>
<p>d�
kr0.�/ � r00.�/k2 D d
</p>
<p>d�
fŒr0.�/ � r00.�/&#141; � Œr0.�/ � r00.�/&#141;g
</p>
<p>D 2Œr0.�/ � r00.�/&#141; � d
d�
Œr0.�/ � r00.�/&#141; (11.32)
</p>
<p>the derivative of the above term in brackets reducing to
</p>
<p>d
</p>
<p>d�
Œr0.�/ � r00.�/&#141; D r0.�/ � r000.�/
</p>
<p>and hence,
</p>
<p>d
</p>
<p>d�
kr0 � r00k D Œr
</p>
<p>0.�/ � r00.�/&#141; � Œr0.�/ � r000.�/&#141;
kr0 � r00k (11.33a)
</p>
<p>Furthermore,
</p>
<p>d
</p>
<p>d�
kr0.�/k3 D 3kr0.�/k2 d
</p>
<p>d�
kr0.�/k
</p>
<p>the last derivative again being found from an intermediate relation, namely,
</p>
<p>d
</p>
<p>d�
kr0.�/k2 D 2kr0.�/k d
</p>
<p>d�
kr0.�/k
</p>
<p>whence,
</p>
<p>d
</p>
<p>d�
kr0.�/k D 1
</p>
<p>2kr0.�/k
d
</p>
<p>d�
kr0.�/k2</p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Parametric Path Representation 475
</p>
<p>with
</p>
<p>d
</p>
<p>d�
kr0.�/k2 D d
</p>
<p>d�
Œr0.�/ � r0.�/&#141; D 2r0.�/ � r00.�/
</p>
<p>and so,
</p>
<p>d
</p>
<p>d�
kr0.�/k D r
</p>
<p>0.�/ � r00.�/
kr0.�/k
</p>
<p>d
</p>
<p>d�
kr0.�/k2
</p>
<p>Therefore,
</p>
<p>d
</p>
<p>d�
kr0.�/k3 D 3kr0.�/kr0.�/ � r00.�/ (11.33b)
</p>
<p>Substitution of Eqs. (11.33a and b) into Eq. (11.31) yields the desired expression,
namely,
</p>
<p>�0.�/ D Œr
0.�/ � r00.�/&#141; � Œr0.�/ � r000.�/&#141;
</p>
<p>kr0.�/k3kr0 � r00k � 3�
r0.�/ � r00.�/
kr0.�/k2 (11.34)
</p>
<p>Likewise,
</p>
<p>� 0.�/ D N
D
</p>
<p>(11.35a)
</p>
<p>with N and D defined as
</p>
<p>N � d
d�
Œr0.�/ � r00.�/ � r000.�/&#141; � � d
</p>
<p>d�
kr0.�/ � r00.�/k2 (11.35b)
</p>
<p>D � kr0.�/ � r00.�/k2 (11.35c)
</p>
<p>The first term of the numerator N of the foregoing expression can be readily
calculated as
</p>
<p>d
</p>
<p>d�
Œr0.�/ � r00.�/ � r000.�/&#141; D r0.�/ � r00.�/ � r.iv/.�/ (11.35d)
</p>
<p>while the derivative appearing in the second term of the same numerator was
obtained previously, as displayed in Eq. (11.32). Upon substitution of the expres-
sions appearing in Eqs. (11.32) and (11.35d) into Eq. (11.35a), we obtain the desired
expression:
</p>
<p>� 0.�/ D r
0.�/ � r00.�/ � Œr.iv/.�/ � 2�r0.�/ � r000.�/&#141;
</p>
<p>kr0.�/ � r00.�/k2 (11.35e)
</p>
<p>thereby completing the desired relations.</p>
<p/>
</div>
<div class="page"><p/>
<p>476 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>Table 11.1 DH parameters
of a Fanuc S-300 Robot Link ai (m) bi (m) ˛i (
</p>
<p>ı)
</p>
<p>1 0.0 0.9 90
2 0.9 0.0 0
3 0.95 0.0 90
4 0.0 1.3 �90
5 0.0 0.0 90
6 0.0 0.44 �90
</p>
<p>Example 11.3.1 (Planning of a Gluing Operation). A robot used for a gluing
operation is required to guide the glue nozzle fixed to its end-effector through a
helicoidal path so that the tip of the nozzle traverses the helix at a constant speed
v0 D 0:8m/s and the end-effector maintains a fixed orientation with respect to
the curve, i.e., with respect to the Frenet&ndash;Serret triad of the helix. Determine the
orientation matrix Q of the end-effector with respect to a frame fx; y; zg fixed
to the robot base, as well as the angular velocity and angular acceleration of the
end-effector. The operation is to be performed with a Fanuc S-300 robot, whose
Denavit&ndash;Hartenberg (DH) parameters are given in Table 11.1, while the axis of
the helix is chosen to be parallel to the first axis of the robot and beginning at
point P0 .2; �2; 1:2/ in meters. Find the joint trajectories of the robot as well as
the associated joint rates and joint accelerations from Cartesian position, velocity,
and acceleration data. Verify that the joint-rate and joint-acceleration profiles are
compatible with those of the joint variables. It is known that the radius of the helix
is a D 1:6m and that its pitch is b D 2:5m/turn. Finally, the gluing operation takes
place in 10 s.
</p>
<p>Solution: We will use a Cartesian frame fixed to the base of the robot such that its
z axis coincides with the axis of the first revolute. The helix can then be given in the
parametric representation shown below:
</p>
<p>x D 2C a cos'
y D �2C a sin'
</p>
<p>z D 1:2C b'
2�
</p>
<p>where the parameter ' is the angle made by the projection, onto the X&ndash;Y plane, of
the position vector of a point P of the helix with the x axis.
</p>
<p>In the process, we will need first and second time-derivatives of the foregoing
Cartesian coordinates. These are given below for quick reference:
</p>
<p>Px D �a P' sin'
Py D a P' cos'
</p>
<p>Pz D b
2�
P'</p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Parametric Path Representation 477
</p>
<p>and
</p>
<p>Rx D �a P'2 cos' � a R' sin'
Ry D �a P'2 sin' C a R' cos'
</p>
<p>Rz D b
2�
R'
</p>
<p>We now impose the constant-speed condition, which leads to
</p>
<p>Px2 C Py2 C Pz2 � a2 P'2 C b
2
</p>
<p>4�2
P'2 D v20
</p>
<p>and hence,
</p>
<p>P' D c
</p>
<p>where the constant c is defined as
</p>
<p>c � v0
</p>
<p>s
</p>
<p>4�2
</p>
<p>4�2a2 C b2
</p>
<p>Thus, P' is constant, and hence,
</p>
<p>' D ct
</p>
<p>Moreover, in terms of constant c, the Cartesian coordinates of a point of the helix
take on the forms
</p>
<p>x D 2C a cos ct
y D �2C a sin ct
</p>
<p>z D 1:2C bc
2�
t
</p>
<p>the first time-derivatives of these coordinates becoming
</p>
<p>Px D �ac sin ct
Py D ac cos ct
</p>
<p>Pz D bc
2�
</p>
<p>and the corresponding second time-derivatives
</p>
<p>Rx D �ac2 cos ct
Ry D �ac2 sin ct
Rz D 0</p>
<p/>
</div>
<div class="page"><p/>
<p>478 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>Now the Frenet&ndash;Serret triad is readily calculated as
</p>
<p>et �
dr
</p>
<p>ds
� PrPs D
</p>
<p>c
</p>
<p>v0
</p>
<p>2
</p>
<p>4
</p>
<p>�a sin ct
a cos ct
b=2�
</p>
<p>3
</p>
<p>5
</p>
<p>Furthermore,
</p>
<p>det
</p>
<p>ds
� PetPs D
</p>
<p>ac2
</p>
<p>v20
</p>
<p>2
</p>
<p>4
</p>
<p>� cos ct
� sin ct
0
</p>
<p>3
</p>
<p>5 � �en
</p>
<p>from which it is apparent that
</p>
<p>� D a c
2
</p>
<p>v20
� 4�
</p>
<p>2a
</p>
<p>4�2a2 C b2 ; en D �
</p>
<p>2
</p>
<p>4
</p>
<p>cos ct
sin ct
0
</p>
<p>3
</p>
<p>5
</p>
<p>Thus, the binormal vector eb is calculated simply as the cross product of the first
two vectors of the Frenet&ndash;Serret triad, namely,
</p>
<p>eb � et � en D �
c
</p>
<p>v0
</p>
<p>2
</p>
<p>4
</p>
<p>�.b=2�/ sin ct
.b=2�/ cos ct
</p>
<p>�a
</p>
<p>3
</p>
<p>5
</p>
<p>and hence, the orientation matrix Q of the gluing nozzle, or of the end-effector for
that matter, is given by
</p>
<p>Q �
�
</p>
<p>et en eb
�
</p>
<p>Hence,
</p>
<p>Q D c
v0
</p>
<p>2
</p>
<p>4
</p>
<p>�a sin ct �.v0=c/ cos ct .b=2�/ sin ct
a cos ct �.v0=c/ sin ct �.b=2�/ cos ct
.b=2�/ 0 a
</p>
<p>3
</p>
<p>5
</p>
<p>Now, the angular velocity is determined from Eq. (11.12), which requires the
calculation of the Darboux vector, as given in Eq. (11.13). Upon calculation of the
Darboux vector and substitution of the expression thus resulting into Eq. (11.12),
we obtain
</p>
<p>! D c
3
</p>
<p>v20
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>.4�2a2 C b2/=4�2
</p>
<p>3
</p>
<p>5 D c
</p>
<p>2
</p>
<p>4
</p>
<p>0
</p>
<p>0
</p>
<p>1
</p>
<p>3
</p>
<p>5
</p>
<p>which is thus constant, and hence,
</p>
<p>P! D 0</p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Parametric Path Representation 479
</p>
<p>Now, the coordinates of the center of the wrist, C , are determined with the aid
of relation (4.18c), where the operation point is a point on the helix, i.e., p D xiC
yjC zk, parameters b6, �6, and �6 being obtained from Table 11.1, namely,
</p>
<p>b6 D 0:440m; �6 D cos˛6 D 0; �6 D sin˛6 D �1
</p>
<p>Furthermore, the numerical value of c is obtained from the helix geometry, namely,
</p>
<p>c D 0:8
</p>
<p>s
</p>
<p>4�2
</p>
<p>4�2 � 1:62 C 2:52 D 0:48522 s
�1
</p>
<p>Upon substitution in Eq. (4.18c) of the entries found above for Q, along with
the numerical values, we obtain the Cartesian coordinates of the center C of the
spherical wrist of the robot as
</p>
<p>2
</p>
<p>4
</p>
<p>xC
yC
zC
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>2C 1:16 cos.0:48522t/
�2C 1:16 sin.0:48522t/
</p>
<p>1:2C 0:19306t
</p>
<p>3
</p>
<p>5
</p>
<p>in meters. Apparently, point C describes a helicoidal path as well, although of a
smaller radius, that is coaxial with the given helix.
</p>
<p>Now the time-histories of the joint angles are computed from inverse kinematics.
Note that the robot at hand being of the decoupled type, it allows for a simple
inverse kinematics solution. The details of the solution were discussed extensively
in Sect. 4.4 and are left as an exercise to the reader.
</p>
<p>Of the four inverse kinematics solutions of the arm, three were found to lead
to link interferences, when these trajectories were tested with the aid of RVS, the
package for robot visualization developed at McGill University (Darcovich et al.
1999). Hence, only one such solution is physically possible. This solution, along
with one of the two wrist solutions, is plotted in Fig. 11.1, with Figs. 11.2 and 11.3
showing, respectively, the corresponding joint rates and joint accelerations.
</p>
<p>Note that the maxima and minima of the joint-variables occur at instants where
the corresponding joint rates vanish. Likewise, the maxima and minima of joint rates
occur at instants where the associated joint accelerations vanish, thereby verifying
that the computed results are compatible. A more detailed verification can be done
by numerical differentiation of the joint-variable time-histories.
</p>
<p>Example 11.3.2 (Planning of an Arc-Welding Operation). A spherical reservoir of
radius R is to be arc-welded to a cylindrical pipe of radius r , with the axis of the
cylinder located a distance d from the center of the sphere, all elements of the
cylinder piercing the sphere, i.e., d C r � R, as shown in Fig. 11.4. Note that two
intersection curves are geometrically possible, but the welding will take place only
along the upper curve. Moreover, the welding electrode is to traverse the intersection
curve, while the tool carrying the electrode is to keep a constant orientation with</p>
<p/>
</div>
<div class="page"><p/>
<p>480 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>t (s) t (s)
</p>
<p>t (s) t (s)
</p>
<p>t (s) t (s)
</p>
<p>-10
</p>
<p>0
</p>
<p>10
</p>
<p>20
</p>
<p>30
</p>
<p>40
</p>
<p>50
</p>
<p>60
</p>
<p>70
</p>
<p>80
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>75
</p>
<p>80
</p>
<p>85
</p>
<p>90
</p>
<p>95
</p>
<p>100
</p>
<p>105
</p>
<p>110
</p>
<p>115
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>-23
</p>
<p>-22
</p>
<p>-21
</p>
<p>-20
</p>
<p>-19
</p>
<p>-18
</p>
<p>-17
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>-90
</p>
<p>-80
</p>
<p>-70
</p>
<p>-60
</p>
<p>-50
</p>
<p>-40
</p>
<p>-30
</p>
<p>-20
</p>
<p>-10
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>10
</p>
<p>15
</p>
<p>20
</p>
<p>25
</p>
<p>30
</p>
<p>35
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>-70
</p>
<p>-60
</p>
<p>-50
</p>
<p>-40
</p>
<p>-30
</p>
<p>-20
</p>
<p>-10
</p>
<p>0
</p>
<p>10
</p>
<p>20
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>Fig. 11.1 Joint trajectories for a Fanuc S-300
</p>
<p>respect to that curve. In the coordinate frame shown in Fig. 11.4, find an expression
for the rotation matrix defining the orientation of the end-effector, to which the
electrode is rigidly attached.
</p>
<p>Solution: Note that the X axis of the coordinate frame indicated in Fig. 11.4
intersects the A axis of the cylinder, this axis being parallel to theZ axis. Moreover,
we define ' as the angle shown in Fig 11.4b. Now, the x and y coordinates of an
arbitrary point of the intersection curve are given by
</p>
<p>x D d C r cos' (11.36a)
y D r sin' (11.36b)</p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Parametric Path Representation 481
</p>
<p>t (s) t (s)
</p>
<p>t (s) t (s)
</p>
<p>t (s) t (s)
</p>
<p>7.5
</p>
<p>8
</p>
<p>8.5
</p>
<p>9
</p>
<p>9.5
</p>
<p>10
</p>
<p>10.5
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>2.2
</p>
<p>2.4
</p>
<p>2.6
</p>
<p>2.8
</p>
<p>3
</p>
<p>3.2
</p>
<p>3.4
</p>
<p>3.6
</p>
<p>3.8
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>-1
</p>
<p>-0.5
</p>
<p>0
</p>
<p>0.5
</p>
<p>1
</p>
<p>1.5
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>-16
</p>
<p>-14
</p>
<p>-12
</p>
<p>-10
</p>
<p>-8
</p>
<p>-6
</p>
<p>-4
</p>
<p>-2
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>-2.05
</p>
<p>-2
</p>
<p>-1.95
</p>
<p>-1.9
</p>
<p>-1.85
</p>
<p>-1.8
</p>
<p>-1.75
</p>
<p>-1.7
</p>
<p>-1.65
</p>
<p>-1.6
</p>
<p>-1.55
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>2
</p>
<p>4
</p>
<p>6
</p>
<p>8
</p>
<p>10
</p>
<p>12
</p>
<p>14
</p>
<p>16
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>Fig. 11.2 Joint velocities for a Fanuc S-300
</p>
<p>Further, in order to find the remaining z coordinate, we use the equation of the
sphere, S , namely,
</p>
<p>SW x2 C y2 C z2 D R2
</p>
<p>If we substitute the x and y coordinates of the intersection curve in the above
equation and then solve for the z coordinate in terms of ', we obtain
</p>
<p>z D ˙
p
</p>
<p>R2 � r2 � d 2 � 2dr cos' (11.36c)
</p>
<p>In the above relation, the plus and minus signs correspond to the upper and lower
portions of the intersection curve, respectively. Since we are interested in only the
upper intersection, we will take only the positive sign in that relation. Furthermore,
we define</p>
<p/>
</div>
<div class="page"><p/>
<p>482 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>t (s) t (s)
</p>
<p>t (s)
</p>
<p>t (s) t (s)
</p>
<p>t (s)
</p>
<p>0.1
</p>
<p>0.15
</p>
<p>0.2
</p>
<p>0.25
</p>
<p>0.3
</p>
<p>0.35
</p>
<p>0.4
</p>
<p>0.45
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>-0.6
</p>
<p>-0.5
</p>
<p>-0.4
</p>
<p>-0.3
</p>
<p>-0.2
</p>
<p>-0.1
</p>
<p>0
</p>
<p>0.1
</p>
<p>0.2
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>-0.1
</p>
<p>0
</p>
<p>0.1
</p>
<p>0.2
</p>
<p>0.3
</p>
<p>0.4
</p>
<p>0.5
</p>
<p>0 1 2 3 4 5 6 7 8
</p>
<p>-4
</p>
<p>-3.5
</p>
<p>-3
</p>
<p>-2.5
</p>
<p>-2
</p>
<p>-1.5
</p>
<p>-1
</p>
<p>-0.5
</p>
<p>0
</p>
<p>0 1 2 3 4 5 6 7 8 9 10
</p>
<p>-0.05
</p>
<p>0
</p>
<p>0.05
</p>
<p>0.1
</p>
<p>0.15
</p>
<p>0.2
</p>
<p>0.25
</p>
<p>0.3
</p>
<p>0.35
</p>
<p>0.4
</p>
<p>0.45
</p>
<p>0 1 2 3 4 5 6 7 8
</p>
<p>0
</p>
<p>0.5
</p>
<p>1
</p>
<p>1.5
</p>
<p>2
</p>
<p>2.5
</p>
<p>3
</p>
<p>3.5
</p>
<p>4
</p>
<p>0 1 2 3 4 5 6 7 8
</p>
<p>9 10
</p>
<p>9 10 9 10
</p>
<p>Fig. 11.3 Joint accelerations for a Fanuc S-300
</p>
<p>d � �r; R � �r
</p>
<p>where � and � are nondimensional constants. Moreover, let
</p>
<p>�2 � �2 � �2 � 1 &gt; 0
</p>
<p>O' � 1p
�2 � 2� cos'
</p>
<p>the inequality following from the geometry of Fig.11.4b. Then, the position vector
r of any point on the intersection curve can be expressed in the form
</p>
<p>r D r
</p>
<p>2
</p>
<p>4
</p>
<p>�C cos'
sin'
1= O'
</p>
<p>3
</p>
<p>5 (11.37)</p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Parametric Path Representation 483
</p>
<p>a b
</p>
<p>Fig. 11.4 Intersection curve between a spherical reservoir and a cylindrical pipes
</p>
<p>Now, upon differentiation of r with respect to ', we obtain
</p>
<p>r0.'/ D r
</p>
<p>2
</p>
<p>4
</p>
<p>� sin'
cos'
� O' sin'
</p>
<p>3
</p>
<p>5 (11.38a)
</p>
<p>r00.'/ D r
</p>
<p>2
</p>
<p>4
</p>
<p>� cos'
� sin'
</p>
<p>� O' cos' � .�2 sin2 '/ O'3
</p>
<p>3
</p>
<p>5 (11.38b)
</p>
<p>where we have used the relation
</p>
<p>O'0.'/ D �.� sin'/ O'3
</p>
<p>In addition, using Eqs. (11.38a and b), we derive the items needed to compute the
Frenet&ndash;Serret triad, from which we will derive the required orientation matrix, i.e.,
</p>
<p>r0.'/ � r00.'/ D r2
2
</p>
<p>4
</p>
<p>� O' � �2 O'3 cos' sin2 '
��2 O'3 sin3 '
</p>
<p>1
</p>
<p>3
</p>
<p>5 (11.39a)
</p>
<p>kr0.'/k D rG.'/ (11.39b)
</p>
<p>kr0.'/ � r00.'/k D r2 O'3
p
</p>
<p>D.'/ (11.39c)
</p>
<p>with functions D.'/ and G.'/ defined as
</p>
<p>D � �4�2 C �4 C �6 � 6�2�.�2 C �2/ cos' C 6�2.�2 C 2�2/ cos2 '
C 2�3.�2 � 4/ cos3 ' � 3�4 cos4 ' (11.39d)
</p>
<p>G �
q
</p>
<p>1C �2 O'2 sin2 ' (11.39e)</p>
<p/>
</div>
<div class="page"><p/>
<p>484 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>Now et , eb , and en are obtained as
</p>
<p>et �
r0.'/
</p>
<p>kr0.'/k D
1
</p>
<p>G
</p>
<p>2
</p>
<p>4
</p>
<p>� sin'
cos'
� O' sin'
</p>
<p>3
</p>
<p>5 � nt
G
</p>
<p>(11.40a)
</p>
<p>eb �
r0.'/ � r00.'/
kr0.'/ � r00.'/k D
</p>
<p>1
</p>
<p>O'3
p
D
</p>
<p>2
</p>
<p>4
</p>
<p>� O' � �2 O'3 cos' sin2 '
��2 O'3 sin3 '
</p>
<p>1
</p>
<p>3
</p>
<p>5 � nb
O'3
p
D
</p>
<p>(11.40b)
</p>
<p>en �
1
</p>
<p>O'3
p
DG
</p>
<p>2
</p>
<p>4
</p>
<p>��3 O'4 sin4 ' � cos'
�3 O'4 cos' sin3 ' � �2 O'2 sin' � sin'
</p>
<p>� O' cos' � �2 O'3 sin2 '
</p>
<p>3
</p>
<p>5 � nn
O'3
p
DG
</p>
<p>(11.40c)
</p>
<p>where en has been calculated as en D eb � et .
The orthogonal matrix defining the orientation of the end-effector can now be
</p>
<p>readily computed as
</p>
<p>Q �
�
</p>
<p>et en eb
�
</p>
<p>for we have all the necessary expressions. Note, however, that these expressions
allow us to find Q for any value of ', but we do not have, as yet, an expression of
the form '.t/ that would allow us to obtain Q.t/. Such an expression is derived in
Example 11.5.1.
</p>
<p>Example 11.3.3 (Calculation of Torsion, Curvature, and Darboux Vector). We refer
here to the intersection curve of Example 11.3.2, for which we want to find
expressions for its curvature, torsion, and Darboux vector.
</p>
<p>Solution: We can use directly the expressions derived above, Eqs. (11.28a and b),
to obtain the curvature and torsion in terms of derivatives with respect to parameter
'. With these expressions and those for the Frenet&ndash;Serret triad, the Darboux vector
would follow. However, we can take shortcuts, for we already have expressions for
the Frenet&ndash;Serret triad, if we express the curvature and torsion in terms of this triad
and its derivatives with respect to ', as we explain below. Indeed, from the Frenet&ndash;
Serret relations, Eqs. (11.2b), we can express the curvature and torsion in the forms
</p>
<p>� D e0t .s/ � en (11.41a)
� D �e0b.s/ � en (11.41b)
</p>
<p>and hence, all we need now are the derivatives of the tangent and normal vectors
with respect to s. These are readily derived using relation (11.26a), i.e.,</p>
<p/>
</div>
<div class="page"><p/>
<p>11.3 Parametric Path Representation 485
</p>
<p>e0t .s/ D
e0t .'/
</p>
<p>kr0.'/k (11.42a)
</p>
<p>e0b.s/ D
e0b.'/
</p>
<p>kr0.'/k (11.42b)
</p>
<p>Now, in order to differentiate the Frenet&ndash;Serret triad with respect to ', we first
note, from Eqs. (11.40a&ndash;c), that these three expressions are vector rational functions,
and hence, their derivatives with respect to ' are derived by applying Eq. (11.30b),
thereby obtaining
</p>
<p>e0t .'/ D
1
</p>
<p>G
Œn0t .'/ � etG 0.'/&#141; (11.43)
</p>
<p>e0b.'/ D
1
</p>
<p>O'3
p
D
</p>
<p>�
</p>
<p>n0b.'/ � eb
�
</p>
<p>3 O'2 O'0.'/
p
D C O'3D
</p>
<p>0.'/
</p>
<p>2
p
D
</p>
<p>��
</p>
<p>(11.44)
</p>
<p>where nt and nb are the numerators of the vector rational expressions of et and
eb , respectively, given in Eq. (11.40a and b). Below we calculate the foregoing
derivatives with respect to ':
</p>
<p>n0t .'/ D
</p>
<p>2
</p>
<p>4
</p>
<p>� cos'
� sin'
</p>
<p>� O'.cos' � � O'2 sin2 '/
</p>
<p>3
</p>
<p>5
</p>
<p>n0b.'/ D �
</p>
<p>2
</p>
<p>4
</p>
<p>O'0 � � O'2 sin'Œ3 O'0 cos' sin' C O'.3 cos2 ' � 1/&#141;
�3� O'2 sin2 'Œ O'0 sin' C O' cos'&#141;
</p>
<p>0
</p>
<p>3
</p>
<p>5
</p>
<p>O'0 � O'0.'/ D �� sin'
.�2 � 2� cos'/3=2
</p>
<p>D 0.'/ D 6�2�.�2 C �2/ sin' � 12�2.�2 C 2�2/ cos' sin'
� 6�3.�2 � 4/ cos2 ' sin' C 12�4 cos3 ' sin'
</p>
<p>G 0.'/ D �
2 sin'
</p>
<p>2G
.2 O' cos' C O'0 sin'/
</p>
<p>and kr0.'/k was already calculated in Example 11.3.2.</p>
<p/>
</div>
<div class="page"><p/>
<p>486 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>If we now substitute all the foregoing expressions into Eqs. (11.42a and b), we
obtain, after intensive simplifications,
</p>
<p>� D
p
D O'3
G3r
</p>
<p>(11.45a)
</p>
<p>� D �3�
2 O'E sin'
rDG2
</p>
<p>(11.45b)
</p>
<p>with function E.'/ defined, in turn, as
</p>
<p>E.'/ � 1O'4 Œ��
3 O'4 sin4 ' C � O'2 sin2 '.� cos' � 1/C cos'&#141; (11.46)
</p>
<p>With the foregoing expressions for et , eb , � , and �, computing the Darboux vector of
the intersection curve reduces to a routine substitution of the foregoing expressions
into Eq. (11.13).
</p>
<p>11.4 Parametric Splines in Trajectory Planning
</p>
<p>Sometimes the path to be followed by the tip of the end-effector is given only as a
discrete set of sampled points fPigN1 . This is the case, for example, if the path is the
intersection of two warped surfaces, as in the arc-welding of two plates of the hull
of a vessel or the spot-welding of two sheets of the fuselage of an airplane. In these
instances, the coordinates of the sampled points are either calculated numerically
via nonlinear-equation solving or estimated using a vision system. In either case, it
is clear that only point coordinates are available, while trajectory planning calls
for information on derivatives of the position vector of points along the path
with respect to the arc length. These derivatives can be estimated via a suitable
interpolation of the given coordinates. Various interpolation schemes are available
(Foley and Van Dam 1982; Hoschek and Lasser 1992), the most widely accepted
ones being based on spline functions, which were introduced in Sect. 6.6. The
splines introduced therein are applicable whenever a function, not a geometric curve,
is to be interpolated. However, in trajectory planning, geometric curves in three-
dimensional space come into play, and hence, those splines, termed nonparametric,
are no longer applicable. What we need here are parametric splines, as described
below.
</p>
<p>Although parametric splines, in turn, can be of various types (Dierckx 1993), we
will focus here on cubic parametric splines because of their simplicity.
</p>
<p>Let Pi .xi ; yi ; zi /, for i D 1; : : : ; N , be the set of sampled points on the path
to be traced by the tip of the end-effector, fpi gN1 being the set of corresponding
position vectors. Our purpose in this section is to produce a smooth curve � that
passes through fPigN1 and that has a continuous Frenet&ndash;Serret triad. To this end, we
will resort to the expressions derived in Sect. 11.3, in terms of a parameter � , which
we will define presently.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.4 Parametric Splines in Trajectory Planning 487
</p>
<p>We first introduce a few definitions: Let the kth derivative of the position vector
p of an arbitrary point P of � with respect to � , evaluated at Pi , be denoted by
p
.k/
i , its components being denoted correspondingly by x
</p>
<p>.k/
i , y
</p>
<p>.k/
i , and z
</p>
<p>.k/
i . Next, the
</p>
<p>coordinates of P are expressed as piecewise cubic polynomials of � , namely,
</p>
<p>x.�/ D Axi .� � �i /3 C Bxi .� � �i /2 C Cxi .� � �i /CDxi (11.47a)
y.�/ D Ayi .� � �i /3 C Byi .� � �i /2 C Cyi .� � �i /CDyi (11.47b)
z.�/ D Azi .� � �i /3 C Bzi .� � �i /2 C Czi .� � �i /CDzi (11.47c)
</p>
<p>for a real parameter � , such that �i � � � �iC1; and i D 1; : : : ; N � 1, with �i
defined as
</p>
<p>�1 D 0; �iC1 � �i C&#129;�i ; &#129;�i �
q
</p>
<p>&#129;x2i C&#129;y2i C&#129;z2i (11.47d)
&#129;xi � xiC1 � xi ; &#129;yi � yiC1 � yi ; &#129;zi � ziC1 � zi (11.47e)
</p>
<p>and hence, &#129;�i represents the length of the chord subtended by the arc of path
between Pi and PiC1. Likewise, � denotes a path length measured along the spatial
polygonal joining the N points fPigN1 . Thus, the closer the aforementioned points,
the closer the approximation of &#129;�i to the arc length between these two points, and
hence, the better the approximations of the curve properties.
</p>
<p>The foregoing spline coefficients Axi ; Ayi ; : : : ; Dzi , for i D 1; : : : ; N � 1, are
determined as explained below. Let us define the N -dimensional vectors
</p>
<p>x � Œx1; : : : ; xN &#141;T ; x00 � Œx001 ; : : : ; x00N &#141;T (11.48a)
y � Œy1; : : : ; yN &#141;T ; y00 � Œy001 ; : : : ; y00N &#141;T (11.48b)
z � Œz1; : : : ; zN &#141;T ; z00 � Œz001 ; : : : ; z00N &#141;T (11.48c)
</p>
<p>The relationships between x, y, and z and their counterparts x00, y00, and z00 are the
same as those found for nonparametric splines in Eq. (6.58a), namely,
</p>
<p>Ax00 D 6Cx (11.49a)
Ay00 D 6Cy (11.49b)
Az00 D 6Cz (11.49c)
</p>
<p>which are expressions similar to those of Eq. (6.58a), except that the A and C
matrices appearing in Eq. (11.49b) are now themselves functions of the coordinates
of the supporting points (SP) of the spline. In fact, the .N � 2/�N matrices A and
C are defined exactly as in Eqs. (6.58b and c), repeated below for quick reference:</p>
<p/>
</div>
<div class="page"><p/>
<p>488 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>A D
</p>
<p>2
</p>
<p>6
6
6
6
6
4
</p>
<p>˛1 2˛1;2 ˛2 0 � � � 0 0
0 ˛2 2˛2;3 ˛3 � � � 0 0
:::
</p>
<p>:::
: : :
</p>
<p>: : :
: : :
</p>
<p>:::
:::
</p>
<p>0 0 : : : ˛N 000 2˛N 0;00N 00 ˛N 00 0
</p>
<p>0 0 0 � � � ˛N 00 2˛N;00N 0 ˛N 0
</p>
<p>3
</p>
<p>7
7
7
7
7
5
</p>
<p>(11.49d)
</p>
<p>and
</p>
<p>C D
</p>
<p>2
</p>
<p>6
6
6
6
6
4
</p>
<p>ˇ1 �ˇ1;2 ˇ2 0 � � � 0 0
0 ˇ2 �ˇ2;3 ˇ3 � � � 0 0
:::
</p>
<p>:::
: : :
</p>
<p>: : :
: : :
</p>
<p>:::
:::
</p>
<p>0 0 � � � ˇN 000 �ˇN 0;00N 00 ˇN 00 0
0 0 0 � � � ˇN 00 �ˇN;00N 0 ˇN 0
</p>
<p>3
</p>
<p>7
7
7
7
7
5
</p>
<p>(11.49e)
</p>
<p>where ˛k and ˇk are now defined correspondingly, i.e., for i; j; k D 1; : : : ; N 0,
</p>
<p>˛k D &#129;�k ; ˛i;j D ˛i C ˛j ; ˇk D 1=˛k ; ˇi;j D ˇi C ˇj (11.50)
</p>
<p>while N 0, N 00, and N 000 are defined as in Eq. (6.58f), i.e., as
</p>
<p>N 0 � N � 1; N 00 � N � 2; N 000 � N � 3 (11.51)
</p>
<p>Note that the spline p.�/ is fully determined once its coefficients are known.
These are computed exactly as their counterparts for nonparametric splines, namely,
as in Eqs. (6.55a&ndash;e). Obviously, different from the aforementioned formulas, the
coefficients of the parametric spline pertain to three coordinates, and hence, three
sets of such coefficients need be computed in this case. In order to simplify matters,
we introduce the vectors below:
</p>
<p>ak �
</p>
<p>2
</p>
<p>4
</p>
<p>Axk
Ayk
Azk
</p>
<p>3
</p>
<p>5 ; bk �
</p>
<p>2
</p>
<p>4
</p>
<p>Bxk
Byk
Bzk
</p>
<p>3
</p>
<p>5 ; ck �
</p>
<p>2
</p>
<p>4
</p>
<p>Cxk
Cyk
Czk
</p>
<p>3
</p>
<p>5 ; dk �
</p>
<p>2
</p>
<p>4
</p>
<p>Dxk
Dyk
Dzk
</p>
<p>3
</p>
<p>5 (11.52)
</p>
<p>and thus, the position vector of an arbitrary point P on the parametric spline takes
on the form
</p>
<p>p.�/ D ak.���k/3Cbk.���k/2Cck.���k/Cdk ; k D 1; : : : ; N�1 (11.53a)</p>
<p/>
</div>
<div class="page"><p/>
<p>11.4 Parametric Splines in Trajectory Planning 489
</p>
<p>in the interval �k � � � �kC1. The counterpart set of Eqs. (6.55a&ndash;e) is then
</p>
<p>ak D
1
</p>
<p>6&#129;�k
.p00kC1 � p00k/ (11.53b)
</p>
<p>bk D
1
</p>
<p>2
p00k (11.53c)
</p>
<p>ck D
&#129;pk
</p>
<p>&#129;�k
� 1
6
&#129;�k .p
</p>
<p>00
kC1 C 2p00k/ (11.53d)
</p>
<p>dk D pk (11.53e)
&#129;pk � pkC1 � pk (11.53f)
</p>
<p>where vectors pk and p00k are defined as
</p>
<p>pk �
</p>
<p>2
</p>
<p>4
</p>
<p>xk
yk
zk
</p>
<p>3
</p>
<p>5 ; p00k �
</p>
<p>2
</p>
<p>4
</p>
<p>x00k
y00k
z00k
</p>
<p>3
</p>
<p>5 (11.54)
</p>
<p>Note that since p is piecewise cubic in � , p0 is piecewise quadratic, whereas p00
</p>
<p>is piecewise linear in the same argument, p000 being piecewise constant; higher-
order derivatives vanish. Properly speaking, however, the piecewise constancy of p000
</p>
<p>causes the fourth-order derivative to be discontinuous at the SP, and consequently,
all higher-order derivatives are equally discontinuous at those points. In practice,
these discontinuities are smoothed out by the inertia of the links and the motors, if
the SP are chosen close enough. Obviously, higher-order continuity can be achieved
if higher-order splines, e.g., quintic splines, are used instead. For the sake of
conciseness, these splines are not discussed here, the interested reader being directed
to the specialized literature (Dierckx 1993).
</p>
<p>Further, the N � 3 matrices P and P00 are defined as
</p>
<p>P �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>pT1
pT2
:::
</p>
<p>pTN
</p>
<p>3
</p>
<p>7
7
7
5
; P00 �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>.p001 /
T
</p>
<p>.p002 /
T
</p>
<p>:::
</p>
<p>.p00N /
T
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(11.55)
</p>
<p>which allows us to rewrite Eqs. (11.49b) in matrix form as
</p>
<p>AP00 D 6CP (11.56)
</p>
<p>It is now apparent that the spline coefficients ak ; : : : ; dk can be calculated once vec-
tors p00k are available. These vectors can be computed via matrix P
</p>
<p>00 as the solution
to Eq. (11.56). However, finding this solution requires inverting the .N � 2/ �N
matrix A, which is rectangular and hence cannot be inverted, properly speaking.</p>
<p/>
</div>
<div class="page"><p/>
<p>490 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>We thus have an underdetermined system of linear equations, and further conditions
are needed in order to render it determined. Such conditions are those defining the
type of spline at hand. For example, closed paths call naturally for periodic splines,
while open paths call for other types such as natural splines. The conditions imposed
on periodic parametric splines are listed below:
</p>
<p>pN D p1; p0N D p01; p00N D p001 (11.57a)
</p>
<p>On the other hand, natural parametric splines are obtained under the conditions
</p>
<p>p001 D p00N D 0 (11.57b)
</p>
<p>Thus, if a periodic parametric spline is required, then vectors pN and p00N can be
deleted from matrices P and P00, respectively, these then becoming .N � 1/ � 3
matrices, namely,
</p>
<p>P �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>pT1
pT2
:::
</p>
<p>pTN�1
</p>
<p>3
</p>
<p>7
7
7
5
; P00 �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>.p001 /
T
</p>
<p>.p002 /
T
</p>
<p>:::
</p>
<p>.p00N�1
T
/
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(11.58)
</p>
<p>Moreover, the first-derivative condition of Eq. (11.57a) is added to the N � 2
continuity conditions of Eq. (6.56), thereby obtaining N � 1 equations of this form.
Consequently, A becomes an .N � 1/ � .N � 1/ matrix. Correspondingly, C also
becomes an .N � 1/ � .N � 1/ matrix, i.e.,
</p>
<p>A �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
4
</p>
<p>2˛1;N 0 ˛1 0 0 � � � ˛N 0
˛1 2˛1;2 ˛2 0 � � � 0
0 ˛2 2˛2;3 ˛3 � � � 0
:::
</p>
<p>:::
: : :
</p>
<p>: : :
: : :
</p>
<p>:::
</p>
<p>0 0 : : : ˛N 000 2˛N 000;N 00 ˛N 00
</p>
<p>˛N 0 0 0 � � � ˛N 00 2˛N 00;N 0
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
5
</p>
<p>(11.59a)
</p>
<p>and
</p>
<p>C �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
4
</p>
<p>�ˇ1;N 0 ˇ1 0 0 � � � ˇN 0
ˇ1 �ˇ1;2 ˇ2 0 � � � 0
0 ˇ2 �ˇ2;3 ˇ3 � � � 0
:::
</p>
<p>:::
: : :
</p>
<p>: : :
: : :
</p>
<p>:::
</p>
<p>0 0 � � � ˇN 000 �ˇN 000;N 00 ˇN 00
ˇN 0 0 0 � � � ˇN 00 �ˇN 00;N 0
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
5
</p>
<p>(11.59b)</p>
<p/>
</div>
<div class="page"><p/>
<p>11.4 Parametric Splines in Trajectory Planning 491
</p>
<p>Table 11.2 The Cartesian coordinates of the supporting points
</p>
<p>' 0ı 30ı 60ı 90ı 120ı 150ı
</p>
<p>x 0.45 0.429904 0.375 0.3 0.225 0.170096
y 0 0.075 0.129904 0.15 0.129904 0.075
z 0.396863 0.411774 0.45 0.497494 0.540833 0.570475
</p>
<p>' 180ı 210ı 240ı 270ı 300ı 330ı
</p>
<p>x 0.15 0.170096 0.225 0.3 0.375 0.429904
y 0 �0:075 �0:129904 �0:15 �0:129904 �0:075
z 0.580948 0.570475 0.540833 0.497494 0.45 0.411774
</p>
<p>Since A is nonsingular, Eq. (11.56) can be solved for P00, namely,
</p>
<p>P00 D 6A�1CP (11.60)
</p>
<p>thereby computing all vectors fp00kgN�11 , from which p00N can be readily obtained.
Hence, the spline coefficients follow.
</p>
<p>Likewise, if natural parametric splines are used, then P00 becomes an .N � 2/� 3
matrix, while A, consequently, becomes an .N � 2/ � .N � 2/ matrix, as given in
Eq. (6.59).
</p>
<p>Example 11.4.1 (Spline-Approximation of a Warped Path). For the numerical val-
ues R D 0:6m, r D 0:15m, and d D 0:3m, determine the periodic parametric
cubic spline approximating the intersection of the sphere and the cylinder of
Fig. 11.4, with 12 equally spaced supporting points along the cylindrical coordinate
', i.e., with supporting points distributed along the intersection curve at intervals
&#129;' D 30ı. Using the spline, find values of the tangent, normal, and binormal
vectors of the curve, as well as the rotation matrix Q. In order to quantify the error
in this approximation, compare (a) the components of the two position vectors, the
exact and the spline-generated ones, while normalizing their differences using the
radius of the cylinder r ; and (b) the Euler&ndash;Rodrigues parameters of the exact and
the spline-approximated rotation matrices. Plot these errors vs. '.
</p>
<p>Solution: We use Eq. (11.37) to find the Cartesian coordinates of the supporting
points. The numerical results are given in terms of the components of r �
Œ x; y; z &#141;T in Table 11.2. Note that this table does not include the Cartesian-
coordinate values at 360ı because these are identical with those at 0ı.
</p>
<p>The four Euler&ndash;Rodrigues parameters frig3iD0 of the rotation matrix are most
suitably calculated in terms of the linear invariants, i.e., as appearing in Eq. (2.79).
If we let Qp and Qr denote the estimates of p and r, respectively, then the orientation
error is evaluated via the four differences &#129;ri D ri � Qri , for i D 0; : : : ; 3. The
positioning error is computed, in turn, as the normalized difference � D .p� Qp/=r to
yield a dimensionless number, its components being denoted by �x , �y , and �z. The
components of the two errors are plotted vs. ' in Figs. 11.5 and 11.6. Note that the
orientation errors are, roughly, one order of magnitude greater than the positioning
errors.</p>
<p/>
</div>
<div class="page"><p/>
<p>492 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>0 50 100 150 200 250 300 350
</p>
<p>&minus;1
</p>
<p>0
</p>
<p>1
x 10
</p>
<p>&minus;3
</p>
<p>0 50 100 150 200 250 300 350
</p>
<p>&minus;1
</p>
<p>0
</p>
<p>1
x 10
</p>
<p>&minus;3
</p>
<p>0 50 100 150 200 250 300 350
</p>
<p>&minus;1
</p>
<p>0
</p>
<p>1
x 10
</p>
<p>&minus;3
</p>
<p>x
</p>
<p>y
</p>
<p>z
</p>
<p>(deg)
</p>
<p>(deg)
</p>
<p>(deg)
</p>
<p>Fig. 11.5 Plots of the positioning errors
</p>
<p>11.5 Continuous-Path Tracking
</p>
<p>When a continuous trajectory is to be tracked with a robot, the joint angles have
to be calculated along a continuous set of poses of the end-effector. In practice, the
continuous trajectory is sampled at a discrete set of close-enough poses f sk gN1 along
the continuous trajectory. Then in principle, an IKP must be solved at each sampled
pose. If the manipulator is of the decoupled type, these calculations are feasible in
a fraction of a millisecond, for the solution reduces, in the majority of the cases,
to a cascading of quadratic equations. In the worst case, the inverse kinematics of
a decoupled manipulator requires finding all the roots of a quartic equation at each
sampled pose, but this is still feasible in the same time frame, for the four roots
of interest can be calculated from formulas. However, if the manipulator has an
architecture not lending itself to a simple solution and requires solving polynomials
of a degree higher than four, then finding all solutions at each sample pose may
require a few milliseconds, which may be too slow in fast operations. Hence, an
alternative approach is needed.
</p>
<p>The alternative is to solve the IKP iteratively. That is, if we have the value of
the vector of joint variables �.tk/ and want to find its value at tkC1, then we use
Algorithm 11.5.1.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.5 Continuous-Path Tracking 493
</p>
<p>0 100 200 300
</p>
<p>&minus;0.01
</p>
<p>&minus;0.005
</p>
<p>0
</p>
<p>0.005
</p>
<p>0.01
</p>
<p>0 100 200 300
&minus;0.01
</p>
<p>&minus;0.005
</p>
<p>0
</p>
<p>0.005
</p>
<p>0.01
</p>
<p>0 100 200 300
</p>
<p>&minus;0.01
</p>
<p>&minus;0.005
</p>
<p>0
</p>
<p>0.005
</p>
<p>0.01
</p>
<p>0 100 200 300
</p>
<p>&minus;0.01
</p>
<p>&minus;0.005
</p>
<p>0
</p>
<p>0.005
</p>
<p>0.01
</p>
<p>∆r1 ∆r2
</p>
<p>∆r3 ∆r0
</p>
<p>(deg)
</p>
<p>(deg) (deg)
</p>
<p>(deg)
</p>
<p>Fig. 11.6 Plots of the orientation errors
</p>
<p>Algorithm 11.5.1
</p>
<p>� �.tk/
1 find correction &#129;�
</p>
<p>if k&#129;� k � �, then stop;
else
</p>
<p>� � C&#129;�
go to 1
</p>
<p>Various procedures are available to find the correction &#129;� of Algorithm 11.5.
The one we have found very convenient is based on the Newton&ndash;Gauss method
(Dahlquist and Bj&ouml;rck 1974). In the realm of Newton methods&mdash;there are several
of these, the Newton&ndash;Gauss and the Newton&ndash;Raphson methods being two of this
class&mdash;the closure equations (4.9a and b) are written in the form
</p>
<p>f.�/ D sd (11.61)</p>
<p/>
</div>
<div class="page"><p/>
<p>494 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>where sd is the seven-dimensional prescribed-pose array. We recall here the
definition of the pose array introduced in Sect. 3.2 to represent sd , namely,
</p>
<p>sd �
</p>
<p>2
</p>
<p>4
</p>
<p>q
</p>
<p>q0
p
</p>
<p>3
</p>
<p>5
</p>
<p>d
</p>
<p>(11.62)
</p>
<p>with q and q0 defined, in turn, as a three-dimensional vector invariant of the
rotation Q and its corresponding scalar, respectively. Moreover, p is the position
vector of the operation point. Therefore, the seven-dimensional vector f is defined,
correspondingly, as
</p>
<p>f.�/ �
</p>
<p>2
</p>
<p>4
</p>
<p>fv.�/
</p>
<p>f0.�/
</p>
<p>fp.�/
</p>
<p>3
</p>
<p>5 �
</p>
<p>2
</p>
<p>4
</p>
<p>q
</p>
<p>q0
p
</p>
<p>3
</p>
<p>5 (11.63)
</p>
<p>where fv.�/ denotes the counterpart of q above, as pertaining to the product
Q1 � � �Q6 of Eq. (4.9a); f0.�/ is the counterpart of q0, as pertaining to the same
product; and fp.�/ is the sum a1 C � � � C Q1 � � �Q5a6. In principle, any of
the three types of rotation invariants introduced in Sect. 3.2 can be used in the
above formulation.
</p>
<p>Now, Eq. (11.61) represents a nonlinear system of seven equations in six
unknowns. The system is thus overdetermined, but since the four rotational equa-
tions are consistent, this system should admit an exact solution, even if this solution
is complex. For example, if p is specified in sd above as lying outside of the
manipulator reach, then no real solution is possible, and the solution reported by
any iterative procedure capable of handling complex solutions will be complex.
</p>
<p>Upon application of the Newton&ndash;Gauss method to find a solution of Eq. (11.61),
we assume that we have an initial guess �0, and based on this value, we generate a
sequence �1, : : :, � i , � iC1, : : :, until either a convergence or an abortion criterion is
met. This sequence is generated in the form
</p>
<p>� iC1 D � i C&#129;� i (11.64)
</p>
<p>with &#129;� i calculated from
</p>
<p>ˆ.� i /&#129;� i D �f.� i /C sd (11.65)
</p>
<p>andˆ defined as the Jacobian matrix of f.�/with respect to � . Note that by virtue of
its definition,ˆ is a 7�6matrix. A common misconception in the robotics literature
is to confuse this Jacobian matrix with the Jacobian defined by Whitney (1972) and
introduced in Eq. (5.10a), which maps joint rates into the EE twist. The difference
between the two Jacobians being essential, it is made clear in the discussion below.
First and foremost, ˆ is an actual Jacobian matrix, while Whitney&rsquo;s Jacobian,
properly speaking, is not. In fact, ˆ is defined as
</p>
<p>ˆ � @f
@�
</p>
<p>(11.66)</p>
<p/>
</div>
<div class="page"><p/>
<p>11.5 Continuous-Path Tracking 495
</p>
<p>In order to find ˆ in Eq. (11.65), we note that by application of the chain rule,
</p>
<p>Pf D @f
@�
P� � ˆ P� (11.67)
</p>
<p>However, from the definition of f, we have that Pf is the time-derivative of the pose
array of the EE, i.e., Ps. Moreover, by virtue of Eq. (3.78), this time-derivative can be
expressed as a linear transformation of the twist t of the EE, i.e.,
</p>
<p>Pf D Tt (11.68a)
</p>
<p>with T defined in Sect. 3.2 as
</p>
<p>T �
�
</p>
<p>F O43
</p>
<p>O33 133
</p>
<p>�
</p>
<p>(11.68b)
</p>
<p>where O33 and O43 denote the 3� 3 and the 4� 3 zero matrices, 133 being the 3� 3
identity matrix. Further, matrix F takes on various forms, depending on the type of
rotation representation adopted, as discussed in Sect. 3.2.
</p>
<p>We write next the left-hand side of Eq. (11.68a) as shown in Eq. (11.67), and the
twist t of the right-hand side of Eq. (11.68a) in terms of P� , as expressed in Eq. (5.9),
thereby obtaining
</p>
<p>ˆ P� � TJ P� (11.69)
</p>
<p>which is a relation valid for any value of P� . As a consequence, then,
</p>
<p>ˆ D TJ (11.70)
</p>
<p>whence the relation between the two Jacobians is apparent. Note that Eq. (11.68a)
allows us to write
</p>
<p>Pf D TJ P� (11.71)
</p>
<p>Upon equating the right-hand sides of Eqs. (11.71) and (11.68a), we obtain
</p>
<p>TJ P� D Tt � Psd (11.72)
</p>
<p>If linear invariants are used to represent the rotation, then T becomes rank-
deficient if and only if the angle of the rotation becomes � (Tandirci et al. 1994);
otherwise, T is always of full rank, and Eq. (11.72) leads to
</p>
<p>J P� D t (11.73)</p>
<p/>
</div>
<div class="page"><p/>
<p>496 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>which is exactly the same as Eq. (5.9). Now we multiply both sides of the foregoing
equation by &#129;t , thereby obtaining
</p>
<p>J&#129;� D t&#129;t (11.74)
</p>
<p>All we need now is, apparently, the product in the right-hand side of the above
equation, namely,
</p>
<p>t&#129;t D
�
</p>
<p>!&#129;t
</p>
<p>Pp&#129;t
</p>
<p>�
</p>
<p>�
�
</p>
<p>!&#129;t
</p>
<p>&#129;p
</p>
<p>�
</p>
<p>(11.75)
</p>
<p>The product !&#129;t is found below, in terms of the orientation data available: First
and foremost, it is common practice in the realm of Newton methods to assume
that a good enough approximation to the root sought is available, and hence, &#129;�
is &ldquo;small.&rdquo; That is, we assume that k&#129;�k is small, where k � k denotes any vector
norm. Moreover, we use the end-effector pose at t D tk as a reference to describe
the desired pose at t D tkC1, the rotation sought&mdash;that takes the EE to its desired
attitude&mdash;being denoted by&#129;Q, and defined as .&#129;Q/Qk D Qd , when all rotations
are expressed in the same frame and Qk represents the orientation of the EE at
t D tk . Thus,
</p>
<p>&#129;Q D QdQkT (11.76)
</p>
<p>Now we relate !&#129;t with &#129;Q. To this end, notice that
</p>
<p>!&#129;t D vect.&#127;&#129;t/ (11.77a)
</p>
<p>with &#127; denoting the cross-product matrix of !. On the other hand, &#129;Q is bound to
be a rotation about an axis parallel to a unit vector e, through a small angle &#129;�, and
hence, from Eq. (2.49),
</p>
<p>&#129;Q � 1C .&#129;�/E (11.77b)
</p>
<p>where E is the cross-product matrix of e. It is then possible to assume that &#127;&#129;t ,
as appearing in Eq. (11.77a), is the skew-symmetric component of &#129;Q, as given by
Eq. (11.77b), i.e.,
</p>
<p>&#129;Q D 1C&#127;&#129;t
</p>
<p>whence
</p>
<p>&#127;&#129;t D QdQTk � 1
</p>
<p>which readily leads to
</p>
<p>!&#129;t D vect.QdQTk / (11.78)
</p>
<p>thereby obtaining the relation sought.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.5 Continuous-Path Tracking 497
</p>
<p>Algorithm 11.5.2
</p>
<p>1 &#129;Q  QdQkT
</p>
<p>&#129;p  pd � pk
</p>
<p>&#129;t  
�
</p>
<p>vect.&#129;Q/
&#129;p
</p>
<p>�
</p>
<p>&#129;�  J�1&#129;t
if k&#129;� k � �, then stop;
else
</p>
<p>�  � C&#129;�
Qk  .&#129;Q/Qk
pk  p.�/
</p>
<p>go to 1
</p>
<p>In summary, then, the correction &#129;� is computed from
</p>
<p>J&#129;� D &#129;t (11.79)
</p>
<p>with &#129;t defined as
</p>
<p>&#129;t �
�
</p>
<p>vect.QdQkT /
&#129;p
</p>
<p>�
</p>
<p>(11.80)
</p>
<p>and &#129;p defined, in turn, as the difference between the prescribed value pd of the
position vector of the operation point and its value pk at the current iteration. Thus,
the numerical path-tracking scheme consists essentially of Eqs. (11.79) and (11.80),
as first proposed by Pieper (1968). We thus have Algorithm 11.5.2.
</p>
<p>When implementing the foregoing procedure, we want to save processing time;
hence, we aim at fast computations. The computation of the correction&#129;� involves
only linear-equation solving, which was discussed at length in Chap. 4 and need
not be discussed further here. The only item that still needs some discussion is the
calculation of the vector norm k&#129;�k. Since any norm can be used here, we can
choose the norm that is fastest to compute, namely, the maximum norm, also known
as the Chebyshev norm, represented as k&#129;�k1, and defined as
</p>
<p>k&#129;�k1 � max
i
f j�i j g (11.81)
</p>
<p>Note that this norm only requires comparisons and no floating-point operations. The
Euclidean norm of an n-dimensional vector, however, requires n multiplications,
n � 1 additions, and one square root.</p>
<p/>
</div>
<div class="page"><p/>
<p>498 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>Example 11.5.1 (Path-Tracking for Arc-Welding). With reference to the
arc-welding exercise of Example 11.3.2, we want to use the Fanuc Arc Mate,
whose Denavit&ndash;Hartenberg parameters are listed in Table 5.2. Furthermore, the
welding seam to be tracked is placed well within the workspace of the manipulator.
A location found quite suitable for this task was obtained with the aid of RVS, our
Robot Visualization System. This location requires that the coordinate frame FC of
Fig. 11.4 have its axes parallel pairwise to those of the robot base, F1. The latter is
defined according to the Denavit&ndash;Hartenberg notation, and soZ1 coincides with the
axis of the first revolute; it is, moreover, directed upwards. The position found for
the origin OC of FC , of position vector o, is given in F1 as
</p>
<p>Œ o &#141;1 �
</p>
<p>2
</p>
<p>4
</p>
<p>x
</p>
<p>y
</p>
<p>z
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>�1:0
�0:1
0:5
</p>
<p>3
</p>
<p>5 m
</p>
<p>Find the time-histories of all the joint variables that will perform the desired
operation with the tip of the electrode traversing the intersection curve at the
constant speed of v0 D 0:1m/s. Furthermore, plot the variation of the condition
number of the Jacobian matrix along the path.
</p>
<p>Solution: The robot at hand was studied in Sect. 9.7, where it was found not to
be of the decoupled type. In fact, this robot does not admit a closed-form inverse
displacement solution, and hence, the foregoing iterative procedure is to be used.
</p>
<p>At the outset, we calculate all inverse displacement solutions at the pose
corresponding to ' D 0 using the bivariate-equation approach of Sect. 9.4. This
pose is defined by the orthogonal matrix Q and the position vector p given below:
</p>
<p>ŒQ &#141;1 �
�
</p>
<p>eb et en
�
</p>
<p>D
</p>
<p>2
</p>
<p>4
</p>
<p>0:6030 0 �0:7977
0 1 0
</p>
<p>0:7977 0 0:6030
</p>
<p>3
</p>
<p>5 ; Œp &#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>�0:5500
�0:100
0:8969
</p>
<p>3
</p>
<p>5 m
</p>
<p>with both Q and p given in robot-base coordinates. The contours for the above
pose, which were obtained using the procedure of Sect. 9.4, are shown in Fig. 11.7,
the eight solutions obtained being summarized in Table 11.3, which includes the
condition number of the Jacobian, �.J/, of each solution. Note that the calculation
of �.J/ required computing the characteristic length of the robot, as explained in
Sect. 5.8. This length, as calculated in that section, turned out to be L D 0:3573m.
</p>
<p>Now, we have eight solutions at our disposal, from which we must choose one
for path-tracking. In the absence of any criterion to single out one specific solution,
we can pick up the solution with the lowest condition number. If we do this, we end
up with solution 1 in Table 11.3. However, when we attempted to track the given
path with this solution, it turned out that this solution encountered a singularity and
was hence discarded. Of the seven remaining solutions, solution 5 has the lowest
condition number; this solution led to a singularity-free trajectory.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.5 Continuous-Path Tracking 499
</p>
<p>-150 -100 -50 0 50 100 150
</p>
<p>-150
</p>
<p>-100
</p>
<p>-50
</p>
<p>0
</p>
<p>50
</p>
<p>100
</p>
<p>150
</p>
<p>1
</p>
<p>2
</p>
<p>3
</p>
<p>4
</p>
<p>5
</p>
<p>6
</p>
<p>7
</p>
<p>8
</p>
<p>Fig. 11.7 Contour solutions
of the Fanuc Arc Mate robot
at the given EE pose
</p>
<p>Table 11.3 Inverse kinematics solutions of the Fanuc Arc Mate robot for the given EE pose
</p>
<p>i �.J/ �1 �2 �3 �4 �5 �6
</p>
<p>1 4.74 19:9039ı 124:909ı �176:484ı 16:1379ı �102:29ı �15:8409ı
2 4.85 �3:6664ı 124:723ı �173:071ı 177:019ı 101:19ı �177:208ı
3 11.12 �154:951ı �67:5689ı �135:549ı 141:716ı 146:966ı 17:754ı
4 6.31 �176:328ı �63:4487ı �129:817ı �4:5893ı �140:319ı �178:681ı
5 4.79 �176:341ı 75:1632ı �76:6692ı 3:7343ı 51:4104ı �179:877ı
6 5.20 �153:567ı 73:4546ı �72:5407ı �153:868ı �53:7328ı �0:5046ı
7 8.68 �3:6362ı �129:644ı �32:9672ı �175:011ı �144:428ı 178:133ı
8 9.94 18:9031ı �131:096ı �26:8084ı �28:6793ı 147:417ı 13:0786ı
</p>
<p>Once the appropriate solution is chosen, the trajectory can be tracked with the aid
of Algorithm 11.5.2. Here, we need a discrete set of poses at equal time-intervals.
Note that we can produce such a set at equal intervals of angle ' because we have
expressions for the pose variables in terms of this angle. In order to obtain this set
at equal time-intervals, then, we need angle ' as a function of time, i.e., '.t/. In the
sequel, we will also need the time T required to complete the task. Now, since the
speed of the electrode tip is constant and equal to v0, the time T is readily obtained
by dividing the total length l of the curve by v0. The length of the curve, in turn, can
be computed as s.2�/, where function s.'/ denotes the arc length as a function of
angle ', i.e.,
</p>
<p>s.'/ D
Z '
</p>
<p>0
</p>
<p>kr0.'/kd' (11.82)</p>
<p/>
</div>
<div class="page"><p/>
<p>500 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>We thus obtain, by numerical quadrature,
</p>
<p>l � s.2�/ D 1:0257m
</p>
<p>Hence, the total time is
</p>
<p>T � l
v0
D 10:257 s
</p>
<p>Now, in order to obtain '.t/, we first calculate Ps as
</p>
<p>Ps � ds
dt
D ds
d'
</p>
<p>d'
</p>
<p>dt
D P' ds
</p>
<p>d'
(11.83a)
</p>
<p>Furthermore, we note that ds=d' D kr0.'/k, which allows us to write Ps as
</p>
<p>Ps � P'kr0.'/k
</p>
<p>Moreover, kr0.'/k was found in Eq. (11.39b) to be
</p>
<p>kr0.'/k D rG.'/
</p>
<p>Ps thus becoming
</p>
<p>Ps D rG P' (11.83b)
</p>
<p>Furthermore, we recall the expression derived for G.'/ in Eq. (11.39e). This
expression, along with the constancy condition on Ps, i.e., Ps D v0, leads to
</p>
<p>r P'
p
</p>
<p>1C .� O' sin'/2 D v0
</p>
<p>where r is the radius of the cylinder. Upon solving for P' from the above equation,
we obtain
</p>
<p>P' D v0
r
</p>
<p>s
</p>
<p>�2 � 2� cos'
�2 � 2� cos' C �2 sin2 '
</p>
<p>which is a nonlinear first-order differential equation for '.t/. Its initial value can
be assigned as '.0/ D 0, thereby formulating a nonlinear first-order initial-value
problem. The numerical solution of the foregoing problem is nowadays routine
work, which can be handled with suitable software, e.g., Matlab (Hanselman and
Littlefield 2001). Upon solving this equation, a data file is produced that contains the
time-history of '. The plot of ' vs. nondimensional time is displayed in Fig. 11.8a.
Since the variations of '.t/ are relatively small, this plot provides little information
on the time-history of interest. A more informative plot, that of P'.t/, is included in
Fig. 11.8b for this reason. Apparently, ' turns out to be the sum of a linear and a
periodic term.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.6 Exercises 501
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>0
</p>
<p>2
</p>
<p>4
</p>
<p>6
</p>
<p>8
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>0.55
</p>
<p>0.6
</p>
<p>0.65
</p>
<p>0.7
</p>
<p>(rad)
</p>
<p>(rad/s)
</p>
<p>a
</p>
<p>b
</p>
<p>Fig. 11.8 Plot of P' vs. nondimensional time
</p>
<p>With '.t/ known as a function of time, we can now specify the pose of the end-
effector, i.e., p and Q, as functions of time.
</p>
<p>The whole trajectory was tracked with the robot at hand using the algorithm
outlined in this section. With the aid of this algorithm, we produced the plots
of Fig. 11.9. Also, the time-history of the condition number of the manipulator
Jacobian was computed and plotted in Fig. 11.10. Apparently, the condition number
of the Jacobian remains within the same order of magnitude throughout the whole
operation, below 10, thereby showing that the manipulator remains far enough from
singularities during this task&mdash;the condition number becomes very large when a
singularity is approached, becoming unbounded at singularities. A rendering of the
welding seam with the Frenet&ndash;Serret triad at a sample of points is displayed in
Fig. 11.11. It is noteworthy that the torsion of the path is manifested in this figure by
virtue of the inclination of theZ axis, which changes from point to point. In a planar
curve, this axis would remain at a fixed orientation while traversing the curve.
</p>
<p>11.6 Exercises
</p>
<p>11.1 A PUMA 560 robot, with the DH parameters of Table 11.4, is used to perform
a gluing operation as indicated below: A nozzle dispensing the glue is rigidly
attached to the gripper of the robot. The tip of the nozzle, point P , is to trace
a helicoidal path at a constant rate of 50 mm/s. Furthermore, the center of the
wrist is located at a point C , fixed to a Frenet&ndash;Serret coordinate frame. In this</p>
<p/>
</div>
<div class="page"><p/>
<p>502 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>0 0.5 1
</p>
<p>160
</p>
<p>180
</p>
<p>200
</p>
<p>220
</p>
<p>0 0.5 1
</p>
<p>60
</p>
<p>70
</p>
<p>80
</p>
<p>90
</p>
<p>0 0.5 1
</p>
<p>250
</p>
<p>300
</p>
<p>350
</p>
<p>0 0.5 1
</p>
<p>0
</p>
<p>200
</p>
<p>400
</p>
<p>0 0.5 1
</p>
<p>40
</p>
<p>60
</p>
<p>80
</p>
<p>100
</p>
<p>0 0.5 1
</p>
<p>160
</p>
<p>180
</p>
<p>200
</p>
<p>Fig. 11.9 Time-histories of the joint variables (in degrees) of the Fanuc Arc Mate robot used to
track a warped curve for arc-welding vs. nondimensional time
</p>
<p>0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1
</p>
<p>3
</p>
<p>3.5
</p>
<p>4
</p>
<p>4.5
</p>
<p>5
</p>
<p>5.5Fig. 11.10 Time-history of
the condition number of the
Jacobian matrix during an
arc-welding operation vs.
nondimensional time
</p>
<p>frame, the coordinates of C are . 0; �50; 86:7 /mm. Moreover, the path to
be traced by point P is given as
</p>
<p>x D a cos#; y D a sin#; z D b#; 0 � # � �=2
</p>
<p>with the values a D 300mm, b D 800=� mm.
(a) Decide where to locate the robot base with respect to the path so that the latter
</p>
<p>will lie well within the workspace of the robot. Then, produce plots of �i vs.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.6 Exercises 503
</p>
<p>Fig. 11.11 Welding seam
with Frenet&ndash;Serret frames
</p>
<p>Table 11.4 DH parameters
of a PUMA 560 robot Joint i ˛i (
</p>
<p>ı) ai (m) bi (m)
</p>
<p>1 90 0 0:660
2 0 0.432 0
3 90 0.020 0:149
4 90 0 0:432
5 90 0 0
6 0 0 0:056
</p>
<p>t , for 0 � t � T , where T is the time it takes to traverse the whole trajectory,
for i D 1; 2; : : : ; 6.
</p>
<p>(b) Produce plots of P�i vs. t in the same time interval for all six joints.
(c) Produce plots of R�i vs. t in the same time interval for all six joints.
</p>
<p>11.2 A bracket for spot-welding, shown in Fig. 11.12, is rigidly attached to the
end-effector of a robotic manipulator. It is desired that point P of the bracket
follow a helicoidal path � , while keeping the orientation of the bracket with
respect to � as indicated below: Let B � fi0; j0;k0g and F7 � fi7; j7;k7g
be triads of unit orthogonal vectors fixed to the base of the robot and to the
bracket, respectively. Moreover, let F � fet ; en; ebg be the Frenet&ndash;Serret triad
of � , given as</p>
<p/>
</div>
<div class="page"><p/>
<p>504 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>Fig. 11.12 A bracket for spot-welding
</p>
<p>et D �0:6 sin'i0 C 0:6 cos'j0 C 0:8k0
en D � cos'i0 � sin'j0
eb D 0:8 sin'i0 � 0:8 cos 'j0 C 0:6k0
</p>
<p>where ' is a given function of time, '.t/.
Furthermore, the orientation of the bracket with respect to � is to be kept
</p>
<p>constant and given in terms of the Frenet&ndash;Serret triad as
</p>
<p>i7 D 0:933et C 0:067en � 0:354eb
j7 D 0:067et C 0:933en C 0:354eb
k7 D 0:354et � 0:354en C 0:866eb
</p>
<p>Additionally, R and S.t/ denote the rotation matrices defining the orienta-
tion of F7 with respect to F and of F with respect to B, respectively.
</p>
<p>(a) Find the matrix representation of S.t/ in B.
(b) Find the matrix representation of R in F .
(c) Let Q.t/ denote the orientation of F7 with respect to B. Find its matrix
</p>
<p>representation in B.</p>
<p/>
</div>
<div class="page"><p/>
<p>11.6 Exercises 505
</p>
<p>(d) Find the Darboux vector ı of the path, along with its time-derivative, Pı, in
base-fixed coordinates. Note: You can do this in several ways, as discussed
in Sect. 11.2. Choose the one that will allow you to use previously computed
</p>
<p>results, thereby simplifying the computations.
</p>
<p>11.3 The parametric equations of a curve are given as
</p>
<p>x D 2t; y D t2; z D t3=3
</p>
<p>where t is time. A robotic manipulator is to follow this trajectory so that its
gripper keeps a constant orientation with respect to the Frenet&ndash;Serret frame
of the curve.
</p>
<p>(a) Determine the unit vector parallel to the axis of rotation and the angle of
rotation of the gripper as functions of time.
</p>
<p>(b) Find the angular velocity and angular acceleration of the gripper as functions
of time.
</p>
<p>11.4 Derive Eqs. (11.45a and b).
11.5 Find the spline approximation of the helix of Example 11.3.1. Then, plot the
</p>
<p>approximation errors of the Cartesian coordinates of points of the helix, for
N D 5, 11, and 21 equally spaced supporting points. In order to assess the
orientation error, compute the Darboux vectors of the spline, ıs , and of the
helix, ıh. The approximation error of the orientation is now defined as
</p>
<p>eo � max
'
fkıs.'/ � ıh.'/kg
</p>
<p>with ' defined as in Example 11.3.1.
11.6 Find the spline approximation of the curvature, torsion, and Darboux vector
</p>
<p>of the curve introduced in Example 11.3.2. Find expressions for the exact
values of these variables and plot the approximation errors, for 5, 10, and 20
equally spaced supporting points vs. '. In the error definitions given below,
subscript e indicates exact value, subscript s spline value:
</p>
<p>e� � �s.'/ � �e.'/
e� � �s.'/ � �e.'/
eı � kıs.'/ � ıe.'/k
</p>
<p>11.7 From the plots of the time-histories of the joint angles calculated in Exam-
ple 11.5.1, it is apparent that, with the exception of �4, which has a linear
component, these histories are periodic. Repeat Example 11.5.1, but now
using a spline approximation of the welding seam, with N D 5; 10, and
20 supporting points. With this spline approximation, calculate the pose, the
twist, and the twist-rate at each supporting point. Now, calculate values of � ,</p>
<p/>
</div>
<div class="page"><p/>
<p>506 11 Trajectory Planning: Continuous-Path Operations
</p>
<p>P� , and R� at each of these supporting points by means of inverse kinematics.
Compare the values thus obtained of R� with those derived from the linear
relation between the function values and the values of its second derivative at
the supporting points when using a cubic spline.
</p>
<p>11.8 The decoupled robot of Fig. 4.23 is to perform an arc-welding operation along
a welding seam that requires its wrist center C to travel at a constant speed
of 1m=s along a line joining points A and B , not shown in that figure, while
keeping the EE holding the electrode at a constant orientation with respect
to the base frame. Moreover, the seam is to be traversed according to the
following schedule: With point C located at a point A0 on the extension of
AB , a distance of 250mm from A, point C approaches A with a cycloidal
motion at the specified speed; upon reaching B , point C decelerates with a
cycloidal motion as well, until it reaches a point B 0 in the other extension of
AB , 250mm from B , with zero speed. The position vectors of points A and
B , denoted by a and b, respectively, are given, in base coordinates, as
</p>
<p>a D
</p>
<p>2
</p>
<p>4
</p>
<p>500
</p>
<p>�500
500
</p>
<p>3
</p>
<p>5 ; b D
</p>
<p>2
</p>
<p>4
</p>
<p>1; 200
</p>
<p>0
</p>
<p>1; 200
</p>
<p>3
</p>
<p>5
</p>
<p>in mm. For the above-given data, find the time-histories of all joint variables.
</p>
<p>11.9 Derive expressions (11.45a and b).
11.10 If linear invariants are used to represent the desired pose sd , then q D 0 and
</p>
<p>q0 D 1when the angle of rotation becomes � . Under these conditions, matrix
T of Eq. (11.72) becomes rank-deficient, this equation thus not necessarily
leading to Eq. (11.73). One way of coping with this algorithmic singularity
consists in redefining axis X1 of the DH notation by rotating the current X1
axis by an angle&#129;�1 about Z1, which does not affect the remaining variables
and parameters of the said notation.
</p>
<p>Find the optimum value of &#129;�1 that will take T &ldquo;farthest&rdquo; from its current
rank-deficiency.</p>
<p/>
</div>
<div class="page"><p/>
<p>Chapter 12
</p>
<p>Dynamics of Complex Robotic Mechanical
Systems
</p>
<p>12.1 Introduction
</p>
<p>The subject of this chapter is the dynamics of the class of robotic mechanical
systems introduced in Chap. 10 under the generic name of complex. Notice that
this class comprises serial manipulators not allowing a decoupling of the orientation
from the positioning tasks. For purposes of dynamics, this decoupling is irrelevant
and hence, was not a condition in the study of the dynamics of serial manipulators in
Chap. 7. Thus, serial manipulators need not be further studied here, the focus being
on parallel manipulators and rolling robots. The dynamics of walking machines and
multifingered hands involves special features that render these systems more elab-
orate from the dynamics viewpoint, for they exhibit a time-varying topology. What
this means is that these systems include kinematic loops that open when a leg takes
off or when a finger releases an object and open chains that close when a leg touches
ground or when a finger makes contact with an object. The implication here is that
the degree of freedom of these systems is time-varying. The derivation of such a
mathematical model is discussed in Pfeiffer et al. (1995), but is left out in this book.
</p>
<p>The degree of freedom (dof) of the mechanical systems studied here is thus
constant. Now, the two kinds of systems studied here pertain to very different types,
for parallel manipulators fall into the realm of holonomic, while rolling robots
into that of nonholonomic, mechanical systems. In order to better understand this
essential difference between these two types of systems, we give below a summary
of the classification of mechanical systems at large.
</p>
<p>12.2 Classification of Robotic Mechanical Systems
</p>
<p>with Regard to Dynamics
</p>
<p>Because robotic mechanical systems are a class of general mechanical systems,
a classification of the latter will help us focus on the systems motivating this
study. Mechanical systems can be classified according to various criteria, the most
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5__12,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>507</p>
<p/>
</div>
<div class="page"><p/>
<p>508 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>common one being based on the type of constraints to which these systems are
subjected. In this context we find holonomic vs. nonholonomic and scleronomic vs.
rheonomic constraints. Holonomic constraints are those that are expressed either
as a system of algebraic equations in displacement variables, whether angular or
translational, not involving any velocity variables, or as a system of equations in
velocity variables that nevertheless can be integrated as a whole to produce a system
of equations of the first type. Note that it is not necessary that every single scalar
equation of velocity constraints be integrable; rather, the whole system must be
integrable for the system of velocity constraints to lead to a system of displacement
constraints. If the system of velocity constraints is not integrable, the constraints
are said to be nonholonomic. Moreover, if a mechanical system is subject only to
holonomic constraints, it is said to be holonomic; otherwise, it is nonholonomic.
Manipulators composed of revolute and prismatic pairs are examples of holonomic
systems, while wheeled robots are usually nonholonomic systems. On the other
hand, if a mechanical system is subject to constraints that are not explicit functions
of time, these constraints are termed scleronomic, while if the constraints are explicit
functions of time, they are termed rheonomic. For our purposes, however, this
distinction is irrelevant.
</p>
<p>In order to understand better one more classification of mechanical systems,
we recall the concepts of generalized coordinate and generalized speed that were
introduced in Sect. 7.3.2. The generalized coordinates of a mechanical system are
all those displacement variables, whether rotational or translational, that determine
uniquely a configuration of the system. Note that the set of generalized coordinates
of a system is not unique. Moreover, various sets of generalized coordinates of
a mechanical system need not have the same number of elements, but there is a
minimum number below which the set of generalized coordinates cannot define
the configuration of the system. This minimum number corresponds, in the case
of holonomic systems, to the degree of freedom of the system. Serial and parallel
manipulators coupled only by revolute or prismatic pairs are holonomic, their joint
variables, grouped in vector � , playing the role of generalized coordinates, while
their joint rates, grouped in vector P� , in turn, play the role of generalized speeds.
Note that in the case of parallel manipulators, not all joint variables are independent
generalized coordinates. In the case of nonholonomic systems, on the other hand,
the number of generalized coordinates needed to fully specify their configuration
exceeds their degree of freedom by virtue of the lack of integrability of their
kinematic constraints. This concept is best illustrated with the aid of examples,
which are included in Sect. 12.5. Time-derivatives of the generalized coordinates,
or linear combinations thereof, are termed the generalized speeds of the system.
If the kinetic energy of a mechanical system is zero when all its generalized speeds
are set equal to zero, the system is said to be catastatic. If, on the contrary, the
kinetic energy of the system is nonzero even if all the generalized speeds are set
equal to zero, the system is said to be acatastatic. All the systems that we will study
in this chapter are catastatic. A light robot mounted on a heavy noninertial base that</p>
<p/>
</div>
<div class="page"><p/>
<p>12.3 The Structure of the Dynamics Models of Holonomic Systems 509
</p>
<p>undergoes a controlled motion is an example of an acatastatic system, for the motion
of the base can be assumed to be insensitive to the dynamics of the robot; however,
the motion of the base does affect the dynamics of the robot.
</p>
<p>Another criterion used in classifying mechanical systems, which pertains specif-
ically to robotic mechanical systems, is based on the type of actuation. In general,
a system needs at least as many independent actuators as degrees of freedom.
However, instances arise in which the number of actuators is greater than the degree
of freedom of the system. In these instances, we speak of redundantly actuated
systems. In view of the fundamental character of this book, we will not study
redundant actuation here; we will thus assume that the number of independent
actuators equals the degree of freedom of the system.
</p>
<p>The main results of this chapter are applicable to robotic mechanical systems
at large. For brevity, we will frequently refer to the objects of our study simply as
systems.
</p>
<p>12.3 The Structure of the Dynamics Models
</p>
<p>of Holonomic Systems
</p>
<p>We saw in Sect. 7.6 that the mathematical model of a manipulator of the serial
type contains basically three terms, namely, one linear in the joint accelerations,
one quadratic in the joint rates, and one arising from the environment, i.e., from
actuators, dissipation, and potential fields such as gravity. We show in this section
that in fact, the essential structure of this model still holds in the case of more general
mechanical systems subject to holonomic constraints, if we regard the rates of the
actuated joints as the independent generalized speeds of the system. Nonholonomic
robotic systems are studied in Sect. 12.5.
</p>
<p>First, we will assume that the mechanical system at hand is composed of r rigid
bodies and its degree of freedom is n. Henceforth, we assume that these bodies are
coupled in such a way that they may form kinematic loops; for this reason, such
systems contain some unactuated joints. Definitions similar to those of Sect. 7.3.1
are henceforth adopted. In this vein, the manipulator mass matrix of that section
becomes now, more generically, the 6r � 6r system mass matrix M, the 6r � 6r
system angular velocity matrix W, and the 6r-dimensional system twist vector t
being defined likewise.
</p>
<p>We assume further that the total number of joints, active and passive, is m &gt; n.
The m-dimensional array � of joint variables, associated with both actuated and
unactuated joints, is thus naturally partitioned into two subarrays, the n-dimensional
vector of actuated joint variables �a and its m0-dimensional unactuated counterpart
�u, with m0 � m � n, namely,
</p>
<p>� D
�
</p>
<p>�a
</p>
<p>�u
</p>
<p>�
</p>
<p>(12.1)</p>
<p/>
</div>
<div class="page"><p/>
<p>510 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>We can now set up the mathematical model of the system at hand using the
natural orthogonal complement, as introduced in Sect. 7.5. Since the system under
study has n degrees of freedom, the model sought must be a system of n second-
order ordinary differential equations. We can proceed to derive this model as we did
in Sect. 7.5, by regarding all joints first as if they were independent, but taking into
account that only n of the total m joints are actuated. We do this by introducing
a vector of constraint forces, as is done in the realm of Lagrangian dynamics
(T&ouml;r&ouml;k 2000). In this vein, we first represent the twists of all the moving links as
linear transformations of the joint-rate vector P� , then assemble all the individual
six-dimensional twist arrays into the 6r-dimensional array t defined above as the
system twist. We thus end up with a relation of the form
</p>
<p>t D U.�/ P� (12.2)
</p>
<p>where U.�/ is the 6r � m twist-shaping matrix, playing a role similar to that of
matrix T of Sect. 7.5. Moreover, the constraints relating all joint rates can be cast in
the form
</p>
<p>A.�/ P� D 0p (12.3)
</p>
<p>where A.�/ is a p�mmatrix, whereby p &lt; m, with nullity&mdash;the nullity of a matrix
is the dimension of its null space&mdash;� D n, and 0p is the p-dimensional zero vector.
Given the nullity of A.�/, up to n of the m components of � can be assigned freely
without violating the constraints (12.3), which is compatible with the assumption
on the dof of the system. Note that, in setting up the foregoing p constraints on the
joint rates, the number p depends on the topology of the system, i.e., on its number
of links; on its number of joints; and on how the links are coupled, so as to form
kinematic loops.
</p>
<p>In applying the procedure of the natural orthogonal complement to the con-
strained system, we end up with a system of m second-order ordinary differential
equations, namely, the Euler&ndash;Lagrange equations of a system constrained by the
relations (12.3), which thus takes the form
</p>
<p>QI R� C QC.�; P�/ P� D Q� C Qı C Q&#13; C QJTwW C AT� (12.4a)
</p>
<p>The above equation contains terms that are familiar from Sect. 7.5, except for the last
term of the right-hand side. This term accounts for the generically termed constraint
forces and amounting to constraint joint torques and forces that must be exerted at
all joints in order to maintain the topology of the system. Vector � is termed the
vector of Lagrange multipliers in the realm of Lagrangian dynamics. In the above
equation, the definitions below, similar to those of Eqs. (7.58) and (7.59), have been
introduced:</p>
<p/>
</div>
<div class="page"><p/>
<p>12.3 The Structure of the Dynamics Models of Holonomic Systems 511
</p>
<p>QI.�/ � UTMU (12.4b)
QC.�; P�/ � UTM PUC UTWMU (12.4c)
</p>
<p>Q� � UTwA; Qı � UTwD; Q&#13; � UTwG (12.4d)
</p>
<p>Moreover, wA, wD , wG , and wW are the various types of wrenches acting on the
system: exerted by the actuators; stemming from dissipation effects; due to the
gravity field; and exerted by the environment, respectively. In turn, QJ is the 6 � m
Jacobian matrix mapping the system joint rates into the end-effector twist, while
wW is assumed applied onto the end-effector.
</p>
<p>Upon resorting to the kinematics of the system, it is possible to express the vector
of joint rates P� as a linear transformation of the vector of actuated joint rates P�a,
namely,1
</p>
<p>P� D &sbquo;.�a/ P�a (12.5)
</p>
<p>where we have assumed that, from the geometry of the system, �u has been solved
for in terms of �a. Further, upon substitution of Eq. (12.5) into Eq. (12.3), we obtain
</p>
<p>A.�/&sbquo;.�a/ P�a D 0p
</p>
<p>which must hold for any P�a, given the dof of the system. As a consequence, then,
</p>
<p>A.�/&sbquo;.�a/ D Opn (12.6)
</p>
<p>and hence, &sbquo;.�a/ is an orthogonal complement of A.�/, which we can also call
a natural orthogonal complement. Notice, however, that contrary to the natural
orthogonal complement U, which maps the joint-rate vector onto the system twist,
&sbquo; maps the space of actuated joint rates into that of the system joint rates.
Apparently,
</p>
<p>R� D &sbquo;.�a/ R�a C P&sbquo;.�a; P�a/ P�a (12.7)
</p>
<p>Upon substitution of Eq. (12.7) into Eq. (12.4a), we obtain
</p>
<p>QI&sbquo; R�a C QI P&sbquo; P�a C QC.�a; P�a/&sbquo; P�a D Q� C Qı C Q&#13; C QJTwW C AT�
</p>
<p>Further, the term of constraint forces is eliminated from the above equations upon
multiplying both sides of the above equation by &sbquo;T from the left, thus obtaining
the mathematical model sought, i.e.,
</p>
<p>I R�a C C P�a D � C ı C &#13; C JTwW (12.8a)
</p>
<p>1&sbquo; is not to be confused with the matrix defined in Eqs. (10.54a and b).</p>
<p/>
</div>
<div class="page"><p/>
<p>512 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>with the definitions below:
</p>
<p>I D TTMT; C D TTM PTC TTWMT; J D QJ&sbquo;; (12.8b)
� D &sbquo;T Q�; ı D &sbquo;T Qı; &#13; D &sbquo;T Q&#13;; (12.8c)
</p>
<p>and
</p>
<p>T D U&sbquo; (12.8d)
</p>
<p>That is, the mathematical model governing the dynamics of any holonomic robotic
mechanical system is formally identical to that of Eq. (7.61) obtained for serial
manipulators.
</p>
<p>12.4 Dynamics of Parallel Manipulators
</p>
<p>We illustrate the modeling techniques of mechanical systems with kinematic loops
via a class of systems known as parallel manipulators. While parallel manipulators
can take on a large variety of forms, we focus here on those termed platform
manipulators, with an architecture similar to that of flight simulators. In platform
manipulators we can distinguish two special links, namely, the base B and the
moving platform M. Moreover, these two links are coupled via six legs, with
each leg constituting a six-axis kinematic chain of the serial type, as shown in
Fig. 12.1, whereby a wrench wW , represented by a double-headed arrow, acts on
M and is applied at CM, the mass center of M. This figure shows the axes of
the revolutes coupling the legs to the two platforms as forming regular polygons.
However, the modeling discussed below is not restricted to this particular geometry.
As a matter of fact, these axes need not even be coplanar. On the other hand,
the architecture of Fig. 12.1 is very general, for it includes more specific types of
platform manipulators, such as flight simulators. In these, the first three revolute
axes stemming from the base platform have intersecting axes, thereby giving rise to
a spherical kinematic pair, while the upper two axes intersect at right angles, thus
constituting a universal joint. Moreover, the intermediate joint in flight simulators is
not a revolute, but rather a prismatic pair, which is the actuated joint of the leg. A leg
kinematically equivalent to that of flight simulators can be obtained from that of
the manipulator of Fig. 12.1, if the intermediate revolute has an axis perpendicular
to the line connecting the centers of the spherical and the universal joints of the
corresponding leg, as shown in Fig. 12.2. In flight simulators, the pose of the moving
platform is controlled by hydraulic actuators that vary the distance between these
two centers. In the revolute-coupled equivalent leg, the length of the same line is
controlled by the rotation of the intermediate revolute.</p>
<p/>
</div>
<div class="page"><p/>
<p>12.4 Dynamics of Parallel Manipulators 513
</p>
<p>Fig. 12.1 A platform-type
parallel manipulator
</p>
<p>Fig. 12.2 A leg of a simple
platform-type parallel
manipulator
</p>
<p>Shown in Fig. 12.3 is the graph of the system depicted in Fig. 12.1. In that graph,
the nodes denote rigid links, while the edges denote joints. By application of Euler&rsquo;s
formula for graphs (Harary 1972), the number � of independent loops of a system
with many kinematic loops is given by</p>
<p/>
</div>
<div class="page"><p/>
<p>514 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>Fig. 12.3 The graph of the
flight simulator
</p>
<p>� D j � l C 1 (12.9)
</p>
<p>where j is the number of revolute and prismatic joints and l is the number of links.
Thus, if we apply Euler&rsquo;s formula to the system of Fig. 12.1, we conclude
</p>
<p>that its kinematic chain contains five independent loops. Hence, while the chain
apparently contains six distinct loops, only five of these are independent. Moreover,
the degree of freedom of the manipulator is six. Indeed, the total number of links
of the manipulator is l D 6 � 5 C 2 D 32. Of these, one is fixed, and hence, we
have 31 moving links, each with six degrees of freedom prior to coupling. Thus, we
have a total of 31 � 6 D 186 degrees of freedom at our disposal. Upon coupling,
each revolute removes five degrees of freedom, and hence, the 36 kinematic pairs
remove 180 degrees of freedom, the manipulator thus being left with 6 degrees of
freedom. We derive below the mathematical model governing the motion of the
overall system in terms of the independent generalized coordinates associated with
the actuated joints of the legs.
</p>
<p>We assume, henceforth, that each leg is a six-axis open kinematic chain with
either revolute or prismatic pairs, only one of which is actuated, and we thus have
as many actuated joints as degrees of freedom. Furthermore, we label the legs with
Roman numerals I , II , : : :, VI and denote the mass center of the mobile platform
M by CM, with the twist of M denoted by tM and defined at the mass center. That
is, if cM denotes the position vector of CM in an inertial frame and PcM its velocity,
while !M is the angular velocity of M, then</p>
<p/>
</div>
<div class="page"><p/>
<p>12.4 Dynamics of Parallel Manipulators 515
</p>
<p>Fig. 12.4 The free-body
diagram of M
</p>
<p>tM �
�
</p>
<p>!M
</p>
<p>PcM
</p>
<p>�
</p>
<p>(12.10)
</p>
<p>Next, the Newton&ndash;Euler equations of M are derived from the free-body diagram
shown in Fig. 12.4. In this figure, the legs have been replaced by the constraint
wrenches fwCJ gVII acting at point CM, the governing equation thus taking the form
of Eq. (7.5c), namely,
</p>
<p>MMPtM D �WMMMtM C wW C
VI
X
</p>
<p>JDI
wCJ (12.11)
</p>
<p>with wW denoting the external wrench acting on M. Furthermore, let us denote by
qJ the variable of the actuated joint of the J th leg, all variables of the six actuated
joints being grouped in the six-dimensional array q, i.e.,
</p>
<p>q �
�
</p>
<p>qI qII � � � qVI
�T
</p>
<p>(12.12)
</p>
<p>Now, we derive a relation between the twist tM and the active joint rates, PqJ , for
J D I , II , : : :, VI . To this end, we resort to Fig. 12.5, depicting the J th leg as a
serial-type, six-axis manipulator, whose twist&ndash;shape relations are readily expressed
as in Eq. (5.9), namely,
</p>
<p>JJ P�J D tM; J D I; II; : : : ; VI (12.13)
</p>
<p>where JJ is the 6 � 6 Jacobian matrix of the J th leg.
In Fig. 12.5, the moving platform M has been replaced by the constraint wrench
</p>
<p>transmitted by the moving platform onto the end link of the J th leg, �wCJ , whose
sign is the opposite of that transmitted by this leg onto M by virtue of Newton&rsquo;s
third law. The dynamics model of the manipulator of Fig. 12.5 then takes the form
</p>
<p>IJ R�J C CJ .�J ; P�J / P�J D �J � JTJ wCJ ; J D I; II; : : : ; VI (12.14)
</p>
<p>where IJ is the 6 � 6 inertia matrix of the manipulator, while CJ is the matrix
coefficient of the inertia terms that are quadratic in the joint rates. Moreover, �J and
�J denote the six-dimensional vectors of joint variables and joint torques, namely,</p>
<p/>
</div>
<div class="page"><p/>
<p>516 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>Fig. 12.5 The serial manipulator of the J th leg
</p>
<p>�J �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>�J1
�J2
:::
</p>
<p>�J6
</p>
<p>3
</p>
<p>7
7
7
5
; �J �
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
4
</p>
<p>0
:::
</p>
<p>�Jk
0
:::
</p>
<p>0
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
5
</p>
<p>(12.15)
</p>
<p>with subscript Jk denoting in turn the only actuated joint of the J th leg, namely, the
kth joint of the leg. If we now introduce eJk , defined as a unit vector all of whose
entries are zero except for the kth entry, which is unity, then we can write
</p>
<p>�J D fJ eJk (12.16)
</p>
<p>If the actuated joint is prismatic, as is the case in flight simulators, then fJ is a force;
if this joint is a revolute, then fJ is a torque.
</p>
<p>Now, since the dimension of q coincides with the degree of freedom of the
manipulator, it is possible to find, within the framework of the natural orthogonal
complement, a 6� 6 matrix LJ mapping the vector of actuated joint rates Pq into the
vector of J th-leg joint-rates, namely,
</p>
<p>P�J D LJ Pq; J D I; II; : : : ; VI (12.17)
</p>
<p>The calculation of LJ will be illustrated with an example.
Moreover, if the manipulator of Fig. 12.5 is not at a singular configuration, then
</p>
<p>we can solve for wCJ from Eq. (12.14), i.e.,</p>
<p/>
</div>
<div class="page"><p/>
<p>12.4 Dynamics of Parallel Manipulators 517
</p>
<p>wCJ D J�TJ .�J � IJ R�J � CJ P�J / (12.18)
</p>
<p>in which the superscript �T stands for the transpose of the inverse, or equivalently,
the inverse of the transpose, while IJ D IJ .�J / and CJ D CJ .�J ; P�J /. Further,
we substitute wCJ as given by Eq. (12.18) into Eq. (12.11), thereby obtaining the
Newton&ndash;Euler equations of the moving platform free of constraint wrenches.
Additionally, the equations thus resulting now contain inertia terms and joint torques
pertaining to the J th leg, namely,
</p>
<p>MMPtM D �WMMMtM C wW C
VI
X
</p>
<p>JDI
J�TJ .�J � IJ R�J � CJ P�J / (12.19)
</p>
<p>Still within the framework of the natural orthogonal complement, we set up the
relation between the twist tM and the vector of actuated joint rates Pq as
</p>
<p>tM D T Pq (12.20)
</p>
<p>which upon differentiation with respect to time, yields
</p>
<p>PtM D T RqC PT Pq (12.21)
</p>
<p>In the next step, we substitute tM and its time-derivative as given by Eqs. (12.20
and 12.21) into Eq. (12.19), thereby obtaining
</p>
<p>MM.T RqC PT Pq/CWMMMT Pq
</p>
<p>C
VI
X
</p>
<p>JDI
J�TJ .IJ R�J C CJ P�J / D wW C
</p>
<p>VI
X
</p>
<p>JDI
J�TJ �J (12.22)
</p>
<p>Further, we recall relation (12.17), which upon differentiation with respect to
time, yields
</p>
<p>R�J D LJ RqC PLJ Pq (12.23)
</p>
<p>Next, relations (12.17 and 12.23) are substituted into Eq. (12.22), thereby obtaining
the model sought in terms only of actuated joint variables. After simplification, this
model takes the form
</p>
<p>MMT RqCMM PT PqCWMMMT Pq
</p>
<p>C
JDVI
X
</p>
<p>JDI
J�TJ .IJLJ RqC IJ PLJ PqC CJLJ Pq/ D wW C
</p>
<p>VI
X
</p>
<p>JDI
J�TJ �J (12.24)
</p>
<p>where now IJ D IJ .q/ and CJ D CJ .q; Pq/.
Our final step in this formulation consists in deriving a reduced 6 � 6 model
</p>
<p>in terms only of actuated joint variables. Prior to this step, we note that from
Eqs. (12.13), (12.17), and (12.20),</p>
<p/>
</div>
<div class="page"><p/>
<p>518 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>LJ D J�1J T (12.25)
</p>
<p>Upon substitution of the above relation into Eq. (12.24) and multiplication of both
sides of Eq. (12.24) by TT from the left, we obtain the desired model in the form of
Eqs. (12.8a), namely,
</p>
<p>M.q/ RqC N.q; Pq/ Pq D �W C
VI
X
</p>
<p>JDI
LJ�J (12.26)
</p>
<p>with the 6 � 6 matrices M.q/, N.q; Pq/, and vector �W defined as
</p>
<p>M.q/ � TTMMTC
VI
X
</p>
<p>JDI
LTJ IJLJ (12.27a)
</p>
<p>N.q; Pq/ � TT .MM PTCWMMMT/C
VI
X
</p>
<p>JDI
LTJ .IJ
</p>
<p>PLJ C CJLJ / (12.27b)
</p>
<p>�W � TTwW (12.27c)
</p>
<p>Alternatively, the foregoing variables can be expressed in a more compact form that
will shed more light on the above model. To do this, we define the 36� 36 matrices
I and C as well as the 6� 36 matrix L, the 6� 6 matrixƒ, and the six-dimensional
vector � as
</p>
<p>I � diag.II ; III ; : : : ; IVI / (12.28a)
C � diag.CI ; CII ; : : : ; CVI / (12.28b)
L �
</p>
<p>�
</p>
<p>LI LII : : : LVI
�
</p>
<p>(12.28c)
</p>
<p>ƒ �
�
</p>
<p>LI eIk LII eIIk : : : LVI eVIk
�
</p>
<p>(12.28d)
</p>
<p>� �
�
</p>
<p>fI fII : : : fVI
�T
</p>
<p>(12.28e)
</p>
<p>and hence,
</p>
<p>M.q/ � TTMMTC LT IL (12.29a)
N.q; Pq/ � TT .MM PTCWMMMT/C LT I PLC LTC.q; Pq/L (12.29b)
</p>
<p>VI
X
</p>
<p>JDI
LTJ �J � ƒ� (12.29c)
</p>
<p>whence the mathematical model of Eq. (12.26) takes on a more familiar form,
namely,</p>
<p/>
</div>
<div class="page"><p/>
<p>12.4 Dynamics of Parallel Manipulators 519
</p>
<p>M.q/ RqC N.q; Pq/ Pq D �W Cƒ� (12.30)
</p>
<p>Thus, for inverse dynamics, we want to determine � for a motion given by q and
Pq, which can be done from the above equation, namely,
</p>
<p>� D ƒ�1ŒM.q/ RqC N.q; Pq/ Pq � �W &#141; (12.31)
</p>
<p>Notice, however, that the foregoing solution is not recursive, and since it requires
linear-equation solving, it is of order n3, which thus yields a rather high numer-
ical complexity. It should be possible to produce a recursive algorithm for the
computation of �, but this issue will not be pursued here. Moreover, given the
parallel structure of the manipulator, the associated recursive algorithm should
be parallelizable with multiple processors.
</p>
<p>For purposes of direct dynamics, on the other hand, we want to solve for Rq from
Eq. (12.30). Moreover, for simulation purposes, we need to derive the state-variable
equations of the system at hand. This can be readily done if we define r � Pq, the
state-variable model thus taking on the form
</p>
<p>Pq D r (12.32a)
Pr D M�1Œ�N.q; r/rC �W Cƒ�&#141; (12.32b)
</p>
<p>In light of the matrix inversion of the foregoing model, then, the complexity of the
forward dynamics computations is also of order n3.
</p>
<p>Example 12.4.1. Derive matrix LJ of Eq. (12.17) for a manipulator having six
identical legs like that of Fig. 12.2, the actuators being placed at the fourth joint.
</p>
<p>Solution: We attach coordinate frames to the links of the serial chain of the J th leg
following the Denavit&ndash;Hartenberg notation, while noting that the first three joints
intersect at a common point, and hence, r1 D r2 D r3. According to this notation,
we recall, vector ri is directed from the origin Oi of the i th frame to the operation
point of the manipulator, which in this case, is CM. The Jacobian matrix of the J th
leg then takes the form
</p>
<p>JJ D
�
</p>
<p>e1 e2 e3 e4 e5 e6
</p>
<p>e1 � r1 e2 � r1 e3 � r1 e4 � r4 e5 � r5 e6 � r5
</p>
<p>�
</p>
<p>J
</p>
<p>the subscript J of the array in the right-hand side reminding us that the vectors
inside it pertain to the J th leg. Thus, matrix JJ maps the joint-rate vector of the J th
leg, P�J , into the twist tM of the platform, i.e.,
</p>
<p>JJ P�J D tM
</p>
<p>Clearly, the joint-rate vector of the J th leg is defined as</p>
<p/>
</div>
<div class="page"><p/>
<p>520 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>P�J �
� P�J1 P�J2 P�J3 P�J4 P�J5 P�J6
</p>
<p>�T
</p>
<p>Now, note that except for P�J4, all joint-rates of this leg are passive and thus need not
appear in the mathematical model of the whole manipulator. Hence, we should aim
at eliminating all joint-rates from the above twist-rate relation, except for the one
associated with the active joint. We can achieve this if we realize that
</p>
<p>rJ1 � eJ i C eJ i � rJ1 D 0; i D 1; 2; 3
</p>
<p>Further, we define a 3 � 6 matrix AJ as
</p>
<p>AJ �
�
</p>
<p>RJ1 1
�
</p>
<p>with RJ1 defined, in turn, as the cross-product matrix of rJ1. Now, upon multiplica-
tion of JJ by AJ from the left, we obtain a 3 � 6 matrix whose first three columns
vanish, namely,
</p>
<p>AJ JJ D
�
</p>
<p>0 0 0 e4 � .r4 � r1/ e5 � .r5 � r1/ e6 � .r5 � r1/
�
</p>
<p>J
</p>
<p>and hence, if we multiply both sides of the above twist&ndash;shape equation by AJ from
the left, we will obtain a new twist&ndash;shape equation that is free of the first three joint
rates. Moreover, this equation is three-dimensional, i.e.,
</p>
<p>Œe4 � .r4 � r1/ P�4 C e5 � .r5 � r1/ P�5 C e6 � .r5 � r1/ P�6&#141;J D �!M � rJ1 C PcM
</p>
<p>where the subscript J attached to the brackets enclosing the whole left-hand side
again reminds us that all quantities therein are to be understood as pertaining to the
J th leg. For example, e4 is to be read eJ4. Furthermore, only P�J4 is associated with
an active joint and denoted, henceforth, by PqJ , i.e.,
</p>
<p>qJ � �J4 (12.33)
</p>
<p>It is noteworthy that the foregoing method of elimination of passive joint rates is not
ad hoc at all. While we applied it here to the elimination of the three joint rates of
a spherical joint, it has been formalized and generalized to all six lower kinematic
pairs (Angeles 1994).
</p>
<p>We have now to eliminate both P�J5 and P�J6 from the foregoing equation. This
can be readily accomplished if we dot-multiply both sides of the same equation by
vector uJ defined as the cross product of the vector coefficients of the two passive
joint rates, i.e.,
</p>
<p>uJ � Œe5 � .r5 � r1/&#141;J � Œe6 � .r5 � r1/&#141;J</p>
<p/>
</div>
<div class="page"><p/>
<p>12.4 Dynamics of Parallel Manipulators 521
</p>
<p>We thus obtain a third twist&ndash;shape relation that is scalar and free of passive joint
rates, namely,
</p>
<p>uJ � Œe4 � .r4 � r1/ P�4&#141;J D uJ � .�!M � rJ1 C PcM/
</p>
<p>The above equation is clearly of the form
</p>
<p>�J PqJ D yTJ tM; PqJ � . P�4/J ; J D I; II; : : : ; VI
</p>
<p>with �J and yJ defined, in turn, as
</p>
<p>�J � uJ � eJ4 � .rJ4 � rJ1/ (12.34a)
</p>
<p>yJ �
�
</p>
<p>�rJ1 � uJ
uJ
</p>
<p>�
</p>
<p>(12.34b)
</p>
<p>Upon assembling the foregoing six scalar twist&ndash;shape relations, we obtain a six-
dimensional twist&ndash;shape relation between the active joint rates of the manipulator
and the twist of the moving platform, namely,
</p>
<p>Z Pq D YtM
</p>
<p>with the obvious definitions for the two 6 � 6 matrices Y and Z given below:
</p>
<p>Y �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>yTI
yTII
:::
</p>
<p>yTVI
</p>
<p>3
</p>
<p>7
7
7
5
; Z � diag.�I ; �II ; : : : ; �VI /
</p>
<p>We now can determine matrix T of the procedure described above, as long as Y is
invertible, in the form
</p>
<p>T D Y�1Z
</p>
<p>whence the leg-matrix LJ of the same procedure is readily determined, namely,
</p>
<p>LJ D J�1J T
</p>
<p>Therefore, all we need now is an expression for the inverse of the leg Jacobian JJ .
This Jacobian is clearly full, which might discourage the reader from attempting its
closed-form inversion. However, a closer look reveals that this Jacobian is similar
to that of decoupled manipulators, studied in Sect. 5.2, and hence, its closed-form
inversion should be reducible to that of a 3 � 3 matrix. Indeed, if we recall the
twist-transfer formula of Eqs. (5.12a and b), we can then write JJ as
</p>
<p>JJ � UJKJ</p>
<p/>
</div>
<div class="page"><p/>
<p>522 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>where UJ is a unimodular 6� 6 matrix and KJ is the Jacobian of the same J th leg,
but now defined with its operation point located at the center of the spherical joint.
Thus,
</p>
<p>UJ �
�
</p>
<p>1 O
</p>
<p>OJ1 � CM 1
</p>
<p>�
</p>
<p>; KJ �
�
</p>
<p>K11 K12
</p>
<p>O K22
</p>
<p>�
</p>
<p>J
</p>
<p>the superscript J indicating the J th leg and with the definitions below:
</p>
<p>O: the 3 � 3 zero matrix;
1: the 3 � 3 identity matrix;
OJ1: the cross-product matrix of oJ1, the position vector of the center of the
</p>
<p>spherical joint;
CM: the cross product matrix of cM, the position vector of CM.
</p>
<p>Furthermore, the 3 � 3 blocks of KJ are defined, in turn, as
</p>
<p>.K11/J �
�
</p>
<p>e1 e2 e3
�
</p>
<p>J
</p>
<p>.K12/J �
�
</p>
<p>e4 e5 e6
�
</p>
<p>J
</p>
<p>.K22/J �
�
</p>
<p>e4 � .r4 � r1/ e5 � .r5 � r1/ e6 � .r5 � r1/
�
</p>
<p>J
</p>
<p>Now, if the inverse of a block matrix is recalled, we have
</p>
<p>K�1J D
�
</p>
<p>K�111 �K�111 K12K�122
O K�122
</p>
<p>�
</p>
<p>J
</p>
<p>where the superscript of the blocks has been transferred to the whole matrix, in order
to ease the notation. The problem of inverting KJ has now been reduced to that of
inverting two of its 3 � 3 blocks. These can be inverted explicitly if we recall the
concept of reciprocal bases (Brand 1965). Thus,
</p>
<p>.K�111 /J D
1
</p>
<p>&#129;J11
</p>
<p>2
</p>
<p>4
</p>
<p>.e2 � e3/T
</p>
<p>.e3 � e1/T
</p>
<p>.e1 � e2/T
</p>
<p>3
</p>
<p>5
</p>
<p>J
</p>
<p>.K�122 /J D
1
</p>
<p>&#129;J22
</p>
<p>2
</p>
<p>4
</p>
<p>Œ.e5 � s5/ � .e6 � s5/&#141;T
Œ.e6 � s5/ � .e4 � s4/&#141;T
Œ.e4 � s4/ � .e5 � s5/&#141;T
</p>
<p>3
</p>
<p>5
</p>
<p>J
</p>
<p>with sJ4, sJ5, &#129;J11, and &#129;
J
22 defined as
</p>
<p>sJ4 � rJ4 � rJ1
sJ5 � rJ5 � rJ1
&#129;J11 � det.KJ11/ D .e1 � e2 � e3/J
&#129;J22 � det.KJ22/ D Œ.e4 � s4/ � .e�s5/ � .e6 � s5/&#141;J</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 523
</p>
<p>the subscripted brackets and parentheses still reminding us that all vectors involved
pertain to the J th leg. Moreover, since UJ is unimodular, its inverse is simply
</p>
<p>U�1J D
�
</p>
<p>1 O
</p>
<p>CM �OJ1 1
</p>
<p>�
</p>
<p>and hence,
</p>
<p>J�1J D
�
</p>
<p>K�111 �K�111 K12K�122 .CM �OJ1/ �K�111 K12K�122
K�122 .CM �OJ1/ K�122
</p>
<p>�
</p>
<p>J
</p>
<p>the matrix sought, LJ , then being calculated as
</p>
<p>LJ D J�1J Y�1Z
</p>
<p>While we have a closed-form inverse of JJ , we do not have one for Y, which is full
and does not bear any particular structure that would allow us its inversion explicitly.
Therefore, matrix LJ should be calculated numerically.
</p>
<p>12.5 Dynamics of Rolling Robots
</p>
<p>The dynamics of rolling robots, similar to that of other robotic mechanical systems,
comprises two main problems, inverse and direct dynamics. We will study both
using the same mathematical model. Hence, the main task here is to derive this
model. It turns out that while rolling robots usually are nonholonomic mechanical
systems, their mathematical models are formally identical to those of holonomic
systems. The difference between holonomic and nonholonomic systems lies in
that, in the former, the number of independent actuators equals the necessary and
sufficient number of variables&mdash;independent generalized coordinates in Lagrangian
mechanics&mdash;defining a posture (configuration) of the system. In nonholonomic
systems, however, the necessary and sufficient number of variables defining a
posture of the system exceeds the number of independent actuators. As a conse-
quence, in holonomic systems the dof equals the number of independent actuators.
In nonholonomic systems, the dof is usually defined as the necessary and sufficient
number of variables defining the system posture, while the number of independent
actuators is termed the system mobility, which thus turns out to be smaller than the
system dof. Therefore, relations between these dependent and independent variables
will be needed and will be derived in the course of our discussion. Moreover, we will
study robots with both conventional and omnidirectional wheels. Of the latter, we
will focus on robots with Mekanum wheels.</p>
<p/>
</div>
<div class="page"><p/>
<p>524 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>a b
</p>
<p>Fig. 12.6 A two-dof rolling robot: (a) its general layout; and (b) a detail of its actuated wheels
</p>
<p>12.5.1 Robots with Conventional Wheels
</p>
<p>We study here the robot of Fig. 10.17, under the assumption that it is driven by
motors collocated at the axes of its two coaxial wheels, indicated as M1 and M2 in
Fig. 10.17b. For quick reference, we repeat this figure here as Fig. 12.6.
</p>
<p>Our approach will be one of multibody dynamics; for this reason, we distinguish
five rigid bodies composing the robotic mechanical system at hand. These are the
three wheels (two actuated and one caster wheels), the bracket carrying the caster
wheel, and the platform. We label these bodies with numbers from 1 to 5, in the
foregoing order, while noticing that bodies 4 and 5, the bracket and the platform,
undergo planar motion, and hence, deserve special treatment. The 6 � 6 mass
matrices of the first three bodies are labeled M1 to M3, with a similar labeling for
their corresponding six-dimensional twists, the counterpart items for bodies 4 and
5 being denoted by M04, M
</p>
<p>0
5, t
0
4, and t
</p>
<p>0
5, the primes indicating 3 � 3&mdash;as opposed
</p>
<p>to 6 � 6 in the general case&mdash;mass matrices and three-dimensional&mdash;as opposed to
six-dimensional in the general case&mdash;twist arrays.
</p>
<p>We undertake the formulation of the mathematical model of the mechanical
system under study, which is of the general form of Eq. (12.8a) derived for
holonomic systems. The nonholonomy of the system brings about special features
that will be highlighted in the derivations below.
</p>
<p>As a first step in our formulation, we distinguish between actuated and unac-
tuated joint variables, grouped into vectors �a and �u, respectively, their time-
derivatives being the actuated and unactuated joint rates, P�a and P�u, respectively.
From the kinematic analysis of this system in Sect. 10.5.1, it is apparent that the
foregoing vectors are all two-dimensional, namely,</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 525
</p>
<p>�a �
�
</p>
<p>�1
�2
</p>
<p>�
</p>
<p>; �u �
�
</p>
<p>�3
 
</p>
<p>�
</p>
<p>(12.35)
</p>
<p>Further, we set to deriving expressions for the twists of the five moving bodies in
terms of the actuated joint rates, i.e., we write those twists as linear transformations
of P�a, i.e.,
</p>
<p>ti D Ti P�a; i D 1; 2; 3 (12.36a)
</p>
<p>and
</p>
<p>t0i D T0i P�a; i D 4; 5 (12.36b)
</p>
<p>where, from Eqs. (10.41a and b), (10.44a and b), and (10.48),
</p>
<p>T1 D
�
</p>
<p>�iC �ık ��ık
rj 0
</p>
<p>�
</p>
<p>(12.37)
</p>
<p>T2 D
�
</p>
<p>�ık �.iC �ık/
0 rj
</p>
<p>�
</p>
<p>(12.38)
</p>
<p>T3 D
�
</p>
<p>&sbquo;3
</p>
<p>G3
</p>
<p>�
</p>
<p>(12.39)
</p>
<p>T04 D
�
</p>
<p>�T4
G4
</p>
<p>�
</p>
<p>(12.40)
</p>
<p>T05 D
�
</p>
<p>�ı ��ı
r.�iC .1=2/j/ r.��iC .1=2/j/
</p>
<p>�
</p>
<p>�
�
</p>
<p>�T5
C5
</p>
<p>�
</p>
<p>(12.41)
</p>
<p>with &sbquo;3; G3; �4 and G4 yet to be derived. In the sequel, we will find convenient
to work with a few nondimensional parameters, ˛, ı, �&mdash;already defined in
Eq. (10.53)&mdash;and �, which is introduced now, and displayed below with the first
three parameters for quick reference:
</p>
<p>˛ � aC b
l
</p>
<p>; ı � d
l
; � � r
</p>
<p>d
; � � a
</p>
<p>l
(12.42)
</p>
<p>In the derivations below, we resort to the notation introduced in Sect. 10.5.1. First,
we note that, from Eqs. (10.45), (10.52a and b), we can write, with �ij denoting the
.i; j / entry of&sbquo;, as derived in Sect. 10.5.1,
</p>
<p>!3 D .�11 P�1 C �12 P�2/e3 C Œ�ı. P�1 � P�2/C �21 P�1 C �22 P�2&#141;k (12.43)
</p>
<p>or
</p>
<p>!3 D &sbquo;3 P�a (12.44)</p>
<p/>
</div>
<div class="page"><p/>
<p>526 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>with&sbquo;3 defined as
</p>
<p>&sbquo;3 D
�
</p>
<p>�11e3 C .�21 C �ı/k �12e3 C .�22 � �ı/k
�
</p>
<p>In more compact form,
</p>
<p>&sbquo;3 D
�
</p>
<p>�11e3 C �21k �12e3 C �22k
�
</p>
<p>(12.45a)
</p>
<p>with �21 and �22 defined, in turn, as
</p>
<p>�21 � �21 C �ı; �22 � �22 � �ı (12.45b)
</p>
<p>Moreover,
</p>
<p>Pc3 D �r P�3f3 D �r.�11 P�1 C �12 P�2/f3
</p>
<p>and hence,
</p>
<p>G3 D r
�
</p>
<p>��11f3 ��12f3
�
</p>
<p>(12.46)
</p>
<p>Further, it is apparent from Fig. 12.6 that the scalar angular velocity of the bracket,
!4, is given by
</p>
<p>!4 D ! C P 
</p>
<p>and hence,
</p>
<p>!4 D �ı. P�1 � P�2/C �21 P�1 C �22 P�2 D �21 P�1 C �22 P�2
</p>
<p>Therefore, we can write
</p>
<p>!4 D �T4 P�a (12.47a)
</p>
<p>where �4 is defined as
</p>
<p>�4 �
�
</p>
<p>�21 �22
�T
</p>
<p>(12.47b)
</p>
<p>Now, since we are given the inertial properties of the bracket in bracket coordinates,
it makes sense to express Pc4 in those coordinates, taking into account that point C4
lies in the middle of the line PO3. Such an expression is obtained below:
</p>
<p>Pc4 D Po3 C!4 �
1
</p>
<p>2
Œ�d f3 C .h � r/k&#141; D �r P�3f3 C
</p>
<p>d
</p>
<p>2
.! C P /e3</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 527
</p>
<p>Upon expressing P�3 and P in terms of P�1 and P�2, we obtain
</p>
<p>Pc4 D d
�
1
</p>
<p>2
�21e3 � ��11f3
</p>
<p>�
</p>
<p>P�1 C d
�
1
</p>
<p>2
�22e3 � ��12f3
</p>
<p>�
</p>
<p>P�2 (12.48)
</p>
<p>whence it is apparent that
</p>
<p>G4 D d
�
</p>
<p>.1=2/�21e3 � ��11f3 .1=2/�22e3 � ��12f3
�
</p>
<p>(12.49)
</p>
<p>Therefore,
</p>
<p>T04 D
�
</p>
<p>�21 �22
dŒ.1=2/�21e3 � ��11f3&#141; d Œ.1=2/�22e3 � ��12f3&#141;
</p>
<p>�
</p>
<p>(12.50)
</p>
<p>thereby completing all needed twist-shaping matrices.
The 2 � 2 matrix of generalized inertia, I.�/, is now obtained. Here we have
</p>
<p>written this matrix as a function of all variables, independent and dependent, arrayed
in the four-dimensional vector � , because we cannot obtain an expression for �u
in terms of �a, given the nonholonomy of the system at hand. Therefore, I is, in
general, a function of �1, �2, �3, and  . To be sure, from the above expressions for
the twist-shaping matrices Ti and T0i , it is apparent that the said inertia matrix is an
explicit function of  only, its dependence on �1 and �2 being implicitly given via
vectors e3 and f3. We derive the expression sought for I starting from the kinetic
energy, namely,
</p>
<p>T D
3
X
</p>
<p>1
</p>
<p>1
</p>
<p>2
tTi Mi ti C
</p>
<p>1
</p>
<p>2
</p>
<p>5
X
</p>
<p>4
</p>
<p>.t0i /
TM0i t
</p>
<p>0
i
</p>
<p>or
</p>
<p>T D 1
2
P�Ta
</p>
<p> 
3
X
</p>
<p>1
</p>
<p>TTi MiTi
</p>
<p>!
</p>
<p>P�a C
1
</p>
<p>2
P�Ta
</p>
<p> 
5
X
</p>
<p>4
</p>
<p>.T0i /
TM0iT
</p>
<p>0
i
</p>
<p>!
</p>
<p>P�a (12.51)
</p>
<p>and hence,
</p>
<p>I D
3
X
</p>
<p>1
</p>
<p>TTi MiTi C
5
X
</p>
<p>4
</p>
<p>.T0i /
TM0iT
</p>
<p>0
i (12.52)
</p>
<p>In order to expand the foregoing expression, we let Jw and Jc be the 3� 3 inertia
matrices of the two actuated wheels and the caster wheel, respectively, the scalar
moments of inertia of the bracket and the platform, which undergo planar motion,
being denoted by Ib and Ip . Likewise, we letmw,mb ,mc , andmp denote the masses
of the corresponding bodies. Therefore,</p>
<p/>
</div>
<div class="page"><p/>
<p>528 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>M1 D
�
</p>
<p>Jw O
</p>
<p>O mw13
</p>
<p>�
</p>
<p>DM2
</p>
<p>M3 D
�
</p>
<p>Jc O
</p>
<p>O mc13
</p>
<p>�
</p>
<p>M04 D
�
</p>
<p>Ib 0
T
</p>
<p>0 mb12
</p>
<p>�
</p>
<p>M05 D
�
</p>
<p>Ip 0
T
</p>
<p>0 mp12
</p>
<p>�
</p>
<p>with O and 13 denoting the 3 � 3 zero and identity matrices, while 0 and 12 the
two-dimensional zero vector and the 2 � 2 identity matrix. Furthermore, under the
assumption that the actuated wheels are dynamically balanced, we have
</p>
<p>Jw D
</p>
<p>2
</p>
<p>4
</p>
<p>I 0 0
</p>
<p>0 H 0
</p>
<p>0 0 H
</p>
<p>3
</p>
<p>5
</p>
<p>Moreover, we assume that the caster wheel can be modeled as a rigid disk of uniform
material of the given mass mc and radius r , and hence, in bracket-fixed coordinates
f e3; f3; k g,
</p>
<p>Jc D
1
</p>
<p>4
mcr
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>2 0 0
</p>
<p>0 1 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>It is now a simple matter to calculate
</p>
<p>TT1 M1T1 D
�
</p>
<p>I C .�ı/2H Cmwr2 �.�ı/2H
�.�ı/2H .�ı/2H
</p>
<p>�
</p>
<p>TT2 M2T2 D
�
</p>
<p>.�ı/2H �.�ı/2H
�.�ı/2H I C .�ı/2H Cmwr2
</p>
<p>�
</p>
<p>where the symmetry between the two foregoing expressions is to be highlighted: that
is, the second expression is derived if the diagonal entries of the first expression are
exchanged, which is physically plausible, because such an exchange is equivalent
to a relabeling of the two wheels. The calculation of the remaining products is less
straightforward but can be readily obtained. From the expressions for T3 and M3,
we have
</p>
<p>TT3 M3T3 D
�
</p>
<p>&sbquo;T3 G
T
3
</p>
<p>�
�
</p>
<p>Jc O
</p>
<p>O mc13
</p>
<p>� �
</p>
<p>&sbquo;3
</p>
<p>G3
</p>
<p>�
</p>
<p>D &sbquo;T3 Jc&sbquo;3 CmcGT3 G3</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 529
</p>
<p>In order to calculate the foregoing products, we write Jc and &sbquo;3 in component
form, i.e.,
</p>
<p>Jc&sbquo;3 D
1
</p>
<p>4
mcr
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>2 0 0
</p>
<p>0 1 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>�11 �12
0 0
</p>
<p>�21 �22
</p>
<p>3
</p>
<p>5 D 1
4
mcr
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>2�11 2�12
0 0
</p>
<p>�21 �22
</p>
<p>3
</p>
<p>5
</p>
<p>and hence,
</p>
<p>&sbquo;T3 Jc&sbquo;3 D
1
</p>
<p>4
mcr
</p>
<p>2
</p>
<p>"
</p>
<p>2�211 C �
2
</p>
<p>21 2�11�12 C �21�22
2�11�12 C �21�22 2�212 C �
</p>
<p>2
</p>
<p>22
</p>
<p>#
</p>
<p>Likewise,
</p>
<p>m3G
T
3 G3 D mcr2
</p>
<p>�
</p>
<p>�211 �11�12
�11�12 �
</p>
<p>2
12
</p>
<p>�
</p>
<p>Further,
</p>
<p>.T04/
TM04T
</p>
<p>0
4 D
</p>
<p>�
</p>
<p>�4 G
T
4
</p>
<p>�
�
</p>
<p>Ib 0
T
</p>
<p>0 mb12
</p>
<p>� �
</p>
<p>�T4
G4
</p>
<p>�
</p>
<p>D Ib�4�T4 CmbGT4 G4
</p>
<p>Upon expansion, we have
</p>
<p>.T04/
TM04T
</p>
<p>0
4 D Ib
</p>
<p>"
</p>
<p>�
2
</p>
<p>21 �21�22
</p>
<p>�21�22 �
2
</p>
<p>22
</p>
<p>#
</p>
<p>C 1
4
mbd
</p>
<p>2
</p>
<p>"
</p>
<p>�
2
</p>
<p>21 C 4�2�211 �21�22 C 4�2�11�12
�21�22 C 4�2�11�12 �
</p>
<p>2
</p>
<p>22 C 4�2�212
</p>
<p>#
</p>
<p>Finally,
</p>
<p>.T05/
TM05T
</p>
<p>0
5 D
</p>
<p>�
</p>
<p>�5 G
T
5
</p>
<p>�
�
</p>
<p>Ip 0
T
</p>
<p>0 mp12
</p>
<p>� �
</p>
<p>�T5
G5
</p>
<p>�
</p>
<p>D Ip�5�T5 CmpGT5 G5
</p>
<p>which can be readily expanded as
</p>
<p>.T05/
TM05T
</p>
<p>0
5 D Ip.�ı/2
</p>
<p>�
</p>
<p>1 �1
�1 1
</p>
<p>�
</p>
<p>Cmpr2
�
</p>
<p>.1=4/C �2 .1=4/ � �2
</p>
<p>.1=4/ � �2 .1=4/C �2
�
</p>
<p>We can thus express the generalized inertia matrix as
</p>
<p>I D Iw C Ic C Ib C Ip</p>
<p/>
</div>
<div class="page"><p/>
<p>530 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>where Iw, Ic , Ib , and Ip denote the contributions of the actuated wheels, the caster
wheel, the bracket, and the platform, respectively, i.e.,
</p>
<p>Iw D
2
X
</p>
<p>1
</p>
<p>TTi MiTi D
�
</p>
<p>I C 2.�ı/2H Cmwr2 �2.�ı/2H
�2.�ı/2H I C 2.�ı/2H Cmwr2
</p>
<p>�
</p>
<p>Ic D
mcr
</p>
<p>2
</p>
<p>4
</p>
<p>"
</p>
<p>6�211 C �
2
</p>
<p>21 6�11�12 C �21�22
6�11�12 C �21�22 6�212 C �
</p>
<p>2
</p>
<p>22
</p>
<p>#
</p>
<p>Ib D Ib
</p>
<p>"
</p>
<p>�
2
</p>
<p>21 �21�22
</p>
<p>�21�22 �
2
</p>
<p>22
</p>
<p>#
</p>
<p>C 1
4
mbd
</p>
<p>2
</p>
<p>"
</p>
<p>�
2
</p>
<p>21 C 4�2�211 �21�22 C 4�2�11�12
�21�22 C 4�2�11�12 �
</p>
<p>2
</p>
<p>22 C 4�2�212
</p>
<p>#
</p>
<p>Ip D Ip.�ı/2
�
</p>
<p>1 �1
�1 1
</p>
<p>�
</p>
<p>Cmpr2
�
</p>
<p>.1=4/C �2 .1=4/ � �2
</p>
<p>.1=4/ � �2 .1=4/C �2
�
</p>
<p>It is now apparent that the contributions of the actuated wheels and the platform
are constant, while those of the caster wheel and the bracket are configuration-
dependent. Therefore, only the latter contribute to the Coriolis and centrifugal
generalized forces. We thus have
</p>
<p>TTM PT D TT3 M3 PT3 C .T04/TM04 PT04
</p>
<p>From the expression for TT3 M3T3, we obtain
</p>
<p>TT3 M3
PT3 D &sbquo;T3 Jc P&sbquo;3 Cm3CT3 PC3
</p>
<p>the time-derivatives being displayed below:
</p>
<p>P&sbquo;3 D
� P�11e3 C �11!4f3 C P�21k P�12e3 C �12!4f3 C P�22k
</p>
<p>�
</p>
<p>PC3 D r
�
</p>
<p>� P�11f3 C �11!4e3 � P�12f3 C �12!4e3
�
</p>
<p>with the time-derivatives of the entries of&sbquo; given as
</p>
<p>P&sbquo; D P 
�
</p>
<p>�˛ sin C .cos /=2 ˛ sin C .cos /=2
�Œ�˛ cos � .sin /=2&#141; �Œ˛ cos � .sin /=2&#141;
</p>
<p>�
</p>
<p>(12.53)
</p>
<p>its parameters being defined in Eq. (12.42). Upon expansion, the products appearing
in the expression for TT3 M3 PT 3 become</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 531
</p>
<p>&sbquo;T3 Jc
P&sbquo;3 D
</p>
<p>mcr
2
</p>
<p>4
</p>
<p>�
</p>
<p>2�11 P�11 C �21 P�21 2�11 P�12 C �21 P�22
2�12 P�11 C �22 P�21 2�12 P�12 C �22 P�22
</p>
<p>�
</p>
<p>m3C
T
3
PC3 D mcr2
</p>
<p>�
</p>
<p>�11 P�11 �11 P�12
�12 P�11 �12 P�12
</p>
<p>�
</p>
<p>Therefore,
</p>
<p>TT3 M3
PT3 D
</p>
<p>mcr
2
</p>
<p>4
</p>
<p>�
</p>
<p>6�11 P�11 C �21 P�21 6�11 P�12 C �21 P�22
6�12 P�11 C �22 P�21 6�12 P�12 C �22 P�22
</p>
<p>�
</p>
<p>Likewise,
</p>
<p>.T04/
TM04 PT04 D Ib�4 P�
</p>
<p>T
</p>
<p>4 CmbCT4 PC4
</p>
<p>the above time-derivatives being
</p>
<p>P�T4 D
� P�21 P�22
</p>
<p>�
</p>
<p>PC4 D d
�
</p>
<p>c11e3 C c12f3 c21e3 C c22f3
�
</p>
<p>with coefficients ci;j given below:
</p>
<p>c11 D
1
</p>
<p>2
P�21 C ��11!4 ; c12 D
</p>
<p>1
</p>
<p>2
�21!4 � � P�11
</p>
<p>c21 D
1
</p>
<p>2
P�22 C ��12!4 ; c22 D
</p>
<p>1
</p>
<p>2
�22!4 � � P�12
</p>
<p>Hence,
</p>
<p>Ib�4 P�
T
</p>
<p>4 D Ib
�
</p>
<p>�21 P�21 �21 P�22
�22 P�21 �22 P�22
</p>
<p>�
</p>
<p>mbC
T
4
PC4 D
</p>
<p>1
</p>
<p>2
mbd
</p>
<p>2
</p>
<p>�
</p>
<p>�21c11 � 2��11c12 �21c21 � 2��11c22
�22c11 � 2��12c12 �22c21 � 2��12c22
</p>
<p>�
</p>
<p>Therefore,
</p>
<p>.T04/
TM04 PT04 D Ib
</p>
<p>�
</p>
<p>�21 P�21 �21 P�22
�22 P�21 �22 P�22
</p>
<p>�
</p>
<p>C 1
2
mbd
</p>
<p>2
</p>
<p>�
</p>
<p>�21c11 � 2��11c12 �21c21 � 2��11c22
�22c11 � 2��12c12 �22c21 � 2��12c22
</p>
<p>�
</p>
<p>In the final steps, we calculate TTWMT. As we saw earlier, only the caster wheel
and the bracket can contribute to this term, for the contributions of the other bodies</p>
<p/>
</div>
<div class="page"><p/>
<p>532 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>to the matrix of generalized inertia are constant. However, the bracket undergoes
planar motion, and according to Exercise 7.10, its contribution to this term vanishes.
Therefore,
</p>
<p>TTWMT D TT3 W3M3T3
</p>
<p>Upon expansion of the foregoing product, we have
</p>
<p>TT3 W3M3T3 D
�
</p>
<p>&sbquo;T3 G
T
3
</p>
<p>�
�
</p>
<p>&#127;3 O
</p>
<p>O O
</p>
<p>� �
</p>
<p>Ic O
</p>
<p>O mc13
</p>
<p>� �
</p>
<p>&sbquo;3
</p>
<p>G3
</p>
<p>�
</p>
<p>D &sbquo;T3&#127;3Ic&sbquo;3 (12.54)
</p>
<p>The foregoing term vanishes, as we prove below. First, notice that
</p>
<p>&#127;3!3 D 0
</p>
<p>However, from Eq. (12.44),
</p>
<p>!3 D &sbquo;3 P�a
</p>
<p>and hence,
</p>
<p>&#127;3&sbquo;3 P�a D 0
</p>
<p>for every P�a, whence
</p>
<p>&#127;3&sbquo;3 D O32
</p>
<p>with O32 denoting the 3�2 zero matrix. Upon transposing the foregoing expression,
we obtain
</p>
<p>&sbquo;T3&#127;3 D O23
</p>
<p>where we have recalled that&#127;3 is skew-symmetric.
Substitution of the above expression into Eq. (12.54) readily shows that the term
</p>
<p>in question indeed vanishes, i.e.,
In summary, the Coriolis and centrifugal force terms of the system at hand take
</p>
<p>the form
</p>
<p>C.�; P�a/ P�a D
mcr
</p>
<p>2
</p>
<p>4
</p>
<p>�
</p>
<p>6�11. P�11 P�1 C P�12 P�2/C �21. P�12 P�1 C P�22 P�2/
6�12. P�11 P�1 C P�12 P�2/C �22. P�12 P�1 C P�22 P�2/
</p>
<p>�
</p>
<p>C Ib. P�21 P�1 C P�22 P�2/
�
</p>
<p>�21
�22
</p>
<p>�
</p>
<p>C 1
2
mbd
</p>
<p>2.c11 P�1 C c21 P�2/
�
</p>
<p>�21
�22
</p>
<p>�
</p>
<p>�mbd 2�.c12 P�1 C c22 P�2/
�
</p>
<p>�11
�12
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 533
</p>
<p>If we recall that the cij coefficients are linear in the joint rates, then the foregoing
expression clearly shows the quadratic nature of the Coriolis and centrifugal terms
with respect to the joint rates.
</p>
<p>The derivation of the forces supplied by the actuators is straightforward:
</p>
<p>� D
�
</p>
<p>�1
�2
</p>
<p>�
</p>
<p>The dissipative generalized force is less straightforward, but its calculation is not
too lengthy. In fact, if we assume linear dashpots at all joints, then the dissipation
function is
</p>
<p>&#129; D 1
2
c1 P�21 C
</p>
<p>1
</p>
<p>2
c2 P�22 C
</p>
<p>1
</p>
<p>2
c3 P�23 C
</p>
<p>1
</p>
<p>2
c4 P 2 D
</p>
<p>1
</p>
<p>2
P�Ta C12 P�a C
</p>
<p>1
</p>
<p>2
P�Tu C34 P�u
</p>
<p>with C12 and C34 defined as
</p>
<p>C12 �
�
</p>
<p>c1 0
</p>
<p>0 c2
</p>
<p>�
</p>
<p>; C34 �
�
</p>
<p>c3 0
</p>
<p>0 c4
</p>
<p>�
</p>
<p>Now, if we recall the expression for P�u in terms of P�a, we end up with
</p>
<p>&#129; D 1
2
P�Ta D P�a
</p>
<p>D being defined, in turn, as the equivalent damping matrix, given by
</p>
<p>D D C12 C&sbquo;TC34&sbquo;
</p>
<p>Since &sbquo; D &sbquo;. /; D D D. /, the dynamics model under study thus taking the
form
</p>
<p>I.�/ R�a C C.�; P�a/ P�a D � � D. / P�a
</p>
<p>with I and C.�; P�a/ given, such as in the case of holonomic systems, as
</p>
<p>I.�/ D TTMT
C.�; P�a/ D TTM PTC TTWMT
</p>
<p>thereby completing the mathematical model governing the motion of the system
at hand. Note here that � denotes the four-dimensional vector of joint variables
containing all four angles appearing as components of �a and �u. Because of the
nonholonomy of the system, an expression for the latter in terms of the former
cannot be derived, and thus the whole four-dimensional vector � is left as an
argument of both I and C.</p>
<p/>
</div>
<div class="page"><p/>
<p>534 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>a b
</p>
<p>Fig. 12.7 Rolling robot with ODWs in a &#129;-array
</p>
<p>Note that calculating the torque � required for a given motion&mdash;inverse
dynamics&mdash;of the rolling robot under study is straightforward from the above
model. However, given the strong coupling among all variables involved, a
recursive algorithm in this case is not apparent. On the other hand, the determination
of the motion produced by a given history of joint torques requires (a) the calculation
of I, which can be achieved symbolically; (b) the inversion of I, which can be done
symbolically because this is a 2 � 2 matrix; (c) the calculation of the Coriolis and
centrifugal terms, as well as the dissipative forces; and (d) the integration of the
initial-value problem resulting once initial values to � and P�a have been assigned.
</p>
<p>12.5.2 Robots with Omnidirectional Wheels
</p>
<p>We now consider a three-dof robot with three actuated wheels of the Mekanum type,
as shown in Fig. 10.19, with the configuration of Fig. 12.7, which will be termed,
henceforth, the &#129;-array. This system is illustrated in Fig. 12.8.
</p>
<p>Below we will adopt the notation of Sect. 10.5.2, with ˛ D �=2 and n D 3.
We now recall that the twist of the platform was represented in planar form as
</p>
<p>t0 �
�
</p>
<p>!
</p>
<p>Pc
</p>
<p>�
</p>
<p>(12.55)
</p>
<p>where ! is the scalar angular velocity of the platform and Pc is the two-dimensional
position vector of its mass center, which will be assumed to coincide with the</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 535
</p>
<p>Fig. 12.8 A view of the
three-wheeled robot with
Mekanum wheels in a
&#129;-array
</p>
<p>centroid of the set of points fCi g31. Moreover, the three wheels are actuated, and
hence, the three-dimensional vector of actuated joint rates is defined as
</p>
<p>P�a �
</p>
<p>2
</p>
<p>4
</p>
<p>P�1
P�2
P�3
</p>
<p>3
</p>
<p>5 (12.56)
</p>
<p>The relation between P�a and t0 was derived in general in Sect. 10.5.2. As pertaining
to the robot of Fig. 12.7, we have
</p>
<p>J P�a D Kt0 (12.57a)
</p>
<p>with the two 3 � 3 Jacobians J and K defined as
</p>
<p>J � �a1; K �
</p>
<p>2
</p>
<p>4
</p>
<p>r fT1
r fT2
r fT3
</p>
<p>3
</p>
<p>5 (12.57b)
</p>
<p>where, it is recalled, a is the height of the axis of the wheel hub and r is the
horizontal distance of the points of contact with the ground to the mass center C of
the platform, as indicated in Fig. 12.7a. Moreover, vectors f ei g31 and f fi g31, defined
in Sect. 10.5.2, are displayed in Fig. 12.7. Below we derive expressions for ! and
Pc, from Eq. (12.57a), in terms of the joint rates. To this end, we expand these three
equations, thus obtaining
</p>
<p>r! C fT1 Pc D �a P�1 (12.58a)
</p>
<p>r! C fT2 Pc D �a P�2 (12.58b)
</p>
<p>r! C fT3 Pc D �a P�3 (12.58c)</p>
<p/>
</div>
<div class="page"><p/>
<p>536 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>Upon adding corresponding sides of the three foregoing equations, we obtain
</p>
<p>3r! C PcT
3
X
</p>
<p>1
</p>
<p>fi D �a
3
X
</p>
<p>1
</p>
<p>P�i (12.59)
</p>
<p>But from Fig. 12.7b, it is apparent that
</p>
<p>e1 C e2 C e3 D 0 (12.60a)
f1 C f2 C f3 D 0 (12.60b)
</p>
<p>Likewise,
</p>
<p>e1 D
p
3
</p>
<p>3
.f3 � f2/; e2 D
</p>
<p>p
3
</p>
<p>3
.f1 � f3/; e3 D
</p>
<p>p
3
</p>
<p>3
.f2 � f1/ (12.60c)
</p>
<p>f1 D
p
3
</p>
<p>3
.e2 � e3/; f2 D
</p>
<p>p
3
</p>
<p>3
.e3 � e1/; f3 D
</p>
<p>p
3
</p>
<p>3
.e1 � e2/ (12.60d)
</p>
<p>and hence, the above equation for ! and Pc leads to
</p>
<p>! D � a
3r
</p>
<p>3
X
</p>
<p>1
</p>
<p>P�i (12.61)
</p>
<p>Now we derive an expression for Pc in terms of the actuated joint rates. We do
this by subtracting, sidewise, Eq. (12.58b) from Eq. (12.58a) and Eq. (12.58c) from
Eq. (12.58b), thus obtaining a system of two linear equations in two unknowns, the
two components of the two-dimensional vector Pc, namely,
</p>
<p>APc D b
</p>
<p>with matrix A and vector b defined as
</p>
<p>A �
�
</p>
<p>.f1 � f2/T
</p>
<p>.f2 � f3/T
�
</p>
<p>� �
p
3
</p>
<p>�
</p>
<p>eT3
eT1
</p>
<p>�
</p>
<p>; b � �a
� P�1 � P�2
P�2 � P�3
</p>
<p>�
</p>
<p>where we have used relations (12.60c). Since A is a 2 � 2 matrix, its inverse can be
readily found with the aid of Facts 5.7.3 and 5.7.4, which yield
</p>
<p>Pc D 2
3
a
�
</p>
<p>�Ee1 Ee3
�
� P�1 � P�2
P�2 � P�3
</p>
<p>�
</p>
<p>Now, from Fig. 12.7b,
</p>
<p>Ee1 D f1; Ee3 D f3</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 537
</p>
<p>and hence, Pc reduces to
</p>
<p>Pc D 2
3
aŒ. P�2 � P�1/f1 C . P�2 � P�3/f3&#141; �
</p>
<p>2
</p>
<p>3
aŒ P�2.f1 C f3/ � P�1f1 � P�3f3&#141;
</p>
<p>But by virtue of Eq. (12.60b),
</p>
<p>f1 C f3 D �f2
</p>
<p>the above expression for Pc thus becoming
</p>
<p>Pc D �2a
3
</p>
<p>3
X
</p>
<p>1
</p>
<p>P�i fi (12.62)
</p>
<p>Thus, ! is proportional to the mean value of f P�i g31, while Pc is proportional to the
mean value of f P�i fi g31. In deriving the mathematical model of the robot at hand,
we will resort to the natural orthogonal complement, and therefore, we will require
expressions for the twists of all bodies involved in terms of the actuated wheel rates.
We start by labeling the wheels as bodies 1, 2, and 3, with the platform being body 4.
Moreover, we will neglect the inertia of the rollers, and so no labels need be attached
to these. Furthermore, the wheel hubs undergo rotations with angular velocities in
two orthogonal directions, and hence, a full six-dimensional twist representation
of these will be required. Henceforth, we will regard the angular velocity of the
platform and the velocity of its mass center as three-dimensional vectors. Therefore,
</p>
<p>t4 � T4 P�a; T4 � ��
�
</p>
<p>k k k
</p>
<p>2rf1 2rf2 2rf3
</p>
<p>�
</p>
<p>(12.63)
</p>
<p>with � defined, in turn, as the ratio
</p>
<p>� � a
3r
</p>
<p>(12.64)
</p>
<p>Now, the wheel angular velocities are given simply as
</p>
<p>!i D P�iei C !k D P�iei � �
 
</p>
<p>3
X
</p>
<p>1
</p>
<p>P�i
</p>
<p>!
</p>
<p>k (12.65)
</p>
<p>or
</p>
<p>!1 D .e1 � �k/ P�1 � � P�2k � � P�3k (12.66a)
!2 D �� P�1kC .e2 � �k/ P�2 � � P�3k (12.66b)
!3 D �� P�1k � � P�2kC .e3 � �k/ P�3 (12.66c)</p>
<p/>
</div>
<div class="page"><p/>
<p>538 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>Similar expressions are derived for vectors Pci . To this end, we resort to the geometry
of Fig. 12.7, from which we derive the relations
</p>
<p>Pci D PcC !rfi D �2�r
 
</p>
<p>3
X
</p>
<p>1
</p>
<p>P�j fj
</p>
<p>!
</p>
<p>� �r
 
</p>
<p>3
X
</p>
<p>1
</p>
<p>P�j
</p>
<p>!
</p>
<p>fi
</p>
<p>and hence,
</p>
<p>Pc1 D ��rŒ.3 P�1 C P�2 C P�3/f1 C 2. P�2f2 C P�3f3/&#141; (12.67a)
Pc2 D ��rŒ2 P�1f1 C . P�1 C 3 P�2 C P�3/f2 C 2 P�3f3&#141; (12.67b)
Pc3 D ��rŒ2. P�1f1 C P�2f2/C . P�1 C P�2 C 3 P�3/f3&#141; (12.67c)
</p>
<p>From the foregoing relations, and those for the angular velocities of the wheels,
Eqs. (12.66a&ndash;c), we can now write the twists of the wheels in the form
</p>
<p>ti D Ti P�a; i D 1; 2; 3 (12.68)
</p>
<p>where
</p>
<p>T1 �
�
</p>
<p>e1 � �k ��k ��k
�3�rf1 ��r.f1 C 2f2/ ��r.f1 C 2f3/
</p>
<p>�
</p>
<p>T2 �
�
</p>
<p>��k e2 � �k ��k
��r.f2 C 2f1/ �3�rf2 ��r.f2 C 2f3/
</p>
<p>�
</p>
<p>T3 �
�
</p>
<p>��k ��k e3 � �k
��r.f3 C 2f1/ ��r.f3 C 2f2/ �3�rf3
</p>
<p>�
</p>
<p>On the other hand, similar to what we have in Eq. (12.62), an interesting relationship
among angular velocities of the wheels arises here. Indeed, upon adding the
corresponding sides of the three equations (12.66a&ndash;c), we obtain
</p>
<p>3
X
</p>
<p>1
</p>
<p>!i D
3
X
</p>
<p>1
</p>
<p>P�iei � 3�k
3
X
</p>
<p>1
</p>
<p>P�i
</p>
<p>Further, we dot-multiply the two sides of the foregoing equation by k, which yields,
upon rearrangement of terms,
</p>
<p>3�
</p>
<p>3
X
</p>
<p>1
</p>
<p>P�i D �k �
3
X
</p>
<p>1
</p>
<p>!i
</p>
<p>and by virtue of Eq. (12.61),
</p>
<p>! D k �!; ! � 1
3
</p>
<p>3
X
</p>
<p>1
</p>
<p>!i (12.69)
</p>
<p>that is, the vertical component of the mean wheel angular velocity equals the scalar
angular velocity of the platform.</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 539
</p>
<p>Now we proceed to establish the mathematical model governing the dynamics of
the system under study. The generalized inertia matrix is then calculated as
</p>
<p>I D
4
X
</p>
<p>1
</p>
<p>TTi MiTi (12.70)
</p>
<p>where, if Iw andmw denote the moment-of-inertia matrix, in body-fixed coordinates,
and the mass of each of the three wheels, with similar definitions for Ip and mp as
pertaining to the platform,
</p>
<p>Mi D
�
</p>
<p>Iw O
</p>
<p>O mw1
</p>
<p>�
</p>
<p>; i D 1; 2; 3; M4 D
�
</p>
<p>Ip O
</p>
<p>O mp1
</p>
<p>�
</p>
<p>(12.71)
</p>
<p>We will also need the angular-velocity dyads, Wi , which are calculated as
</p>
<p>Wi D
�
</p>
<p>&#127;i O
</p>
<p>O O
</p>
<p>�
</p>
<p>; i D 1; 2; 3 (12.72)
</p>
<p>where W4 will not be needed, since the platform undergoes planar motion. We have
</p>
<p>M1T1 D
�
</p>
<p>Iw.e1 � �k/ ��Iwk ��Iwk
�3mw�rf1 �mw�r.f1 C 2f2/ �mw�r.f1 C 2f3/
</p>
<p>�
</p>
<p>Moreover, we assume that in a local coordinate frame f ei ; fi ; k g,
</p>
<p>Iw D
</p>
<p>2
</p>
<p>4
</p>
<p>I 0 0
</p>
<p>0 J 0
</p>
<p>0 0 J
</p>
<p>3
</p>
<p>5
</p>
<p>in which I and J are constants. Hence,
</p>
<p>TT1 M1T1 D
</p>
<p>2
</p>
<p>4
</p>
<p>I C �2K �2J �2J
�2J �2L �2M
</p>
<p>�2J �2M �2L
</p>
<p>3
</p>
<p>5
</p>
<p>where
</p>
<p>K � J C 9mwr2
</p>
<p>L � J C 3mwr2
</p>
<p>M � J � 3mwr2</p>
<p/>
</div>
<div class="page"><p/>
<p>540 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>Likewise,
</p>
<p>TT2 M2T2 D
</p>
<p>2
</p>
<p>4
</p>
<p>�2L �2J �2M
</p>
<p>�2J I C �2K �2J
�2M �2J �2L
</p>
<p>3
</p>
<p>5
</p>
<p>TT3 M3T3 D
</p>
<p>2
</p>
<p>4
</p>
<p>�2L �2J �2J
</p>
<p>�2J �2L �2J
</p>
<p>�2J �2J I C �2K
</p>
<p>3
</p>
<p>5
</p>
<p>Furthermore,
</p>
<p>M4T4 D ��
�
</p>
<p>Ipk Ipk Ipk
</p>
<p>2mprf1 2mprf2 2mprf3
</p>
<p>�
</p>
<p>It is apparent that, by virtue of the planar motion undergone by the platform, only its
moment of inertia H about the vertical passing through its mass center is needed.
Then,
</p>
<p>TT4 M4T4 D �2
2
</p>
<p>4
</p>
<p>H C 4mpr2 H � 2mpr2 H � 2mpr2
H � 2mpr2 H C 4mpr2 H � 2mpr2
H � 2mpr2 H � 2mpr2 H C 4mpr2
</p>
<p>3
</p>
<p>5
</p>
<p>Upon summing all four products computed above, we obtain
</p>
<p>I D
</p>
<p>2
</p>
<p>4
</p>
<p>˛ ˇ ˇ
</p>
<p>ˇ ˛ ˇ
</p>
<p>ˇ ˇ ˛
</p>
<p>3
</p>
<p>5
</p>
<p>with the definitions below:
</p>
<p>˛ � I C �2.H C 3J C 15mwr2 C 4mpr2/
ˇ � �2
</p>
<p>�
</p>
<p>H C 3J � 3mwr2 � 2mpr2
&#13;
</p>
<p>which is a constant matrix. Moreover, note that the geometric and inertial symmetry
assumed at the outset is apparent in the form of the foregoing inertia matrix, its
inverse being readily obtained in closed form, namely,
</p>
<p>I�1 D 1
&#129;
</p>
<p>2
</p>
<p>4
</p>
<p>˛ C ˇ �ˇ �ˇ
�ˇ ˛ C ˇ �ˇ
�ˇ �ˇ ˛ C ˇ
</p>
<p>3
</p>
<p>5 ; &#129; � .˛ C ˇ/˛ � 2ˇ2
</p>
<p>Next, we turn to the calculation of the TTM PT term. This is readily found to be
</p>
<p>TTM PT D
4
X
</p>
<p>1
</p>
<p>TTi Mi
PTi</p>
<p/>
</div>
<div class="page"><p/>
<p>12.5 Dynamics of Rolling Robots 541
</p>
<p>each of the foregoing products being expanded below. We have, first,
</p>
<p>PT1 D
�
</p>
<p>!f1 0 0
</p>
<p>3�r!e1 ��r!.e3 � e2/ �r!.e3 � e2/
</p>
<p>�
</p>
<p>PT2 D
�
</p>
<p>0 !f2 0
</p>
<p>�r!.e1 � e3/ 3�r!e2 ��r!.e1 � e3/
</p>
<p>�
</p>
<p>PT3 D
�
</p>
<p>0 0 !f3
��r!.e2 � e1/ �r!.e2 � e1/ 3�r!e3
</p>
<p>�
</p>
<p>PT4 D �
�
</p>
<p>0 0 0
</p>
<p>2r!e1 2r!e2 2r!e3
</p>
<p>�
</p>
<p>Hence, for the first wheel,
</p>
<p>M1 PT1 D
�
</p>
<p>Iw!f1 0 0
</p>
<p>3�mwr!e1 ��mwr!.e3 � e2/ �mwr!.e3 � e2/
</p>
<p>�
</p>
<p>Therefore,
</p>
<p>TT1 M1
PT1 D 3
</p>
<p>p
3�2mwr
</p>
<p>2!
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 1
1 0 0
</p>
<p>�1 0 0
</p>
<p>3
</p>
<p>5
</p>
<p>where the skew-symmetric matrix is the cross product matrix of vector Œ 0; 1; 1 &#141;T .
By symmetry, the other two products, TTi Mi PTi , for i D 1; 2, take on similar forms,
with the skew-symmetric matrix, becoming, correspondingly, the cross-product
matrix of vectors Œ 1; 0; 1 &#141;T and Œ 1; 1; 0 &#141;T . This means that the first of these three
products is affected by the rotation of the second and the third wheels, but not by
that of the first one; the second of those products is affected by the rotation of the
first and the third wheels, but not by the second; the third product is affected, in turn,
by the rotation of the first two wheels, but not by that of the third wheel. We thus
have
</p>
<p>TT2 M2
PT2 D 3
</p>
<p>p
3�2mwr
</p>
<p>2!
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 0
1 0 �1
0 1 0
</p>
<p>3
</p>
<p>5
</p>
<p>TT3 M3
PT3 D 3
</p>
<p>p
3�2mwr
</p>
<p>2!
</p>
<p>2
</p>
<p>4
</p>
<p>0 0 1
</p>
<p>0 0 �1
�1 1 0
</p>
<p>3
</p>
<p>5
</p>
<p>Furthermore,
</p>
<p>M4 PT4 D �
�
</p>
<p>0 0 0
</p>
<p>�2mpr!e1 �2mpr!e2 �2mpr!e3
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>542 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>and hence,
</p>
<p>TT4 M4
PT4 D 2
</p>
<p>p
3�2mpr
</p>
<p>2!
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 1
1 0 �1
�1 1 0
</p>
<p>3
</p>
<p>5 (12.74a)
</p>
<p>whose skew-symmetric matrix is readily identified as the cross-product matrix of
vector Œ 1; 1; 1 &#141;T , thereby indicating an equal participation of all three wheels in
this term, a rather plausible result. Upon adding all four products calculated above,
we obtain
</p>
<p>TTM PT D 2
p
3�2.3mw Cmp/r2!
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 1
1 0 �1
�1 1 0
</p>
<p>3
</p>
<p>5 (12.75)
</p>
<p>The equal participation of all three wheels in the foregoing product is apparent.
Moreover, notice that the term in parentheses can be regarded as an equivalent mass,
which is merely the sum of all four masses involved, the moments of inertia of the
wheels playing no role in this term.
</p>
<p>We now turn to the calculation of the TTWMT term, which can be expressed as
a sum, namely,
</p>
<p>TTWMT D
3
X
</p>
<p>1
</p>
<p>TTi WiMiTi
</p>
<p>where we have not considered the contribution of the platform, because this
undergoes planar motion. Moreover, matrices Wi , for i D 1, 2, and 3, take the
obvious forms
</p>
<p>Wi �
�
</p>
<p>&#127;i O
</p>
<p>O O
</p>
<p>�
</p>
<p>We then have, for the first wheel,
</p>
<p>W1M1T1 D
�
</p>
<p>!1 � ŒIw.e1 � �k/&#141; �!1 � .�Iwk/ �!1 � .�Iwk/
0 0 0
</p>
<p>�
</p>
<p>Now, it does not require too much effort to calculate the complete first product,
which merely vanishes, i.e.,
</p>
<p>TT1 W1M1T1 D O33
</p>
<p>with O33 defined as the 3�3 zero matrix. By symmetry, the remaining two products
also vanish, and hence, the sum also does, i.e.,
</p>
<p>TTWMT D O33 (12.76)</p>
<p/>
</div>
<div class="page"><p/>
<p>12.6 Exercises 543
</p>
<p>Now, calculating the dissipative and active generalized forces is straightforward.
We will neglect here the dissipation of energy occurring at the bearings of the
rollers, and hence, if we assume that the lubricant of the wheel hubs produces linear
dissipative torques, then we have
</p>
<p>ı D c
</p>
<p>2
</p>
<p>4
</p>
<p>P�1
P�2
P�3
</p>
<p>3
</p>
<p>5 ; � D
</p>
<p>2
</p>
<p>4
</p>
<p>�1
�2
�3
</p>
<p>3
</p>
<p>5 (12.77)
</p>
<p>where c is the common damping coefficient for all three wheel hubs. We now have
all the elements needed to set up the mathematical model governing the dynamics
of the robot, namely,
</p>
<p>I R�a C C.!/ P�a D � � ı (12.78)
</p>
<p>where C.!/ � TTM PT C TTWMT; from Eqs. (12.75) and (12.76), this term
becomes
</p>
<p>C.!/ D 2
p
3�2.3mw Cmp/r2!
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 1
1 0 �1
�1 1 0
</p>
<p>3
</p>
<p>5 (12.79)
</p>
<p>Since ! D �a=.3r/. P�1 C P�2 C P�3/, the quadratic nature of the second term
of Eq. (12.78) in the joint rates becomes apparent. It is also apparent that the
mathematical model derived above does not depend on �a. What this means is that
the mathematical model allows the integration of the actuated joint accelerations to
yield joint-rate histories P�a.t/, but this model cannot provide joint-variable histories
�a.t/. To obtain these, for given initial conditions, the joint-rate histories have to be
integrated, which can be done by numerical quadrature.
</p>
<p>Finally, in order to obtain the Cartesian histories of the platform pose, given
by the angle � that a specific line of the platform makes with a line fixed in an
inertial frame, and the position vector of the mass center, c, Eqs. (12.61) and (12.62)
have to be integrated. While the integration of the former can be readily done by
quadrature, that of the latter requires knowledge of vectors fi , for i D 1; 2; 3, and
these vectors depend on � . Thus, the integration of Eq. (12.61) can be done once
the joint-rate histories are known; that of Eq. (12.62) requires knowledge of angle
� . These features are inherent to nonholonomic systems.
</p>
<p>12.6 Exercises
</p>
<p>12.1 Show that the mathematical model of an arbitrary robotic mechanical system,
whether holonomic or nonholonomic, with r rigid bodies and n degrees of
freedom, can be cast in the general form
</p>
<p>I.�/ R�a C C.�; P�a/ P�a D �A C &#13; C ı</p>
<p/>
</div>
<div class="page"><p/>
<p>544 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>where
</p>
<p>�: the m-dimensional vector of variables associated with all joints,
actuated and unactuated;
</p>
<p>P�a: the n-dimensional vector of actuated joint variables, n � m;
�A: the n-dimensional vector of actuator torques;
&#13;: the n-dimensional vector of gravity torques;
ı: the n-dimensional vector of dissipative torques;
</p>
<p>I.�/: the n � n matrix of generalized inertia;
C.�; P�a/: the n � n matrix of Coriolis and centrifugal forces;
with I.�/ and C.�; P�a/ given by
</p>
<p>I.�/ � TTMT
</p>
<p>C.�; P�a/ �
1
</p>
<p>2
ŒPIC TTM PT � PTTMTC TT .WMCMW/T&#141;
</p>
<p>in which
</p>
<p>M: the 6r � 6r matrix of system mass;
T: the n � 6r twist-shaping matrix that maps the n-dimensional vector of
</p>
<p>actuated joint rates into the 6r-dimensional vector of system twist t;
W: the 6r � 6r matrix of system angular velocity.
</p>
<p>12.2 For the system of Exercise 12.1, show that the matrix difference PI.�; P�a/ �
2C.�; P�a/ is skew-symmetric. This is a well-known result for holonomic
systems (Spong et al. 2006).
</p>
<p>12.3 For the rolling robot with conventional wheels of Sect. 12.5.1, find the
generalized inertia matrix of the robot under the maneuvers described
below:
</p>
<p>(a) pure translation;
(b) midpoint of segment O1O2 stationary.
</p>
<p>In each case, give a physical interpretation of the matrix thus obtained.
12.4 With reference to the same robot of Exercise 12.3, state the conditions on its
</p>
<p>geometric parameters that yield Iw and Ip isotropic, these two 2� 2 matrices
having been defined in Sect. 12.5.1.
</p>
<p>12.5 Derive the mathematical model governing the motion of a two-dof rolling
robot with conventional wheels, similar to that of Fig. 10.17, but with two
caster wheels instead. The vertical axes of the caster wheels are a distance l
apart and a distance aCb from the common axis of the driving wheels. What
is the characteristic length of this robot?
</p>
<p>12.6 Find the conditions under which the three-wheeled robot with omnidirec-
tional wheels analyzed in Sect. 12.5.2 has an isotropic inertia matrix. Discuss
the advantages of such an inertially isotropic robot.</p>
<p/>
</div>
<div class="page"><p/>
<p>12.6 Exercises 545
</p>
<p>12.7 With reference to the omnidirectional robot of Sect. 12.5.2, show that the
mathematical model can be manipulated to yield a single first-order ordinary
differential equation in !, of the form
</p>
<p>P! C k! D f .t/
</p>
<p>in which k is a constant with units of frequency, its inverse being the time-
constant of the system. Find expressions for k and f .t/. Then, integrate the
above equation in closed form, to obtain the time-history of ! for a given
time-history f .t/ and given initial condition !.0/.
</p>
<p>12.8 Establish the conditions on the actuated joint rates under which the three-
wheeled robot with omnidirectional wheels of Sect. 12.5.2 undergoes pure
translation. Under these conditions, the robot has only two degrees of
freedom and, hence, a 2�2 inertia matrix. Derive an expression for its inertia
matrix. Hint: The constraint for pure translation can be written as
</p>
<p>aT P�a D 0
</p>
<p>and hence, if the 3 � 2 matrix L is an orthogonal complement of a, i.e., if
aTL D 0T2 , where 02 is the two-dimensional zero vector, then the underlying
Euler&ndash;Lagrange equations of the constrained system can be derived by
</p>
<p>multiplying the two sides of the mathematical model found in Sect. 12.5.2
</p>
<p>by LT :
</p>
<p>LT I R�a C LTC P�a D LT � � LT ı
</p>
<p>Further, upon writing P�a as a linear transformation of a two-dimensional
vector u, namely, as
</p>
<p>P�a D Lu
</p>
<p>we obtain
</p>
<p>LT IL PuC LTCLu D LT � � LT ı
</p>
<p>and hence, the generalized inertia matrix under pure translation is LT IL.
12.9 Find the maneuver(s) under which the Coriolis and centrifugal forces of the
</p>
<p>robot analyzed in Sect. 12.5.2 vanish. Note that in general, these forces do not
vanish, even though the generalized inertia matrix of the robot is constant.
</p>
<p>12.10 Find the eigenvalues and eigenvectors of the matrix of generalized inertia
of the three-dof rolling robot with omnidirectional wheels analyzed in
Sect. 12.5.2.
</p>
<p>12.11 The Euler&ndash;Lagrange equations derived for holonomic mechanical systems in
Sect. 12.3, termed the Euler&ndash;Lagrange equations of the second kind, require
that the generalized coordinates describing the system be independent. In</p>
<p/>
</div>
<div class="page"><p/>
<p>546 12 Dynamics of Complex Robotic Mechanical Systems
</p>
<p>nonholonomic mechanical systems, a set of kinematic constraints is not
integrable, which prevents us from solving for dependent from independent
generalized coordinates, the application of the Euler&ndash;Lagrange equations
as described in that section thus not being possible. However, dependent
generalized coordinates can be used if the Euler&ndash;Lagrange equations of the
first kind are recalled. To this end, we let q be the m-dimensional vector of
generalized coordinates that are subject to p differential constraints of the
form
</p>
<p>A.q/ Pq D b.q; t /
</p>
<p>where A is a p � m matrix of constraints and b is a p-dimensional vector
depending on the configuration q and, possibly, on time explicitly. When
b does not contain t explicitly, the constraints are termed scleronomic;
otherwise, rheonomic. Furthermore, let n � m � p be the mobility of the
system. The Euler&ndash;Lagrange equations of the first kind of the system at hand
take on the form
</p>
<p>d
</p>
<p>dt
</p>
<p>�
@L
</p>
<p>@ Pq
</p>
<p>�
</p>
<p>� @L
@q
D �C AT�
</p>
<p>where � is a p-dimensional vector of Lagrange multipliers that are chosen
so as to satisfy the kinematic constraints. Thus, we regard the m dependent
generalized coordinates grouped in vector q as independent, their constraints
giving rise to the constraint forces AT�.
</p>
<p>Use the Euler&ndash;Lagrange equations of the first kind to set up the mathe-
matical model of the rolling robot with omnidirectional wheels studied in
Sect. 12.5.2.</p>
<p/>
</div>
<div class="page"><p/>
<p>Erratum
</p>
<p>Fundamentals of Robotic Mechanical Systems
Theory, Methods, and Algorithms
</p>
<p>Fourth Edition
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
</p>
<p>and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5,
</p>
<p>c&#13; Springer International Publishing Switzerland 2014
</p>
<p>DOI 10.1007/978-3-319-01851-5_13
</p>
<p>The publisher regrets the error in the print and online versions of this book. Listed
</p>
<p>below are the corrections.
</p>
<p>Introduction: In order to ease the finding of items
</p>
<p>in this document, we have kept the page format and
</p>
<p>the original fonts of the book; we have also typeset
</p>
<p>with typewriter font--the one used in this Introd-
</p>
<p>uction--text that does not belong to the book.
</p>
<p>p. 93: The correct matrix ŒR2&#141;C is
</p>
<p>ŒR2&#141;C D
</p>
<p>2
</p>
<p>4
</p>
<p>0:373 �0:926 0:043
</p>
<p>0:902 0:352 �0:249
</p>
<p>0:215 0:132 0:967
</p>
<p>3
</p>
<p>5
</p>
<p>p. 129: Line below Eq. (3.133a): in light of Eq. (2.39), should
</p>
<p>read: in light of Eq. (2.40)
</p>
<p>p. 137: In Exercise 3.20, the expression forMA is faulty.
</p>
<p>The correct expression is
</p>
<p>MA D MC CmPP
T
</p>
<p>p. 144: The last line of text, &ldquo;One thus has, using subscripted brack-
</p>
<p>ets as introduced in Sect. 2.2,&rdquo;, should read:
</p>
<p>&ldquo;One thus has, using subscripted brackets as introduced in Sect. 2.3,&rdquo;
</p>
<p>The online version of the original book  can be found at
</p>
<p>http://dx.doi.org/10.1007/978-3-319-01851-5
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods, E-1
</p>
<p>and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5_13,
</p>
<p>c&#13; Springer International Publishing Switzerland 2014</p>
<p/>
<div class="annotation"><a href="http://dx.doi.org/10.1007/978-3-319-01851-5_13">http://dx.doi.org/10.1007/978-3-319-01851-5_13</a></div>
</div>
<div class="page"><p/>
<p>E-2 Erratum
</p>
<p>p. 171: The third line of text below eq. (4.33), &ldquo;From Defi-
</p>
<p>nition 2.2.1, then Œu&#141;1 D Œe7&#141;1 D Œe6&#141;1&rdquo;, should read:
</p>
<p>&ldquo;From Definition 2.2.1, then Œu&#141;1 D Œe7&#141;1 D Œe6&#141;1&rdquo;
</p>
<p>p. 178: The correct expression for Q123 is
</p>
<p>Q123 D Q1Q2Q3 D
</p>
<p>2
</p>
<p>4
</p>
<p>0 1 0
</p>
<p>�1 0 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>Œe6&#141;4 should read:
</p>
<p>Œe6&#141;4 D .Q1Q2Q3/
T Œe6&#141;1 D
</p>
<p>2
</p>
<p>4
</p>
<p>0 �1 0
</p>
<p>1 0 0
</p>
<p>0 0 1
</p>
<p>3
</p>
<p>5
</p>
<p>2
</p>
<p>4
</p>
<p>2=3
</p>
<p>�2=3
</p>
<p>�1=3
</p>
<p>3
</p>
<p>5 D
</p>
<p>2
</p>
<p>4
</p>
<p>2=3
</p>
<p>2=3
</p>
<p>�1=3
</p>
<p>3
</p>
<p>5
</p>
<p>�4;2 should be
</p>
<p>�4;2 D �80:26438967
ı
</p>
<p>p. 182: The caption of Fig. 4.26 is faulty. The correct
</p>
<p>caption isMotoman-EA1400Nwelding robot: (a) top view; (b) side
</p>
<p>view; (c) orthographic projection; (d) view A, as per side view; (e) view
</p>
<p>B, as per side view. All dimensions in mm
</p>
<p>p. 200 Where it reads: (b) the moments of the three lines about any point
</p>
<p>on the intersecting line are all zero, the correct wording should read:
</p>
<p>(b) the moments of the three lines with respect to the intersecting line are
</p>
<p>all zero.
</p>
<p>p. 202: The expression for ˛ is faulty. The correct expre-
</p>
<p>ssion is
</p>
<p>˛ D
</p>
<p>q
</p>
<p>a23 C b
2
4
</p>
<p>q
</p>
<p>a22 C d
2 C
</p>
<p>q
</p>
<p>a23 C b
2
4
</p>
<p>Please refer to Appendix A for details.
</p>
<p>p. 211: Where it reads: with �a and �w defined as the wrist and the arm
</p>
<p>torques, respectively, the correct wording should read:
</p>
<p>with �a and �w defined as the arm and the wrist torques, respectively.</p>
<p/>
</div>
<div class="page"><p/>
<p>Erratum E-3
</p>
<p>p. 219: Equation (5.67c) should read:
</p>
<p>R�1 D R� � . R�2 C R�3/
</p>
<p>p. 291: The second line of the expression for �2 should
</p>
<p>read:
</p>
<p>�
1
</p>
<p>2
m3a3.a1s23 C 2a2s3/ P�1 P�3 �m3a2a3s3 P�2 P�3 �
</p>
<p>1
</p>
<p>2
m3a2a3s3 P�
</p>
<p>2
3
</p>
<p>p. 321: Caption of Fig. 7.7 should read:
</p>
<p>Mass-center location of the robot of Fig. 4.17
</p>
<p>p. 324: The second line of the expression for Pt11 should
</p>
<p>read:
</p>
<p>D
</p>
<p>�
</p>
<p>Pe1
</p>
<p>Pe1 � �1 C e1 � P�1
</p>
<p>�
</p>
<p>The second line of the expression for Pt21 should
</p>
<p>read:
</p>
<p>D
</p>
<p>�
</p>
<p>0
</p>
<p>e1 � .!1 � a1 C !2 � �2/
</p>
<p>�
</p>
<p>D p
</p>
<p>�
</p>
<p>0
</p>
<p>.a=2/.i � 3j/
</p>
<p>�
</p>
<p>The fourth line of the expression for Pt31 should
</p>
<p>read:
</p>
<p>D p
</p>
<p>�
</p>
<p>0
</p>
<p>.a=2/.i � 3j/
</p>
<p>�
</p>
<p>The second line of the expression for Pt32 should
</p>
<p>read:
</p>
<p>D
</p>
<p>�
</p>
<p>pe1 � e2
.pe1 � e2/ � .a2 C �3/C e2 � Œp.e1 C e2/ � a2 C p.e1 C e2 C e3/ � �3&#141;
</p>
<p>�
</p>
<p>p. 325: Entry (3,1) of matrix TT M PT is flawed. The correct
</p>
<p>expression for this matrix is:
</p>
<p>TT M PT D p
</p>
<p>2
</p>
<p>4
</p>
<p>�.1=4/a2m .7=4/a2m �.1=2/a2m � I
</p>
<p>.1=4/a2m 0 .1=4/a2mC I
</p>
<p>.3=4/a2m .1=4/a2m � I 0
</p>
<p>3
</p>
<p>5 � P</p>
<p/>
</div>
<div class="page"><p/>
<p>E-4 Erratum
</p>
<p>p. 326: Entries (1,3), (2,3) and (3,1) of matrix PI are faulty. The correct expression
</p>
<p>of the matrix is:
</p>
<p>PI D p
</p>
<p>2
</p>
<p>4
</p>
<p>�.1=2/a2m .5=4/a2m �I C .1=4/a2m
</p>
<p>.5=4/a2m 0 .1=2/a2m
</p>
<p>�I C .1=4/a2m .1=2/a2m 0
</p>
<p>3
</p>
<p>5
</p>
<p>p. 327: The second-to-last line of text, &ldquo;Now we have&rdquo;,
</p>
<p>should read:
</p>
<p>&ldquo;Now, the matrix C of Coriolis and centrifugal forces is obtained as shown
</p>
<p>below:&rdquo;
</p>
<p>The last equation displayed should read:
</p>
<p>C D TT M PT C TT WMT D pA
</p>
<p>p. 328 Entry (1,1) of matrix A is flawed. The correct
</p>
<p>expression is
</p>
<p>A �
</p>
<p>2
</p>
<p>4
</p>
<p>�.1=4/a2m .7=4/a2mC I �.1=2/a2m � 2I
</p>
<p>�.1=2/a2m � I 0 .1=4/a2mC 2I
</p>
<p>.3=4/a2mC I .1=4/a2m � 2I 0
</p>
<p>3
</p>
<p>5
</p>
<p>The first entry of the vector array in the second
</p>
<p>equation display has a &ldquo;(1/2)&rdquo; too much. The cor-
</p>
<p>rect display is
</p>
<p>.TT M PT C TT WMT/ P� D p2
</p>
<p>2
</p>
<p>4
</p>
<p>a2m � I
</p>
<p>�.1=4/a2mC I
</p>
<p>a2m � I
</p>
<p>3
</p>
<p>5
</p>
<p>p. 329: The second line of the expression for Rc3 has an &ldquo;D&rdquo;
</p>
<p>too much. It should read:
</p>
<p>C!3 � .!3 � �3/ D
1
</p>
<p>2
ap2.�4j C k/ �
</p>
<p>1
</p>
<p>2
ap2j C
</p>
<p>1
</p>
<p>2
ap2.2i � j C k/
</p>
<p>The expressions for fP2 , n
P
2 , and f
</p>
<p>P
1 are faulty. They
</p>
<p>should read:
</p>
<p>fP2 Dm2Rc2 C f
P
3 D
</p>
<p>1
</p>
<p>2
amp2.�4j C k/ � 2amp2j D
</p>
<p>1
</p>
<p>2
amp2.�8j C k/
</p>
<p>nP2 D I2 P!2&bdquo;ƒ&sbquo;&hellip;
Ip2.�i/
</p>
<p>C!2 � I2!2
&bdquo; ƒ&sbquo; &hellip;
</p>
<p>0
</p>
<p>C nP3
&bdquo;ƒ&sbquo;&hellip;
</p>
<p>Ip2.�iCj�k/Ca2mp2.i�2k/
</p>
<p>C .a2 � �2/ � f
P
3
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>a2mp2.�iCk/
</p>
<p>C �2 � f
P
2
</p>
<p>&bdquo; ƒ&sbquo; &hellip;
</p>
<p>1
4 a
</p>
<p>2mp2.�6i�j�8k/</p>
<p/>
</div>
<div class="page"><p/>
<p>Erratum E-5
</p>
<p>DIp2.�2i C j � k/C
1
</p>
<p>4
a2mp2.�6i � j � 12k/
</p>
<p>fP1 Dm1Rc1 C f
P
2 D
</p>
<p>1
</p>
<p>2
amp2.i � j/C
</p>
<p>1
</p>
<p>2
amp2.�8j C k/
</p>
<p>D
1
</p>
<p>2
amp2.i � 9j C k/
</p>
<p>p. 330: The second equation display, that of �1, is faulty.
</p>
<p>The correct expression reads:
</p>
<p>�1 D n
P
1 � e1 D �Ip
</p>
<p>2
C a2mp2
</p>
<p>The first component of vector C.� ; P�/ P� is faulty.
</p>
<p>The correct expression is
</p>
<p>C.�; P�/ P� D
</p>
<p>2
</p>
<p>4
</p>
<p>�Ip2 C a2mp2
</p>
<p>Ip2 � .1=4/a2mp2
</p>
<p>�Ip2 C a2mp2
</p>
<p>3
</p>
<p>5
</p>
<p>Appendix A
</p>
<p>Z1
</p>
<p>Z2
</p>
<p>Z2
</p>
<p>Z3
</p>
<p>Z3
</p>
<p>Z4
</p>
<p>Z5
</p>
<p>Z6
</p>
<p>X1
</p>
<p>X2
</p>
<p>X3
</p>
<p>X4
X5
</p>
<p>O1, O2
</p>
<p>O1, O2
</p>
<p>O3
</p>
<p>O3
</p>
<p>O4
</p>
<p>O4
</p>
<p>C
</p>
<p>C
</p>
<p>I
</p>
<p>I
</p>
<p>I
</p>
<p>a2
</p>
<p>a2
</p>
<p>a3
</p>
<p>a3
</p>
<p>d
</p>
<p>d
</p>
<p>b4
</p>
<p>b4
</p>
<p>a2
3
</p>
<p>+ b2
4
</p>
<p>a2
3
</p>
<p>+ d2
</p>
<p>&radic;
</p>
<p>&radic;
</p>
<p>FIGURE 1. Elbow singularity of the Puma robot</p>
<p/>
</div>
<div class="page"><p/>
<p>E-6 Erratum
</p>
<p>With reference to the figure above, the relations below can be derived:
</p>
<p>˛ D
IC
</p>
<p>O2C
(1)
</p>
<p>IC D
</p>
<p>q
</p>
<p>a23 C b
2
4 (2)
</p>
<p>O2C D O2I C IC (3)
</p>
<p>O2I D
</p>
<p>q
</p>
<p>a22 C d
2 (4)</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix A
</p>
<p>Kinematics of Rotations: A Summary
</p>
<p>The purpose of this appendix is to outline proofs of some results in the realm of
kinematics of rotations that were invoked in the preceding chapters. Further details
are available in the literature (Angeles 1988).
</p>
<p>We start by noticing two preliminary facts whose proof is straightforward, as the
reader is invited to verify.
</p>
<p>Lemma A.1. The .d=dt/. � / and the vect. � / operators, for 3� 3 matrix operands,
commute.
</p>
<p>and
</p>
<p>Lemma A.2. The .d=dt/. � / and the tr. � / operators, for n � n matrix operands,
commute.
</p>
<p>Furthermore, we have
</p>
<p>Theorem A.1. Let A and S both be 3 � 3 matrices, the former arbitrary, the latter
skew-symmetric. Then,
</p>
<p>vect.SA / D 1
2
Œtr.A/1 � A&#141;s
</p>
<p>where s � vect.S /.
Proof. An invariant proof of this theorem appears elusive, but a componentwise
proof is straightforward. Indeed, let aij denote the .i; j / entry of A, and si the i th
component of s. Then,
</p>
<p>SA D
</p>
<p>2
</p>
<p>4
</p>
<p>�a21s3 C a31s2 �a22s3 C a32s2 �a23s3 C a33s2
a11s3 � a31s1 a12s3 � a32s1 a13s3 � a33s1
�a11s2 C a21s1 �a12s2 C a22s1 �a13s2 C a23s1
</p>
<p>3
</p>
<p>5
</p>
<p>Hence,
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>547</p>
<p/>
</div>
<div class="page"><p/>
<p>548 A Kinematics of Rotations: A Summary
</p>
<p>vect.SA / D 1
2
</p>
<p>2
</p>
<p>4
</p>
<p>.a22 C a33/s1 � a12s2 � a13s3
</p>
<p>.a11 C a33/s2 � a21s1 � a23s3
</p>
<p>.a11 C a22/s3 � a31s1 � a32s2
</p>
<p>3
</p>
<p>5
</p>
<p>On the other hand,
</p>
<p>tr.A /1 � A D
</p>
<p>2
</p>
<p>4
</p>
<p>a22 C a33 �a12 �a13
�a21 a11 C a33 �a23
�a31 �a32 a11 C a22
</p>
<p>3
</p>
<p>5
</p>
<p>and hence,
</p>
<p>1
</p>
<p>2
Œtr.A /1 � A&#141;s D 1
</p>
<p>2
</p>
<p>2
</p>
<p>4
</p>
<p>.a22 C a33/s1 � a12s2 � a13s3
</p>
<p>.a11 C a33/s2 � a21s1 � a23s3
</p>
<p>.a11 C a22/s3 � a31s1 � a32s2
</p>
<p>3
</p>
<p>5
</p>
<p>thereby completing the proof. Moreover, we have
</p>
<p>Theorem A.2. Let A, S, and s be defined as in Theorem A.1. Then,
</p>
<p>tr.SA / D �2s � Œvect.A /&#141;
</p>
<p>Proof. From the above expression for SA,
</p>
<p>tr.SA / D �a21s3 C a31s2 C a12s3 � a32s1 � a13s2 C a23s1
D .a23 � a32/s1 C .a31 � a13/s2 C .a12 � a21/s3
</p>
<p>D
�
</p>
<p>s1 s2 s3
�
</p>
<p>2
</p>
<p>4
</p>
<p>a23 � a32
a31 � a13
a12 � a21
</p>
<p>3
</p>
<p>5 D �2s � Œvect.A /&#141; (A.1)
</p>
<p>q.e.d.
</p>
<p>Now we turn to the proof of the relations between the time-derivatives of the
rotation invariants and the angular-velocity vector. Thus,
</p>
<p>Theorem A.3. Let � denote the four-dimensional array of natural rotation invari-
</p>
<p>ants, as introduced in Sect. 2.3.2 and reproduced below for quick reference:
</p>
<p>� �
�
</p>
<p>e
</p>
<p>�
</p>
<p>�
</p>
<p>Then the relationship between P� and the angular velocity ! is given by</p>
<p/>
</div>
<div class="page"><p/>
<p>A Kinematics of Rotations: A Summary 549
</p>
<p>P� D N!
</p>
<p>with N defined as
</p>
<p>N �
�
</p>
<p>Œsin�=.2.1 � cos�//&#141;.1 � eeT / � .1=2/E
eT
</p>
<p>�
</p>
<p>Proof. Let us obtain first an expression for Pe. This is readily done by recalling that
e is the real eigenvector of Q, i.e.,
</p>
<p>Qe D e
</p>
<p>Upon differentiation of both sides of the foregoing equation with respect to time,
we have
</p>
<p>PQeCQPe D Pe
</p>
<p>i.e.,
</p>
<p>.1 �Q/Pe D PQe
</p>
<p>An expression for PQ can be derived from Eq. (3.44), which yields
</p>
<p>PQ D &#127;Q (A.2)
</p>
<p>Therefore,
</p>
<p>PQe D &#127;e � ! � e
</p>
<p>and hence, the above equation for Pe takes the form
</p>
<p>.1 �Q/Pe D ! � e
</p>
<p>from which it is not possible to solve for Pe because matrix .1�Q/ is singular. Indeed,
since both matrices inside the parentheses have an eigenvalue C1, their difference
has an eigenvalue 0, which renders this difference singular. Thus, one more relation
is needed in order to be able to determine Pe. This relation follows from the condition
that kek2 D 1. Upon differentiation of both sides of this condition with respect to
time, we obtain
</p>
<p>eT Pe D 0
</p>
<p>the last two equations thus yielding a system of four scalar equations to
determine Pe. We now assemble these equations into a single one, namely,</p>
<p/>
</div>
<div class="page"><p/>
<p>550 A Kinematics of Rotations: A Summary
</p>
<p>APe D b
</p>
<p>where A is a 4 � 3 matrix, while b is a four-dimensional vector, defined as
</p>
<p>A �
�
</p>
<p>1 �Q
eT
</p>
<p>�
</p>
<p>; b �
�
</p>
<p>! � e
0
</p>
<p>�
</p>
<p>The foregoing overdetermined system of four equations in three unknowns now
leads to a system of three equations in three unknowns if we multiply its two sides
by AT from the right, thereby producing
</p>
<p>ATAPe D AT b
</p>
<p>We can therefore solve for Pe from the above equation in the form
</p>
<p>Pe D .ATA/�1AT b
</p>
<p>where ATA takes the form
</p>
<p>ATA D .2/1 � .QCQT /C eeT
</p>
<p>But the sum inside the parentheses is readily identified as twice the symmetric
component of Q, if we recall the Cartesian decomposition of matrices introduced
in Eq. (2.57). Therefore,
</p>
<p>QCQT D 2Œ.cos�/1C .1 � cos�/eeT &#141;
</p>
<p>Hence,
</p>
<p>ATA D 2.1 � cos�/1 � .1 � 2 cos�/eeT
</p>
<p>As the reader can readily verify, the inverse of this matrix is given by
</p>
<p>.ATA/�1 D 1
2.1 � cos�/1C
</p>
<p>1 � 2 cos�
2.1 � cos�/ee
</p>
<p>T
</p>
<p>which fails to exist only in the trivial case in which Q becomes the identity matrix.
Upon expansion of the last expression for Pe, we have
</p>
<p>Pe D � 1
2.1 � cos�/.E �Q
</p>
<p>TE/!
</p>
<p>Now QTE is obtained by recalling Eq. (2.55), thereby obtaining
</p>
<p>QTE D .cos�/EC .sin�/.1 � eeT /</p>
<p/>
</div>
<div class="page"><p/>
<p>A Kinematics of Rotations: A Summary 551
</p>
<p>the final expression for Pe thus being
</p>
<p>Pe D � 1
2.1 � cos�/ Œ.1 � cos�/E � .sin�/.1 � ee
</p>
<p>T /&#141;!
</p>
<p>Now, an expression for P� is obtained upon equating the trace of the two sides of
Eq. (A.2), which yields
</p>
<p>tr. PQ / D tr.&#127;Q / (A.3)
</p>
<p>From Lemma A.2,
</p>
<p>tr. PQ / D d
dt
</p>
<p>tr.Q / (A.4)
</p>
<p>and hence,
</p>
<p>tr. PQ / D �2 P� sin�
</p>
<p>On the other hand, from Theorem A.2,
</p>
<p>tr.&#127;Q / D �2! � .sin�/e
</p>
<p>Therefore,
</p>
<p>P� D ! � e
</p>
<p>Upon assembling the expressions for Pe and P�, we obtain the desired relation, with
N given as displayed above, thereby proving the theorem.
</p>
<p>Theorem A.4. Let � denote the four-dimensional array of linear rotation invari-
</p>
<p>ants, as introduced in Sect. 2.3.3 and reproduced below for quick reference:
</p>
<p>� �
�
</p>
<p>.sin�/e
cos�
</p>
<p>�
</p>
<p>�
�
</p>
<p>vect.Q /
Œtr.Q / � 1&#141;=2
</p>
<p>�
</p>
<p>Then the relationship between P� and the angular velocity is given by
</p>
<p>P� D L!
</p>
<p>with L defined as
</p>
<p>L �
�
</p>
<p>.1=2/Œtr.Q/1 �Q&#141;
�.sin�/eT
</p>
<p>�</p>
<p/>
</div>
<div class="page"><p/>
<p>552 A Kinematics of Rotations: A Summary
</p>
<p>Proof. From Lemma A.1, we have
</p>
<p>d
</p>
<p>dt
vect.Q / D vect. PQ / (A.5)
</p>
<p>On the other hand, equating the vectors of the two sides of Eq. (A.2) yields
</p>
<p>vect. PQ / D vect.&#127;Q /
</p>
<p>and hence,
</p>
<p>d
</p>
<p>dt
vect.Q / D vect.&#127;Q /
</p>
<p>But, if we recall Theorem A.1, the foregoing relation leads to
</p>
<p>d
</p>
<p>dt
vect.Q / D 1
</p>
<p>2
Œtr.Q/1 �Q&#141;!
</p>
<p>Likewise, from Lemma A.2, we have
</p>
<p>d
</p>
<p>dt
tr.Q / D tr. PQ /
</p>
<p>and hence,
</p>
<p>d
</p>
<p>dt
tr.Q / D tr.&#127;Q /
</p>
<p>Now, if we recall Theorem A.2, the foregoing relation leads to
</p>
<p>d
</p>
<p>dt
tr.Q / D �2! � Œvect.Q /&#141; D �2.sin�/eT!
</p>
<p>Hence,
</p>
<p>d
</p>
<p>dt
.cos�/ D �.sin�/eT!
</p>
<p>Upon assembling the last two expressions for the time-derivatives of the vector of
Q and cos�, we obtain the desired relation.
</p>
<p>Theorem A.5. Let � denote the four-dimensional array of the Euler&ndash;Rodrigues
</p>
<p>parameters of a rotation, as introduced in Sect. 2.3.6 and reproduced below for quick
</p>
<p>reference:</p>
<p/>
</div>
<div class="page"><p/>
<p>A Kinematics of Rotations: A Summary 553
</p>
<p>� �
�
</p>
<p>Œsin.�=2/&#141;e
cos.�=2/
</p>
<p>�
</p>
<p>�
�
</p>
<p>r
</p>
<p>r0
</p>
<p>�
</p>
<p>Then, the relationship between P� and the angular velocity takes the form
</p>
<p>P� D H!
</p>
<p>with H defined as
</p>
<p>H � 1
2
</p>
<p>�
</p>
<p>cos.�=2/1 � sin.�=2/E
� sin.�=2/eT
</p>
<p>�
</p>
<p>� 1
2
</p>
<p>�
</p>
<p>r01 � R
�rT
</p>
<p>�
</p>
<p>where R is the cross-product matrix of r.
</p>
<p>Proof. If we differentiate r, we obtain
</p>
<p>Pr D Pe sin
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>C e
P�
2
</p>
<p>cos
</p>
<p>�
�
</p>
<p>2
</p>
<p>�
</p>
<p>and hence, all we need to derive the desired relations is to find expressions for Pe
and P� in terms of the Euler&ndash;Rodrigues parameters. Note that from Theorem A.3, we
already have those expressions in terms of the natural invariants. Thus, substitution
of the time-derivatives of the natural invariants, as given in Theorem A.3, into the
above expression for Pr leads to
</p>
<p>Pr D �1
2
</p>
<p>sin
</p>
<p>�
�
</p>
<p>2
</p>
<p>�
</p>
<p>E!C 1
2
</p>
<p>sin
</p>
<p>�
�
</p>
<p>2
</p>
<p>�
sin�
</p>
<p>1 � cos�!
</p>
<p>C 1
2
.e �!/
</p>
<p>�
</p>
<p>cos
</p>
<p>�
�
</p>
<p>2
</p>
<p>�
</p>
<p>� sin
�
�
</p>
<p>2
</p>
<p>�
sin�
</p>
<p>1 � cos�
</p>
<p>�
</p>
<p>e (A.6)
</p>
<p>Now, by recalling the identities giving the trigonometric functions of � in terms of
those of �=2, we obtain
</p>
<p>sin
</p>
<p>�
�
</p>
<p>2
</p>
<p>�
sin�
</p>
<p>1 � cos� D cos
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>and hence, the term in brackets of the above expression vanishes, the expression for
Pr thus reducing to
</p>
<p>Pr D 1
2
</p>
<p>�
</p>
<p>cos
</p>
<p>�
�
</p>
<p>2
</p>
<p>�
</p>
<p>1 � sin
�
�
</p>
<p>2
</p>
<p>�
</p>
<p>E
</p>
<p>�
</p>
<p>! � 1
2
.r01 � R/!
</p>
<p>thereby completing the proof.</p>
<p/>
</div>
<div class="page"><p/>
<p>Appendix B
</p>
<p>Numerical Equation-Solving
</p>
<p>The numerical solution of the most common types of systems of linear and nonlinear
equations is outlined in this appendix.
</p>
<p>We start with the solution of the linear algebraic system
</p>
<p>Ax D b (B.1)
</p>
<p>with A defined as a full-rank m�n matrix, while x and b are n- andm-dimensional
vectors, respectively. The case m D n is the most frequently encountered; this case
was discussed in Sect. 5.2 and need not be further discussed. We will consider only
two cases:
</p>
<p>(a) overdetermined: m &gt; n; and
(b) underdetermined: m &lt; n.
</p>
<p>The overdetermined case does not admit a solution, unless vector b happens to lie
in the range of A. Besides this special case, then, we must reformulate the problem;
rather than seeking a solution of Eq. (B.1), we will look for an approximation of that
system of equations. Moreover, we will seek an approximation that will satisfy an
optimality condition.
</p>
<p>The underdetermined case, on the contrary, admits infinitely many solutions, the
objective then being to seek one that satisfies (a) the system of equations and (b) an
additional optimality condition as well.
</p>
<p>A nonlinear system of equations takes the form
</p>
<p>f.x/ D 0m
</p>
<p>where f and x are m- and n-dimensional vectors, respectively, while 0m is the
m-dimensional zero vector. We consider the cases:
</p>
<p>(a) determined: m D n; and
(b) overdetermined: m &gt; n.
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>555</p>
<p/>
</div>
<div class="page"><p/>
<p>556 B Numerical Equation-Solving
</p>
<p>The underdetermined case m &lt; n, not occurring in the book, and requiring
specialized knowledge of mathematical programming, is left out.
</p>
<p>We study each of the two cases above in the sections below.
</p>
<p>B.1 The Overdetermined Linear Case
</p>
<p>The error e in the approximation of Eq. (B.1) is defined as
</p>
<p>e � b � Ax (B.2)
</p>
<p>An obvious way of imposing an optimality condition on the solution x is to
specify that this solution minimize a norm of e. All norms of e can be expressed as
</p>
<p>kekp �
 
</p>
<p>1
</p>
<p>m
</p>
<p>m
X
</p>
<p>1
</p>
<p>jekjp
!1=p
</p>
<p>(B.3)
</p>
<p>with ek being understood as the kth component of the m-dimensional vector e.
When p D 2, the foregoing norm is known as the Euclidean norm, which we have
used most frequently in this book. When p !1, the infinity norm, also known as
the Chebyshev norm, is obtained. It turns out that upon seeking the value of x that
minimizes a norm of e, the simplest is the Euclidean norm, for the minimization
of its square leads to a linear system of equations whose solution can be obtained
directly, as opposed to iteratively. Indeed, let us set up the minimization problem
below:
</p>
<p>z.x/ � 1
2
kek22 ! min
</p>
<p>x
(B.4)
</p>
<p>The normality condition of the minimization problem at hand is derived upon setting
the gradient of z with respect to x equal to zero, i.e.,
</p>
<p>d z
</p>
<p>dx
D 0 (B.5)
</p>
<p>Now, the chain rule and the results of Sect. 2.3.1 allow us to write
</p>
<p>d z
</p>
<p>dx
�
�
de
</p>
<p>dx
</p>
<p>�T
d z
</p>
<p>de
� �AT e (B.6)
</p>
<p>and hence, we have the first result:
</p>
<p>Theorem B.1. The error in the approximation of Eq. (B.1), for the full-rank m � n
matrix A, with m &gt; n, is of minimum Euclidean norm if it lies in the null space
</p>
<p>of AT :</p>
<p/>
</div>
<div class="page"><p/>
<p>B Numerical Equation-Solving 557
</p>
<p>AT e D 0n (B.7)
</p>
<p>Furthermore, if Eq. (B.2) is substituted into Eq. (B.6), and the product thus
resulting is substituted, in turn, into the normality condition, we obtain
</p>
<p>ATAx D AT b (B.8)
</p>
<p>which is known as the normal equation of the minimization problem at hand. By
virtue of the assumption on the rank of A, the product ATA is positive-definite and
hence, invertible. As a consequence, the value x0 of x that minimizes the Euclidean
norm of the approximation error of the given system is
</p>
<p>x0 D .ATA/�1AT b (B.9)
</p>
<p>the matrix coefficient of b being known as a generalized inverse of A. The error
obtained with this value is known as the least-square error of the approximation,
i.e.,
</p>
<p>e0 � b � Ax0 (B.10)
</p>
<p>The reader should be able to prove one more result:
</p>
<p>Theorem B.2 (Projection Theorem). The least-square error e0 is orthogonal
</p>
<p>to Ax0.
</p>
<p>While the formula yielding the foregoing generalized inverse is quite simple to
implement, the number of floating-point operations (flops) it takes to evaluate,
along with the ever-present roundoff errors in both the data and the results,
renders it not only inefficient, but also unreliable if applied as such. Indeed, if
we recall the concept of condition number, introduced in Sect. 5.8 and recalled in
Sect. 9.4.1, along with the definition adopted in the latter for the condition number,
it becomes apparent that the condition number of ATA is exactly the square of the
condition number of A. This result can be best understood if we apply the Polar-
Decomposition Theorem, introduced in Sect. 5.8, to rectangular matrices, but we
will not elaborate on this issue here.
</p>
<p>As a consequence, then, even if A is only slightly ill-conditioned, the product
ATA can be catastrophically ill-conditioned. Below we outline two procedures to
calculate efficiently the least-square approximation of the overdetermined system
(B.1) that preserve the condition number of A and do this with a low number of
flops (floating-point operations).</p>
<p/>
</div>
<div class="page"><p/>
<p>558 B Numerical Equation-Solving
</p>
<p>B.1.1 The Numerical Solution of an Overdetermined System
</p>
<p>of Linear Equations
</p>
<p>In seeking a numerical solution of the system of equations at hand, we would
like to end up with a triangular system, similar to the LU-decomposition applied
to solve a system of as many equations as unknowns, and hence, we have to
perform some transformations either on the rows of A or on its columns. A safe
numerical procedure should thus preserve (a) the Euclidean norm of the columns
of A and (b) the inner product between any two columns of this matrix. Hence, a
triangularization procedure like LU-decomposition would not work, because this
does not preserve inner products. Obviously, the transformations that do preserve
these inner products are orthogonal, either rotations or reflections. Of these, the most
best-known methods are (a) the Gram&ndash;Schmidt orthogonalization procedure and
(b) Householder reflections.
</p>
<p>The Gram&ndash;Schmidt procedure consists in regarding the columns of A as a set of
n m-dimensional vectors f ak gn1 . From this set, a new set f ek gn1 is obtained that is
orthonormal. The procedure is quite simple and works as follows: Define e1 as
</p>
<p>e1 D
a1
</p>
<p>ka1k
(B.11)
</p>
<p>Further, we define e2 as the normal component of a2 onto e2, as introduced in
Eq. (2.6b), i.e.,
</p>
<p>a?2 � .1 � e1eT1 /a2 (B.12a)
</p>
<p>e2 �
a?2
ka?2 k
</p>
<p>(B.12b)
</p>
<p>In the next step, we define e3 as the unit vector normal to the plane defined by
e1 and e2 and in the direction in which the inner product eT3 a3 is positive, which
is possible because all vectors of the set f ak gm1 have been assumed to be linearly
independent&mdash;remember that A has been assumed to be of full rank. To this end, we
subtract from a3 its projection onto the plane mentioned above, i.e.,
</p>
<p>a?3 D .1 � e1eT1 � e2eT2 /a3 (B.13a)
</p>
<p>e3 �
a?3
ka?3 k
</p>
<p>(B.13b)
</p>
<p>and so on, until we obtain en�1, the last unit vector of the orthogonal set, en, being
obtained as
</p>
<p>a?n D .1 � e1eT1 � e2eT2 � � � � � en�1eTn�1/an (B.14a)</p>
<p/>
</div>
<div class="page"><p/>
<p>B Numerical Equation-Solving 559
</p>
<p>Finally,
</p>
<p>en �
a?n
ka?n k
</p>
<p>(B.14b)
</p>
<p>In the next stage, we represent all vectors of the set f ak gn1 in orthogonal coordinates,
i.e., in the base O D f ek gn1 , which are then arranged in anm�n array Ao. By virtue
of the form in which the set f ek gn1 was defined, the lastm�k components of vector
ak vanish. We thus have, in the said orthonormal basis,
</p>
<p>Œ ak &#141;O D
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>˛1k
˛2k
:::
</p>
<p>˛kk
0
:::
</p>
<p>0
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>(B.15a)
</p>
<p>Further, we represent b in O as well, thus obtaining
</p>
<p>Œb &#141;O D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>ˇ1
ˇ2
:::
</p>
<p>ˇm
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(B.15b)
</p>
<p>Therefore, Eq. (B.1), when expressed in O, becomes
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>˛11 ˛12 � � � ˛1n
0 ˛22 � � � ˛2n
:::
</p>
<p>:::
: : :
</p>
<p>:::
</p>
<p>0 0 � � � ˛nn
0 0 � � � 0
:::
</p>
<p>:::
: : :
</p>
<p>:::
</p>
<p>0 0 � � � 0
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>x1
x2
:::
</p>
<p>xn
</p>
<p>3
</p>
<p>7
7
7
5
D
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>ˇ1
ˇ2
:::
</p>
<p>ˇn
ˇnC1
:::
</p>
<p>ˇm
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>(B.16)
</p>
<p>whence x can be computed by back-substitution. It is apparent, then, that the last
m � n equations of the foregoing system are incompatible: their left-hand sides
are zero, while their right-hand sides are not necessarily so. What the right-hand
sides of these equations represent, then, is the approximation error in orthogonal
coordinates. The error Euclidean norm is, then,</p>
<p/>
</div>
<div class="page"><p/>
<p>560 B Numerical Equation-Solving
</p>
<p>ke0k �
q
</p>
<p>ˇ2nC1 C : : :C ˇ2m (B.17)
</p>
<p>The second method discussed here is based on the application of a chain of n
reflections fHk gn1 , known as Householder reflections, to both sides of Eq. (B.1).
The purpose of these reflections is, again, to obtain a representation of matrix A
in upper-triangular form (Golub and Van Loan 1989). The algorithm proceeds as
follows: We assume that we have applied reflections H1, H2, : : :, Hk�1, in this order,
to A that have rendered it in upper-trapezoidal form, i.e.,
</p>
<p>Ai�1 � Hi�1 : : :H2H1A
</p>
<p>D
</p>
<p>2
</p>
<p>6
6
6
6
6
6
6
6
6
6
6
6
6
4
</p>
<p>a�11 a
�
12 � � � a�1;i�1 a�1i � � � a�1n
</p>
<p>0 a�22 � � � a�2;i�1 a�2i � � � a�2n
0 0 � � � a�3;i�1 a�3i � � � a�3n
:::
</p>
<p>:::
: : :
</p>
<p>:::
:::
</p>
<p>: : :
:::
</p>
<p>0 0 � � � a�i�1;i�1 a�i�1;i � � � a�i�1;n
0 0 � � � 0 a�i;i � � � a�i;n
:::
</p>
<p>:::
: : :
</p>
<p>:::
:::
</p>
<p>: : :
:::
</p>
<p>0 0 � � � 0 a�m;i � � � a�mn
</p>
<p>3
</p>
<p>7
7
7
7
7
7
7
7
7
7
7
7
7
5
</p>
<p>(B.18)
</p>
<p>The next Householder reflection, Hi , is determined so as to render the last m � i
components of the i th column of HiAi�1 equal to zero, while leaving its first i � 1
columns unchanged. We do this by setting
</p>
<p>˛i D sgn.a�i i /
q
</p>
<p>.a�i i /
2 C .a�iC1;i /2 C � � � C .a�mi /2
</p>
<p>ui D
h
</p>
<p>0 0 � � � 0 a�i i C ˛i a�iC1;i � � � a�mi
iT
</p>
<p>Hi D 1 � 2
uiu
</p>
<p>T
i
</p>
<p>kuik2
</p>
<p>where sgn.x/ is defined as C1 if x &gt; 0, as �1 if x &lt; 0, and is left undefined when
x D 0. As the reader can readily verify,
</p>
<p>1
</p>
<p>2
kuik2 D ˛i .ui /i D ˛i .a�i i C ˛i / � &#13;i
</p>
<p>and hence, the denominator appearing in the expression for Hi is calculated with
one single addition and one single multiplication. It is noteworthy that Hi , as defined
above, is the n� n counterpart of the 3� 3 pure reflection defined in Eq. (2.5). As a
matter of fact, Hi reflects vectors in m-dimensional space onto a hyperplane of unit
normal ui=kuik.</p>
<p/>
</div>
<div class="page"><p/>
<p>B Numerical Equation-Solving 561
</p>
<p>It is important to realize that
</p>
<p>(a) ˛i is defined with the sign of a�i i because &#13;i is a multiple of the i th component
of ui , which is, in turn, the sum of a�i i and ˛i , thereby guaranteeing that the
absolute value of this sum will always be greater than the absolute value of
each of its terms. If this provision were not made, then the resulting sum could
be of a negligibly small absolute value, which would thus render &#13;i a very
small positive number, thereby introducing unnecessarily an inadmissibly large
roundoff-error amplification upon dividing the product uiuTi by &#13;i ;
</p>
<p>(b) an arbitrary vector v is transformed by Hi with unusually few flops, namely,
</p>
<p>Hiv D v �
1
</p>
<p>&#13;i
.vT ui /ui
</p>
<p>Upon application of the n Householder reflections thus defined, the system at
hand becomes
</p>
<p>HAx D Hb (B.19)
</p>
<p>with H defined as
</p>
<p>H � Hn : : :H2H1 (B.20)
</p>
<p>Similar to that in equation (B.16), the matrix coefficient of x in Eq. (B.19), i.e., HA,
is in upper-triangular form. That is, we have
</p>
<p>HA D
�
</p>
<p>U
</p>
<p>Om0n
</p>
<p>�
</p>
<p>; Hb D
�
</p>
<p>bU
</p>
<p>bL
</p>
<p>�
</p>
<p>(B.21)
</p>
<p>with Om0n denoting the .m � n/ � n zero matrix, m0 � m � n, and bU and bL
being n- and m0-dimensional vectors. The unknown x can thus be calculated from
Eq. (B.19) by back-substitution.
</p>
<p>Note that the last m0 components of the left-hand side of Eq. (B.19) are zero,
while the corresponding components of the right-hand side of the same equation are
not necessarily so. This apparent contradiction can be resolved by recalling that the
overdetermined system at hand in general has no solution. The lower part of b, bL,
is then nothing but an m0-dimensional array containing the nonzero components of
the approximation error in the new coordinates. That is, the least-square error, e0, in
these coordinates takes the form
</p>
<p>e0 D
�
</p>
<p>0n
</p>
<p>bL
</p>
<p>�
</p>
<p>(B.22a)
</p>
<p>Therefore,
</p>
<p>ke0k D kbLk (B.22b)</p>
<p/>
</div>
<div class="page"><p/>
<p>562 B Numerical Equation-Solving
</p>
<p>B.2 The Underdetermined Linear Case
</p>
<p>In this section we study the solution of system (B.1) under the assumption that
m &lt; n and rank.A/ D m. Now, the system under study admits infinitely many
solutions, which allows us to impose one condition on a specific solution that we
may want to obtain. The obvious choice is a minimality condition on a norm of x.
As in the previous section, the minimization of the square of the Euclidean norm of
x leads to a linear problem, and hence, a direct solution of the problem at hand is
possible. We thus have
</p>
<p>z.x/ � 1
2
kxk22 ! min
</p>
<p>x
(B.23)
</p>
<p>subject to the constraint represented by Eq. (B.1). Since we now have a constrained
minimization problem, we proceed to its solution via Lagrange multipliers. That is,
we introduce a new objective function �.x/, defined as
</p>
<p>�.x/ � z.x/C �T .Ax � b/ ! min
x;�
</p>
<p>(B.24)
</p>
<p>subject to no constraints, with � defined as an m-dimensional vector of Lagrange
multipliers, as yet to be determined. We thus have now an unconstrained mini-
mization problem with m C n design variables, the m components of � and the n
components of x, that we group in the .mCn/-dimensional vector y � Œ xT �T &#141;T .
The normality condition of the foregoing problem can now be stated as
</p>
<p>d�
</p>
<p>dy
D 0mCn (B.25a)
</p>
<p>with 0mCn defined as the .mCn/-dimensional zero vector. The above condition can
be broken down into the two conditions below:
</p>
<p>d�
</p>
<p>dx
D 0n
</p>
<p>d�
</p>
<p>d�
D 0m
</p>
<p>with 0m and 0n defined, respectively, as them- and n-dimensional zero vectors. The
above equations thus lead to
</p>
<p>d�
</p>
<p>dx
� xC AT� D 0n (B.26)
</p>
<p>d�
</p>
<p>d�
� Ax � b D 0m (B.27)</p>
<p/>
</div>
<div class="page"><p/>
<p>B Numerical Equation-Solving 563
</p>
<p>Upon elimination of � from the above system of equations, we obtain
</p>
<p>x D AT .AAT /�1b (B.28)
</p>
<p>which is the minimum-norm solution of the proposed problem. Again, the formula
yielding the foregoing solution is deceptively simple. If we attempt the calculation
of the inverse occurring in it, we risk introducing unnecessarily an inadmissibly
ill-conditioned matrix, the product AAT . Therefore, an alternative approach to the
straightforward implementation of the above formula should be attempted, as we do
in the subsection below.
</p>
<p>B.2.1 The Numerical Solution of an Underdetermined System
</p>
<p>of Linear Equations
</p>
<p>The simplest way of solving this problem is by introducing them�m identity matrix
1, in a disguised manner, between the two factors of the left-hand side of Eq. (B.1).
To this end, we assume that we have an orthogonal m �m matrix H, so that
</p>
<p>HTH D 1 (B.29)
</p>
<p>Equation (B.1) thus becoming
</p>
<p>AHTHx D b (B.30a)
</p>
<p>which can be rewritten in the form
</p>
<p>AHT v D b (B.30b)
</p>
<p>with v defined, obviously, as
</p>
<p>v � Hx (B.30c)
</p>
<p>Now, H is chosen as the product of m Householder reflections that transforms
AT into upper-triangular form, i.e., so that
</p>
<p>HAT D
�
</p>
<p>U
</p>
<p>On0m
</p>
<p>�
</p>
<p>(B.31)
</p>
<p>with On0m defined as the n0 � m zero matrix and n0 � n � m. Moreover, U is
upper-triangular. Further, let us partition v in the form</p>
<p/>
</div>
<div class="page"><p/>
<p>564 B Numerical Equation-Solving
</p>
<p>v �
�
</p>
<p>vU
</p>
<p>vL
</p>
<p>�
</p>
<p>(B.32)
</p>
<p>Upon substitution of Eqs. (B.31) and (B.32) into Eq. (B.30b), we obtain
</p>
<p>�
</p>
<p>UT Omn0
�
�
</p>
<p>vU
</p>
<p>vL
</p>
<p>�
</p>
<p>D b
</p>
<p>where Omn0 is the m � n0 zero matrix. Hence,
</p>
<p>UT vU COmn0vL D b (B.33)
</p>
<p>whence it is apparent that vL can attain any value. Now, since v is the image of x
under an orthogonal transformation, the Euclidean norms of these two vectors are
identical, and hence,
</p>
<p>kxk2 D kvU k2 C kvLk2 (B.34)
</p>
<p>Therefore, if we want to minimize the Euclidean norm of x, the obvious choice of
vL is zero. Furthermore, from Eq. (B.33),
</p>
<p>vU D U�T b (B.35)
</p>
<p>and so,
</p>
<p>x D HT v D HT
�
</p>
<p>U�T b
0n0
</p>
<p>�
</p>
<p>(B.36)
</p>
<p>with 0n0 denoting the n0-dimensional zero vector, thereby completing the numerical
solution of the problem at hand.
</p>
<p>B.3 Nonlinear-Equation Solving: The Determined Case
</p>
<p>Definition B.3.1. A system of algebraic equations containing some that are not
linear is termed nonlinear. If the number of equations is identical to the number
of unknowns, the system is determined.
</p>
<p>Example. Find the intersection of the circle and the hyperbola depicted in Fig. B.1.
</p>
<p>Solution: The equations of the circle and the hyperbola are
</p>
<p>f1.x; y/ � x2 C y2 � 4 D 0
f2.x; y/ � x2 � y2 � 1 D 0</p>
<p/>
</div>
<div class="page"><p/>
<p>B Numerical Equation-Solving 565
</p>
<p>Fig. B.1 Intersection of a
circle and a hyperbola
</p>
<p>Table B.1 The four
intersection points of the
circle and the hyperbola
of Fig. B.1
</p>
<p>Pi xi yi
</p>
<p>1
p
5=2
</p>
<p>p
3=2
</p>
<p>2
p
5=2 �
</p>
<p>p
3=2
</p>
<p>3 �
p
5=2
</p>
<p>p
3=2
</p>
<p>4 �
p
5=2 �
</p>
<p>p
3=2
</p>
<p>The solution to a nonlinear system of equations, when one exists at all, is usually
multiple: The circle and the hyperbola of Fig. B.1 intersect at four points fPig41,
of coordinates .xi ; yi /, as displayed in Table B.1. The problem may have no real
solution, e.g., the circle and the hyperbola of Fig. B.2 do not intersect. The system of
equations from which the coordinates of the intersection points are to be computed
is given below:
</p>
<p>f1.x; y/ � x2 C y2 � 1 D 0
</p>
<p>f2.x; y/ � x2 � y2 � 16 D 0
</p>
<p>This system of equations admits no real solution!
</p>
<p>In general, a determined nonlinear system of equations takes the form
</p>
<p>f.x/ D 0 (B.37)</p>
<p/>
</div>
<div class="page"><p/>
<p>566 B Numerical Equation-Solving
</p>
<p>Fig. B.2 A circle and a
hyperbola that do not
intersect
</p>
<p>where x and f are both n-dimensional vectors:
</p>
<p>x �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>x1
x2
:::
</p>
<p>xn
</p>
<p>3
</p>
<p>7
7
7
5
; f �
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>f1.x1; x2; : : : ; xn/
</p>
<p>f2.x1; x2; : : : ; xn/
:::
</p>
<p>fn.x1; x2; : : : ; xn/
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(B.38)
</p>
<p>B.3.1 The Newton&ndash;Raphson Method
</p>
<p>We outline below the method of solution of determined nonlinear systems using
the Newton&ndash;Raphson method. This is an iterative method, whereby a sequence of
approximations is obtained that, if converging, approaches the solution in a finite
number of iterations within a prescribed tolerance.
</p>
<p>A value x0 of x is given as an initial guess:
</p>
<p>x0 �
�
</p>
<p>p1 p2 : : : pn
�T
</p>
<p>and f is evaluated at x0:
</p>
<p>f0 � f.x0/
</p>
<p>If the value x0 was chosen randomly, most likely it will not verify the given system
of equations, i.e.,
</p>
<p>f0 &curren; 0n</p>
<p/>
</div>
<div class="page"><p/>
<p>B Numerical Equation-Solving 567
</p>
<p>Next, we look for a &ldquo;small&rdquo; increment &#129;x of x (the increment is small if its norm&mdash;
any norm&mdash;is small):
</p>
<p>&#129;x �
�
</p>
<p>&#129;x1 &#129;x2 : : : &#129;xn
�T
</p>
<p>Now, f.x0C&#129;x/ is evaluated up to its linear approximation (all quadratic and higher-
order terms are dropped from its series expansion):
</p>
<p>f.x0 C&#129;x/ � f.x0/C @f
@x
</p>
<p>ˇ
ˇ
xDx0&#129;x (B.39)
</p>
<p>The Jacobian matrix of f with respect to x is defined as the matrix of partial
derivatives of the components of f with respect to all the components of x:
</p>
<p>F � @f
@x
D
</p>
<p>2
</p>
<p>6
6
6
4
</p>
<p>@f1=@x1 @f1=@x2 � � � @f1=@xn
@f2=@x1 @f2=@x2 � � � @f2=@xn
</p>
<p>:::
:::
</p>
<p>: : :
:::
</p>
<p>@fn=@x1 @fn=@x2 � � � @fn=@xn
</p>
<p>3
</p>
<p>7
7
7
5
</p>
<p>(B.40)
</p>
<p>In the next step, we find &#129;x that renders zero the linear approximation of f.x0 C
&#129;x/:
</p>
<p>f0 C F.x0/&#129;x D 0
</p>
<p>or
</p>
<p>F.x0/&#129;x D �f0 (B.41)
</p>
<p>whence &#129;x can be found using, for example, Gaussian elimination:
</p>
<p>&#129;x D �F�10 f0; F0 � F.x0/ (B.42)
</p>
<p>Next, x is updated:
</p>
<p>x  x0 C&#129;x (B.43)
</p>
<p>the procedure stopping when
</p>
<p>k&#129;xk � �x (B.44)
</p>
<p>for a prescribed tolerance �x .</p>
<p/>
</div>
<div class="page"><p/>
<p>568 B Numerical Equation-Solving
</p>
<p>Remarks.
</p>
<p>&bull; Use the maximum norm to test convergence in Eq. (B.44), for it costs virtually
nothing;
</p>
<p>&bull; no guarantee that the Newton&ndash;Raphson method will converge at all;
&bull; whether the Newton&ndash;Raphson method converges is dependent upon the initial
</p>
<p>guess, x0;
&bull; the boundary between regions of convergence and divergence is a fractal
</p>
<p>(Mandelbrot 1983; Gleick 1988);
&bull; when the Newton&ndash;Raphson method converges, it does so quadratically: At every
</p>
<p>iteration, two decimal places of accuracy are gained (Dahlquist and Bj&ouml;rck 1974).
</p>
<p>B.4 Overdetermined Nonlinear Systems of Equations
</p>
<p>A system of nonlinear equations of the form
</p>
<p>f.x/ D 0 (B.45)
</p>
<p>where x is a n-dimensional vector and f is a q-dimensional vector, is overdetermined
if q &gt; n. Just as in the linear case, in general, no vector x can be found that verifies
all the q scalar equations of the system. However, approximations can be found that
minimize the least-square error of the approximation, as described in the balance of
this Section. The method of solution adopted here is the overdetermined counterpart
of the Newton&ndash;Raphson method.
</p>
<p>B.4.1 The Newton&ndash;Gauss Method
</p>
<p>Problem. Find an approximate solution to system (B.45) that verifies those equa-
tions with the least-square error:
</p>
<p>F.x/ D 1
2
</p>
<p>fTWf ! min
x
</p>
<p>(B.46)
</p>
<p>where W is a q � q positive-definite weighting matrix.
Solution: We follow a procedure similar to Newton&ndash;Raphson&rsquo;s, which is known
as the Newton&ndash;Gauss method, as described below:
</p>
<p>First, an initial guess x0 of x is given; then, we produce the sequence
</p>
<p>x1; x2; : : : ; (B.47)
</p>
<p>such that
</p>
<p>xkC1 D xk C&#129;xk (B.48)</p>
<p/>
</div>
<div class="page"><p/>
<p>B Numerical Equation-Solving 569
</p>
<p>Calculation of &#129;xk :
</p>
<p>&bull; Factor W into its two Cholesky factors:
</p>
<p>W D VTV (B.49)
</p>
<p>which is possible because W is assumed positive-definite.
&bull; Compute &#129;xk as the least-square solution of the unconstrained overdetermined
</p>
<p>linear system
</p>
<p>VF.xk/&#129;xk D �Vf.&#129;xk/ (B.50)
</p>
<p>with F.x/ defined as the q � n Jacobian matrix of the vector function f.x/, i.e.,
</p>
<p>F.x/ D @f.x/
@x
</p>
<p>(B.51)
</p>
<p>Dropping superscripts for the sake of notation-simplicity and recalling Eqs. (B.7)
and (B.8),
</p>
<p>&#129;x D �.FTWF/�1FTWf (B.52)
</p>
<p>This procedure is iterative, stopping when a convergence criterion, discussed in
Sect. B.4.2, is met.
</p>
<p>B.4.2 Convergence Criterion
</p>
<p>Calculate first rF.x/:
</p>
<p>rF.x/ � @F
@x
D
�
@f
</p>
<p>@x
</p>
<p>�T
@F
</p>
<p>@f
(B.53)
</p>
<p>@f
</p>
<p>@x
� F; @F
</p>
<p>@f
DWf (B.54)
</p>
<p>Hence, the condition for a stationary point is
</p>
<p>FTWf D 0 (B.55)
</p>
<p>which is the normality condition of Problem (B.46).
It is thus apparent that, at a stationary point of F , f.x/ need not vanish; however,
</p>
<p>f.x/ must lie in the null space of FTW. Moreover, from Eqs. (B.52) and (B.55)
follows that, at a stationary point, &#129;x vanishes. Hence, the convergence criterion is</p>
<p/>
</div>
<div class="page"><p/>
<p>570 B Numerical Equation-Solving
</p>
<p>k&#129;xk &lt; � (B.56)
</p>
<p>where � is a prescribed tolerance.
</p>
<p>Remarks.
</p>
<p>&bull; The normality condition (B.55) alone does not guarantee a minimum, but only a
stationary point.
</p>
<p>&bull; However, as it turns out, if the procedure converges, then it does so, to a second-
order approximation, to a minimum, and neither to a maximum nor a to saddle
point, as we prove below.
</p>
<p>The sequence F.x0/, F.x1/, . . . , F.xk/, F.xkC1/, . . . , obtained from the sequence
of x values, evolves, to a first order, as &#129;F.x/, given by
</p>
<p>&#129;F D
�
@F
</p>
<p>@x
</p>
<p>�T
</p>
<p>&#129;x (B.57)
</p>
<p>i.e.,
</p>
<p>&#129;F D fTWF&#129;x (B.58)
</p>
<p>Upon plugging expression (B.52) of &#129;x into eq. (B.58), we obtain
</p>
<p>&#129;f D �fT WF.FTWF/�1FTW
&bdquo; ƒ&sbquo; &hellip;
</p>
<p>M
</p>
<p>f D �fTMf (B.59)
</p>
<p>where, apparently, M is a q � q positive-definite matrix. As a consequence, fTMf
becomes a positive-definite quadratic expression of f; hence, &#129;F is negative defi-
nite. Thus, the second-order approximation of F.x/ is negative-definite, and hence,
the sequence of F values decreases monotonically. That is, in the neighbourhood of
a stationary point the first-order approximation of f.x/ is good enough, and hence,
if the procedure converges, it does so to a minimum.
</p>
<p>The reader may wonder whether the Newton&ndash;Raphson method can be used
to solve nonlinear least-square problems. Although the answer is yes, the
Newton&ndash;Raphson method is not advisible in this case, as made apparent below.
</p>
<p>Recall rF from Eqs. (B.46) and (B.47):
</p>
<p>rF.x/ D @F
@x
D FT .x/
&bdquo;ƒ&sbquo;&hellip;
</p>
<p>n�q
</p>
<p>W
&bdquo;ƒ&sbquo;&hellip;
</p>
<p>q�q
f.x/
&bdquo;ƒ&sbquo;&hellip;
</p>
<p>q�dim
</p>
<p>rF.x/ D 0 ) FT .x/Wf.x/
&bdquo; ƒ&sbquo; &hellip;
</p>
<p>� .x/2Rn
</p>
<p>D 0 .NC/</p>
<p/>
</div>
<div class="page"><p/>
<p>B Numerical Equation-Solving 571
</p>
<p>thereby obtaining a determined system of n equations in n unknowns. This system
can be solved using Newton&ndash;Raphson method which requires r .x/:
</p>
<p>r .x/ D @ 
@x
D @
@x
ŒFT .x/
&bdquo;ƒ&sbquo;&hellip;
</p>
<p>.@f=@x/T
</p>
<p>Wf.x/&#141;
</p>
<p>That is, r .x/ involves second-order derivatives of  with respect to x:
</p>
<p>@2fi
</p>
<p>@xj @xi
; i D 1; : : : ; n
</p>
<p>In summary, the Newton&ndash;Raphson method is too cumbersome and prone to
ill-conditioning, for it is based on the normality conditions of the problem at hand.</p>
<p/>
</div>
<div class="page"><p/>
<p>References
</p>
<p>Al-Widyan, K. and Angeles, J., 2004, &ldquo;The robust design of Sch&ouml;nflies-motion generators,&rdquo; in
Lenarčič, J., and Galletti, C. (editors), On Advances in Robot Kinematics, Kluwer Academic
Publishers, Dordrecht, pp. 339&ndash;350
</p>
<p>Albala, H., 1982, &ldquo;Displacement analysis of the N -bar, single-loop, spatial linkage. Part I:
Underlying mathematics and useful tables&rdquo;, and &ldquo;Part II: Basic displacement equations in matrix
and algebraic form&rdquo;, ASME J. Mechanical Design 104, pp. 504&ndash;519, 520&ndash;525.
</p>
<p>Alizade, R.A., Duffy, J., and Hajiyev, E.T., 1983, &ldquo;Mathematical models for analysis and synthesis
of spatial mechanism. Part IV: Seven-link spatial mechanisms&rdquo;, Mechanism and Machine
Theory 18, no. 5, pp. 323&ndash;328.
</p>
<p>Allen, P.K., Michelman, P., and Roberts, K.S., 1989, &ldquo;An integrated system for dextrous manipu-
lation&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation, Scottsdale, pp. 612&ndash;617.
</p>
<p>Altmann, S.L., 1989, &ldquo;Hamilton, Rodrigues, and the quaternion scandal. What went wrong
with mathematical discoveries in the nineteenth century&rdquo;, Mathematics Magazine 62, no. 5,
pp. 291&ndash;308.
</p>
<p>Angeles, J., 1982, Spatial Kinematic Chains. Analysis, Synthesis, Optimization, Springer-Verlag,
Berlin.
</p>
<p>Angeles, J., 1985, &ldquo;On the numerical solution of the inverse kinematic problem&rdquo;, The Int.
J. Robotics Res. 4, no. 2, pp. 21&ndash;37.
</p>
<p>Angeles, J., 1988, Rational Kinematics, Springer-Verlag, New York.
Angeles, J., 1994, &ldquo;On twist and wrench generators and annihilators&rdquo;, in Seabra Pereira, M.F.O.,
</p>
<p>and Ambr&oacute;sio, J.A.C. (editors), Computer-Aided Analysis of Rigid and Flexible Mechanical
Systems, Kluwer Academic Publishers, Dordrecht.
</p>
<p>Angeles, J., 1998, &ldquo;The Application of Dual Algebra to Kinematic Analysis,&rdquo; in Angeles,
J. and Zakhariev, E. (editors), Computational Methods in Mechanical Systems, Springer-Verlag,
Heidelberg, Vol. 161, pp. 3&ndash;31.
</p>
<p>Angeles, J., 2005, &ldquo;The degree of freedom of parallel robots: a group-theoretic approach,&rdquo; Proc.
IEEE International Conference on Robotics &amp; Automation, Barcelona, Spain, April 18&ndash;22,
pp. 1017&ndash;1024.
</p>
<p>Angeles, J. and Etemadi Zanganeh, K., 1992, &ldquo;The semigraphical solution of the direct kinematics
of general platform manipulators,&rdquo; Proc. ISRAM &rsquo;92. Fourth International Symposium on
Robotics and Manufacturing, Nov. 11&ndash;13, Santa Fe, Vol. 4, pp. 5&ndash;52.
</p>
<p>Angeles, J. and Etemadi Zanganeh, K., 1992a, &ldquo;The semigraphical determination of all inverse
kinematic solutions of general six-revolute manipulators&rdquo;, Proc. 9th CISM-IFToMM Symp.on
Theory and Practice of Robots and Manipulators, Sept. 1&ndash;4, Udine, pp. 23&ndash;32.
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>573</p>
<p/>
</div>
<div class="page"><p/>
<p>574 References
</p>
<p>Angeles, J. and Etemadi Zanganeh, K., 1992b, &ldquo;The semigraphical solutions of the direct kine-
matics of general platform manipulators&rdquo;, Proc. 4th Int. Symp. Robotics and Manufacturing,
Nov. 11&ndash;13, Santa Fe, vol. 4, pp. 45&ndash;52.
</p>
<p>Angeles, J., Hommel, G., and Kov&aacute;cs, P., 1993, Computational Kinematics, Kluwer Academic
Publishers, Dordrecht.
</p>
<p>Angeles, J. and Lee, S., 1988, &ldquo;The formulation of dynamical equations of holonomic mechanical
systems using a natural orthogonal complement&rdquo;, ASME J. Applied Mechanics 55, pp. 243&ndash;244.
</p>
<p>Angeles, J. and Ma, O., 1988, &ldquo;Dynamic simulation of n-axis serial robotic manipulators using a
natural orthogonal complement&rdquo;, The Int. J. Robotics Res. 7, no. 5, pp. 32&ndash;47.
</p>
<p>Angeles, J., Ma, O., and Rojas, A.A., 1989, &ldquo;An algorithm for the inverse dynamics of n-axis
general manipulators using Kane&rsquo;s formulation of dynamical equations&rdquo;, Computers and
Mathematics with Applications 17, no. 12, pp. 1545&ndash;1561.
</p>
<p>Angeles, J., Morozov, A., and Navarro, O., 2000, &ldquo;A novel manipulator architecture for the pro-
duction of SCARA motions&rdquo;, Proc. IEEE Int. Conf. Robotics and Automation, San Francisco,
pp. 2370&ndash;2375. CD-ROM 00CH37065C, April 24&ndash;28.
</p>
<p>Angeles, J., Rojas, A.A., and L&oacute;pez-Caj&uacute;n, C.S., 1988, &ldquo;Trajectory planning in robotics
continuous-path applications&rdquo;, IEEE J. Robotics &amp; Automation RA-4, pp. 380&ndash;385.
</p>
<p>Angeles, J., Soucy, G. and Ferrie, F., 2000, &ldquo;The online solution of the hand-eye problem,&rdquo; IEEE
Transactions on Robotics and Automation, Vol. 16, No. 6, pp. 720&ndash;731.
</p>
<p>Azimi, A., Holz, D., K&ouml;vecses, J., Angeles, J. and Teichmann, M., 2012, &ldquo;Efficient dynamics
modeling for rover simulation on soft terrain,&rdquo; Proc. 50th AIAA Aerospace Sciences Meeting,
9&ndash;12 January, Nashville, TN. Paper No. 084, pp. 1&ndash;9.
</p>
<p>Balafoutis, C.A. and Patel, R.V., 1991, Dynamic Analysis of Robot Manipulators: A Cartesian
Tensor Approach, Kluwer Academic Publishers, Dordrecht.
</p>
<p>Bondy, M., Krishnasamy, R. Crymble, D. and Jasiobedzki, P., 2007, &ldquo;Space vision marker system
(SVMS),&rdquo; AIAA SPACE 2007 Conference &amp; Exposition, September 18&ndash;20, Long Beach, CA.
</p>
<p>Borenstein, J., 1993, &ldquo;Multi-layered control of a four-degree-of-freedom mobile robot with
compliant linkage&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation, Atlanta, pp. 7&ndash;12.
</p>
<p>Bottema, O. and Roth, B., 1979, Theoretical Kinematics, North-Holland Publishing, Co., Amster-
dam (also available as a 1990 Dover Publications book).
</p>
<p>Brand, L., 1965, Advanced Calculus, John Wiley &amp; Sons, New York.
Bricard, R., 1927, Le&ccedil;ons de Cin&eacute;matique, Gauthier-Villars, Paris.
Bryson, Jr., A.E. and Ho, Y-C., 1975, Applied Optimal Control: Optimization, Estimation, and
</p>
<p>Control, Hemisphere Publishing Corporation, Washington, DC.
Burdick, J.W., 1995, &ldquo;A classification of 3R regional manipulator singularities and geometries&rdquo;,
</p>
<p>Mechanism and Machine Theory 30, no. 1, pp. 71&ndash;89.
Ceccarelli, M., 1995, &ldquo;Screw axis defined by Giulio Mozzi in 1763&rdquo;, Proc. Ninth World
</p>
<p>Congress on the Theory of Machines and Mechanisms, August 29&ndash;September 2, Milan, vol. 4,
pp. 3187&ndash;3190.
</p>
<p>Ceccarelli, M., 1996, &ldquo;A formulation for the workspace boundary of general n-revolute manipula-
tors&rdquo;, Mechanism and Machine Theory 31, no. 5, pp. 637&ndash;646.
</p>
<p>Charentus, S. and Renaud, M., 1989, Calcul du mod&egrave;le g&eacute;ometrique directe de la plate-forme
de Stewart, LAAS Report # 89260, Laboratoire d&rsquo;Automatique et d&rsquo;Analyse de Syst&egrave;mes,
Toulouse.
</p>
<p>Chasles, M., 1830, &ldquo;Notes sur les propri&eacute;t&eacute;s g&eacute;n&eacute;rales de deux corps semblables entr&rsquo;eux et plac&eacute;s
d&rsquo;une mani&egrave;re quelconque dans l&rsquo;espace, et sur le d&eacute;placement fini ou infiniment petit d&rsquo;un
corps solide libre&rdquo;, Bull. Sci. Math. Ferrusaac 14, pp. 321&ndash;326.
</p>
<p>Cheng, H. and Gupta, K.C., 1989, &ldquo;An historical note on finite rotations&rdquo;, ASME J. Applied
Mechanics 56, pp. 139&ndash;142.
</p>
<p>Chiang, C.H., 1988, Kinematics of Spherical Mechanisms, Cambridge University Press,
Cambridge.
</p>
<p>Chou, K.C.J. and Kamel, M., 1988, &ldquo;Quaternions approach to solve the kinematic equation of
rotation, AaAx D AxAb , of a sensor-mounted robotic manipulator&rdquo;, Proc. IEEE Int. Conf. on
Robotics &amp; Automation, Philadelphia, pp. 656&ndash;662.</p>
<p/>
</div>
<div class="page"><p/>
<p>References 575
</p>
<p>Chou, K.C.J. and Kamel, M., 1991, &ldquo;Finding the position and orientation of a sensor on a robot
manipulator using quaternions&rdquo;, The Int. J. Robotics Res. 10, no. 3, pp. 240&ndash;254.
</p>
<p>Clavel, R., 1988, &ldquo;Delta, a fast robot with parallel geometry&rdquo;, Proc. 18th Int. Symposium on
Industrial Robots, Lausanne, pp. 91&ndash;100.
</p>
<p>Comerford, R., 1994, &ldquo;Mecha. . . what?&rdquo;, IEEE Spectrum, August, pp. 46&ndash;49.
Company, O., Pierrot, F., Shibukawa, T., and Morita, K., 2001, &ldquo;Four-degree-of-freedom parallel
</p>
<p>robot,&rdquo; European Patent No. EP1084802, March 21.
Coriolis, G.G., 1835. &ldquo;M&eacute;moire sur les &eacute;quations du mouvement relatif des syst&egrave;mes des corps&rdquo;,
</p>
<p>J.Ecole Polytechnique 15, cahier 24, pp. 142&ndash;154.
Craig, J.J., 1989, Introduction to Robotics: Mechanics and Control, 2nd Edition, Addison-Wesley
</p>
<p>Publishing Company, Reading, MA.
CRC Standard Mathematical Tables, 1987, 28th Edition, CRC Press, Boca Raton, Fla.
Currie, I.G., 1993, Fundamental Mechanics of Fluids, 2nd Edition, McGraw-Hill Book Company,
</p>
<p>New York.
Dahlquist, G. and Bj&ouml;rck, &Aring;., 1974, Numerical Methods, Prentice-Hall, Englewood Cliffs, NJ.
Daniilidis, K., 1999, &ldquo;Hand-Eye Calibration Using Dual Quaternions&rdquo;, The Int. J. Robotics Res.
</p>
<p>18, no. 3, pp. 286&ndash;298.
Darcovich, J., Angeles, J., Montagnier, P., and Wu, C.-J., 1999, &ldquo;RVS: A Robot Visualization
</p>
<p>Software Package&rdquo;, in Batoz, J.-L., Chedmail, P., Cognet, G., and Fortin, C. (editors), Inte-
grated Design and Manufacturing in Mechanical Engineering, Kluwer Academic Publishers,
Dordrecht, pp. 265&ndash;272.
</p>
<p>De Luca, A. and Oriolo, G., 1995, &ldquo;Modelling and control of nonholonomic mechanical systems&rdquo;,
in Angeles, J. and Kecskem&eacute;thy, A. (editors), Kinematics and Dynamics of Multi-Body Systems,
Springer-Verlag, New York, pp. 277&ndash;342.
</p>
<p>Denavit, J. and Hartenberg, R.S., 1955, &ldquo;A kinematic notation for lower-pair mechanisms based on
matrices&rdquo;, ASME J. Applied Mechanics 22, pp. 215&ndash;221.
</p>
<p>Dierckx, P., 1993, Curve and Surface Fitting with Splines, Clarendon Press, Oxford.
Dietmaier, P., 1998, &ldquo;The Stewart-Gough platform of general geometry can have 40 real postures&rdquo;,
</p>
<p>Proc. Sixth International Workshop on Advances in Robot Kinematics, Kluwer Academic
Publishers, Dordrecht, pp. 7&ndash;16.
</p>
<p>Duffy, J., 1980, Analysis of Mechanisms and Robot Manipulators, Edward Arnold, London.
Duffy, J. and Crane, C., 1980, &ldquo;A displacement analysis of the general spatial 7-link, 7R
</p>
<p>mechanism&rdquo;, Mechanism and Machine Theory 15, no. 3, pp. 153&ndash;169.
Duffy, J. and Derby, S., 1979, &ldquo;Displacement analysis of a spatial 7R mechanism&mdash;A generalized
</p>
<p>lobster&rsquo;s arm&rdquo;, ASME J. Mechanical Design 101, pp. 224&ndash;231.
Ekvall, S. and Krajić, D., 2005, &ldquo;Grasp Recognition for Programming by Demonstration,&rdquo; Proc.
</p>
<p>2005 IEEE International Conference on Robotics and Automation, Barcelona, Spain, April
18&ndash;22, pp. 760&ndash;765.
</p>
<p>Etter, D.M., 1997, Engineering Problem Solving with Matlab, Prentice-Hall, Upper Saddle River,
NJ.
</p>
<p>Euler, L., 1776, &ldquo;Nova methodus motum corporum rigidorum determinandi&rdquo;, Novii Comentarii
Academi&aelig; Scientiarum Petropolitan&aelig;, vol. 20 (1775) 1776, pp. 208&ndash;238 = Opera Omnia
Vols. 2&ndash;9, pp. 99&ndash;125.
</p>
<p>Everett, J.D., 1875, &ldquo;On a new method in statics and kinematics&rdquo;, Messenger of Mathematics 45,
pp. 36&ndash;37.
</p>
<p>Featherstone, R., 1983, &ldquo;Position and velocity transformations between robot end-effector coordi-
nates and joint angles&rdquo;, The Int. J. Robotics Res. 2, no. 2, pp. 35&ndash;45.
</p>
<p>Featherstone, R., 1987, Robot Dynamics Algorithms, Kluwer Academic Publishers, Dordrecht.
Foley, J.D. and Van Dam, A., 1982, Fundamentals of Interactive Computer Graphics, Addison-
</p>
<p>Wesley Publishing Company, Reading, MA.
Forsythe, G.E., 1970, &ldquo;Pitfalls in computation, or why a math book isn&rsquo;t enough&rdquo;, American
</p>
<p>Mathematical Monthly 27, pp. 931&ndash;956.
Ge, Q.J. and Kang, D., 1995, &ldquo;Motion interpolation with G2 composite B&eacute;zier motions&rdquo;, ASME J.
</p>
<p>Mechanical Design 117, pp. 520&ndash;525.</p>
<p/>
</div>
<div class="page"><p/>
<p>576 References
</p>
<p>Gear, C.W., 1971, Numerical Initial Value Problems in Ordinary Differential Equations, Prentice-
Hall, Englewood Cliffs, NJ.
</p>
<p>Gleick, J. 1988. Chaos: making a new science. New York, N.Y.,: Penguin.
Golub, G.H. and Van Loan, C.F., 1989, Matrix Computations, The Johns Hopkins University Press,
</p>
<p>Baltimore.
Gockel, T., Ahlmann, J., Dillmann, R., and Azad, P., 2005, &ldquo;3D vision sensing for grasp planning:
</p>
<p>A new, robust and affordable structured light approach,&rdquo; Proc. 2005 IEEE International
Conference on Robotics and Automation, Barcelona, Spain, April 18&ndash;22, pp. 2540&ndash;2545.
</p>
<p>Gogu, G., 2004, &ldquo;Fully Isotropic T3R1-type parallel manipulators,&rdquo; in Lenarčič, J. and Galletti,
C. (editors), On Advances in Robot Kinematics, Kluwer Academic Publishers, Dordrecht,
pp. 265&ndash;272.
</p>
<p>Gosselin, C.M., Sefrioui, J., and Richard, M.J., 1992, &ldquo;Solutions polynomiales au probl&egrave;me de la
cin&eacute;matique directe des manipulateurs parall&egrave;les plans &agrave; trois degr&eacute;s de libert&eacute;&rdquo;, Mechanism
and Machine Theory 27, no. 2, pp. 107&ndash;119.
</p>
<p>Gosselin, C.M., and Hadj-Messaoud, A., 1993, &ldquo;Automatic planning of smooth trajectories for
pick-and-place operations&rdquo;, ASME Journal of Mechanical Design, Vol. 115, no. 3, pp. 450&ndash;456.
</p>
<p>Gosselin, C.M., Sefrioui, J., and Richard, M.J., 1994a, &ldquo;On the direct kinematics of spherical
three-degree-of-freedom parallel manipulators with a coplanar platform&rdquo;, ASME J. Mechanical
Design 116, pp. 587&ndash;593.
</p>
<p>Gosselin, C.M., Sefrioui, J., and Richard, M.J., 1994b, &ldquo;On the direct kinematics of spherical three-
degree-of-freedom parallel manipulators of general architecture&rdquo;, ASME J. Mechanical Design
116, pp. 594&ndash;598.
</p>
<p>Gosselin, C.M., Perreault, L., and Vaillancourt, C., 1995, &ldquo;Simulation and computer-aided kine-
matic design of three-degree-of-freedom spherical parallel manipulators&rdquo;, J. Robotic Systems
12, no. 12, pp. 857&ndash;869.
</p>
<p>Gough, V.M., 1956&ndash;1957, &ldquo;Communications&rdquo;, Proc. Automobile Division of The Institution of
Mechanical Engineers, pp. 166&ndash;168. See also &ldquo;Discussion in London&rdquo;, Proc. Automobile
Division of The Institution of Mechanical Engineers, pp. 392&ndash;394.
</p>
<p>Graham, D., 1972, &ldquo;A behavioural analysis of the temporal organisation of walking movements in
the 1st instar and adult stick insect (Carausius morosus)&rdquo;, J. Comp. Physiol. 81, pp. 23&ndash;25.
</p>
<p>Halmos, P., 1974, Finite-Dimensional Vector Spaces, Springer-Verlag, New York.
Hamilton, W.R., 1844, &ldquo;On quaternions: or a new system of imaginaries in algebra&rdquo;, Phil. Mag.,
</p>
<p>3rd. ser. 25, pp. 489&ndash;495.
Hanselman, D. and Littlefield, B., 2001, Mastering MATLAB 6. A Comprehensive Tutorial and
</p>
<p>Reference, Prentice-Hall, Upper-Saddle River, NJ.
Harary, F., 1972, Graph Theory, Addison-Wesley Publishing Company, Reading, MA.
Hartenberg, R.S. and Denavit, J., 1964. Kinematic Synthesis of Linkages, McGraw-Hill Book
</p>
<p>Company, New York.
Hayward, V., 1994, &ldquo;Design of hydraulic robot shoulder based on combinatorial mechanism,&rdquo; in
</p>
<p>Yoshikawa, T., and Miyazaki, F. (eds.), Experimental Robotics 3, Lecture Notes in Control and
Information Sciences 200, Springer-Verlag, New York, pp. 297&ndash;310. The Int. J. Robotics Res.
10, no. 5, pp. 767&ndash;790.
</p>
<p>Henrici, P., 1964, Elements of Numerical Analysis, John Wiley &amp; Sons, New York.
Herv&eacute;, J.M., 1999, &ldquo;The Lie group of rigid body displacements, a fundamental tool for mechanism
</p>
<p>design,&rdquo; Mechanism and Machine Theory, Vol. 34, pp. 719&ndash;730.
Herv&eacute;, J.M. and Sparacino, F., 1992, &ldquo;Star, a new concept in robotics&rdquo;, Proc. 3rd International
</p>
<p>Workshop on Advances in Robot Kinematics, September 7&ndash;9, Ferrara, pp. 176&ndash;183.
Hillier, F.S. and Lieberman, G.J., 1995, Introduction to Mathematical Programming, McGraw-Hill,
</p>
<p>New York.
Hirose, S., Masui, T., and Kikuchi, H., 1985, &ldquo;Titan III: A quadruped walking vehicle&rdquo;, in
</p>
<p>Hanafusa, H. and Inoue, X. (editors), Robotics Research 2, MIT Press, Cambridge, MA,
pp. 325&ndash;331.</p>
<p/>
</div>
<div class="page"><p/>
<p>References 577
</p>
<p>Hines, L.L., Arabagi, V. and Sitti, M., 2011, &ldquo;Free flight simulations and pitch and roll control
experiments of a sub-gram flapping-flight micro aerial vehicle,&rdquo; 2011 IEEE Int. Conf. Robotics
and Automation, Shanghai, China, May 9&ndash;13, Paper No. 0602.
</p>
<p>Hollerbach, J.M., 1980, &ldquo;A recursive Lagrangian formulation of manipulator dynamics and a
comparative study of dynamic formulation complexity&rdquo;, IEEE Trans. Systems, Man, and
Cybernetics SMC-10, no. 11, pp. 730&ndash;736.
</p>
<p>Hollerbach, J.M. and Sahar, G., 1983, &ldquo;Wrist-partitioned inverse kinematic accelerations and
manipulator dynamics&rdquo;, The Int. J. Robotics Res. 2, no. 4, pp. 61&ndash;76.
</p>
<p>Horaud, R. and Dornaika, F., 1995, &ldquo;Hand-eye calibration&rdquo;, The Int. J. Robotics Res. 14, no. 3,
pp. 195&ndash;210.
</p>
<p>Horn, B.K.P., 1986, Robot Vision, The MIT Press, Cambridge, MA.
Hoschek, J. and Lasser, D., 1992, Grundlagen der geometrischen Datenverarbeitung, B.G.
</p>
<p>Teubner, Stuttgart.
Hughes, P.C., Sincarsin, W.G., and Carroll, K.A., 1991, &ldquo;Trussarm&mdash;a variable-geometry-truss
</p>
<p>manipulator&rdquo;, J. of Intell. Mater. Syst. and Struct. 2, pp. 148&ndash;160.
Husty, M. L., 1996, &ldquo;An algorithm for solving the direct kinematics of general Stewart-Gough
</p>
<p>platforms&rdquo;, Mechanism and Machine Theory 31, no. 4, pp. 365&ndash;380.
Husty, M.L., Pfurner, M. and Schr&ouml;cker, H.-P., 2007, &ldquo;A new and efficient algorithm for the inverse
</p>
<p>kinematics of a general 6R manipulator,&rdquo; Mechanism and Machine Theory, Vol. 42, No. 1,
pp. 66&ndash;81.
</p>
<p>Isidori, A., 1989, Nonlinear Control Systems, 2nd Edition, Springer-Verlag, Berlin.
Jacobsen, S.C., Iversen, E.K., Knutti, D.F., and Biggers, K.B., 1984, &ldquo;The Utah/MIT dextrous
</p>
<p>hand: Work in progress&rdquo;, The Int. J. Robotics Res. 3, no. 4, pp. 21&ndash;50.
Jacobsen, S.C., Iversen, E.K., Knutti, D.F., Johnson, R.T., and Biggers, K.B., 1986, &ldquo;Design of
</p>
<p>the Utah/MIT dextrous hand&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation, San Francisco,
pp. 1520&ndash;1532.
</p>
<p>Kahaner, D., Moler, C., and Nash, S., 1989, Numerical Methods and Software, Prentice-Hall,
Englewood Cliffs, NJ.
</p>
<p>Kahn, M. E. 1969. &ldquo;The near-minimum time control of open-loop articulated kinematic chains&rdquo;,
AI Memo 177, Artificial Intelligence Laboratory, Stanford University, Stanford. Also see Kahn,
M.E., and Roth, B., 1971, &ldquo;The near-minimum-time control of open-loop articulated kinematic
chains&rdquo;, ASME J. Dyn. Systs., Meas., and Control, 91, pp. 164&ndash;172.
</p>
<p>Kane, T.R., 1961, &ldquo;Dynamics of nonholonomic systems&rdquo;, ASME J. Applied Mechanics 83,
pp. 574&ndash;578.
</p>
<p>Kane, T.R. and Levinson, D.A., 1983, &ldquo;The use of Kane&rsquo;s dynamical equations in robotics&rdquo;, The
Int. J. Robotics Res. 2, no. 3, pp. 3&ndash;21.
</p>
<p>Kane, T.R., Likins, P.W., and Levinson, D.A., 1983, Spacecraft Dynamics, McGraw-Hill Book
Co., New York.
</p>
<p>Kaye, R. and Wilson, R., 1998, Linear Algebra, Oxford University Press, New York.
Khalil, W. and Dombre, E., 2002, Modeling, Identification &amp; Control of Robots, Hermes Penton
</p>
<p>Ltd., London.
Khalil, W., Kleinfinger, J.F., and Gautier, M., 1986, &ldquo;Reducing the computational burden of the
</p>
<p>dynamical models of robots&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation, , San Francisco,
pp. 525&ndash;531.
</p>
<p>Khalil, W. and Dombre, E., 2002, Modeling, Identification &amp; Control of Robots, Hermes Penton
Ltd., London.
</p>
<p>Khan, W. A. and Angeles, J., 2011, &ldquo;A novel paradigm for the qualitative synthesis of simple
kinematic chains based on complexity measures&rdquo;, ASME J. of Mechanisms and Robotics, Vol.
3, No. 3, pp. 031010-1&ndash;031010-11.
</p>
<p>Killough, S.M. and Pin, F.G., 1992, &ldquo;Design of an omnidirectional and holonomic wheeled
platform prototype&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation, , Nice, pp. 84&ndash;90.
</p>
<p>Klein, C.A., Olson, K.W., and Pugh, D.R., 1983, &ldquo;Use of force and attitude sensors for locomotion
of a legged vehicle over irregular terrain&rdquo;, The Int. J. Robotics Res. 2, no. 2, pp. 3&ndash;17.</p>
<p/>
</div>
<div class="page"><p/>
<p>578 References
</p>
<p>Kumar A.V. and Waldron K.J., 1981, &ldquo;The workspace of a mechanical manipulator&rdquo;, ASME
J. Mechanical Design 103, pp. 665&ndash;672.
</p>
<p>Latombe, J.-C., 1991, Robot Motion Planning, Kluwer Academic Publishers, Dordrecht.
Lalibert&eacute;, T., Birglen, L. and Gosselin, C., 2002, &ldquo;Underactuation in robotic grasping hands,&rdquo;
</p>
<p>Japanese J. Machine Intelligence and Robotic Control, Special Issue on Underactuated Robots,
Vol. 4, No. 3, pp. 77&ndash;87.
</p>
<p>Lazard, D. and Merlet, J.-P., 1994, &ldquo;The (true) Stewart platform has 12 configurations&rdquo;, Proc. IEEE
Int. Conf. on Robotics &amp; Automation, San Diego, pp. 2160&ndash;2165.
</p>
<p>Lee, C.C. and Lee, P.C., 2010, &ldquo;Isoconstraned mechanisms for fast pick-and-place manipulation,&rdquo;
in Lou, Y. and Li, Z. (editors), Geometric Methods in Robotics and Mechanism Research,
Lambert Academic Publishing, Saarbr&uuml;cken, Germany, pp. 85&ndash;99.
</p>
<p>Lee, H.Y. and Liang, C.G., 1988, &ldquo;Displacement analysis of the general spatial seven-link 7R
mechanism&rdquo;, Mechanism and Machine Theory 23, no. 3, pp. 219&ndash;226.
</p>
<p>Lee, H.Y. and Roth, B., 1993, &ldquo;A closed-form solution of the forward displacement analysis of
a class of in-parallel mechanisms&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation, Atlanta,
pp. 720&ndash;731.
</p>
<p>Lee, T., Leok, M. and McClamroch, N.H., 2010, &ldquo;Geometric tracking control of a quadrotor UAV
on SE(3),&rdquo; Proc. 49th IEEE Conf. Decision and Control, Dec. 15&ndash;17, Atlanta, GA.
</p>
<p>Leigh, D.C., 1968, Nonlinear Continuum Mechanics, McGraw-Hill Book Company, New York.
Levine, M.D., 1985, Vision in Man and Machines, McGraw-Hill Book Company, New York.
Li, H., 1990, Ein Verfahren zur vollst&auml;ndigen L&ouml;sung der R&uuml;ckw&auml;rtstransformation f&uuml;r Industrier-
</p>
<p>oboter mit allgemeiner Geometrie, doctoral thesis, Universit&auml;t-Gesamthochschule Duisburg,
Duisburg.
</p>
<p>Li, C.-J., 1989, &ldquo;A new Lagrangian formulation of dynamics of robot manipulators&rdquo;, ASME J. Dyn.
Systs., Meas., and Control, 111, pp. 559&ndash;567.
</p>
<p>Li, C.-J. and Sankar, 1992, &ldquo;Fast inverse dynamics computation in real-time robot control&rdquo;,
Mechanism and Machine Theory 1992, no. 27, pp. 741&ndash;750.
</p>
<p>Li, H., Woernle, C., and Hiller, M., 1991, &ldquo;A complete solution for the inverse kinematic problem
of the general 6R robot manipulator&rdquo;, ASME J. Mechanical Design 113, pp. 481&ndash;486.
</p>
<p>Liu, H., Iberall, T., and Bekey, G., 1989, &ldquo;The multi-dimensional quality of task requirements for
dextrous robot hand control&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation, Scottsdale,
pp. 452&ndash;457.
</p>
<p>Livio, M., 2005, The Equation That Couldn&rsquo;t Be Solved. How Mathematical Genius Discovered
the Language of Symmetry, Simon &amp; Schuster, New York-London-Toronto-Sydney.
</p>
<p>Lozano-P&eacute;rez, T., 1981, &ldquo;Automatic planning of manipulator transfer movements&rdquo;, IEEE Trans.
Systems, Man, and Cybernetics SMC-11, no. 110, pp. 681&ndash;689.
</p>
<p>Luh, J.Y.S., Walker, M.W., and Paul, R.P.C., 1980, &ldquo;On-line computational scheme for mechanical
manipulators&rdquo;, ASME J. Dyn. Systs., Meas., and Control, 102, pp. 69&ndash;76.
</p>
<p>Mandelbrot, B. B. 1983, The Fractal Geometry of Nature, 3rd ed., W. H. Freeman and Company,
New York.
</p>
<p>Makino, H. and Furuya, N., 1980, &ldquo;Selective compliance assembly robot arm,&rdquo; Proc. First
International Conference on Assembly Automation, Brighton (no page numbers available.)
</p>
<p>Mavroidis, C. and Roth, B., 1992, &ldquo;Structural parameters which reduce the number of manipulator
configurations&rdquo;, Proc. ASME 22nd Biennial Mechanisms Conference, September 13&ndash;16,
Scottsdale, DE-45, pp. 359&ndash;366.
</p>
<p>Menitto, G. and Buehler, M., 1996, &ldquo;CARL: A compliant articulated robotic leg for dynamic
locomotion&rdquo;, Robotics and Autonomous Systems 18, pp. 337&ndash;344.
</p>
<p>Merlet, J.-P., 1989, &ldquo;Singular Configurations of Parallel Manipulators and Grassmann Geometry&rdquo;,
The Int. J. Robotics Res. 8, no. 5, pp. 45&ndash;56.
</p>
<p>Merlet, J.-P., 2006, Parallel Robots, Second Edition, Springer, Dordrecht.
Morgan, A.P., 1987, Solving Polynomial Systems Using Continuation for Scientific and Engineer-
</p>
<p>ing Problems, Prentice-Hall, Englewood Cliffs. NJ.
Mozzi, G., 1763, Discorso Matematico Sopra il Rotamento Momentaneo dei Corpi, Stamperia di
</p>
<p>Donato Campo, Naples.</p>
<p/>
</div>
<div class="page"><p/>
<p>References 579
</p>
<p>Nanua, P., Waldron, K.J., and Murthy, V., 1990, &ldquo;Direct kinematic solution of a Stewart platform&rdquo;,
IEEE Trans. Robotics &amp; Automation 6, pp. 438&ndash;444.
</p>
<p>Ostrovskaya, S. and Angeles, J., 1998, &ldquo;Nonholonomic systems revisited within the framework of
analytical mechanics&rdquo;, Applied Mechanics Reviews, vol. 51, No. 7, pp. 415&ndash;433.
</p>
<p>Pattee, H.A., 1995, &ldquo;Selecting computer mathematics&rdquo;, Mechanical Engineering 117, no. 9,
pp. 82&ndash;84.
</p>
<p>Paul, R.P., 1981, Robot Manipulators. Mathematics, Programming, and Control, The MIT Press,
Cambridge. MA.
</p>
<p>Paul, R.P. and Stevenson, C.N., 1983, &ldquo;Kinematics of robot wrists&rdquo;, The Int. J. Robotics Res. 2,
no. 1, pp. 31&ndash;38.
</p>
<p>Penrose, R., 1994, Shadows of the Mind. A Search for the Missing Science of Consciousness,
Oxford University Press, Oxford.
</p>
<p>Pettinato, J.S. and Stephanou, H.E., 1989, &ldquo;Manipulability and stability of a tentacle based robot
manipulator&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation, , Scottsdale, pp. 458&ndash;463 .
</p>
<p>Pfeiffer, F., Eltze, J., and Weidemann, H.-J., 1995, &ldquo;The TUM walking machine&rdquo;, Intelligent
Automation and Soft Computing. An International Journal, 1, no. 3, pp. 307&ndash;323.
</p>
<p>Phillips J., 1990, Freedom in Machinery. Vol 2: Screw Theory Exemplified, Cambridge University
Press, Cambridge.
</p>
<p>Pieper, D.L., 1968, The Kinematics of Manipulators Under Computer Control, Ph.D. thesis,
Stanford University, Stanford.
</p>
<p>Pierrot, F., Fournier, A., and Dauchez, P., 1991, &ldquo;Towards a fully-parallel 6 dof robot for high-speed
applications&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation, Sacramento, pp. 1288&ndash;1293.
</p>
<p>Pottmann, H. and Wallner, J., 2001, Computational Line Geometry, Springer, Berlin-Heidelberg-
New York.
</p>
<p>Primrose, E.J.F., 1986, &ldquo;On the input-output equation of the general 7R mechanism&rdquo;, Mechanism
and Machine Theory 21, no. 6, pp. 509&ndash;510.
</p>
<p>Raghavan, M., 1993, &ldquo;The Stewart platform of general geometry has 40 configurations&rdquo;, ASME J.
Mechanical Design 115, pp. 277&ndash;282.
</p>
<p>Raghavan, M. and Roth, B., 1990, &ldquo;Kinematic analysis of the 6R manipulator of general
geometry&rdquo;, in Miura, H. and Arimoto, S. (editors), Proc. 5th Int. Symposium on Robotics
Research, MIT Press, Cambridge, MA.
</p>
<p>Raghavan, M. and Roth, B., 1993, &ldquo;Inverse kinematics of the general 6R manipulator and related
linkages&rdquo;, ASME J. Mechanical Design 115, pp. 502&ndash;508.
</p>
<p>Raibert, M.H., 1986, Legged Robots That Balance, MIT Press, Cambridge, MA.
Ranjbaran, F., Angeles, J., and Patel, R.V., 1992, &ldquo;The determination of the Cartesian workspace of
</p>
<p>general three-axes positioning manipulators&rdquo;, Proc. Third Int. Workshop on Advances in Robot
Kinematics, Sept.7&ndash;9, Ferrara, pp. 318&ndash;324.
</p>
<p>Ravani, B. and Roth, B., 1984, &ldquo;Mappings of spatial kinematics&rdquo;, ASME J. Mechanisms, Transm.,
and Auto. in Design 106, pp. 341&ndash;347.
</p>
<p>Reynaerts, D., 1995, Control Methods and Actuation Technology for Whole-Hand Dextrous Manip-
ulation, doctoral dissertation, Fakulteit der Torgepaste Wetenschappen, Katholieke Universiteit
Leuven, Leuven.
</p>
<p>Roth, B., 1984, &ldquo;Screws, motors, and wrenches that cannot be bought in a hardware store&rdquo;, in
Brady, M., and Paul, R.P. (editors), Robotics Research. The First International Symposium, The
MIT Press, Cambridge, MA, pp. 679&ndash;693.
</p>
<p>Rumbaugh, J., Blaha, M., Premerlani, W., Eddy, F., and Lorensen, W., 1991, Object-Oriented
Modeling and Design, Prentice-Hall, Englewood Cliffs, NJ.
</p>
<p>Rus, D., 1992, &ldquo;Dextrous rotations of polyhedra&rdquo;, Proc. IEEE Int. Conf. on Robotics &amp; Automation,
, Nice, pp. 2758&ndash;2763.
</p>
<p>Russell, Jr., M., 1983, &ldquo;Odex I: The first functionoid&rdquo;, Robotics Age, 5, pp. 12&ndash;18.
Saha, S.K., 1997, &ldquo;A decomposition of the manipulator inertia matrix&rdquo;, IEEE Trans. Robotics &amp;
</p>
<p>Automation 13, pp. 301&ndash;304.
Saha, S.K., 1999, &ldquo;Analytical expression for the inverted inertia matrix of serial robots&rdquo;, The Int.
</p>
<p>J. Robotics Res. 18, no. 1, pp. 116&ndash;124.</p>
<p/>
</div>
<div class="page"><p/>
<p>580 References
</p>
<p>Saha, S.K., 2008, Introduction to Robotics, The McGraw-Hill Companies, New Delhi.
Salisbury, J.K. and Craig, J.J., 1982, &ldquo;Articulated hands: Force and kinematic issues&rdquo;, The Int. J.
</p>
<p>Robotics Res. 1, no. 1, pp. 4&ndash;17.
Salmon, G., Higher Algebra, 5th Edition (1964), reprinted: 1964, Chelsea Publishing Co., New
</p>
<p>York.
Samson, C., Le Borgne, M., and Espiau, B., 1991, Robot Control. The Task Function Approach,
</p>
<p>Clarendon Press, Oxford.
Salerno, A. and Angeles, J., 2004, &ldquo;The control of semi-autonomous self-balancing two-wheeled
</p>
<p>quasiholonomic mobile robots,&rdquo; Proc. 15th CISM-IFToMM Symposium on Robot Design,
Dynamics and Control (RoManSy 2004), Montreal, Canada. June 14&ndash;18.
</p>
<p>Shampine, L.F. and Gear, C.W., 1979, &ldquo;A user&rsquo;s view of solving stiff ordinary differential
equations&rdquo;, SIAM Review 21, no. 1, pp. 1&ndash;17.
</p>
<p>Shiu, Y.C. and Ahmad, S., 1987, &ldquo;Finding the mounting position of a sensor by solving a
homogeneous transform equation of the form AX = XB&rdquo;, Proc. IEEE Int. Conf. on Robotics
&amp; Automation, Raleigh, pp. 1667&ndash;1671.
</p>
<p>Silver, W.M., 1982, &ldquo;On the equivalence of Lagrangian and Newton-Euler dynamics for manipu-
lators&rdquo;, The Int. J. Robotics Res. 1, no. 2, pp. 118&ndash;128.
</p>
<p>Song, S.-M. and Waldron, K.J., 1989, Machines That Walk, The MIT Press, Cambridge, MA.
Soureshi, R., Meckl, P.H., and Durfee, W.M., 1994, &ldquo;Teaching MEs to use microprocessors&rdquo;,
</p>
<p>Mechanical Engineering 116, no. 4, pp. 71&ndash;76.
Spong, M.W., Hutchinson, S., and Vidyasagar, M., 2006, Robot Modeling and Control, John Wiley
</p>
<p>&amp; Sons, Inc., Hoboken, NJ.
Srinivasan L.N. and Ge, Q.J., 1997, &ldquo;Fine tuning of rational B-splines motions&rdquo;, Proc. ASME
</p>
<p>Design Engineering Technical Conference DETC&rsquo;97, pp. 1&ndash;10.
Staffetti, E., Bruyninckx, H., and De Schutter, J., 2002, in Lenarcič, A.J. and Thomas, F., Advances
</p>
<p>in Robot Kinematics: Theory and Applications, Kluwer Academic Publishers, Dordrecht,
pp. 57&ndash;66.
</p>
<p>Stewart, D., 1965, &ldquo;A platform with 6 degrees of freedom&rdquo;, Proc. Institution of Mechanical
Engineers 180, part 1, no. 15, pp. 371&ndash;386.
</p>
<p>Strang, G., 1988, Linear Algebra and Its Applications, Third Edition, Harcourt Brace Jovanovich
College Publishers, New York.
</p>
<p>Stroustrup, B., 1991, The CCC Programming Language, Addison-Wesley Publishing Company,
Reading, MA.
</p>
<p>Sutherland, I.E. and Ullner, M.K., 1984, &ldquo;Footprints in the asphalt&rdquo;, The Int. J. Robotics Res. 3,
no. 2, pp. 29&ndash;36.
</p>
<p>Sun, L., Xie, H., Rong, W., and Chen, L., 2005, &ldquo;Task-reconfigurable system for MEMS assembly,&rdquo;
Proc. IEEE International Conference on Robotics and Automation, Barcelona, Spain, April
18&ndash;22, pp. 844&ndash;849.
</p>
<p>Synge, J.L., 1960, &ldquo;Classical Dynamics&rdquo;, in Fl&uuml;gge, S. (editor), Encyclopedia of Physics, vol. III/1,
Springer-Verlag, Berlin, pp. 1&ndash;225.
</p>
<p>Takano, M., 1985, &ldquo;A new effective solution for inverse kinematics problem (synthesis) of a robot
with any type of configuration&rdquo;, Journal of the Faculty of Engineering, The University of Tokyo
38, no. 2, pp. 107&ndash;135.
</p>
<p>Tandirci, M., Angeles J., and Ranjbaran, F., 1992, &ldquo;The characteristic point and the characteristic
length of robotic manipulators&rdquo;, ASME 22nd Biennial Mechanisms Conference, September
13&ndash;16, Scottsdale, vol. 45, pp. 203&ndash;208.
</p>
<p>Tandirci, M., Angeles, J., and Darcovich, J., 1994, &ldquo;On rotation representations in computational
robot kinematics&rdquo;, J. Intelligent and Robotic Systems 9, pp. 5&ndash;23.
</p>
<p>Teichmann, M., 1995, Grasping and Fixturing: A Geometric Study and Implementation, Ph.D.
thesis, Department of Computer Science, New York University, New York.
</p>
<p>Thompson, S.E. and Patel, R.V., 1987, &ldquo;Formulation of joint trajectories for industrial robots using
B-splines&rdquo;, IEEE Trans. Industrial Electronics IE-34, pp. 192&ndash;199.</p>
<p/>
</div>
<div class="page"><p/>
<p>References 581
</p>
<p>Thorne, C.E. and Yim, M., 2011, &ldquo;Towards the development of gyroscopically controlled micro air
vehicles,&rdquo; 2011 IEEE Int. Conf. Robotics and Automation, Shanghai, China, May 9&ndash;13, Paper
No. 1800.
</p>
<p>Todd, D.J., 1985, Walking Machines. An Introduction to Legged Robots, Kogan Page Ltd., London.
T&ouml;r&ouml;k, J.S., 2000, Analytical Mechanics with an Introduction to Dynamical Systems, John Wiley
</p>
<p>&amp; sons, Inc., New York.
Tsai, L.W. and Morgan, A.P., 1985, &ldquo;Solving the kinematics of the most general six- and five-
</p>
<p>degree-of-freedom manipulators by continuation methods&rdquo;, ASME J. Mechanisms, Transm., and
Auto. in Design 107, pp. 189&ndash;200.
</p>
<p>Uicker, Jr., J.J., 1965. On the Dynamic Analysis of Spatial Linkages Using 4 � 4 Matrices, Ph.D.
thesis, Northwestern University, Evanston.
</p>
<p>Van Brussel, H., Santoso, B., and Reynaerts, D., 1989, &ldquo;Design and control of a multi-fingered
robot hand provided with tactile feedback&rdquo;, Proc. NASA Conf. Space Telerobotics, Pasadena,
Jan.31&ndash;Feb.2, vol. III, pp. 89&ndash;101.
</p>
<p>Vijaykumar, R., Tsai, M.J., and Waldron, K.J., 1986, &ldquo;Geometric optimization of serial chain
manipulator structures for working volume and dexterity&rdquo;, The Int. J. Robotics Res. 5, no. 2,
pp. 91&ndash;103.
</p>
<p>Vinogradov I.B., Kobrinski A.E., Stepanenko, Y.E., and Tives, L.T., 1971, &ldquo;Details of kinematics
of manipulators with the method of volumes&rdquo; (in Russian), Mekhanika Mashin, no. 27&ndash;28,
pp. 5&ndash;16.
</p>
<p>von Mises, R., 1924, &ldquo;Motorrechnung, ein neues Hilfsmittel der Mechanik&rdquo;, Z. Angewandte
Mathematik und Mechanik 4, no. 2, pp. 155&ndash;181.
</p>
<p>von Mises, R., 1996, &ldquo;Motor calculus. A new theoretical device for mechanics&rdquo;, translated from
the German by J. E. Baker and K. Wohlhart, Institute for Mechanics, Technical University of
Graz, Graz.
</p>
<p>Vukobratovic, M. and Stepanenko, J., 1972, &ldquo;On the stability of anthropomorphic systems&rdquo;, Math.
Biosci. 15, pp. 1&ndash;37.
</p>
<p>W&auml;lischmiller, W. and Li, H., 1996, &ldquo;Development and application of the TELBOT System&ndash;A new
Tele Robot System&rdquo;, Proc. 11th CISM&ndash;IFToMM Symposium on Theory and Practice of Robots
and Manipulators&ndash;Ro.Man.Sy. 11, Udine (Italy), July 1&ndash;4.
</p>
<p>Walker, M.W. and Orin, D.E., 1982, &ldquo;Efficient dynamic computer simulation of robotic mecha-
nisms&rdquo;, ASME J. Dyn. Systs., Meas., and Control, 104, pp. 205&ndash;211.
</p>
<p>Wampler, C., 1996, &ldquo;Forward displacement analysis of general six-in-parallel SPS (Stewart)
platform manipulators using soma coordinates&rdquo;, Mechanism and Machine Theory 31, no. 3,
pp. 331&ndash;337.
</p>
<p>Wells, D., 1986, The Penguin Dictionary of Curious and Interesting Numbers, Penguin Books,
Middlesex, England.
</p>
<p>Wen, L., Wang, T., Wu, G. and Li, J., 2011, &ldquo;A novel method based on a force-feedback technique
for the hydrodynamic investigation of kinematic effects on robotic fish,&rdquo; 2011 IEEE Int. Conf.
Robotics and Automation, Shanghai, China, May 9&ndash;13, Paper No. 0828.
</p>
<p>West, M. and Asada, H., 1995, &ldquo;Design and control of ball wheel omnidirectional vehicles&rdquo;, Proc.
IEEE Int. Conf. on Robotics &amp; Automation, Nagoya, pp. 1931&ndash;1938.
</p>
<p>Whitney, D.E., 1972, &ldquo;The mathematics of coordinated control of prosthetic arms and manipula-
tors&rdquo;, ASME J. Dyn. Systs., Meas., and Control, 94, pp. 303&ndash;309.
</p>
<p>Williams, O., Angeles, J., and Bulca, F., 1993, &ldquo;Design philosophy of an isotropic six-axis serial
manipulator&rdquo;, Robotics and Computer-Aided Manufacturing 10, no. 4, pp. 275&ndash;286.
</p>
<p>Yang, D.C. and Lai, Z.C., 1985, &ldquo;On the conditioning of robotic manipulators&mdash;service angle&rdquo;,
ASME J. Mechanisms, Transm., and Auto. in Design 107, pp. 262&ndash;270.
</p>
<p>Yang, L., Hou, X.R., and Zeng, Z.B., 1996, &ldquo;A complete discrimination system for polynomial,&rdquo;
Mathematic Mechanization Preprints, No. 14, pp. 98&ndash;115.
</p>
<p>Yoshikawa, T., 1985, &ldquo;Manipulability of robotic mechanisms&rdquo;, The Int. J. Robotics Res. 4, no. 2,
pp. 3&ndash;9.</p>
<p/>
</div>
<div class="page"><p/>
<p>Index
</p>
<p>A
</p>
<p>ABB-IRB 1000 robot, 180, 251
acatastatic systems, 508
acceleration analysis
</p>
<p>of parallel manipulators, 438
of rigid bodies, 117
of serial manipulators, 206
</p>
<p>affine transformation, 28, 66
Agile Eye, 12
AI, see artificial intelligence
algorithm definition, 25
angle of rotation, 41
angular acceleration
</p>
<p>computation, 362
invariant-rate relations, 118
matrix, 117
vector, 117
</p>
<p>angular velocity
dyad, 130, 283
invariant-rate relations, 115, 548&ndash;551
matrix, 109
vector, 109
</p>
<p>Appendix A, 547
Appendix B, 555
arc-welding, 466
</p>
<p>operation, 479
path-tracking, 498
</p>
<p>architecture of a
kinematic chain, 141
manipulator, 139
</p>
<p>articulated-body method, 317
artificial intelligence, 5, 24
axial component of a vector, 31
axial vector of a 3 � 3 matrix,
</p>
<p>45
</p>
<p>B
</p>
<p>base frame, 151
basis of a vector space, 31
Bezout&rsquo;s method, 433
bivariate-equation approach, 377, 390, 401
</p>
<p>C
</p>
<p>C, 25
CCC, 25
Canadarm, see Canadarm2
Canadarm2, 5, 6
canonical form of a rotation, 43
Carausius morosus, 17, 576
Cartesian coordinates
</p>
<p>of a manipulator, 139
also, see Cartesian variables
</p>
<p>Cartesian decomposition, 44
Cartesian variables
</p>
<p>of a manipulator, 150
caster wheel, 451, 524
catastatic system, 508
Cayley&rsquo;s Theorem, 87
Cayley&ndash;Hamilton theorem, 36
center
</p>
<p>of mass, 126
centroidal
</p>
<p>moment of inertia, 131
change of basis, 70
characteristic equation, 33, 36
</p>
<p>of a manipulator, 158, 401
characteristic length, 227, 233, 238
characteristic polynomial, 33
</p>
<p>of a manipulator, 204, 376, 398, 401, 424,
434
</p>
<p>J. Angeles, Fundamentals of Robotic Mechanical Systems: Theory, Methods,
and Algorithms, Mechanical Engineering Series 124, DOI 10.1007/978-3-319-01851-5,
&copy; Springer International Publishing Switzerland 2014
</p>
<p>583</p>
<p/>
</div>
<div class="page"><p/>
<p>584 Index
</p>
<p>Chasles&rsquo; Theorem, see Mozzi&ndash;Chasles&rsquo;
Theorem
</p>
<p>Chebyshev norm, 228, 497
Cholesky-decomposition algorithm, 318, 338
classical mechanics, 126
closure equations, 152
compatibility conditions
</p>
<p>for acceleration, 363
for velocity, 357
</p>
<p>composite rigid-body method, 317
composition of reflections and
</p>
<p>rotations, 58
condition number, 226, 403
configuration of a manipulator, 139
constraint wrenches, 185
continuous path, 256, 376
</p>
<p>operations, 465
tracking, 492
</p>
<p>control vector, 306, 340
coordinate transformation, 60&ndash;70
Coriolis
</p>
<p>acceleration, 121
and centrifugal forces, 310, 311, 317
</p>
<p>Couette flow, 344
Coulomb
</p>
<p>dissipation function, 345
friction, 285, 344
</p>
<p>CP, see continuous path
cross-product matrix, 37
curvature, 467
</p>
<p>derivative w. r. t.
a parameter, 475
</p>
<p>derivative w. r. t. the arc length, 467
parametric representation, 473
time-derivative, 469
</p>
<p>cycloidal motion, 265
</p>
<p>D
</p>
<p>Darboux vector, 469
time-derivative, 470
</p>
<p>decoupled manipulators, 143, 151
decoupled robots, 139
Delta Robot, 13
Delta robot, 13
delta-array (&#129;-array), 462, 534
Denavit&ndash;Hartenberg
</p>
<p>frames, 141
notation, 139
parameters, 143
rotation matrix, 145
vector joining two frame origins, 145
</p>
<p>determined system, 564
dexterity, 25
</p>
<p>measures, see kinetostatic performance
indices
</p>
<p>DEXTRE, 5
dextrous hands, see multifingered hands
dextrous manipulation, 10
dextrous workspace, 222
DH, see Denavit&ndash;Hartenberg
dialytic elimination, 204, 252
DIESTRO
</p>
<p>inverse kinematics, 414
Jacobian, 249
manipulator, 239, 414
</p>
<p>differentiation with respect to
vectors, 37
</p>
<p>direct kinematic problem
of parallel manipulators, 421
</p>
<p>displacement equations of a
manipulator, 152
</p>
<p>dissipation function, 285, 344
duality, 185
dynamic systems, 1
dynamics
</p>
<p>of holonomic systems, 507
of multibody systems, 283
of parallel manipulators, 512
of rigid bodies, 125
of robotic mechanical systems, 507
of rolling robots, 523
of serial manipulators, 281
</p>
<p>E
</p>
<p>EE, see end-effector
elastodynamic, 186
end-effector, 141
Euclidean norm, 39
Euler
</p>
<p>angles, 44, 88, 94
equation (for graphs), 514
equation (in mechanics), 129
parameters, see Euler&ndash;Rodrigues
</p>
<p>parameters
Euler&rsquo;s
</p>
<p>formula for graphs, see Euler equation for
graphs
</p>
<p>theorem, 36
Euler&ndash;Lagrange equations, 282, 284
</p>
<p>derived with the NOC, 309, 510
Euler&ndash;Rodrigues parameters, 55
</p>
<p>F
</p>
<p>Fanuc Arc Mate
inverse displacement, 410</p>
<p/>
</div>
<div class="page"><p/>
<p>Index 585
</p>
<p>Fanuc Arc Mate 120iB, 181
Fanuc Robot Arc Mate
</p>
<p>characteristic length, 248
DH parameters, 248
KCI, 249
</p>
<p>feasible twists, 185
First Law of Thermodynamics, 211
flight simulator, 422
floating-point operation, 25, 209, 317, 557
flop, see floating-point operation
forward dynamics
</p>
<p>algorithm complexity, 335
of serial manipulators, 281, 317
</p>
<p>fractal, 568
Frenet, see Frenet&ndash;Serret
Frenet&ndash;Serret
</p>
<p>formulas, 467
frame, 466
vectors, 466
</p>
<p>friction forces, 343
Frobenius norm, 225
fuzzy logic, 24
</p>
<p>G
</p>
<p>genealogy of robotic mechanical systems, 1, 4
general architecture of a
</p>
<p>manipulator, 5
generalized coordinates, 284, 285, 508
generalized forces, 284, 285, 530
generalized inertia matrix, 287, 539
</p>
<p>Cholesky decomposition, 318
factoring, 319
time-rate of change, 321
</p>
<p>generalized speeds, 285, 508
Ginger, see Segway
gluing operation, 476
grasping matrix, 444
gravity
</p>
<p>terms, 342
wrench, 307
</p>
<p>H
</p>
<p>hand-eye calibration, 83
Hexa robot, 14
higher kinematic pair, 140
holonomic systems, 507, 508
homogeneous coordinates, 60
homotopy, 376
</p>
<p>I
</p>
<p>IDP, see inverse displacement problem
ilonators, 20
</p>
<p>inertia dyad, 130, 283
inertial frame, 120, 126
input, 1, 306
instant screw axis, 110
instrument calibration, 81
intelligent machines, 2, 24
intelligent robots, 2
invariance, 76
inverse displacement problem of
</p>
<p>a general 6R manipulator, 375
inverse dynamics
</p>
<p>of serial manipulators, 281
recursive, 294
</p>
<p>inverse kinematics problem of
parallel manipulators, 424
</p>
<p>inverse vs. forward dynamics, 281
inward recursions, 301, 304
ISA, see instant screw axis
isomorphism, 33
isotropic
</p>
<p>manipulator, 227
matrix, 224, 227
</p>
<p>isotropy, 230
iteration, 25, 497
</p>
<p>J
</p>
<p>Jacobian matrix, 185
condition number, 226
evaluation, 194
invertibility, 222
transfer formula, 190
</p>
<p>joint, 140
coordinates, 139, 143
parameters, 143
variables, 143
</p>
<p>K
</p>
<p>Kane&rsquo;s equations, 293
KCI, see kinematic conditioning index
kernel of a linear transformation, 29
Kinemate, 115
kinematic
</p>
<p>chain, 140
conditioning index, 225
constraints, 307
constraints for serial manipulators, 311
pair, 140
</p>
<p>kinematic chain
architecture of a , 141
</p>
<p>kinetic energy, 126
kinetostatic performance indices, 221
kinetostatics, 185</p>
<p/>
</div>
<div class="page"><p/>
<p>586 Index
</p>
<p>L
</p>
<p>least-square error, 568
least-square solution, 569
Lee vs. Li, 377
Lee&rsquo;s manipulator, 411
Lee&rsquo;s procedure, 407
left hand, 14
legged robots, 17
Li vs. Lee, see Lee vs. Li
Li&rsquo;s manipulator, see Lee&rsquo;s manipulator
linear invariants, 44
</p>
<p>of rotation, 46
linear transformations, 28
local structure of a manipulator, 143
locomotors, 17
lower kinematic pair, 140
LU decomposition, 190
</p>
<p>M
</p>
<p>machine (definitions of), 24
main gauche, see left hand
maneuverability, 461
manipulability, 222
</p>
<p>of decoupled manipulators, 254
manipulator
</p>
<p>angular velocity matrix, 286
architecture, 139
configuration, 139
dynamics, 281, 512
general architecture, 5
mass matrix, 286
posture, 139
twist, 286
wrench, 286
</p>
<p>manipulators, 8, 139
matrix
</p>
<p>norm, 225
representation, 32
</p>
<p>mechanical system, 2
mechatronics, 25
Mekanum wheels, 20
minimum-time trajectory, 310
mobile wheeled pendulums, 21
module, 36
moment
</p>
<p>of inertia, 128
moment invariants, 77
moment of a line
</p>
<p>about a point, 103
about another line, 133
</p>
<p>moment-of-inertia matrix, 128
momentum screw, 130
Motoman-EA1400N welding robot, 182
</p>
<p>motor, 115
Mozzi&ndash;Chasles&rsquo; Theorem, 97
MSS, 5
multibody system
</p>
<p>dynamics, 283
Euler&ndash;Lagrange equations, 294
</p>
<p>multicubic expression, 153
multifingered hands, 10
multilinear expression, 153
multiquadratic expression, 153
multiquartic expression, 153
</p>
<p>N
</p>
<p>natural orthogonal complement, 282
applied to holonomic systems, 510
applied to parallel manipulators, 512
applied to planar manipulators, 330
applied to rolling robots, 524, 537
</p>
<p>Newton
-Gauss method, 493
-Raphson method, 84
equation, 129
methods, 377, 493
</p>
<p>Newton&ndash;Euler
equations, 129
</p>
<p>Newton&ndash;Euler equations, 130
NOC, see natural orthogonal complement
nonholonomic systems, 282, 507, 523
noninertial base link, 316
nonlinear system, 564
norm
</p>
<p>also, see Frobenius norm
norm (matrix -), 225
normal component of a vector, 31
normality condition, 569
null space of a linear transformation, 29
numerical conditioning, 390, 403
</p>
<p>O
</p>
<p>object-oriented programming, 25
Odetics series of hexapods, 17
ODW, see omnidirectional wheels, see
</p>
<p>omnidirectional wheels
off-line, 5, 158, 196
omnidirectional wheels, 20, 534
</p>
<p>dynamics, 534
kinematics, 457
</p>
<p>on-line, 25
operation point, 142
orientation problem, 171
orthogonal complement, 308
orthogonal decomposition of a vector, 31</p>
<p/>
</div>
<div class="page"><p/>
<p>Index 587
</p>
<p>orthogonal decoupled manipulator, 165
orthogonal projection, 29
orthogonal RRR manipulator
</p>
<p>dynamics, 321, 332
inverse kinematics, 166, 169
recursive dynamics, 328
workspace, 173
</p>
<p>OSU ASV, 17
OSU Hexapod, 17
output, 1
outward recursions, 295
overdetermined system, 568
</p>
<p>P
</p>
<p>Pappus&ndash;Guldinus theorem, 253
parallel axes, theorem, 129
parallel manipulators
</p>
<p>acceleration analysis, 436
dynamics, 512
kinematics, 421
velocity analysis, 436
</p>
<p>parallel robots, 12
parametric
</p>
<p>path representation, 472
representation of curvature, 473
representation of curvature derivative, 475
representation of torsion, 473
representation of torsion derivative, 475
splines, 486
</p>
<p>path-tracking for arc-welding, 498
pick-and-place operations, 255, 256
Pl&uuml;cker coordinates
</p>
<p>of a line, 102
transfer formula, 104
</p>
<p>planar manipulators, 212
acceleration analysis, 218
displacement analysis, 214
dynamics, 288
static analysis, 220
velocity analysis, 216
</p>
<p>platform manipulators, 424, 431, 512
polar-decomposition theorem, 222
polynomial interpolation
</p>
<p>with 3-4-5 polynomial, 258
with 4-5-6-7 polynomial, 262
</p>
<p>pose
array, 106
of a rigid body, 105
</p>
<p>positioning problem, 154
posture of a manipulator, 139
PPO, see pick-and-place operations
principal axes of inertia, 128
principal moments of inertia, 128
</p>
<p>Principle of Virtual Work, 211
prismatic pair, 140, 199
programmable robot, 2
projection, 29
</p>
<p>theorem, 557
Puma robot, 142, 143, 163
</p>
<p>DH parameters, 143
inverse kinematics, 154
workspace, 164
</p>
<p>pure reflection, 30
</p>
<p>Q
</p>
<p>quaternions, 57
</p>
<p>R
</p>
<p>Raghavan and Roth&rsquo;s procedure, 377
Raghavan-Roth&rsquo;s procedure, 390
range of a linear transformation, 29, 85
Rayleigh dissipation function, see dissipation
</p>
<p>function
real-time, 25, 281
reciprocal bases, 82, 193, 522
reciprocal product, 125
recursion, 25
redundant sensing, 81
References, 571
reflection, 30, 378, 384
</p>
<p>composition with rotations, 58
regional structure of a manipulator, 143
revolute pair, 140
rheonomic systems, 508
robot design, 186
robotic hands, 10
robotic mechanical systems, vii, 1
Rodrigues, see Euler&ndash;Rodrigues
</p>
<p>vector, 88
rolling robots
</p>
<p>dynamics, 523
kinematics, 450
</p>
<p>rotating pair, 140
rotation, 33
rotation matrix, 41
</p>
<p>exponential representation, 43
run-time, 25
Runge&ndash;Kutta methods, 341
RVS, viii, 257
</p>
<p>S
</p>
<p>SARAH, 11
Sch&ouml;nflies-motion generators, 16
scleronomic systems, 508</p>
<p/>
</div>
<div class="page"><p/>
<p>588 Index
</p>
<p>screw
amplitude, 99
axis, 99
motion, 95
pitch, 99
</p>
<p>Segway, 21
self-inverse, 31
serial manipulators
</p>
<p>acceleration analysis, 206
dynamics, 281
kinematics, 140
statics, 210
velocity analysis, 186
workspace, 203
</p>
<p>service angle, 222
similarity transformations, 70
simple manipulation, 10
simulation, 339
singular-value decomposition, 224
singular-values, 224
singularities, 185
singularity analysis of decoupled manipulators,
</p>
<p>199
sliding pair, 140
SPDM, 5
spherical wrist, 142, 172, 173
</p>
<p>workspace, 174
spline(s), 269
</p>
<p>interpolation of 4-5-6-7 polynomial,
275
</p>
<p>natural, 273
nonparametric, 270, 486
parametric, 486
periodic, 270
</p>
<p>square root of a matrix, 56
Star robot, 14
state
</p>
<p>of a dynamical system, 306
of parallel manipulators, 519
of serial manipulators, 306, 340
variable, 285, 306, 340
variable equations, 340
vector, 306
</p>
<p>static analysis
of rigid bodies, 121
of serial manipulators, 210
</p>
<p>static, conservative conditions, 185
stationary point, 570
Steiner&rsquo;s Theorem
</p>
<p>in dyad form, 131
Steiner, theorem, 129
Stewart platform, see Stewart&ndash;Gough
</p>
<p>platform
</p>
<p>Stewart&ndash;Gough platform, xiii, 424
direct kinematics, 422
leg kinematics, 424
</p>
<p>structural design, 186
structure of mechanical systems, 9
structured environment, 3
Sutherland, Sprout &amp; Assocs. Hexapod, 17
Swedish wheels, 20
system, 1
</p>
<p>T
</p>
<p>telemanipulators, 5
tensors, 27, 305, 306
Titan series of quadrupeds, 17
torsion, 467
</p>
<p>derivative w. r. t.
a parameter, 475
</p>
<p>derivative w. r. t. the arc length, 467
parametric representation, 473
time-derivative, 469
</p>
<p>trace of a square matrix, 45
trajectories with via poses, 267
trajectory planning, 255, 465
truncation error, 341
Trussarm, 14, 15
TU Munich Hand, 11
TU Munich Hexapod, 18
twist, 111
</p>
<p>axis coordinates, 115
of a rigid body, 114
ray coordinates, 115
transfer formula, 117
</p>
<p>twist-shape relations, 308
for serial manipulators, 311
</p>
<p>U
</p>
<p>unimodular group (of matrices), 104
unstructured environment, 3
</p>
<p>V
</p>
<p>vector of a 3� 3 matrix, 45
vector space, 28
velocity analysis
</p>
<p>of parallel manipulators, 436
of rolling robots, 452
of serial manipulators, 186
</p>
<p>via poses, 268
virtual work, see Principle of Virtual Work
viscosity coefficient, 343
viscous forces, 343</p>
<p/>
</div>
<div class="page"><p/>
<p>Index 589
</p>
<p>W
</p>
<p>walking machines
kinematics, 447
leg architecture, 448&ndash;450
</p>
<p>walking stick, 17
weighting matrix, 568
wheeled robots, 19
</p>
<p>workspace of positioning manipulators,
202
</p>
<p>wrench
acting on a rigid body, 122
axis, 123
pitch, 123
transfer formula, 125</p>
<p/>
</div>
<ul>	<li>Preface to the Fourth Edition</li>
	<li>Preface to the First Edition</li>
<ul>	<li>On Notation</li>
	<li>How to Use the Book</li>
	<li>Acknowledgments</li>
</ul>
	<li>Contents</li>
	<li>1 An Overview of Robotic Mechanical Systems</li>
<ul>	<li>1.1 Introduction</li>
	<li>1.2 The General Architecture of Robotic Mechanical Systems</li>
<ul>	<li>1.2.1 Types of Robots by Function</li>
	<li>1.2.2 Types of Robots by Size</li>
	<li>1.2.3 Types of Robots by Application</li>
</ul>
	<li>1.3 Manipulators</li>
<ul>	<li>1.3.1 Robotic Arms</li>
	<li>1.3.2 Robotic Hands</li>
</ul>
	<li>1.4 Motion Generators</li>
<ul>	<li>1.4.1 Parallel Robots</li>
	<li>1.4.2 SCARA Systems</li>
</ul>
	<li>1.5 Locomotors</li>
<ul>	<li>1.5.1 Legged Robots</li>
<ul>	<li>Humanoids</li>
</ul>
	<li>1.5.2 Wheeled Robots and Rovers</li>
<ul>	<li>Mobile Wheeled Pendulums</li>
	<li>1.5.2.1 Rovers</li>
</ul>
</ul>
	<li>1.6 Swimming Robots</li>
	<li>1.7 Flying Robots</li>
	<li>1.8 Exercises</li>
</ul>
	<li>2 Mathematical Background</li>
<ul>	<li>2.1 Preamble</li>
	<li>2.2 Linear Transformations</li>
	<li>2.3 Rigid-Body Rotations</li>
<ul>	<li>2.3.1 The Cross-Product Matrix</li>
	<li>2.3.2 The Rotation Matrix</li>
<ul>	<li>The Canonical Forms of the Rotation Matrix</li>
</ul>
	<li>2.3.3 The Linear Invariants of a 33 Matrix</li>
	<li>2.3.4 The Linear Invariants of a Rotation</li>
	<li>2.3.5 Examples</li>
	<li>2.3.6 The Euler&ndash;Rodrigues Parameters</li>
</ul>
	<li>2.4 Composition of Reflections and Rotations</li>
	<li>2.5 Coordinate Transformations and Homogeneous Coordinates</li>
<ul>	<li>2.5.1 Coordinate Transformations Between Frames with a Common Origin</li>
	<li>2.5.2 Coordinate Transformation with Origin Shift</li>
	<li>2.5.3 Homogeneous Coordinates</li>
</ul>
	<li>2.6 Similarity Transformations</li>
	<li>2.7 Invariance Concepts</li>
<ul>	<li>2.7.1 Applications to Redundant Sensing</li>
</ul>
	<li>2.8 Exercises</li>
</ul>
	<li>3 Fundamentals of Rigid-Body Mechanics</li>
<ul>	<li>3.1 Introduction</li>
	<li>3.2 General Rigid-Body Motion and Its Associated Screw</li>
<ul>	<li>3.2.1 The Screw of a Rigid-Body Motion</li>
	<li>3.2.2 The Pl&uuml;cker Coordinates of a Line</li>
	<li>3.2.3 The Pose of a Rigid Body</li>
</ul>
	<li>3.3 Rotation of a Rigid Body About a Fixed Point</li>
	<li>3.4 General Instantaneous Motion of a Rigid Body</li>
<ul>	<li>3.4.1 The Instant Screw of a Rigid-Body Motion</li>
	<li>3.4.2 The Twist of a Rigid Body</li>
</ul>
	<li>3.5 Acceleration Analysis of Rigid-Body Motions</li>
	<li>3.6 Rigid-Body Motion Referred to Moving Coordinate Axes</li>
	<li>3.7 Static Analysis of Rigid Bodies</li>
	<li>3.8 Dynamics of Rigid Bodies</li>
	<li>3.9 Exercises</li>
</ul>
	<li>4 Geometry of Decoupled Serial Robots</li>
<ul>	<li>4.1 Introduction</li>
	<li>4.2 The Denavit&ndash;Hartenberg Notation</li>
	<li>4.3 The Geometric Model of Six-Revolute Manipulators</li>
	<li>4.4 The Inverse Displacement Analysis of Decoupled Manipulators</li>
<ul>	<li>4.4.1 The Positioning Problem</li>
<ul>	<li>The Vanishing of 1</li>
	<li>The Vanishing of 2</li>
</ul>
	<li>4.4.2 The Orientation Problem</li>
</ul>
	<li>4.5 Exercises</li>
</ul>
	<li>5 Kinetostatics of Serial Robots</li>
<ul>	<li>5.1 Introduction</li>
	<li>5.2 Velocity Analysis of Serial Manipulators</li>
<ul>	<li>5.2.1 Decoupled Manipulators</li>
</ul>
	<li>5.3 Jacobian Evaluation</li>
<ul>	<li>5.3.1 Evaluation of Submatrix A</li>
	<li>5.3.2 Evaluation of Submatrix B</li>
</ul>
	<li>5.4 Singularity Analysis of Decoupled Manipulators</li>
<ul>	<li>5.4.1 Manipulator Workspace</li>
</ul>
	<li>5.5 Acceleration Analysis of Serial Manipulators</li>
	<li>5.6 Static Analysis of Serial Manipulators</li>
	<li>5.7 Planar Manipulators</li>
<ul>	<li>5.7.1 Displacement Analysis</li>
	<li>5.7.2 Velocity Analysis</li>
	<li>5.7.3 Acceleration Analysis</li>
	<li>5.7.4 Static Analysis</li>
</ul>
	<li>5.8 Kinetostatic Performance Indices</li>
<ul>	<li>5.8.1 Positioning Manipulators</li>
<ul>	<li>Planar Manipulators</li>
	<li>Spatial Manipulators</li>
</ul>
	<li>5.8.2 Orienting Manipulators</li>
	<li>5.8.3 Positioning and Orienting Manipulators</li>
<ul>	<li>Planar Manipulators</li>
	<li>Spatial Manipulators</li>
</ul>
	<li>5.8.4 Computation of the Characteristic Length: Applications to Performance Evaluation</li>
</ul>
	<li>5.9 Exercises</li>
</ul>
	<li>6 Trajectory Planning: Pick-and-Place Operations</li>
<ul>	<li>6.1 Introduction</li>
	<li>6.2 Background on PPO</li>
	<li>6.3 Polynomial Interpolation</li>
<ul>	<li>6.3.1 A 3-4-5 Interpolating Polynomial</li>
	<li>6.3.2 A 4-5-6-7 Interpolating Polynomial</li>
</ul>
	<li>6.4 Cycloidal Motion</li>
	<li>6.5 Trajectories with via Poses</li>
	<li>6.6 Synthesis of PPO Using Cubic Splines</li>
	<li>6.7 Exercises</li>
</ul>
	<li>7 Dynamics of Serial Robotic Manipulators</li>
<ul>	<li>7.1 Introduction</li>
	<li>7.2 Inverse vs. Forward Dynamics</li>
	<li>7.3 Fundamentals of Multibody System Dynamics</li>
<ul>	<li>7.3.1 On Nomenclature and Basic Definitions</li>
	<li>7.3.2 The Euler&ndash;Lagrange Equations of Serial Manipulators</li>
	<li>7.3.3 Kane's Equations</li>
</ul>
	<li>7.4 Recursive Inverse Dynamics</li>
<ul>	<li>7.4.1 Kinematics Computations: Outward Recursions</li>
	<li>7.4.2 Dynamics Computations: Inward Recursions</li>
</ul>
	<li>7.5 The Natural Orthogonal Complement</li>
<ul>	<li>7.5.1 Derivation of Constraint Equations and Twist&ndash;Shape Relations</li>
	<li>7.5.2 Noninertial Base Link</li>
</ul>
	<li>7.6 Manipulator Forward Dynamics</li>
<ul>	<li>7.6.1 Planar Manipulators</li>
	<li>7.6.2 Algorithm Complexity</li>
	<li>7.6.3 Simulation</li>
</ul>
	<li>7.7 Incorporation of Gravity into the Dynamics Equations</li>
	<li>7.8 The Modeling of Dissipative Forces</li>
	<li>7.9 Exercises</li>
</ul>
	<li>8 Special Topics in Rigid-Body Kinematics</li>
<ul>	<li>8.1 Introduction</li>
	<li>8.2 Computation of Angular Velocity from Point-Velocity Data</li>
<ul>	<li>8.2.1 A Robust Formulation</li>
</ul>
	<li>8.3 Computation of Angular Acceleration from Point-Acceleration Data</li>
<ul>	<li>8.3.1 A Robust Formulation</li>
</ul>
	<li>8.4 Exercises</li>
</ul>
	<li>9 Geometry of General Serial Robots</li>
<ul>	<li>9.1 Introduction</li>
	<li>9.2 The IDP of General Six-Revolute Manipulators</li>
<ul>	<li>9.2.1 Preliminaries</li>
	<li>9.2.2 Derivation of the Fundamental Closure Equations</li>
</ul>
	<li>9.3 The Univariate-Polynomial Approach</li>
<ul>	<li>9.3.1 The Raghavan&ndash;Roth Procedure</li>
	<li>9.3.2 The Li&ndash;Woernle&ndash;Hiller Procedure</li>
</ul>
	<li>9.4 The Bivariate-Equation Approach</li>
<ul>	<li>9.4.1 Numerical Conditioning of the Solutions</li>
</ul>
	<li>9.5 Implementation of the Solution Method</li>
	<li>9.6 Computation of the Remaining Joint Angles</li>
<ul>	<li>9.6.1 The Raghavan&ndash;Roth Procedure</li>
	<li>9.6.2 The Li&ndash;Woernle&ndash;Hiller Procedure</li>
	<li>9.6.3 The Bivariate-Equation Approach</li>
</ul>
	<li>9.7 Examples</li>
	<li>9.8 Exercises</li>
</ul>
	<li>10 Kinematics of Alternative Robotic Mechanical Systems</li>
<ul>	<li>10.1 Introduction</li>
	<li>10.2 Kinematics of Parallel Manipulators</li>
<ul>	<li>10.2.1 Velocity and Acceleration Analyses of Parallel Manipulators</li>
<ul>	<li>Planar and Spherical Manipulators</li>
</ul>
</ul>
	<li>10.3 Multifingered Hands</li>
	<li>10.4 Walking Machines</li>
	<li>10.5 Rolling Robots</li>
<ul>	<li>10.5.1 Robots with Conventional Wheels</li>
	<li>10.5.2 Robots with Omnidirectional Wheels</li>
</ul>
	<li>10.6 Exercises</li>
</ul>
	<li>11 Trajectory Planning: Continuous-Path Operations</li>
<ul>	<li>11.1 Introduction</li>
	<li>11.2 Curve Geometry</li>
	<li>11.3 Parametric Path Representation</li>
	<li>11.4 Parametric Splines in Trajectory Planning</li>
	<li>11.5 Continuous-Path Tracking</li>
	<li>11.6 Exercises</li>
</ul>
	<li>12 Dynamics of Complex Robotic Mechanical Systems</li>
<ul>	<li>12.1 Introduction</li>
	<li>12.2 Classification of Robotic Mechanical Systems with Regard to Dynamics</li>
	<li>12.3 The Structure of the Dynamics Models of Holonomic Systems</li>
	<li>12.4 Dynamics of Parallel Manipulators</li>
	<li>12.5 Dynamics of Rolling Robots</li>
<ul>	<li>12.5.1 Robots with Conventional Wheels</li>
	<li>12.5.2 Robots with Omnidirectional Wheels</li>
</ul>
	<li>12.6 Exercises</li>
</ul>
	<li>Erratum</li>
<ul>	<li>Appendix A</li>
</ul>
	<li>Appendix A Kinematics of Rotations: A Summary&#13;</li>
	<li>Appendix B Numerical Equation-Solving&#13;</li>
<ul>	<li>B.1 The Overdetermined Linear Case</li>
<ul>	<li>B.1.1 The Numerical Solution of an Overdetermined System of Linear Equations</li>
</ul>
	<li>B.2 The Underdetermined Linear Case</li>
<ul>	<li>B.2.1 The Numerical Solution of an Underdetermined System of Linear Equations</li>
</ul>
	<li>B.3 Nonlinear-Equation Solving: The Determined Case</li>
<ul>	<li>B.3.1 The Newton&ndash;Raphson Method</li>
</ul>
	<li>B.4 Overdetermined Nonlinear Systems of Equations</li>
<ul>	<li>B.4.1 The Newton&ndash;Gauss Method</li>
	<li>B.4.2 Convergence Criterion</li>
</ul>
</ul>
	<li>References</li>
	<li>Index</li>
</ul>
</body></html>